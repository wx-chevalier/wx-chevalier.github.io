<!DOCTYPE html><html lang="zh" >


<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  
  
  
    <meta name="generator" content="Wowchemy 5.5.0 for Hugo" />
  

  
  










  







  
  
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  

  
  
  
    
      
      <link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap">
      <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap" media="print" onload="this.media='all'">
    
  

  
    <meta name="google-site-verification" content="google69a5cccb61297807" />
    <meta name="baidu-site-verification" content="cqmZHEleVh" />
  
  
  
  
  

  

  
  
  
    
  
  <meta name="description" content="How to start a Go project in 2023 Install / Setup The first thing to do is download and install Go. I would suggest always installing from the Go website itself https://golang.org/ and following the instructions for your OS of choice. Other than the Go 1.18 release (which included generics) I have never had any issue always installing the newest version of Go and compiling away. The backwards compatibility promise is real. So much so even if a project’s go.mod file says 1.20, if it does not use any 1.20 functionality you can probably still compile it using an earlier release." />

  
  <link rel="alternate" hreflang="zh" href="https://ng-tech.icu/books/go-notes/01.%E8%AF%AD%E6%B3%95%E5%9F%BA%E7%A1%80/01.%E5%BF%AB%E9%80%9F%E5%BC%80%E5%A7%8B/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/how-to-start-a-go-project-in-2023/" />

  
  
  
    <meta name="theme-color" content="#0a55a7" />
  

  
  

  

  <link rel="stylesheet" href="/css/vendor-bundle.min.c7b8d9abd591ba2253ea42747e3ac3f5.css" media="print" onload="this.media='all'">

  
  
  
    
    

    
    
    
    
      
      
    
    
    

    
    
    
      
    
    
      
      
        
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.1/styles/github.min.css" crossorigin="anonymous" title="hl-light" media="print" onload="this.media='all'">
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.1/styles/dracula.min.css" crossorigin="anonymous" title="hl-dark" media="print" onload="this.media='all'" disabled>
        
      
    

    
    
    

    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/instantsearch.css@7.4.5/themes/satellite-min.css" integrity="sha256-TehzF/2QvNKhGQrrNpoOb2Ck4iGZ1J/DI4pkd2oUsBc=" crossorigin="anonymous">
    

    
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      
        
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
  

  
  
  
  
  
  <link rel="stylesheet" href="/css/wowchemy.0d97305106da5efa530e28b021b4c580.css" />

  




<script async src="https://www.googletagmanager.com/gtag/js?id=G-40NYXJ8823"></script>

<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', "G-40NYXJ8823");
</script>


  


  


  


  <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?56df1177bce405601b0ecdd7208f75c6";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>



  
  
  

  

  
    <link rel="manifest" href="/manifest.webmanifest" />
  

  <link rel="icon" type="image/png" href="/media/icon_hu0f7d075e895d6f5f1f5fdbc1e33dc138_10087_32x32_fill_lanczos_center_3.png" />
  <link rel="apple-touch-icon" type="image/png" href="/media/icon_hu0f7d075e895d6f5f1f5fdbc1e33dc138_10087_180x180_fill_lanczos_center_3.png" />

  <link rel="canonical" href="https://ng-tech.icu/books/go-notes/01.%E8%AF%AD%E6%B3%95%E5%9F%BA%E7%A1%80/01.%E5%BF%AB%E9%80%9F%E5%BC%80%E5%A7%8B/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/how-to-start-a-go-project-in-2023/" />

  
  
  
  
  
  
  
  
    
  
  

  
  
    
    
  
  <meta property="twitter:card" content="summary_large_image" />
  
    <meta property="twitter:site" content="@wx-chevalier" />
    <meta property="twitter:creator" content="@wx-chevalier" />
  
  <meta property="og:site_name" content="Next-gen Tech Edu" />
  <meta property="og:url" content="https://ng-tech.icu/books/go-notes/01.%E8%AF%AD%E6%B3%95%E5%9F%BA%E7%A1%80/01.%E5%BF%AB%E9%80%9F%E5%BC%80%E5%A7%8B/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/how-to-start-a-go-project-in-2023/" />
  <meta property="og:title" content="How to start a Go project in 2023 | Next-gen Tech Edu" />
  <meta property="og:description" content="How to start a Go project in 2023 Install / Setup The first thing to do is download and install Go. I would suggest always installing from the Go website itself https://golang.org/ and following the instructions for your OS of choice. Other than the Go 1.18 release (which included generics) I have never had any issue always installing the newest version of Go and compiling away. The backwards compatibility promise is real. So much so even if a project’s go.mod file says 1.20, if it does not use any 1.20 functionality you can probably still compile it using an earlier release." /><meta property="og:image" content="https://ng-tech.icu/media/sharing.png" />
    <meta property="twitter:image" content="https://ng-tech.icu/media/sharing.png" /><meta property="og:locale" content="zh" />
  
    
    
  

  



  

  

  





  <title>How to start a Go project in 2023 | Next-gen Tech Edu</title>
</head>


<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" class="page-wrapper   " data-wc-page-id="080fd37461cbae7a9af67dbcebaa13d6" >
  <button onclick="topFunction()" id="backTopBtn" title="Go to top"><i class="fa-solid fa-circle-up" aria-hidden="true"></i></button>
  
  
  
  
  
  
  
  
  
  <script src="/js/wowchemy-init.min.14a0ed61c6dbd594b9c75193b25be179.js"></script>

  


<aside class="search-modal" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6 search-title">
          <p>搜索</p>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#" aria-label="关闭"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        
        
      </div>

      
      

      
    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

      <div id="search-common-queries">
        
      </div>

    </section>
  </div>
</aside>



  <div class="page-header">
    












<header class="header--fixed">
  <nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
    <div class="container-xl">

      
      <div class="d-none d-lg-inline-flex">
        <a class="navbar-brand" href="/">Next-gen Tech Edu</a>
      </div>
      

      
      <button type="button" class="navbar-toggler" data-toggle="collapse"
              data-target="#navbar-content" aria-controls="navbar-content" aria-expanded="false" aria-label="切换导航">
      <span><i class="fas fa-bars"></i></span>
      </button>
      

      
      <div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none">
        <a class="navbar-brand" href="/">Next-gen Tech Edu</a>
      </div>
      

      
      
      <div class="navbar-collapse main-menu-item collapse justify-content-start" id="navbar-content">

        
        <ul class="navbar-nav d-md-inline-flex">
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
          

          <li class="nav-item">
            <a class="nav-link " href="/books-gallery"><span>笔记（万篇）</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="/#knowledge-map"><span>知识图谱</span></a>
          </li>

          
          

          
          <style>
            .dropdown-item{
              display: inline-flex;
            }
          </style>
          <li class="nav-item dropdown">
            <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" aria-haspopup="true"><span>实验室</span><span class="caret"></span>
            </a>
            <div class="dropdown-menu">
              
                <a class="dropdown-item" href="/galaxy-home/gh-craft"><span>Craft 方块世界</span></a>
              
                <a class="dropdown-item" href="/galaxy-home/glossary-cards"><span>3D 知识卡牌</span></a>
              
            </div>
          </li>

          
          

          
          <style>
            .dropdown-item{
              display: inline-flex;
            }
          </style>
          <li class="nav-item dropdown">
            <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" aria-haspopup="true"><span>其他阅读渠道</span><span class="caret"></span>
            </a>
            <div class="dropdown-menu">
              
                <a class="dropdown-item" href="https://zhuanlan.zhihu.com/wxyyxc1992"><img style="width:16px;height:16px;display:inline-block;margin-right:8px" src="https://ngte-superbed.oss-cn-beijing.aliyuncs.com/item/20230218234451.png"></img><span>知乎</span></a>
              
                <a class="dropdown-item" href="https://segmentfault.com/blog/wxyyxc1992"><img style="width:16px;height:16px;display:inline-block;margin-right:8px" src="https://ngte-superbed.oss-cn-beijing.aliyuncs.com/item/20230219113556.png"></img><span>SegmentFault</span></a>
              
                <a class="dropdown-item" href="https://zhuanlan.zhihu.com/wxyyxc1992"><img style="width:16px;height:16px;display:inline-block;margin-right:8px" src="https://ngte-superbed.oss-cn-beijing.aliyuncs.com/item/20230219113519.png"></img><span>掘金</span></a>
              
            </div>
          </li>

          
          

        

          
        </ul>
      </div>

      <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">

        
        
        
        <li class="nav-item">
          <a class="nav-link js-search" href="#" aria-label="搜索"><i class="fas fa-search" aria-hidden="true"></i></a>
        </li>
        

        
        
        <li class="nav-item">
            <a class="nav-link" href="https://github.com/wx-chevalier" aria-label="GitHub"><i class="fa-brands fa-github" aria-hidden="true"></i></a>
        </li>
        

        
        
        

        
        
        
        <div></div>
        
        <style>
        @media only screen and (max-width: 600px) {
          .jimmysong-template {
            display: none!important;
          }
        }
        </style>
        
        <li class="jimmysong-template" style="color: white;font-size: 12px;">
          <a href="https://jimmysong.io" style="color: white">By Jimmy Song's Template</a>
        </li>
      </ul>

    </div>
  </nav>
</header>


  </div>

  <div class="page-body">
    
    
    

    




<link rel="stylesheet" href="//unpkg.com/heti/umd/heti.min.css">
<div class="container-xl docs">
  <div class="row flex-xl-nowrap">
    <div class="docs-sidebar">
      <form class="docs-search d-flex align-items-center">
  <button class="btn docs-toggle d-md-none p-0 mr-md-3 w-100" type="button" data-toggle="collapse" data-target="#docs-nav" aria-controls="docs-nav" aria-expanded="false" aria-label="Toggle section navigation">
    <div class="d-flex">
      <span class="d-md-none pl-1 flex-grow-1 text-left overflow-hidden">
        
          99.参考资料
        
      </span>
      <span><i class="fas fa-chevron-down"></i></span>
    </div>
  </button>

  
  <button class="form-control sidebar-search js-search d-none d-md-flex">
    <i class="fas fa-search pr-2"></i>
    <span class="sidebar-search-text">搜索...</span>
    <span class="sidebar-search-shortcut">/</span>
  </button>
  
</form>

<nav class="collapse docs-links" id="docs-nav">
  
  
  
  
  
  

  
  
    

    
      

      <ul class="nav docs-sidenav">
        <li style="display: inline-flex">
          <a style="cursor: pointer;" onclick="window.history.back()">
            <i class="fas fa-arrow-left pr-1"></i>
            Back
          </a>
          <span>|</span>
          <a href="/books/">
            <i class="fa-solid fa-house" style="margin-right: 4px"></i>
            Books
          </a>
        </li>
      </ul>

      
      
        
          
        
      



  
    
    
    
    
      
    
    

    
    
    
    
    
    <div class="docs-toc-item has-child">
    <div class="parent-node d-flex justify-content-between" onClick="Collapse(&#34;caret-id00eb3103d90e6ccf2e8d4e3c7f2ef192&#34;)" href="#id00eb3103d90e6ccf2e8d4e3c7f2ef192" aria-expanded="false" aria-controls="id00eb3103d90e6ccf2e8d4e3c7f2ef192" aria-hidden="false" data-toggle="collapse">
    
    <a class="d-inline docs-toc-link " href="/books/go-notes/01.%E8%AF%AD%E6%B3%95%E5%9F%BA%E7%A1%80/01.%E5%BF%AB%E9%80%9F%E5%BC%80%E5%A7%8B/">01.快速开始</a>
    <a class="nav-toogle d-inline level" aria-hidden="false" data-toggle="collapse" href="#id00eb3103d90e6ccf2e8d4e3c7f2ef192" aria-expanded="false" aria-controls="id00eb3103d90e6ccf2e8d4e3c7f2ef192">
    
    <i class="fa-solid fa-angle-down" id="caret-id00eb3103d90e6ccf2e8d4e3c7f2ef192"></i>
    
    </a>
    
    </div>
    
      
      <ul class="nav docs-sidenav collapse  show " id="id00eb3103d90e6ccf2e8d4e3c7f2ef192">
      



  
    
    
    
    
      
    
    

    
    
    
    
    
    <div class="docs-toc-item has-child">
    <div class="parent-node d-flex justify-content-between" onClick="Collapse(&#34;caret-id5949d673e7cd39b0f3db1d83b8c2b0f4&#34;)" href="#id5949d673e7cd39b0f3db1d83b8c2b0f4" aria-expanded="false" aria-controls="id5949d673e7cd39b0f3db1d83b8c2b0f4" aria-hidden="false" data-toggle="collapse">
    
    <a class="d-inline docs-toc-link " href="/books/go-notes/01.%E8%AF%AD%E6%B3%95%E5%9F%BA%E7%A1%80/01.%E5%BF%AB%E9%80%9F%E5%BC%80%E5%A7%8B/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/">99.参考资料</a>
    <a class="nav-toogle d-inline level" aria-hidden="false" data-toggle="collapse" href="#id5949d673e7cd39b0f3db1d83b8c2b0f4" aria-expanded="false" aria-controls="id5949d673e7cd39b0f3db1d83b8c2b0f4">
    
    <i class="fa-solid fa-angle-down" id="caret-id5949d673e7cd39b0f3db1d83b8c2b0f4"></i>
    
    </a>
    
    </div>
    
      
      <ul class="nav docs-sidenav collapse  show " id="id5949d673e7cd39b0f3db1d83b8c2b0f4">
      



  <li class="child level active"><a href="/books/go-notes/01.%E8%AF%AD%E6%B3%95%E5%9F%BA%E7%A1%80/01.%E5%BF%AB%E9%80%9F%E5%BC%80%E5%A7%8B/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/how-to-start-a-go-project-in-2023/">How to start a Go project in 2023</a></li>

      
        </ul>
      
    

    
      </div>
    




  <li class="child level "><a href="/books/go-notes/01.%E8%AF%AD%E6%B3%95%E5%9F%BA%E7%A1%80/01.%E5%BF%AB%E9%80%9F%E5%BC%80%E5%A7%8B/web-%E5%BA%94%E7%94%A8/">Web 应用</a></li>




  
    
    
    
    
      
    
    

    
    
    
    <div class="docs-toc-item has-child">
    <div class="parent-node d-flex justify-content-between" onClick="Collapse(&#34;caret-id4a31bffa5a8f0efc62818239b39a5fde&#34;)" href="#id4a31bffa5a8f0efc62818239b39a5fde" aria-expanded="false" aria-controls="id4a31bffa5a8f0efc62818239b39a5fde" aria-hidden="false" data-toggle="collapse">
    
    <a class="d-inline docs-toc-link " href="/books/go-notes/01.%E8%AF%AD%E6%B3%95%E5%9F%BA%E7%A1%80/01.%E5%BF%AB%E9%80%9F%E5%BC%80%E5%A7%8B/%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/">开发环境</a>
    <a class="nav-toogle d-inline level" aria-hidden="false" data-toggle="collapse" href="#id4a31bffa5a8f0efc62818239b39a5fde" aria-expanded="false" aria-controls="id4a31bffa5a8f0efc62818239b39a5fde">
    
        <i class="fa-solid fa-angle-right" id="caret-id4a31bffa5a8f0efc62818239b39a5fde"></i>
    
    </a>
    
    </div>
    
      
      <ul class="nav docs-sidenav collapse  " id="id4a31bffa5a8f0efc62818239b39a5fde">
      



  <li class="child level "><a href="/books/go-notes/01.%E8%AF%AD%E6%B3%95%E5%9F%BA%E7%A1%80/01.%E5%BF%AB%E9%80%9F%E5%BC%80%E5%A7%8B/%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/delve/">Delve</a></li>




  <li class="child level "><a href="/books/go-notes/01.%E8%AF%AD%E6%B3%95%E5%9F%BA%E7%A1%80/01.%E5%BF%AB%E9%80%9F%E5%BC%80%E5%A7%8B/%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/%E5%B7%A5%E5%85%B7%E9%93%BE/">工具链</a></li>




  <li class="child level "><a href="/books/go-notes/01.%E8%AF%AD%E6%B3%95%E5%9F%BA%E7%A1%80/01.%E5%BF%AB%E9%80%9F%E5%BC%80%E5%A7%8B/%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/%E5%86%85%E7%BD%AE%E5%91%BD%E4%BB%A4/">内置命令</a></li>

      
        </ul>
      
    

    
      </div>
    




  
    
    
    
    
      
    
    

    
    
    
    <div class="docs-toc-item has-child">
    <div class="parent-node d-flex justify-content-between" onClick="Collapse(&#34;caret-id984b936cc61300d164b64781a2cfd885&#34;)" href="#id984b936cc61300d164b64781a2cfd885" aria-expanded="false" aria-controls="id984b936cc61300d164b64781a2cfd885" aria-hidden="false" data-toggle="collapse">
    
    <a class="d-inline docs-toc-link " href="/books/go-notes/01.%E8%AF%AD%E6%B3%95%E5%9F%BA%E7%A1%80/01.%E5%BF%AB%E9%80%9F%E5%BC%80%E5%A7%8B/%E5%91%BD%E4%BB%A4%E8%A1%8C%E5%BA%94%E7%94%A8/">命令行应用</a>
    <a class="nav-toogle d-inline level" aria-hidden="false" data-toggle="collapse" href="#id984b936cc61300d164b64781a2cfd885" aria-expanded="false" aria-controls="id984b936cc61300d164b64781a2cfd885">
    
        <i class="fa-solid fa-angle-right" id="caret-id984b936cc61300d164b64781a2cfd885"></i>
    
    </a>
    
    </div>
    
      
      <ul class="nav docs-sidenav collapse  " id="id984b936cc61300d164b64781a2cfd885">
      



  <li class="child level "><a href="/books/go-notes/01.%E8%AF%AD%E6%B3%95%E5%9F%BA%E7%A1%80/01.%E5%BF%AB%E9%80%9F%E5%BC%80%E5%A7%8B/%E5%91%BD%E4%BB%A4%E8%A1%8C%E5%BA%94%E7%94%A8/cobra/">Cobra</a></li>




  <li class="child level "><a href="/books/go-notes/01.%E8%AF%AD%E6%B3%95%E5%9F%BA%E7%A1%80/01.%E5%BF%AB%E9%80%9F%E5%BC%80%E5%A7%8B/%E5%91%BD%E4%BB%A4%E8%A1%8C%E5%BA%94%E7%94%A8/urfave-cli/">urfave-cli</a></li>

      
        </ul>
      
    

    
      </div>
    

      
        </ul>
      
    

    
      </div>
    

    
  
</nav>

    </div>

    
    
    <div class="d-none d-xl-block col-xl-2 docs-toc">
      
     
      <ul class="nav toc-top">
        <li><a href="#" id="back_to_top" class="docs-toc-title">目录</a></li>
      </ul>
     

      <nav id="TableOfContents">
  <ul>
    <li><a href="#install--setup">Install / Setup</a>
      <ul>
        <li><a href="#editor">Editor</a></li>
      </ul>
    </li>
    <li><a href="#starting-a-project">Starting a Project</a>
      <ul>
        <li><a href="#getting-packages--dependencies">Getting Packages / Dependencies</a></li>
        <li><a href="#clean--tidy">Clean / Tidy</a></li>
      </ul>
    </li>
    <li><a href="#learning-go">Learning Go</a></li>
    <li><a href="#searching">Searching</a></li>
    <li><a href="#building--installing">Building / Installing</a>
      <ul>
        <li><a href="#trimming-builds">Trimming Builds</a></li>
        <li><a href="#packaging--deploying">Packaging / Deploying</a></li>
      </ul>
    </li>
    <li><a href="#linting--static-analysis--security-scanning">Linting / Static Analysis / Security Scanning</a></li>
    <li><a href="#profiling">Profiling</a></li>
    <li><a href="#unit-testing">Unit Testing</a>
      <ul>
        <li><a href="#mocks">Mocks</a></li>
      </ul>
    </li>
    <li><a href="#integration-testing">Integration Testing</a>
      <ul>
        <li><a href="#test-caching">Test Caching</a></li>
      </ul>
    </li>
    <li><a href="#community">Community</a></li>
    <li><a href="#multiple-main-entry-points">Multiple Main Entry Points</a></li>
    <li><a href="#os-specific-code">OS Specific Code</a></li>
    <li><a href="#docker">Docker</a></li>
    <li><a href="#useful-toolspackages">Useful Tools/Packages</a>
      <ul>
        <li><a href="#tools">Tools</a></li>
        <li><a href="#packages">Packages</a></li>
      </ul>
    </li>
  </ul>
</nav>

      
<div class="subscribe-module col-24 mt-1">
    <img src="https://ngte-superbed.oss-cn-beijing.aliyuncs.com/item/20230220172727.png" alt="image" title="王下邀月熊的微信公众号"/>
</div>



    </div>
    

    <main class="py-md-3 pl-md-3 docs-content col-xl-8" role="main">

      <article class="article">

          

          <h1>How to start a Go project in 2023</h1>

          <div class="article-style">
            <h1 id="how-to-start-a-go-project-in-2023">How to start a Go project in 2023</h1>
<h2 id="install--setup">Install / Setup</h2>
<p>The first thing to do is download and install Go. I would suggest always installing from the Go website itself <a href="https://golang.org/" target="_blank" rel="noopener">https://golang.org/</a> and following the instructions for your OS of choice. Other than the Go 1.18 release (which included generics) I have never had any issue always installing the newest version of Go and compiling away. The backwards compatibility promise is real. So much so even if a project’s go.mod file says 1.20, if it does not use any 1.20 functionality you can probably still compile it using an earlier release.</p>
<p>Older guides will mention setting up your $GOPATH. This is something you can comfortably ignore in 2023. Check my <a href="https://boyter.org/posts/how-to-start-go-project-2018/" target="_blank" rel="noopener">previous post</a> if you are curious. However everything has or is moving to modules, so just consider this something you don’t have to learn.</p>
<p>One thing I do recommend is update your machines path to point to the <code>bin</code> directory of the default $GOPATH, <code>export PATH=$PATH:$(go env GOPATH)/bin</code> so that you can install anything you are working on quickly and have it available everywhere. For example, on my current machine it contains the following.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="c1"># boyter @ Bens-MacBook-Air in ~/go/bin [10:04:57]</span>
</span></span><span class="line"><span class="cl">$ tree
</span></span><span class="line"><span class="cl">.
</span></span><span class="line"><span class="cl">├── boltbrowser
</span></span><span class="line"><span class="cl">├── cs
</span></span><span class="line"><span class="cl">├── dcd
</span></span><span class="line"><span class="cl">├── goreleaser
</span></span><span class="line"><span class="cl">├── gow
</span></span><span class="line"><span class="cl">├── hashit
</span></span><span class="line"><span class="cl">├── lc
</span></span><span class="line"><span class="cl">├── scc
</span></span></code></pre></div><p>My dotfile contains <code>export PATH=/Users/boyter/go/bin:$PATH</code> to achieve the above.</p>
<p>With the exported path I can run <code>scc</code>, <code>dcd</code> and <code>lc</code> anywhere I want, after first running <code>go install</code> for the project I am working on. When on Windows I go a little further than most and have my $GOPATH shared between Windows and Linux using the WSL so I can work on the same code-base in either, and as such you would see .exe files in the above. To do that you just need to do a symlink inside the WSL to the Windows directory.</p>
<h3 id="editor">Editor</h3>
<p>Based on the most recent <a href="https://go.dev/blog/survey2023-q1-results" target="_blank" rel="noopener">Go survey results</a> most people code Go in Visual Studio Code or Jetbrains Goland, which are the only editors I am going to include.</p>
<p>Goland works pretty much out of the box, and is the IDE I use day to day. So long as you have Go installed it should find it and start working. The biggest issue is when new releases of Go come out. This can cause Goland to be confused, and break things like your debugger. The solution is to upgrade after a week or so once the Jetbrains team has updated to match.</p>
<p>I have found these updates sometimes result result in an infinite loop of The “clang” command requires the command line developer tools on macOS. The fix for this I <a href="https://boyter.org/posts/golang-the-clang-command-requires-command-line-developer-tools/" target="_blank" rel="noopener">wrote about</a> but boils down to running <code>xcodebuild -runFirstLaunch</code> to resolve the issue.</p>
<p>Visual Studio Code has come a long way and is a lot better than it was when I first started with Go. Install the <a href="https://code.visualstudio.com/" target="_blank" rel="noopener">latest version</a>, and then install the <a href="https://code.visualstudio.com/docs/languages/go" target="_blank" rel="noopener">Go in Visual Studio Code</a> extension. You get intellisense, reformatting, auto-import/remove import functionality you want. Debugging supposedly works now as well, but I cannot report on this.</p>
<p>I still prefer to pay and use for Goland because I find it to be like pairing with a brilliant engineer who never sleeps and is almost never wrong. Its ability to generate table tests, and run individual ones saves a lot of time and the refactoring tools are great. However for this post I tried using Visual Studio Code for a few hours and I was very impressed, and have no problems recommending it now.</p>
<h2 id="starting-a-project">Starting a Project</h2>
<p>Starting a project is as easy as starting a new directory and running <code>go mod init NAMEHERE</code> where <code>NAMEHERE</code> is the name of the package you want for your project. It used to be that you used a name that matched the location of your repository so for example <code>github.com/boyter/scc</code> but you can use whatever you want now. Using the full repo URL isn’t a bad idea though and I still prefer it for most projects.</p>
<h3 id="getting-packages--dependencies">Getting Packages / Dependencies</h3>
<p>Getting a package is almost as simple as knowing its path and using <code>go get URL</code> to download it to your local system. I usually vendor dependencies so I have a copy stored with my project allowing for reproducible builds. It also allows me to patch bugs in the dependencies easily while waiting on upstream fixes. To do so run <code>go mod vendor</code> which will pull everything into the <code>vendor</code> directory. If you do this I suggest setting up a <code>.ignore</code> file with <code>vendor</code> in it.</p>
<p>Where getting packages can be confusing is if the package maintainer has moved on from semantic version 1 to 2 or further. In this case you will need to add the version you want at the end to pull in the version you want.</p>
<p>For example my project <code>scc</code> is on version 3.1.0. If I were to import it without specifying the version,</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">$ go get github.com/boyter/scc/
</span></span><span class="line"><span class="cl">go: added github.com/boyter/scc v2.12.0+incompatible
</span></span></code></pre></div><p>I would get a version 2.12 package which can be confusing to those new to Go. When adding the latest version,</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">$ go get github.com/boyter/scc/v3
</span></span><span class="line"><span class="cl">go: added github.com/boyter/scc/v3 v3.1.0
</span></span></code></pre></div><p>Which as you an see has pulled down the correct version which is what I would expect.</p>
<p>The following guide <a href="https://engineering.kablamo.com.au/posts/2018/just-tell-me-how-to-use-go-modules/" target="_blank" rel="noopener">Just tell me how to use Go Modules</a> and it’s <a href="https://news.ycombinator.com/item?id=18653225" target="_blank" rel="noopener">Hacker News Conversation</a> covers this fairly well.</p>
<h3 id="clean--tidy">Clean / Tidy</h3>
<p>One thing that will come up occasionally when you try to run <code>go</code> after working with packages is it reporting you need to run <code>go mod tidy</code>. Don’t worry too much about this, just run <code>go mod tidy</code> and whatever you were trying to do till you are able to progress again. You can read about what its doing at <a href="https://go.dev/ref/mod" target="_blank" rel="noopener">Go Modules Reference</a>.</p>
<p>Cached artifacts from the Go build system can be stored on your local system and take up a fair amount of space (my local at time of writing is ~1GB in size). To clean this up run <code>go clean -cache</code>.</p>
<h2 id="learning-go">Learning Go</h2>
<p>You can get to grips with Go pretty easily using the <a href="https://go.dev/learn/" target="_blank" rel="noopener">go.dev learning tutorials</a>. This will get you up to speed with how to write code, and the syntax you need to be aware of. However for learning how to structure your own HTTP application, which is what most people are doing I strongly suggest the following book <a href="https://lets-go.alexedwards.net/" target="_blank" rel="noopener">https://lets-go.alexedwards.net/</a> It does cost money, but it will short-cut your learning process by a few hours.</p>
<p>I have a sample that I personally use for setting up new HTTP projects which you can find on github <a href="https://github.com/boyter/go-http-template" target="_blank" rel="noopener">https://github.com/boyter/go-http-template</a></p>
<p>One thing I strongly suggest reading however is the <a href="https://devs.cloudimmunity.com/gotchas-and-common-mistakes-in-go-golang/index.html" target="_blank" rel="noopener">50 Shades of Go</a> post. It covers a lot of the Go pitfalls you are likely to run into. Checking for this is something a lot of companies screen for when hiring, as exposure to these issues is a good indication of experience using Go.</p>
<h2 id="searching">Searching</h2>
<p>To search for anything about Go in your search engine of choice use the word <code>golang</code> rather than <code>go</code> when searching. For example to search for how to open a file I would search for <code>golang open file</code>.</p>
<p>Note its best to not refer to the language as golang in casual conversation, as this will annoy a lot of pedantic people. Everyone knows what you are talking about but expect someone to say something eventually.</p>
<h2 id="building--installing">Building / Installing</h2>
<p>For commands which have <code>package main</code></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">go build   builds the <span class="nb">command</span> and leaves the result in the current working directory.
</span></span><span class="line"><span class="cl">go install builds the <span class="nb">command</span> in a temporary directory <span class="k">then</span> moves it to <span class="nv">$GOPATH</span>/bin.
</span></span></code></pre></div><p>For packages</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">go build   builds your package <span class="k">then</span> discards the results.
</span></span><span class="line"><span class="cl">go install builds <span class="k">then</span> installs the package in your <span class="nv">$GOPATH</span>/pkg directory.
</span></span></code></pre></div><p>If you want to cross compile, that is build on Linux for Windows or vice versa you can set what architecture your want to target and the OS through environment variables. You can view your defaults in <code>go env</code> but to change them you would do something like,</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="nv">GOOS</span><span class="o">=</span>darwin <span class="nv">GOARCH</span><span class="o">=</span>amd64 go build
</span></span><span class="line"><span class="cl"><span class="nv">GOOS</span><span class="o">=</span>darwin <span class="nv">GOARCH</span><span class="o">=</span>arm64 go build
</span></span><span class="line"><span class="cl"><span class="nv">GOOS</span><span class="o">=</span>windows <span class="nv">GOARCH</span><span class="o">=</span>amd64 go build
</span></span><span class="line"><span class="cl"><span class="nv">GOOS</span><span class="o">=</span>windows <span class="nv">GOARCH</span><span class="o">=</span>arm64 go build
</span></span><span class="line"><span class="cl"><span class="nv">GOOS</span><span class="o">=</span>linux <span class="nv">GOARCH</span><span class="o">=</span>amd64 go build
</span></span><span class="line"><span class="cl"><span class="nv">GOOS</span><span class="o">=</span>linux <span class="nv">GOARCH</span><span class="o">=</span>arm64 go build
</span></span></code></pre></div><h3 id="trimming-builds">Trimming Builds</h3>
<p>Go binaries are by default “fat” and larger than you might expect. There is an easy way to reduce the size,</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">go build -ldflags<span class="o">=</span><span class="s2">&#34;-s -w&#34;</span>
</span></span></code></pre></div><p>Which strips out the debug information. For smaller binaries where startup time does not matter you can also use <a href="https://upx.github.io/" target="_blank" rel="noopener">https://upx.github.io/</a> but I have found issues with using this when cross compiling. See this <a href="https://boyter.org/posts/trimming-golang-binary-fat/" target="_blank" rel="noopener">other post</a> I wrote about using both.</p>
<h3 id="packaging--deploying">Packaging / Deploying</h3>
<p>While you can use the above mentioned GOOS and GOARCH to build your own packages, I strongly suggest using <a href="https://goreleaser.com/" target="_blank" rel="noopener">goreleaser</a>. It makes deployments considerably easier and its guide ensures you are tagging correctly.</p>
<h2 id="linting--static-analysis--security-scanning">Linting / Static Analysis / Security Scanning</h2>
<p>While you can use sonar and various other tools for this, I prefer to have something you can run locally, and easily integrate into your CI/CD system. Using the below tools will get you those all important audit ticks.</p>
<p>For linting and static analysis <a href="https://github.com/golangci/golangci-lint" target="_blank" rel="noopener">https://github.com/golangci/golangci-lint</a></p>
<p>For security checks I like to use gitleaks <a href="https://github.com/gitleaks/gitleaks" target="_blank" rel="noopener">https://github.com/gitleaks/gitleaks</a> and run it with the following checks.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">gitleaks detect -v -c gitleaks.toml
</span></span><span class="line"><span class="cl">gitleaks protect -v -c gitleaks.tom
</span></span></code></pre></div><p>Note that you need to include a gitleaks toml file. <a href="https://gist.github.com/boyter/48942e5bcf9eed3cd3ed5f8ad413920f" target="_blank" rel="noopener">Here is the one I use</a> as a base where I have included the vendor directory to be ignored as things like the AWS SDK causes gitleaks to freak out.</p>
<h2 id="profiling">Profiling</h2>
<p>Profiling in Go has first class support. For CPU profiling you want your profiler to run either over a time period for things like HTTP services or when the program exits for short lived applications.</p>
<p>For short lived applications add the following in your main function,</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="line"><span class="cl"><span class="nx">f</span><span class="p">,</span> <span class="nx">_</span> <span class="o">:=</span> <span class="nx">os</span><span class="p">.</span><span class="nf">Create</span><span class="p">(</span><span class="s">&#34;profile.pprof&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nx">pprof</span><span class="p">.</span><span class="nf">StartCPUProfile</span><span class="p">(</span><span class="nx">f</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">defer</span> <span class="nx">pprof</span><span class="p">.</span><span class="nf">StopCPUProfile</span><span class="p">()</span>
</span></span></code></pre></div><p>This will start profiling when you run the command, and save the results to profile.pprof when the program exits.</p>
<p>For HTTP something like the following works,</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="line"><span class="cl"><span class="nx">f</span><span class="p">,</span> <span class="nx">_</span> <span class="o">:=</span> <span class="nx">os</span><span class="p">.</span><span class="nf">Create</span><span class="p">(</span><span class="s">&#34;profile.pprof&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nx">_</span> <span class="p">=</span> <span class="nx">pprof</span><span class="p">.</span><span class="nf">StartCPUProfile</span><span class="p">(</span><span class="nx">f</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">go</span> <span class="kd">func</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="nx">time</span><span class="p">.</span><span class="nf">Sleep</span><span class="p">(</span><span class="mi">30</span> <span class="o">*</span> <span class="nx">time</span><span class="p">.</span><span class="nx">Second</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="nx">pprof</span><span class="p">.</span><span class="nf">StopCPUProfile</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">}()</span>
</span></span></code></pre></div><p>Where it starts collecting CPU profile information for 30 seconds before saving it to disk. You can put this either inside your main function or behind a route, or even some sort of background task to collect profile information over time.</p>
<p>Memory profiles take a snapshot of the heap. I tend to use them mostly to get an idea of what is going on in long lived HTTP services.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="line"><span class="cl"><span class="nx">f</span><span class="p">,</span> <span class="nx">_</span> <span class="o">:=</span> <span class="nx">os</span><span class="p">.</span><span class="nf">Create</span><span class="p">(</span><span class="s">&#34;memprofile.pprof&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nx">_</span> <span class="p">=</span> <span class="nx">pprof</span><span class="p">.</span><span class="nf">WriteHeapProfile</span><span class="p">(</span><span class="nx">f</span><span class="p">)</span>
</span></span></code></pre></div><p>Putting the above behind a simple route dumps a snapshot of the heap to disk which I can then analyze.</p>
<p>In either case the analysis of the profile is the same,</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">go tool pprof -http<span class="o">=</span>localhost:8090 profile.pprof
</span></span></code></pre></div><p>The above will open a http server on port 8090 which you can then inspect. This is usually how I inspect profile outputs since I find the HTTP interface easy to read and I really like using flame graphs. You can find more details on the <a href="https://go.dev/blog/pprof" target="_blank" rel="noopener">go.dev website for pprof</a>.</p>
<h2 id="unit-testing">Unit Testing</h2>
<p>To run all the unit tests for your code (with caching there is no reason to not run them all anymore) you should run the following which will run all the unit tests</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">go <span class="nb">test</span> ./...
</span></span></code></pre></div><p>To run benchmarks run the below inside the directory where the benchmark is. Say you have <code>./processor/</code> inside your project with a benchmark file inside there go to that directory and run,</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">go <span class="nb">test</span> --bench .
</span></span></code></pre></div><p>To run the built in fuzz tests,</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">go <span class="nb">test</span> -fuzz .
</span></span></code></pre></div><p>To create a test file you need only create a file with <code>_test</code> as a suffix in the name. For example to create a test for a file called <code>file.go</code> you might want to call the file <code>file_test.go</code>.</p>
<p>If you want to run an individual test you can do so,</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">go <span class="nb">test</span> ./... -run NameOfTest
</span></span></code></pre></div><p>Which will attempt to any test in all packages that have the name <code>NameOfTest</code>. Keep in mind that the argument <code>NameOfTest</code> supports regular expressions so its possible to target groups of tests assuming you name them well. For general running you can use <code>.</code> which matches everything.</p>
<p>If you find yourself wanting or needing to run tests ignoring the cache you can do the following,</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="nv">GOCACHE</span><span class="o">=</span>off go <span class="nb">test</span> ./...
</span></span></code></pre></div><p>The standard practice with Go tests is to put them next to the file you are testing. However this is not actually required. So long as you can import the code (that is it is made exposed with an uppercase prefix) you can put the tests anywhere you like. This of course means you cannot test the private code which some consider an anti-pattern anyway.</p>
<p>For fuzz testing I suggest reading this guide by <a href="https://bitfieldconsulting.com/golang/fuzz-tests" target="_blank" rel="noopener">bitfield consulting</a> which covers the use of the inbuilt fuzz detector well. Note that if you search for how to fuzz test in Go you will probably run into articles about the previous first choice <a href="https://github.com/dvyukov/go-fuzz" target="_blank" rel="noopener">https://github.com/dvyukov/go-fuzz</a> so look for guides written after mid 2022.</p>
<h3 id="mocks">Mocks</h3>
<p>Generally mocking in Go is as simple as defining an interface over the things you want to mock away. However some dislike the manual approach and use tools like <a href="https://boyter.org/posts/how-to-start-go-project-2023/%28https://github.com/stretchr/testify%29" target="_blank" rel="noopener">testify</a> and <a href="https://github.com/vektra/mockery" target="_blank" rel="noopener">mockery</a> to achieve this.</p>
<p>If you are coming from a Java background, don’t bother looking for a Mockito replacement. There isn’t anything even close to it in Go. If you feel like creating one please let me know though.</p>
<p>I fall into the manual approach generally so I have no strong feelings either way on the above. In short though, stick to “Accept interfaces, return structs” as your approach to code and you should be fine. You can read about this at the following links <a href="https://medium.com/swlh/golangs-interfaces-explained-with-mocks-886f69eca6f0" target="_blank" rel="noopener">https://medium.com/swlh/golangs-interfaces-explained-with-mocks-886f69eca6f0</a> <a href="https://bryanftan.medium.com/accept-interfaces-return-structs-in-go-d4cab29a301b" target="_blank" rel="noopener">https://bryanftan.medium.com/accept-interfaces-return-structs-in-go-d4cab29a301b</a> <a href="https://tutorialedge.net/golang/accept-interfaces-return-structs/" target="_blank" rel="noopener">https://tutorialedge.net/golang/accept-interfaces-return-structs/</a></p>
<h2 id="integration-testing">Integration Testing</h2>
<p>If you end up adding integration tests inside your Go code its common practice to split them via tags. This is where you put the following at the top of your test file</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="line"><span class="cl"><span class="c1">//go:build integration
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="kn">package</span> <span class="nx">mypackage</span>
</span></span></code></pre></div><p>You can then run them</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">go <span class="nb">test</span> --tags<span class="o">=</span>integration ./...
</span></span></code></pre></div><p>This will still run the untagged tests. You can also use this to split tests into separate groups. However you do need to be careful, because by default when each group runs they run in their own context, so methods in one test group will not be available to others and cause a compile error.</p>
<h3 id="test-caching">Test Caching</h3>
<p>Test results are cached by default which might not be ideal for integration tests. Where you want to override this <code>-count=1</code> can be added to your run command to run the test 1 time ignoring the cached results. You can replace 1 with a higher value if required.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">go <span class="nb">test</span> -count<span class="o">=</span><span class="m">1</span> --tags<span class="o">=</span>integration ./...
</span></span></code></pre></div><h2 id="community">Community</h2>
<p>Your best bet to hang out with other “Gophers” is either the <a href="https://www.reddit.com/r/golang/" target="_blank" rel="noopener">subreddit</a> or <a href="https://gophers.slack.com/" target="_blank" rel="noopener">slack</a>. Of the two I find the slack to be more accommodating and nicer to deal with.</p>
<p>Twitter accounts I find useful, although some might have moved to the fediverse, but you can confirm via their profile.</p>
<ul>
<li><a href="https://twitter.com/go_perf" target="_blank" rel="noopener">https://twitter.com/go_perf</a></li>
<li><a href="https://twitter.com/golangnews" target="_blank" rel="noopener">https://twitter.com/golangnews</a></li>
<li><a href="https://twitter.com/golang_news" target="_blank" rel="noopener">https://twitter.com/golang_news</a></li>
<li><a href="https://twitter.com/golang" target="_blank" rel="noopener">https://twitter.com/golang</a></li>
<li><a href="https://twitter.com/golangweekly" target="_blank" rel="noopener">https://twitter.com/golangweekly</a></li>
<li><a href="https://twitter.com/goinggodotnet" target="_blank" rel="noopener">https://twitter.com/goinggodotnet</a></li>
<li><a href="https://twitter.com/_rsc" target="_blank" rel="noopener">https://twitter.com/_rsc</a></li>
<li><a href="https://twitter.com/bradfitz" target="_blank" rel="noopener">https://twitter.com/bradfitz</a></li>
</ul>
<p>The following newsletter is worth subscribing to as well <a href="https://golangweekly.com/" target="_blank" rel="noopener">https://golangweekly.com/</a> and is a great way to keep an eye on the latest developments.</p>
<p>The following websites/blogs tend to have quality Go content worth paying attention to</p>
<ul>
<li><a href="https://bitfieldconsulting.com/golang/" target="_blank" rel="noopener">https://bitfieldconsulting.com/golang/</a></li>
<li><a href="https://dave.cheney.net/" target="_blank" rel="noopener">https://dave.cheney.net/</a></li>
<li><a href="https://www.ardanlabs.com/categories/go-programing/" target="_blank" rel="noopener">https://www.ardanlabs.com/categories/go-programing/</a></li>
</ul>
<h2 id="multiple-main-entry-points">Multiple Main Entry Points</h2>
<p>There are times where you want to potentially have multiple entry points into an application by having multiple <code>main.go</code> files in the main package. One way to achieve this is to have shared code in one repository, and then import it into others. However this can be cumbersome when you want to use vendor imports.</p>
<p>One common pattern for this is to have a directory inside the root of the application and place your main.go files in there. For example,</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">SRC
</span></span><span class="line"><span class="cl">├── cmd
</span></span><span class="line"><span class="cl">│   ├── commandline
</span></span><span class="line"><span class="cl">│   │   └── main.go
</span></span><span class="line"><span class="cl">│   ├── webhttp
</span></span><span class="line"><span class="cl">│   │   └── main.go
</span></span><span class="line"><span class="cl">│   ├── convert1.0-2.0
</span></span><span class="line"><span class="cl">│   │   └── main.go
</span></span></code></pre></div><p>Then each entry point can import from the root package and you can compile and run multiple entry points into your application. Assuming your application lives in <code>http://github.com/name/mycode</code> you would need to import like so in each application,</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="line"><span class="cl"><span class="kn">package</span> <span class="nx">main</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">	<span class="s">&#34;github.com/name/mycode&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span></code></pre></div><p>With the above you can now call into code exposed by the repository package in the root.</p>
<h2 id="os-specific-code">OS Specific Code</h2>
<p>Occasionally you will require code in your application that will not compile or run on different operating systems. The most common way to deal with this is to have the following structure in your application,</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">main_darwin.go
</span></span><span class="line"><span class="cl">main_linux.go
</span></span><span class="line"><span class="cl">main_windows.go
</span></span></code></pre></div><p>Assuming that the above just contained definitions for line breaks on multiple operating systems EG <code>const LineBreak = &quot;\n\r&quot;</code> or <code>const LineBreak = &quot;\n&quot;</code> the you can import and refer to <code>LineBreak</code> however you wish. The same technique will work for functions or anything else you wish to include.</p>
<h2 id="docker">Docker</h2>
<p>Using the above techniques you can run inside Docker using multiple entry points easily. A sample dockerfile to achieve this is below using code from our hypothetical repository at <code>https://username@bitbucket.code.company-name.com.au/scm/code/random-code.git</code></p>
<p>The below would build and run the main application,</p>
<pre tabindex="0"><code>FROM golang:1.20

COPY ./ /go/src/bitbucket.code.company-name.com.au/scm/code/
WORKDIR /go/src/bitbucket.code.company-name.com.au/scm/code/

RUN go build main.go

CMD [&#34;./main&#34;]
</code></pre><p>The below would build and run from the one of the alternate entry point’s for the application,</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">FROM golang:1.20
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">COPY ./ /go/src/bitbucket.code.company-name.com.au/scm/code/
</span></span><span class="line"><span class="cl">WORKDIR /go/src/bitbucket.code.company-name.com.au/scm/code/cmd/webhttp/
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">RUN go build main.go
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">CMD <span class="o">[</span><span class="s2">&#34;./main&#34;</span><span class="o">]</span>
</span></span></code></pre></div><p>A few people who have read this post suggested using multi stage docker builds <a href="https://docs.docker.com/develop/develop-images/multistage-build/#use-multi-stage-builds" target="_blank" rel="noopener">https://docs.docker.com/develop/develop-images/multistage-build/#use-multi-stage-builds</a> which works well with Docker 17.05 or higher. More details here <a href="https://medium.com/travis-on-docker/multi-stage-docker-builds-for-creating-tiny-go-images-e0e1867efe5a" target="_blank" rel="noopener">https://medium.com/travis-on-docker/multi-stage-docker-builds-for-creating-tiny-go-images-e0e1867efe5a</a> An example would be,</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">FROM golang:1.20
</span></span><span class="line"><span class="cl">COPY . /go/src/bitbucket.code.company-name.com.au/scm/code
</span></span><span class="line"><span class="cl">WORKDIR /go/src/bitbucket.code.company-name.com.au/scm/code/
</span></span><span class="line"><span class="cl">RUN <span class="nv">CGO_ENABLED</span><span class="o">=</span><span class="m">0</span> go build main.go
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">FROM alpine:3.7
</span></span><span class="line"><span class="cl">RUN apk add --no-cache ca-certificates
</span></span><span class="line"><span class="cl">COPY --from<span class="o">=</span><span class="m">0</span> /go/src/bitbucket.code.company-name.com.au/scm/code/main .
</span></span><span class="line"><span class="cl">CMD <span class="o">[</span><span class="s2">&#34;./main&#34;</span><span class="o">]</span>
</span></span></code></pre></div><p>The result is much smaller images to run your code which is always nice.</p>
<h2 id="useful-toolspackages">Useful Tools/Packages</h2>
<p>A brief list of useful tools I like related to Go development, and packages that I like to use. Note that some are not written in Go.</p>
<h3 id="tools">Tools</h3>
<ul>
<li>gow <a href="https://github.com/mitranim/gow" target="_blank" rel="noopener">https://github.com/mitranim/gow</a> - A watch mode command. Run it with your arguments, and it will hot recompile under the hood for you. Very useful for HTTP development. For example <code>gow -e=go,html,css run .</code> will watch for file changes to any Go, HTML or CSS file, and if found rerun the <code>go run .</code> command giving you a hot reload.</li>
<li>hyperfine <a href="https://github.com/sharkdp/hyperfine" target="_blank" rel="noopener">https://github.com/sharkdp/hyperfine</a> - A command line benchmarking tool. Think of it as a replacement for running <code>time</code> multiple times and averaging the results.</li>
<li>dcd <a href="https://github.com/boyter/dcd" target="_blank" rel="noopener">https://github.com/boyter/dcd</a> - Duplicate code detector. My own project (so I hesitate to add it) but you can run it to find examples of duplicated code in a project. Especially useful when looking to refactor.</li>
<li>gotestsum <a href="https://github.com/gotestyourself/gotestsum" target="_blank" rel="noopener">https://github.com/gotestyourself/gotestsum</a> - Alternate test runner. Gives different test outputs with format options that you might prefer. Can produce junit output format to work with CI/CD systems.</li>
<li><a href="https://mholt.github.io/json-to-go/" target="_blank" rel="noopener">https://mholt.github.io/json-to-go/</a> - JSON to Go generator. Goland can do this for you too, but this tool works pretty well for pasting in JSON and getting back a struct that can hold it.</li>
<li>gofumpt <a href="https://github.com/mvdan/gofumpt" target="_blank" rel="noopener">https://github.com/mvdan/gofumpt</a> - A stricter formatter than gofmt. I personally have not used this, but had it suggested to me.</li>
<li><a href="https://github.com/golangci/golangci-lint" target="_blank" rel="noopener">https://github.com/golangci/golangci-lint</a> - Static type checker and lint enforcer. Apply this from day one of your project and it will save you a lot of cleanup. The suggestions it provides are always good and it helps when asked the usual sort of audit questions. Hook it into your CI/CD pipeline as a deployment gate for best results.</li>
<li>gitleaks <a href="https://github.com/gitleaks/gitleaks" target="_blank" rel="noopener">https://github.com/gitleaks/gitleaks</a> - SAST tool to find and identify checked in secrets, passwords and such. Again works well to help pass audit questions.</li>
<li>BFG Repo-Cleaner <a href="https://rtyley.github.io/bfg-repo-cleaner/" target="_blank" rel="noopener">https://rtyley.github.io/bfg-repo-cleaner/</a> - Easiest way to remove large binaries or checked in secrets from a git repository. Very useful for fixing issues gitleaks finds.</li>
</ul>
<h3 id="packages">Packages</h3>
<ul>
<li><a href="https://github.com/tidwall/gjson" target="_blank" rel="noopener">https://github.com/tidwall/gjson</a> - A quick way to get JSON values from a JSON document. Rather than deserialize into a struct you can just get the value you want. Especially useful for integration tests when running against your own endpoints. Since importing the struct you used to marshal out won’t catch regressions, using this is a decent way to write non brittle tests. <code>g := gjson.Get(resp.Body, &quot;response.someValue&quot;)</code>.</li>
<li><a href="https://github.com/rs/zerolog/" target="_blank" rel="noopener">https://github.com/rs/zerolog/</a> - Structured JSON logs. A fast way to get structured logs that make sense. My preference is to use this with a unique code <code>date | md5 | cut -c 1-8</code> allowing you to track down errors to the exact line <code>log.Error().Str(common.UniqueCode, &quot;9822f401&quot;).Err(err).Msg(&quot;&quot;)</code>. Add in context information to get the invoke details too giving you some level of observability through your logs.</li>
<li><a href="https://github.com/gorilla/mux" target="_blank" rel="noopener">https://github.com/gorilla/mux</a> - A replacement for the standard Go router which is a bit janky. Annoyingly this code is now archived. While the code has not rusted and it still works finding something that is maintained should be a priority. The following blog post has a decent over view of the potential replacements <a href="https://mariocarrion.com/2022/12/19/gorilla-mux-archived-migration-path.html" target="_blank" rel="noopener">https://mariocarrion.com/2022/12/19/gorilla-mux-archived-migration-path.html</a></li>
<li><a href="https://github.com/google/go-cmp" target="_blank" rel="noopener">https://github.com/google/go-cmp</a> - Better than <code>reflect.DeepEqual</code> for equality checks.</li>
<li><a href="https://github.com/google/uuid/" target="_blank" rel="noopener">https://github.com/google/uuid/</a> - Probably the defacto package for creating the various versions of UUID’s.</li>
</ul>

          </div>

          



          
          
          <div class="article-widget">
            
<div class="container-xl row post-nav">
  
  
</div>

          </div>
          

        <div class="body-footer">
          <p>最近更新于 0001-01-01</p>

          



          


  
  
  

  

  
  <section id="comments" class="mb-3 pt-0">
    
<div id="disqus_thread"></div>
<script>
  var disqus_config = function () {
    
    
    
  };
  (function() {
    if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
      document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
      return;
    }
    var d = document, s = d.createElement('script'); 
    s.async = true;
    s.src = 'https://' + "ngte" + '.disqus.com/embed.js';
    
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
  })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>


  </section>
  



          


        </div>

      </article>

      <footer class="site-footer">

  



  

  
  <div class="copyright py-4 bg-footer">
      <div class="row justify-content-center">
        <div class="text-center footer-color">
          <p class="mb-0">© 2017-2022 NGTE all rights reserved</p>
        </div>
    </div>
  </div>

  <script type="text/javascript" id="clstr_globe" async src="//clustrmaps.com/globe.js?d=kgpJG5sWZQpKujBmD-uW1B54-WBPol-DuDtrB2KFjKs"></script>
  
</footer>


    </main>
  </div>
</div>
<script src="//unpkg.com/heti/umd/heti-addon.min.js"></script>
<script>
  const heti = new Heti('.article');
  heti.autoSpacing();
</script>
<script type="text/javascript">
  window.$crisp = [];
  window.CRISP_WEBSITE_ID = "12adcc35-9621-4313-8262-62dc654b29d8";
  (function () {
    setTimeout(function() {
      d = document;
      s = d.createElement("script");
      s.src = "https://client.crisp.chat/l.js";
      s.async = 1;
      d.getElementsByTagName("head")[0].appendChild(s);
    }, 2500);
  })();
</script>
  </div>

  <div class="page-footer">
    
    
  </div>

      

    
    <script src="/js/vendor-bundle.min.d26509351aa0ff874abbee824e982e9b.js"></script>

    
    
    
      

      
      

      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.1/highlight.min.js" integrity="sha512-Ypjm0o7jOxAd4hpdoppSEN0TQOC19UtPAqD+4s5AlXmUvbmmS/YMxYqAqarQYyxTnB6/rqip9qcxlNB/3U9Wdg==" crossorigin="anonymous"></script>
        
        
      

    

    
    
    

    
    
    
      
      <script id="search-hit-algolia-template" type="text/html">
        <div class="search-hit">
          <div class="search-hit-content">
            <div class="search-hit-name">
              <a href="{{relpermalink}}">{{#helpers.highlight}}{ "attribute": "title" }{{/helpers.highlight}}</a>
            </div>
            <div class="article-metadata search-hit-type">{{type}}</div>
            <p class="search-hit-description">{{#helpers.highlight}}{ "attribute": "summary" }{{/helpers.highlight}}</p>
          </div>
        </div>
      </script>
      
        <script src="https://cdn.jsdelivr.net/npm/instantsearch.js@4/dist/instantsearch.production.min.js" crossorigin="anonymous"></script>
      
      
    

    
    

    
    
    
    
      <script id="dsq-count-scr" src="https://ngte.disqus.com/count.js" async></script>
      
    

    
    
      
      
      
      
      
      
      
    

    
    <script src="/zh/js/algolia-search-built.min.4387d694ca1258194aaf562b8cd1c400.js" type="module"></script>
    

    
    
    
    <script id="page-data" type="application/json">{"use_headroom":false}</script>

    
    
    
    
    
    
    
    
    
    
    <script src="/zh/js/wowchemy.min.d1673c7a11d1238516cbe12a1e84257f.js"></script>

    
    
    
    
    
    
    <script>

var mybutton = document.getElementById("backTopBtn");


window.onscroll = function() {scrollFunction()};

function scrollFunction() {
  if (document.body.scrollTop > 20 || document.documentElement.scrollTop > 20) {
    mybutton.style.display = "block";
  } else {
    mybutton.style.display = "none";
  }
}


function topFunction() {
  document.body.scrollTop = 0;
  document.documentElement.scrollTop = 0;
}
</script>


    

    
    
    <script src="https://cdn.jsdelivr.net/gh/bryanbraun/anchorjs@4.2.2/anchor.min.js" integrity="sha512-I7w3ZdSFzw5j3jU3ZkNikBNeIrl3i+hEuEdwNmqUJvwNcaBUNcijnP2gd9DtGlgVYDplfjGoD8vTNsID+lCjqg==" crossorigin="anonymous"></script>
    <script>
      anchors.add();
    </script>
    

    
    <script>



(function() {
  'use strict';

  if(!document.queryCommandSupported('copy')) {
    return;
  }

  function flashCopyMessage(el, msg) {
    el.className = "highlight-copy-btn";
    el.textContent = msg;
    setTimeout(function() {
      el.textContent = "";
      el.className = "highlight-copy-btn fa fa-copy";
    }, 1000);
  }

  function selectText(node) {
    var selection = window.getSelection();
    var range = document.createRange();
    range.selectNodeContents(node);
    selection.removeAllRanges();
    selection.addRange(range);
    return selection;
  }

  function addCopyButton(containerEl) {
    var copyBtn = document.createElement("button");
    copyBtn.className = "highlight-copy-btn fa fa-copy";
    copyBtn.textContent = "";

    var codeEl = containerEl.firstElementChild;
    copyBtn.addEventListener('click', function() {
      try {
        var selection = selectText(codeEl);
        document.execCommand('copy');
        selection.removeAllRanges();
        
        flashCopyMessage(copyBtn, '已复制')
        
      } catch(e) {
        console && console.log(e);
        flashCopyMessage(copyBtn, 'Failed :\'(')
      }
    });

    containerEl.appendChild(copyBtn);
  }

  
  var highlightBlocks = document.getElementsByClassName('highlight');
  Array.prototype.forEach.call(highlightBlocks, addCopyButton);
})();
</script>

    


</body>
</html>
