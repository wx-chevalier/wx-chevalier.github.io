<!doctype html><html lang=zh><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=generator content="Wowchemy 5.5.0 for Hugo"><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=preload as=style href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap"><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap" media=print onload='this.media="all"'><meta name=google-site-verification content="google69a5cccb61297807"><meta name=baidu-site-verification content="cqmZHEleVh"><meta name=description content="﻿# Bean Definition <?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?> <beans xmlns=&#34;http://www.springframework.org/schema/beans&#34; xmlns:xsi=&#34;http://www.w3.org/2001/XMLSchema-instance&#34; xsi:schemaLocation=&#34;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd&#34;> <!-- A simple bean definition --> <bean id=&#34;...&#34; class=&#34;...&#34;> <!-- collaborators and configuration for this bean go here --> </bean> <!-- A bean definition with lazy init set on --> <bean id=&#34;...&#34; class=&#34;...&#34; lazy-init=&#34;true&#34;> <!-- collaborators and configuration for this bean go here --> </bean> <!-- A bean definition with initialization method --> <bean id=&#34;...&#34; class=&#34;...&#34; init-method=&#34;...&#34;> <!-- collaborators and configuration for this bean go here --> </bean> <!-- A bean definition with destruction method --> <bean id=&#34;...&#34; class=&#34;...&#34; destroy-method=&#34;...&#34;> <!-- collaborators and configuration for this bean go"><link rel=alternate hreflang=zh href=https://ng-tech.icu/books/spring-series/1.%E5%9F%BA%E7%A1%80%E4%BD%BF%E7%94%A8/%E4%BE%9D%E8%B5%96%E6%B3%A8%E5%85%A5/bean/bean-%E5%A3%B0%E6%98%8E/><meta name=theme-color content="#0a55a7"><link rel=stylesheet href=/css/vendor-bundle.min.c7b8d9abd591ba2253ea42747e3ac3f5.css media=print onload='this.media="all"'><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.1/styles/github.min.css crossorigin=anonymous title=hl-light media=print onload='this.media="all"'><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.1/styles/dracula.min.css crossorigin=anonymous title=hl-dark media=print onload='this.media="all"' disabled><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/instantsearch.css@7.4.5/themes/satellite-min.css integrity="sha256-TehzF/2QvNKhGQrrNpoOb2Ck4iGZ1J/DI4pkd2oUsBc=" crossorigin=anonymous><link rel=stylesheet href=/css/wowchemy.63df6ae9fc2b4cc71b83f1774d780209.css><script async src="https://www.googletagmanager.com/gtag/js?id=G-40NYXJ8823"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-40NYXJ8823")</script><script>var _hmt=_hmt||[];(function(){var e,t=document.createElement("script");t.src="https://hm.baidu.com/hm.js?56df1177bce405601b0ecdd7208f75c6",e=document.getElementsByTagName("script")[0],e.parentNode.insertBefore(t,e)})()</script><link rel=manifest href=/manifest.webmanifest><link rel=icon type=image/png href=/media/icon_hu0f7d075e895d6f5f1f5fdbc1e33dc138_10087_32x32_fill_lanczos_center_3.png><link rel=apple-touch-icon type=image/png href=/media/icon_hu0f7d075e895d6f5f1f5fdbc1e33dc138_10087_180x180_fill_lanczos_center_3.png><link rel=canonical href=https://ng-tech.icu/books/spring-series/1.%E5%9F%BA%E7%A1%80%E4%BD%BF%E7%94%A8/%E4%BE%9D%E8%B5%96%E6%B3%A8%E5%85%A5/bean/bean-%E5%A3%B0%E6%98%8E/><meta property="twitter:card" content="summary_large_image"><meta property="twitter:site" content="@wx-chevalier"><meta property="twitter:creator" content="@wx-chevalier"><meta property="og:site_name" content="Next-gen Tech Edu"><meta property="og:url" content="https://ng-tech.icu/books/spring-series/1.%E5%9F%BA%E7%A1%80%E4%BD%BF%E7%94%A8/%E4%BE%9D%E8%B5%96%E6%B3%A8%E5%85%A5/bean/bean-%E5%A3%B0%E6%98%8E/"><meta property="og:title" content="Bean 声明 | Next-gen Tech Edu"><meta property="og:description" content="﻿# Bean Definition <?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?> <beans xmlns=&#34;http://www.springframework.org/schema/beans&#34; xmlns:xsi=&#34;http://www.w3.org/2001/XMLSchema-instance&#34; xsi:schemaLocation=&#34;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd&#34;> <!-- A simple bean definition --> <bean id=&#34;...&#34; class=&#34;...&#34;> <!-- collaborators and configuration for this bean go here --> </bean> <!-- A bean definition with lazy init set on --> <bean id=&#34;...&#34; class=&#34;...&#34; lazy-init=&#34;true&#34;> <!-- collaborators and configuration for this bean go here --> </bean> <!-- A bean definition with initialization method --> <bean id=&#34;...&#34; class=&#34;...&#34; init-method=&#34;...&#34;> <!-- collaborators and configuration for this bean go here --> </bean> <!-- A bean definition with destruction method --> <bean id=&#34;...&#34; class=&#34;...&#34; destroy-method=&#34;...&#34;> <!-- collaborators and configuration for this bean go"><meta property="og:image" content="https://ng-tech.icu/media/sharing.png"><meta property="twitter:image" content="https://ng-tech.icu/media/sharing.png"><meta property="og:locale" content="zh"><title>Bean 声明 | Next-gen Tech Edu</title></head><body id=top data-spy=scroll data-offset=70 data-target=#TableOfContents class=page-wrapper data-wc-page-id=42796e81239a0832fd91e5da3b619920><button onclick=topFunction() id=backTopBtn title="Go to top"><i class="fa-solid fa-circle-up" aria-hidden=true></i></button>
<script src=/js/wowchemy-init.min.14a0ed61c6dbd594b9c75193b25be179.js></script><aside class=search-modal id=search><div class=container><section class=search-header><div class="row no-gutters justify-content-between mb-3"><div class="col-6 search-title"><p>搜索</p></div><div class="col-6 col-search-close"><a class=js-search href=# aria-label=关闭><i class="fas fa-times-circle text-muted" aria-hidden=true></i></a></div></div><div id=search-box></div></section><section class=section-search-results><div id=search-hits></div><div id=search-common-queries></div></section></div></aside><div class=page-header><header class=header--fixed><nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id=navbar-main><div class=container-xl><div class="d-none d-lg-inline-flex"><a class=navbar-brand href=/>Next-gen Tech Edu</a></div><button type=button class=navbar-toggler data-toggle=collapse data-target=#navbar-content aria-controls=navbar-content aria-expanded=false aria-label=切换导航>
<span><i class="fas fa-bars"></i></span></button><div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none"><a class=navbar-brand href=/>Next-gen Tech Edu</a></div><div class="navbar-collapse main-menu-item collapse justify-content-start" id=navbar-content><ul class="navbar-nav d-md-inline-flex"><li class=nav-item><a class=nav-link href=/books-gallery><span>笔记（万篇）</span></a></li><li class=nav-item><a class=nav-link href=/#knowledge-map><span>知识图谱</span></a></li><style>.dropdown-item{display:inline-flex}</style><li class="nav-item dropdown"><a href=# class="nav-link dropdown-toggle" data-toggle=dropdown aria-haspopup=true><span>实验室</span><span class=caret></span></a><div class=dropdown-menu><a class=dropdown-item href=/galaxy-home/gh-craft><span>Craft 方块世界</span></a>
<a class=dropdown-item href=/galaxy-home/glossary-cards><span>3D 知识卡牌</span></a></div></li><style>.dropdown-item{display:inline-flex}</style><li class="nav-item dropdown"><a href=# class="nav-link dropdown-toggle" data-toggle=dropdown aria-haspopup=true><span>其他阅读渠道</span><span class=caret></span></a><div class=dropdown-menu><a class=dropdown-item href=https://zhuanlan.zhihu.com/wxyyxc1992><img style=width:16px;height:16px;display:inline-block;margin-right:8px src=https://ngte-superbed.oss-cn-beijing.aliyuncs.com/item/20230218234451.png></img><span>知乎</span></a>
<a class=dropdown-item href=https://segmentfault.com/blog/wxyyxc1992><img style=width:16px;height:16px;display:inline-block;margin-right:8px src=https://ngte-superbed.oss-cn-beijing.aliyuncs.com/item/20230219113556.png></img><span>SegmentFault</span></a>
<a class=dropdown-item href=https://zhuanlan.zhihu.com/wxyyxc1992><img style=width:16px;height:16px;display:inline-block;margin-right:8px src=https://ngte-superbed.oss-cn-beijing.aliyuncs.com/item/20230219113519.png></img><span>掘金</span></a></div></li></ul></div><ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2"><li class=nav-item><a class="nav-link js-search" href=# aria-label=搜索><i class="fas fa-search" aria-hidden=true></i></a></li><li class=nav-item><a class=nav-link href=https://github.com/wx-chevalier aria-label=GitHub><i class="fa-brands fa-github" aria-hidden=true></i></a></li><div></div><style>@media only screen and (max-width:600px){.jimmysong-template{display:none!important}}</style><li class=jimmysong-template style=color:#fff;font-size:12px><a href=https://jimmysong.io style=color:#fff>By Jimmy Song's Template</a></li></ul></div></nav></header></div><div class=page-body><link rel=stylesheet href=//unpkg.com/heti/umd/heti.min.css><div class="container-xl docs"><div class="row flex-xl-nowrap"><div class=docs-sidebar><form class="docs-search d-flex align-items-center"><button class="btn docs-toggle d-md-none p-0 mr-md-3 w-100" type=button data-toggle=collapse data-target=#docs-nav aria-controls=docs-nav aria-expanded=false aria-label="Toggle section navigation"><div class=d-flex><span class="d-md-none pl-1 flex-grow-1 text-left overflow-hidden">Bean</span>
<span><i class="fas fa-chevron-down"></i></span></div></button>
<button class="form-control sidebar-search js-search d-none d-md-flex">
<i class="fas fa-search pr-2"></i>
<span class=sidebar-search-text>搜索...</span>
<span class=sidebar-search-shortcut>/</span></button></form><nav class="collapse docs-links" id=docs-nav><ul class="nav docs-sidenav"><li style=display:inline-flex><a style=cursor:pointer onclick=window.history.back()><i class="fas fa-arrow-left pr-1"></i>
Back</a>
<span>|</span>
<a href=/books/><i class="fa-solid fa-house" style=margin-right:4px></i>
Books</a></li></ul><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-id4951dce8246a735d9d68869b8622b530")' href=#id4951dce8246a735d9d68869b8622b530 aria-expanded=false aria-controls=id4951dce8246a735d9d68869b8622b530 aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/spring-series/1.%E5%9F%BA%E7%A1%80%E4%BD%BF%E7%94%A8/%E4%BE%9D%E8%B5%96%E6%B3%A8%E5%85%A5/>依赖注入</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#id4951dce8246a735d9d68869b8622b530 aria-expanded=false aria-controls=id4951dce8246a735d9d68869b8622b530><i class="fa-solid fa-angle-down" id=caret-id4951dce8246a735d9d68869b8622b530></i></a></div><ul class="nav docs-sidenav collapse show" id=id4951dce8246a735d9d68869b8622b530><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-idc438efc3bb57673a9fe879f8691d77ab")' href=#idc438efc3bb57673a9fe879f8691d77ab aria-expanded=false aria-controls=idc438efc3bb57673a9fe879f8691d77ab aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/spring-series/1.%E5%9F%BA%E7%A1%80%E4%BD%BF%E7%94%A8/%E4%BE%9D%E8%B5%96%E6%B3%A8%E5%85%A5/bean/>Bean</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#idc438efc3bb57673a9fe879f8691d77ab aria-expanded=false aria-controls=idc438efc3bb57673a9fe879f8691d77ab><i class="fa-solid fa-angle-down" id=caret-idc438efc3bb57673a9fe879f8691d77ab></i></a></div><ul class="nav docs-sidenav collapse show" id=idc438efc3bb57673a9fe879f8691d77ab><li class="child level"><a href=/books/spring-series/1.%E5%9F%BA%E7%A1%80%E4%BD%BF%E7%94%A8/%E4%BE%9D%E8%B5%96%E6%B3%A8%E5%85%A5/bean/bean-%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/>Bean 生命周期</a></li><li class="child level active"><a href=/books/spring-series/1.%E5%9F%BA%E7%A1%80%E4%BD%BF%E7%94%A8/%E4%BE%9D%E8%B5%96%E6%B3%A8%E5%85%A5/bean/bean-%E5%A3%B0%E6%98%8E/>Bean 声明</a></li><li class="child level"><a href=/books/spring-series/1.%E5%9F%BA%E7%A1%80%E4%BD%BF%E7%94%A8/%E4%BE%9D%E8%B5%96%E6%B3%A8%E5%85%A5/bean/bean-%E6%B3%A8%E5%85%A5/>Bean 注入</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-ide17105ac1ee7997074f7780cd43b56be")' href=#ide17105ac1ee7997074f7780cd43b56be aria-expanded=false aria-controls=ide17105ac1ee7997074f7780cd43b56be aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/spring-series/1.%E5%9F%BA%E7%A1%80%E4%BD%BF%E7%94%A8/%E4%BE%9D%E8%B5%96%E6%B3%A8%E5%85%A5/%E5%8F%82%E6%95%B0%E9%85%8D%E7%BD%AE/>参数配置</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#ide17105ac1ee7997074f7780cd43b56be aria-expanded=false aria-controls=ide17105ac1ee7997074f7780cd43b56be><i class="fa-solid fa-angle-right" id=caret-ide17105ac1ee7997074f7780cd43b56be></i></a></div><ul class="nav docs-sidenav collapse" id=ide17105ac1ee7997074f7780cd43b56be><li class="child level"><a href=/books/spring-series/1.%E5%9F%BA%E7%A1%80%E4%BD%BF%E7%94%A8/%E4%BE%9D%E8%B5%96%E6%B3%A8%E5%85%A5/%E5%8F%82%E6%95%B0%E9%85%8D%E7%BD%AE/%E5%A4%9A%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/>多环境配置</a></li><li class="child level"><a href=/books/spring-series/1.%E5%9F%BA%E7%A1%80%E4%BD%BF%E7%94%A8/%E4%BE%9D%E8%B5%96%E6%B3%A8%E5%85%A5/%E5%8F%82%E6%95%B0%E9%85%8D%E7%BD%AE/%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6/>配置文件</a></li><li class="child level"><a href=/books/spring-series/1.%E5%9F%BA%E7%A1%80%E4%BD%BF%E7%94%A8/%E4%BE%9D%E8%B5%96%E6%B3%A8%E5%85%A5/%E5%8F%82%E6%95%B0%E9%85%8D%E7%BD%AE/%E9%85%8D%E7%BD%AE%E5%BC%95%E7%94%A8/>配置引用</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-id0706c54f1ff6a47aa1a9a15c1ed04053")' href=#id0706c54f1ff6a47aa1a9a15c1ed04053 aria-expanded=false aria-controls=id0706c54f1ff6a47aa1a9a15c1ed04053 aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/spring-series/1.%E5%9F%BA%E7%A1%80%E4%BD%BF%E7%94%A8/%E4%BE%9D%E8%B5%96%E6%B3%A8%E5%85%A5/%E4%BE%9D%E8%B5%96%E6%9C%BA%E5%88%B6/>依赖机制</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#id0706c54f1ff6a47aa1a9a15c1ed04053 aria-expanded=false aria-controls=id0706c54f1ff6a47aa1a9a15c1ed04053><i class="fa-solid fa-angle-right" id=caret-id0706c54f1ff6a47aa1a9a15c1ed04053></i></a></div><ul class="nav docs-sidenav collapse" id=id0706c54f1ff6a47aa1a9a15c1ed04053><li class="child level"><a href=/books/spring-series/1.%E5%9F%BA%E7%A1%80%E4%BD%BF%E7%94%A8/%E4%BE%9D%E8%B5%96%E6%B3%A8%E5%85%A5/%E4%BE%9D%E8%B5%96%E6%9C%BA%E5%88%B6/jar-%E5%8A%A0%E8%BD%BD/>Jar 加载</a></li><li class="child level"><a href=/books/spring-series/1.%E5%9F%BA%E7%A1%80%E4%BD%BF%E7%94%A8/%E4%BE%9D%E8%B5%96%E6%B3%A8%E5%85%A5/%E4%BE%9D%E8%B5%96%E6%9C%BA%E5%88%B6/scopedproxymode/>ScopedProxyMode</a></li><li class="child level"><a href=/books/spring-series/1.%E5%9F%BA%E7%A1%80%E4%BD%BF%E7%94%A8/%E4%BE%9D%E8%B5%96%E6%B3%A8%E5%85%A5/%E4%BE%9D%E8%B5%96%E6%9C%BA%E5%88%B6/%E5%90%AF%E5%8A%A8%E6%B5%81%E7%A8%8B/>启动流程</a></li><li class="child level"><a href=/books/spring-series/1.%E5%9F%BA%E7%A1%80%E4%BD%BF%E7%94%A8/%E4%BE%9D%E8%B5%96%E6%B3%A8%E5%85%A5/%E4%BE%9D%E8%B5%96%E6%9C%BA%E5%88%B6/%E5%BE%AA%E7%8E%AF%E4%BE%9D%E8%B5%96/>循环依赖</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-idb644fdd6ec5fa01cdccf204bfbf976fc")' href=#idb644fdd6ec5fa01cdccf204bfbf976fc aria-expanded=false aria-controls=idb644fdd6ec5fa01cdccf204bfbf976fc aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/spring-series/1.%E5%9F%BA%E7%A1%80%E4%BD%BF%E7%94%A8/%E4%BE%9D%E8%B5%96%E6%B3%A8%E5%85%A5/%E5%BA%94%E7%94%A8%E4%B8%8A%E4%B8%8B%E6%96%87/>应用上下文</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#idb644fdd6ec5fa01cdccf204bfbf976fc aria-expanded=false aria-controls=idb644fdd6ec5fa01cdccf204bfbf976fc><i class="fa-solid fa-angle-right" id=caret-idb644fdd6ec5fa01cdccf204bfbf976fc></i></a></div><ul class="nav docs-sidenav collapse" id=idb644fdd6ec5fa01cdccf204bfbf976fc><li class="child level"><a href=/books/spring-series/1.%E5%9F%BA%E7%A1%80%E4%BD%BF%E7%94%A8/%E4%BE%9D%E8%B5%96%E6%B3%A8%E5%85%A5/%E5%BA%94%E7%94%A8%E4%B8%8A%E4%B8%8B%E6%96%87/spring-runner/>Spring Runner</a></li><li class="child level"><a href=/books/spring-series/1.%E5%9F%BA%E7%A1%80%E4%BD%BF%E7%94%A8/%E4%BE%9D%E8%B5%96%E6%B3%A8%E5%85%A5/%E5%BA%94%E7%94%A8%E4%B8%8A%E4%B8%8B%E6%96%87/%E8%87%AA%E5%8A%A8%E9%85%8D%E7%BD%AE/>自动配置</a></li></ul></div></ul></div></nav></div><div class="d-none d-xl-block col-xl-2 docs-toc"><ul class="nav toc-top"><li><a href=# id=back_to_top class=docs-toc-title>目录</a></li></ul><nav id=TableOfContents><ul><li><a href=#definition>Definition</a><ul><li><a href=#instantiationbean-定义与初始化>Instantiation:Bean 定义与初始化</a></li><li><a href=#definition-inheritance定义继承>Definition Inheritance(定义继承)</a></li></ul></li><li><a href=#scope作用域>Scope(作用域)</a><ul><li><a href=#singleton单例>Singleton(单例)</a></li><li><a href=#prototype>Prototype</a></li></ul></li><li><a href=#lifecycle>LifeCycle</a><ul><li><a href=#postconstruct-和predestory>@PostConstruct 和@PreDestory</a></li><li><a href=#initializingbeandisposablebean>InitializingBean,DisposableBean</a></li></ul></li></ul><ul><li><a href=#configuration配置>Configuration(配置)</a><ul><li><a href=#xml-based>XML-Based</a></li><li><a href=#annotation-based>Annotation-Based</a></li><li><a href=#java-based>Java-Based</a></li></ul></li><li><a href=#instantiating加载>Instantiating(加载)</a><ul><li><a href=#configurableapplicationcontext>ConfigurableApplicationContext</a></li><li><a href=#annotationconfigapplicationcontext>AnnotationConfigApplicationContext</a></li></ul></li></ul><ul><li><ul><li><a href=#constructor-based-dependency-injectionhttpwwwtutorialspointcomspringconstructor_based_dependency_injectionhtm><a href=http://www.tutorialspoint.com/spring/constructor_based_dependency_injection.htm>Constructor-based dependency injection</a></a></li><li><a href=#setter-based-dependency-injectionhttpwwwtutorialspointcomspringsetter_based_dependency_injectionhtm><a href=http://www.tutorialspoint.com/spring/setter_based_dependency_injection.htm>Setter-based dependency injection</a></a></li><li><a href=#autowiring>Autowiring</a></li></ul></li></ul></nav><div class="subscribe-module col-24 mt-1"><img src=https://ngte-superbed.oss-cn-beijing.aliyuncs.com/item/20230220172727.png alt=image title=王下邀月熊的微信公众号></div></div><main class="py-md-3 pl-md-3 docs-content col-xl-8" role=main><article class=article><h1>Bean 声明</h1><div class=article-style><p>﻿# Bean</p><h2 id=definition>Definition</h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=cp>&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nt>&lt;beans</span> <span class=na>xmlns=</span><span class=s>&#34;http://www.springframework.org/schema/beans&#34;</span>
</span></span><span class=line><span class=cl>    <span class=na>xmlns:xsi=</span><span class=s>&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span>
</span></span><span class=line><span class=cl>    <span class=na>xsi:schemaLocation=</span><span class=s>&#34;http://www.springframework.org/schema/beans
</span></span></span><span class=line><span class=cl><span class=s>    http://www.springframework.org/schema/beans/spring-beans-3.0.xsd&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>   <span class=c>&lt;!-- A simple bean definition --&gt;</span>
</span></span><span class=line><span class=cl>   <span class=nt>&lt;bean</span> <span class=na>id=</span><span class=s>&#34;...&#34;</span> <span class=na>class=</span><span class=s>&#34;...&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>       <span class=c>&lt;!-- collaborators and configuration for this bean go here --&gt;</span>
</span></span><span class=line><span class=cl>   <span class=nt>&lt;/bean&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>   <span class=c>&lt;!-- A bean definition with lazy init set on --&gt;</span>
</span></span><span class=line><span class=cl>   <span class=nt>&lt;bean</span> <span class=na>id=</span><span class=s>&#34;...&#34;</span> <span class=na>class=</span><span class=s>&#34;...&#34;</span> <span class=na>lazy-init=</span><span class=s>&#34;true&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>       <span class=c>&lt;!-- collaborators and configuration for this bean go here --&gt;</span>
</span></span><span class=line><span class=cl>   <span class=nt>&lt;/bean&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>   <span class=c>&lt;!-- A bean definition with initialization method --&gt;</span>
</span></span><span class=line><span class=cl>   <span class=nt>&lt;bean</span> <span class=na>id=</span><span class=s>&#34;...&#34;</span> <span class=na>class=</span><span class=s>&#34;...&#34;</span> <span class=na>init-method=</span><span class=s>&#34;...&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>       <span class=c>&lt;!-- collaborators and configuration for this bean go here --&gt;</span>
</span></span><span class=line><span class=cl>   <span class=nt>&lt;/bean&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>   <span class=c>&lt;!-- A bean definition with destruction method --&gt;</span>
</span></span><span class=line><span class=cl>   <span class=nt>&lt;bean</span> <span class=na>id=</span><span class=s>&#34;...&#34;</span> <span class=na>class=</span><span class=s>&#34;...&#34;</span> <span class=na>destroy-method=</span><span class=s>&#34;...&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>       <span class=c>&lt;!-- collaborators and configuration for this bean go here --&gt;</span>
</span></span><span class=line><span class=cl>   <span class=nt>&lt;/bean&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>   <span class=c>&lt;!-- more bean definitions go here --&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nt>&lt;/beans&gt;</span>
</span></span></code></pre></div><h3 id=instantiationbean-定义与初始化>Instantiation:Bean 定义与初始化</h3><h4 id=constructor构造函数法>Constructor:构造函数法</h4><pre tabindex=0><code>&lt;bean id=&#34;exampleBean&#34; class=&#34;examples.ExampleBean&#34;/&gt;

&lt;bean name=&#34;anotherExample&#34; class=&#34;examples.ExampleBeanTwo&#34;/&gt;
</code></pre><h4 id=static-factory-method>Static Factory Method</h4><pre tabindex=0><code>&lt;bean id=&#34;clientService&#34;
    class=&#34;examples.ClientService&#34;
    factory-method=&#34;createInstance&#34;/&gt;
</code></pre><pre tabindex=0><code>public class ClientService {
    private static ClientService clientService = new ClientService();
    private ClientService() {}

    public static ClientService createInstance() {
        return clientService;
    }
}
</code></pre><h4 id=instance-factory-method实例工厂方法>Instance Factory Method:实例工厂方法</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=c>&lt;!-- the factory bean, which contains a method called createInstance() --&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;bean</span> <span class=na>id=</span><span class=s>&#34;serviceLocator&#34;</span> <span class=na>class=</span><span class=s>&#34;examples.DefaultServiceLocator&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=c>&lt;!-- inject any dependencies required by this locator bean --&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/bean&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c>&lt;!-- the bean to be created via the factory bean --&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;bean</span> <span class=na>id=</span><span class=s>&#34;clientService&#34;</span>
</span></span><span class=line><span class=cl>    <span class=na>factory-bean=</span><span class=s>&#34;serviceLocator&#34;</span>
</span></span><span class=line><span class=cl>    <span class=na>factory-method=</span><span class=s>&#34;createClientServiceInstance&#34;</span><span class=nt>/&gt;</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>DefaultServiceLocator</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kd>static</span> <span class=n>ClientService</span> <span class=n>clientService</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ClientServiceImpl</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=nf>DefaultServiceLocator</span><span class=o>()</span> <span class=o>{}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>ClientService</span> <span class=nf>createClientServiceInstance</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>clientService</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>当然，实例工厂方法也可以在一个工厂类中提供多个方法：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;bean</span> <span class=na>id=</span><span class=s>&#34;serviceLocator&#34;</span> <span class=na>class=</span><span class=s>&#34;examples.DefaultServiceLocator&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=c>&lt;!-- inject any dependencies required by this locator bean --&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/bean&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nt>&lt;bean</span> <span class=na>id=</span><span class=s>&#34;clientService&#34;</span>
</span></span><span class=line><span class=cl>    <span class=na>factory-bean=</span><span class=s>&#34;serviceLocator&#34;</span>
</span></span><span class=line><span class=cl>    <span class=na>factory-method=</span><span class=s>&#34;createClientServiceInstance&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nt>&lt;bean</span> <span class=na>id=</span><span class=s>&#34;accountService&#34;</span>
</span></span><span class=line><span class=cl>    <span class=na>factory-bean=</span><span class=s>&#34;serviceLocator&#34;</span>
</span></span><span class=line><span class=cl>    <span class=na>factory-method=</span><span class=s>&#34;createAccountServiceInstance&#34;</span><span class=nt>/&gt;</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>DefaultServiceLocator</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kd>static</span> <span class=n>ClientService</span> <span class=n>clientService</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ClientServiceImpl</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kd>static</span> <span class=n>AccountService</span> <span class=n>accountService</span> <span class=o>=</span> <span class=k>new</span> <span class=n>AccountServiceImpl</span><span class=o>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=nf>DefaultServiceLocator</span><span class=o>()</span> <span class=o>{}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>ClientService</span> <span class=nf>createClientServiceInstance</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>clientService</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>AccountService</span> <span class=nf>createAccountServiceInstance</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>accountService</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>一般来说，如果完全用注解方式来定义 Bean，可以用 Configuration 方式来定义一系列的 Bean，譬如:</p><pre tabindex=0><code>@Configuration
public class TestConfig {

@Bean
public HessianProxyFactoryBean helloClient() {
HessianProxyFactoryBean factory = new HessianProxyFactoryBean();
factory.setServiceUrl(&#34;http://localhost:8181/HelloService&#34;);
factory.setServiceInterface(HelloService.class);
return factory;
}
}
</code></pre><p>这里用 Configuration 进行注解之后，其中注解为@Bean 的方法就可以自动地变为了实例工厂方法。</p><h3 id=definition-inheritance定义继承>Definition Inheritance(定义继承)</h3><p>类似于 Java 中的抽象类或者接口，在 Spring 中定义 Bean 时也支持继承，最简单的示例如下所示：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=cp>&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nt>&lt;beans</span> <span class=na>xmlns=</span><span class=s>&#34;http://www.springframework.org/schema/beans&#34;</span>
</span></span><span class=line><span class=cl>    <span class=na>xmlns:xsi=</span><span class=s>&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span>
</span></span><span class=line><span class=cl>    <span class=na>xsi:schemaLocation=</span><span class=s>&#34;http://www.springframework.org/schema/beans
</span></span></span><span class=line><span class=cl><span class=s>    http://www.springframework.org/schema/beans/spring-beans-3.0.xsd&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>   <span class=nt>&lt;bean</span> <span class=na>id=</span><span class=s>&#34;helloWorld&#34;</span> <span class=na>class=</span><span class=s>&#34;com.tutorialspoint.HelloWorld&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=nt>&lt;property</span> <span class=na>name=</span><span class=s>&#34;message1&#34;</span> <span class=na>value=</span><span class=s>&#34;Hello World!&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>      <span class=nt>&lt;property</span> <span class=na>name=</span><span class=s>&#34;message2&#34;</span> <span class=na>value=</span><span class=s>&#34;Hello Second World!&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>   <span class=nt>&lt;/bean&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>   <span class=nt>&lt;bean</span> <span class=na>id=</span><span class=s>&#34;helloIndia&#34;</span> <span class=na>class=</span><span class=s>&#34;com.tutorialspoint.HelloIndia&#34;</span> <span class=na>parent=</span><span class=s>&#34;helloWorld&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=nt>&lt;property</span> <span class=na>name=</span><span class=s>&#34;message1&#34;</span> <span class=na>value=</span><span class=s>&#34;Hello India!&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>      <span class=nt>&lt;property</span> <span class=na>name=</span><span class=s>&#34;message3&#34;</span> <span class=na>value=</span><span class=s>&#34;Namaste India!&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>   <span class=nt>&lt;/bean&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nt>&lt;/beans&gt;</span>
</span></span></code></pre></div><p>对应的 HelloWorld.java 文件定义如下：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kn>package</span> <span class=nn>com.tutorialspoint</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>HelloWorld</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>   <span class=kd>private</span> <span class=n>String</span> <span class=n>message1</span><span class=o>;</span>
</span></span><span class=line><span class=cl>   <span class=kd>private</span> <span class=n>String</span> <span class=n>message2</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>   <span class=kd>public</span> <span class=kt>void</span> <span class=nf>setMessage1</span><span class=o>(</span><span class=n>String</span> <span class=n>message</span><span class=o>){</span>
</span></span><span class=line><span class=cl>      <span class=k>this</span><span class=o>.</span><span class=na>message1</span>  <span class=o>=</span> <span class=n>message</span><span class=o>;</span>
</span></span><span class=line><span class=cl>   <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>   <span class=kd>public</span> <span class=kt>void</span> <span class=nf>setMessage2</span><span class=o>(</span><span class=n>String</span> <span class=n>message</span><span class=o>){</span>
</span></span><span class=line><span class=cl>      <span class=k>this</span><span class=o>.</span><span class=na>message2</span>  <span class=o>=</span> <span class=n>message</span><span class=o>;</span>
</span></span><span class=line><span class=cl>   <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>   <span class=kd>public</span> <span class=kt>void</span> <span class=nf>getMessage1</span><span class=o>(){</span>
</span></span><span class=line><span class=cl>      <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;World Message1 : &#34;</span> <span class=o>+</span> <span class=n>message1</span><span class=o>);</span>
</span></span><span class=line><span class=cl>   <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>   <span class=kd>public</span> <span class=kt>void</span> <span class=nf>getMessage2</span><span class=o>(){</span>
</span></span><span class=line><span class=cl>      <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;World Message2 : &#34;</span> <span class=o>+</span> <span class=n>message2</span><span class=o>);</span>
</span></span><span class=line><span class=cl>   <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>HelloIndia.java 文件为：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kn>package</span> <span class=nn>com.tutorialspoint</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>HelloIndia</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>   <span class=kd>private</span> <span class=n>String</span> <span class=n>message1</span><span class=o>;</span>
</span></span><span class=line><span class=cl>   <span class=kd>private</span> <span class=n>String</span> <span class=n>message2</span><span class=o>;</span>
</span></span><span class=line><span class=cl>   <span class=kd>private</span> <span class=n>String</span> <span class=n>message3</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>   <span class=kd>public</span> <span class=kt>void</span> <span class=nf>setMessage1</span><span class=o>(</span><span class=n>String</span> <span class=n>message</span><span class=o>){</span>
</span></span><span class=line><span class=cl>      <span class=k>this</span><span class=o>.</span><span class=na>message1</span>  <span class=o>=</span> <span class=n>message</span><span class=o>;</span>
</span></span><span class=line><span class=cl>   <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>   <span class=kd>public</span> <span class=kt>void</span> <span class=nf>setMessage2</span><span class=o>(</span><span class=n>String</span> <span class=n>message</span><span class=o>){</span>
</span></span><span class=line><span class=cl>      <span class=k>this</span><span class=o>.</span><span class=na>message2</span>  <span class=o>=</span> <span class=n>message</span><span class=o>;</span>
</span></span><span class=line><span class=cl>   <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>   <span class=kd>public</span> <span class=kt>void</span> <span class=nf>setMessage3</span><span class=o>(</span><span class=n>String</span> <span class=n>message</span><span class=o>){</span>
</span></span><span class=line><span class=cl>      <span class=k>this</span><span class=o>.</span><span class=na>message3</span>  <span class=o>=</span> <span class=n>message</span><span class=o>;</span>
</span></span><span class=line><span class=cl>   <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>   <span class=kd>public</span> <span class=kt>void</span> <span class=nf>getMessage1</span><span class=o>(){</span>
</span></span><span class=line><span class=cl>      <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;India Message1 : &#34;</span> <span class=o>+</span> <span class=n>message1</span><span class=o>);</span>
</span></span><span class=line><span class=cl>   <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>   <span class=kd>public</span> <span class=kt>void</span> <span class=nf>getMessage2</span><span class=o>(){</span>
</span></span><span class=line><span class=cl>      <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;India Message2 : &#34;</span> <span class=o>+</span> <span class=n>message2</span><span class=o>);</span>
</span></span><span class=line><span class=cl>   <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>   <span class=kd>public</span> <span class=kt>void</span> <span class=nf>getMessage3</span><span class=o>(){</span>
</span></span><span class=line><span class=cl>      <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;India Message3 : &#34;</span> <span class=o>+</span> <span class=n>message3</span><span class=o>);</span>
</span></span><span class=line><span class=cl>   <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>而主应用文件定义如下：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kn>package</span> <span class=nn>com.tutorialspoint</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>org.springframework.context.ApplicationContext</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>org.springframework.context.support.ClassPathXmlApplicationContext</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>MainApp</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>   <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>      <span class=n>ApplicationContext</span> <span class=n>context</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ClassPathXmlApplicationContext</span><span class=o>(</span><span class=s>&#34;Beans.xml&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      <span class=n>HelloWorld</span> <span class=n>objA</span> <span class=o>=</span> <span class=o>(</span><span class=n>HelloWorld</span><span class=o>)</span> <span class=n>context</span><span class=o>.</span><span class=na>getBean</span><span class=o>(</span><span class=s>&#34;helloWorld&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      <span class=n>objA</span><span class=o>.</span><span class=na>getMessage1</span><span class=o>();</span>
</span></span><span class=line><span class=cl>      <span class=n>objA</span><span class=o>.</span><span class=na>getMessage2</span><span class=o>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      <span class=n>HelloIndia</span> <span class=n>objB</span> <span class=o>=</span> <span class=o>(</span><span class=n>HelloIndia</span><span class=o>)</span> <span class=n>context</span><span class=o>.</span><span class=na>getBean</span><span class=o>(</span><span class=s>&#34;helloIndia&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>      <span class=n>objB</span><span class=o>.</span><span class=na>getMessage1</span><span class=o>();</span>
</span></span><span class=line><span class=cl>      <span class=n>objB</span><span class=o>.</span><span class=na>getMessage2</span><span class=o>();</span>
</span></span><span class=line><span class=cl>      <span class=n>objB</span><span class=o>.</span><span class=na>getMessage3</span><span class=o>();</span>
</span></span><span class=line><span class=cl>   <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>运行结果如下所示：</p><pre tabindex=0><code>World Message1 : Hello World!
World Message2 : Hello Second World!
India Message1 : Hello India!
India Message2 : Hello Second World!
India Message3 : Namaste India!
</code></pre><h4 id=bean-definition-template>Bean Definition Template</h4><p>有时候可以创建一个抽象的 Bean 定义的模板以方便被其他的 Bean 定义时候使用。在定义模板时，并不需要指定一个类属性而只需要指定为抽象即可。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=cp>&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nt>&lt;beans</span> <span class=na>xmlns=</span><span class=s>&#34;http://www.springframework.org/schema/beans&#34;</span>
</span></span><span class=line><span class=cl>    <span class=na>xmlns:xsi=</span><span class=s>&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span>
</span></span><span class=line><span class=cl>    <span class=na>xsi:schemaLocation=</span><span class=s>&#34;http://www.springframework.org/schema/beans
</span></span></span><span class=line><span class=cl><span class=s>    http://www.springframework.org/schema/beans/spring-beans-3.0.xsd&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>   <span class=nt>&lt;bean</span> <span class=na>id=</span><span class=s>&#34;beanTeamplate&#34;</span> <span class=na>abstract=</span><span class=s>&#34;true&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=nt>&lt;property</span> <span class=na>name=</span><span class=s>&#34;message1&#34;</span> <span class=na>value=</span><span class=s>&#34;Hello World!&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>      <span class=nt>&lt;property</span> <span class=na>name=</span><span class=s>&#34;message2&#34;</span> <span class=na>value=</span><span class=s>&#34;Hello Second World!&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>      <span class=nt>&lt;property</span> <span class=na>name=</span><span class=s>&#34;message3&#34;</span> <span class=na>value=</span><span class=s>&#34;Namaste India!&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>   <span class=nt>&lt;/bean&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>   <span class=nt>&lt;bean</span> <span class=na>id=</span><span class=s>&#34;helloIndia&#34;</span> <span class=na>class=</span><span class=s>&#34;com.tutorialspoint.HelloIndia&#34;</span> <span class=na>parent=</span><span class=s>&#34;beanTeamplate&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=nt>&lt;property</span> <span class=na>name=</span><span class=s>&#34;message1&#34;</span> <span class=na>value=</span><span class=s>&#34;Hello India!&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>      <span class=nt>&lt;property</span> <span class=na>name=</span><span class=s>&#34;message3&#34;</span> <span class=na>value=</span><span class=s>&#34;Namaste India!&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>   <span class=nt>&lt;/bean&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nt>&lt;/beans&gt;</span>
</span></span></code></pre></div><h2 id=scope作用域>Scope(作用域)</h2><p>Spring 框架中主要的作用域为如下五种，其中三种只能用在基于 Web 的 ApplicationContext 中：</p><table><thead><tr><th>Scope</th><th>Description</th></tr></thead><tbody><tr><td>singleton</td><td>This scopes the bean definition to a single instance per Spring IoC container (default).</td></tr><tr><td>prototype</td><td>This scopes a single bean definition to have any number of object instances.</td></tr><tr><td>request</td><td>This scopes a bean definition to an HTTP request. Only valid in the context of a web-aware Spring ApplicationContext.</td></tr><tr><td>session</td><td>This scopes a bean definition to an HTTP session. Only valid in the context of a web-aware Spring ApplicationContext.</td></tr></tbody></table><p>| global-session | This scopes a bean definition to a global HTTP session. Only valid in the context of a web-aware Spring ApplicationContext. |</p><p>最常用的作用域就是 Prototype 与 Singleton，原型作用域下 Spring IoC 容器会在每次使用该对象的时候动态创建一个新的 Bean 实例，而如果设置为了单例模式，那么整个生命周期中都只会生成一个对象实例。一般来说对于无状态的 Bean 是建议生成单例作用域，而对于有状态的 Bean 是原型作用域。</p><h3 id=singleton单例>Singleton(单例)</h3><ul><li>声明单例</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=cp>&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nt>&lt;beans</span> <span class=na>xmlns=</span><span class=s>&#34;http://www.springframework.org/schema/beans&#34;</span>
</span></span><span class=line><span class=cl>    <span class=na>xmlns:xsi=</span><span class=s>&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span>
</span></span><span class=line><span class=cl>    <span class=na>xsi:schemaLocation=</span><span class=s>&#34;http://www.springframework.org/schema/beans
</span></span></span><span class=line><span class=cl><span class=s>    http://www.springframework.org/schema/beans/spring-beans-3.0.xsd&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>   <span class=nt>&lt;bean</span> <span class=na>id=</span><span class=s>&#34;helloWorld&#34;</span> <span class=na>class=</span><span class=s>&#34;com.tutorialspoint.HelloWorld&#34;</span>
</span></span><span class=line><span class=cl>      <span class=na>scope=</span><span class=s>&#34;singleton&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>   <span class=nt>&lt;/bean&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nt>&lt;/beans&gt;</span>
</span></span></code></pre></div><ul><li>创建 Java 文件</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kn>package</span> <span class=nn>com.tutorialspoint</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=c1>//@Component //也可以在这里用注解声明，默认就是单例作用域
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>public</span> <span class=kd>class</span> <span class=nc>HelloWorld</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>   <span class=kd>private</span> <span class=n>String</span> <span class=n>message</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>   <span class=kd>public</span> <span class=kt>void</span> <span class=nf>setMessage</span><span class=o>(</span><span class=n>String</span> <span class=n>message</span><span class=o>){</span>
</span></span><span class=line><span class=cl>      <span class=k>this</span><span class=o>.</span><span class=na>message</span>  <span class=o>=</span> <span class=n>message</span><span class=o>;</span>
</span></span><span class=line><span class=cl>   <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>   <span class=kd>public</span> <span class=kt>void</span> <span class=nf>getMessage</span><span class=o>(){</span>
</span></span><span class=line><span class=cl>      <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;Your Message : &#34;</span> <span class=o>+</span> <span class=n>message</span><span class=o>);</span>
</span></span><span class=line><span class=cl>   <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><ul><li>创建全局容器</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kn>package</span> <span class=nn>com.tutorialspoint</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>org.springframework.context.ApplicationContext</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>org.springframework.context.support.ClassPathXmlApplicationContext</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>MainApp</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>   <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>      <span class=n>ApplicationContext</span> <span class=n>context</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ClassPathXmlApplicationContext</span><span class=o>(</span><span class=s>&#34;Beans.xml&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      <span class=n>HelloWorld</span> <span class=n>objA</span> <span class=o>=</span> <span class=o>(</span><span class=n>HelloWorld</span><span class=o>)</span> <span class=n>context</span><span class=o>.</span><span class=na>getBean</span><span class=o>(</span><span class=s>&#34;helloWorld&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      <span class=n>objA</span><span class=o>.</span><span class=na>setMessage</span><span class=o>(</span><span class=s>&#34;I&#39;m object A&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>      <span class=n>objA</span><span class=o>.</span><span class=na>getMessage</span><span class=o>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      <span class=n>HelloWorld</span> <span class=n>objB</span> <span class=o>=</span> <span class=o>(</span><span class=n>HelloWorld</span><span class=o>)</span> <span class=n>context</span><span class=o>.</span><span class=na>getBean</span><span class=o>(</span><span class=s>&#34;helloWorld&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>      <span class=n>objB</span><span class=o>.</span><span class=na>getMessage</span><span class=o>();</span>
</span></span><span class=line><span class=cl>   <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>运行上述代码后，可以得到如下结果：</p><pre tabindex=0><code>Your Message : I&#39;m object A
Your Message : I&#39;m object A
</code></pre><p>如果你信不过 Spring IoC 或者需要一些额外的操作，那么可以用如下方式手动创建：</p><pre tabindex=0><code>@Service
public class Singleton {

private static AtomicReference&lt;Singleton&gt; INSTANCE = new AtomicReference&lt;Singleton&gt;();

public Singleton() {
final Singleton previous = INSTANCE.getAndSet(this);
if(previous != null)
throw new IllegalStateException(&#34;Second singleton &#34; + this + &#34; created after &#34; + previous);
}

public static Singleton getInstance() {
return INSTANCE.get();
}

}
</code></pre><h3 id=prototype>Prototype</h3><ul><li>Java Class</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kn>package</span> <span class=nn>com.tutorialspoint</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>HelloWorld</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>   <span class=kd>private</span> <span class=n>String</span> <span class=n>message</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>   <span class=kd>public</span> <span class=kt>void</span> <span class=nf>setMessage</span><span class=o>(</span><span class=n>String</span> <span class=n>message</span><span class=o>){</span>
</span></span><span class=line><span class=cl>      <span class=k>this</span><span class=o>.</span><span class=na>message</span>  <span class=o>=</span> <span class=n>message</span><span class=o>;</span>
</span></span><span class=line><span class=cl>   <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>   <span class=kd>public</span> <span class=kt>void</span> <span class=nf>getMessage</span><span class=o>(){</span>
</span></span><span class=line><span class=cl>      <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;Your Message : &#34;</span> <span class=o>+</span> <span class=n>message</span><span class=o>);</span>
</span></span><span class=line><span class=cl>   <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><ul><li>App</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kn>package</span> <span class=nn>com.tutorialspoint</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>org.springframework.context.ApplicationContext</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>org.springframework.context.support.ClassPathXmlApplicationContext</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>MainApp</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>   <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>      <span class=n>ApplicationContext</span> <span class=n>context</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ClassPathXmlApplicationContext</span><span class=o>(</span><span class=s>&#34;Beans.xml&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      <span class=n>HelloWorld</span> <span class=n>objA</span> <span class=o>=</span> <span class=o>(</span><span class=n>HelloWorld</span><span class=o>)</span> <span class=n>context</span><span class=o>.</span><span class=na>getBean</span><span class=o>(</span><span class=s>&#34;helloWorld&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      <span class=n>objA</span><span class=o>.</span><span class=na>setMessage</span><span class=o>(</span><span class=s>&#34;I&#39;m object A&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>      <span class=n>objA</span><span class=o>.</span><span class=na>getMessage</span><span class=o>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      <span class=n>HelloWorld</span> <span class=n>objB</span> <span class=o>=</span> <span class=o>(</span><span class=n>HelloWorld</span><span class=o>)</span> <span class=n>context</span><span class=o>.</span><span class=na>getBean</span><span class=o>(</span><span class=s>&#34;helloWorld&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>      <span class=n>objB</span><span class=o>.</span><span class=na>getMessage</span><span class=o>();</span>
</span></span><span class=line><span class=cl>   <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><ul><li>Beans.xml</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=cp>&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nt>&lt;beans</span> <span class=na>xmlns=</span><span class=s>&#34;http://www.springframework.org/schema/beans&#34;</span>
</span></span><span class=line><span class=cl>    <span class=na>xmlns:xsi=</span><span class=s>&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span>
</span></span><span class=line><span class=cl>    <span class=na>xsi:schemaLocation=</span><span class=s>&#34;http://www.springframework.org/schema/beans
</span></span></span><span class=line><span class=cl><span class=s>    http://www.springframework.org/schema/beans/spring-beans-3.0.xsd&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>   <span class=nt>&lt;bean</span> <span class=na>id=</span><span class=s>&#34;helloWorld&#34;</span> <span class=na>class=</span><span class=s>&#34;com.tutorialspoint.HelloWorld&#34;</span>
</span></span><span class=line><span class=cl>      <span class=na>scope=</span><span class=s>&#34;prototype&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>   <span class=nt>&lt;/bean&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nt>&lt;/beans&gt;</span>
</span></span></code></pre></div><p>结果如下：</p><pre tabindex=0><code>Your Message : I&#39;m object A
Your Message : null
</code></pre><h2 id=lifecycle>LifeCycle</h2><p>容器初始化 bean 和销毁前所做的操作定义方式有三种：</p><ul><li><p><a href=http://write.blog.csdn.net/postedit/8681497 target=_blank rel=noopener>第一种：通过@PostConstruct 和@PreDestroy 方法 实现初始化和销毁 bean 之前进行的操作</a></p></li><li><p>第二种是：<a href=http://blog.csdn.net/topwqp/article/details/8681467 target=_blank rel=noopener>通过 在 xml 中定义 init-method 和 destory-method 方法</a></p></li><li><p>第三种是：<a href=http://blog.csdn.net/topwqp/article/details/8681573 target=_blank rel=noopener> 通过 bean 实现 InitializingBean 和 DisposableBean 接口</a></p></li></ul><h3 id=postconstruct-和predestory>@PostConstruct 和@PreDestory</h3><ul><li>定义相关的实现类</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kn>package</span> <span class=nn>com.myapp.core.annotation.init</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>javax.annotation.PostConstruct</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>javax.annotation.PreDestroy</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>PersonService</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=kd>private</span> <span class=n>String</span>  <span class=n>message</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=kd>public</span> <span class=n>String</span> <span class=nf>getMessage</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>		<span class=k>return</span> <span class=n>message</span><span class=o>;</span>
</span></span><span class=line><span class=cl>	<span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=kd>public</span> <span class=kt>void</span> <span class=nf>setMessage</span><span class=o>(</span><span class=n>String</span> <span class=n>message</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>		<span class=k>this</span><span class=o>.</span><span class=na>message</span> <span class=o>=</span> <span class=n>message</span><span class=o>;</span>
</span></span><span class=line><span class=cl>	<span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=nd>@PostConstruct</span>
</span></span><span class=line><span class=cl>	<span class=kd>public</span> <span class=kt>void</span>  <span class=nf>init</span><span class=o>(){</span>
</span></span><span class=line><span class=cl>		<span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;I&#39;m  init  method  using  @PostConstrut....&#34;</span><span class=o>+</span><span class=n>message</span><span class=o>);</span>
</span></span><span class=line><span class=cl>	<span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=nd>@PreDestroy</span>
</span></span><span class=line><span class=cl>	<span class=kd>public</span> <span class=kt>void</span>  <span class=nf>dostory</span><span class=o>(){</span>
</span></span><span class=line><span class=cl>		<span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;I&#39;m  destory method  using  @PreDestroy.....&#34;</span><span class=o>+</span><span class=n>message</span><span class=o>);</span>
</span></span><span class=line><span class=cl>	<span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><ul><li>定义相关的配置文件</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=cp>&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;beans</span> <span class=na>xmlns=</span><span class=s>&#34;http://www.springframework.org/schema/beans&#34;</span>
</span></span><span class=line><span class=cl><span class=na>xmlns:xsi=</span><span class=s>&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span>
</span></span><span class=line><span class=cl><span class=na>xmlns:context=</span><span class=s>&#34;http://www.springframework.org/schema/context&#34;</span>
</span></span><span class=line><span class=cl><span class=na>xsi:schemaLocation=</span><span class=s>&#34;http://www.springframework.org/schema/beans
</span></span></span><span class=line><span class=cl><span class=s>http://www.springframework.org/schema/beans/spring-beans-3.1.xsd
</span></span></span><span class=line><span class=cl><span class=s>http://www.springframework.org/schema/context
</span></span></span><span class=line><span class=cl><span class=s>http://www.springframework.org/schema/context/spring-context-3.1.xsd&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c>&lt;!-- &lt;context:component-scan  base-package=&#34;com.myapp.core.jsr330&#34;/&gt; --&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nt>&lt;context:annotation-config</span> <span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nt>&lt;bean</span> <span class=na>id=</span><span class=s>&#34;personService&#34;</span> <span class=na>class=</span><span class=s>&#34;com.myapp.core.annotation.init.PersonService&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=nt>&lt;property</span> <span class=na>name=</span><span class=s>&#34;message&#34;</span> <span class=na>value=</span><span class=s>&#34;123&#34;</span><span class=nt>&gt;&lt;/property&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/bean&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nt>&lt;/beans&gt;</span>
</span></span></code></pre></div><h3 id=initializingbeandisposablebean>InitializingBean,DisposableBean</h3><ul><li>定义相应类实现 InitializingBean ,DisposableBean 接口</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kn>package</span> <span class=nn>com.myapp.core.annotation.init</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>javax.annotation.PostConstruct</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>javax.annotation.PreDestroy</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>org.springframework.beans.factory.DisposableBean</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>org.springframework.beans.factory.InitializingBean</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>PersonService</span>  <span class=kd>implements</span> <span class=n>InitializingBean</span><span class=o>,</span><span class=n>DisposableBean</span><span class=o>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=kd>private</span> <span class=n>String</span>  <span class=n>message</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=kd>public</span> <span class=n>String</span> <span class=nf>getMessage</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>		<span class=k>return</span> <span class=n>message</span><span class=o>;</span>
</span></span><span class=line><span class=cl>	<span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=kd>public</span> <span class=kt>void</span> <span class=nf>setMessage</span><span class=o>(</span><span class=n>String</span> <span class=n>message</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>		<span class=k>this</span><span class=o>.</span><span class=na>message</span> <span class=o>=</span> <span class=n>message</span><span class=o>;</span>
</span></span><span class=line><span class=cl>	<span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=nd>@Override</span>
</span></span><span class=line><span class=cl>	<span class=kd>public</span> <span class=kt>void</span> <span class=nf>destroy</span><span class=o>()</span> <span class=kd>throws</span> <span class=n>Exception</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>		<span class=c1>// TODO Auto-generated method stub
</span></span></span><span class=line><span class=cl><span class=c1></span>		<span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;I&#39;m  init  method  using implements InitializingBean interface....&#34;</span><span class=o>+</span><span class=n>message</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=nd>@Override</span>
</span></span><span class=line><span class=cl>	<span class=kd>public</span> <span class=kt>void</span> <span class=nf>afterPropertiesSet</span><span class=o>()</span> <span class=kd>throws</span> <span class=n>Exception</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>		<span class=c1>// TODO Auto-generated method stub
</span></span></span><span class=line><span class=cl><span class=c1></span>		<span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;I&#39;m  init  method  using implements DisposableBean interface....&#34;</span><span class=o>+</span><span class=n>message</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><ul><li>定义相应的配置文件</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=cp>&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;beans</span> <span class=na>xmlns=</span><span class=s>&#34;http://www.springframework.org/schema/beans&#34;</span>
</span></span><span class=line><span class=cl><span class=na>xmlns:xsi=</span><span class=s>&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span>
</span></span><span class=line><span class=cl><span class=na>xmlns:context=</span><span class=s>&#34;http://www.springframework.org/schema/context&#34;</span>
</span></span><span class=line><span class=cl><span class=na>xsi:schemaLocation=</span><span class=s>&#34;http://www.springframework.org/schema/beans
</span></span></span><span class=line><span class=cl><span class=s>http://www.springframework.org/schema/beans/spring-beans-3.1.xsd
</span></span></span><span class=line><span class=cl><span class=s>http://www.springframework.org/schema/context
</span></span></span><span class=line><span class=cl><span class=s>http://www.springframework.org/schema/context/spring-context-3.1.xsd&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c>&lt;!-- &lt;context:component-scan  base-package=&#34;com.myapp.core.jsr330&#34;/&gt; --&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c>&lt;!-- &lt;context:annotation-config /&gt; --&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c>&lt;!-- &lt;bean class=&#34;org.springframework.context.annotation.CommonAnnotationBeanPostProcessor&#34; /&gt;
</span></span></span><span class=line><span class=cl><span class=c>&lt;bean id=&#34;personService&#34; class=&#34;com.myapp.core.annotation.init.PersonService&#34;&gt;
</span></span></span><span class=line><span class=cl><span class=c>		  &lt;property name=&#34;message&#34; value=&#34;123&#34;&gt;&lt;/property&gt;
</span></span></span><span class=line><span class=cl><span class=c>&lt;/bean&gt;
</span></span></span><span class=line><span class=cl><span class=c> --&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nt>&lt;bean</span> <span class=na>id=</span><span class=s>&#34;personService&#34;</span> <span class=na>class=</span><span class=s>&#34;com.myapp.core.annotation.init.PersonService&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>		  <span class=nt>&lt;property</span> <span class=na>name=</span><span class=s>&#34;message&#34;</span> <span class=na>value=</span><span class=s>&#34;123&#34;</span><span class=nt>&gt;&lt;/property&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/bean&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nt>&lt;/beans&gt;</span>
</span></span></code></pre></div><ul><li>测试类</li></ul><pre tabindex=0><code>package com.myapp.core.annotation.init;

import org.springframework.context.ApplicationContext;
import org.springframework.context.support.AbstractApplicationContext;
import org.springframework.context.support.ClassPathXmlApplicationContext;

public class MainTest {

	public static void main(String[] args) {

		AbstractApplicationContext  context = new ClassPathXmlApplicationContext(&#34;resource/annotation.xml&#34;);

		PersonService   personService  =  (PersonService)context.getBean(&#34;personService&#34;);

	         context.registerShutdownHook();
	}

}
</code></pre><h1 id=applicationcontext>ApplicationContext</h1><h2 id=configuration配置>Configuration(配置)</h2><p>这里的配置即指所有 Bean 的注册地，即声明一个 Bean 之后，ApplicationContext 需要自动去加载并且初始化这些 Bean。有点类似于 Zookeeper 的作用，即告诉下文的 ApplicationContext 的下载器应该去哪些包中加载 Bean。</p><h3 id=xml-based>XML-Based</h3><p>基于 XML 的配置方案即是传统意义上将所有的 Bean 及其他配置放置在了 XML 文件中并且以 XML 作为第一加载入口。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;beans&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;context:component-scan</span> <span class=na>base-package=</span><span class=s>&#34;org.example&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;context:include-filter</span> <span class=na>type=</span><span class=s>&#34;regex&#34;</span>
</span></span><span class=line><span class=cl>                <span class=na>expression=</span><span class=s>&#34;.*Stub.*Repository&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;context:exclude-filter</span> <span class=na>type=</span><span class=s>&#34;annotation&#34;</span>
</span></span><span class=line><span class=cl>                <span class=na>expression=</span><span class=s>&#34;org.springframework.stereotype.Repository&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;/context:component-scan&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/beans&gt;</span>
</span></span></code></pre></div><h3 id=annotation-based>Annotation-Based</h3><p>基于注解的配置方案同样是选择了 XML 作为第一配置入口，但是会将大量的 Controller 等 Bean 的配置放置在 Java 代码中。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=cp>&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;beans</span> <span class=na>xmlns=</span><span class=s>&#34;http://www.springframework.org/schema/beans&#34;</span>
</span></span><span class=line><span class=cl>    <span class=na>xmlns:xsi=</span><span class=s>&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span>
</span></span><span class=line><span class=cl>    <span class=na>xmlns:context=</span><span class=s>&#34;http://www.springframework.org/schema/context&#34;</span>
</span></span><span class=line><span class=cl>    <span class=na>xsi:schemaLocation=</span><span class=s>&#34;http://www.springframework.org/schema/beans
</span></span></span><span class=line><span class=cl><span class=s>        http://www.springframework.org/schema/beans/spring-beans.xsd
</span></span></span><span class=line><span class=cl><span class=s>        http://www.springframework.org/schema/context
</span></span></span><span class=line><span class=cl><span class=s>        http://www.springframework.org/schema/context/spring-context.xsd&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;context:annotation-config/&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/beans&gt;</span>
</span></span></code></pre></div><h3 id=java-based>Java-Based</h3><p>基于 Java 代码的配置方案即是选择将 Java 类作为第一配置入口。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Configuration</span>
</span></span><span class=line><span class=cl><span class=nd>@ComponentScan</span><span class=o>(</span><span class=n>basePackages</span> <span class=o>=</span> <span class=s>&#34;org.example&#34;</span><span class=o>,</span>
</span></span><span class=line><span class=cl>        <span class=n>includeFilters</span> <span class=o>=</span> <span class=nd>@Filter</span><span class=o>(</span><span class=n>type</span> <span class=o>=</span> <span class=n>FilterType</span><span class=o>.</span><span class=na>REGEX</span><span class=o>,</span> <span class=n>pattern</span> <span class=o>=</span> <span class=s>&#34;.*Stub.*Repository&#34;</span><span class=o>),</span>
</span></span><span class=line><span class=cl>        <span class=n>excludeFilters</span> <span class=o>=</span> <span class=nd>@Filter</span><span class=o>(</span><span class=n>Repository</span><span class=o>.</span><span class=na>class</span><span class=o>))</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>AppConfig</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=o>...</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>同样的，在配置类中依然可以引入 XML 配置的内容：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Configuration</span>
</span></span><span class=line><span class=cl><span class=nd>@PropertySource</span><span class=o>(</span><span class=s>&#34;classpath:apis.application.properties&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl><span class=nd>@ComponentScan</span><span class=o>(</span><span class=n>basePackages</span> <span class=o>=</span> <span class=o>{</span><span class=s>&#34;org.surfnet.oaaas.resource&#34;</span><span class=o>,</span> <span class=s>&#34;org.surfnet.oaaas.service&#34;</span><span class=o>})</span>
</span></span><span class=line><span class=cl><span class=nd>@ImportResource</span><span class=o>({</span><span class=s>&#34;classpath:spring-repositories.xml&#34;</span><span class=o>,</span> <span class=s>&#34;classpath:commonApplicationContext.xml&#34;</span><span class=o>})</span>
</span></span><span class=line><span class=cl><span class=nd>@EnableTransactionManagement</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>SpringConfiguration</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>有时候，也可以使用@ContextConfiguration 注解：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@RunWith</span><span class=o>(</span><span class=n>SpringJUnit4ClassRunner</span><span class=o>.</span><span class=na>class</span><span class=o>)</span>
</span></span><span class=line><span class=cl><span class=nd>@ContextConfiguration</span><span class=o>({</span> <span class=s>&#34;classpath:META-INF/conf/spring/this-xml-conf.xml&#34;</span><span class=o>,</span>
</span></span><span class=line><span class=cl>                    <span class=s>&#34;classpath:META-INF/conf/spring/that-other-xml-conf.xml&#34;</span> <span class=o>})</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>CleverMoneyMakingBusinessServiceIntegrationTest</span> <span class=o>{...}</span>
</span></span></code></pre></div><h2 id=instantiating加载>Instantiating(加载)</h2><p>在配置了基本的 Bean 和整个 ApplicationContext 之后，在具体应用时就需要从容器中获取相对应的 Bean。在 Web 项目中，类似于 Tomcat 或者 Jetty 这样的 Servlet 容器会自动从 web.xml 开始加载配置文件，此处不赘述，可以详见笔者的 Spring-MVC 系列实战笔记。而在本系列中主要介绍如何在 Java 代码中加载整个 Spring ApplicationContext。</p><h3 id=configurableapplicationcontext>ConfigurableApplicationContext</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=k>new</span> <span class=n>ClassPathXmlApplicationContext</span><span class=o>(</span>
</span></span><span class=line><span class=cl>    <span class=k>new</span> <span class=n>String</span><span class=o>[]</span> <span class=o>{</span> <span class=s>&#34;classpath:META-INF/conf/spring/this-xml-conf.xml&#34;</span><span class=o>,</span>
</span></span><span class=line><span class=cl>                   <span class=s>&#34;classpath:META-INF/conf/spring/that-other-xml-conf.xml&#34;</span> <span class=o>}</span> <span class=o>);</span>
</span></span></code></pre></div><h3 id=annotationconfigapplicationcontext>AnnotationConfigApplicationContext</h3><p>AnnotationConfigApplicationContext 可以从某个以<code>@Configuration</code>配置的类中初始化加载所有的 Bean，即以<code>@Configuration</code>注解的类本身会注册成某个 Bean，以及所有声明在其中的 Bean 也会完成在 ApplicationContext 中的注册。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>ApplicationContext</span> <span class=n>ctx</span> <span class=o>=</span> <span class=k>new</span> <span class=n>AnnotationConfigApplicationContext</span><span class=o>(</span><span class=n>MyServiceImpl</span><span class=o>.</span><span class=na>class</span><span class=o>,</span> <span class=n>Dependency1</span><span class=o>.</span><span class=na>class</span><span class=o>,</span> <span class=n>Dependency2</span><span class=o>.</span><span class=na>class</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>MyService</span> <span class=n>myService</span> <span class=o>=</span> <span class=n>ctx</span><span class=o>.</span><span class=na>getBean</span><span class=o>(</span><span class=n>MyService</span><span class=o>.</span><span class=na>class</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>myService</span><span class=o>.</span><span class=na>doStuff</span><span class=o>();</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p><code>AnnotationConfigApplicationContext</code>并不仅仅只可以传入某个配置类作为参数，任何以<code>@Component</code>作为注解的类都可以作为参数传入其构造器中：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>ApplicationContext</span> <span class=n>ctx</span> <span class=o>=</span> <span class=k>new</span> <span class=n>AnnotationConfigApplicationContext</span><span class=o>(</span><span class=n>MyServiceImpl</span><span class=o>.</span><span class=na>class</span><span class=o>,</span> <span class=n>Dependency1</span><span class=o>.</span><span class=na>class</span><span class=o>,</span> <span class=n>Dependency2</span><span class=o>.</span><span class=na>class</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>MyService</span> <span class=n>myService</span> <span class=o>=</span> <span class=n>ctx</span><span class=o>.</span><span class=na>getBean</span><span class=o>(</span><span class=n>MyService</span><span class=o>.</span><span class=na>class</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>myService</span><span class=o>.</span><span class=na>doStuff</span><span class=o>();</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>除了在初始化时候传入一些 Bean 的配置，<code>AnnotationConfigApplicationContext</code>还允许在运行时利用代码动态地注册一些 Bean 的配置类，如下所示：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>AnnotationConfigApplicationContext</span> <span class=n>ctx</span> <span class=o>=</span> <span class=k>new</span> <span class=n>AnnotationConfigApplicationContext</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=n>ctx</span><span class=o>.</span><span class=na>register</span><span class=o>(</span><span class=n>AppConfig</span><span class=o>.</span><span class=na>class</span><span class=o>,</span> <span class=n>OtherConfig</span><span class=o>.</span><span class=na>class</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>ctx</span><span class=o>.</span><span class=na>register</span><span class=o>(</span><span class=n>AdditionalConfig</span><span class=o>.</span><span class=na>class</span><span class=o>);</span><span class=c1>//使用定义类
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>ctx</span><span class=o>.</span><span class=na>scan</span><span class=o>(</span><span class=s>&#34;com.acme&#34;</span><span class=o>);</span><span class=c1>//自动扫描某些包
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>ctx</span><span class=o>.</span><span class=na>refresh</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=n>MyService</span> <span class=n>myService</span> <span class=o>=</span> <span class=n>ctx</span><span class=o>.</span><span class=na>getBean</span><span class=o>(</span><span class=n>MyService</span><span class=o>.</span><span class=na>class</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>myService</span><span class=o>.</span><span class=na>doStuff</span><span class=o>();</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><h1 id=dependence-injection--依赖注入>Dependence Injection | 依赖注入</h1><p>自动注入的具体表现即所有在 ApplicationContext 中声明的 Bean 可以允许其他同样注册的 Bean 根据接口类或者名称自动完成赋值或者实例化。</p><h3 id=constructor-based-dependency-injectionhttpwwwtutorialspointcomspringconstructor_based_dependency_injectionhtm><a href=http://www.tutorialspoint.com/spring/constructor_based_dependency_injection.htm target=_blank rel=noopener>Constructor-based dependency injection</a></h3><p>Constructor-based DI is accomplished when the container invokes a class constructor with a number of arguments, each representing a dependency on other class.</p><pre tabindex=0><code>package x.y;

public class Foo {

    public Foo(Bar bar, Baz baz) {
        // ...
    }

}
</code></pre><pre tabindex=0><code>&lt;beans&gt;
    &lt;bean id=&#34;foo&#34; class=&#34;x.y.Foo&#34;&gt;
        &lt;constructor-arg ref=&#34;bar&#34;/&gt;
        &lt;constructor-arg ref=&#34;baz&#34;/&gt;
    &lt;/bean&gt;

    &lt;bean id=&#34;bar&#34; class=&#34;x.y.Bar&#34;/&gt;

    &lt;bean id=&#34;baz&#34; class=&#34;x.y.Baz&#34;/&gt;
&lt;/beans&gt;
</code></pre><h3 id=setter-based-dependency-injectionhttpwwwtutorialspointcomspringsetter_based_dependency_injectionhtm><a href=http://www.tutorialspoint.com/spring/setter_based_dependency_injection.htm target=_blank rel=noopener>Setter-based dependency injection</a></h3><p>Setter-based DI is accomplished by the container calling setter methods on your beans after invoking a no-argument constructor or no-argument static factory method to instantiate your bean.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;bean</span> <span class=na>id=</span><span class=s>&#34;exampleBean&#34;</span> <span class=na>class=</span><span class=s>&#34;examples.ExampleBean&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=c>&lt;!-- setter injection using the nested ref element --&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;property</span> <span class=na>name=</span><span class=s>&#34;beanOne&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;ref</span> <span class=na>bean=</span><span class=s>&#34;anotherExampleBean&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;/property&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c>&lt;!-- setter injection using the neater ref attribute --&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;property</span> <span class=na>name=</span><span class=s>&#34;beanTwo&#34;</span> <span class=na>ref=</span><span class=s>&#34;yetAnotherBean&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;property</span> <span class=na>name=</span><span class=s>&#34;integerProperty&#34;</span> <span class=na>value=</span><span class=s>&#34;1&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/bean&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nt>&lt;bean</span> <span class=na>id=</span><span class=s>&#34;anotherExampleBean&#34;</span> <span class=na>class=</span><span class=s>&#34;examples.AnotherBean&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;bean</span> <span class=na>id=</span><span class=s>&#34;yetAnotherBean&#34;</span> <span class=na>class=</span><span class=s>&#34;examples.YetAnotherBean&#34;</span><span class=nt>/&gt;</span>
</span></span></code></pre></div><h3 id=autowiring>Autowiring</h3><p>有些依赖不需要显示声明，而只需要在 Java 的类定义时使用@Autowired 注解即可。</p><table><thead><tr><th>Mode</th><th>Description</th></tr></thead><tbody><tr><td>no</td><td>This is default setting which means no autowiring and you should use explicit bean reference for wiring. You have nothing to do special for this wiring. This is what you already have seen in Dependency Injection chapter.</td></tr><tr><td><a href=http://www.tutorialspoint.com/spring/spring_autowiring_byname.htm target=_blank rel=noopener>byName</a></td><td>Autowiring by property name. Spring container looks at the properties of the beans on which <em>autowire</em> attribute is set to<em>byName</em> in the XML configuration file. It then tries to match and wire its properties with the beans defined by the same names in the configuration file.</td></tr><tr><td><a href=http://www.tutorialspoint.com/spring/spring_autowiring_bytype.htm target=_blank rel=noopener>byType</a></td><td>Autowiring by property datatype. Spring container looks at the properties of the beans on which <em>autowire</em> attribute is set to <em>byType</em> in the XML configuration file. It then tries to match and wire a property if its <strong>type</strong> matches with exactly one of the beans name in configuration file. If more than one such beans exists, a fatal exception is thrown.</td></tr><tr><td><a href=http://www.tutorialspoint.com/spring/spring_autowiring_byconstructor.htm target=_blank rel=noopener>constructor</a></td><td>Similar to byType, but type applies to constructor arguments. If there is not exactly one bean of the constructor argument type in the container, a fatal error is raised.</td></tr><tr><td>autodetect</td><td>Spring first tries to wire using autowire by <em>constructor</em>, if it does not work, Spring tries to autowire by <em>byType</em>.</td></tr></tbody></table><p>You can apply the <code>@Autowired</code> annotation to constructors:</p><pre tabindex=0><code>public class MovieRecommender {


  private final CustomerPreferenceDao customerPreferenceDao;


  @Autowired
  public MovieRecommender(CustomerPreferenceDao customerPreferenceDao) {
  this.customerPreferenceDao = customerPreferenceDao;
  }


  // ...


}
</code></pre><p>As expected, you can also apply the <code>@Autowired</code> annotation to &ldquo;traditional&rdquo; setter methods:</p><pre tabindex=0><code>public class SimpleMovieLister {


  private MovieFinder movieFinder;


  @Autowired
  public void setMovieFinder(MovieFinder movieFinder) {
  this.movieFinder = movieFinder;
  }


  // ...


}
</code></pre><p>You can also apply the annotation to methods with arbitrary names and/or multiple arguments:</p><pre tabindex=0><code>public class MovieRecommender {


  private MovieCatalog movieCatalog;


  private CustomerPreferenceDao customerPreferenceDao;


  @Autowired
  public void prepare(MovieCatalog movieCatalog,
  CustomerPreferenceDao customerPreferenceDao) {
  this.movieCatalog = movieCatalog;
  this.customerPreferenceDao = customerPreferenceDao;
  }


  // ...


}
</code></pre><p>You can apply <code>@Autowired</code> to fields as well and even mix it with constructors:</p><pre tabindex=0><code>public class MovieRecommender {


  private final CustomerPreferenceDao customerPreferenceDao;


  @Autowired
  private MovieCatalog movieCatalog;


  @Autowired
  public MovieRecommender(CustomerPreferenceDao customerPreferenceDao) {
  this.customerPreferenceDao = customerPreferenceDao;
  }


  // ...


}
</code></pre><p>It is also possible to provide <em>all</em> beans of a particular type from the <code>ApplicationContext</code> by adding the annotation to a field or method that expects an array of that type:</p><pre tabindex=0><code>public class MovieRecommender {


  @Autowired
  private MovieCatalog[] movieCatalogs;


  // ...


}
</code></pre><p>The same applies for typed collections:</p><pre tabindex=0><code>public class MovieRecommender {


  private Set&lt;MovieCatalog&gt; movieCatalogs;


  @Autowired
  public void setMovieCatalogs(Set&lt;MovieCatalog&gt; movieCatalogs) {
  this.movieCatalogs = movieCatalogs;
  }


  // ...


}
</code></pre><p>Even typed Maps can be autowired as long as the expected key type is <code>String</code>. The Map values will contain all beans of the expected type, and the keys will contain the corresponding bean names:</p><pre tabindex=0><code>public class MovieRecommender {


  private Map&lt;String, MovieCatalog&gt; movieCatalogs;


  @Autowired
  public void setMovieCatalogs(Map&lt;String, MovieCatalog&gt; movieCatalogs) {
  this.movieCatalogs = movieCatalogs;
  }


  // ...


}
</code></pre><p>By default, the autowiring fails whenever <em>zero</em> candidate beans are available; the default behavior is to treat annotated methods, constructors, and fields as indicating<em>required</em> dependencies. This behavior can be changed as demonstrated below.</p><pre tabindex=0><code>public class SimpleMovieLister {


  private MovieFinder movieFinder;


  @Autowired(required=false)
  public void setMovieFinder(MovieFinder movieFinder) {
  this.movieFinder = movieFinder;
  }


  // ...


}
</code></pre><h4 id=qualifier>Qualifier</h4><p>如果有同一个类的不同的声明：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;bean</span> <span class=na>id=</span><span class=s>&#34;a&#34;</span> <span class=na>class=</span><span class=s>&#34;com.package.MyClass&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;bean</span> <span class=na>id=</span><span class=s>&#34;b&#34;</span> <span class=na>class=</span><span class=s>&#34;com.package.MyClass&#34;</span><span class=nt>/&gt;</span>
</span></span></code></pre></div><p>可以使用：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Autowired</span>
</span></span><span class=line><span class=cl><span class=nd>@Qualifier</span><span class=o>(</span><span class=s>&#34;a&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl><span class=n>MyClass</span> <span class=n>a</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@Autowired</span>
</span></span><span class=line><span class=cl><span class=nd>@Qualifier</span><span class=o>(</span><span class=s>&#34;b&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl><span class=n>MyClass</span> <span class=n>b</span><span class=o>;</span>
</span></span></code></pre></div><h1 id=注解方式声明>注解方式声明</h1><p>在 Spring 2.0 之前的版本中，@Repository 注解可以标记在任何的类上，用来表明该类是用来执行与数据库相关的操作（即 DAO 对象），并支持自动处理数据库操作产生的异常。在 Spring 2.5 版本中，引入了更多的 Spring 类注解：@Component,@Service,@Controller。@Component 是一个通用的 Spring 容器管理的单例 bean 组件。而@Repository, @Service, @Controller 就是针对不同的使用场景所采取的特定功能化的注解组件。</p><p>因此，当你的一个类被 @Component 所注解，那么就意味着同样可以用 @Repository, @Service, @Controller 来替代它，同时这些注解会具备有更多的功能，而且功能各异。最后，如果你不知道要在项目的业务层采用@Service 还是@Component 注解。那么，@Service 是一个更好的选择。就如上文所说的，@Repository 早已被支持了在你的持久层作为一个标记可以去自动处理数据库操作产生的异常</p><h1 id=conditional-configuration--条件化配置>Conditional Configuration | 条件化配置</h1><p>Class conditions allow us to specify that a configuration bean will be included if a specified class is present.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Configuration</span>
</span></span><span class=line><span class=cl><span class=nd>@ConditionalOnClass</span><span class=o>(</span><span class=n>DataSource</span><span class=o>.</span><span class=na>class</span><span class=o>)</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>MySQLAutoconfiguration</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>  <span class=c1>//...
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=o>}</span>
</span></span></code></pre></div><p>也可以根据某个 Bean 是否存在来决定是否需要创建 Bean:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Bean</span>
</span></span><span class=line><span class=cl><span class=nd>@ConditionalOnBean</span><span class=o>(</span><span class=n>name</span> <span class=o>=</span> <span class=s>&#34;dataSource&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl><span class=nd>@ConditionalOnMissingBean</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=n>LocalContainerEntityManagerFactoryBean</span> <span class=nf>entityManagerFactory</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>LocalContainerEntityManagerFactoryBean</span> <span class=n>em</span>
</span></span><span class=line><span class=cl>      <span class=o>=</span> <span class=k>new</span> <span class=n>LocalContainerEntityManagerFactoryBean</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=o>...</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>em</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>还可以根据是否存在某个属性配置来决定是否需要创建某个 Bean:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Bean</span>
</span></span><span class=line><span class=cl><span class=nd>@ConditionalOnProperty</span><span class=o>(</span>
</span></span><span class=line><span class=cl>  <span class=n>name</span> <span class=o>=</span> <span class=s>&#34;usemysql&#34;</span><span class=o>,</span>
</span></span><span class=line><span class=cl>  <span class=n>havingValue</span> <span class=o>=</span> <span class=s>&#34;local&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl><span class=nd>@ConditionalOnMissingBean</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=n>DataSource</span> <span class=nf>dataSource</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>DriverManagerDataSource</span> <span class=n>dataSource</span> <span class=o>=</span> <span class=k>new</span> <span class=n>DriverManagerDataSource</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=o>...</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>dataSource</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// Defining Condition that checks if the JdbcTemplate is available on the classpath
</span></span></span><span class=line><span class=cl><span class=c1>//
</span></span></span><span class=line><span class=cl><span class=c1>// Conditions are used by the auto-configuration mechanism of Spring Boot
</span></span></span><span class=line><span class=cl><span class=c1>// There are several configuration classes in the spring-boot-autoconfigure.jar
</span></span></span><span class=line><span class=cl><span class=c1>// which contribute to the configuration if specific conditions are met
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>public</span> <span class=kd>class</span> <span class=nc>JdbcTemplateCondition</span> <span class=kd>implements</span> <span class=n>Condition</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>  <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>  <span class=kd>public</span> <span class=kt>boolean</span> <span class=nf>matches</span><span class=o>(</span><span class=n>ConditionContext</span> <span class=n>context</span><span class=o>,</span> <span class=n>AnnotatedTypeMetadata</span> <span class=n>metadata</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>      <span class=n>context</span><span class=o>.</span><span class=na>getClassLoader</span><span class=o>().</span><span class=na>loadClass</span><span class=o>(</span><span class=s>&#34;org.springframework.jdbc.core.JdbcTemplate&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>      <span class=k>return</span> <span class=kc>true</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span> <span class=k>catch</span> <span class=o>(</span><span class=n>Exception</span> <span class=n>e</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>      <span class=k>return</span> <span class=kc>false</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>  <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Use a custom condition class to decide whether a Bean should be created or not
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nd>@Conditional</span><span class=o>(</span><span class=n>JdbcTemplateCondition</span><span class=o>.</span><span class=na>class</span><span class=o>)</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>MyService</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>  <span class=o>...</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><table><thead><tr><th>条件化注解</th><th>配置生效条件</th></tr></thead><tbody><tr><td>@ConditionalOnBean</td><td>配置了某个特定 bean</td></tr><tr><td>@ConditionalOnMissingBean</td><td>没有配置特定的 bean</td></tr><tr><td>@ConditionalOnClass</td><td>Classpath 里有指定的类</td></tr><tr><td>@ConditionalOnMissingClass</td><td>Classpath 里没有指定的类</td></tr><tr><td>@ConditionalOnExpression</td><td>给定的 Spring Expression Language 表达式计算结果为 true</td></tr><tr><td>@ConditionalOnJava</td><td>Java 的版本匹配特定指或者一个范围值</td></tr><tr><td>@ConditionalOnProperty</td><td>指定的配置属性要有一个明确的值</td></tr><tr><td>@ConditionalOnResource</td><td>Classpath 里有指定的资源</td></tr><tr><td>@ConditionalOnWebApplication</td><td>这是一个 Web 应用程序</td></tr><tr><td>@ConditionalOnNotWebApplication</td><td>这不是一个 Web 应用程序</td></tr></tbody></table></div><div class=article-widget><div class="container-xl row post-nav"><div class="col-6 post-nav-item"><div class=meta-nav>上一页</div><a href=/books/spring-series/1.%E5%9F%BA%E7%A1%80%E4%BD%BF%E7%94%A8/%E4%BE%9D%E8%B5%96%E6%B3%A8%E5%85%A5/bean/bean-%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/ rel=next>Bean 生命周期</a></div><div class="col-6 post-nav-item"><div class=meta-nav>下一页</div><a href=/books/spring-series/1.%E5%9F%BA%E7%A1%80%E4%BD%BF%E7%94%A8/%E4%BE%9D%E8%B5%96%E6%B3%A8%E5%85%A5/bean/bean-%E6%B3%A8%E5%85%A5/ rel=prev>Bean 注入</a></div></div></div><div class=body-footer><p>最近更新于 0001-01-01</p><section id=comments class="mb-3 pt-0"><div id=disqus_thread></div><script>var disqus_config=function(){};(function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="https://ngte.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)})()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></section></div></article><footer class=site-footer><div class="copyright py-4 bg-footer"><div class="row justify-content-center"><div class="text-center footer-color"><p class=mb-0>© 2017-2022 NGTE all rights reserved</p></div></div></div></footer></main></div></div><script src=//unpkg.com/heti/umd/heti-addon.min.js></script>
<script>const heti=new Heti(".article");heti.autoSpacing()</script><script type=text/javascript>window.$crisp=[],window.CRISP_WEBSITE_ID="12adcc35-9621-4313-8262-62dc654b29d8",function(){setTimeout(function(){d=document,s=d.createElement("script"),s.src="https://client.crisp.chat/l.js",s.async=1,d.getElementsByTagName("head")[0].appendChild(s)},2500)}()</script></div><div class=page-footer></div><script src=/js/vendor-bundle.min.d26509351aa0ff874abbee824e982e9b.js></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.1/highlight.min.js integrity="sha512-Ypjm0o7jOxAd4hpdoppSEN0TQOC19UtPAqD+4s5AlXmUvbmmS/YMxYqAqarQYyxTnB6/rqip9qcxlNB/3U9Wdg==" crossorigin=anonymous></script>
<script id=search-hit-algolia-template type=text/html><div class=search-hit><div class=search-hit-content><div class=search-hit-name><a href={{relpermalink}}>{{#helpers.highlight}}{ "attribute": "title" }{{/helpers.highlight}}</a></div><div class="article-metadata search-hit-type">{{type}}</div><p class=search-hit-description>{{#helpers.highlight}}{ "attribute": "summary" }{{/helpers.highlight}}</p></div></div></script><script src=https://cdn.jsdelivr.net/npm/instantsearch.js@4/dist/instantsearch.production.min.js crossorigin=anonymous></script>
<script id=dsq-count-scr src=https://ngte.disqus.com/count.js async></script>
<script src=/zh/js/algolia-search-built.min.4387d694ca1258194aaf562b8cd1c400.js type=module></script>
<script id=page-data type=application/json>{"use_headroom":false}</script><script src=/zh/js/wowchemy.min.d1673c7a11d1238516cbe12a1e84257f.js></script>
<script>var mybutton=document.getElementById("backTopBtn");window.onscroll=function(){scrollFunction()};function scrollFunction(){document.body.scrollTop>20||document.documentElement.scrollTop>20?mybutton.style.display="block":mybutton.style.display="none"}function topFunction(){document.body.scrollTop=0,document.documentElement.scrollTop=0}</script><script src=https://cdn.jsdelivr.net/gh/bryanbraun/anchorjs@4.2.2/anchor.min.js integrity="sha512-I7w3ZdSFzw5j3jU3ZkNikBNeIrl3i+hEuEdwNmqUJvwNcaBUNcijnP2gd9DtGlgVYDplfjGoD8vTNsID+lCjqg==" crossorigin=anonymous></script>
<script>anchors.add()</script><script>(function(){"use strict";if(!document.queryCommandSupported("copy"))return;function e(e,t){e.className="highlight-copy-btn",e.textContent=t,setTimeout(function(){e.textContent="",e.className="highlight-copy-btn fa fa-copy"},1e3)}function t(e){var t=window.getSelection(),n=document.createRange();return n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n),t}function n(n){var o,s=document.createElement("button");s.className="highlight-copy-btn fa fa-copy",s.textContent="",o=n.firstElementChild,s.addEventListener("click",function(){try{var n=t(o);document.execCommand("copy"),n.removeAllRanges(),e(s,"已复制")}catch(t){console&&console.log(t),e(s,"Failed :'(")}}),n.appendChild(s)}var s=document.getElementsByClassName("highlight");Array.prototype.forEach.call(s,n)})()</script></body></html>