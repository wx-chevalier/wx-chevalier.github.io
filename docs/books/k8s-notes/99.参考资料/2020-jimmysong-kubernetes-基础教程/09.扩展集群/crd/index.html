<!DOCTYPE html><html lang="zh" >


<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  
  
  
    <meta name="generator" content="Wowchemy 5.5.0 for Hugo" />
  

  
  










  







  
  
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  

  
  
  
    
      
      <link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap">
      <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap" media="print" onload="this.media='all'">
    
  

  
    <meta name="google-site-verification" content="google69a5cccb61297807" />
    <meta name="baidu-site-verification" content="cqmZHEleVh" />
  
  
  
  
  

  

  
  
  
    
  
  <meta name="description" content="weight: 64 title: 使用 CRD 扩展 Kubernetes API date: &lsquo;2022-05-21T00:00:00&#43;08:00&rsquo; type: book 本文是如何创建 CRD 来扩展 Kubernetes API 的教程。CRD 是用来扩展 Kubernetes 最常用的方式，在 Service Mesh 和 Operator 中也被大量使用。因此读者如果想在 Kubernetes 上做扩展和开发的话，是十分有必要了解 CRD 的。 在阅读本文前您需要先" />

  
  <link rel="alternate" hreflang="zh" href="https://ng-tech.icu/books/k8s-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2020-jimmysong-kubernetes-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/09.%E6%89%A9%E5%B1%95%E9%9B%86%E7%BE%A4/crd/" />

  
  
  
    <meta name="theme-color" content="#0a55a7" />
  

  
  

  

  <link rel="stylesheet" href="/css/vendor-bundle.min.c7b8d9abd591ba2253ea42747e3ac3f5.css" media="print" onload="this.media='all'">

  
  
  
    
    

    
    
    
    
      
      
    
    
    

    
    
    
      
    
    
      
      
        
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.1/styles/github.min.css" crossorigin="anonymous" title="hl-light" media="print" onload="this.media='all'">
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.1/styles/dracula.min.css" crossorigin="anonymous" title="hl-dark" media="print" onload="this.media='all'" disabled>
        
      
    

    
    
    

    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/instantsearch.css@7.4.5/themes/satellite-min.css" integrity="sha256-TehzF/2QvNKhGQrrNpoOb2Ck4iGZ1J/DI4pkd2oUsBc=" crossorigin="anonymous">
    

    
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      
        
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
  

  
  
  
  
  
  <link rel="stylesheet" href="/css/wowchemy.0d97305106da5efa530e28b021b4c580.css" />

  




<script async src="https://www.googletagmanager.com/gtag/js?id=G-40NYXJ8823"></script>

<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', "G-40NYXJ8823");
</script>


  


  


  


  <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?56df1177bce405601b0ecdd7208f75c6";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>



  
  
  

  

  
    <link rel="manifest" href="/manifest.webmanifest" />
  

  <link rel="icon" type="image/png" href="/media/icon_hu0f7d075e895d6f5f1f5fdbc1e33dc138_10087_32x32_fill_lanczos_center_3.png" />
  <link rel="apple-touch-icon" type="image/png" href="/media/icon_hu0f7d075e895d6f5f1f5fdbc1e33dc138_10087_180x180_fill_lanczos_center_3.png" />

  <link rel="canonical" href="https://ng-tech.icu/books/k8s-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2020-jimmysong-kubernetes-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/09.%E6%89%A9%E5%B1%95%E9%9B%86%E7%BE%A4/crd/" />

  
  
  
  
  
  
  
  
    
  
  

  
  
    
    
  
  <meta property="twitter:card" content="summary_large_image" />
  
    <meta property="twitter:site" content="@wx-chevalier" />
    <meta property="twitter:creator" content="@wx-chevalier" />
  
  <meta property="og:site_name" content="Next-gen Tech Edu" />
  <meta property="og:url" content="https://ng-tech.icu/books/k8s-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2020-jimmysong-kubernetes-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/09.%E6%89%A9%E5%B1%95%E9%9B%86%E7%BE%A4/crd/" />
  <meta property="og:title" content="crd | Next-gen Tech Edu" />
  <meta property="og:description" content="weight: 64 title: 使用 CRD 扩展 Kubernetes API date: &lsquo;2022-05-21T00:00:00&#43;08:00&rsquo; type: book 本文是如何创建 CRD 来扩展 Kubernetes API 的教程。CRD 是用来扩展 Kubernetes 最常用的方式，在 Service Mesh 和 Operator 中也被大量使用。因此读者如果想在 Kubernetes 上做扩展和开发的话，是十分有必要了解 CRD 的。 在阅读本文前您需要先" /><meta property="og:image" content="https://ng-tech.icu/media/sharing.png" />
    <meta property="twitter:image" content="https://ng-tech.icu/media/sharing.png" /><meta property="og:locale" content="zh" />
  
    
    
  

  



  

  

  





  <title>crd | Next-gen Tech Edu</title>
</head>


<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" class="page-wrapper   " data-wc-page-id="f087c0e5aa0507d49a00472e4a58d7bf" >
  <button onclick="topFunction()" id="backTopBtn" title="Go to top"><i class="fa-solid fa-circle-up" aria-hidden="true"></i></button>
  
  
  
  
  
  
  
  
  
  <script src="/js/wowchemy-init.min.14a0ed61c6dbd594b9c75193b25be179.js"></script>

  


<aside class="search-modal" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6 search-title">
          <p>搜索</p>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#" aria-label="关闭"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        
        
      </div>

      
      

      
    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

      <div id="search-common-queries">
        
      </div>

    </section>
  </div>
</aside>



  <div class="page-header">
    












<header class="header--fixed">
  <nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
    <div class="container-xl">

      
      <div class="d-none d-lg-inline-flex">
        <a class="navbar-brand" href="/">Next-gen Tech Edu</a>
      </div>
      

      
      <button type="button" class="navbar-toggler" data-toggle="collapse"
              data-target="#navbar-content" aria-controls="navbar-content" aria-expanded="false" aria-label="切换导航">
      <span><i class="fas fa-bars"></i></span>
      </button>
      

      
      <div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none">
        <a class="navbar-brand" href="/">Next-gen Tech Edu</a>
      </div>
      

      
      
      <div class="navbar-collapse main-menu-item collapse justify-content-start" id="navbar-content">

        
        <ul class="navbar-nav d-md-inline-flex">
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
          

          <li class="nav-item">
            <a class="nav-link " href="/books-gallery"><span>笔记（万篇）</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="/#knowledge-map"><span>知识图谱</span></a>
          </li>

          
          

          
          <style>
            .dropdown-item{
              display: inline-flex;
            }
          </style>
          <li class="nav-item dropdown">
            <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" aria-haspopup="true"><span>实验室</span><span class="caret"></span>
            </a>
            <div class="dropdown-menu">
              
                <a class="dropdown-item" href="/galaxy-home/gh-craft"><span>Craft 方块世界</span></a>
              
                <a class="dropdown-item" href="/galaxy-home/glossary-cards"><span>3D 知识卡牌</span></a>
              
            </div>
          </li>

          
          

          
          <style>
            .dropdown-item{
              display: inline-flex;
            }
          </style>
          <li class="nav-item dropdown">
            <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" aria-haspopup="true"><span>其他阅读渠道</span><span class="caret"></span>
            </a>
            <div class="dropdown-menu">
              
                <a class="dropdown-item" href="https://zhuanlan.zhihu.com/wxyyxc1992"><img style="width:16px;height:16px;display:inline-block;margin-right:8px" src="https://ngte-superbed.oss-cn-beijing.aliyuncs.com/item/20230218234451.png"></img><span>知乎</span></a>
              
                <a class="dropdown-item" href="https://segmentfault.com/blog/wxyyxc1992"><img style="width:16px;height:16px;display:inline-block;margin-right:8px" src="https://ngte-superbed.oss-cn-beijing.aliyuncs.com/item/20230219113556.png"></img><span>SegmentFault</span></a>
              
                <a class="dropdown-item" href="https://zhuanlan.zhihu.com/wxyyxc1992"><img style="width:16px;height:16px;display:inline-block;margin-right:8px" src="https://ngte-superbed.oss-cn-beijing.aliyuncs.com/item/20230219113519.png"></img><span>掘金</span></a>
              
            </div>
          </li>

          
          

        

          
        </ul>
      </div>

      <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">

        
        
        
        <li class="nav-item">
          <a class="nav-link js-search" href="#" aria-label="搜索"><i class="fas fa-search" aria-hidden="true"></i></a>
        </li>
        

        
        
        <li class="nav-item">
            <a class="nav-link" href="https://github.com/wx-chevalier" aria-label="GitHub"><i class="fa-brands fa-github" aria-hidden="true"></i></a>
        </li>
        

        
        
        

        
        
        
        <div></div>
        
        <style>
        @media only screen and (max-width: 600px) {
          .jimmysong-template {
            display: none!important;
          }
        }
        </style>
        
        <li class="jimmysong-template" style="color: white;font-size: 12px;">
          <a href="https://jimmysong.io" style="color: white">By Jimmy Song's Template</a>
        </li>
      </ul>

    </div>
  </nav>
</header>


  </div>

  <div class="page-body">
    
    
    

    




<link rel="stylesheet" href="//unpkg.com/heti/umd/heti.min.css">
<div class="container-xl docs">
  <div class="row flex-xl-nowrap">
    <div class="docs-sidebar">
      <form class="docs-search d-flex align-items-center">
  <button class="btn docs-toggle d-md-none p-0 mr-md-3 w-100" type="button" data-toggle="collapse" data-target="#docs-nav" aria-controls="docs-nav" aria-expanded="false" aria-label="Toggle section navigation">
    <div class="d-flex">
      <span class="d-md-none pl-1 flex-grow-1 text-left overflow-hidden">
        
          _index
        
      </span>
      <span><i class="fas fa-chevron-down"></i></span>
    </div>
  </button>

  
  <button class="form-control sidebar-search js-search d-none d-md-flex">
    <i class="fas fa-search pr-2"></i>
    <span class="sidebar-search-text">搜索...</span>
    <span class="sidebar-search-shortcut">/</span>
  </button>
  
</form>

<nav class="collapse docs-links" id="docs-nav">
  
  
  
  
  
  

  
  
    

    
      

      <ul class="nav docs-sidenav">
        <li style="display: inline-flex">
          <a style="cursor: pointer;" onclick="window.history.back()">
            <i class="fas fa-arrow-left pr-1"></i>
            Back
          </a>
          <span>|</span>
          <a href="/books/">
            <i class="fa-solid fa-house" style="margin-right: 4px"></i>
            Books
          </a>
        </li>
      </ul>

      
      
        
          
        
      



  
    
    
    
    
      
    
    

    
    
    
    
    
    <div class="docs-toc-item has-child">
    <div class="parent-node d-flex justify-content-between" onClick="Collapse(&#34;caret-idfeb2a47527259ef304df22cf4fd82382&#34;)" href="#idfeb2a47527259ef304df22cf4fd82382" aria-expanded="false" aria-controls="idfeb2a47527259ef304df22cf4fd82382" aria-hidden="false" data-toggle="collapse">
    
    <a class="d-inline docs-toc-link " href="/books/k8s-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2020-jimmysong-kubernetes-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/">_index</a>
    <a class="nav-toogle d-inline level" aria-hidden="false" data-toggle="collapse" href="#idfeb2a47527259ef304df22cf4fd82382" aria-expanded="false" aria-controls="idfeb2a47527259ef304df22cf4fd82382">
    
    <i class="fa-solid fa-angle-down" id="caret-idfeb2a47527259ef304df22cf4fd82382"></i>
    
    </a>
    
    </div>
    
      
      <ul class="nav docs-sidenav collapse  show " id="idfeb2a47527259ef304df22cf4fd82382">
      



  
    
    
    
    
      
    
    

    
    
    
    <div class="docs-toc-item has-child">
    <div class="parent-node d-flex justify-content-between" onClick="Collapse(&#34;caret-id74d39329e37c239b9d6d4b2c4a260a33&#34;)" href="#id74d39329e37c239b9d6d4b2c4a260a33" aria-expanded="false" aria-controls="id74d39329e37c239b9d6d4b2c4a260a33" aria-hidden="false" data-toggle="collapse">
    
    <a class="d-inline docs-toc-link " href="/books/k8s-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2020-jimmysong-kubernetes-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/02.%E8%B5%84%E6%BA%90%E5%AF%B9%E8%B1%A1/">_index</a>
    <a class="nav-toogle d-inline level" aria-hidden="false" data-toggle="collapse" href="#id74d39329e37c239b9d6d4b2c4a260a33" aria-expanded="false" aria-controls="id74d39329e37c239b9d6d4b2c4a260a33">
    
        <i class="fa-solid fa-angle-right" id="caret-id74d39329e37c239b9d6d4b2c4a260a33"></i>
    
    </a>
    
    </div>
    
      
      <ul class="nav docs-sidenav collapse  " id="id74d39329e37c239b9d6d4b2c4a260a33">
      



  <li class="child level "><a href="/books/k8s-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2020-jimmysong-kubernetes-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/02.%E8%B5%84%E6%BA%90%E5%AF%B9%E8%B1%A1/14.init-%E5%AE%B9%E5%99%A8/">14.Init 容器</a></li>




  <li class="child level "><a href="/books/k8s-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2020-jimmysong-kubernetes-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/02.%E8%B5%84%E6%BA%90%E5%AF%B9%E8%B1%A1/pause-container/">pause-container</a></li>




  <li class="child level "><a href="/books/k8s-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2020-jimmysong-kubernetes-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/02.%E8%B5%84%E6%BA%90%E5%AF%B9%E8%B1%A1/pod/">pod</a></li>




  <li class="child level "><a href="/books/k8s-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2020-jimmysong-kubernetes-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/02.%E8%B5%84%E6%BA%90%E5%AF%B9%E8%B1%A1/pod-disruption-budget/">pod-disruption-budget</a></li>




  <li class="child level "><a href="/books/k8s-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2020-jimmysong-kubernetes-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/02.%E8%B5%84%E6%BA%90%E5%AF%B9%E8%B1%A1/pod-hook/">pod-hook</a></li>




  <li class="child level "><a href="/books/k8s-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2020-jimmysong-kubernetes-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/02.%E8%B5%84%E6%BA%90%E5%AF%B9%E8%B1%A1/pod-lifecycle/">pod-lifecycle</a></li>




  <li class="child level "><a href="/books/k8s-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2020-jimmysong-kubernetes-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/02.%E8%B5%84%E6%BA%90%E5%AF%B9%E8%B1%A1/pod-overview/">pod-overview</a></li>




  <li class="child level "><a href="/books/k8s-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2020-jimmysong-kubernetes-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/02.%E8%B5%84%E6%BA%90%E5%AF%B9%E8%B1%A1/pod-preset/">pod-preset</a></li>




  <li class="child level "><a href="/books/k8s-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2020-jimmysong-kubernetes-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/02.%E8%B5%84%E6%BA%90%E5%AF%B9%E8%B1%A1/pod-security-policy/">pod-security-policy</a></li>

      
        </ul>
      
    

    
      </div>
    




  
    
    
    
    
      
    
    

    
    
    
    <div class="docs-toc-item has-child">
    <div class="parent-node d-flex justify-content-between" onClick="Collapse(&#34;caret-id00d0eb1f5206fd2532bbc45c4bdd8926&#34;)" href="#id00d0eb1f5206fd2532bbc45c4bdd8926" aria-expanded="false" aria-controls="id00d0eb1f5206fd2532bbc45c4bdd8926" aria-hidden="false" data-toggle="collapse">
    
    <a class="d-inline docs-toc-link " href="/books/k8s-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2020-jimmysong-kubernetes-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/05.%E6%9C%8D%E5%8A%A1%E5%8F%91%E7%8E%B0%E4%B8%8E%E8%B7%AF%E7%94%B1/">_index</a>
    <a class="nav-toogle d-inline level" aria-hidden="false" data-toggle="collapse" href="#id00d0eb1f5206fd2532bbc45c4bdd8926" aria-expanded="false" aria-controls="id00d0eb1f5206fd2532bbc45c4bdd8926">
    
        <i class="fa-solid fa-angle-right" id="caret-id00d0eb1f5206fd2532bbc45c4bdd8926"></i>
    
    </a>
    
    </div>
    
      
      <ul class="nav docs-sidenav collapse  " id="id00d0eb1f5206fd2532bbc45c4bdd8926">
      



  <li class="child level "><a href="/books/k8s-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2020-jimmysong-kubernetes-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/05.%E6%9C%8D%E5%8A%A1%E5%8F%91%E7%8E%B0%E4%B8%8E%E8%B7%AF%E7%94%B1/39.service/">39.Service</a></li>




  <li class="child level "><a href="/books/k8s-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2020-jimmysong-kubernetes-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/05.%E6%9C%8D%E5%8A%A1%E5%8F%91%E7%8E%B0%E4%B8%8E%E8%B7%AF%E7%94%B1/40.%E6%8B%93%E6%89%91%E6%84%9F%E7%9F%A5%E8%B7%AF%E7%94%B1/">40.拓扑感知路由</a></li>




  <li class="child level "><a href="/books/k8s-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2020-jimmysong-kubernetes-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/05.%E6%9C%8D%E5%8A%A1%E5%8F%91%E7%8E%B0%E4%B8%8E%E8%B7%AF%E7%94%B1/41.ingress/">41.Ingress</a></li>




  <li class="child level "><a href="/books/k8s-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2020-jimmysong-kubernetes-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/05.%E6%9C%8D%E5%8A%A1%E5%8F%91%E7%8E%B0%E4%B8%8E%E8%B7%AF%E7%94%B1/42.gateway-api/">42.Gateway API</a></li>

      
        </ul>
      
    

    
      </div>
    




  
    
    
    
    
      
    
    

    
    
    
    <div class="docs-toc-item has-child">
    <div class="parent-node d-flex justify-content-between" onClick="Collapse(&#34;caret-id32c88b3f1c86b390a9c6f65823b94d5e&#34;)" href="#id32c88b3f1c86b390a9c6f65823b94d5e" aria-expanded="false" aria-controls="id32c88b3f1c86b390a9c6f65823b94d5e" aria-hidden="false" data-toggle="collapse">
    
    <a class="d-inline docs-toc-link " href="/books/k8s-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2020-jimmysong-kubernetes-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/07.%E7%BD%91%E7%BB%9C/">_index</a>
    <a class="nav-toogle d-inline level" aria-hidden="false" data-toggle="collapse" href="#id32c88b3f1c86b390a9c6f65823b94d5e" aria-expanded="false" aria-controls="id32c88b3f1c86b390a9c6f65823b94d5e">
    
        <i class="fa-solid fa-angle-right" id="caret-id32c88b3f1c86b390a9c6f65823b94d5e"></i>
    
    </a>
    
    </div>
    
      
      <ul class="nav docs-sidenav collapse  " id="id32c88b3f1c86b390a9c6f65823b94d5e">
      



  <li class="child level "><a href="/books/k8s-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2020-jimmysong-kubernetes-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/07.%E7%BD%91%E7%BB%9C/calico/">calico</a></li>




  <li class="child level "><a href="/books/k8s-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2020-jimmysong-kubernetes-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/07.%E7%BD%91%E7%BB%9C/cilium/">cilium</a></li>




  <li class="child level "><a href="/books/k8s-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2020-jimmysong-kubernetes-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/07.%E7%BD%91%E7%BB%9C/flannel/">flannel</a></li>

      
        </ul>
      
    

    
      </div>
    




  
    
    
    
    
      
    
    

    
    
    
    
    
    <div class="docs-toc-item has-child">
    <div class="parent-node d-flex justify-content-between" onClick="Collapse(&#34;caret-id1288ced20a7fea2f35c56e0b90712237&#34;)" href="#id1288ced20a7fea2f35c56e0b90712237" aria-expanded="false" aria-controls="id1288ced20a7fea2f35c56e0b90712237" aria-hidden="false" data-toggle="collapse">
    
    <a class="d-inline docs-toc-link " href="/books/k8s-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2020-jimmysong-kubernetes-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/09.%E6%89%A9%E5%B1%95%E9%9B%86%E7%BE%A4/">_index</a>
    <a class="nav-toogle d-inline level" aria-hidden="false" data-toggle="collapse" href="#id1288ced20a7fea2f35c56e0b90712237" aria-expanded="false" aria-controls="id1288ced20a7fea2f35c56e0b90712237">
    
    <i class="fa-solid fa-angle-down" id="caret-id1288ced20a7fea2f35c56e0b90712237"></i>
    
    </a>
    
    </div>
    
      
      <ul class="nav docs-sidenav collapse  show " id="id1288ced20a7fea2f35c56e0b90712237">
      



  <li class="child level "><a href="/books/k8s-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2020-jimmysong-kubernetes-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/09.%E6%89%A9%E5%B1%95%E9%9B%86%E7%BE%A4/aggregated-api-server/">aggregated-api-server</a></li>




  <li class="child level "><a href="/books/k8s-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2020-jimmysong-kubernetes-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/09.%E6%89%A9%E5%B1%95%E9%9B%86%E7%BE%A4/apiservice/">apiservice</a></li>




  <li class="child level active"><a href="/books/k8s-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2020-jimmysong-kubernetes-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/09.%E6%89%A9%E5%B1%95%E9%9B%86%E7%BE%A4/crd/">crd</a></li>




  <li class="child level "><a href="/books/k8s-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2020-jimmysong-kubernetes-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/09.%E6%89%A9%E5%B1%95%E9%9B%86%E7%BE%A4/custom-resource/">custom-resource</a></li>




  <li class="child level "><a href="/books/k8s-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2020-jimmysong-kubernetes-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/09.%E6%89%A9%E5%B1%95%E9%9B%86%E7%BE%A4/service-catalog/">service-catalog</a></li>

      
        </ul>
      
    

    
      </div>
    




  
    
    
    
    
      
    
    

    
    
    
    <div class="docs-toc-item has-child">
    <div class="parent-node d-flex justify-content-between" onClick="Collapse(&#34;caret-idd7760aeea62bb053c481ba072639774f&#34;)" href="#idd7760aeea62bb053c481ba072639774f" aria-expanded="false" aria-controls="idd7760aeea62bb053c481ba072639774f" aria-hidden="false" data-toggle="collapse">
    
    <a class="d-inline docs-toc-link " href="/books/k8s-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2020-jimmysong-kubernetes-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/10.%E5%A4%9A%E9%9B%86%E7%BE%A4%E7%AE%A1%E7%90%86/">_index</a>
    <a class="nav-toogle d-inline level" aria-hidden="false" data-toggle="collapse" href="#idd7760aeea62bb053c481ba072639774f" aria-expanded="false" aria-controls="idd7760aeea62bb053c481ba072639774f">
    
        <i class="fa-solid fa-angle-right" id="caret-idd7760aeea62bb053c481ba072639774f"></i>
    
    </a>
    
    </div>
    
      
      <ul class="nav docs-sidenav collapse  " id="idd7760aeea62bb053c481ba072639774f">
      



  <li class="child level "><a href="/books/k8s-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2020-jimmysong-kubernetes-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/10.%E5%A4%9A%E9%9B%86%E7%BE%A4%E7%AE%A1%E7%90%86/federation/">federation</a></li>




  <li class="child level "><a href="/books/k8s-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2020-jimmysong-kubernetes-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/10.%E5%A4%9A%E9%9B%86%E7%BE%A4%E7%AE%A1%E7%90%86/multi-cluster-services-api/">multi-cluster-services-api</a></li>

      
        </ul>
      
    

    
      </div>
    




  
    
    
    
    
      
    
    

    
    
    
    <div class="docs-toc-item has-child">
    <div class="parent-node d-flex justify-content-between" onClick="Collapse(&#34;caret-id8fea313385df6cf9c2a4a8befa22b099&#34;)" href="#id8fea313385df6cf9c2a4a8befa22b099" aria-expanded="false" aria-controls="id8fea313385df6cf9c2a4a8befa22b099" aria-hidden="false" data-toggle="collapse">
    
    <a class="d-inline docs-toc-link " href="/books/k8s-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2020-jimmysong-kubernetes-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/11.%E8%B5%84%E6%BA%90%E5%AF%B9%E8%B1%A1%E9%85%8D%E7%BD%AE/">_index</a>
    <a class="nav-toogle d-inline level" aria-hidden="false" data-toggle="collapse" href="#id8fea313385df6cf9c2a4a8befa22b099" aria-expanded="false" aria-controls="id8fea313385df6cf9c2a4a8befa22b099">
    
        <i class="fa-solid fa-angle-right" id="caret-id8fea313385df6cf9c2a4a8befa22b099"></i>
    
    </a>
    
    </div>
    
      
      <ul class="nav docs-sidenav collapse  " id="id8fea313385df6cf9c2a4a8befa22b099">
      



  <li class="child level "><a href="/books/k8s-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2020-jimmysong-kubernetes-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/11.%E8%B5%84%E6%BA%90%E5%AF%B9%E8%B1%A1%E9%85%8D%E7%BD%AE/74.%E9%85%8D%E7%BD%AE-pod-%E7%9A%84-liveness-%E5%92%8C-readiness-%E6%8E%A2%E9%92%88/">74.配置 Pod 的 liveness 和 readiness 探针</a></li>




  <li class="child level "><a href="/books/k8s-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2020-jimmysong-kubernetes-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/11.%E8%B5%84%E6%BA%90%E5%AF%B9%E8%B1%A1%E9%85%8D%E7%BD%AE/quota/">quota</a></li>




  <li class="child level "><a href="/books/k8s-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2020-jimmysong-kubernetes-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/11.%E8%B5%84%E6%BA%90%E5%AF%B9%E8%B1%A1%E9%85%8D%E7%BD%AE/secret/">secret</a></li>




  <li class="child level "><a href="/books/k8s-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2020-jimmysong-kubernetes-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/11.%E8%B5%84%E6%BA%90%E5%AF%B9%E8%B1%A1%E9%85%8D%E7%BD%AE/service-account/">service-account</a></li>

      
        </ul>
      
    

    
      </div>
    




  
    
    
    
    
      
    
    

    
    
    
    <div class="docs-toc-item has-child">
    <div class="parent-node d-flex justify-content-between" onClick="Collapse(&#34;caret-id168c4a45c67989cc65f77496e86d8aa8&#34;)" href="#id168c4a45c67989cc65f77496e86d8aa8" aria-expanded="false" aria-controls="id168c4a45c67989cc65f77496e86d8aa8" aria-hidden="false" data-toggle="collapse">
    
    <a class="d-inline docs-toc-link " href="/books/k8s-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2020-jimmysong-kubernetes-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/12.%E5%91%BD%E4%BB%A4%E4%BD%BF%E7%94%A8/">_index</a>
    <a class="nav-toogle d-inline level" aria-hidden="false" data-toggle="collapse" href="#id168c4a45c67989cc65f77496e86d8aa8" aria-expanded="false" aria-controls="id168c4a45c67989cc65f77496e86d8aa8">
    
        <i class="fa-solid fa-angle-right" id="caret-id168c4a45c67989cc65f77496e86d8aa8"></i>
    
    </a>
    
    </div>
    
      
      <ul class="nav docs-sidenav collapse  " id="id168c4a45c67989cc65f77496e86d8aa8">
      



  <li class="child level "><a href="/books/k8s-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2020-jimmysong-kubernetes-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/12.%E5%91%BD%E4%BB%A4%E4%BD%BF%E7%94%A8/docker-cli-to-kubectl/">docker-cli-to-kubectl</a></li>




  <li class="child level "><a href="/books/k8s-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2020-jimmysong-kubernetes-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/12.%E5%91%BD%E4%BB%A4%E4%BD%BF%E7%94%A8/etcdctl/">etcdctl</a></li>




  <li class="child level "><a href="/books/k8s-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2020-jimmysong-kubernetes-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/12.%E5%91%BD%E4%BB%A4%E4%BD%BF%E7%94%A8/kubectl-cheatsheet/">kubectl-cheatsheet</a></li>




  <li class="child level "><a href="/books/k8s-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2020-jimmysong-kubernetes-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/12.%E5%91%BD%E4%BB%A4%E4%BD%BF%E7%94%A8/using-kubectl/">using-kubectl</a></li>

      
        </ul>
      
    

    
      </div>
    




  
    
    
    
    
      
    
    

    
    
    
    <div class="docs-toc-item has-child">
    <div class="parent-node d-flex justify-content-between" onClick="Collapse(&#34;caret-id01a01dcaf73a226d20a86d2a0e6589cf&#34;)" href="#id01a01dcaf73a226d20a86d2a0e6589cf" aria-expanded="false" aria-controls="id01a01dcaf73a226d20a86d2a0e6589cf" aria-hidden="false" data-toggle="collapse">
    
    <a class="d-inline docs-toc-link " href="/books/k8s-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2020-jimmysong-kubernetes-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/13.%E9%9B%86%E7%BE%A4%E5%AE%89%E5%85%A8%E6%80%A7%E7%AE%A1%E7%90%86/">_index</a>
    <a class="nav-toogle d-inline level" aria-hidden="false" data-toggle="collapse" href="#id01a01dcaf73a226d20a86d2a0e6589cf" aria-expanded="false" aria-controls="id01a01dcaf73a226d20a86d2a0e6589cf">
    
        <i class="fa-solid fa-angle-right" id="caret-id01a01dcaf73a226d20a86d2a0e6589cf"></i>
    
    </a>
    
    </div>
    
      
      <ul class="nav docs-sidenav collapse  " id="id01a01dcaf73a226d20a86d2a0e6589cf">
      



  <li class="child level "><a href="/books/k8s-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2020-jimmysong-kubernetes-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/13.%E9%9B%86%E7%BE%A4%E5%AE%89%E5%85%A8%E6%80%A7%E7%AE%A1%E7%90%86/auth-with-kubeconfig-or-token/">auth-with-kubeconfig-or-token</a></li>




  <li class="child level "><a href="/books/k8s-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2020-jimmysong-kubernetes-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/13.%E9%9B%86%E7%BE%A4%E5%AE%89%E5%85%A8%E6%80%A7%E7%AE%A1%E7%90%86/authentication/">authentication</a></li>




  <li class="child level "><a href="/books/k8s-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2020-jimmysong-kubernetes-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/13.%E9%9B%86%E7%BE%A4%E5%AE%89%E5%85%A8%E6%80%A7%E7%AE%A1%E7%90%86/ip-masq-agent/">ip-masq-agent</a></li>




  <li class="child level "><a href="/books/k8s-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2020-jimmysong-kubernetes-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/13.%E9%9B%86%E7%BE%A4%E5%AE%89%E5%85%A8%E6%80%A7%E7%AE%A1%E7%90%86/kubectl-user-authentication-authorization/">kubectl-user-authentication-authorization</a></li>




  <li class="child level "><a href="/books/k8s-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2020-jimmysong-kubernetes-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/13.%E9%9B%86%E7%BE%A4%E5%AE%89%E5%85%A8%E6%80%A7%E7%AE%A1%E7%90%86/kubelet-authentication-authorization/">kubelet-authentication-authorization</a></li>




  <li class="child level "><a href="/books/k8s-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2020-jimmysong-kubernetes-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/13.%E9%9B%86%E7%BE%A4%E5%AE%89%E5%85%A8%E6%80%A7%E7%AE%A1%E7%90%86/kubernetes-security-best-practice/">kubernetes-security-best-practice</a></li>




  <li class="child level "><a href="/books/k8s-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2020-jimmysong-kubernetes-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/13.%E9%9B%86%E7%BE%A4%E5%AE%89%E5%85%A8%E6%80%A7%E7%AE%A1%E7%90%86/managing-tls-in-a-cluster/">managing-tls-in-a-cluster</a></li>




  <li class="child level "><a href="/books/k8s-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2020-jimmysong-kubernetes-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/13.%E9%9B%86%E7%BE%A4%E5%AE%89%E5%85%A8%E6%80%A7%E7%AE%A1%E7%90%86/tls-bootstrapping/">tls-bootstrapping</a></li>

      
        </ul>
      
    

    
      </div>
    




  
    
    
    
    
      
    
    

    
    
    
    <div class="docs-toc-item has-child">
    <div class="parent-node d-flex justify-content-between" onClick="Collapse(&#34;caret-id39fdbb30c1067eb27eb3da47e08b99b4&#34;)" href="#id39fdbb30c1067eb27eb3da47e08b99b4" aria-expanded="false" aria-controls="id39fdbb30c1067eb27eb3da47e08b99b4" aria-hidden="false" data-toggle="collapse">
    
    <a class="d-inline docs-toc-link " href="/books/k8s-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2020-jimmysong-kubernetes-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/14.%E8%AE%BF%E9%97%AE%E9%9B%86%E7%BE%A4/">_index</a>
    <a class="nav-toogle d-inline level" aria-hidden="false" data-toggle="collapse" href="#id39fdbb30c1067eb27eb3da47e08b99b4" aria-expanded="false" aria-controls="id39fdbb30c1067eb27eb3da47e08b99b4">
    
        <i class="fa-solid fa-angle-right" id="caret-id39fdbb30c1067eb27eb3da47e08b99b4"></i>
    
    </a>
    
    </div>
    
      
      <ul class="nav docs-sidenav collapse  " id="id39fdbb30c1067eb27eb3da47e08b99b4">
      



  <li class="child level "><a href="/books/k8s-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2020-jimmysong-kubernetes-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/14.%E8%AE%BF%E9%97%AE%E9%9B%86%E7%BE%A4/accessing-kubernetes-pods-from-outside-of-the-cluster/">accessing-kubernetes-pods-from-outside-of-the-cluster</a></li>




  <li class="child level "><a href="/books/k8s-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2020-jimmysong-kubernetes-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/14.%E8%AE%BF%E9%97%AE%E9%9B%86%E7%BE%A4/authenticate-across-clusters-kubeconfig/">authenticate-across-clusters-kubeconfig</a></li>




  <li class="child level "><a href="/books/k8s-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2020-jimmysong-kubernetes-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/14.%E8%AE%BF%E9%97%AE%E9%9B%86%E7%BE%A4/connecting-to-applications-port-forward/">connecting-to-applications-port-forward</a></li>




  <li class="child level "><a href="/books/k8s-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2020-jimmysong-kubernetes-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/14.%E8%AE%BF%E9%97%AE%E9%9B%86%E7%BE%A4/kubernator-kubernetes-ui/">kubernator-kubernetes-ui</a></li>




  <li class="child level "><a href="/books/k8s-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2020-jimmysong-kubernetes-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/14.%E8%AE%BF%E9%97%AE%E9%9B%86%E7%BE%A4/lens/">lens</a></li>




  <li class="child level "><a href="/books/k8s-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2020-jimmysong-kubernetes-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/14.%E8%AE%BF%E9%97%AE%E9%9B%86%E7%BE%A4/methods/">methods</a></li>




  <li class="child level "><a href="/books/k8s-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2020-jimmysong-kubernetes-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/14.%E8%AE%BF%E9%97%AE%E9%9B%86%E7%BE%A4/service-access-application-cluster/">service-access-application-cluster</a></li>

      
        </ul>
      
    

    
      </div>
    




  
    
    
    
    
      
    
    

    
    
    
    <div class="docs-toc-item has-child">
    <div class="parent-node d-flex justify-content-between" onClick="Collapse(&#34;caret-idf4cf6ce46a88a0c077dfca9b9e734c24&#34;)" href="#idf4cf6ce46a88a0c077dfca9b9e734c24" aria-expanded="false" aria-controls="idf4cf6ce46a88a0c077dfca9b9e734c24" aria-hidden="false" data-toggle="collapse">
    
    <a class="d-inline docs-toc-link " href="/books/k8s-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2020-jimmysong-kubernetes-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/15.%E9%83%A8%E7%BD%B2%E5%BA%94%E7%94%A8/">_index</a>
    <a class="nav-toogle d-inline level" aria-hidden="false" data-toggle="collapse" href="#idf4cf6ce46a88a0c077dfca9b9e734c24" aria-expanded="false" aria-controls="idf4cf6ce46a88a0c077dfca9b9e734c24">
    
        <i class="fa-solid fa-angle-right" id="caret-idf4cf6ce46a88a0c077dfca9b9e734c24"></i>
    
    </a>
    
    </div>
    
      
      <ul class="nav docs-sidenav collapse  " id="idf4cf6ce46a88a0c077dfca9b9e734c24">
      



  <li class="child level "><a href="/books/k8s-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2020-jimmysong-kubernetes-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/15.%E9%83%A8%E7%BD%B2%E5%BA%94%E7%94%A8/deploy-applications-in-kubernetes/">deploy-applications-in-kubernetes</a></li>




  <li class="child level "><a href="/books/k8s-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2020-jimmysong-kubernetes-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/15.%E9%83%A8%E7%BD%B2%E5%BA%94%E7%94%A8/migrating-hadoop-yarn-to-kubernetes/">migrating-hadoop-yarn-to-kubernetes</a></li>




  <li class="child level "><a href="/books/k8s-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2020-jimmysong-kubernetes-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/15.%E9%83%A8%E7%BD%B2%E5%BA%94%E7%94%A8/using-statefulset/">using-statefulset</a></li>

      
        </ul>
      
    

    
      </div>
    




  
    
    
    
    
      
    
    

    
    
    
    <div class="docs-toc-item has-child">
    <div class="parent-node d-flex justify-content-between" onClick="Collapse(&#34;caret-iddc4a814b092bd6f1cf42d650fe7e06ef&#34;)" href="#iddc4a814b092bd6f1cf42d650fe7e06ef" aria-expanded="false" aria-controls="iddc4a814b092bd6f1cf42d650fe7e06ef" aria-hidden="false" data-toggle="collapse">
    
    <a class="d-inline docs-toc-link " href="/books/k8s-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2020-jimmysong-kubernetes-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/17.%E5%BC%80%E5%8F%91%E6%8C%87%E5%8D%97/">_index</a>
    <a class="nav-toogle d-inline level" aria-hidden="false" data-toggle="collapse" href="#iddc4a814b092bd6f1cf42d650fe7e06ef" aria-expanded="false" aria-controls="iddc4a814b092bd6f1cf42d650fe7e06ef">
    
        <i class="fa-solid fa-angle-right" id="caret-iddc4a814b092bd6f1cf42d650fe7e06ef"></i>
    
    </a>
    
    </div>
    
      
      <ul class="nav docs-sidenav collapse  " id="iddc4a814b092bd6f1cf42d650fe7e06ef">
      



  <li class="child level "><a href="/books/k8s-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2020-jimmysong-kubernetes-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/17.%E5%BC%80%E5%8F%91%E6%8C%87%E5%8D%97/advance-developer/">advance-developer</a></li>




  <li class="child level "><a href="/books/k8s-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2020-jimmysong-kubernetes-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/17.%E5%BC%80%E5%8F%91%E6%8C%87%E5%8D%97/client-go-sample/">client-go-sample</a></li>




  <li class="child level "><a href="/books/k8s-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2020-jimmysong-kubernetes-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/17.%E5%BC%80%E5%8F%91%E6%8C%87%E5%8D%97/contribute/">contribute</a></li>




  <li class="child level "><a href="/books/k8s-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2020-jimmysong-kubernetes-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/17.%E5%BC%80%E5%8F%91%E6%8C%87%E5%8D%97/developing-environment/">developing-environment</a></li>




  <li class="child level "><a href="/books/k8s-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2020-jimmysong-kubernetes-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/17.%E5%BC%80%E5%8F%91%E6%8C%87%E5%8D%97/kubebuilder/">kubebuilder</a></li>




  <li class="child level "><a href="/books/k8s-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2020-jimmysong-kubernetes-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/17.%E5%BC%80%E5%8F%91%E6%8C%87%E5%8D%97/minikube/">minikube</a></li>




  <li class="child level "><a href="/books/k8s-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2020-jimmysong-kubernetes-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/17.%E5%BC%80%E5%8F%91%E6%8C%87%E5%8D%97/operator/">operator</a></li>




  <li class="child level "><a href="/books/k8s-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2020-jimmysong-kubernetes-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/17.%E5%BC%80%E5%8F%91%E6%8C%87%E5%8D%97/operator-sdk/">operator-sdk</a></li>




  <li class="child level "><a href="/books/k8s-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2020-jimmysong-kubernetes-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/17.%E5%BC%80%E5%8F%91%E6%8C%87%E5%8D%97/sigs-and-working-group/">sigs-and-working-group</a></li>




  <li class="child level "><a href="/books/k8s-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2020-jimmysong-kubernetes-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/17.%E5%BC%80%E5%8F%91%E6%8C%87%E5%8D%97/testing/">testing</a></li>

      
        </ul>
      
    

    
      </div>
    




  
    
    
    
    
      
    
    

    
    
    
    <div class="docs-toc-item has-child">
    <div class="parent-node d-flex justify-content-between" onClick="Collapse(&#34;caret-idc379548d194af53b89f5e96849eabfca&#34;)" href="#idc379548d194af53b89f5e96849eabfca" aria-expanded="false" aria-controls="idc379548d194af53b89f5e96849eabfca" aria-hidden="false" data-toggle="collapse">
    
    <a class="d-inline docs-toc-link " href="/books/k8s-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2020-jimmysong-kubernetes-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/01.kubernetes-%E6%9E%B6%E6%9E%84/">01.Kubernetes 架构</a>
    <a class="nav-toogle d-inline level" aria-hidden="false" data-toggle="collapse" href="#idc379548d194af53b89f5e96849eabfca" aria-expanded="false" aria-controls="idc379548d194af53b89f5e96849eabfca">
    
        <i class="fa-solid fa-angle-right" id="caret-idc379548d194af53b89f5e96849eabfca"></i>
    
    </a>
    
    </div>
    
      
      <ul class="nav docs-sidenav collapse  " id="idc379548d194af53b89f5e96849eabfca">
      



  <li class="child level "><a href="/books/k8s-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2020-jimmysong-kubernetes-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/01.kubernetes-%E6%9E%B6%E6%9E%84/11.pod-%E7%8A%B6%E6%80%81%E4%B8%8E%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E7%AE%A1%E7%90%86/">11.Pod 状态与生命周期管理</a></li>




  <li class="child level "><a href="/books/k8s-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2020-jimmysong-kubernetes-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/01.kubernetes-%E6%9E%B6%E6%9E%84/4.kubernetes-%E7%9A%84%E8%AE%BE%E8%AE%A1%E7%90%86%E5%BF%B5/">4.Kubernetes 的设计理念</a></li>




  <li class="child level "><a href="/books/k8s-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2020-jimmysong-kubernetes-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/01.kubernetes-%E6%9E%B6%E6%9E%84/5.etcd-%E8%A7%A3%E6%9E%90/">5.Etcd 解析</a></li>




  
    
    
    
    
      
    
    

    
    
    
    <div class="docs-toc-item has-child">
    <div class="parent-node d-flex justify-content-between" onClick="Collapse(&#34;caret-id368e72318dd32dbcd50de93ab64365e7&#34;)" href="#id368e72318dd32dbcd50de93ab64365e7" aria-expanded="false" aria-controls="id368e72318dd32dbcd50de93ab64365e7" aria-hidden="false" data-toggle="collapse">
    
    <a class="d-inline docs-toc-link " href="/books/k8s-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2020-jimmysong-kubernetes-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/01.kubernetes-%E6%9E%B6%E6%9E%84/6.%E5%BC%80%E6%94%BE%E6%8E%A5%E5%8F%A3/">6.开放接口</a>
    <a class="nav-toogle d-inline level" aria-hidden="false" data-toggle="collapse" href="#id368e72318dd32dbcd50de93ab64365e7" aria-expanded="false" aria-controls="id368e72318dd32dbcd50de93ab64365e7">
    
        <i class="fa-solid fa-angle-right" id="caret-id368e72318dd32dbcd50de93ab64365e7"></i>
    
    </a>
    
    </div>
    
      
      <ul class="nav docs-sidenav collapse  " id="id368e72318dd32dbcd50de93ab64365e7">
      



  <li class="child level "><a href="/books/k8s-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2020-jimmysong-kubernetes-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/01.kubernetes-%E6%9E%B6%E6%9E%84/6.%E5%BC%80%E6%94%BE%E6%8E%A5%E5%8F%A3/7.%E5%AE%B9%E5%99%A8%E8%BF%90%E8%A1%8C%E6%97%B6%E6%8E%A5%E5%8F%A3cri/">7.容器运行时接口（CRI）</a></li>




  <li class="child level "><a href="/books/k8s-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2020-jimmysong-kubernetes-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/01.kubernetes-%E6%9E%B6%E6%9E%84/6.%E5%BC%80%E6%94%BE%E6%8E%A5%E5%8F%A3/8.%E5%AE%B9%E5%99%A8%E7%BD%91%E7%BB%9C%E6%8E%A5%E5%8F%A3cni/">8.容器网络接口（CNI）</a></li>




  <li class="child level "><a href="/books/k8s-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2020-jimmysong-kubernetes-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/01.kubernetes-%E6%9E%B6%E6%9E%84/6.%E5%BC%80%E6%94%BE%E6%8E%A5%E5%8F%A3/9.%E5%AE%B9%E5%99%A8%E5%AD%98%E5%82%A8%E6%8E%A5%E5%8F%A3csi/">9.容器存储接口（CSI）</a></li>

      
        </ul>
      
    

    
      </div>
    

      
        </ul>
      
    

    
      </div>
    




  
    
    
    
    
      
    
    

    
    
    
    <div class="docs-toc-item has-child">
    <div class="parent-node d-flex justify-content-between" onClick="Collapse(&#34;caret-id1d05cd42f9cfbd4840e4fd53bae4dd56&#34;)" href="#id1d05cd42f9cfbd4840e4fd53bae4dd56" aria-expanded="false" aria-controls="id1d05cd42f9cfbd4840e4fd53bae4dd56" aria-hidden="false" data-toggle="collapse">
    
    <a class="d-inline docs-toc-link " href="/books/k8s-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2020-jimmysong-kubernetes-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/03.%E9%9B%86%E7%BE%A4%E8%B5%84%E6%BA%90%E7%AE%A1%E7%90%86/">03.集群资源管理</a>
    <a class="nav-toogle d-inline level" aria-hidden="false" data-toggle="collapse" href="#id1d05cd42f9cfbd4840e4fd53bae4dd56" aria-expanded="false" aria-controls="id1d05cd42f9cfbd4840e4fd53bae4dd56">
    
        <i class="fa-solid fa-angle-right" id="caret-id1d05cd42f9cfbd4840e4fd53bae4dd56"></i>
    
    </a>
    
    </div>
    
      
      <ul class="nav docs-sidenav collapse  " id="id1d05cd42f9cfbd4840e4fd53bae4dd56">
      



  <li class="child level "><a href="/books/k8s-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2020-jimmysong-kubernetes-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/03.%E9%9B%86%E7%BE%A4%E8%B5%84%E6%BA%90%E7%AE%A1%E7%90%86/22.node/">22.Node</a></li>




  <li class="child level "><a href="/books/k8s-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2020-jimmysong-kubernetes-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/03.%E9%9B%86%E7%BE%A4%E8%B5%84%E6%BA%90%E7%AE%A1%E7%90%86/23.namespace/">23.Namespace</a></li>




  <li class="child level "><a href="/books/k8s-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2020-jimmysong-kubernetes-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/03.%E9%9B%86%E7%BE%A4%E8%B5%84%E6%BA%90%E7%AE%A1%E7%90%86/24.label/">24.Label</a></li>




  <li class="child level "><a href="/books/k8s-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2020-jimmysong-kubernetes-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/03.%E9%9B%86%E7%BE%A4%E8%B5%84%E6%BA%90%E7%AE%A1%E7%90%86/25.annotation/">25.Annotation</a></li>




  <li class="child level "><a href="/books/k8s-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2020-jimmysong-kubernetes-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/03.%E9%9B%86%E7%BE%A4%E8%B5%84%E6%BA%90%E7%AE%A1%E7%90%86/26.taint-%E5%92%8C-toleration%E6%B1%A1%E7%82%B9%E5%92%8C%E5%AE%B9%E5%BF%8D/">26.Taint 和 Toleration（污点和容忍）</a></li>




  <li class="child level "><a href="/books/k8s-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2020-jimmysong-kubernetes-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/03.%E9%9B%86%E7%BE%A4%E8%B5%84%E6%BA%90%E7%AE%A1%E7%90%86/27.%E5%9E%83%E5%9C%BE%E6%94%B6%E9%9B%86/">27.垃圾收集</a></li>




  <li class="child level "><a href="/books/k8s-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2020-jimmysong-kubernetes-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/03.%E9%9B%86%E7%BE%A4%E8%B5%84%E6%BA%90%E7%AE%A1%E7%90%86/71.%E8%B5%84%E6%BA%90%E8%B0%83%E5%BA%A6/">71.资源调度</a></li>




  <li class="child level "><a href="/books/k8s-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2020-jimmysong-kubernetes-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/03.%E9%9B%86%E7%BE%A4%E8%B5%84%E6%BA%90%E7%AE%A1%E7%90%86/72.%E6%9C%8D%E5%8A%A1%E8%B4%A8%E9%87%8F%E7%AD%89%E7%BA%A7qos/">72.服务质量等级（QoS）</a></li>

      
        </ul>
      
    

    
      </div>
    




  
    
    
    
    
      
    
    

    
    
    
    <div class="docs-toc-item has-child">
    <div class="parent-node d-flex justify-content-between" onClick="Collapse(&#34;caret-id73fa50fc0f0e8300fcb24a99c4fe7e56&#34;)" href="#id73fa50fc0f0e8300fcb24a99c4fe7e56" aria-expanded="false" aria-controls="id73fa50fc0f0e8300fcb24a99c4fe7e56" aria-hidden="false" data-toggle="collapse">
    
    <a class="d-inline docs-toc-link " href="/books/k8s-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2020-jimmysong-kubernetes-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/04.%E6%8E%A7%E5%88%B6%E5%99%A8/">04.控制器</a>
    <a class="nav-toogle d-inline level" aria-hidden="false" data-toggle="collapse" href="#id73fa50fc0f0e8300fcb24a99c4fe7e56" aria-expanded="false" aria-controls="id73fa50fc0f0e8300fcb24a99c4fe7e56">
    
        <i class="fa-solid fa-angle-right" id="caret-id73fa50fc0f0e8300fcb24a99c4fe7e56"></i>
    
    </a>
    
    </div>
    
      
      <ul class="nav docs-sidenav collapse  " id="id73fa50fc0f0e8300fcb24a99c4fe7e56">
      



  <li class="child level "><a href="/books/k8s-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2020-jimmysong-kubernetes-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/04.%E6%8E%A7%E5%88%B6%E5%99%A8/29.deployment/">29.Deployment</a></li>




  <li class="child level "><a href="/books/k8s-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2020-jimmysong-kubernetes-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/04.%E6%8E%A7%E5%88%B6%E5%99%A8/30.statefulset/">30.StatefulSet</a></li>




  <li class="child level "><a href="/books/k8s-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2020-jimmysong-kubernetes-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/04.%E6%8E%A7%E5%88%B6%E5%99%A8/31.daemonset/">31.DaemonSet</a></li>




  <li class="child level "><a href="/books/k8s-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2020-jimmysong-kubernetes-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/04.%E6%8E%A7%E5%88%B6%E5%99%A8/32.replicationcontroller-%E5%92%8C-replicaset/">32.ReplicationController 和 ReplicaSet</a></li>




  <li class="child level "><a href="/books/k8s-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2020-jimmysong-kubernetes-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/04.%E6%8E%A7%E5%88%B6%E5%99%A8/33.job/">33.Job</a></li>




  <li class="child level "><a href="/books/k8s-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2020-jimmysong-kubernetes-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/04.%E6%8E%A7%E5%88%B6%E5%99%A8/34.cronjob/">34.CronJob</a></li>




  <li class="child level "><a href="/books/k8s-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2020-jimmysong-kubernetes-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/04.%E6%8E%A7%E5%88%B6%E5%99%A8/34.ingress-%E6%8E%A7%E5%88%B6%E5%99%A8/">34.Ingress 控制器</a></li>




  
    
    
    
    
      
    
    

    
    
    
    <div class="docs-toc-item has-child">
    <div class="parent-node d-flex justify-content-between" onClick="Collapse(&#34;caret-id8843184acab98f9c1f592c03cde5d6c8&#34;)" href="#id8843184acab98f9c1f592c03cde5d6c8" aria-expanded="false" aria-controls="id8843184acab98f9c1f592c03cde5d6c8" aria-hidden="false" data-toggle="collapse">
    
    <a class="d-inline docs-toc-link " href="/books/k8s-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2020-jimmysong-kubernetes-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/04.%E6%8E%A7%E5%88%B6%E5%99%A8/35.horizontal-pod-autoscaling/">35.Horizontal Pod Autoscaling</a>
    <a class="nav-toogle d-inline level" aria-hidden="false" data-toggle="collapse" href="#id8843184acab98f9c1f592c03cde5d6c8" aria-expanded="false" aria-controls="id8843184acab98f9c1f592c03cde5d6c8">
    
        <i class="fa-solid fa-angle-right" id="caret-id8843184acab98f9c1f592c03cde5d6c8"></i>
    
    </a>
    
    </div>
    
      
      <ul class="nav docs-sidenav collapse  " id="id8843184acab98f9c1f592c03cde5d6c8">
      



  <li class="child level "><a href="/books/k8s-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2020-jimmysong-kubernetes-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/04.%E6%8E%A7%E5%88%B6%E5%99%A8/35.horizontal-pod-autoscaling/36.%E8%87%AA%E5%AE%9A%E4%B9%89%E6%8C%87%E6%A0%87-hpa/">36.自定义指标 HPA</a></li>

      
        </ul>
      
    

    
      </div>
    




  <li class="child level "><a href="/books/k8s-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2020-jimmysong-kubernetes-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/04.%E6%8E%A7%E5%88%B6%E5%99%A8/37.%E5%87%86%E5%85%A5%E6%8E%A7%E5%88%B6%E5%99%A8admission-controller/">37.准入控制器（Admission Controller）</a></li>

      
        </ul>
      
    

    
      </div>
    




  
    
    
    
    
      
    
    

    
    
    
    <div class="docs-toc-item has-child">
    <div class="parent-node d-flex justify-content-between" onClick="Collapse(&#34;caret-id8d90075d981248eb8af28ee2dbf60243&#34;)" href="#id8d90075d981248eb8af28ee2dbf60243" aria-expanded="false" aria-controls="id8d90075d981248eb8af28ee2dbf60243" aria-hidden="false" data-toggle="collapse">
    
    <a class="d-inline docs-toc-link " href="/books/k8s-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2020-jimmysong-kubernetes-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/06.%E8%BA%AB%E4%BB%BD%E4%B8%8E%E6%9D%83%E9%99%90%E8%AE%A4%E8%AF%81/">06.身份与权限认证</a>
    <a class="nav-toogle d-inline level" aria-hidden="false" data-toggle="collapse" href="#id8d90075d981248eb8af28ee2dbf60243" aria-expanded="false" aria-controls="id8d90075d981248eb8af28ee2dbf60243">
    
        <i class="fa-solid fa-angle-right" id="caret-id8d90075d981248eb8af28ee2dbf60243"></i>
    
    </a>
    
    </div>
    
      
      <ul class="nav docs-sidenav collapse  " id="id8d90075d981248eb8af28ee2dbf60243">
      



  <li class="child level "><a href="/books/k8s-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2020-jimmysong-kubernetes-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/06.%E8%BA%AB%E4%BB%BD%E4%B8%8E%E6%9D%83%E9%99%90%E8%AE%A4%E8%AF%81/45-%E5%9F%BA%E4%BA%8E%E8%A7%92%E8%89%B2%E7%9A%84%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6rbac/">45-基于角色的访问控制（RBAC）</a></li>




  <li class="child level "><a href="/books/k8s-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2020-jimmysong-kubernetes-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/06.%E8%BA%AB%E4%BB%BD%E4%B8%8E%E6%9D%83%E9%99%90%E8%AE%A4%E8%AF%81/46-network-policy/">46-Network Policy</a></li>




  <li class="child level "><a href="/books/k8s-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2020-jimmysong-kubernetes-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/06.%E8%BA%AB%E4%BB%BD%E4%B8%8E%E6%9D%83%E9%99%90%E8%AE%A4%E8%AF%81/serviceaccount/">serviceaccount</a></li>




  <li class="child level "><a href="/books/k8s-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2020-jimmysong-kubernetes-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/06.%E8%BA%AB%E4%BB%BD%E4%B8%8E%E6%9D%83%E9%99%90%E8%AE%A4%E8%AF%81/spiffe/">spiffe</a></li>




  <li class="child level "><a href="/books/k8s-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2020-jimmysong-kubernetes-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/06.%E8%BA%AB%E4%BB%BD%E4%B8%8E%E6%9D%83%E9%99%90%E8%AE%A4%E8%AF%81/spire/">spire</a></li>




  <li class="child level "><a href="/books/k8s-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2020-jimmysong-kubernetes-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/06.%E8%BA%AB%E4%BB%BD%E4%B8%8E%E6%9D%83%E9%99%90%E8%AE%A4%E8%AF%81/spire-k8s-workload-registar/">spire-k8s-workload-registar</a></li>




  <li class="child level "><a href="/books/k8s-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2020-jimmysong-kubernetes-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/06.%E8%BA%AB%E4%BB%BD%E4%B8%8E%E6%9D%83%E9%99%90%E8%AE%A4%E8%AF%81/svid/">svid</a></li>

      
        </ul>
      
    

    
      </div>
    




  
    
    
    
    
      
    
    

    
    
    
    <div class="docs-toc-item has-child">
    <div class="parent-node d-flex justify-content-between" onClick="Collapse(&#34;caret-idf759f23d388589b25d9dd92d16f640a5&#34;)" href="#idf759f23d388589b25d9dd92d16f640a5" aria-expanded="false" aria-controls="idf759f23d388589b25d9dd92d16f640a5" aria-hidden="false" data-toggle="collapse">
    
    <a class="d-inline docs-toc-link " href="/books/k8s-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2020-jimmysong-kubernetes-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/08.%E5%AD%98%E5%82%A8/">08.存储</a>
    <a class="nav-toogle d-inline level" aria-hidden="false" data-toggle="collapse" href="#idf759f23d388589b25d9dd92d16f640a5" aria-expanded="false" aria-controls="idf759f23d388589b25d9dd92d16f640a5">
    
        <i class="fa-solid fa-angle-right" id="caret-idf759f23d388589b25d9dd92d16f640a5"></i>
    
    </a>
    
    </div>
    
      
      <ul class="nav docs-sidenav collapse  " id="idf759f23d388589b25d9dd92d16f640a5">
      



  <li class="child level "><a href="/books/k8s-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2020-jimmysong-kubernetes-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/08.%E5%AD%98%E5%82%A8/55.secret/">55.Secret</a></li>




  <li class="child level "><a href="/books/k8s-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2020-jimmysong-kubernetes-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/08.%E5%AD%98%E5%82%A8/56.configmap/">56.ConfigMap</a></li>




  <li class="child level "><a href="/books/k8s-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2020-jimmysong-kubernetes-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/08.%E5%AD%98%E5%82%A8/57.configmap-%E7%9A%84%E7%83%AD%E6%9B%B4%E6%96%B0/">57.ConfigMap 的热更新</a></li>




  <li class="child level "><a href="/books/k8s-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2020-jimmysong-kubernetes-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/08.%E5%AD%98%E5%82%A8/58.volume/">58.Volume</a></li>




  <li class="child level "><a href="/books/k8s-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2020-jimmysong-kubernetes-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/08.%E5%AD%98%E5%82%A8/59.%E6%8C%81%E4%B9%85%E5%8C%96%E5%8D%B7persistent-volume/">59.持久化卷（Persistent Volume）</a></li>




  <li class="child level "><a href="/books/k8s-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2020-jimmysong-kubernetes-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/08.%E5%AD%98%E5%82%A8/60.storage-class/">60.Storage Class</a></li>




  <li class="child level "><a href="/books/k8s-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2020-jimmysong-kubernetes-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/08.%E5%AD%98%E5%82%A8/61.%E6%9C%AC%E5%9C%B0%E6%8C%81%E4%B9%85%E5%8C%96%E5%AD%98%E5%82%A8/">61.本地持久化存储</a></li>

      
        </ul>
      
    

    
      </div>
    

      
        </ul>
      
    

    
      </div>
    

    
  
</nav>

    </div>

    
    
    <div class="d-none d-xl-block col-xl-2 docs-toc">
      
     
      <ul class="nav toc-top">
        <li><a href="#" id="back_to_top" class="docs-toc-title">目录</a></li>
      </ul>
     

      <nav id="TableOfContents">
  <ul>
    <li><a href="#type-book">weight: 64
title: 使用 CRD 扩展 Kubernetes API
date: &lsquo;2022-05-21T00:00:00+08:00&rsquo;
type: book</a></li>
    <li><a href="#创建-crdcustomresourcedefinition">创建 CRD（CustomResourceDefinition）</a></li>
    <li><a href="#创建自定义对象">创建自定义对象</a></li>
    <li><a href="#删除-customresourcedefinition">删除 CustomResourceDefinition</a></li>
    <li><a href="#高级主题">高级主题</a>
      <ul>
        <li><a href="#finalizer终结器">Finalizer（终结器）</a></li>
        <li><a href="#validation验证">Validation（验证）</a></li>
        <li><a href="#其他打印列">其他打印列</a></li>
        <li><a href="#子资源">子资源</a></li>
        <li><a href="#category分类">Category（分类）</a></li>
      </ul>
    </li>
    <li><a href="#参考">参考</a></li>
  </ul>
</nav>

      
<div class="subscribe-module col-24 mt-1">
    <img src="https://ngte-superbed.oss-cn-beijing.aliyuncs.com/item/20230220172727.png" alt="image" title="王下邀月熊的微信公众号"/>
</div>



    </div>
    

    <main class="py-md-3 pl-md-3 docs-content col-xl-8" role="main">

      <article class="article">

          

          <h1>crd</h1>

          <div class="article-style">
            <hr>
<h2 id="type-book">weight: 64
title: 使用 CRD 扩展 Kubernetes API
date: &lsquo;2022-05-21T00:00:00+08:00&rsquo;
type: book</h2>
<p>本文是如何创建 CRD 来扩展 Kubernetes API 的教程。CRD 是用来扩展 Kubernetes 最常用的方式，在 Service Mesh 和 Operator 中也被大量使用。因此读者如果想在 Kubernetes 上做扩展和开发的话，是十分有必要了解 CRD 的。</p>
<p>在阅读本文前您需要先了解<a href="../custom-resource">使用自定义资源扩展 API</a>， 以下内容译自 <a href="https://kubernetes.io/docs/tasks/access-kubernetes-api/custom-resources/custom-resource-definitions/" target="_blank" rel="noopener">Kubernetes 官方文档</a>，有删改，推荐阅读<a href="https://cloudnative.to/blog/kubernetes-crd-quick-start/" target="_blank" rel="noopener">如何从零开始编写一个 Kubernetes CRD</a>。</p>
<h2 id="创建-crdcustomresourcedefinition">创建 CRD（CustomResourceDefinition）</h2>
<p>创建新的 CustomResourceDefinition（CRD）时，Kubernetes API Server 会为您指定的每个版本创建新的 RESTful 资源路径。CRD 可以是命名空间的，也可以是集群范围的，可以在 CRD <code>scope</code> 字段中所指定。与现有的内置对象一样，删除命名空间会删除该命名空间中的所有自定义对象。CustomResourceDefinition 本身是非命名空间的，可供所有命名空间使用。</p>
<p>参考下面的 CRD，将其配置保存在 <code>resourcedefinition.yaml</code> 文件中：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l">apiextensions.k8s.io/v1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">CustomResourceDefinition</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c"># 名称必须符合下面的格式：&lt;plural&gt;.&lt;group&gt;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">crontabs.stable.example.com</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c"># REST API使用的组名称：/apis/&lt;group&gt;/&lt;version&gt;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">group</span><span class="p">:</span><span class="w"> </span><span class="l">stable.example.com</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c"># REST API使用的版本号：/apis/&lt;group&gt;/&lt;version&gt;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">versions</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">v1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="c"># 可以通过 served 来开关每个 version</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">served</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="c"># 有且仅有一个 version 开启存储</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">storage</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">schema</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">openAPIV3Schema</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">object</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">properties</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">              </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">object</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">              </span><span class="nt">properties</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="nt">cronSpec</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">string</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="nt">image</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">string</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="nt">replicas</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">integer</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c"># Namespaced或Cluster</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">scope</span><span class="p">:</span><span class="w"> </span><span class="l">Namespaced</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">names</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c"># URL中使用的复数名称: /apis/&lt;group&gt;/&lt;version&gt;/&lt;plural&gt;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">plural</span><span class="p">:</span><span class="w"> </span><span class="l">crontabs</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c"># CLI中使用的单数名称</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">singular</span><span class="p">:</span><span class="w"> </span><span class="l">crontab</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c"># CamelCased格式的单数类型。在清单文件中使用</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">CronTab</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c"># CLI中使用的资源简称</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">shortNames</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="l">ct</span><span class="w">
</span></span></span></code></pre></div><blockquote>
<p>此处使用的 apiVersion 版本是 <code>apiextensions.k8s.io/v1</code>，跟上一版 <code>apiextensions.k8s.io/v1beta1</code> 的最主要区别是改用了 <a href="https://kubernetes.io/docs/tasks/access-kubernetes-api/extend-api-custom-resource-definitions/#validation" target="_blank" rel="noopener">OpenAPI v3.0 validation schema</a>。</p>
</blockquote>
<p>创建该 CRD：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">kubectl create -f resourcedefinition.yaml
</span></span></code></pre></div><p>访问 RESTful API 端点如 <code>http://172.20.0.113:8080</code> 将看到如下 API 端点已创建：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">/apis/stable.example.com/v1/namespaces/*/crontabs/...
</span></span></code></pre></div><p>然后，此端点 URL 可用于创建和管理自定义对象。上面的 CRD 中定义的类型就是 <code>CronTab</code>。</p>
<p>可能需要几秒钟才能创建端点。您可以监控 CustomResourceDefinition 中 <code>Established</code> 的状态何时为 true，或者查看 API 资源的发现信息中是否显示了您的资源。</p>
<h2 id="创建自定义对象">创建自定义对象</h2>
<p>创建 CustomResourceDefinition 对象后，您可以创建自定义对象。自定义对象可包含自定义字段。这些字段可以包含任意  JSON。在以下示例中， <code>cronSpec</code> 和 <code>image</code> 自定义字段在自定义对象中设置 <code>CronTab</code>。<code>CronTab</code> 类型来自您在上面创建的 CustomResourceDefinition 对象的规范。</p>
<p>如果您将以下 YAML 保存到 <code>my-crontab.yaml</code>：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;stable.example.com/v1&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">CronTab</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">my-new-cron-object</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">cronSpec</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;* * * * */5&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">my-awesome-cron-image</span><span class="w">
</span></span></span></code></pre></div><p>并创建它：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">kubectl create -f my-crontab.yaml
</span></span></code></pre></div><p>然后，您可以使用 kubectl 管理 CronTab 对象。例如：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">kubectl get crontab
</span></span></code></pre></div><p>应该打印这样的列表：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">NAME                 AGE
</span></span><span class="line"><span class="cl">my-new-cron-object   6s
</span></span></code></pre></div><p>使用 kubectl 时，资源名称不区分大小写，您可以使用 CRD 中定义的单数或复数形式，以及任何短名称。</p>
<p>您还可以查看原始 YAML 数据：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">kubectl get ct -o yaml
</span></span></code></pre></div><p>您应该看到它的 yaml 中的自定义 <code>cronSpec</code> 和 <code>image</code> 字段：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l">v1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">items</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span>- <span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l">stable.example.com/v1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">CronTab</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">clusterName</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">creationTimestamp</span><span class="p">:</span><span class="w"> </span><span class="ld">2017-05-31T12:56:35Z</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">deletionGracePeriodSeconds</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">deletionTimestamp</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">my-new-cron-object</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l">default</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">resourceVersion</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;285&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">selfLink</span><span class="p">:</span><span class="w"> </span><span class="l">/apis/stable.example.com/v1/namespaces/default/crontabs/my-new-cron-object</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">uid</span><span class="p">:</span><span class="w"> </span><span class="l">9423255b-4600-11e7-af6a-28d2447dc82b</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">cronSpec</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;* * * * */5&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">my-awesome-cron-image</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">List</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">resourceVersion</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">selfLink</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;&#34;</span><span class="w">
</span></span></span></code></pre></div><h2 id="删除-customresourcedefinition">删除 CustomResourceDefinition</h2>
<p>删除 CustomResourceDefinition 时，服务器将删除 RESTful API 端点并<strong>删除存储在其中的所有自定义对象</strong>。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">kubectl delete -f resourcedefinition.yaml
</span></span><span class="line"><span class="cl">kubectl get crontabs
</span></span><span class="line"><span class="cl">Error from server <span class="o">(</span>NotFound<span class="o">)</span>: Unable to list <span class="s2">&#34;crontabs&#34;</span>: the server could not find the requested resource <span class="o">(</span>get crontabs.stable.example.com<span class="o">)</span>
</span></span></code></pre></div><p>如果稍后重新创建相同的 CustomResourceDefinition，它将从空开始。</p>
<h2 id="高级主题">高级主题</h2>
<h3 id="finalizer终结器">Finalizer（终结器）</h3>
<p>Finalizer（终结器）允许控制器实现异步预删除 hook。自定义对象支持终结器，就像内置对象一样。</p>
<p>您可以将终结器添加到自定义对象，如下所示：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;stable.example.com/v1&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">CronTab</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">finalizers</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="l">finalizer.stable.example.com</span><span class="w">
</span></span></span></code></pre></div><p>终结器是任意字符串值，当存在时确保在资源存在时不可能进行硬删除。</p>
<p>对具有终结器的对象的第一个删除请求设置该<code>metadata.deletionTimestamp</code>字段的值， 但不删除它。设置此值后，<code>finalizer</code> 只能删除列表中的条目。</p>
<p>如果设置了 <code>metadata.deletionTimestamp</code> 字段，控制器监控对象将执行它们所有的终结器，对该对象轮询更新请求。执行完所有终结器后，将删除该资源。</p>
<p>值<code>metadata.deletionGracePeriodSeconds</code>控制轮询更新之间的间隔。</p>
<p>每个控制器都有责任从列表中删除其终结器。</p>
<p>如果终结器列表为空，Kubernetes 最终只会删除该对象，这意味着所有终结器都已执行。</p>
<h3 id="validation验证">Validation（验证）</h3>
<p><strong>功能状态：</strong> <code>Kubernetes v1.12</code> <a href="https://kubernetes.io/docs/tasks/access-kubernetes-api/custom-resources/custom-resource-definitions/#" target="_blank" rel="noopener">beta</a></p>
<p>可以通过 <a href="https://github.com/OAI/OpenAPI-Specification/blob/master/versions/3.0.0.md#schemaObject" target="_blank" rel="noopener">OpenAPI v3 schema</a>验证自定义对象是否符合标准 。此外，以下限制适用于 schema：</p>
<ul>
<li>字段<code>default</code>、<code>nullable</code>、<code>discriminator</code>、<code>readOnly</code>、<code>writeOnly</code>、<code>xml</code>、 <code>deprecated</code> 和 <code>$ref</code> 不能设置。</li>
<li>该字段 <code>uniqueItems</code> 不能设置为 true。</li>
<li>该字段 <code>additionalProperties</code> 不能设置为 false。</li>
</ul>
<p>您可以使用 <a href="https://kubernetes.io/docs/admin/kube-apiserver" target="_blank" rel="noopener">kube-apiserver</a><code>CustomResourceValidation</code> 上的功能门（feature gate）禁用此功能：</p>
<pre tabindex="0"><code>--feature-gates=CustomResourceValidation=false
</code></pre><p>该 schema 在 CustomResourceDefinition 中定义。在以下示例中，CustomResourceDefinition 对自定义对象应用以下验证：</p>
<ul>
<li><code>spec.cronSpec</code>  必须是字符串，并且必须是正则表达式描述的形式。</li>
<li><code>spec.replicas</code>  必须是整数，且最小值必须为 1，最大值为 10。</li>
</ul>
<p>将 CustomResourceDefinition 保存到 <code>resourcedefinition.yaml</code>：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l">apiextensions.k8s.io/v1beta1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">CustomResourceDefinition</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">crontabs.stable.example.com</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">group</span><span class="p">:</span><span class="w"> </span><span class="l">stable.example.com</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">versions</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">v1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">served</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">storage</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="l">v1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">scope</span><span class="p">:</span><span class="w"> </span><span class="l">Namespaced</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">names</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">plural</span><span class="p">:</span><span class="w"> </span><span class="l">crontabs</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">singular</span><span class="p">:</span><span class="w"> </span><span class="l">crontab</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">CronTab</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">shortNames</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="l">ct</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">validation</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="c"># openAPIV3Schema 适用于验证自定义对象的 schema。</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">openAPIV3Schema</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">properties</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">properties</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="nt">cronSpec</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">              </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">string</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">              </span><span class="nt">pattern</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;^(\d+|\*)(/\d+)?(\s+(\d+|\*)(/\d+)?){4}$&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="nt">replicas</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">              </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">integer</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">              </span><span class="nt">minimum</span><span class="p">:</span><span class="w"> </span><span class="m">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">              </span><span class="nt">maximum</span><span class="p">:</span><span class="w"> </span><span class="m">10</span><span class="w">
</span></span></span></code></pre></div><p>并创建它：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">kubectl create -f resourcedefinition.yaml
</span></span></code></pre></div><p><code>CronTab</code> 如果其字段中存在无效值，则将拒绝创建类型的自定义对象的请求。在以下示例中，自定义对象包含具有无效值的字段：</p>
<ul>
<li><code>spec.cronSpec</code> 与正则表达式不匹配。</li>
<li><code>spec.replicas</code> 大于10。</li>
</ul>
<p>如果您将以下YAML保存到<code>my-crontab.yaml</code>：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;stable.example.com/v1&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">CronTab</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">my-new-cron-object</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">cronSpec</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;* * * *&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">my-awesome-cron-image</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">replicas</span><span class="p">:</span><span class="w"> </span><span class="m">15</span><span class="w">
</span></span></span></code></pre></div><p>并创建它：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">kubectl create -f my-crontab.yaml
</span></span></code></pre></div><p>你会收到一个错误：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">The CronTab <span class="s2">&#34;my-new-cron-object&#34;</span> is invalid: <span class="o">[]</span>: Invalid value: map<span class="o">[</span>string<span class="o">]</span>interface <span class="o">{}{</span><span class="s2">&#34;apiVersion&#34;</span>:<span class="s2">&#34;stable.example.com/v1&#34;</span>, <span class="s2">&#34;kind&#34;</span>:<span class="s2">&#34;CronTab&#34;</span>, <span class="s2">&#34;metadata&#34;</span>:map<span class="o">[</span>string<span class="o">]</span>interface <span class="o">{}{</span><span class="s2">&#34;name&#34;</span>:<span class="s2">&#34;my-new-cron-object&#34;</span>, <span class="s2">&#34;namespace&#34;</span>:<span class="s2">&#34;default&#34;</span>, <span class="s2">&#34;deletionTimestamp&#34;</span>:interface <span class="o">{}(</span>nil<span class="o">)</span>, <span class="s2">&#34;deletionGracePeriodSeconds&#34;</span>:<span class="o">(</span>*int64<span class="o">)(</span>nil<span class="o">)</span>, <span class="s2">&#34;creationTimestamp&#34;</span>:<span class="s2">&#34;2017-09-05T05:20:07Z&#34;</span>, <span class="s2">&#34;uid&#34;</span>:<span class="s2">&#34;e14d79e7-91f9-11e7-a598-f0761cb232d1&#34;</span>, <span class="s2">&#34;selfLink&#34;</span>:<span class="s2">&#34;&#34;</span>, <span class="s2">&#34;clusterName&#34;</span>:<span class="s2">&#34;&#34;</span><span class="o">}</span>, <span class="s2">&#34;spec&#34;</span>:map<span class="o">[</span>string<span class="o">]</span>interface <span class="o">{}{</span><span class="s2">&#34;cronSpec&#34;</span>:<span class="s2">&#34;* * * *&#34;</span>, <span class="s2">&#34;image&#34;</span>:<span class="s2">&#34;my-awesome-cron-image&#34;</span>, <span class="s2">&#34;replicas&#34;</span>:15<span class="o">}}</span>:
</span></span><span class="line"><span class="cl">validation failure list:
</span></span><span class="line"><span class="cl">spec.cronSpec in body should match <span class="s1">&#39;^(\d+|\*)(/\d+)?(\s+(\d+|\*)(/\d+)?){4}$&#39;</span>
</span></span><span class="line"><span class="cl">spec.replicas in body should be less than or equal to <span class="m">10</span>
</span></span></code></pre></div><p>如果字段包含有效值，则接受对象创建请求。</p>
<p>将以下 YAML 保存到 <code>my-crontab.yaml</code>：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;stable.example.com/v1&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">CronTab</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">my-new-cron-object</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">cronSpec</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;* * * * */5&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">my-awesome-cron-image</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">replicas</span><span class="p">:</span><span class="w"> </span><span class="m">5</span><span class="w">
</span></span></span></code></pre></div><p>并创建它：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">kubectl create -f my-crontab.yaml
</span></span><span class="line"><span class="cl">crontab <span class="s2">&#34;my-new-cron-object&#34;</span> created
</span></span></code></pre></div><h3 id="其他打印列">其他打印列</h3>
<p>从 Kubernetes 1.11 开始，kubectl 使用服务器端打印。服务器决定 <code>kubectl get</code> 命令显示哪些列。您可以使用 CustomResourceDefinition 自定义这些列。下面的示例将输出 <code>Spec</code>、<code>Replicas</code> 和 <code>Age</code>  列。</p>
<ol>
<li>
<p>将 CustomResourceDefinition 保存到 <code>resourcedefinition.yaml</code>。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="w">  </span><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l">apiextensions.k8s.io/v1beta1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">CustomResourceDefinition</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">crontabs.stable.example.com</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">group</span><span class="p">:</span><span class="w"> </span><span class="l">stable.example.com</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="l">v1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">scope</span><span class="p">:</span><span class="w"> </span><span class="l">Namespaced</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">names</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">plural</span><span class="p">:</span><span class="w"> </span><span class="l">crontabs</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">singular</span><span class="p">:</span><span class="w"> </span><span class="l">crontab</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">CronTab</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">shortNames</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="l">ct</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">additionalPrinterColumns</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">Spec</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">string</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l">The cron spec defining the interval a CronJob is run</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">JSONPath</span><span class="p">:</span><span class="w"> </span><span class="l">.spec.cronSpec</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">Replicas</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">integer</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l">The number of jobs launched by the CronJob</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">JSONPath</span><span class="p">:</span><span class="w"> </span><span class="l">.spec.replicas</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">Age</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">date</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">JSONPath</span><span class="p">:</span><span class="w"> </span><span class="l">.metadata.creationTimestamp</span><span class="w">
</span></span></span></code></pre></div></li>
<li>
<p>创建 CustomResourceDefinition：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">kubectl create -f resourcedefinition.yaml
</span></span></code></pre></div></li>
<li>
<p>使用上一节中的创建的  <code>my-crontab.yaml</code>  实例。</p>
</li>
<li>
<p>调用服务器端打印：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">kubectl get crontab my-new-cron-object
</span></span></code></pre></div><p>请注意 <code>NAME</code>、<code>SPEC</code>、<code>REPLICAS</code> 和 <code>AGE</code> 在输出列：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  NAME                 SPEC        REPLICAS   AGE
</span></span><span class="line"><span class="cl">  my-new-cron-object   * * * * *   <span class="m">1</span>          7s
</span></span></code></pre></div></li>
</ol>
<p><code>NAME</code> 列是隐含的，不需要在 CustomResourceDefinition 中定义。</p>
<h4 id="priority优先级">Priority（优先级）</h4>
<p>每列中都包含一个 <code>priority</code> 字段。目前，优先级区分标准视图或 wide 视图中显示的列（使用 <code>-o wide</code> 标志）。</p>
<ul>
<li>具有优先级的列 <code>0</code> 显示在标准视图中。</li>
<li>优先级大于 <code>0</code> 的列仅在 wide 视图中显示。</li>
</ul>
<h4 id="type类型">Type（类型）</h4>
<p>列中的 <code>type</code> 字段可以是以下任何一种（参考 <a href="https://github.com/OAI/OpenAPI-Specification/blob/master/versions/3.0.0.md#dataTypes" target="_blank" rel="noopener">OpenAPI v3 数据类型</a>）：</p>
<ul>
<li><code>integer</code> - 非浮点数</li>
<li><code>number</code> - 浮点数</li>
<li><code>string</code> - 字符串</li>
<li><code>boolean</code> - ture 或 false</li>
<li><code>date</code> - 自此时间戳以来的时间差异呈现</li>
</ul>
<p>如果 CustomResource 中的值与为列指定的类型不匹配，则省略该值。使用 CustomResource 验证以确保值类型正确。</p>
<h4 id="format格式">Format（格式）</h4>
<p>列中的 <code>format</code> 字段可以是以下任何一个：</p>
<ul>
<li><code>int32</code></li>
<li><code>int64</code></li>
<li><code>float</code></li>
<li><code>double</code></li>
<li><code>byte</code></li>
<li><code>date</code></li>
<li><code>date-time</code></li>
<li><code>password</code></li>
</ul>
<p>该列 <code>format</code> 控制 <code>kubectl</code> 打印值时使用的样式。</p>
<h3 id="子资源">子资源</h3>
<p><strong>功能状态：</strong> <code>Kubernetes v1.12</code> <a href="https://kubernetes.io/docs/tasks/access-kubernetes-api/custom-resources/custom-resource-definitions/#" target="_blank" rel="noopener">beta</a></p>
<p>自定义资源支持 <code>/status</code> 和 <code>/scale</code> 子资源。</p>
<p>您可以使用 <a href="https://kubernetes.io/docs/admin/kube-apiserver" target="_blank" rel="noopener">kube-apiserver</a> <code>CustomResourceSubresources</code> 上的功能门（feature gate）禁用此功能：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">--feature-gates<span class="o">=</span><span class="nv">CustomResourceSubresources</span><span class="o">=</span><span class="nb">false</span>
</span></span></code></pre></div><p>可以通过在 CustomResourceDefinition 中定义它们来选择性地启用 status 和 scale 子资源。</p>
<h4 id="状态子资源">状态子资源</h4>
<p>启用状态子资源后，将公开自定义资源的子资源 <code>/status</code>。</p>
<ul>
<li>状态和规范节分别由自定义资源内的 JSONPath <code>.status</code> 和 <code>.spec</code> JSONPath 表示。</li>
<li><code>PUT</code> <code>/status</code> 对子资源的请求采用自定义资源对象，并忽略除状态节之外的任何更改。</li>
<li><code>PUT</code> <code>/status</code> 对子资源的请求仅验证自定义资源的状态节。</li>
<li><code>PUT</code>/ <code>POST</code>/ <code>PATCH</code> 请求自定义资源忽略更改状态节。</li>
<li>对 spec 节的任何更改都会增加 <code>.metadata.generation</code> 的值。</li>
<li>在 CRD OpenAPI 验证模式的根目录中只允许以下构造：
<ul>
<li>Description</li>
<li>Example</li>
<li>ExclusiveMaximum</li>
<li>ExclusiveMinimum</li>
<li>ExternalDocs</li>
<li>Format</li>
<li>Items</li>
<li>Maximum</li>
<li>MaxItems</li>
<li>MaxLength</li>
<li>Minimum</li>
<li>MinItems</li>
<li>MinLength</li>
<li>MultipleOf</li>
<li>Pattern</li>
<li>Properties</li>
<li>Required</li>
<li>Title</li>
<li>Type</li>
<li>UniqueItems</li>
</ul>
</li>
</ul>
<h4 id="扩展子资源">扩展子资源</h4>
<p>启用 scale 子资源后，将公开自定义资源的子资源 <code>/scale</code>。该 <code>autoscaling/v1.Scale</code> 对象作为有效负载发送 <code>/scale</code>。</p>
<p>要启用 scale 子资源，CustomResourceDefinition 中需要定义以下值。</p>
<ul>
<li><code>SpecReplicasPath</code> 在与之对应的自定义资源中定义 JSONPath <code>Scale.Spec.Replicas</code>。
<ul>
<li>这是一个必需的值。</li>
<li><code>.spec</code>  只允许使用带点符号的 JSONPaths 。</li>
<li>如果 <code>SpecReplicasPath</code> 自定义资源中没有值，则 <code>/scale</code> 子资源将在GET上返回错误。</li>
</ul>
</li>
<li><code>StatusReplicasPath</code> 在与之对应的自定义资源中定义 JSONPath <code>Scale.Status.Replicas</code>。
<ul>
<li>这是一个必需的值。</li>
<li><code>.stutus</code> 只允许使用带点符号的 JSONPaths 。</li>
<li>如果 <code>StatusReplicasPath</code> 自定义资源中没有值，则子资源 <code>/scale</code> 中的状态副本值将默认为 0。</li>
</ul>
</li>
<li><code>LabelSelectorPath </code>在与之对应的自定义资源中定义 JSONPath <code>Scale.Status.Selector</code>。
<ul>
<li>这是一个可选值。</li>
<li>必须将其设置为与 HPA 一起使用。</li>
<li><code>.status</code> 只允许使用带点符号的 JSONPaths 。</li>
<li>如果 <code>LabelSelectorPath</code> 自定义资源中没有值，则子资源 <code>/scale</code> 中的状态选择器值将默认为空字符串。</li>
</ul>
</li>
</ul>
<p>在以下示例中，启用了status 和 scale 子资源。</p>
<p>将 CustomResourceDefinition 保存到<code>resourcedefinition.yaml</code>：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l">apiextensions.k8s.io/v1beta1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">CustomResourceDefinition</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">crontabs.stable.example.com</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">group</span><span class="p">:</span><span class="w"> </span><span class="l">stable.example.com</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">versions</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">v1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">served</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">storage</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">scope</span><span class="p">:</span><span class="w"> </span><span class="l">Namespaced</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">names</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">plural</span><span class="p">:</span><span class="w"> </span><span class="l">crontabs</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">singular</span><span class="p">:</span><span class="w"> </span><span class="l">crontab</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">CronTab</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">shortNames</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="l">ct</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c"># subresources describes the subresources for custom resources.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">subresources</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c"># status enables the status subresource.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">status</span><span class="p">:</span><span class="w"> </span>{}<span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c"># scale enables the scale subresource.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">scale</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="c"># specReplicasPath defines the JSONPath inside of a custom resource that corresponds to Scale.Spec.Replicas.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">specReplicasPath</span><span class="p">:</span><span class="w"> </span><span class="l">.spec.replicas</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="c"># statusReplicasPath defines the JSONPath inside of a custom resource that corresponds to Scale.Status.Replicas.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">statusReplicasPath</span><span class="p">:</span><span class="w"> </span><span class="l">.status.replicas</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="c"># labelSelectorPath defines the JSONPath inside of a custom resource that corresponds to Scale.Status.Selector.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">labelSelectorPath</span><span class="p">:</span><span class="w"> </span><span class="l">.status.labelSelector</span><span class="w">
</span></span></span></code></pre></div><p>并创建它：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">kubectl create -f resourcedefinition.yaml
</span></span></code></pre></div><p>创建 CustomResourceDefinition 对象后，您可以创建自定义对象。</p>
<p>如果您将以下 YAML 保存到 <code>my-crontab.yaml</code>：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;stable.example.com/v1&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">CronTab</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">my-new-cron-object</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">cronSpec</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;* * * * */5&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">my-awesome-cron-image</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">replicas</span><span class="p">:</span><span class="w"> </span><span class="m">3</span><span class="w">
</span></span></span></code></pre></div><p>并创建它：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">kubectl create -f my-crontab.yaml
</span></span></code></pre></div><p>然后在以下位置创建新的命名空间 RESTful API 端点：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">/apis/stable.example.com/v1/namespaces/*/crontabs/status
</span></span></code></pre></div><p>和</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">/apis/stable.example.com/v1/namespaces/*/crontabs/scale
</span></span></code></pre></div><p>可以使用该 <code>kubectl scale</code> 命令缩放自定义资源。例如，以上创建的自定义资源的的 <code>.spec.replicas</code>  设置为 5：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">kubectl scale --replicas<span class="o">=</span><span class="m">5</span> crontabs/my-new-cron-object
</span></span><span class="line"><span class="cl">crontabs <span class="s2">&#34;my-new-cron-object&#34;</span> scaled
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">kubectl get crontabs my-new-cron-object -o <span class="nv">jsonpath</span><span class="o">=</span><span class="s1">&#39;{.spec.replicas}&#39;</span>
</span></span><span class="line"><span class="cl"><span class="m">5</span>
</span></span></code></pre></div><h3 id="category分类">Category（分类）</h3>
<p>类别是自定义资源所属的分组资源的列表（例如 <code>all</code>）。您可以使用 <code>kubectl get &lt;category-name&gt;</code> 列出属于该类别的资源。此功能是 <strong>beta</strong>，可用于 v1.10 中的自定义资源。</p>
<p>以下示例添加 <code>all</code> CustomResourceDefinition 中的类别列表，并说明如何使用 <code>kubectl get all</code> 输出自定义资源 。</p>
<p>将以下 CustomResourceDefinition 保存到 <code>resourcedefinition.yaml</code>：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l">apiextensions.k8s.io/v1beta1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">CustomResourceDefinition</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">crontabs.stable.example.com</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">group</span><span class="p">:</span><span class="w"> </span><span class="l">stable.example.com</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">versions</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">v1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">served</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">storage</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">scope</span><span class="p">:</span><span class="w"> </span><span class="l">Namespaced</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">names</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">plural</span><span class="p">:</span><span class="w"> </span><span class="l">crontabs</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">singular</span><span class="p">:</span><span class="w"> </span><span class="l">crontab</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">CronTab</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">shortNames</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="l">ct</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c"># categories is a list of grouped resources the custom resource belongs to.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">categories</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="l">all</span><span class="w">
</span></span></span></code></pre></div><p>并创建它：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">kubectl create -f resourcedefinition.yaml
</span></span></code></pre></div><p>创建 CustomResourceDefinition 对象后，您可以创建自定义对象。</p>
<p>将以下 YAML 保存到 <code>my-crontab.yaml</code>：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;stable.example.com/v1&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">CronTab</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">my-new-cron-object</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">cronSpec</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;* * * * */5&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">my-awesome-cron-image</span><span class="w">
</span></span></span></code></pre></div><p>并创建它：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">kubectl create -f my-crontab.yaml
</span></span></code></pre></div><p>您可以使用<code>kubectl get</code>以下方式指定类别：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">kubectl get all
</span></span></code></pre></div><p>它将包括种类的自定义资源<code>CronTab</code>：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">NAME                          AGE
</span></span><span class="line"><span class="cl">crontabs/my-new-cron-object   3s
</span></span></code></pre></div><h2 id="参考">参考</h2>
<ul>
<li><a href="https://kubernetes.io/docs/tasks/access-kubernetes-api/custom-resources/custom-resource-definitions/" target="_blank" rel="noopener">Extend the Kubernetes API with CustomResourceDefinitions - kubernetes.io</a></li>
<li><a href="https://cloudnative.to/blog/kubernetes-crd-quick-start/" target="_blank" rel="noopener">如何从零开始编写一个 Kubernetes CRD - cloudnative.to</a></li>
</ul>

          </div>

          



          
          
          <div class="article-widget">
            
<div class="container-xl row post-nav">
  
  
  
  <div class="col-6 post-nav-item">
    <div class="meta-nav">上一页</div>
    <a href="/books/k8s-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2020-jimmysong-kubernetes-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/09.%E6%89%A9%E5%B1%95%E9%9B%86%E7%BE%A4/apiservice/" rel="next">apiservice</a>
  </div>
  
  
  
  <div class="col-6 post-nav-item">
    <div class="meta-nav">下一页</div>
    <a href="/books/k8s-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2020-jimmysong-kubernetes-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/09.%E6%89%A9%E5%B1%95%E9%9B%86%E7%BE%A4/custom-resource/" rel="prev">custom-resource</a>
  </div>
  
</div>

          </div>
          

        <div class="body-footer">
          <p>最近更新于 0001-01-01</p>

          



          


  
  
  

  

  
  <section id="comments" class="mb-3 pt-0">
    
<div id="disqus_thread"></div>
<script>
  var disqus_config = function () {
    
    
    
  };
  (function() {
    if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
      document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
      return;
    }
    var d = document, s = d.createElement('script'); 
    s.async = true;
    s.src = 'https://' + "ngte" + '.disqus.com/embed.js';
    
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
  })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>


  </section>
  



          


        </div>

      </article>

      <footer class="site-footer">

  



  

  
  <div class="copyright py-4 bg-footer">
      <div class="row justify-content-center">
        <div class="text-center footer-color">
          <p class="mb-0">© 2017-2022 NGTE all rights reserved</p>
        </div>
    </div>
  </div>

  <script type="text/javascript" id="clstr_globe" async src="//clustrmaps.com/globe.js?d=kgpJG5sWZQpKujBmD-uW1B54-WBPol-DuDtrB2KFjKs"></script>
  
</footer>


    </main>
  </div>
</div>
<script src="//unpkg.com/heti/umd/heti-addon.min.js"></script>
<script>
  const heti = new Heti('.article');
  heti.autoSpacing();
</script>
<script type="text/javascript">
  window.$crisp = [];
  window.CRISP_WEBSITE_ID = "12adcc35-9621-4313-8262-62dc654b29d8";
  (function () {
    setTimeout(function() {
      d = document;
      s = d.createElement("script");
      s.src = "https://client.crisp.chat/l.js";
      s.async = 1;
      d.getElementsByTagName("head")[0].appendChild(s);
    }, 2500);
  })();
</script>
  </div>

  <div class="page-footer">
    
    
  </div>

      

    
    <script src="/js/vendor-bundle.min.d26509351aa0ff874abbee824e982e9b.js"></script>

    
    
    
      

      
      

      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.1/highlight.min.js" integrity="sha512-Ypjm0o7jOxAd4hpdoppSEN0TQOC19UtPAqD+4s5AlXmUvbmmS/YMxYqAqarQYyxTnB6/rqip9qcxlNB/3U9Wdg==" crossorigin="anonymous"></script>
        
        
      

    

    
    
    

    
    
    
      
      <script id="search-hit-algolia-template" type="text/html">
        <div class="search-hit">
          <div class="search-hit-content">
            <div class="search-hit-name">
              <a href="{{relpermalink}}">{{#helpers.highlight}}{ "attribute": "title" }{{/helpers.highlight}}</a>
            </div>
            <div class="article-metadata search-hit-type">{{type}}</div>
            <p class="search-hit-description">{{#helpers.highlight}}{ "attribute": "summary" }{{/helpers.highlight}}</p>
          </div>
        </div>
      </script>
      
        <script src="https://cdn.jsdelivr.net/npm/instantsearch.js@4/dist/instantsearch.production.min.js" crossorigin="anonymous"></script>
      
      
    

    
    

    
    
    
    
      <script id="dsq-count-scr" src="https://ngte.disqus.com/count.js" async></script>
      
    

    
    
      
      
      
      
      
      
      
    

    
    <script src="/zh/js/algolia-search-built.min.4387d694ca1258194aaf562b8cd1c400.js" type="module"></script>
    

    
    
    
    <script id="page-data" type="application/json">{"use_headroom":false}</script>

    
    
    
    
    
    
    
    
    
    
    <script src="/zh/js/wowchemy.min.d1673c7a11d1238516cbe12a1e84257f.js"></script>

    
    
    
    
    
    
    <script>

var mybutton = document.getElementById("backTopBtn");


window.onscroll = function() {scrollFunction()};

function scrollFunction() {
  if (document.body.scrollTop > 20 || document.documentElement.scrollTop > 20) {
    mybutton.style.display = "block";
  } else {
    mybutton.style.display = "none";
  }
}


function topFunction() {
  document.body.scrollTop = 0;
  document.documentElement.scrollTop = 0;
}
</script>


    

    
    
    <script src="https://cdn.jsdelivr.net/gh/bryanbraun/anchorjs@4.2.2/anchor.min.js" integrity="sha512-I7w3ZdSFzw5j3jU3ZkNikBNeIrl3i+hEuEdwNmqUJvwNcaBUNcijnP2gd9DtGlgVYDplfjGoD8vTNsID+lCjqg==" crossorigin="anonymous"></script>
    <script>
      anchors.add();
    </script>
    

    
    <script>



(function() {
  'use strict';

  if(!document.queryCommandSupported('copy')) {
    return;
  }

  function flashCopyMessage(el, msg) {
    el.className = "highlight-copy-btn";
    el.textContent = msg;
    setTimeout(function() {
      el.textContent = "";
      el.className = "highlight-copy-btn fa fa-copy";
    }, 1000);
  }

  function selectText(node) {
    var selection = window.getSelection();
    var range = document.createRange();
    range.selectNodeContents(node);
    selection.removeAllRanges();
    selection.addRange(range);
    return selection;
  }

  function addCopyButton(containerEl) {
    var copyBtn = document.createElement("button");
    copyBtn.className = "highlight-copy-btn fa fa-copy";
    copyBtn.textContent = "";

    var codeEl = containerEl.firstElementChild;
    copyBtn.addEventListener('click', function() {
      try {
        var selection = selectText(codeEl);
        document.execCommand('copy');
        selection.removeAllRanges();
        
        flashCopyMessage(copyBtn, '已复制')
        
      } catch(e) {
        console && console.log(e);
        flashCopyMessage(copyBtn, 'Failed :\'(')
      }
    });

    containerEl.appendChild(copyBtn);
  }

  
  var highlightBlocks = document.getElementsByClassName('highlight');
  Array.prototype.forEach.call(highlightBlocks, addCopyButton);
})();
</script>

    


</body>
</html>
