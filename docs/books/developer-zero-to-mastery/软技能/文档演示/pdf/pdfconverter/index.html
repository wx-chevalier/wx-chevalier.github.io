<!doctype html><html lang=zh><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=generator content="Wowchemy 5.5.0 for Hugo"><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=preload as=style href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap"><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap" media=print onload='this.media="all"'><meta name=google-site-verification content="google69a5cccb61297807"><meta name=baidu-site-verification content="cqmZHEleVh"><meta name=description content="﻿- Html to pdf converter in nodejs DOCX2PDF 将 DOCX 文档转化为 PDF 是项目中常见的需求之一，目前主流的方法可以分为两大类，一类是利用各种 Office 应用进行转换，譬如 Microsoft Office、WPS 以及 LiberOffice，另一种是利用各种语言提供的对"><link rel=alternate hreflang=zh href=https://ng-tech.icu/books/developer-zero-to-mastery/%E8%BD%AF%E6%8A%80%E8%83%BD/%E6%96%87%E6%A1%A3%E6%BC%94%E7%A4%BA/pdf/pdfconverter/><meta name=theme-color content="#0a55a7"><link rel=stylesheet href=/css/vendor-bundle.min.c7b8d9abd591ba2253ea42747e3ac3f5.css media=print onload='this.media="all"'><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.1/styles/github.min.css crossorigin=anonymous title=hl-light media=print onload='this.media="all"'><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.1/styles/dracula.min.css crossorigin=anonymous title=hl-dark media=print onload='this.media="all"' disabled><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/instantsearch.css@7.4.5/themes/satellite-min.css integrity="sha256-TehzF/2QvNKhGQrrNpoOb2Ck4iGZ1J/DI4pkd2oUsBc=" crossorigin=anonymous><link rel=stylesheet href=/css/wowchemy.63df6ae9fc2b4cc71b83f1774d780209.css><script async src="https://www.googletagmanager.com/gtag/js?id=G-40NYXJ8823"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-40NYXJ8823")</script><script>var _hmt=_hmt||[];(function(){var e,t=document.createElement("script");t.src="https://hm.baidu.com/hm.js?56df1177bce405601b0ecdd7208f75c6",e=document.getElementsByTagName("script")[0],e.parentNode.insertBefore(t,e)})()</script><link rel=manifest href=/manifest.webmanifest><link rel=icon type=image/png href=/media/icon_hu0f7d075e895d6f5f1f5fdbc1e33dc138_10087_32x32_fill_lanczos_center_3.png><link rel=apple-touch-icon type=image/png href=/media/icon_hu0f7d075e895d6f5f1f5fdbc1e33dc138_10087_180x180_fill_lanczos_center_3.png><link rel=canonical href=https://ng-tech.icu/books/developer-zero-to-mastery/%E8%BD%AF%E6%8A%80%E8%83%BD/%E6%96%87%E6%A1%A3%E6%BC%94%E7%A4%BA/pdf/pdfconverter/><meta property="twitter:card" content="summary_large_image"><meta property="twitter:site" content="@wx-chevalier"><meta property="twitter:creator" content="@wx-chevalier"><meta property="og:site_name" content="Next-gen Tech Edu"><meta property="og:url" content="https://ng-tech.icu/books/developer-zero-to-mastery/%E8%BD%AF%E6%8A%80%E8%83%BD/%E6%96%87%E6%A1%A3%E6%BC%94%E7%A4%BA/pdf/pdfconverter/"><meta property="og:title" content="PDFConverter | Next-gen Tech Edu"><meta property="og:description" content="﻿- Html to pdf converter in nodejs DOCX2PDF 将 DOCX 文档转化为 PDF 是项目中常见的需求之一，目前主流的方法可以分为两大类，一类是利用各种 Office 应用进行转换，譬如 Microsoft Office、WPS 以及 LiberOffice，另一种是利用各种语言提供的对"><meta property="og:image" content="https://ng-tech.icu/media/sharing.png"><meta property="twitter:image" content="https://ng-tech.icu/media/sharing.png"><meta property="og:locale" content="zh"><title>PDFConverter | Next-gen Tech Edu</title></head><body id=top data-spy=scroll data-offset=70 data-target=#TableOfContents class=page-wrapper data-wc-page-id=2ece06ddb87fa9cbdf0b05171b7bb265><button onclick=topFunction() id=backTopBtn title="Go to top"><i class="fa-solid fa-circle-up" aria-hidden=true></i></button>
<script src=/js/wowchemy-init.min.14a0ed61c6dbd594b9c75193b25be179.js></script><aside class=search-modal id=search><div class=container><section class=search-header><div class="row no-gutters justify-content-between mb-3"><div class="col-6 search-title"><p>搜索</p></div><div class="col-6 col-search-close"><a class=js-search href=# aria-label=关闭><i class="fas fa-times-circle text-muted" aria-hidden=true></i></a></div></div><div id=search-box></div></section><section class=section-search-results><div id=search-hits></div><div id=search-common-queries></div></section></div></aside><div class=page-header><header class=header--fixed><nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id=navbar-main><div class=container-xl><div class="d-none d-lg-inline-flex"><a class=navbar-brand href=/>Next-gen Tech Edu</a></div><button type=button class=navbar-toggler data-toggle=collapse data-target=#navbar-content aria-controls=navbar-content aria-expanded=false aria-label=切换导航>
<span><i class="fas fa-bars"></i></span></button><div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none"><a class=navbar-brand href=/>Next-gen Tech Edu</a></div><div class="navbar-collapse main-menu-item collapse justify-content-start" id=navbar-content><ul class="navbar-nav d-md-inline-flex"><li class=nav-item><a class=nav-link href=/books-gallery><span>笔记（万篇）</span></a></li><li class=nav-item><a class=nav-link href=/#knowledge-map><span>知识图谱</span></a></li><style>.dropdown-item{display:inline-flex}</style><li class="nav-item dropdown"><a href=# class="nav-link dropdown-toggle" data-toggle=dropdown aria-haspopup=true><span>实验室</span><span class=caret></span></a><div class=dropdown-menu><a class=dropdown-item href=/galaxy-home/gh-craft><span>Craft 方块世界</span></a>
<a class=dropdown-item href=/galaxy-home/glossary-cards><span>3D 知识卡牌</span></a></div></li><style>.dropdown-item{display:inline-flex}</style><li class="nav-item dropdown"><a href=# class="nav-link dropdown-toggle" data-toggle=dropdown aria-haspopup=true><span>其他阅读渠道</span><span class=caret></span></a><div class=dropdown-menu><a class=dropdown-item href=https://zhuanlan.zhihu.com/wxyyxc1992><img style=width:16px;height:16px;display:inline-block;margin-right:8px src=https://ngte-superbed.oss-cn-beijing.aliyuncs.com/item/20230218234451.png></img><span>知乎</span></a>
<a class=dropdown-item href=https://segmentfault.com/blog/wxyyxc1992><img style=width:16px;height:16px;display:inline-block;margin-right:8px src=https://ngte-superbed.oss-cn-beijing.aliyuncs.com/item/20230219113556.png></img><span>SegmentFault</span></a>
<a class=dropdown-item href=https://zhuanlan.zhihu.com/wxyyxc1992><img style=width:16px;height:16px;display:inline-block;margin-right:8px src=https://ngte-superbed.oss-cn-beijing.aliyuncs.com/item/20230219113519.png></img><span>掘金</span></a></div></li></ul></div><ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2"><li class=nav-item><a class="nav-link js-search" href=# aria-label=搜索><i class="fas fa-search" aria-hidden=true></i></a></li><li class=nav-item><a class=nav-link href=https://github.com/wx-chevalier aria-label=GitHub><i class="fa-brands fa-github" aria-hidden=true></i></a></li><div></div><style>@media only screen and (max-width:600px){.jimmysong-template{display:none!important}}</style><li class=jimmysong-template style=color:#fff;font-size:12px><a href=https://jimmysong.io style=color:#fff>By Jimmy Song's Template</a></li></ul></div></nav></header></div><div class=page-body><link rel=stylesheet href=//unpkg.com/heti/umd/heti.min.css><div class="container-xl docs"><div class="row flex-xl-nowrap"><div class=docs-sidebar><form class="docs-search d-flex align-items-center"><button class="btn docs-toggle d-md-none p-0 mr-md-3 w-100" type=button data-toggle=collapse data-target=#docs-nav aria-controls=docs-nav aria-expanded=false aria-label="Toggle section navigation"><div class=d-flex><span class="d-md-none pl-1 flex-grow-1 text-left overflow-hidden">PDF</span>
<span><i class="fas fa-chevron-down"></i></span></div></button>
<button class="form-control sidebar-search js-search d-none d-md-flex">
<i class="fas fa-search pr-2"></i>
<span class=sidebar-search-text>搜索...</span>
<span class=sidebar-search-shortcut>/</span></button></form><nav class="collapse docs-links" id=docs-nav><ul class="nav docs-sidenav"><li style=display:inline-flex><a style=cursor:pointer onclick=window.history.back()><i class="fas fa-arrow-left pr-1"></i>
Back</a>
<span>|</span>
<a href=/books/><i class="fa-solid fa-house" style=margin-right:4px></i>
Books</a></li></ul><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-id436d2b29eb1f288bfb55f0e626302d95")' href=#id436d2b29eb1f288bfb55f0e626302d95 aria-expanded=false aria-controls=id436d2b29eb1f288bfb55f0e626302d95 aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/developer-zero-to-mastery/%E8%BD%AF%E6%8A%80%E8%83%BD/%E6%96%87%E6%A1%A3%E6%BC%94%E7%A4%BA/>文档演示</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#id436d2b29eb1f288bfb55f0e626302d95 aria-expanded=false aria-controls=id436d2b29eb1f288bfb55f0e626302d95><i class="fa-solid fa-angle-down" id=caret-id436d2b29eb1f288bfb55f0e626302d95></i></a></div><ul class="nav docs-sidenav collapse show" id=id436d2b29eb1f288bfb55f0e626302d95><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-id2c3ff03ddcae77d66c6a87e76a8449ce")' href=#id2c3ff03ddcae77d66c6a87e76a8449ce aria-expanded=false aria-controls=id2c3ff03ddcae77d66c6a87e76a8449ce aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/developer-zero-to-mastery/%E8%BD%AF%E6%8A%80%E8%83%BD/%E6%96%87%E6%A1%A3%E6%BC%94%E7%A4%BA/latex/>LaTeX</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#id2c3ff03ddcae77d66c6a87e76a8449ce aria-expanded=false aria-controls=id2c3ff03ddcae77d66c6a87e76a8449ce><i class="fa-solid fa-angle-right" id=caret-id2c3ff03ddcae77d66c6a87e76a8449ce></i></a></div><ul class="nav docs-sidenav collapse" id=id2c3ff03ddcae77d66c6a87e76a8449ce><li class="child level"><a href=/books/developer-zero-to-mastery/%E8%BD%AF%E6%8A%80%E8%83%BD/%E6%96%87%E6%A1%A3%E6%BC%94%E7%A4%BA/latex/latex/>LaTex</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-ide4cfb556178234c69c4199b1679764eb")' href=#ide4cfb556178234c69c4199b1679764eb aria-expanded=false aria-controls=ide4cfb556178234c69c4199b1679764eb aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/developer-zero-to-mastery/%E8%BD%AF%E6%8A%80%E8%83%BD/%E6%96%87%E6%A1%A3%E6%BC%94%E7%A4%BA/markdown/>Markdown</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#ide4cfb556178234c69c4199b1679764eb aria-expanded=false aria-controls=ide4cfb556178234c69c4199b1679764eb><i class="fa-solid fa-angle-right" id=caret-ide4cfb556178234c69c4199b1679764eb></i></a></div><ul class="nav docs-sidenav collapse" id=ide4cfb556178234c69c4199b1679764eb><li class="child level"><a href=/books/developer-zero-to-mastery/%E8%BD%AF%E6%8A%80%E8%83%BD/%E6%96%87%E6%A1%A3%E6%BC%94%E7%A4%BA/markdown/gitbook/>Gitbook</a></li><li class="child level"><a href=/books/developer-zero-to-mastery/%E8%BD%AF%E6%8A%80%E8%83%BD/%E6%96%87%E6%A1%A3%E6%BC%94%E7%A4%BA/markdown/markdown/>MarkDown</a></li><li class="child level"><a href=/books/developer-zero-to-mastery/%E8%BD%AF%E6%8A%80%E8%83%BD/%E6%96%87%E6%A1%A3%E6%BC%94%E7%A4%BA/markdown/styleguide/>StyleGuide</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-ide0683f11473d8e566125114f11858987")' href=#ide0683f11473d8e566125114f11858987 aria-expanded=false aria-controls=ide0683f11473d8e566125114f11858987 aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/developer-zero-to-mastery/%E8%BD%AF%E6%8A%80%E8%83%BD/%E6%96%87%E6%A1%A3%E6%BC%94%E7%A4%BA/microsoft/>MicroSoft</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#ide0683f11473d8e566125114f11858987 aria-expanded=false aria-controls=ide0683f11473d8e566125114f11858987><i class="fa-solid fa-angle-right" id=caret-ide0683f11473d8e566125114f11858987></i></a></div><ul class="nav docs-sidenav collapse" id=ide0683f11473d8e566125114f11858987><li class="child level"><a href=/books/developer-zero-to-mastery/%E8%BD%AF%E6%8A%80%E8%83%BD/%E6%96%87%E6%A1%A3%E6%BC%94%E7%A4%BA/microsoft/docgenerator/>DocGenerator</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-id311dc913ae18a5e1374568f33ac66329")' href=#id311dc913ae18a5e1374568f33ac66329 aria-expanded=false aria-controls=id311dc913ae18a5e1374568f33ac66329 aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/developer-zero-to-mastery/%E8%BD%AF%E6%8A%80%E8%83%BD/%E6%96%87%E6%A1%A3%E6%BC%94%E7%A4%BA/pdf/>PDF</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#id311dc913ae18a5e1374568f33ac66329 aria-expanded=false aria-controls=id311dc913ae18a5e1374568f33ac66329><i class="fa-solid fa-angle-down" id=caret-id311dc913ae18a5e1374568f33ac66329></i></a></div><ul class="nav docs-sidenav collapse show" id=id311dc913ae18a5e1374568f33ac66329><li class="child level active"><a href=/books/developer-zero-to-mastery/%E8%BD%AF%E6%8A%80%E8%83%BD/%E6%96%87%E6%A1%A3%E6%BC%94%E7%A4%BA/pdf/pdfconverter/>PDFConverter</a></li><li class="child level"><a href=/books/developer-zero-to-mastery/%E8%BD%AF%E6%8A%80%E8%83%BD/%E6%96%87%E6%A1%A3%E6%BC%94%E7%A4%BA/pdf/pdfextractor/>PDFExtractor</a></li><li class="child level"><a href=/books/developer-zero-to-mastery/%E8%BD%AF%E6%8A%80%E8%83%BD/%E6%96%87%E6%A1%A3%E6%BC%94%E7%A4%BA/pdf/pdfgenerator/>PDFGenerator</a></li><li class="child level"><a href=/books/developer-zero-to-mastery/%E8%BD%AF%E6%8A%80%E8%83%BD/%E6%96%87%E6%A1%A3%E6%BC%94%E7%A4%BA/pdf/pdfview/>PDFView</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-ida272cd62540dca405fb9ad0095a35e37")' href=#ida272cd62540dca405fb9ad0095a35e37 aria-expanded=false aria-controls=ida272cd62540dca405fb9ad0095a35e37 aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/developer-zero-to-mastery/%E8%BD%AF%E6%8A%80%E8%83%BD/%E6%96%87%E6%A1%A3%E6%BC%94%E7%A4%BA/powerpoint/>PowerPoint</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#ida272cd62540dca405fb9ad0095a35e37 aria-expanded=false aria-controls=ida272cd62540dca405fb9ad0095a35e37><i class="fa-solid fa-angle-right" id=caret-ida272cd62540dca405fb9ad0095a35e37></i></a></div><ul class="nav docs-sidenav collapse" id=ida272cd62540dca405fb9ad0095a35e37><li class="child level"><a href=/books/developer-zero-to-mastery/%E8%BD%AF%E6%8A%80%E8%83%BD/%E6%96%87%E6%A1%A3%E6%BC%94%E7%A4%BA/powerpoint/ppt-%E6%A8%A1%E6%9D%BF%E6%8E%A8%E4%BB%8B/>PPT 模板推介</a></li><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-id1a444fd62f9b39642fc72f64fe8b0ecf")' href=#id1a444fd62f9b39642fc72f64fe8b0ecf aria-expanded=false aria-controls=id1a444fd62f9b39642fc72f64fe8b0ecf aria-hidden=false data-toggle=collapse></div></div></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-id99c41c880b9ca77a1bd7b7f2ebe66ea2")' href=#id99c41c880b9ca77a1bd7b7f2ebe66ea2 aria-expanded=false aria-controls=id99c41c880b9ca77a1bd7b7f2ebe66ea2 aria-hidden=false data-toggle=collapse></div></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-id06e7ee327ec378c475045aa8aca65dde")' href=#id06e7ee327ec378c475045aa8aca65dde aria-expanded=false aria-controls=id06e7ee327ec378c475045aa8aca65dde aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/developer-zero-to-mastery/%E8%BD%AF%E6%8A%80%E8%83%BD/%E6%96%87%E6%A1%A3%E6%BC%94%E7%A4%BA/%E5%B7%A5%E4%BD%9C%E5%8F%B0/>工作台</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#id06e7ee327ec378c475045aa8aca65dde aria-expanded=false aria-controls=id06e7ee327ec378c475045aa8aca65dde><i class="fa-solid fa-angle-right" id=caret-id06e7ee327ec378c475045aa8aca65dde></i></a></div><ul class="nav docs-sidenav collapse" id=id06e7ee327ec378c475045aa8aca65dde><li class="child level"><a href=/books/developer-zero-to-mastery/%E8%BD%AF%E6%8A%80%E8%83%BD/%E6%96%87%E6%A1%A3%E6%BC%94%E7%A4%BA/%E5%B7%A5%E4%BD%9C%E5%8F%B0/markdown-%E5%AE%9E%E6%88%98/>Markdown 实战</a></li><li class="child level"><a href=/books/developer-zero-to-mastery/%E8%BD%AF%E6%8A%80%E8%83%BD/%E6%96%87%E6%A1%A3%E6%BC%94%E7%A4%BA/%E5%B7%A5%E4%BD%9C%E5%8F%B0/%E5%B7%A5%E5%85%B7%E7%AE%B1/>工具箱</a></li><li class="child level"><a href=/books/developer-zero-to-mastery/%E8%BD%AF%E6%8A%80%E8%83%BD/%E6%96%87%E6%A1%A3%E6%BC%94%E7%A4%BA/%E5%B7%A5%E4%BD%9C%E5%8F%B0/%E6%88%91%E7%9A%84-app-%E5%B7%A5%E4%BD%9C%E5%8F%B0-%E4%B8%8D%E4%BB%85%E4%BB%85%E6%98%AF%E6%8A%80%E6%9C%AF/>我的 App 工作台-不仅仅是技术</a></li><li class="child level"><a href=/books/developer-zero-to-mastery/%E8%BD%AF%E6%8A%80%E8%83%BD/%E6%96%87%E6%A1%A3%E6%BC%94%E7%A4%BA/%E5%B7%A5%E4%BD%9C%E5%8F%B0/%E9%98%85%E8%AF%BB/>阅读</a></li></ul></div></ul></div></nav></div><div class="d-none d-xl-block col-xl-2 docs-toc"><ul class="nav toc-top"><li><a href=# id=back_to_top class=docs-toc-title>目录</a></li></ul><nav id=TableOfContents><ul><li><a href=#microsoft-office>MicroSoft Office</a></li><li><a href=#wps>WPS</a></li><li><a href=#liberoffice>LiberOffice</a></li><li><a href=#xdocreporthttpsgithubcomopensagresxdocreport><a href=https://github.com/opensagres/xdocreport>xdocreport</a></a></li></ul></nav><div class="subscribe-module col-24 mt-1"><img src=https://ngte-superbed.oss-cn-beijing.aliyuncs.com/item/20230220172727.png alt=image title=王下邀月熊的微信公众号></div></div><main class="py-md-3 pl-md-3 docs-content col-xl-8" role=main><article class=article><h1>PDFConverter</h1><div class=article-style><p>﻿- <a href=https://github.com/marcbachmann/node-html-pdf target=_blank rel=noopener>Html to pdf converter in nodejs</a></p><h1 id=docx2pdf>DOCX2PDF</h1><p>将 DOCX 文档转化为 PDF 是项目中常见的需求之一，目前主流的方法可以分为两大类，一类是利用各种 Office 应用进行转换，譬如 Microsoft Office、WPS 以及 LiberOffice，另一种是利用各种语言提供的对于 Office 文档读取的接口(譬如 Apache POI)然后使用专门的 PDFGenerator 库，譬如 IText 进行 PDF 构建。总的来说，从样式上利用 Office 应用可以保证较好的样式，不过相对而言效率会比较低。其中 Microsoft Office 涉及版权，不可轻易使用(笔者所在公司就被抓包了)，WPS 目前使用比较广泛，不过存在超链接截断问题，即超过 256 个字符的超链接会被截断，LiberOffice 的样式排版相对比较随意。而利用 POI 接口进行读取与生成的方式性能较好，适用于对于格式要求不是很高的情况。另外还有一些封装好的在线工具或者命令行工具，譬如<a href=https://github.com/casatir/docx2pdf target=_blank rel=noopener>docx2pdf</a>与<a href=http://officetopdf.codeplex.com/releases/view/620406 target=_blank rel=noopener>OfficeToPDF</a>。</p><h2 id=microsoft-office>MicroSoft Office</h2><p>本部分的核心代码如下，全部代码参考<a href=https://github.com/wx-chevalier/WXJavaToolkits/blob/master/code/src/main/java/wx/toolkits/storage/pdf/converter/docx/OfficeConverter.java target=_blank rel=noopener>这里</a>:</p><pre tabindex=0><code class=language-private data-lang=private>private Dispatch activeDoc = null;
private final static String APP_ID = &#34;Word.Application&#34;;

// Constants that map onto Word&#39;s WdSaveOptions enumeration and that
// may be passed to the close(int) method
public static final int DO_NOT_SAVE_CHANGES = 0;
public static final int PROMPT_TO_SAVE_CHANGES = -2;
public static final int SAVE_CHANGES = -1;

// These constant values determine whether or not tha application
// instance will be displyed on the users screen or not.
public static final boolean VISIBLE = true;
public static final boolean HIDDEN = false;

/**
 * Create a new instance of the JacobWordSearch class using the following
 * parameters.
 *
 * @param visibility A primitive boolean whose value will determine whether
 *                   or not the Word application will be visible to the user. Pass true
 *                   to display Word, false otherwise.
 */
public OfficeConverter(boolean visibility) {
    this.oleComponent = new ActiveXComponent(OfficeConverter.APP_ID);
    this.oleComponent.setProperty(&#34;Visible&#34;, new Variant(visibility));
}

/**
 * Open ana existing Word document.
 *
 * @param docName An instance of the String class that encapsulates the
 *                path to and name of a valid Word file. Note that there are a few
 *                limitations applying to the format of this String; it must specify
 *                the absolute path to the file and it must not use the single forward
 *                slash to specify the path separator.
 */
public void openDoc(String docName) {
    Dispatch disp = null;
    Variant var = null;
    // First get a Dispatch object referencing the Documents collection - for
    // collections, think of ArrayLists of objects.
    var = Dispatch.get(this.oleComponent, &#34;Documents&#34;);
    disp = var.getDispatch();
    // Now call the Open method on the Documents collection Dispatch object
    // to both open the file and add it to the collection. It would be possible
    // to open a series of files and access each from the Documents collection
    // but for this example, it is simpler to store a reference to the
    // active document in a private instance variable.
    var = Dispatch.call(disp, &#34;Open&#34;, docName);
    this.activeDoc = var.getDispatch();
}

/**
 * There is more than one way to convert the document into PDF format, you
 * can either explicitly use a FileConvertor object or call the
 * ExportAsFixedFormat method on the active document. This method opts for
 * the latter and calls the ExportAsFixedFormat method passing the name
 * of the file along with the integer value of 17. This value maps onto one
 * of Word&#39;s constants called wdExportFormatPDF and causes the application
 * to convert the file into PDF format. If you wanted to do so, for testing
 * purposes, you could add another value to the args array, a Boolean value
 * of true. This would open the newly converted document automatically.
 *
 * @param filename
 */
public void publishAsPDF(String filename) {
    // The code to expoort as a PDF is 17
    //Object args = new Object{filename, new Integer(17), new Boolean(true)};
    Object args = new Object {
        filename, new Integer(17)
    } ;
    Dispatch.call(this.activeDoc, &#34;ExportAsFixedFormat&#34;, args);
}

/**
 * Called to close the active document. Note that this method simply
 * calls the overloaded closeDoc(int) method passing the value 0 which
 * instructs Word to close the document and discard any changes that may
 * have been made since the document was opened or edited.
 */
public void closeDoc() {
    this.closeDoc(JacobWordSearch.DO_NOT_SAVE_CHANGES);
}

/**
 * Called to close the active document. It is possible with this overloaded
 * version of the close() method to specify what should happen if the user
 * has made changes to the document that have not been saved. There are three
 * possible value defined by the following manifest constants;
 * DO_NOT_SAVE_CHANGES - Close the document and discard any changes
 * the user may have made.
 * PROMPT_TO_SAVE_CHANGES - Display a prompt to the user asking them
 * how to proceed.
 * SAVE_CHANGES - Save the changes the user has made to the document.
 *
 * @param saveOption A primitive integer whose value indicates how the close
 *                   operation should proceed if the user has made changes to the active
 *                   document. Note that no checks are made on the value passed to
 *                   this argument.
 */
public void closeDoc(int saveOption) {
    Object args = {new Integer(saveOption)};
    Dispatch.call(this.activeDoc, &#34;Close&#34;, args);
}

/**
 * Called once processing has completed in order to close down the instance
 * of Word.
 */
public void quit() {
    Dispatch.call(this.oleComponent, &#34;Quit&#34;);
}
</code></pre><h2 id=wps>WPS</h2><blockquote></blockquote><ul><li><a href=http://www.programgo.com/article/57122675725/ target=_blank rel=noopener>Java 调用 WPS 或 pdfcreator 的 com 接口实现 doc 转 pdf</a></li></ul><p>本文的核心代码如下，完整代码查看<a href=https://github.com/wx-chevalier/WXJavaToolkits/blob/master/code/src/main/java/wx/toolkits/storage/pdf/converter/docx/WPSConverter.java target=_blank rel=noopener>这里</a>:</p><pre tabindex=0><code class=language-@Override data-lang=@Override>        public boolean convert(String word, String pdf) {
            File pdfFile = new File(pdf);
            File wordFile = new File(word);
            boolean convertSuccessfully = false;

            ActiveXComponent wps = null;
            ActiveXComponent doc = null;


            try {
                wps = new ActiveXComponent(&#34;KWPS.Application&#34;);

//                Dispatch docs = wps.getProperty(&#34;Documents&#34;).toDispatch();
//                Dispatch d = Dispatch.call(docs, &#34;Open&#34;, wordFile.getAbsolutePath(), false, true).toDispatch();
//                Dispatch.call(d, &#34;SaveAs&#34;, pdfFile.getAbsolutePath(), 17);
//                Dispatch.call(d, &#34;Close&#34;, false);

                doc = wps.invokeGetComponent(&#34;Documents&#34;)
                        .invokeGetComponent(&#34;Open&#34;, new Variant(wordFile.getAbsolutePath()));

                try {
                    doc.invoke(&#34;SaveAs&#34;,
                            new Variant(new File(&#34;C:\\Users\\lotuc\\Documents\\mmm.pdf&#34;).getAbsolutePath()),
                            new Variant(17));
                    convertSuccessfully = true;
                } catch (Exception e) {
                    logger.warning(&#34;生成PDF失败&#34;);
                    e.printStackTrace();
                }

                File saveAsFile = new File(&#34;C:\\Users\\lotuc\\Documents\\saveasfile.doc&#34;);
                try {
                    doc.invoke(&#34;SaveAs&#34;, saveAsFile.getAbsolutePath());
                    logger.info(&#34;成功另存为&#34; + saveAsFile.getAbsolutePath());
                } catch (Exception e) {
                    logger.info(&#34;另存为&#34; + saveAsFile.getAbsolutePath() + &#34;失败&#34;);
                    e.printStackTrace();
                }
            } finally {
                if (doc == null) {
                    logger.info(&#34;打开文件 &#34; + wordFile.getAbsolutePath() + &#34; 失败&#34;);
                } else {
                    try {
                        logger.info(&#34;释放文件 &#34; + wordFile.getAbsolutePath());
                        doc.invoke(&#34;Close&#34;);
                        doc.safeRelease();
                    } catch (Exception e1) {
                        logger.info(&#34;释放文件 &#34; + wordFile.getAbsolutePath() + &#34; 失败&#34;);
                    }
                }

                if (wps == null) {
                    logger.info(&#34;加载 WPS 控件失败&#34;);
                } else {
                    try {
                        logger.info(&#34;释放 WPS 控件&#34;);
                        wps.invoke(&#34;Quit&#34;);
                        wps.safeRelease();
                    } catch (Exception e1) {
                        logger.info(&#34;释放 WPS 控件失败&#34;);
                    }
                }
            }

            return convertSuccessfully;
        }
</code></pre><h2 id=liberoffice>LiberOffice</h2><blockquote></blockquote><ul><li><a href=http://www.codeproject.com/Tips/988667/Convert-Microsoft-Word-to-PDF-using-Java-and-Libre target=_blank rel=noopener>Convert Microsoft Word to PDF - using Java and LibreOffice (UNO API)</a></li></ul><p>LiberOffice 本身提供了一个命令行工具进行转换，在你安装好了 LiberOffice 之后</p><pre tabindex=0><code>/usr/local/bin/soffice --convert-to pdf:writer_pdf_Export /Users/lotuc/Downloads/test.doc
</code></pre><p>如果有打开的 libreoffice 实例, 要穿入 env 选项指定一个工作目录</p><pre tabindex=0><code>/usr/local/bin/soffice &#34;-env:UserInstallation=file:///tmp/LibreOffice_Conversion_abc&#34; --convert-to pdf:writer_pdf_Export /Users/lotuc/Downloads/test.doc
</code></pre><p>首先我们需要安装好 LiberOffice，然后将依赖的 Jar 包添加到 classpath 中:</p><pre tabindex=0><code class=language-Install data-lang=Install>
Create a Java project in your favorite editor and add these to your class path:
  [Libre Office Dir]/URE/java/juh.jar
  [Libre Office Dir]/URE/java/jurt.jar
  [Libre Office Dir]/URE/java/ridl.jar
  [Libre Office Dir]/program/classes/unoil.jar
</code></pre><p>然后我们需要启动一个 LiberOffice 进程:</p><pre tabindex=0><code class=language-import data-lang=import>import java.io.File;
import com.sun.star.beans.PropertyValue;
import com.sun.star.comp.helper.Bootstrap;
import com.sun.star.frame.XComponentLoader;
import com.sun.star.frame.XDesktop;
import com.sun.star.frame.XStorable;
import com.sun.star.lang.XComponent;
import com.sun.star.lang.XMultiComponentFactory;
import com.sun.star.text.XTextDocument;
import com.sun.star.uno.UnoRuntime;
import com.sun.star.uno.XComponentContext;
import com.sun.star.util.XReplaceDescriptor;
import com.sun.star.util.XReplaceable;

public class MailMergeExample {

public static void main(String[] args) throws Exception {

 // Initialise
 XComponentContext xContext = Bootstrap.bootstrap();

 XMultiComponentFactory xMCF = xContext.getServiceManager();

 Object oDesktop = xMCF.createInstanceWithContext(
      &#34;com.sun.star.frame.Desktop&#34;, xContext);

 XDesktop xDesktop = (XDesktop) UnoRuntime.queryInterface(
      XDesktop.class, oDesktop);
</code></pre><p>接下来我们需要加载目标 Doc 文档:</p><pre tabindex=0><code class=language-// data-lang=//>String workingDir = &#34;C:/projects/&#34;;
String myTemplate = &#34;letterTemplate.doc&#34;;

if (!new File(workingDir + myTemplate).canRead()) {
 throw new RuntimeException(&#34;Cannot load template:&#34; + new File(workingDir + myTemplate));
}

XComponentLoader xCompLoader = (XComponentLoader) UnoRuntime
 .queryInterface(com.sun.star.frame.XComponentLoader.class, xDesktop);

String sUrl = &#34;file:///&#34; + workingDir + myTemplate;

PropertyValue[] propertyValues = new PropertyValue[0];

propertyValues = new PropertyValue[1];
propertyValues[0] = new PropertyValue();
propertyValues[0].Name = &#34;Hidden&#34;;
propertyValues[0].Value = new Boolean(true);

XComponent xComp = xCompLoader.loadComponentFromURL(
 sUrl, &#34;_blank&#34;, 0, propertyValues);
</code></pre><p>然后我们可以使用如下方式对内容进行替换:</p><pre tabindex=0><code class=language-// data-lang=//>XReplaceDescriptor xReplaceDescr = null;
XReplaceable xReplaceable = null;

XTextDocument xTextDocument = (XTextDocument) UnoRuntime
  .queryInterface(XTextDocument.class, xComp);

xReplaceable = (XReplaceable) UnoRuntime
  .queryInterface(XReplaceable.class, xTextDocument);

xReplaceDescr = (XReplaceDescriptor) xReplaceable
  .createReplaceDescriptor();

// mail merge the date
xReplaceDescr.setSearchString(&#34;&lt;date&gt;&#34;);
xReplaceDescr.setReplaceString(new Date().toString());
xReplaceable.replaceAll(xReplaceDescr);

// mail merge the addressee
xReplaceDescr.setSearchString(&#34;&lt;addressee&gt;&#34;);
xReplaceDescr.setReplaceString(&#34;Best Friend&#34;);
xReplaceable.replaceAll(xReplaceDescr);

// mail merge the signatory
xReplaceDescr.setSearchString(&#34;&lt;signatory&gt;&#34;);
xReplaceDescr.setReplaceString(&#34;Your New Boss&#34;);
xReplaceable.replaceAll(xReplaceDescr);
</code></pre><p>然后可以输出到 PDF 中:</p><pre tabindex=0><code class=language-// data-lang=//>XStorable xStorable = (XStorable) UnoRuntime
  .queryInterface(XStorable.class, xComp);

propertyValues = new PropertyValue[2];
propertyValues[0] = new PropertyValue();
propertyValues[0].Name = &#34;Overwrite&#34;;
propertyValues[0].Value = new Boolean(true);
propertyValues[1] = new PropertyValue();
propertyValues[1].Name = &#34;FilterName&#34;;
propertyValues[1].Value = &#34;writer_pdf_Export&#34;;

// Appending the favoured extension to the origin document name
String myResult = workingDir + &#34;letterOutput.pdf&#34;;
xStorable.storeToURL(&#34;file:///&#34; + myResult, propertyValues);

System.out.println(&#34;Saved &#34; + myResult);
</code></pre><h2 id=xdocreporthttpsgithubcomopensagresxdocreport><a href=https://github.com/opensagres/xdocreport target=_blank rel=noopener>xdocreport</a></h2><p>本文的核心代码如下，完整代码查看<a href=https://github.com/wx-chevalier/WXJavaToolkits/blob/master/code/src/main/java/wx/toolkits/storage/pdf/converter/docx/POIConverter.java target=_blank rel=noopener>这里</a>:</p><pre tabindex=0><code class=language-/** data-lang=/**>* @param inpuFile 输入的文件流
* @param outFile  输出的文件对象
* @return
* @function 利用Apache POI从输入的文件中生成PDF文件
*/
@SneakyThrows
public static void convertWithPOI(InputStream inpuFile, File outFile) {

   //从输入的文件流创建对象
   XWPFDocument document = new XWPFDocument(inpuFile);

   //创建PDF选项
   PdfOptions pdfOptions = PdfOptions.create();//.fontEncoding(&#34;windows-1250&#34;)

   //为输出文件创建目录
   outFile.getParentFile().mkdirs();

   //执行PDF转化
   PdfConverter.getInstance().convert(document, new FileOutputStream(outFile), pdfOptions);

}
/**
* @param inpuFile
* @param outFile
* @param renderParams
* @function 先将渲染参数填入模板DOCX文件然后生成PDF
*/
@SneakyThrows
public static void convertFromTemplateWithFreemarker(InputStream inpuFile, File outFile, Map&lt;String, Object&gt; renderParams) {

   //创建Report实例
   IXDocReport report = XDocReportRegistry.getRegistry().loadReport(
           inpuFile, TemplateEngineKind.Freemarker);

   //创建上下文
   IContext context = report.createContext();

   //填入渲染参数
   renderParams.forEach((s, o) -&gt; {
       context.put(s, o);
   });

   //创建输出流
   outFile.getParentFile().mkdirs();

   //创建转化参数
   Options options = Options.getTo(ConverterTypeTo.PDF).via(
           ConverterTypeVia.XWPF);

   //执行转化过程
   report.convert(context, options, new FileOutputStream(outFile));
}
</code></pre><h1 id=html2pdf>HTML2PDF</h1><p><a href=https://github.com/arachnys/athenapdf target=_blank rel=noopener>athenapdf</a>
<a href=https://github.com/wkhtmltopdf/wkhtmltopdf target=_blank rel=noopener>wkhtmltopdf</a></p></div><div class=article-widget><div class="container-xl row post-nav"><div class="col-6 post-nav-item"><div class=meta-nav>下一页</div><a href=/books/developer-zero-to-mastery/%E8%BD%AF%E6%8A%80%E8%83%BD/%E6%96%87%E6%A1%A3%E6%BC%94%E7%A4%BA/pdf/pdfextractor/ rel=prev>PDFExtractor</a></div></div></div><div class=body-footer><p>最近更新于 0001-01-01</p><section id=comments class="mb-3 pt-0"><div id=disqus_thread></div><script>var disqus_config=function(){};(function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="https://ngte.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)})()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></section></div></article><footer class=site-footer><div class="copyright py-4 bg-footer"><div class="row justify-content-center"><div class="text-center footer-color"><p class=mb-0>© 2017-2022 NGTE all rights reserved</p></div></div></div></footer></main></div></div><script src=//unpkg.com/heti/umd/heti-addon.min.js></script>
<script>const heti=new Heti(".article");heti.autoSpacing()</script><script type=text/javascript>window.$crisp=[],window.CRISP_WEBSITE_ID="12adcc35-9621-4313-8262-62dc654b29d8",function(){setTimeout(function(){d=document,s=d.createElement("script"),s.src="https://client.crisp.chat/l.js",s.async=1,d.getElementsByTagName("head")[0].appendChild(s)},2500)}()</script></div><div class=page-footer></div><script src=/js/vendor-bundle.min.d26509351aa0ff874abbee824e982e9b.js></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.1/highlight.min.js integrity="sha512-Ypjm0o7jOxAd4hpdoppSEN0TQOC19UtPAqD+4s5AlXmUvbmmS/YMxYqAqarQYyxTnB6/rqip9qcxlNB/3U9Wdg==" crossorigin=anonymous></script>
<script id=search-hit-algolia-template type=text/html><div class=search-hit><div class=search-hit-content><div class=search-hit-name><a href={{relpermalink}}>{{#helpers.highlight}}{ "attribute": "title" }{{/helpers.highlight}}</a></div><div class="article-metadata search-hit-type">{{type}}</div><p class=search-hit-description>{{#helpers.highlight}}{ "attribute": "summary" }{{/helpers.highlight}}</p></div></div></script><script src=https://cdn.jsdelivr.net/npm/instantsearch.js@4/dist/instantsearch.production.min.js crossorigin=anonymous></script>
<script id=dsq-count-scr src=https://ngte.disqus.com/count.js async></script>
<script src=/zh/js/algolia-search-built.min.4387d694ca1258194aaf562b8cd1c400.js type=module></script>
<script id=page-data type=application/json>{"use_headroom":false}</script><script src=/zh/js/wowchemy.min.d1673c7a11d1238516cbe12a1e84257f.js></script>
<script>var mybutton=document.getElementById("backTopBtn");window.onscroll=function(){scrollFunction()};function scrollFunction(){document.body.scrollTop>20||document.documentElement.scrollTop>20?mybutton.style.display="block":mybutton.style.display="none"}function topFunction(){document.body.scrollTop=0,document.documentElement.scrollTop=0}</script><script src=https://cdn.jsdelivr.net/gh/bryanbraun/anchorjs@4.2.2/anchor.min.js integrity="sha512-I7w3ZdSFzw5j3jU3ZkNikBNeIrl3i+hEuEdwNmqUJvwNcaBUNcijnP2gd9DtGlgVYDplfjGoD8vTNsID+lCjqg==" crossorigin=anonymous></script>
<script>anchors.add()</script><script>(function(){"use strict";if(!document.queryCommandSupported("copy"))return;function e(e,t){e.className="highlight-copy-btn",e.textContent=t,setTimeout(function(){e.textContent="",e.className="highlight-copy-btn fa fa-copy"},1e3)}function t(e){var t=window.getSelection(),n=document.createRange();return n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n),t}function n(n){var o,s=document.createElement("button");s.className="highlight-copy-btn fa fa-copy",s.textContent="",o=n.firstElementChild,s.addEventListener("click",function(){try{var n=t(o);document.execCommand("copy"),n.removeAllRanges(),e(s,"已复制")}catch(t){console&&console.log(t),e(s,"Failed :'(")}}),n.appendChild(s)}var s=document.getElementsByClassName("highlight");Array.prototype.forEach.call(s,n)})()</script></body></html>