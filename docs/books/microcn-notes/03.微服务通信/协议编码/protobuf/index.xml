<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Protobuf | Next-gen Tech Edu</title><link>https://ng-tech.icu/books/microcn-notes/03.%E5%BE%AE%E6%9C%8D%E5%8A%A1%E9%80%9A%E4%BF%A1/%E5%8D%8F%E8%AE%AE%E7%BC%96%E7%A0%81/protobuf/</link><atom:link href="https://ng-tech.icu/books/microcn-notes/03.%E5%BE%AE%E6%9C%8D%E5%8A%A1%E9%80%9A%E4%BF%A1/%E5%8D%8F%E8%AE%AE%E7%BC%96%E7%A0%81/protobuf/index.xml" rel="self" type="application/rss+xml"/><description>Protobuf</description><generator>Wowchemy (https://wowchemy.com)</generator><language>zh</language><image><url>https://ng-tech.icu/media/sharing.png</url><title>Protobuf</title><link>https://ng-tech.icu/books/microcn-notes/03.%E5%BE%AE%E6%9C%8D%E5%8A%A1%E9%80%9A%E4%BF%A1/%E5%8D%8F%E8%AE%AE%E7%BC%96%E7%A0%81/protobuf/</link></image><item><title>快速开始</title><link>https://ng-tech.icu/books/microcn-notes/03.%E5%BE%AE%E6%9C%8D%E5%8A%A1%E9%80%9A%E4%BF%A1/%E5%8D%8F%E8%AE%AE%E7%BC%96%E7%A0%81/protobuf/%E5%BF%AB%E9%80%9F%E5%BC%80%E5%A7%8B/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://ng-tech.icu/books/microcn-notes/03.%E5%BE%AE%E6%9C%8D%E5%8A%A1%E9%80%9A%E4%BF%A1/%E5%8D%8F%E8%AE%AE%E7%BC%96%E7%A0%81/protobuf/%E5%BF%AB%E9%80%9F%E5%BC%80%E5%A7%8B/</guid><description>&lt;h1 id="快速开始">快速开始&lt;/h1>
&lt;h2 id="protoc-安装">protoc 安装&lt;/h2>
&lt;ol>
&lt;li>Download the appropriate release here: &lt;a href="https://github.com/google/protobuf/releases" target="_blank" rel="noopener">https://github.com/google/protobuf/releases&lt;/a>&lt;/li>
&lt;li>Unzip the folder&lt;/li>
&lt;li>Enter the folder and run &lt;code>./autogen.sh &amp;amp;&amp;amp; ./configure &amp;amp;&amp;amp; make&lt;/code>&lt;/li>
&lt;li>If you run into this error: &lt;em>autoreconf: failed to run aclocal: No such file or directory,&lt;/em> run &lt;code>brew install autoconf &amp;amp;&amp;amp; brew install automake.&lt;/code> And run the command from step 3 again.&lt;/li>
&lt;li>Then run these other commands. They should run without issues&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">$ make check
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ sudo make install
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ which protoc
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ protoc --version
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="代码编译">代码编译&lt;/h2></description></item><item><title>类型定义</title><link>https://ng-tech.icu/books/microcn-notes/03.%E5%BE%AE%E6%9C%8D%E5%8A%A1%E9%80%9A%E4%BF%A1/%E5%8D%8F%E8%AE%AE%E7%BC%96%E7%A0%81/protobuf/%E7%B1%BB%E5%9E%8B%E5%AE%9A%E4%B9%89/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://ng-tech.icu/books/microcn-notes/03.%E5%BE%AE%E6%9C%8D%E5%8A%A1%E9%80%9A%E4%BF%A1/%E5%8D%8F%E8%AE%AE%E7%BC%96%E7%A0%81/protobuf/%E7%B1%BB%E5%9E%8B%E5%AE%9A%E4%B9%89/</guid><description>&lt;h1 id="protobuf">Protobuf&lt;/h1>
&lt;p>首先让我们看一个简单的例子 simple.proto:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">syntax&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s">&amp;#34;proto3&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">message&lt;/span> &lt;span class="nx">SearchRequest&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">string&lt;/span> &lt;span class="nx">query&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int32&lt;/span> &lt;span class="nx">page_number&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int32&lt;/span> &lt;span class="nx">result_per_page&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>第一行指定 protobuf 的版本，这里是以 proto3 格式定义。你还可以指定为 proto2。如果没有指定，默认以 proto2 格式定义。它定义了一个 message 类型: &lt;code>SearchRequest&lt;/code>，它包含三个字段&lt;code>query&lt;/code>、&lt;code>page_number&lt;/code>、&lt;code>result_per_page&lt;/code>,它会被 protoc 编译成不同的编程语言的相应对象，比如 Java 中的 class、Go 中的 struct 等。&lt;/p>
&lt;p>字段是以&lt;code>[ &amp;quot;repeated&amp;quot; ] type fieldName &amp;quot;=&amp;quot; fieldNumber [ &amp;quot;[&amp;quot; fieldOptions &amp;quot;]&amp;quot; ] &amp;quot;;&amp;quot;&lt;/code>格式定义的。这个例子是一个简单的例子，采用了&lt;code>type fieldName &amp;quot;=&amp;quot; fieldNumber&lt;/code>格式定义的。&lt;/p>
&lt;p>比如第一个字段&lt;code>query&lt;/code>, 首先是它的类型&lt;code>string&lt;/code>，其次是字段的名称，然后是等号&lt;code>=&lt;/code>, 之后是字段的序号，然后是分号。复杂的结构，前面可以定义为&lt;code>repeated&lt;/code>, 序号之后可以定义一些可选项。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">syntax&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s">&amp;#34;proto3&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">package&lt;/span> &lt;span class="nx">fromatob&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// FromAtoB is a simplified version of fromAtoB’s backend API.
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="nx">service&lt;/span> &lt;span class="nx">FromAtoB&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">rpc&lt;/span> &lt;span class="nf">Lookup&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">LookupRequest&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="nf">returns&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">Coordinate&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// A LookupRequest is a request to look up the coordinates for a city by name.
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="nx">message&lt;/span> &lt;span class="nx">LookupRequest&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">string&lt;/span> &lt;span class="nx">name&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// A Coordinate identifies a location on Earth by latitude and longitude.
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="nx">message&lt;/span> &lt;span class="nx">Coordinate&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// Latitude is the degrees latitude of the location, in the range [-90, 90].
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="nx">double&lt;/span> &lt;span class="nx">latitude&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// Longitude is the degrees longitude of the location, in the range [-180, 180].
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="nx">double&lt;/span> &lt;span class="nx">longitude&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item></channel></rss>