<!doctype html><html lang=zh><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=generator content="Wowchemy 5.5.0 for Hugo"><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=preload as=style href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap"><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap" media=print onload='this.media="all"'><meta name=google-site-verification content="google69a5cccb61297807"><meta name=baidu-site-verification content="cqmZHEleVh"><meta name=description content="附录:对象序列化 当你创建对象时，只要你需要，它就会一直存在，但是在程序终止时，无论如何它都不会继续存在。尽管这么做肯定是有意义的，但是仍旧存在某些情况，如果对象能够在程序不运行的情况下仍能存在并保存其"><link rel=alternate hreflang=zh href=https://ng-tech.icu/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/appendix-object-serialization/><meta name=theme-color content="#0a55a7"><link rel=stylesheet href=/css/vendor-bundle.min.c7b8d9abd591ba2253ea42747e3ac3f5.css media=print onload='this.media="all"'><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.1/styles/github.min.css crossorigin=anonymous title=hl-light media=print onload='this.media="all"'><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.1/styles/dracula.min.css crossorigin=anonymous title=hl-dark media=print onload='this.media="all"' disabled><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/instantsearch.css@7.4.5/themes/satellite-min.css integrity="sha256-TehzF/2QvNKhGQrrNpoOb2Ck4iGZ1J/DI4pkd2oUsBc=" crossorigin=anonymous><link rel=stylesheet href=/css/wowchemy.63df6ae9fc2b4cc71b83f1774d780209.css><script async src="https://www.googletagmanager.com/gtag/js?id=G-40NYXJ8823"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-40NYXJ8823")</script><script>var _hmt=_hmt||[];(function(){var e,t=document.createElement("script");t.src="https://hm.baidu.com/hm.js?56df1177bce405601b0ecdd7208f75c6",e=document.getElementsByTagName("script")[0],e.parentNode.insertBefore(t,e)})()</script><link rel=manifest href=/manifest.webmanifest><link rel=icon type=image/png href=/media/icon_hu0f7d075e895d6f5f1f5fdbc1e33dc138_10087_32x32_fill_lanczos_center_3.png><link rel=apple-touch-icon type=image/png href=/media/icon_hu0f7d075e895d6f5f1f5fdbc1e33dc138_10087_180x180_fill_lanczos_center_3.png><link rel=canonical href=https://ng-tech.icu/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/appendix-object-serialization/><meta property="twitter:card" content="summary_large_image"><meta property="twitter:site" content="@wx-chevalier"><meta property="twitter:creator" content="@wx-chevalier"><meta property="og:site_name" content="Next-gen Tech Edu"><meta property="og:url" content="https://ng-tech.icu/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/appendix-object-serialization/"><meta property="og:title" content="Appendix-Object-Serialization | Next-gen Tech Edu"><meta property="og:description" content="附录:对象序列化 当你创建对象时，只要你需要，它就会一直存在，但是在程序终止时，无论如何它都不会继续存在。尽管这么做肯定是有意义的，但是仍旧存在某些情况，如果对象能够在程序不运行的情况下仍能存在并保存其"><meta property="og:image" content="https://ng-tech.icu/media/sharing.png"><meta property="twitter:image" content="https://ng-tech.icu/media/sharing.png"><meta property="og:locale" content="zh"><title>Appendix-Object-Serialization | Next-gen Tech Edu</title></head><body id=top data-spy=scroll data-offset=70 data-target=#TableOfContents class=page-wrapper data-wc-page-id=759bcbbed3d9cdf1bfb961ad3a2f07a9><button onclick=topFunction() id=backTopBtn title="Go to top"><i class="fa-solid fa-circle-up" aria-hidden=true></i></button>
<script src=/js/wowchemy-init.min.14a0ed61c6dbd594b9c75193b25be179.js></script><aside class=search-modal id=search><div class=container><section class=search-header><div class="row no-gutters justify-content-between mb-3"><div class="col-6 search-title"><p>搜索</p></div><div class="col-6 col-search-close"><a class=js-search href=# aria-label=关闭><i class="fas fa-times-circle text-muted" aria-hidden=true></i></a></div></div><div id=search-box></div></section><section class=section-search-results><div id=search-hits></div><div id=search-common-queries></div></section></div></aside><div class=page-header><header class=header--fixed><nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id=navbar-main><div class=container-xl><div class="d-none d-lg-inline-flex"><a class=navbar-brand href=/>Next-gen Tech Edu</a></div><button type=button class=navbar-toggler data-toggle=collapse data-target=#navbar-content aria-controls=navbar-content aria-expanded=false aria-label=切换导航>
<span><i class="fas fa-bars"></i></span></button><div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none"><a class=navbar-brand href=/>Next-gen Tech Edu</a></div><div class="navbar-collapse main-menu-item collapse justify-content-start" id=navbar-content><ul class="navbar-nav d-md-inline-flex"><li class=nav-item><a class=nav-link href=/books-gallery><span>笔记（万篇）</span></a></li><li class=nav-item><a class=nav-link href=/#knowledge-map><span>知识图谱</span></a></li><style>.dropdown-item{display:inline-flex}</style><li class="nav-item dropdown"><a href=# class="nav-link dropdown-toggle" data-toggle=dropdown aria-haspopup=true><span>实验室</span><span class=caret></span></a><div class=dropdown-menu><a class=dropdown-item href=/galaxy-home/gh-craft><span>Craft 方块世界</span></a>
<a class=dropdown-item href=/galaxy-home/glossary-cards><span>3D 知识卡牌</span></a></div></li><style>.dropdown-item{display:inline-flex}</style><li class="nav-item dropdown"><a href=# class="nav-link dropdown-toggle" data-toggle=dropdown aria-haspopup=true><span>其他阅读渠道</span><span class=caret></span></a><div class=dropdown-menu><a class=dropdown-item href=https://zhuanlan.zhihu.com/wxyyxc1992><img style=width:16px;height:16px;display:inline-block;margin-right:8px src=https://ngte-superbed.oss-cn-beijing.aliyuncs.com/item/20230218234451.png></img><span>知乎</span></a>
<a class=dropdown-item href=https://segmentfault.com/blog/wxyyxc1992><img style=width:16px;height:16px;display:inline-block;margin-right:8px src=https://ngte-superbed.oss-cn-beijing.aliyuncs.com/item/20230219113556.png></img><span>SegmentFault</span></a>
<a class=dropdown-item href=https://zhuanlan.zhihu.com/wxyyxc1992><img style=width:16px;height:16px;display:inline-block;margin-right:8px src=https://ngte-superbed.oss-cn-beijing.aliyuncs.com/item/20230219113519.png></img><span>掘金</span></a></div></li></ul></div><ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2"><li class=nav-item><a class="nav-link js-search" href=# aria-label=搜索><i class="fas fa-search" aria-hidden=true></i></a></li><li class=nav-item><a class=nav-link href=https://github.com/wx-chevalier aria-label=GitHub><i class="fa-brands fa-github" aria-hidden=true></i></a></li><div></div><style>@media only screen and (max-width:600px){.jimmysong-template{display:none!important}}</style><li class=jimmysong-template style=color:#fff;font-size:12px><a href=https://jimmysong.io style=color:#fff>By Jimmy Song's Template</a></li></ul></div></nav></header></div><div class=page-body><link rel=stylesheet href=//unpkg.com/heti/umd/heti.min.css><div class="container-xl docs"><div class="row flex-xl-nowrap"><div class=docs-sidebar><form class="docs-search d-flex align-items-center"><button class="btn docs-toggle d-md-none p-0 mr-md-3 w-100" type=button data-toggle=collapse data-target=#docs-nav aria-controls=docs-nav aria-expanded=false aria-label="Toggle section navigation"><div class=d-flex><span class="d-md-none pl-1 flex-grow-1 text-left overflow-hidden">On Java 8</span>
<span><i class="fas fa-chevron-down"></i></span></div></button>
<button class="form-control sidebar-search js-search d-none d-md-flex">
<i class="fas fa-search pr-2"></i>
<span class=sidebar-search-text>搜索...</span>
<span class=sidebar-search-shortcut>/</span></button></form><nav class="collapse docs-links" id=docs-nav><ul class="nav docs-sidenav"><li style=display:inline-flex><a style=cursor:pointer onclick=window.history.back()><i class="fas fa-arrow-left pr-1"></i>
Back</a>
<span>|</span>
<a href=/books/><i class="fa-solid fa-house" style=margin-right:4px></i>
Books</a></li></ul><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-id033d338afe3a284a3059f00eb3f74ee6")' href=#id033d338afe3a284a3059f00eb3f74ee6 aria-expanded=false aria-controls=id033d338afe3a284a3059f00eb3f74ee6 aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/>99.参考资料</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#id033d338afe3a284a3059f00eb3f74ee6 aria-expanded=false aria-controls=id033d338afe3a284a3059f00eb3f74ee6><i class="fa-solid fa-angle-down" id=caret-id033d338afe3a284a3059f00eb3f74ee6></i></a></div><ul class="nav docs-sidenav collapse show" id=id033d338afe3a284a3059f00eb3f74ee6><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-id1aa67499dcba1f0a540c8357bb806bdb")' href=#id1aa67499dcba1f0a540c8357bb806bdb aria-expanded=false aria-controls=id1aa67499dcba1f0a540c8357bb806bdb aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/>On Java 8</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#id1aa67499dcba1f0a540c8357bb806bdb aria-expanded=false aria-controls=id1aa67499dcba1f0a540c8357bb806bdb><i class="fa-solid fa-angle-down" id=caret-id1aa67499dcba1f0a540c8357bb806bdb></i></a></div><ul class="nav docs-sidenav collapse show" id=id1aa67499dcba1f0a540c8357bb806bdb><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/00-introduction/>00-Introduction</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/01-what-is-an-object/>01-What-is-an-Object</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/02-installing-java-and-the-book-examples/>02-Installing-Java-and-the-Book-Examples</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/03-objects-everywhere/>03-Objects-Everywhere</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/04-operators/>04-Operators</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/05-control-flow/>05-Control-Flow</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/06-housekeeping/>06-Housekeeping</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/07-implementation-hiding/>07-Implementation-Hiding</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/08-reuse/>08-Reuse</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/09-polymorphism/>09-Polymorphism</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/10-interfaces/>10-Interfaces</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/11-inner-classes/>11-Inner-Classes</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/12-collections/>12-Collections</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/13-functional-programming/>13-Functional-Programming</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/14-streams/>14-Streams</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/15-exceptions/>15-Exceptions</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/16-validating-your-code/>16-Validating-Your-Code</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/17-files/>17-Files</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/18-strings/>18-Strings</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/19-type-information/>19-Type-Information</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/20-generics/>20-Generics</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/21-arrays/>21-Arrays</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/22-enumerations/>22-Enumerations</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/23-annotations/>23-Annotations</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/24-concurrent-programming/>24-Concurrent-Programming</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/25-patterns/>25-Patterns</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/appendix-becoming-a-programmer/>Appendix-Becoming-a-Programmer</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/appendix-benefits-and-costs-of-static-type-checking/>Appendix-Benefits-and-Costs-of-Static-Type-Checking</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/appendix-collection-topics/>Appendix-Collection-Topics</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/appendix-data-compression/>Appendix-Data-Compression</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/appendix-io-streams/>Appendix-IO-Streams</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/appendix-javadoc/>Appendix-Javadoc</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/appendix-low-level-concurrency/>Appendix-Low-Level-Concurrency</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/appendix-new-io/>Appendix-New-IO</a></li><li class="child level active"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/appendix-object-serialization/>Appendix-Object-Serialization</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/appendix-passing-and-returning-objects/>Appendix-Passing-and-Returning-Objects</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/appendix-programming-guidelines/>Appendix-Programming-Guidelines</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/appendix-standard-io/>Appendix-Standard-IO</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/appendix-supplements/>Appendix-Supplements</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/appendix-the-positive-legacy-of-c-plus-plus-and-java/>Appendix-The-Positive-Legacy-of-C-plus-plus-and-Java</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/appendix-understanding-equals-and-hashcode/>Appendix-Understanding-equals-and-hashCode</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/glossary/>GLOSSARY</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-id4a2a80a5068b60ff6f63901f454227d5")' href=#id4a2a80a5068b60ff6f63901f454227d5 aria-expanded=false aria-controls=id4a2a80a5068b60ff6f63901f454227d5 aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/>Think in Java</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#id4a2a80a5068b60ff6f63901f454227d5 aria-expanded=false aria-controls=id4a2a80a5068b60ff6f63901f454227d5><i class="fa-solid fa-angle-right" id=caret-id4a2a80a5068b60ff6f63901f454227d5></i></a></div><ul class="nav docs-sidenav collapse" id=id4a2a80a5068b60ff6f63901f454227d5><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-id9176d525635447d8d7142fd74b80d40d")' href=#id9176d525635447d8d7142fd74b80d40d aria-expanded=false aria-controls=id9176d525635447d8d7142fd74b80d40d aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/1.%E5%AF%B9%E8%B1%A1%E5%85%A5%E9%97%A8/>1.对象入门</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#id9176d525635447d8d7142fd74b80d40d aria-expanded=false aria-controls=id9176d525635447d8d7142fd74b80d40d><i class="fa-solid fa-angle-right" id=caret-id9176d525635447d8d7142fd74b80d40d></i></a></div><ul class="nav docs-sidenav collapse" id=id9176d525635447d8d7142fd74b80d40d><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/1.%E5%AF%B9%E8%B1%A1%E5%85%A5%E9%97%A8/1.1-%E6%8A%BD%E8%B1%A1%E7%9A%84%E8%BF%9B%E6%AD%A5/>1.1 抽象的进步</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/1.%E5%AF%B9%E8%B1%A1%E5%85%A5%E9%97%A8/1.10-%E6%B0%B8%E4%B9%85%E6%80%A7/>1.10 永久性</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/1.%E5%AF%B9%E8%B1%A1%E5%85%A5%E9%97%A8/1.11-java%E5%92%8C%E5%9B%A0%E7%89%B9%E7%BD%91/>1.11 Java和因特网</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/1.%E5%AF%B9%E8%B1%A1%E5%85%A5%E9%97%A8/1.12-%E5%88%86%E6%9E%90%E5%92%8C%E8%AE%BE%E8%AE%A1/>1.12 分析和设计</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/1.%E5%AF%B9%E8%B1%A1%E5%85%A5%E9%97%A8/1.13-java%E8%BF%98%E6%98%AFc++/>1.13 Java还是C++</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/1.%E5%AF%B9%E8%B1%A1%E5%85%A5%E9%97%A8/1.2-%E5%AF%B9%E8%B1%A1%E7%9A%84%E6%8E%A5%E5%8F%A3/>1.2 对象的接口</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/1.%E5%AF%B9%E8%B1%A1%E5%85%A5%E9%97%A8/1.3-%E5%AE%9E%E7%8E%B0%E6%96%B9%E6%A1%88%E7%9A%84%E9%9A%90%E8%97%8F/>1.3 实现方案的隐藏</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/1.%E5%AF%B9%E8%B1%A1%E5%85%A5%E9%97%A8/1.4-%E6%96%B9%E6%A1%88%E7%9A%84%E9%87%8D%E5%A4%8D%E4%BD%BF%E7%94%A8/>1.4 方案的重复使用</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/1.%E5%AF%B9%E8%B1%A1%E5%85%A5%E9%97%A8/1.5-%E7%BB%A7%E6%89%BF%E9%87%8D%E6%96%B0%E4%BD%BF%E7%94%A8%E6%8E%A5%E5%8F%A3/>1.5 继承：重新使用接口</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/1.%E5%AF%B9%E8%B1%A1%E5%85%A5%E9%97%A8/1.6-%E5%A4%9A%E6%80%81%E5%AF%B9%E8%B1%A1%E7%9A%84%E4%BA%92%E6%8D%A2%E4%BD%BF%E7%94%A8/>1.6 多态对象的互换使用</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/1.%E5%AF%B9%E8%B1%A1%E5%85%A5%E9%97%A8/1.7-%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%88%9B%E5%BB%BA%E5%92%8C%E5%AD%98%E5%9C%A8%E6%97%B6%E9%97%B4/>1.7 对象的创建和存在时间</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/1.%E5%AF%B9%E8%B1%A1%E5%85%A5%E9%97%A8/1.9-%E5%A4%9A%E7%BA%BF%E7%A8%8B/>1.9 多线程</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-id70f1e6e817cedf39d3797ac4da5f8d6c")' href=#id70f1e6e817cedf39d3797ac4da5f8d6c aria-expanded=false aria-controls=id70f1e6e817cedf39d3797ac4da5f8d6c aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/10.java-io-%E7%B3%BB%E7%BB%9F/>10.Java IO 系统</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#id70f1e6e817cedf39d3797ac4da5f8d6c aria-expanded=false aria-controls=id70f1e6e817cedf39d3797ac4da5f8d6c><i class="fa-solid fa-angle-right" id=caret-id70f1e6e817cedf39d3797ac4da5f8d6c></i></a></div><ul class="nav docs-sidenav collapse" id=id70f1e6e817cedf39d3797ac4da5f8d6c><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/10.java-io-%E7%B3%BB%E7%BB%9F/10.1-%E8%BE%93%E5%85%A5%E5%92%8C%E8%BE%93%E5%87%BA/>10.1 输入和输出</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/10.java-io-%E7%B3%BB%E7%BB%9F/10.10-%E6%80%BB%E7%BB%93/>10.10 总结</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/10.java-io-%E7%B3%BB%E7%BB%9F/10.11-%E7%BB%83%E4%B9%A0/>10.11 练习</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/10.java-io-%E7%B3%BB%E7%BB%9F/10.2-%E5%A2%9E%E6%B7%BB%E5%B1%9E%E6%80%A7%E5%92%8C%E6%9C%89%E7%94%A8%E7%9A%84%E6%8E%A5%E5%8F%A3/>10.2 增添属性和有用的接口</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/10.java-io-%E7%B3%BB%E7%BB%9F/10.3-%E6%9C%AC%E8%BA%AB%E7%9A%84%E7%BC%BA%E9%99%B7randomaccessfile/>10.3 本身的缺陷：RandomAccessFile</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/10.java-io-%E7%B3%BB%E7%BB%9F/10.4-file%E7%B1%BB/>10.4 File类</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/10.java-io-%E7%B3%BB%E7%BB%9F/10.5-io%E6%B5%81%E7%9A%84%E5%85%B8%E5%9E%8B%E5%BA%94%E7%94%A8/>10.5 IO流的典型应用</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/10.java-io-%E7%B3%BB%E7%BB%9F/10.6-streamtokenizer/>10.6 StreamTokenizer</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/10.java-io-%E7%B3%BB%E7%BB%9F/10.7-java-1.1%E7%9A%84io%E6%B5%81/>10.7 Java 1.1的IO流</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/10.java-io-%E7%B3%BB%E7%BB%9F/10.8-%E5%8E%8B%E7%BC%A9/>10.8 压缩</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/10.java-io-%E7%B3%BB%E7%BB%9F/10.9-%E5%AF%B9%E8%B1%A1%E5%BA%8F%E5%88%97%E5%8C%96/>10.9 对象序列化</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-idfec0098963e0c81a0402f5db5a6e319e")' href=#idfec0098963e0c81a0402f5db5a6e319e aria-expanded=false aria-controls=idfec0098963e0c81a0402f5db5a6e319e aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/11.%E8%BF%90%E8%A1%8C%E6%9C%9F%E7%B1%BB%E5%9E%8B%E9%89%B4%E5%AE%9A/>11.运行期类型鉴定</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#idfec0098963e0c81a0402f5db5a6e319e aria-expanded=false aria-controls=idfec0098963e0c81a0402f5db5a6e319e><i class="fa-solid fa-angle-right" id=caret-idfec0098963e0c81a0402f5db5a6e319e></i></a></div><ul class="nav docs-sidenav collapse" id=idfec0098963e0c81a0402f5db5a6e319e><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/11.%E8%BF%90%E8%A1%8C%E6%9C%9F%E7%B1%BB%E5%9E%8B%E9%89%B4%E5%AE%9A/11.1-%E5%AF%B9rtti%E7%9A%84%E9%9C%80%E8%A6%81/>11.1 对RTTI的需要</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/11.%E8%BF%90%E8%A1%8C%E6%9C%9F%E7%B1%BB%E5%9E%8B%E9%89%B4%E5%AE%9A/11.2-rtti-%E8%AF%AD%E6%B3%95/>11.2 RTTI 语法</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/11.%E8%BF%90%E8%A1%8C%E6%9C%9F%E7%B1%BB%E5%9E%8B%E9%89%B4%E5%AE%9A/11.3-%E5%8F%8D%E5%B0%84%E8%BF%90%E8%A1%8C%E6%9C%9F%E7%B1%BB%E4%BF%A1%E6%81%AF/>11.3 反射：运行期类信息</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/11.%E8%BF%90%E8%A1%8C%E6%9C%9F%E7%B1%BB%E5%9E%8B%E9%89%B4%E5%AE%9A/11.4-%E6%80%BB%E7%BB%93/>11.4 总结</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/11.%E8%BF%90%E8%A1%8C%E6%9C%9F%E7%B1%BB%E5%9E%8B%E9%89%B4%E5%AE%9A/11.5-%E7%BB%83%E4%B9%A0/>11.5 练习</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-id066af4565dbe51516e21378ece167ac4")' href=#id066af4565dbe51516e21378ece167ac4 aria-expanded=false aria-controls=id066af4565dbe51516e21378ece167ac4 aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/12.%E4%BC%A0%E9%80%92%E5%92%8C%E8%BF%94%E5%9B%9E%E5%AF%B9%E8%B1%A1/>12.传递和返回对象</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#id066af4565dbe51516e21378ece167ac4 aria-expanded=false aria-controls=id066af4565dbe51516e21378ece167ac4><i class="fa-solid fa-angle-right" id=caret-id066af4565dbe51516e21378ece167ac4></i></a></div><ul class="nav docs-sidenav collapse" id=id066af4565dbe51516e21378ece167ac4><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/12.%E4%BC%A0%E9%80%92%E5%92%8C%E8%BF%94%E5%9B%9E%E5%AF%B9%E8%B1%A1/12.1-%E4%BC%A0%E9%80%92%E6%8C%87%E9%92%88/>12.1 传递指针</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/12.%E4%BC%A0%E9%80%92%E5%92%8C%E8%BF%94%E5%9B%9E%E5%AF%B9%E8%B1%A1/12.2-%E5%88%B6%E4%BD%9C%E6%9C%AC%E5%9C%B0%E5%89%AF%E6%9C%AC/>12.2 制作本地副本</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/12.%E4%BC%A0%E9%80%92%E5%92%8C%E8%BF%94%E5%9B%9E%E5%AF%B9%E8%B1%A1/12.3-%E5%85%8B%E9%9A%86%E7%9A%84%E6%8E%A7%E5%88%B6/>12.3 克隆的控制</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/12.%E4%BC%A0%E9%80%92%E5%92%8C%E8%BF%94%E5%9B%9E%E5%AF%B9%E8%B1%A1/12.4-%E5%8F%AA%E8%AF%BB%E7%B1%BB/>12.4 只读类</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/12.%E4%BC%A0%E9%80%92%E5%92%8C%E8%BF%94%E5%9B%9E%E5%AF%B9%E8%B1%A1/12.5-%E6%80%BB%E7%BB%93/>12.5 总结</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/12.%E4%BC%A0%E9%80%92%E5%92%8C%E8%BF%94%E5%9B%9E%E5%AF%B9%E8%B1%A1/12.6-%E7%BB%83%E4%B9%A0/>12.6 练习</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-id11c54e0c8ec90e6f5da1bbc434542b18")' href=#id11c54e0c8ec90e6f5da1bbc434542b18 aria-expanded=false aria-controls=id11c54e0c8ec90e6f5da1bbc434542b18 aria-hidden=false data-toggle=collapse></div></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-id7deaa96e5b7b89f67be6ae9e949e2809")' href=#id7deaa96e5b7b89f67be6ae9e949e2809 aria-expanded=false aria-controls=id7deaa96e5b7b89f67be6ae9e949e2809 aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/14.%E5%A4%9A%E7%BA%BF%E7%A8%8B/>14.多线程</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#id7deaa96e5b7b89f67be6ae9e949e2809 aria-expanded=false aria-controls=id7deaa96e5b7b89f67be6ae9e949e2809><i class="fa-solid fa-angle-right" id=caret-id7deaa96e5b7b89f67be6ae9e949e2809></i></a></div><ul class="nav docs-sidenav collapse" id=id7deaa96e5b7b89f67be6ae9e949e2809><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/14.%E5%A4%9A%E7%BA%BF%E7%A8%8B/14.1-%E5%8F%8D%E5%BA%94%E7%81%B5%E6%95%8F%E7%9A%84%E7%94%A8%E6%88%B7%E7%95%8C%E9%9D%A2/>14.1 反应灵敏的用户界面</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/14.%E5%A4%9A%E7%BA%BF%E7%A8%8B/14.2-%E5%85%B1%E4%BA%AB%E6%9C%89%E9%99%90%E7%9A%84%E8%B5%84%E6%BA%90/>14.2 共享有限的资源</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/14.%E5%A4%9A%E7%BA%BF%E7%A8%8B/14.3-%E5%A0%B5%E5%A1%9E/>14.3 堵塞</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/14.%E5%A4%9A%E7%BA%BF%E7%A8%8B/14.4-%E4%BC%98%E5%85%88%E7%BA%A7/>14.4 优先级</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/14.%E5%A4%9A%E7%BA%BF%E7%A8%8B/14.5-%E5%9B%9E%E9%A1%BErunnable/>14.5 回顾runnable</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/14.%E5%A4%9A%E7%BA%BF%E7%A8%8B/14.6-%E6%80%BB%E7%BB%93/>14.6 总结</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/14.%E5%A4%9A%E7%BA%BF%E7%A8%8B/14.7-%E7%BB%83%E4%B9%A0/>14.7 练习</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-idfbfaa920e3bf4df50a039e5b69621652")' href=#idfbfaa920e3bf4df50a039e5b69621652 aria-expanded=false aria-controls=idfbfaa920e3bf4df50a039e5b69621652 aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/15.%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/>15.网络编程</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#idfbfaa920e3bf4df50a039e5b69621652 aria-expanded=false aria-controls=idfbfaa920e3bf4df50a039e5b69621652><i class="fa-solid fa-angle-right" id=caret-idfbfaa920e3bf4df50a039e5b69621652></i></a></div><ul class="nav docs-sidenav collapse" id=idfbfaa920e3bf4df50a039e5b69621652><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/15.%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/15.1-%E6%9C%BA%E5%99%A8%E7%9A%84%E6%A0%87%E8%AF%86/>15.1 机器的标识</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/15.%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/15.10-%E7%BB%83%E4%B9%A0/>15.10 练习</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/15.%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/15.2-%E5%A5%97%E6%8E%A5%E5%AD%97/>15.2 套接字</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/15.%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/15.3-%E6%9C%8D%E5%8A%A1%E5%A4%9A%E4%B8%AA%E5%AE%A2%E6%88%B7/>15.3 服务多个客户</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/15.%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/15.4-%E6%95%B0%E6%8D%AE%E6%8A%A5/>15.4 数据报</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/15.%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/15.5-%E4%B8%80%E4%B8%AAweb%E5%BA%94%E7%94%A8/>15.5 一个Web应用</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/15.%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/15.6-java%E4%B8%8Ecgi%E7%9A%84%E6%B2%9F%E9%80%9A/>15.6 Java与CGI的沟通</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/15.%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/15.7-%E7%94%A8jdbc%E8%BF%9E%E6%8E%A5%E6%95%B0%E6%8D%AE%E5%BA%93/>15.7 用JDBC连接数据库</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/15.%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/15.8-%E8%BF%9C%E7%A8%8B%E6%96%B9%E6%B3%95/>15.8 远程方法</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/15.%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/15.9-%E6%80%BB%E7%BB%93/>15.9 总结</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-idd6b731bca9fa0fa1240f59a73312d3ed")' href=#idd6b731bca9fa0fa1240f59a73312d3ed aria-expanded=false aria-controls=idd6b731bca9fa0fa1240f59a73312d3ed aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/16.%E8%AE%BE%E8%AE%A1%E8%8C%83%E5%BC%8F/>16.设计范式</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#idd6b731bca9fa0fa1240f59a73312d3ed aria-expanded=false aria-controls=idd6b731bca9fa0fa1240f59a73312d3ed><i class="fa-solid fa-angle-right" id=caret-idd6b731bca9fa0fa1240f59a73312d3ed></i></a></div><ul class="nav docs-sidenav collapse" id=idd6b731bca9fa0fa1240f59a73312d3ed><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/16.%E8%AE%BE%E8%AE%A1%E8%8C%83%E5%BC%8F/16.1-%E8%8C%83%E5%BC%8F%E7%9A%84%E6%A6%82%E5%BF%B5/>16.1 范式的概念</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/16.%E8%AE%BE%E8%AE%A1%E8%8C%83%E5%BC%8F/16.10-%E7%BB%83%E4%B9%A0/>16.10 练习</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/16.%E8%AE%BE%E8%AE%A1%E8%8C%83%E5%BC%8F/16.2-%E8%A7%82%E5%AF%9F%E5%99%A8%E8%8C%83%E5%BC%8F/>16.2 观察器范式</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/16.%E8%AE%BE%E8%AE%A1%E8%8C%83%E5%BC%8F/16.3-%E6%A8%A1%E6%8B%9F%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6%E7%AB%99/>16.3 模拟垃圾回收站</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/16.%E8%AE%BE%E8%AE%A1%E8%8C%83%E5%BC%8F/16.4-%E6%94%B9%E8%BF%9B%E8%AE%BE%E8%AE%A1/>16.4 改进设计</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/16.%E8%AE%BE%E8%AE%A1%E8%8C%83%E5%BC%8F/16.5-%E6%8A%BD%E8%B1%A1%E7%9A%84%E5%BA%94%E7%94%A8/>16.5 抽象的应用</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/16.%E8%AE%BE%E8%AE%A1%E8%8C%83%E5%BC%8F/16.6-%E5%A4%9A%E9%87%8D%E6%B4%BE%E9%81%A3/>16.6 多重派遣</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/16.%E8%AE%BE%E8%AE%A1%E8%8C%83%E5%BC%8F/16.7-%E8%AE%BF%E9%97%AE%E5%99%A8%E8%8C%83%E5%BC%8F/>16.7 访问器范式</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/16.%E8%AE%BE%E8%AE%A1%E8%8C%83%E5%BC%8F/16.8-rtti%E7%9C%9F%E7%9A%84%E6%9C%89%E5%AE%B3%E5%90%97/>16.8 RTTI真的有害吗</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/16.%E8%AE%BE%E8%AE%A1%E8%8C%83%E5%BC%8F/16.9-%E6%80%BB%E7%BB%93/>16.9 总结</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-id389713bbf5649104181bb2266f435fb5")' href=#id389713bbf5649104181bb2266f435fb5 aria-expanded=false aria-controls=id389713bbf5649104181bb2266f435fb5 aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/17.%E9%A1%B9%E7%9B%AE/>17.项目</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#id389713bbf5649104181bb2266f435fb5 aria-expanded=false aria-controls=id389713bbf5649104181bb2266f435fb5><i class="fa-solid fa-angle-right" id=caret-id389713bbf5649104181bb2266f435fb5></i></a></div><ul class="nav docs-sidenav collapse" id=id389713bbf5649104181bb2266f435fb5><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/17.%E9%A1%B9%E7%9B%AE/17.1-%E6%96%87%E5%AD%97%E5%A4%84%E7%90%86/>17.1 文字处理</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/17.%E9%A1%B9%E7%9B%AE/17.2-%E6%96%B9%E6%B3%95%E6%9F%A5%E6%89%BE%E5%B7%A5%E5%85%B7/>17.2 方法查找工具</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/17.%E9%A1%B9%E7%9B%AE/17.3-%E5%A4%8D%E6%9D%82%E6%80%A7%E7%90%86%E8%AE%BA/>17.3 复杂性理论</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/17.%E9%A1%B9%E7%9B%AE/17.4-%E6%80%BB%E7%BB%93/>17.4 总结</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/17.%E9%A1%B9%E7%9B%AE/17.5-%E7%BB%83%E4%B9%A0/>17.5 练习</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-id5e0e190c5cd76ef398a29510006da42c")' href=#id5e0e190c5cd76ef398a29510006da42c aria-expanded=false aria-controls=id5e0e190c5cd76ef398a29510006da42c aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/2.%E4%B8%80%E5%88%87%E9%83%BD%E6%98%AF%E5%AF%B9%E8%B1%A1/>2.一切都是对象</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#id5e0e190c5cd76ef398a29510006da42c aria-expanded=false aria-controls=id5e0e190c5cd76ef398a29510006da42c><i class="fa-solid fa-angle-right" id=caret-id5e0e190c5cd76ef398a29510006da42c></i></a></div><ul class="nav docs-sidenav collapse" id=id5e0e190c5cd76ef398a29510006da42c><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/2.%E4%B8%80%E5%88%87%E9%83%BD%E6%98%AF%E5%AF%B9%E8%B1%A1/2.1-%E7%94%A8%E6%8C%87%E9%92%88%E6%93%8D%E7%BA%B5%E5%AF%B9%E8%B1%A1/>2.1 用指针操纵对象</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/2.%E4%B8%80%E5%88%87%E9%83%BD%E6%98%AF%E5%AF%B9%E8%B1%A1/2.10-%E6%80%BB%E7%BB%93/>2.10 总结</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/2.%E4%B8%80%E5%88%87%E9%83%BD%E6%98%AF%E5%AF%B9%E8%B1%A1/2.11-%E7%BB%83%E4%B9%A0/>2.11 练习</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/2.%E4%B8%80%E5%88%87%E9%83%BD%E6%98%AF%E5%AF%B9%E8%B1%A1/2.2-%E6%89%80%E6%9C%89%E5%AF%B9%E8%B1%A1%E9%83%BD%E5%BF%85%E9%A1%BB%E5%88%9B%E5%BB%BA/>2.2 所有对象都必须创建</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/2.%E4%B8%80%E5%88%87%E9%83%BD%E6%98%AF%E5%AF%B9%E8%B1%A1/2.3-%E7%BB%9D%E5%AF%B9%E4%B8%8D%E8%A6%81%E6%B8%85%E9%99%A4%E5%AF%B9%E8%B1%A1/>2.3 绝对不要清除对象</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/2.%E4%B8%80%E5%88%87%E9%83%BD%E6%98%AF%E5%AF%B9%E8%B1%A1/2.4-%E6%96%B0%E5%BB%BA%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E7%B1%BB/>2.4 新建数据类型：类</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/2.%E4%B8%80%E5%88%87%E9%83%BD%E6%98%AF%E5%AF%B9%E8%B1%A1/2.5-%E6%96%B9%E6%B3%95%E8%87%AA%E5%8F%98%E9%87%8F%E5%92%8C%E8%BF%94%E5%9B%9E%E5%80%BC/>2.5 方法、自变量和返回值</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/2.%E4%B8%80%E5%88%87%E9%83%BD%E6%98%AF%E5%AF%B9%E8%B1%A1/2.6-%E6%9E%84%E5%BB%BAjava%E7%A8%8B%E5%BA%8F/>2.6 构建Java程序</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/2.%E4%B8%80%E5%88%87%E9%83%BD%E6%98%AF%E5%AF%B9%E8%B1%A1/2.7-%E6%88%91%E4%BB%AC%E7%9A%84%E7%AC%AC%E4%B8%80%E4%B8%AAjava%E7%A8%8B%E5%BA%8F/>2.7 我们的第一个Java程序</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/2.%E4%B8%80%E5%88%87%E9%83%BD%E6%98%AF%E5%AF%B9%E8%B1%A1/2.8-%E6%B3%A8%E9%87%8A%E5%92%8C%E5%B5%8C%E5%85%A5%E6%96%87%E6%A1%A3/>2.8 注释和嵌入文档</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/2.%E4%B8%80%E5%88%87%E9%83%BD%E6%98%AF%E5%AF%B9%E8%B1%A1/2.9-%E7%BC%96%E7%A0%81%E6%A0%B7%E5%BC%8F/>2.9 编码样式</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-id7f6454f8b47e8a81e3aa8744515a73b4")' href=#id7f6454f8b47e8a81e3aa8744515a73b4 aria-expanded=false aria-controls=id7f6454f8b47e8a81e3aa8744515a73b4 aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/3.%E6%8E%A7%E5%88%B6%E7%A8%8B%E5%BA%8F%E6%B5%81%E7%A8%8B/>3.控制程序流程</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#id7f6454f8b47e8a81e3aa8744515a73b4 aria-expanded=false aria-controls=id7f6454f8b47e8a81e3aa8744515a73b4><i class="fa-solid fa-angle-right" id=caret-id7f6454f8b47e8a81e3aa8744515a73b4></i></a></div><ul class="nav docs-sidenav collapse" id=id7f6454f8b47e8a81e3aa8744515a73b4><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/3.%E6%8E%A7%E5%88%B6%E7%A8%8B%E5%BA%8F%E6%B5%81%E7%A8%8B/3.1-%E4%BD%BF%E7%94%A8java%E8%BF%90%E7%AE%97%E7%AC%A6/>3.1 使用Java运算符</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/3.%E6%8E%A7%E5%88%B6%E7%A8%8B%E5%BA%8F%E6%B5%81%E7%A8%8B/3.2-%E6%89%A7%E8%A1%8C%E6%8E%A7%E5%88%B6/>3.2 执行控制</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/3.%E6%8E%A7%E5%88%B6%E7%A8%8B%E5%BA%8F%E6%B5%81%E7%A8%8B/3.3-%E6%80%BB%E7%BB%93/>3.3 总结</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/3.%E6%8E%A7%E5%88%B6%E7%A8%8B%E5%BA%8F%E6%B5%81%E7%A8%8B/3.4-%E7%BB%83%E4%B9%A0/>3.4 练习</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-idc822781bc62a7bdf295c84c2a6b543bf")' href=#idc822781bc62a7bdf295c84c2a6b543bf aria-expanded=false aria-controls=idc822781bc62a7bdf295c84c2a6b543bf aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/4.%E5%88%9D%E5%A7%8B%E5%8C%96%E5%92%8C%E6%B8%85%E9%99%A4/>4.初始化和清除</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#idc822781bc62a7bdf295c84c2a6b543bf aria-expanded=false aria-controls=idc822781bc62a7bdf295c84c2a6b543bf><i class="fa-solid fa-angle-right" id=caret-idc822781bc62a7bdf295c84c2a6b543bf></i></a></div><ul class="nav docs-sidenav collapse" id=idc822781bc62a7bdf295c84c2a6b543bf><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/4.%E5%88%9D%E5%A7%8B%E5%8C%96%E5%92%8C%E6%B8%85%E9%99%A4/4.1-%E7%94%A8%E6%9E%84%E9%80%A0%E5%99%A8%E8%87%AA%E5%8A%A8%E5%88%9D%E5%A7%8B%E5%8C%96/>4.1 用构造器自动初始化</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/4.%E5%88%9D%E5%A7%8B%E5%8C%96%E5%92%8C%E6%B8%85%E9%99%A4/4.2-%E6%96%B9%E6%B3%95%E9%87%8D%E8%BD%BD/>4.2 方法重载</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/4.%E5%88%9D%E5%A7%8B%E5%8C%96%E5%92%8C%E6%B8%85%E9%99%A4/4.3-%E6%B8%85%E9%99%A4%E6%94%B6%E5%B0%BE%E5%92%8C%E5%9E%83%E5%9C%BE%E6%94%B6%E9%9B%86/>4.3 清除：收尾和垃圾收集</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/4.%E5%88%9D%E5%A7%8B%E5%8C%96%E5%92%8C%E6%B8%85%E9%99%A4/4.4-%E6%88%90%E5%91%98%E5%88%9D%E5%A7%8B%E5%8C%96/>4.4 成员初始化</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/4.%E5%88%9D%E5%A7%8B%E5%8C%96%E5%92%8C%E6%B8%85%E9%99%A4/4.5-%E6%95%B0%E7%BB%84%E5%88%9D%E5%A7%8B%E5%8C%96/>4.5 数组初始化</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/4.%E5%88%9D%E5%A7%8B%E5%8C%96%E5%92%8C%E6%B8%85%E9%99%A4/4.6-%E6%80%BB%E7%BB%93/>4.6 总结</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/4.%E5%88%9D%E5%A7%8B%E5%8C%96%E5%92%8C%E6%B8%85%E9%99%A4/4.7-%E7%BB%83%E4%B9%A0/>4.7 练习</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-id6a901d0a02c3a80d7989030080838b68")' href=#id6a901d0a02c3a80d7989030080838b68 aria-expanded=false aria-controls=id6a901d0a02c3a80d7989030080838b68 aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/5.%E9%9A%90%E8%97%8F%E5%AE%9E%E6%96%BD%E8%BF%87%E7%A8%8B/>5.隐藏实施过程</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#id6a901d0a02c3a80d7989030080838b68 aria-expanded=false aria-controls=id6a901d0a02c3a80d7989030080838b68><i class="fa-solid fa-angle-right" id=caret-id6a901d0a02c3a80d7989030080838b68></i></a></div><ul class="nav docs-sidenav collapse" id=id6a901d0a02c3a80d7989030080838b68><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/5.%E9%9A%90%E8%97%8F%E5%AE%9E%E6%96%BD%E8%BF%87%E7%A8%8B/5.1-%E5%8C%85%E5%BA%93%E5%8D%95%E5%85%83/>5.1 包：库单元</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/5.%E9%9A%90%E8%97%8F%E5%AE%9E%E6%96%BD%E8%BF%87%E7%A8%8B/5.2-java%E8%AE%BF%E9%97%AE%E6%8C%87%E7%A4%BA%E7%AC%A6/>5.2 Java访问指示符</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/5.%E9%9A%90%E8%97%8F%E5%AE%9E%E6%96%BD%E8%BF%87%E7%A8%8B/5.3-%E6%8E%A5%E5%8F%A3%E4%B8%8E%E5%AE%9E%E7%8E%B0/>5.3 接口与实现</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/5.%E9%9A%90%E8%97%8F%E5%AE%9E%E6%96%BD%E8%BF%87%E7%A8%8B/5.4-%E7%B1%BB%E8%AE%BF%E9%97%AE/>5.4 类访问</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/5.%E9%9A%90%E8%97%8F%E5%AE%9E%E6%96%BD%E8%BF%87%E7%A8%8B/5.5-%E6%80%BB%E7%BB%93/>5.5 总结</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/5.%E9%9A%90%E8%97%8F%E5%AE%9E%E6%96%BD%E8%BF%87%E7%A8%8B/5.6-%E7%BB%83%E4%B9%A0/>5.6 练习</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-id37c68b8a20d43e0232f663888d64c663")' href=#id37c68b8a20d43e0232f663888d64c663 aria-expanded=false aria-controls=id37c68b8a20d43e0232f663888d64c663 aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/6.%E7%B1%BB%E5%86%8D%E7%94%9F/>6.类再生</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#id37c68b8a20d43e0232f663888d64c663 aria-expanded=false aria-controls=id37c68b8a20d43e0232f663888d64c663><i class="fa-solid fa-angle-right" id=caret-id37c68b8a20d43e0232f663888d64c663></i></a></div><ul class="nav docs-sidenav collapse" id=id37c68b8a20d43e0232f663888d64c663><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/6.%E7%B1%BB%E5%86%8D%E7%94%9F/6.1-%E5%90%88%E6%88%90%E7%9A%84%E8%AF%AD%E6%B3%95/>6.1 合成的语法</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/6.%E7%B1%BB%E5%86%8D%E7%94%9F/6.10-%E6%80%BB%E7%BB%93/>6.10 总结</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/6.%E7%B1%BB%E5%86%8D%E7%94%9F/6.11-%E7%BB%83%E4%B9%A0/>6.11 练习</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/6.%E7%B1%BB%E5%86%8D%E7%94%9F/6.2-%E7%BB%A7%E6%89%BF%E7%9A%84%E8%AF%AD%E6%B3%95/>6.2 继承的语法</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/6.%E7%B1%BB%E5%86%8D%E7%94%9F/6.3-%E5%90%88%E6%88%90%E4%B8%8E%E7%BB%A7%E6%89%BF%E7%9A%84%E7%BB%93%E5%90%88/>6.3 合成与继承的结合</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/6.%E7%B1%BB%E5%86%8D%E7%94%9F/6.4-%E5%88%B0%E5%BA%95%E9%80%89%E6%8B%A9%E5%90%88%E6%88%90%E8%BF%98%E6%98%AF%E7%BB%A7%E6%89%BF/>6.4 到底选择合成还是继承</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/6.%E7%B1%BB%E5%86%8D%E7%94%9F/6.5-protected/>6.5 protected</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/6.%E7%B1%BB%E5%86%8D%E7%94%9F/6.6-%E7%B4%AF%E7%A7%AF%E5%BC%80%E5%8F%91/>6.6 累积开发</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/6.%E7%B1%BB%E5%86%8D%E7%94%9F/6.7-%E4%B8%8A%E6%BA%AF%E9%80%A0%E5%9E%8B/>6.7 上溯造型</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/6.%E7%B1%BB%E5%86%8D%E7%94%9F/6.8-final%E5%85%B3%E9%94%AE%E5%AD%97/>6.8 final关键字</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/6.%E7%B1%BB%E5%86%8D%E7%94%9F/6.9-%E5%88%9D%E5%A7%8B%E5%8C%96%E5%92%8C%E7%B1%BB%E8%A3%85%E8%BD%BD/>6.9 初始化和类装载</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-idf9762f8214508119b8ddca6192f53707")' href=#idf9762f8214508119b8ddca6192f53707 aria-expanded=false aria-controls=idf9762f8214508119b8ddca6192f53707 aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/7.%E5%A4%9A%E6%80%81%E6%80%A7/>7.多态性</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#idf9762f8214508119b8ddca6192f53707 aria-expanded=false aria-controls=idf9762f8214508119b8ddca6192f53707><i class="fa-solid fa-angle-right" id=caret-idf9762f8214508119b8ddca6192f53707></i></a></div><ul class="nav docs-sidenav collapse" id=idf9762f8214508119b8ddca6192f53707><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/7.%E5%A4%9A%E6%80%81%E6%80%A7/7.1-%E4%B8%8A%E6%BA%AF%E9%80%A0%E5%9E%8B/>7.1 上溯造型</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/7.%E5%A4%9A%E6%80%81%E6%80%A7/7.10-%E7%BB%83%E4%B9%A0/>7.10 练习</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/7.%E5%A4%9A%E6%80%81%E6%80%A7/7.2-%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3/>7.2 深入理解</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/7.%E5%A4%9A%E6%80%81%E6%80%A7/7.3-%E8%A6%86%E7%9B%96%E4%B8%8E%E9%87%8D%E8%BD%BD/>7.3 覆盖与重载</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/7.%E5%A4%9A%E6%80%81%E6%80%A7/7.4-%E6%8A%BD%E8%B1%A1%E7%B1%BB%E5%92%8C%E6%96%B9%E6%B3%95/>7.4 抽象类和方法</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/7.%E5%A4%9A%E6%80%81%E6%80%A7/7.5-%E6%8E%A5%E5%8F%A3/>7.5 接口</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/7.%E5%A4%9A%E6%80%81%E6%80%A7/7.6-%E5%86%85%E9%83%A8%E7%B1%BB/>7.6 内部类</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/7.%E5%A4%9A%E6%80%81%E6%80%A7/7.7-%E6%9E%84%E9%80%A0%E5%99%A8%E5%92%8C%E5%A4%9A%E6%80%81%E6%80%A7/>7.7 构造器和多态性</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/7.%E5%A4%9A%E6%80%81%E6%80%A7/7.8-%E9%80%9A%E8%BF%87%E7%BB%A7%E6%89%BF%E8%BF%9B%E8%A1%8C%E8%AE%BE%E8%AE%A1/>7.8 通过继承进行设计</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/7.%E5%A4%9A%E6%80%81%E6%80%A7/7.9-%E6%80%BB%E7%BB%93/>7.9 总结</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-id4dd1ab010bfcd5d2b91615fc5fd732df")' href=#id4dd1ab010bfcd5d2b91615fc5fd732df aria-expanded=false aria-controls=id4dd1ab010bfcd5d2b91615fc5fd732df aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/8.%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%AE%B9%E7%BA%B3/>8.对象的容纳</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#id4dd1ab010bfcd5d2b91615fc5fd732df aria-expanded=false aria-controls=id4dd1ab010bfcd5d2b91615fc5fd732df><i class="fa-solid fa-angle-right" id=caret-id4dd1ab010bfcd5d2b91615fc5fd732df></i></a></div><ul class="nav docs-sidenav collapse" id=id4dd1ab010bfcd5d2b91615fc5fd732df><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/8.%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%AE%B9%E7%BA%B3/8.1-%E6%95%B0%E7%BB%84/>8.1 数组</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/8.%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%AE%B9%E7%BA%B3/8.2-%E9%9B%86%E5%90%88/>8.2 集合</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/8.%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%AE%B9%E7%BA%B3/8.3-%E8%BF%AD%E4%BB%A3%E5%99%A8/>8.3 迭代器</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/8.%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%AE%B9%E7%BA%B3/8.4-%E9%9B%86%E5%90%88%E7%9A%84%E7%B1%BB%E5%9E%8B/>8.4 集合的类型</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/8.%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%AE%B9%E7%BA%B3/8.5-%E6%8E%92%E5%BA%8F/>8.5 排序</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/8.%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%AE%B9%E7%BA%B3/8.6-%E9%80%9A%E7%94%A8%E9%9B%86%E5%90%88%E5%BA%93/>8.6 通用集合库</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/8.%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%AE%B9%E7%BA%B3/8.7-%E6%96%B0%E9%9B%86%E5%90%88/>8.7 新集合</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/8.%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%AE%B9%E7%BA%B3/8.8-%E6%80%BB%E7%BB%93/>8.8 总结</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/8.%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%AE%B9%E7%BA%B3/8.9-%E7%BB%83%E4%B9%A0/>8.9 练习</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-id204154b179b9ea8a4e673cdd730ebfd6")' href=#id204154b179b9ea8a4e673cdd730ebfd6 aria-expanded=false aria-controls=id204154b179b9ea8a4e673cdd730ebfd6 aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/9.%E5%BC%82%E5%B8%B8%E5%B7%AE%E9%94%99%E6%8E%A7%E5%88%B6/>9.异常差错控制</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#id204154b179b9ea8a4e673cdd730ebfd6 aria-expanded=false aria-controls=id204154b179b9ea8a4e673cdd730ebfd6><i class="fa-solid fa-angle-right" id=caret-id204154b179b9ea8a4e673cdd730ebfd6></i></a></div><ul class="nav docs-sidenav collapse" id=id204154b179b9ea8a4e673cdd730ebfd6><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/9.%E5%BC%82%E5%B8%B8%E5%B7%AE%E9%94%99%E6%8E%A7%E5%88%B6/9.10-%E7%BB%83%E4%B9%A0/>9.10 练习</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/9.%E5%BC%82%E5%B8%B8%E5%B7%AE%E9%94%99%E6%8E%A7%E5%88%B6/9.6-%E7%94%A8finally%E6%B8%85%E9%99%A4/>9.6 用finally清除</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/9.%E5%BC%82%E5%B8%B8%E5%B7%AE%E9%94%99%E6%8E%A7%E5%88%B6/9.7-%E6%9E%84%E9%80%A0%E5%99%A8/>9.7 构造器</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/9.%E5%BC%82%E5%B8%B8%E5%B7%AE%E9%94%99%E6%8E%A7%E5%88%B6/9.9-%E6%80%BB%E7%BB%93/>9.9 总结</a></li></ul></div><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/%E9%99%84%E5%BD%95a-%E4%BD%BF%E7%94%A8%E9%9D%9Ejava%E4%BB%A3%E7%A0%81/>附录A 使用非JAVA代码</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/%E9%99%84%E5%BD%95b-%E5%AF%B9%E6%AF%94c++%E5%92%8Cjava/>附录B 对比C++和Java</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/%E9%99%84%E5%BD%95c-java%E7%BC%96%E7%A8%8B%E8%A7%84%E5%88%99/>附录C Java编程规则</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/%E9%99%84%E5%BD%95d-%E6%80%A7%E8%83%BD/>附录D 性能</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/%E9%99%84%E5%BD%95e-%E5%85%B3%E4%BA%8E%E5%9E%83%E5%9C%BE%E6%94%B6%E9%9B%86%E7%9A%84%E4%B8%80%E4%BA%9B%E8%AF%9D/>附录E 关于垃圾收集的一些话</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/%E9%99%84%E5%BD%95f-%E6%8E%A8%E8%8D%90%E8%AF%BB%E7%89%A9/>附录F 推荐读物</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/%E5%86%99%E5%9C%A8%E5%89%8D%E9%9D%A2%E7%9A%84%E8%AF%9D/>写在前面的话</a></li><li class="child level"><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/%E5%BC%95%E8%A8%80/>引言</a></li></ul></div></ul></div></nav></div><div class="d-none d-xl-block col-xl-2 docs-toc"><ul class="nav toc-top"><li><a href=# id=back_to_top class=docs-toc-title>目录</a></li></ul><nav id=TableOfContents><ul><li><a href=#查找类>查找类</a></li><li><a href=#控制序列化>控制序列化</a><ul><li><a href=#transient-关键字>transient 关键字</a></li><li><a href=#externalizable-的替代方法>Externalizable 的替代方法</a></li><li><a href=#版本控制>版本控制</a></li></ul></li><li><a href=#使用持久化>使用持久化</a></li><li><a href=#xml>XML</a></li></ul></nav><div class="subscribe-module col-24 mt-1"><img src=https://ngte-superbed.oss-cn-beijing.aliyuncs.com/item/20230220172727.png alt=image title=王下邀月熊的微信公众号></div></div><main class="py-md-3 pl-md-3 docs-content col-xl-8" role=main><article class=article><h1>Appendix-Object-Serialization</h1><div class=article-style><h1 id=附录对象序列化>附录:对象序列化</h1><p>当你创建对象时，只要你需要，它就会一直存在，但是在程序终止时，无论如何它都不会继续存在。尽管这么做肯定是有意义的，但是仍旧存在某些情况，如果对象能够在程序不运行的情况下仍能存在并保存其信息，那将非常有用。这样，在下次运行程序时，该对象将被重建并且拥有的信息与在程序上次运行时它所拥有的信息相同。当然，你可以通过将信息写入文件或数据库来达到相同的效果，但是在使万物都成为对象的精神中，如果能够将一个对象声明为是“持久性”的，并为我们处理掉所有细节，那将会显得十分方便。</p><p>Java 的对象序列化将那些实现了 Serializable 接口的对象转换成一个字节序列，并能够在以后将这个字节序列完全恢复为原来的对象。这一过程甚至可通过网络进行，这意味着序列化机制能自动弥补不同操作系统之间的差异。也就是说，可以在运行 Windows 系统的计算机上创建一个对象，将其序列化，通过网络将它发送给一台运行 Unix 系统的计算机，然后在那里准确地重新组装，而却不必担心数据在不同机器上的表示会不同，也不必关心宇节的顺序或者其他任何细节。</p><p>就其本身来说，对象序列化可以实现轻量级持久性（lightweight persistence），“持久性”意味着一个对象的生存周期并不取决于程序是否正在执行它可以生存于程序的调用之间。通过将一个序列化对象写入磁盘，然后在重新调用程序时恢复该对象，就能够实现持久性的效果。之所以称其为“轻量级”，是因为不能用某种"persistent"（持久）关键字来简单地定义一个对象，并让系统自动维护其他细节问题（尽管将来有可能实现）。相反，对象必须在程序中显式地序列化（serialize）和反序列化还原（deserialize），如果需要个更严格的持久性机制，可以考虑像 Hibernate 之类的工具。</p><p>对象序列化的概念加入到语言中是为了支持两种主要特性。一是 Java 的远程方法调用（Remote Method Invocation，RMI），它使存活于其他计算机上的对象使用起来就像是存活于本机上一样。当向远程对象发送消息时，需要通过对象序列化来传输参数和返回值。</p><p>再者，对 Java Beans 来说，对象的序列化也是必需的（在撰写本文时被视为失败的技术），使用一个 Bean 时，一般情况下是在设计阶段对它的状态信息进行配置。这种状态信息必须保存下来，并在程序启动时进行后期恢复，这种具体工作就是由对象序列化完成的。</p><p>只要对象实现了 Serializable 接口（该接口仅是一个标记接口，不包括任何方法），对象的序列化处理就会非常简单。当序列化的概念被加入到语言中时，许多标准库类都发生了改变，以便具备序列化特性-其中包括所有基本数据类型的封装器、所有容器类以及许多其他的东西。甚至 Class 对象也可以被序列化。</p><p>要序列化一个对象，首先要创建某些 OutputStream 对象，然后将其封装在一个 ObjectOutputStream 对象内。这时，只需调用 writeObject() 即可将对象序列化，并将其发送给 OutputStream（对象化序列是基于字节的，因要使用 InputStream 和 OutputStream 继承层次结构）。要反向进行该过程（即将一个序列还原为一个对象），需要将一个 InputStream 封装在 ObjectInputStream 内，然后调用 readObject()。和往常一样，我们最后获得的是一个引用，它指向一个向上转型的 Object，所以必须向下转型才能直接设置它们。</p><p>对象序列化特别“聪明”的一个地方是它不仅保存了对象的“全景图”，而且能追踪对象内所包含的所有引用，并保存那些对象；接着又能对对象内包含的每个这样的引用进行追踪，依此类推。这种情况有时被称为“对象网”，单个对象可与之建立连接，而且它还包含了对象的引用数组以及成员对象。如果必须保持一套自己的对象序列化机制，那么维护那些可追踪到所有链接的代码可能会显得非常麻烦。然而，由于 Java 的对象序列化似乎找不出什么缺点，所以请尽量不要自己动手，让它用优化的算法自动维护整个对象网。下面这个例子通过对链接的对象生成一个 worm（蠕虫）对序列化机制进行了测试。每个对象都与 worm 中的下一段链接，同时又与属于不同类（Data）的对象引用数组链接：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// serialization/Worm.java
</span></span></span><span class=line><span class=cl><span class=c1>// Demonstrates object serialization
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>import</span> <span class=nn>java.io.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>java.util.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kd>class</span> <span class=nc>Data</span> <span class=kd>implements</span> <span class=n>Serializable</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kt>int</span> <span class=n>n</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=n>Data</span><span class=o>(</span><span class=kt>int</span> <span class=n>n</span><span class=o>)</span> <span class=o>{</span> <span class=k>this</span><span class=o>.</span><span class=na>n</span> <span class=o>=</span> <span class=n>n</span><span class=o>;</span> <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>String</span> <span class=nf>toString</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>Integer</span><span class=o>.</span><span class=na>toString</span><span class=o>(</span><span class=n>n</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>Worm</span> <span class=kd>implements</span> <span class=n>Serializable</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kd>static</span> <span class=n>Random</span> <span class=n>rand</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Random</span><span class=o>(</span><span class=mi>47</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>Data</span><span class=o>[]</span> <span class=n>d</span> <span class=o>=</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=k>new</span> <span class=n>Data</span><span class=o>(</span><span class=n>rand</span><span class=o>.</span><span class=na>nextInt</span><span class=o>(</span><span class=mi>10</span><span class=o>)),</span>
</span></span><span class=line><span class=cl>            <span class=k>new</span> <span class=n>Data</span><span class=o>(</span><span class=n>rand</span><span class=o>.</span><span class=na>nextInt</span><span class=o>(</span><span class=mi>10</span><span class=o>)),</span>
</span></span><span class=line><span class=cl>            <span class=k>new</span> <span class=n>Data</span><span class=o>(</span><span class=n>rand</span><span class=o>.</span><span class=na>nextInt</span><span class=o>(</span><span class=mi>10</span><span class=o>))</span>
</span></span><span class=line><span class=cl>    <span class=o>};</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>Worm</span> <span class=n>next</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kt>char</span> <span class=n>c</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=c1>// Value of i == number of segments
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kd>public</span> <span class=nf>Worm</span><span class=o>(</span><span class=kt>int</span> <span class=n>i</span><span class=o>,</span> <span class=kt>char</span> <span class=n>x</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;Worm constructor: &#34;</span> <span class=o>+</span> <span class=n>i</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>c</span> <span class=o>=</span> <span class=n>x</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span><span class=o>(--</span><span class=n>i</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=o>)</span>
</span></span><span class=line><span class=cl>            <span class=n>next</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Worm</span><span class=o>(</span><span class=n>i</span><span class=o>,</span> <span class=o>(</span><span class=kt>char</span><span class=o>)(</span><span class=n>x</span> <span class=o>+</span> <span class=mi>1</span><span class=o>));</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=nf>Worm</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;No-arg constructor&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>String</span> <span class=nf>toString</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>StringBuilder</span> <span class=n>result</span> <span class=o>=</span> <span class=k>new</span> <span class=n>StringBuilder</span><span class=o>(</span><span class=s>&#34;:&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>result</span><span class=o>.</span><span class=na>append</span><span class=o>(</span><span class=n>c</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>result</span><span class=o>.</span><span class=na>append</span><span class=o>(</span><span class=s>&#34;(&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span><span class=o>(</span><span class=n>Data</span> <span class=n>dat</span> <span class=o>:</span> <span class=n>d</span><span class=o>)</span>
</span></span><span class=line><span class=cl>            <span class=n>result</span><span class=o>.</span><span class=na>append</span><span class=o>(</span><span class=n>dat</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>result</span><span class=o>.</span><span class=na>append</span><span class=o>(</span><span class=s>&#34;)&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span><span class=o>(</span><span class=n>next</span> <span class=o>!=</span> <span class=kc>null</span><span class=o>)</span>
</span></span><span class=line><span class=cl>            <span class=n>result</span><span class=o>.</span><span class=na>append</span><span class=o>(</span><span class=n>next</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>result</span><span class=o>.</span><span class=na>toString</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span>
</span></span><span class=line><span class=cl>    <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=kd>throws</span> <span class=n>ClassNotFoundException</span><span class=o>,</span>
</span></span><span class=line><span class=cl>            <span class=n>IOException</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>Worm</span> <span class=n>w</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Worm</span><span class=o>(</span><span class=mi>6</span><span class=o>,</span> <span class=sc>&#39;a&#39;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;w = &#34;</span> <span class=o>+</span> <span class=n>w</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span><span class=o>(</span>
</span></span><span class=line><span class=cl>                <span class=n>ObjectOutputStream</span> <span class=n>out</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ObjectOutputStream</span><span class=o>(</span>
</span></span><span class=line><span class=cl>                        <span class=k>new</span> <span class=n>FileOutputStream</span><span class=o>(</span><span class=s>&#34;worm.dat&#34;</span><span class=o>))</span>
</span></span><span class=line><span class=cl>        <span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=n>out</span><span class=o>.</span><span class=na>writeObject</span><span class=o>(</span><span class=s>&#34;Worm storage\n&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>            <span class=n>out</span><span class=o>.</span><span class=na>writeObject</span><span class=o>(</span><span class=n>w</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span><span class=o>(</span>
</span></span><span class=line><span class=cl>                <span class=n>ObjectInputStream</span> <span class=n>in</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ObjectInputStream</span><span class=o>(</span>
</span></span><span class=line><span class=cl>                        <span class=k>new</span> <span class=n>FileInputStream</span><span class=o>(</span><span class=s>&#34;worm.dat&#34;</span><span class=o>))</span>
</span></span><span class=line><span class=cl>        <span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=n>String</span> <span class=n>s</span> <span class=o>=</span> <span class=o>(</span><span class=n>String</span><span class=o>)</span><span class=n>in</span><span class=o>.</span><span class=na>readObject</span><span class=o>();</span>
</span></span><span class=line><span class=cl>            <span class=n>Worm</span> <span class=n>w2</span> <span class=o>=</span> <span class=o>(</span><span class=n>Worm</span><span class=o>)</span><span class=n>in</span><span class=o>.</span><span class=na>readObject</span><span class=o>();</span>
</span></span><span class=line><span class=cl>            <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>s</span> <span class=o>+</span> <span class=s>&#34;w2 = &#34;</span> <span class=o>+</span> <span class=n>w2</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span><span class=o>(</span>
</span></span><span class=line><span class=cl>                <span class=n>ByteArrayOutputStream</span> <span class=n>bout</span> <span class=o>=</span>
</span></span><span class=line><span class=cl>                        <span class=k>new</span> <span class=n>ByteArrayOutputStream</span><span class=o>();</span>
</span></span><span class=line><span class=cl>                <span class=n>ObjectOutputStream</span> <span class=n>out2</span> <span class=o>=</span>
</span></span><span class=line><span class=cl>                        <span class=k>new</span> <span class=n>ObjectOutputStream</span><span class=o>(</span><span class=n>bout</span><span class=o>)</span>
</span></span><span class=line><span class=cl>        <span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=n>out2</span><span class=o>.</span><span class=na>writeObject</span><span class=o>(</span><span class=s>&#34;Worm storage\n&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>            <span class=n>out2</span><span class=o>.</span><span class=na>writeObject</span><span class=o>(</span><span class=n>w</span><span class=o>);</span>
</span></span><span class=line><span class=cl>            <span class=n>out2</span><span class=o>.</span><span class=na>flush</span><span class=o>();</span>
</span></span><span class=line><span class=cl>            <span class=k>try</span><span class=o>(</span>
</span></span><span class=line><span class=cl>                    <span class=n>ObjectInputStream</span> <span class=n>in2</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ObjectInputStream</span><span class=o>(</span>
</span></span><span class=line><span class=cl>                            <span class=k>new</span> <span class=n>ByteArrayInputStream</span><span class=o>(</span>
</span></span><span class=line><span class=cl>                                    <span class=n>bout</span><span class=o>.</span><span class=na>toByteArray</span><span class=o>()))</span>
</span></span><span class=line><span class=cl>            <span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                <span class=n>String</span> <span class=n>s</span> <span class=o>=</span> <span class=o>(</span><span class=n>String</span><span class=o>)</span><span class=n>in2</span><span class=o>.</span><span class=na>readObject</span><span class=o>();</span>
</span></span><span class=line><span class=cl>                <span class=n>Worm</span> <span class=n>w3</span> <span class=o>=</span> <span class=o>(</span><span class=n>Worm</span><span class=o>)</span><span class=n>in2</span><span class=o>.</span><span class=na>readObject</span><span class=o>();</span>
</span></span><span class=line><span class=cl>                <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>s</span> <span class=o>+</span> <span class=s>&#34;w3 = &#34;</span> <span class=o>+</span> <span class=n>w3</span><span class=o>);</span>
</span></span><span class=line><span class=cl>            <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>输出为：</p><pre tabindex=0><code>Worm constructor: 6
Worm constructor: 5
Worm constructor: 4
Worm constructor: 3
Worm constructor: 2
Worm constructor: 1
w = :a(853):b(119):c(802):d(788):e(199):f(881)
Worm storage
w2 = :a(853):b(119):c(802):d(788):e(199):f(881)
Worm storage
w3 = :a(853):b(119):c(802):d(788):e(199):f(881)
</code></pre><p>更有趣的是，Worm 内的 Data 对象数组是用随机数初始化的（这样就不用怀疑编译器保留了某种原始信息），每个 Worm 段都用一个 char 加以标记。该 char 是在递归生成链接的 Worm 列表时自动产生的。要创建一个 Worm，必须告诉构造器你所希望的它的长度。在产生下一个引用时，要调用 Worm 构造器，并将长度减 1，以此类推。最后一个 next 引用则为 null（空），表示已到达 Worm 的尾部</p><p>以上这些操作都使得事情变得更加复杂，从而加大了对象序列化的难度。然而，真正的序列化过程却是非常简单的。一旦从另外某个流创建了 ObjectOutputstream，writeObject() 就会将对象序列化。注意也可以为一个 String 调用 writeObject() 也可以用与 DataOutputStream 相同的方法写人所有基本数据类型（它们具有同样的接口）。</p><p>有两段看起来相似的独立的代码。一个读写的是文件，而另一个读写的是字节数组（ByteArray），可利用序列化将对象读写到任何 DatalnputStream 或者 DataOutputStream。</p><p>从输出中可以看出，被还原后的对象确实包含了原对象中的所有链接。</p><p>注意在对一个 Serializable 对象进行还原的过程中，没有调用任何构造器，包括默认的构造器。整个对象都是通过从 InputStream 中取得数据恢复而来的。</p><h2 id=查找类>查找类</h2><p>你或许会奇怪，将一个对象从它的序列化状态中恢复出来，有哪些工作是必须的呢？举个例子来说，假如我们将一个对象序列化，并通过网络将其作为文件传送给另一台计算机，那么，另一台计算机上的程序可以只利用该文件内容来还原这个对象吗？</p><p>回答这个问题的最好方法就是做一个实验。下面这个文件位于本章的子目录下：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// serialization/Alien.java
</span></span></span><span class=line><span class=cl><span class=c1>// A serializable class
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>import</span> <span class=nn>java.io.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>Alien</span> <span class=kd>implements</span> <span class=n>Serializable</span> <span class=o>{}</span>
</span></span></code></pre></div><p>而用于创建和序列化一个 Alien 对象的文件也位于相同的目录下：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// serialization/FreezeAlien.java
</span></span></span><span class=line><span class=cl><span class=c1>// Create a serialized output file
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>import</span> <span class=nn>java.io.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>FreezeAlien</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=kd>throws</span> <span class=n>Exception</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span><span class=o>(</span>
</span></span><span class=line><span class=cl>                <span class=n>ObjectOutputStream</span> <span class=n>out</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ObjectOutputStream</span><span class=o>(</span>
</span></span><span class=line><span class=cl>                        <span class=k>new</span> <span class=n>FileOutputStream</span><span class=o>(</span><span class=s>&#34;X.file&#34;</span><span class=o>));</span>
</span></span><span class=line><span class=cl>        <span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=n>Alien</span> <span class=n>quellek</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Alien</span><span class=o>();</span>
</span></span><span class=line><span class=cl>            <span class=n>out</span><span class=o>.</span><span class=na>writeObject</span><span class=o>(</span><span class=n>quellek</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>一旦该程序被编译和运行，它就会在 c12 目录下产生一个名为 X.file 的文件。以下代码位于一个名为 xiles 的子目录下：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// serialization/xfiles/ThawAlien.java
</span></span></span><span class=line><span class=cl><span class=c1>// Recover a serialized file
</span></span></span><span class=line><span class=cl><span class=c1>// {java serialization.xfiles.ThawAlien}
</span></span></span><span class=line><span class=cl><span class=c1>// {RunFirst: FreezeAlien}
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>package</span> <span class=nn>serialization.xfiles</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>java.io.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>ThawAlien</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=kd>throws</span> <span class=n>Exception</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>ObjectInputStream</span> <span class=n>in</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ObjectInputStream</span><span class=o>(</span>
</span></span><span class=line><span class=cl>                <span class=k>new</span> <span class=n>FileInputStream</span><span class=o>(</span><span class=k>new</span> <span class=n>File</span><span class=o>(</span><span class=s>&#34;X.file&#34;</span><span class=o>)));</span>
</span></span><span class=line><span class=cl>        <span class=n>Object</span> <span class=n>mystery</span> <span class=o>=</span> <span class=n>in</span><span class=o>.</span><span class=na>readObject</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>mystery</span><span class=o>.</span><span class=na>getClass</span><span class=o>());</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>输出为：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>class</span> <span class=nc>Alien</span>
</span></span></code></pre></div><p>为了正常运行，必须保证 Java 虚拟机能找到相关的.class 文件。</p><h2 id=控制序列化>控制序列化</h2><p>正如大家所看到的，默认的序列化机制并不难操纵。然而，如果有特殊的需要那又该怎么办呢？例如，也许要考虑特殊的安全问题，而且你不希望对象的某一部分被序列化；或者一个对象被还原以后，某子对象需要重新创建，从而不必将该子对象序列化。</p><p>在这些特殊情况下，可通过实现 Externalizable 接口——代替实现 Serializable 接口-来对序列化过程进行控制。这个 Externalizable 接口继承了 Serializable 接口，同时增添了两个方法：writeExternal() 和 readExternal()。这两个方法会在序列化和反序列化还原的过程中被自动调用，以便执行一些特殊操作。</p><p>下面这个例子展示了 Externalizable 接口方法的简单实现。注意 Blip1 和 Blip2 除了细微的差别之外，几乎完全一致（研究一下代码，看看你能否发现）：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// serialization/Blips.java
</span></span></span><span class=line><span class=cl><span class=c1>// Simple use of Externalizable &amp; a pitfall
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>import</span> <span class=nn>java.io.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kd>class</span> <span class=nc>Blip1</span> <span class=kd>implements</span> <span class=n>Externalizable</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=nf>Blip1</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;Blip1 Constructor&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>void</span> <span class=nf>writeExternal</span><span class=o>(</span><span class=n>ObjectOutput</span> <span class=n>out</span><span class=o>)</span>
</span></span><span class=line><span class=cl>            <span class=kd>throws</span> <span class=n>IOException</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;Blip1.writeExternal&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>void</span> <span class=nf>readExternal</span><span class=o>(</span><span class=n>ObjectInput</span> <span class=n>in</span><span class=o>)</span>
</span></span><span class=line><span class=cl>            <span class=kd>throws</span> <span class=n>IOException</span><span class=o>,</span> <span class=n>ClassNotFoundException</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;Blip1.readExternal&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=kd>class</span> <span class=nc>Blip2</span> <span class=kd>implements</span> <span class=n>Externalizable</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>Blip2</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;Blip2 Constructor&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>void</span> <span class=nf>writeExternal</span><span class=o>(</span><span class=n>ObjectOutput</span> <span class=n>out</span><span class=o>)</span>
</span></span><span class=line><span class=cl>            <span class=kd>throws</span> <span class=n>IOException</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;Blip2.writeExternal&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>void</span> <span class=nf>readExternal</span><span class=o>(</span><span class=n>ObjectInput</span> <span class=n>in</span><span class=o>)</span>
</span></span><span class=line><span class=cl>            <span class=kd>throws</span> <span class=n>IOException</span><span class=o>,</span> <span class=n>ClassNotFoundException</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;Blip2.readExternal&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>Blips</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;Constructing objects:&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>Blip1</span> <span class=n>b1</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Blip1</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=n>Blip2</span> <span class=n>b2</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Blip2</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span><span class=o>(</span>
</span></span><span class=line><span class=cl>                <span class=n>ObjectOutputStream</span> <span class=n>o</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ObjectOutputStream</span><span class=o>(</span>
</span></span><span class=line><span class=cl>                        <span class=k>new</span> <span class=n>FileOutputStream</span><span class=o>(</span><span class=s>&#34;Blips.serialized&#34;</span><span class=o>))</span>
</span></span><span class=line><span class=cl>        <span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;Saving objects:&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>            <span class=n>o</span><span class=o>.</span><span class=na>writeObject</span><span class=o>(</span><span class=n>b1</span><span class=o>);</span>
</span></span><span class=line><span class=cl>            <span class=n>o</span><span class=o>.</span><span class=na>writeObject</span><span class=o>(</span><span class=n>b2</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span> <span class=k>catch</span><span class=o>(</span><span class=n>IOException</span> <span class=n>e</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=k>throw</span> <span class=k>new</span> <span class=n>RuntimeException</span><span class=o>(</span><span class=n>e</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=c1>// Now get them back:
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;Recovering b1:&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span><span class=o>(</span>
</span></span><span class=line><span class=cl>                <span class=n>ObjectInputStream</span> <span class=n>in</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ObjectInputStream</span><span class=o>(</span>
</span></span><span class=line><span class=cl>                        <span class=k>new</span> <span class=n>FileInputStream</span><span class=o>(</span><span class=s>&#34;Blips.serialized&#34;</span><span class=o>))</span>
</span></span><span class=line><span class=cl>        <span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=n>b1</span> <span class=o>=</span> <span class=o>(</span><span class=n>Blip1</span><span class=o>)</span><span class=n>in</span><span class=o>.</span><span class=na>readObject</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span> <span class=k>catch</span><span class=o>(</span><span class=n>IOException</span> <span class=o>|</span> <span class=n>ClassNotFoundException</span> <span class=n>e</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=k>throw</span> <span class=k>new</span> <span class=n>RuntimeException</span><span class=o>(</span><span class=n>e</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=c1>// OOPS! Throws an exception:
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=c1>//- System.out.println(&#34;Recovering b2:&#34;);
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=c1>//- b2 = (Blip2)in.readObject();
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>输出为：</p><pre tabindex=0><code>Constructing objects:
Blip1 Constructor
Blip2 Constructor
Saving objects:
Blip1.writeExternal
Blip2.writeExternal
Recovering b1:
Blip1 Constructor
Blip1.readExternal
</code></pre><p>没有恢复 Blip2 对象的原因是那样做会导致一个异常。你找出 Blip1 和 Blip2 之间的区别了吗？Blipl 的构造器是“公共的”（public），Blip2 的构造器却不是，这样就会在恢复时造成异常。试试将 Blip2 的构造器变成 public 的，然后删除//注释标记，看看是否能得到正确的结果。</p><p>恢复 b1 后，会调用 Blip1 默认构造器。这与恢复一个 Serializable 对象不同。对于 Serializable 对象，对象完全以它存储的二进制位为基础来构造，而不调用构造器。而对于一个 Externalizable 对象，所有普通的默认构造器都会被调用（包括在字段定义时的初始化），然后调用 readExternal() 必须注意这一点&ndash;所有默认的构造器都会被调用，才能使 Externalizable 对象产生正确的行为。</p><p>下面这个例子示范了如何完整保存和恢复一个 Externalizable 对象：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// serialization/Blip3.java
</span></span></span><span class=line><span class=cl><span class=c1>// Reconstructing an externalizable object
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>import</span> <span class=nn>java.io.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>Blip3</span> <span class=kd>implements</span> <span class=n>Externalizable</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kt>int</span> <span class=n>i</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>String</span> <span class=n>s</span><span class=o>;</span> <span class=c1>// No initialization
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kd>public</span> <span class=nf>Blip3</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;Blip3 Constructor&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=c1>// s, i not initialized
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=nf>Blip3</span><span class=o>(</span><span class=n>String</span> <span class=n>x</span><span class=o>,</span> <span class=kt>int</span> <span class=n>a</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;Blip3(String x, int a)&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>s</span> <span class=o>=</span> <span class=n>x</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=n>i</span> <span class=o>=</span> <span class=n>a</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=c1>// s &amp; i initialized only in non-no-arg constructor.
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>String</span> <span class=nf>toString</span><span class=o>()</span> <span class=o>{</span> <span class=k>return</span> <span class=n>s</span> <span class=o>+</span> <span class=n>i</span><span class=o>;</span> <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>void</span> <span class=nf>writeExternal</span><span class=o>(</span><span class=n>ObjectOutput</span> <span class=n>out</span><span class=o>)</span>
</span></span><span class=line><span class=cl>            <span class=kd>throws</span> <span class=n>IOException</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;Blip3.writeExternal&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=c1>// You must do this:
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>out</span><span class=o>.</span><span class=na>writeObject</span><span class=o>(</span><span class=n>s</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>out</span><span class=o>.</span><span class=na>writeInt</span><span class=o>(</span><span class=n>i</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>void</span> <span class=nf>readExternal</span><span class=o>(</span><span class=n>ObjectInput</span> <span class=n>in</span><span class=o>)</span>
</span></span><span class=line><span class=cl>            <span class=kd>throws</span> <span class=n>IOException</span><span class=o>,</span> <span class=n>ClassNotFoundException</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;Blip3.readExternal&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=c1>// You must do this:
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>s</span> <span class=o>=</span> <span class=o>(</span><span class=n>String</span><span class=o>)</span><span class=n>in</span><span class=o>.</span><span class=na>readObject</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=n>i</span> <span class=o>=</span> <span class=n>in</span><span class=o>.</span><span class=na>readInt</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;Constructing objects:&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>Blip3</span> <span class=n>b3</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Blip3</span><span class=o>(</span><span class=s>&#34;A String &#34;</span><span class=o>,</span> <span class=mi>47</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>b3</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span><span class=o>(</span>
</span></span><span class=line><span class=cl>                <span class=n>ObjectOutputStream</span> <span class=n>o</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ObjectOutputStream</span><span class=o>(</span>
</span></span><span class=line><span class=cl>                        <span class=k>new</span> <span class=n>FileOutputStream</span><span class=o>(</span><span class=s>&#34;Blip3.serialized&#34;</span><span class=o>))</span>
</span></span><span class=line><span class=cl>        <span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;Saving object:&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>            <span class=n>o</span><span class=o>.</span><span class=na>writeObject</span><span class=o>(</span><span class=n>b3</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span> <span class=k>catch</span><span class=o>(</span><span class=n>IOException</span> <span class=n>e</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=k>throw</span> <span class=k>new</span> <span class=n>RuntimeException</span><span class=o>(</span><span class=n>e</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=c1>// Now get it back:
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;Recovering b3:&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span><span class=o>(</span>
</span></span><span class=line><span class=cl>                <span class=n>ObjectInputStream</span> <span class=n>in</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ObjectInputStream</span><span class=o>(</span>
</span></span><span class=line><span class=cl>                        <span class=k>new</span> <span class=n>FileInputStream</span><span class=o>(</span><span class=s>&#34;Blip3.serialized&#34;</span><span class=o>))</span>
</span></span><span class=line><span class=cl>        <span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=n>b3</span> <span class=o>=</span> <span class=o>(</span><span class=n>Blip3</span><span class=o>)</span><span class=n>in</span><span class=o>.</span><span class=na>readObject</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span> <span class=k>catch</span><span class=o>(</span><span class=n>IOException</span> <span class=o>|</span> <span class=n>ClassNotFoundException</span> <span class=n>e</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=k>throw</span> <span class=k>new</span> <span class=n>RuntimeException</span><span class=o>(</span><span class=n>e</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>b3</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>输出为：</p><pre tabindex=0><code>Constructing objects:
Blip3(String x, int a)
A String 47
Saving object:
Blip3.writeExternal
Recovering b3:
Blip3 Constructor
Blip3.readExternal
A String 47
</code></pre><p>其中，字段 s 和 i 只在第二个构造器中初始化，而不是在默认的构造器中初始化。这意味着假如不在 readExternal() 中初始化 s 和 i，s 就会为 null，而 i 就会为零（因为在创建对象的第一步中将对象的存储空间清理为 0）。如果注释掉跟随于"You must do this”后面的两行代码，然后运行程序，就会发现当对象被还原后，s 是 null，而 i 是零。</p><p>我们如果从一个 Externalizable 对象继承，通常需要调用基类版本的 writeExternal() 和 readExternal() 来为基类组件提供恰当的存储和恢复功能。</p><p>因此，为了正常运行，我们不仅需要在 writeExternal() 方法（没有任何默认行为来为 Externalizable 对象写入任何成员对象）中将来自对象的重要信息写入，还必须在 readExternal() 方法中恢复数据。起先，可能会有一点迷惑，因为 Externalizable 对象的默认构造行为使其看起来似乎像某种自动发生的存储与恢复操作。但实际上并非如此。</p><h3 id=transient-关键字>transient 关键字</h3><p>当我们对序列化进行控制时，可能某个特定子对象不想让 Java 的序列化机制自动保存与恢复。如果子对象表示的是我们不希望将其序列化的敏感信息（如密码），通常就会面临这种情况。即使对象中的这些信息是 private（私有）属性，一经序列化处理，人们就可以通过读取文件或者拦截网络传输的方式来访问到它。</p><p>有一种办法可防止对象的敏感部分被序列化，就是将类实现为 Externalizable，如前面所示。这样一来，没有任何东西可以自动序列化，并且可以在 writeExternal() 内部只对所需部分进行显式的序列化。</p><p>然而，如果我们正在操作的是一个 Seralizable 对象，那么所有序列化操作都会自动进行。为了能够予以控制，可以用 transient（瞬时）关键字逐个字段地关闭序列化，它的意思是“不用麻烦你保存或恢复数据——我自己会处理的"。</p><p>例如，假设某个 Logon 对象保存某个特定的登录会话信息，登录的合法性通过校验之后，我们想把数据保存下来，但不包括密码。为做到这一点，最简单的办法是实现 Serializable，并将 password 字段标志为 transient，下面是具体的代码：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// serialization/Logon.java
</span></span></span><span class=line><span class=cl><span class=c1>// Demonstrates the &#34;transient&#34; keyword
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>import</span> <span class=nn>java.util.concurrent.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>java.io.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>java.util.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>onjava.Nap</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>Logon</span> <span class=kd>implements</span> <span class=n>Serializable</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>Date</span> <span class=n>date</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Date</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>String</span> <span class=n>username</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kd>transient</span> <span class=n>String</span> <span class=n>password</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=nf>Logon</span><span class=o>(</span><span class=n>String</span> <span class=n>name</span><span class=o>,</span> <span class=n>String</span> <span class=n>pwd</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>username</span> <span class=o>=</span> <span class=n>name</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=n>password</span> <span class=o>=</span> <span class=n>pwd</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>String</span> <span class=nf>toString</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=s>&#34;logon info: \n username: &#34;</span> <span class=o>+</span>
</span></span><span class=line><span class=cl>                <span class=n>username</span> <span class=o>+</span> <span class=s>&#34;\n date: &#34;</span> <span class=o>+</span> <span class=n>date</span> <span class=o>+</span>
</span></span><span class=line><span class=cl>                <span class=s>&#34;\n password: &#34;</span> <span class=o>+</span> <span class=n>password</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>Logon</span> <span class=n>a</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Logon</span><span class=o>(</span><span class=s>&#34;Hulk&#34;</span><span class=o>,</span> <span class=s>&#34;myLittlePony&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;logon a = &#34;</span> <span class=o>+</span> <span class=n>a</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span><span class=o>(</span>
</span></span><span class=line><span class=cl>                <span class=n>ObjectOutputStream</span> <span class=n>o</span> <span class=o>=</span>
</span></span><span class=line><span class=cl>                        <span class=k>new</span> <span class=n>ObjectOutputStream</span><span class=o>(</span>
</span></span><span class=line><span class=cl>                                <span class=k>new</span> <span class=n>FileOutputStream</span><span class=o>(</span><span class=s>&#34;Logon.dat&#34;</span><span class=o>))</span>
</span></span><span class=line><span class=cl>        <span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=n>o</span><span class=o>.</span><span class=na>writeObject</span><span class=o>(</span><span class=n>a</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span> <span class=k>catch</span><span class=o>(</span><span class=n>IOException</span> <span class=n>e</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=k>throw</span> <span class=k>new</span> <span class=n>RuntimeException</span><span class=o>(</span><span class=n>e</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=k>new</span> <span class=n>Nap</span><span class=o>(</span><span class=mi>1</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=c1>// Now get them back:
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>try</span><span class=o>(</span>
</span></span><span class=line><span class=cl>                <span class=n>ObjectInputStream</span> <span class=n>in</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ObjectInputStream</span><span class=o>(</span>
</span></span><span class=line><span class=cl>                        <span class=k>new</span> <span class=n>FileInputStream</span><span class=o>(</span><span class=s>&#34;Logon.dat&#34;</span><span class=o>))</span>
</span></span><span class=line><span class=cl>        <span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span>
</span></span><span class=line><span class=cl>                    <span class=s>&#34;Recovering object at &#34;</span> <span class=o>+</span> <span class=k>new</span> <span class=n>Date</span><span class=o>());</span>
</span></span><span class=line><span class=cl>            <span class=n>a</span> <span class=o>=</span> <span class=o>(</span><span class=n>Logon</span><span class=o>)</span><span class=n>in</span><span class=o>.</span><span class=na>readObject</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span> <span class=k>catch</span><span class=o>(</span><span class=n>IOException</span> <span class=o>|</span> <span class=n>ClassNotFoundException</span> <span class=n>e</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=k>throw</span> <span class=k>new</span> <span class=n>RuntimeException</span><span class=o>(</span><span class=n>e</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;logon a = &#34;</span> <span class=o>+</span> <span class=n>a</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>输出为：</p><pre tabindex=0><code>logon a = logon info:
username: Hulk
date: Tue May 09 06:07:47 MDT 2017
password: myLittlePony
Recovering object at Tue May 09 06:07:49 MDT 2017
logon a = logon info:
username: Hulk
date: Tue May 09 06:07:47 MDT 2017
password: null
</code></pre><p>可以看到，其中的 date 和 username 是一般的（不是 transient 的），所以它们会被自动序列化。而 password 是 transient 的，所以不会被自动保存到磁盘；另外，自动序列化机制也不会尝试去恢复它。当对象被恢复时，password 就会变成 null。注意，虽然 toString() 是用重载后的+运算符来连接 String 对象，但是 null 引用会被自动转换成字符串 null。</p><p>我们还可以发现：date 字段被存储了到磁盘并从磁盘上被恢复了出来，而且没有再重新生成。由于 Externalizable 对象在默认情况下不保存它们的任何字段，所以 transient 关键字只能和 Serializable 对象一起使用。</p><h3 id=externalizable-的替代方法>Externalizable 的替代方法</h3><p>如果不是特别坚持实现 Externalizable 接口，那么还有另一种方法。我们可以实现 Serializable 接口，并添加（注意我说的是“添加”，而非“覆盖”或者“实现”）名为 writeObject() 和 readObject() 的方法。这样一旦对象被序列化或者被反序列化还原，就会自动地分别调用这两个方法。也就是说，只要我们提供了这两个方法，就会使用它们而不是默认的序列化机制。</p><p>这些方法必须具有准确的方法特征签名：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>private</span> <span class=kt>void</span> <span class=nf>writeObject</span><span class=o>(</span><span class=n>ObjectOutputStream</span> <span class=n>stream</span><span class=o>)</span> <span class=kd>throws</span> <span class=n>IOException</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>private</span> <span class=kt>void</span> <span class=nf>readObject</span><span class=o>(</span><span class=n>ObjectInputStream</span> <span class=n>stream</span><span class=o>)</span> <span class=kd>throws</span> <span class=n>IOException</span><span class=o>,</span> <span class=n>ClassNotFoundException</span>
</span></span></code></pre></div><p>从设计的观点来看，现在事情变得真是不可思议。首先，我们可能会认为由于这些方法不是基类或者 Serializable 接口的一部分，所以应该在它们自己的接口中进行定义。但是注意它们被定义成了 private，这意味着它们仅能被这个类的其他成员调用。然而，实际上我们并没有从这个类的其他方法中调用它们，而是 ObjectOutputStream 和 ObjectInputStream 对象的 writeObject() 和 readobject() 方法调用你的对象的 writeObject() 和 readObject() 方法（注意关于这里用到的相同方法名，我尽量抑制住不去谩骂。一句话：混乱）。读者可能想知道 ObjectOutputStream 和 ObjectInputStream 对象是怎样访问你的类中的 private 方法的。我们只能假设这正是序列化神奇的一部分。</p><p>在接口中定义的所有东西都自动是 public 的，因此如果 writeObject() 和 readObject() 必须是 private 的，那么它们不会是接口的一部分。因为我们必须要完全遵循其方法特征签名，所以其效果就和实现了接口一样。</p><p>在调用 ObjectOutputStream.writeObject() 时，会检查所传递的 Serializable 对象，看看是否实现了它自己的 writeObject()。如果是这样，就跳过正常的序列化过程并调用它的 writeObiect()。readObject() 的情形与此相同。</p><p>还有另外一个技巧。在你的 writeObject() 内部，可以调用 defaultWriteObject() 来选择执行默认的 writeObject()。类似地，在 readObject() 内部，我们可以调用 defaultReadObject()，下面这个简单的例子演示了如何对一个 Serializable 对象的存储与恢复进行控制：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// serialization/SerialCtl.java
</span></span></span><span class=line><span class=cl><span class=c1>// Controlling serialization by adding your own
</span></span></span><span class=line><span class=cl><span class=c1>// writeObject() and readObject() methods
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>import</span> <span class=nn>java.io.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>SerialCtl</span> <span class=kd>implements</span> <span class=n>Serializable</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>String</span> <span class=n>a</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kd>transient</span> <span class=n>String</span> <span class=n>b</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=nf>SerialCtl</span><span class=o>(</span><span class=n>String</span> <span class=n>aa</span><span class=o>,</span> <span class=n>String</span> <span class=n>bb</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>a</span> <span class=o>=</span> <span class=s>&#34;Not Transient: &#34;</span> <span class=o>+</span> <span class=n>aa</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=n>b</span> <span class=o>=</span> <span class=s>&#34;Transient: &#34;</span> <span class=o>+</span> <span class=n>bb</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>String</span> <span class=nf>toString</span><span class=o>()</span> <span class=o>{</span> <span class=k>return</span> <span class=n>a</span> <span class=o>+</span> <span class=s>&#34;\n&#34;</span> <span class=o>+</span> <span class=n>b</span><span class=o>;</span> <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kt>void</span> <span class=nf>writeObject</span><span class=o>(</span><span class=n>ObjectOutputStream</span> <span class=n>stream</span><span class=o>)</span>
</span></span><span class=line><span class=cl>            <span class=kd>throws</span> <span class=n>IOException</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>stream</span><span class=o>.</span><span class=na>defaultWriteObject</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=n>stream</span><span class=o>.</span><span class=na>writeObject</span><span class=o>(</span><span class=n>b</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kt>void</span> <span class=nf>readObject</span><span class=o>(</span><span class=n>ObjectInputStream</span> <span class=n>stream</span><span class=o>)</span>
</span></span><span class=line><span class=cl>            <span class=kd>throws</span> <span class=n>IOException</span><span class=o>,</span> <span class=n>ClassNotFoundException</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>stream</span><span class=o>.</span><span class=na>defaultReadObject</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=n>b</span> <span class=o>=</span> <span class=o>(</span><span class=n>String</span><span class=o>)</span><span class=n>stream</span><span class=o>.</span><span class=na>readObject</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>SerialCtl</span> <span class=n>sc</span> <span class=o>=</span> <span class=k>new</span> <span class=n>SerialCtl</span><span class=o>(</span><span class=s>&#34;Test1&#34;</span><span class=o>,</span> <span class=s>&#34;Test2&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;Before:\n&#34;</span> <span class=o>+</span> <span class=n>sc</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span> <span class=o>(</span>
</span></span><span class=line><span class=cl>                <span class=n>ByteArrayOutputStream</span> <span class=n>buf</span> <span class=o>=</span>
</span></span><span class=line><span class=cl>                        <span class=k>new</span> <span class=n>ByteArrayOutputStream</span><span class=o>();</span>
</span></span><span class=line><span class=cl>                <span class=n>ObjectOutputStream</span> <span class=n>o</span> <span class=o>=</span>
</span></span><span class=line><span class=cl>                        <span class=k>new</span> <span class=n>ObjectOutputStream</span><span class=o>(</span><span class=n>buf</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=n>o</span><span class=o>.</span><span class=na>writeObject</span><span class=o>(</span><span class=n>sc</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=c1>// Now get it back:
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=k>try</span> <span class=o>(</span>
</span></span><span class=line><span class=cl>                    <span class=n>ObjectInputStream</span> <span class=n>in</span> <span class=o>=</span>
</span></span><span class=line><span class=cl>                            <span class=k>new</span> <span class=n>ObjectInputStream</span><span class=o>(</span>
</span></span><span class=line><span class=cl>                                    <span class=k>new</span> <span class=n>ByteArrayInputStream</span><span class=o>(</span>
</span></span><span class=line><span class=cl>                                            <span class=n>buf</span><span class=o>.</span><span class=na>toByteArray</span><span class=o>()));</span>
</span></span><span class=line><span class=cl>            <span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                <span class=n>SerialCtl</span> <span class=n>sc2</span> <span class=o>=</span> <span class=o>(</span><span class=n>SerialCtl</span><span class=o>)</span><span class=n>in</span><span class=o>.</span><span class=na>readObject</span><span class=o>();</span>
</span></span><span class=line><span class=cl>                <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;After:\n&#34;</span> <span class=o>+</span> <span class=n>sc2</span><span class=o>);</span>
</span></span><span class=line><span class=cl>            <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span> <span class=k>catch</span><span class=o>(</span><span class=n>IOException</span> <span class=o>|</span> <span class=n>ClassNotFoundException</span> <span class=n>e</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=k>throw</span> <span class=k>new</span> <span class=n>RuntimeException</span><span class=o>(</span><span class=n>e</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>输出为：</p><pre tabindex=0><code>Before:
Not Transient: Test1
Transient: Test2
After:
Not Transient: Test1
Transient: Test2
</code></pre><p>在这个例子中，有一个 String 字段是普通字段，而另一个是 transient 字段，用来证明非 transient 字段由 defaultWriteObject() 方法保存，而 transient 字段必须在程序中明确保存和恢复。字段是在构造器内部而不是在定义处进行初始化的，以此可以证实它们在反序列化还原期间没有被一些自动化机制初始化。</p><p>如果我们打算使用默认机制写入对象的非 transient 部分，那么必须调用 defaultwriteObject() 作为 writeObject() 中的第一个操作，并让 defaultReadObject() 作为 readObject() 中的第一个操作。这些都是奇怪的方法调用。例如，如果我们正在为 ObjectOutputStream 调用 defaultWriteObject() 且没有传递任何参数，然而不知何故它却可以运行，并且知道对象的引用以及如何写入非 transient 部分。真是奇怪之极。</p><p>对 transient 对象的存储和恢复使用了我们比较熟悉的代码。请再考虑一下在这里所发生的事情。在 main0）中，创建 SerialCtl 对象，然后将其序列化到 ObjectOutputStream（注意在这种情况下，使用的是缓冲区而不是文件-这对于 ObjectOutputStream 来说是完全一样的）。序列化发生在下面这行代码当中</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>o</span><span class=o>.</span><span class=na>writeObject</span><span class=o>(</span><span class=n>sc</span><span class=o>);</span>
</span></span></code></pre></div><p>writeObject() 方法必须检查 sc，判断它是否拥有自己的 writeObject() 方法（不是检查接口——这里根本就没有接口，也不是检查类的类型，而是利用反射来真正地搜索方法）。如果有，那么就会使用它。对 readObject() 也采用了类似的方法。或许这是解决这个问题的唯一切实可行的方法，但它确实有点古怪。</p><h3 id=版本控制>版本控制</h3><p>有时可能想要改变可序列化类的版本（比如源类的对象可能保存在数据库中）。虽然 Java 支持这种做法，但是你可能只在特殊的情况下才这样做，此外，还需要对它有相当深程度的了解（在这里我们就不再试图达到这一点）。从 <a href=http://java.oracle.com target=_blank rel=noopener>http://java.oracle.com</a> 下的 JDK 文档中对这一主题进行了非常彻底的论述。</p><h2 id=使用持久化>使用持久化</h2><p>一个比较诱人的使用序列化技术的想法是：存储程序的一些状态，以便我们随后可以很容易地将程序恢复到当前状态。但是在我们能够这样做之前，必须回答几个问题。如果我们将两个对象-它们都具有指向第三个对象的引用-进行序列化，会发生什么情况？当我们从它们的序列化状态恢复这两个对象时，第三个对象会只出现一次吗？如果将这两个对象序列化成独立的文件，然后在代码的不同部分对它们进行反序列化还原，又会怎样呢？</p><p>下面这个例子说明了上述问题：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// serialization/MyWorld.java
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>import</span> <span class=nn>java.io.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>java.util.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kd>class</span> <span class=nc>House</span> <span class=kd>implements</span> <span class=n>Serializable</span> <span class=o>{}</span>
</span></span><span class=line><span class=cl><span class=kd>class</span> <span class=nc>Animal</span> <span class=kd>implements</span> <span class=n>Serializable</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>String</span> <span class=n>name</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>House</span> <span class=n>preferredHouse</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=n>Animal</span><span class=o>(</span><span class=n>String</span> <span class=n>nm</span><span class=o>,</span> <span class=n>House</span> <span class=n>h</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>name</span> <span class=o>=</span> <span class=n>nm</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=n>preferredHouse</span> <span class=o>=</span> <span class=n>h</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>String</span> <span class=nf>toString</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>name</span> <span class=o>+</span> <span class=s>&#34;[&#34;</span> <span class=o>+</span> <span class=kd>super</span><span class=o>.</span><span class=na>toString</span><span class=o>()</span> <span class=o>+</span>
</span></span><span class=line><span class=cl>                <span class=s>&#34;], &#34;</span> <span class=o>+</span> <span class=n>preferredHouse</span> <span class=o>+</span> <span class=s>&#34;\n&#34;</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>MyWorld</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>House</span> <span class=n>house</span> <span class=o>=</span> <span class=k>new</span> <span class=n>House</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=n>List</span><span class=o>&lt;</span><span class=n>Animal</span><span class=o>&gt;</span> <span class=n>animals</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ArrayList</span><span class=o>&lt;&gt;();</span>
</span></span><span class=line><span class=cl>        <span class=n>animals</span><span class=o>.</span><span class=na>add</span><span class=o>(</span>
</span></span><span class=line><span class=cl>                <span class=k>new</span> <span class=n>Animal</span><span class=o>(</span><span class=s>&#34;Bosco the dog&#34;</span><span class=o>,</span> <span class=n>house</span><span class=o>));</span>
</span></span><span class=line><span class=cl>        <span class=n>animals</span><span class=o>.</span><span class=na>add</span><span class=o>(</span>
</span></span><span class=line><span class=cl>                <span class=k>new</span> <span class=n>Animal</span><span class=o>(</span><span class=s>&#34;Ralph the hamster&#34;</span><span class=o>,</span> <span class=n>house</span><span class=o>));</span>
</span></span><span class=line><span class=cl>        <span class=n>animals</span><span class=o>.</span><span class=na>add</span><span class=o>(</span>
</span></span><span class=line><span class=cl>                <span class=k>new</span> <span class=n>Animal</span><span class=o>(</span><span class=s>&#34;Molly the cat&#34;</span><span class=o>,</span> <span class=n>house</span><span class=o>));</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;animals: &#34;</span> <span class=o>+</span> <span class=n>animals</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span><span class=o>(</span>
</span></span><span class=line><span class=cl>                <span class=n>ByteArrayOutputStream</span> <span class=n>buf1</span> <span class=o>=</span>
</span></span><span class=line><span class=cl>                        <span class=k>new</span> <span class=n>ByteArrayOutputStream</span><span class=o>();</span>
</span></span><span class=line><span class=cl>                <span class=n>ObjectOutputStream</span> <span class=n>o1</span> <span class=o>=</span>
</span></span><span class=line><span class=cl>                        <span class=k>new</span> <span class=n>ObjectOutputStream</span><span class=o>(</span><span class=n>buf1</span><span class=o>)</span>
</span></span><span class=line><span class=cl>        <span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=n>o1</span><span class=o>.</span><span class=na>writeObject</span><span class=o>(</span><span class=n>animals</span><span class=o>);</span>
</span></span><span class=line><span class=cl>            <span class=n>o1</span><span class=o>.</span><span class=na>writeObject</span><span class=o>(</span><span class=n>animals</span><span class=o>);</span> <span class=c1>// Write a 2nd set
</span></span></span><span class=line><span class=cl><span class=c1>// Write to a different stream:
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=k>try</span><span class=o>(</span>
</span></span><span class=line><span class=cl>                    <span class=n>ByteArrayOutputStream</span> <span class=n>buf2</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ByteArrayOutputStream</span><span class=o>();</span>
</span></span><span class=line><span class=cl>                    <span class=n>ObjectOutputStream</span> <span class=n>o2</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ObjectOutputStream</span><span class=o>(</span><span class=n>buf2</span><span class=o>)</span>
</span></span><span class=line><span class=cl>            <span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                <span class=n>o2</span><span class=o>.</span><span class=na>writeObject</span><span class=o>(</span><span class=n>animals</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=c1>// Now get them back:
</span></span></span><span class=line><span class=cl><span class=c1></span>                <span class=k>try</span><span class=o>(</span>
</span></span><span class=line><span class=cl>                        <span class=n>ObjectInputStream</span> <span class=n>in1</span> <span class=o>=</span>
</span></span><span class=line><span class=cl>                                <span class=k>new</span> <span class=n>ObjectInputStream</span><span class=o>(</span>
</span></span><span class=line><span class=cl>                                        <span class=k>new</span> <span class=n>ByteArrayInputStream</span><span class=o>(</span>
</span></span><span class=line><span class=cl>                                                <span class=n>buf1</span><span class=o>.</span><span class=na>toByteArray</span><span class=o>()));</span>
</span></span><span class=line><span class=cl>                        <span class=n>ObjectInputStream</span> <span class=n>in2</span> <span class=o>=</span>
</span></span><span class=line><span class=cl>                                <span class=k>new</span> <span class=n>ObjectInputStream</span><span class=o>(</span>
</span></span><span class=line><span class=cl>                                        <span class=k>new</span> <span class=n>ByteArrayInputStream</span><span class=o>(</span>
</span></span><span class=line><span class=cl>                                                <span class=n>buf2</span><span class=o>.</span><span class=na>toByteArray</span><span class=o>()))</span>
</span></span><span class=line><span class=cl>                <span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                    <span class=n>List</span>
</span></span><span class=line><span class=cl>                            <span class=n>animals1</span> <span class=o>=</span> <span class=o>(</span><span class=n>List</span><span class=o>)</span><span class=n>in1</span><span class=o>.</span><span class=na>readObject</span><span class=o>(),</span>
</span></span><span class=line><span class=cl>                            <span class=n>animals2</span> <span class=o>=</span> <span class=o>(</span><span class=n>List</span><span class=o>)</span><span class=n>in1</span><span class=o>.</span><span class=na>readObject</span><span class=o>(),</span>
</span></span><span class=line><span class=cl>                            <span class=n>animals3</span> <span class=o>=</span> <span class=o>(</span><span class=n>List</span><span class=o>)</span><span class=n>in2</span><span class=o>.</span><span class=na>readObject</span><span class=o>();</span>
</span></span><span class=line><span class=cl>                    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span>
</span></span><span class=line><span class=cl>                            <span class=s>&#34;animals1: &#34;</span> <span class=o>+</span> <span class=n>animals1</span><span class=o>);</span>
</span></span><span class=line><span class=cl>                    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span>
</span></span><span class=line><span class=cl>                            <span class=s>&#34;animals2: &#34;</span> <span class=o>+</span> <span class=n>animals2</span><span class=o>);</span>
</span></span><span class=line><span class=cl>                    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span>
</span></span><span class=line><span class=cl>                            <span class=s>&#34;animals3: &#34;</span> <span class=o>+</span> <span class=n>animals3</span><span class=o>);</span>
</span></span><span class=line><span class=cl>                <span class=o>}</span>
</span></span><span class=line><span class=cl>            <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span> <span class=k>catch</span><span class=o>(</span><span class=n>IOException</span> <span class=o>|</span> <span class=n>ClassNotFoundException</span> <span class=n>e</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=k>throw</span> <span class=k>new</span> <span class=n>RuntimeException</span><span class=o>(</span><span class=n>e</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>输出为：</p><pre tabindex=0><code>animals: [Bosco the dog[Animal@15db9742],
House@6d06d69c
, Ralph the hamster[Animal@7852e922], House@6d06d69c
, Molly the cat[Animal@4e25154f], House@6d06d69c
]
animals1: [Bosco the dog[Animal@7ba4f24f],
House@3b9a45b3
, Ralph the hamster[Animal@7699a589], House@3b9a45b3
, Molly the cat[Animal@58372a00], House@3b9a45b3
]
animals2: [Bosco the dog[Animal@7ba4f24f],
House@3b9a45b3
, Ralph the hamster[Animal@7699a589], House@3b9a45b3
, Molly the cat[Animal@58372a00], House@3b9a45b3
]
animals3: [Bosco the dog[Animal@4dd8dc3],
House@6d03e736
, Ralph the hamster[Animal@568db2f2], House@6d03e736
, Molly the cat[Animal@378bf509], House@6d03e736
]
</code></pre><p>这里有一件有趣的事：我们可以通过一个字节数组来使用对象序列化，从而实现对任何可 Serializable 对象的“深度复制"（deep copy）—— 深度复制意味着我们复制的是整个对象网，而不仅仅是基本对象及其引用。复制对象将在本书的 <a href>附录：传递和返回对象</a> 一章中进行深入地探讨。</p><p>在这个例子中，Animal 对象包含有 House 类型的字段。在 main() 方法中，创建了一个 Animal 列表并将其两次序列化，分别送至不同的流。当其被反序列化还原并被打印时，我们可以看到所示的执行某次运行后的结果（每次运行时，对象将会处在不同的内存地址）。</p><p>当然，我们期望这些反序列化还原后的对象地址与原来的地址不同。但请注意，在 animals1 和 animals2 中却出现了相同的地址，包括二者共享的那个指向 House 对象的引用。另一方面，当恢复 animals3 时，系统无法知道另一个流内的对象是第一个流内的对象的别名，因此它会产生出完全不同的对象网。</p><p>只要将任何对象序列化到单一流中，就可以恢复出与我们写出时一样的对象网，并且没有任何意外重复复制出的对象。当然，我们可以在写出第一个对象和写出最后一个对象期间改变这些对象的状态，但是这是我们自己的事，无论对象在被序列化时处于什么状态（无论它们和其他对象有什么样的连接关系），它们都可以被写出。</p><p>最安全的做法是将其作为“原子”操作进行序列化。如果我们序列化了某些东西，再去做其他一些工作，再来序列化更多的东西，如此等等，那么将无法安全地保存系统状态。取而代之的是，将构成系统状态的所有对象都置入单一容器内，并在一个操作中将该容器直接写出。然后同样只需一次方法调用，即可以将其恢复。</p><p>下面这个例子是一个想象的计算机辅助设计（CAD）系统，该例演示了这一方法。此外，它还引入了 static 字段的问题：如果我们查看 JDK 文档，就会发现 Class 是 Serializable 的，因此只需直接对 Class 对象序列化，就可以很容易地保存 static 字段。在任何情况下，这都是一种明智的做法。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// serialization/AStoreCADState.java
</span></span></span><span class=line><span class=cl><span class=c1>// Saving the state of a fictitious CAD system
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>import</span> <span class=nn>java.io.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>java.util.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>java.util.stream.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kd>enum</span> <span class=n>Color</span> <span class=o>{</span> <span class=n>RED</span><span class=o>,</span> <span class=n>BLUE</span><span class=o>,</span> <span class=n>GREEN</span> <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=kd>abstract</span> <span class=kd>class</span> <span class=nc>Shape</span> <span class=kd>implements</span> <span class=n>Serializable</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kt>int</span> <span class=n>xPos</span><span class=o>,</span> <span class=n>yPos</span><span class=o>,</span> <span class=n>dimension</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kd>static</span> <span class=n>Random</span> <span class=n>rand</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Random</span><span class=o>(</span><span class=mi>47</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kd>static</span> <span class=kt>int</span> <span class=n>counter</span> <span class=o>=</span> <span class=mi>0</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>abstract</span> <span class=kt>void</span> <span class=nf>setColor</span><span class=o>(</span><span class=n>Color</span> <span class=n>newColor</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>abstract</span> <span class=n>Color</span> <span class=nf>getColor</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=n>Shape</span><span class=o>(</span><span class=kt>int</span> <span class=n>xVal</span><span class=o>,</span> <span class=kt>int</span> <span class=n>yVal</span><span class=o>,</span> <span class=kt>int</span> <span class=n>dim</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>xPos</span> <span class=o>=</span> <span class=n>xVal</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=n>yPos</span> <span class=o>=</span> <span class=n>yVal</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=n>dimension</span> <span class=o>=</span> <span class=n>dim</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>String</span> <span class=nf>toString</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>getClass</span><span class=o>()</span> <span class=o>+</span> <span class=s>&#34;color[&#34;</span> <span class=o>+</span> <span class=n>getColor</span><span class=o>()</span> <span class=o>+</span>
</span></span><span class=line><span class=cl>                <span class=s>&#34;] xPos[&#34;</span> <span class=o>+</span> <span class=n>xPos</span> <span class=o>+</span> <span class=s>&#34;] yPos[&#34;</span> <span class=o>+</span> <span class=n>yPos</span> <span class=o>+</span>
</span></span><span class=line><span class=cl>                <span class=s>&#34;] dim[&#34;</span> <span class=o>+</span> <span class=n>dimension</span> <span class=o>+</span> <span class=s>&#34;]\n&#34;</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=n>Shape</span> <span class=nf>randomFactory</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=kt>int</span> <span class=n>xVal</span> <span class=o>=</span> <span class=n>rand</span><span class=o>.</span><span class=na>nextInt</span><span class=o>(</span><span class=mi>100</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=kt>int</span> <span class=n>yVal</span> <span class=o>=</span> <span class=n>rand</span><span class=o>.</span><span class=na>nextInt</span><span class=o>(</span><span class=mi>100</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=kt>int</span> <span class=n>dim</span> <span class=o>=</span> <span class=n>rand</span><span class=o>.</span><span class=na>nextInt</span><span class=o>(</span><span class=mi>100</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=k>switch</span><span class=o>(</span><span class=n>counter</span><span class=o>++</span> <span class=o>%</span> <span class=mi>3</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=k>default</span><span class=o>:</span>
</span></span><span class=line><span class=cl>            <span class=k>case</span> <span class=mi>0</span><span class=o>:</span> <span class=k>return</span> <span class=k>new</span> <span class=n>Circle</span><span class=o>(</span><span class=n>xVal</span><span class=o>,</span> <span class=n>yVal</span><span class=o>,</span> <span class=n>dim</span><span class=o>);</span>
</span></span><span class=line><span class=cl>            <span class=k>case</span> <span class=mi>1</span><span class=o>:</span> <span class=k>return</span> <span class=k>new</span> <span class=n>Square</span><span class=o>(</span><span class=n>xVal</span><span class=o>,</span> <span class=n>yVal</span><span class=o>,</span> <span class=n>dim</span><span class=o>);</span>
</span></span><span class=line><span class=cl>            <span class=k>case</span> <span class=mi>2</span><span class=o>:</span> <span class=k>return</span> <span class=k>new</span> <span class=n>Line</span><span class=o>(</span><span class=n>xVal</span><span class=o>,</span> <span class=n>yVal</span><span class=o>,</span> <span class=n>dim</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=kd>class</span> <span class=nc>Circle</span> <span class=kd>extends</span> <span class=n>Shape</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kd>static</span> <span class=n>Color</span> <span class=n>color</span> <span class=o>=</span> <span class=n>Color</span><span class=o>.</span><span class=na>RED</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=n>Circle</span><span class=o>(</span><span class=kt>int</span> <span class=n>xVal</span><span class=o>,</span> <span class=kt>int</span> <span class=n>yVal</span><span class=o>,</span> <span class=kt>int</span> <span class=n>dim</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=kd>super</span><span class=o>(</span><span class=n>xVal</span><span class=o>,</span> <span class=n>yVal</span><span class=o>,</span> <span class=n>dim</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>void</span> <span class=nf>setColor</span><span class=o>(</span><span class=n>Color</span> <span class=n>newColor</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>color</span> <span class=o>=</span> <span class=n>newColor</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>Color</span> <span class=nf>getColor</span><span class=o>()</span> <span class=o>{</span> <span class=k>return</span> <span class=n>color</span><span class=o>;</span> <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=kd>class</span> <span class=nc>Square</span> <span class=kd>extends</span> <span class=n>Shape</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kd>static</span> <span class=n>Color</span> <span class=n>color</span> <span class=o>=</span> <span class=n>Color</span><span class=o>.</span><span class=na>RED</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=n>Square</span><span class=o>(</span><span class=kt>int</span> <span class=n>xVal</span><span class=o>,</span> <span class=kt>int</span> <span class=n>yVal</span><span class=o>,</span> <span class=kt>int</span> <span class=n>dim</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=kd>super</span><span class=o>(</span><span class=n>xVal</span><span class=o>,</span> <span class=n>yVal</span><span class=o>,</span> <span class=n>dim</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>void</span> <span class=nf>setColor</span><span class=o>(</span><span class=n>Color</span> <span class=n>newColor</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>color</span> <span class=o>=</span> <span class=n>newColor</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>Color</span> <span class=nf>getColor</span><span class=o>()</span> <span class=o>{</span> <span class=k>return</span> <span class=n>color</span><span class=o>;</span> <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=kd>class</span> <span class=nc>Line</span> <span class=kd>extends</span> <span class=n>Shape</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kd>static</span> <span class=n>Color</span> <span class=n>color</span> <span class=o>=</span> <span class=n>Color</span><span class=o>.</span><span class=na>RED</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span>
</span></span><span class=line><span class=cl>    <span class=nf>serializeStaticState</span><span class=o>(</span><span class=n>ObjectOutputStream</span> <span class=n>os</span><span class=o>)</span>
</span></span><span class=line><span class=cl>            <span class=kd>throws</span> <span class=n>IOException</span> <span class=o>{</span> <span class=n>os</span><span class=o>.</span><span class=na>writeObject</span><span class=o>(</span><span class=n>color</span><span class=o>);</span> <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span>
</span></span><span class=line><span class=cl>    <span class=nf>deserializeStaticState</span><span class=o>(</span><span class=n>ObjectInputStream</span> <span class=n>os</span><span class=o>)</span>
</span></span><span class=line><span class=cl>            <span class=kd>throws</span> <span class=n>IOException</span><span class=o>,</span> <span class=n>ClassNotFoundException</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>color</span> <span class=o>=</span> <span class=o>(</span><span class=n>Color</span><span class=o>)</span><span class=n>os</span><span class=o>.</span><span class=na>readObject</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=n>Line</span><span class=o>(</span><span class=kt>int</span> <span class=n>xVal</span><span class=o>,</span> <span class=kt>int</span> <span class=n>yVal</span><span class=o>,</span> <span class=kt>int</span> <span class=n>dim</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=kd>super</span><span class=o>(</span><span class=n>xVal</span><span class=o>,</span> <span class=n>yVal</span><span class=o>,</span> <span class=n>dim</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>void</span> <span class=nf>setColor</span><span class=o>(</span><span class=n>Color</span> <span class=n>newColor</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>color</span> <span class=o>=</span> <span class=n>newColor</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>Color</span> <span class=nf>getColor</span><span class=o>()</span> <span class=o>{</span> <span class=k>return</span> <span class=n>color</span><span class=o>;</span> <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>AStoreCADState</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>List</span><span class=o>&lt;</span><span class=n>Class</span><span class=o>&lt;?</span> <span class=kd>extends</span> <span class=n>Shape</span><span class=o>&gt;&gt;</span> <span class=n>shapeTypes</span> <span class=o>=</span>
</span></span><span class=line><span class=cl>                <span class=n>Arrays</span><span class=o>.</span><span class=na>asList</span><span class=o>(</span>
</span></span><span class=line><span class=cl>                        <span class=n>Circle</span><span class=o>.</span><span class=na>class</span><span class=o>,</span> <span class=n>Square</span><span class=o>.</span><span class=na>class</span><span class=o>,</span> <span class=n>Line</span><span class=o>.</span><span class=na>class</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>List</span><span class=o>&lt;</span><span class=n>Shape</span><span class=o>&gt;</span> <span class=n>shapes</span> <span class=o>=</span> <span class=n>IntStream</span><span class=o>.</span><span class=na>range</span><span class=o>(</span><span class=mi>0</span><span class=o>,</span> <span class=mi>10</span><span class=o>)</span>
</span></span><span class=line><span class=cl>                <span class=o>.</span><span class=na>mapToObj</span><span class=o>(</span><span class=n>i</span> <span class=o>-&gt;</span> <span class=n>Shape</span><span class=o>.</span><span class=na>randomFactory</span><span class=o>())</span>
</span></span><span class=line><span class=cl>                <span class=o>.</span><span class=na>collect</span><span class=o>(</span><span class=n>Collectors</span><span class=o>.</span><span class=na>toList</span><span class=o>());</span>
</span></span><span class=line><span class=cl>        <span class=c1>// Set all the static colors to GREEN:
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>shapes</span><span class=o>.</span><span class=na>forEach</span><span class=o>(</span><span class=n>s</span> <span class=o>-&gt;</span> <span class=n>s</span><span class=o>.</span><span class=na>setColor</span><span class=o>(</span><span class=n>Color</span><span class=o>.</span><span class=na>GREEN</span><span class=o>));</span>
</span></span><span class=line><span class=cl>        <span class=c1>// Save the state vector:
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>try</span><span class=o>(</span>
</span></span><span class=line><span class=cl>                <span class=n>ObjectOutputStream</span> <span class=n>out</span> <span class=o>=</span>
</span></span><span class=line><span class=cl>                        <span class=k>new</span> <span class=n>ObjectOutputStream</span><span class=o>(</span>
</span></span><span class=line><span class=cl>                                <span class=k>new</span> <span class=n>FileOutputStream</span><span class=o>(</span><span class=s>&#34;CADState.dat&#34;</span><span class=o>))</span>
</span></span><span class=line><span class=cl>        <span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=n>out</span><span class=o>.</span><span class=na>writeObject</span><span class=o>(</span><span class=n>shapeTypes</span><span class=o>);</span>
</span></span><span class=line><span class=cl>            <span class=n>Line</span><span class=o>.</span><span class=na>serializeStaticState</span><span class=o>(</span><span class=n>out</span><span class=o>);</span>
</span></span><span class=line><span class=cl>            <span class=n>out</span><span class=o>.</span><span class=na>writeObject</span><span class=o>(</span><span class=n>shapes</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span> <span class=k>catch</span><span class=o>(</span><span class=n>IOException</span> <span class=n>e</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=k>throw</span> <span class=k>new</span> <span class=n>RuntimeException</span><span class=o>(</span><span class=n>e</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=c1>// Display the shapes:
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>shapes</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>输出为：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=o>[</span><span class=kd>class</span> <span class=nc>Circlecolor</span><span class=o>[</span><span class=n>GREEN</span><span class=o>]</span> <span class=n>xPos</span><span class=o>[</span><span class=mi>58</span><span class=o>]</span> <span class=n>yPos</span><span class=o>[</span><span class=mi>55</span><span class=o>]</span> <span class=n>dim</span><span class=o>[</span><span class=mi>93</span><span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>,</span> <span class=kd>class</span> <span class=nc>Squarecolor</span><span class=o>[</span><span class=n>GREEN</span><span class=o>]</span> <span class=n>xPos</span><span class=o>[</span><span class=mi>61</span><span class=o>]</span> <span class=n>yPos</span><span class=o>[</span><span class=mi>61</span><span class=o>]</span> <span class=n>dim</span><span class=o>[</span><span class=mi>29</span><span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>,</span> <span class=kd>class</span> <span class=nc>Linecolor</span><span class=o>[</span><span class=n>GREEN</span><span class=o>]</span> <span class=n>xPos</span><span class=o>[</span><span class=mi>68</span><span class=o>]</span> <span class=n>yPos</span><span class=o>[</span><span class=mi>0</span><span class=o>]</span> <span class=n>dim</span><span class=o>[</span><span class=mi>22</span><span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>,</span> <span class=kd>class</span> <span class=nc>Circlecolor</span><span class=o>[</span><span class=n>GREEN</span><span class=o>]</span> <span class=n>xPos</span><span class=o>[</span><span class=mi>7</span><span class=o>]</span> <span class=n>yPos</span><span class=o>[</span><span class=mi>88</span><span class=o>]</span> <span class=n>dim</span><span class=o>[</span><span class=mi>28</span><span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>,</span> <span class=kd>class</span> <span class=nc>Squarecolor</span><span class=o>[</span><span class=n>GREEN</span><span class=o>]</span> <span class=n>xPos</span><span class=o>[</span><span class=mi>51</span><span class=o>]</span> <span class=n>yPos</span><span class=o>[</span><span class=mi>89</span><span class=o>]</span> <span class=n>dim</span><span class=o>[</span><span class=mi>9</span><span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>,</span> <span class=kd>class</span> <span class=nc>Linecolor</span><span class=o>[</span><span class=n>GREEN</span><span class=o>]</span> <span class=n>xPos</span><span class=o>[</span><span class=mi>78</span><span class=o>]</span> <span class=n>yPos</span><span class=o>[</span><span class=mi>98</span><span class=o>]</span> <span class=n>dim</span><span class=o>[</span><span class=mi>61</span><span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>,</span> <span class=kd>class</span> <span class=nc>Circlecolor</span><span class=o>[</span><span class=n>GREEN</span><span class=o>]</span> <span class=n>xPos</span><span class=o>[</span><span class=mi>20</span><span class=o>]</span> <span class=n>yPos</span><span class=o>[</span><span class=mi>58</span><span class=o>]</span> <span class=n>dim</span><span class=o>[</span><span class=mi>16</span><span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>,</span> <span class=kd>class</span> <span class=nc>Squarecolor</span><span class=o>[</span><span class=n>GREEN</span><span class=o>]</span> <span class=n>xPos</span><span class=o>[</span><span class=mi>40</span><span class=o>]</span> <span class=n>yPos</span><span class=o>[</span><span class=mi>11</span><span class=o>]</span> <span class=n>dim</span><span class=o>[</span><span class=mi>22</span><span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>,</span> <span class=kd>class</span> <span class=nc>Linecolor</span><span class=o>[</span><span class=n>GREEN</span><span class=o>]</span> <span class=n>xPos</span><span class=o>[</span><span class=mi>4</span><span class=o>]</span> <span class=n>yPos</span><span class=o>[</span><span class=mi>83</span><span class=o>]</span> <span class=n>dim</span><span class=o>[</span><span class=mi>6</span><span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>,</span> <span class=kd>class</span> <span class=nc>Circlecolor</span><span class=o>[</span><span class=n>GREEN</span><span class=o>]</span> <span class=n>xPos</span><span class=o>[</span><span class=mi>75</span><span class=o>]</span> <span class=n>yPos</span><span class=o>[</span><span class=mi>10</span><span class=o>]</span> <span class=n>dim</span><span class=o>[</span><span class=mi>42</span><span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>]</span>
</span></span></code></pre></div><p>Shape 类实现了 Serializable，所以任何自 Shape 继承的类也都会自动是 Serializable 的。每个 Shape 都含有数据，而且每个派生自 Shape 的类都包含一个 static 字段，用来确定各种 Shape 类型的颜色（如果将 static 字段置入基类，只会产生一个 static 字段，因为 static 字段不能在派生类中复制）。可对基类中的方法进行重载，以便为不同的类型设置颜色（static 方法不会动态绑定，所以这些都是普通的方法）。每次调用 randomFactory() 方法时，它都会使用不同的随机数作为 Shape 的数据，从而创建不同的 Shape。</p><p>在 main() 中，一个 ArrayList 用于保存 Class 对象，而另一个用于保存几何形状。</p><p>恢复对象相当直观：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// serialization/RecoverCADState.java
</span></span></span><span class=line><span class=cl><span class=c1>// Restoring the state of the fictitious CAD system
</span></span></span><span class=line><span class=cl><span class=c1>// {RunFirst: AStoreCADState}
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>import</span> <span class=nn>java.io.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>java.util.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>RecoverCADState</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=nd>@SuppressWarnings</span><span class=o>(</span><span class=s>&#34;unchecked&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span><span class=o>(</span>
</span></span><span class=line><span class=cl>                <span class=n>ObjectInputStream</span> <span class=n>in</span> <span class=o>=</span>
</span></span><span class=line><span class=cl>                        <span class=k>new</span> <span class=n>ObjectInputStream</span><span class=o>(</span>
</span></span><span class=line><span class=cl>                                <span class=k>new</span> <span class=n>FileInputStream</span><span class=o>(</span><span class=s>&#34;CADState.dat&#34;</span><span class=o>))</span>
</span></span><span class=line><span class=cl>        <span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl><span class=c1>// Read in the same order they were written:
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=n>List</span><span class=o>&lt;</span><span class=n>Class</span><span class=o>&lt;?</span> <span class=kd>extends</span> <span class=n>Shape</span><span class=o>&gt;&gt;</span> <span class=n>shapeTypes</span> <span class=o>=</span>
</span></span><span class=line><span class=cl>                    <span class=o>(</span><span class=n>List</span><span class=o>&lt;</span><span class=n>Class</span><span class=o>&lt;?</span> <span class=kd>extends</span> <span class=n>Shape</span><span class=o>&gt;&gt;)</span><span class=n>in</span><span class=o>.</span><span class=na>readObject</span><span class=o>();</span>
</span></span><span class=line><span class=cl>            <span class=n>Line</span><span class=o>.</span><span class=na>deserializeStaticState</span><span class=o>(</span><span class=n>in</span><span class=o>);</span>
</span></span><span class=line><span class=cl>            <span class=n>List</span><span class=o>&lt;</span><span class=n>Shape</span><span class=o>&gt;</span> <span class=n>shapes</span> <span class=o>=</span>
</span></span><span class=line><span class=cl>                    <span class=o>(</span><span class=n>List</span><span class=o>&lt;</span><span class=n>Shape</span><span class=o>&gt;)</span><span class=n>in</span><span class=o>.</span><span class=na>readObject</span><span class=o>();</span>
</span></span><span class=line><span class=cl>            <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>shapes</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span> <span class=k>catch</span><span class=o>(</span><span class=n>IOException</span> <span class=o>|</span> <span class=n>ClassNotFoundException</span> <span class=n>e</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=k>throw</span> <span class=k>new</span> <span class=n>RuntimeException</span><span class=o>(</span><span class=n>e</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>输出为：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=o>[</span><span class=kd>class</span> <span class=nc>Circlecolor</span><span class=o>[</span><span class=n>RED</span><span class=o>]</span> <span class=n>xPos</span><span class=o>[</span><span class=mi>58</span><span class=o>]</span> <span class=n>yPos</span><span class=o>[</span><span class=mi>55</span><span class=o>]</span> <span class=n>dim</span><span class=o>[</span><span class=mi>93</span><span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>,</span> <span class=kd>class</span> <span class=nc>Squarecolor</span><span class=o>[</span><span class=n>RED</span><span class=o>]</span> <span class=n>xPos</span><span class=o>[</span><span class=mi>61</span><span class=o>]</span> <span class=n>yPos</span><span class=o>[</span><span class=mi>61</span><span class=o>]</span> <span class=n>dim</span><span class=o>[</span><span class=mi>29</span><span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>,</span> <span class=kd>class</span> <span class=nc>Linecolor</span><span class=o>[</span><span class=n>GREEN</span><span class=o>]</span> <span class=n>xPos</span><span class=o>[</span><span class=mi>68</span><span class=o>]</span> <span class=n>yPos</span><span class=o>[</span><span class=mi>0</span><span class=o>]</span> <span class=n>dim</span><span class=o>[</span><span class=mi>22</span><span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>,</span> <span class=kd>class</span> <span class=nc>Circlecolor</span><span class=o>[</span><span class=n>RED</span><span class=o>]</span> <span class=n>xPos</span><span class=o>[</span><span class=mi>7</span><span class=o>]</span> <span class=n>yPos</span><span class=o>[</span><span class=mi>88</span><span class=o>]</span> <span class=n>dim</span><span class=o>[</span><span class=mi>28</span><span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>,</span> <span class=kd>class</span> <span class=nc>Squarecolor</span><span class=o>[</span><span class=n>RED</span><span class=o>]</span> <span class=n>xPos</span><span class=o>[</span><span class=mi>51</span><span class=o>]</span> <span class=n>yPos</span><span class=o>[</span><span class=mi>89</span><span class=o>]</span> <span class=n>dim</span><span class=o>[</span><span class=mi>9</span><span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>,</span> <span class=kd>class</span> <span class=nc>Linecolor</span><span class=o>[</span><span class=n>GREEN</span><span class=o>]</span> <span class=n>xPos</span><span class=o>[</span><span class=mi>78</span><span class=o>]</span> <span class=n>yPos</span><span class=o>[</span><span class=mi>98</span><span class=o>]</span> <span class=n>dim</span><span class=o>[</span><span class=mi>61</span><span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>,</span> <span class=kd>class</span> <span class=nc>Circlecolor</span><span class=o>[</span><span class=n>RED</span><span class=o>]</span> <span class=n>xPos</span><span class=o>[</span><span class=mi>20</span><span class=o>]</span> <span class=n>yPos</span><span class=o>[</span><span class=mi>58</span><span class=o>]</span> <span class=n>dim</span><span class=o>[</span><span class=mi>16</span><span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>,</span> <span class=kd>class</span> <span class=nc>Squarecolor</span><span class=o>[</span><span class=n>RED</span><span class=o>]</span> <span class=n>xPos</span><span class=o>[</span><span class=mi>40</span><span class=o>]</span> <span class=n>yPos</span><span class=o>[</span><span class=mi>11</span><span class=o>]</span> <span class=n>dim</span><span class=o>[</span><span class=mi>22</span><span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>,</span> <span class=kd>class</span> <span class=nc>Linecolor</span><span class=o>[</span><span class=n>GREEN</span><span class=o>]</span> <span class=n>xPos</span><span class=o>[</span><span class=mi>4</span><span class=o>]</span> <span class=n>yPos</span><span class=o>[</span><span class=mi>83</span><span class=o>]</span> <span class=n>dim</span><span class=o>[</span><span class=mi>6</span><span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>,</span> <span class=kd>class</span> <span class=nc>Circlecolor</span><span class=o>[</span><span class=n>RED</span><span class=o>]</span> <span class=n>xPos</span><span class=o>[</span><span class=mi>75</span><span class=o>]</span> <span class=n>yPos</span><span class=o>[</span><span class=mi>10</span><span class=o>]</span> <span class=n>dim</span><span class=o>[</span><span class=mi>42</span><span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>]</span>
</span></span></code></pre></div><p>可以看到，xPos，yPos 以及 dim 的值都被成功地保存和恢复了，但是对 static 信息的读取却出现了问题。所有读回的颜色应该都是“3”，但是真实情况却并非如此。Circle 的值为 1（定义为 RED），而 Square 的值为 0（记住，它们是在构造器中被初始化的）。看上去似乎 static 数据根本没有被序列化！确实如此——尽管 Class 类是 Serializable 的，但它却不能按我们所期望的方式运行。所以假如想序列化 static 值，必须自己动手去实现。</p><p>这正是 Line 中的 serializeStaticState() 和 deserializeStaticState() 两个 static 方法的用途。可以看到，它们是作为存储和读取过程的一部分被显式地调用的。（注意必须维护写入序列化文件和从该文件中读回的顺序。）因此，为了使 CADStatejava 正确运转起来，你必须：</p><ol><li>为几何形状添加 serializeStaticState() 和 deserializeStaticState()</li><li>移除 ArrayList shapeTypes 以及与之有关的所有代码。</li><li>在几何形状内添加对新的序列化和反序列化还原静态方法的调用。</li></ol><p>另一个要注意的问题是安全，因为序列化也会将 private 数据保存下来。如果你关心安全问题，那么应将其标记成 transient，但是这之后，还必须设计一种安全的保存信息的方法，以便在执行恢复时可以复位那些 private 变量。</p><h2 id=xml>XML</h2><p>对象序列化的一个重要限制是它只是 Java 的解决方案：只有 Java 程序才能反序列化这种对象。一种更具互操作性的解决方案是将数据转换为 XML 格式，这可以使其被各种各样的平台和语言使用。</p><p>因为 XML 十分流行，所以用它来编程时的各种选择不胜枚举，包括随 JDK 发布的 javax.xml.*类库。我选择使用 Elliotte Rusty Harold 的开源 XOM 类库（可从 <a href=https://www.xom.nu target=_blank rel=noopener>www.xom.nu</a> 下载并获得文档），因为它看起来最简单，同时也是最直观的用 Java 产生和修改 XML 的方式。另外，XOM 还强调了 XML 的正确性。</p><p>作为一个示例，假设有一个 APerson 对象，它包含姓和名，你想将它们序列化到 XML 中。下面的 APerson 类有一个 getXML() 方法，它使用 XOM 来产生被转换为 XML 的 Element 对象的 APerson 数据；还有一个构造器，接受 Element 并从中抽取恰当的 APerson 数据（注意，XML 示例都在它们自己的子目录中）：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// serialization/APerson.java
</span></span></span><span class=line><span class=cl><span class=c1>// Use the XOM library to write and read XML
</span></span></span><span class=line><span class=cl><span class=c1>// nu.xom.Node comes from http://www.xom.nu
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>import</span> <span class=nn>nu.xom.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>java.io.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>java.util.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>APerson</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>String</span> <span class=n>first</span><span class=o>,</span> <span class=n>last</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=nf>APerson</span><span class=o>(</span><span class=n>String</span> <span class=n>first</span><span class=o>,</span> <span class=n>String</span> <span class=n>last</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=o>.</span><span class=na>first</span> <span class=o>=</span> <span class=n>first</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=o>.</span><span class=na>last</span> <span class=o>=</span> <span class=n>last</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=c1>// Produce an XML Element from this APerson object:
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kd>public</span> <span class=n>Element</span> <span class=nf>getXML</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>Element</span> <span class=n>person</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Element</span><span class=o>(</span><span class=s>&#34;person&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>Element</span> <span class=n>firstName</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Element</span><span class=o>(</span><span class=s>&#34;first&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>firstName</span><span class=o>.</span><span class=na>appendChild</span><span class=o>(</span><span class=n>first</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>Element</span> <span class=n>lastName</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Element</span><span class=o>(</span><span class=s>&#34;last&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>lastName</span><span class=o>.</span><span class=na>appendChild</span><span class=o>(</span><span class=n>last</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>person</span><span class=o>.</span><span class=na>appendChild</span><span class=o>(</span><span class=n>firstName</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>person</span><span class=o>.</span><span class=na>appendChild</span><span class=o>(</span><span class=n>lastName</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>person</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=c1>// Constructor restores a APerson from XML:
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kd>public</span> <span class=nf>APerson</span><span class=o>(</span><span class=n>Element</span> <span class=n>person</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>first</span> <span class=o>=</span> <span class=n>person</span>
</span></span><span class=line><span class=cl>                <span class=o>.</span><span class=na>getFirstChildElement</span><span class=o>(</span><span class=s>&#34;first&#34;</span><span class=o>).</span><span class=na>getValue</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=n>last</span> <span class=o>=</span> <span class=n>person</span>
</span></span><span class=line><span class=cl>                <span class=o>.</span><span class=na>getFirstChildElement</span><span class=o>(</span><span class=s>&#34;last&#34;</span><span class=o>).</span><span class=na>getValue</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>String</span> <span class=nf>toString</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>first</span> <span class=o>+</span> <span class=s>&#34; &#34;</span> <span class=o>+</span> <span class=n>last</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=c1>// Make it human-readable:
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span>
</span></span><span class=line><span class=cl>    <span class=nf>format</span><span class=o>(</span><span class=n>OutputStream</span> <span class=n>os</span><span class=o>,</span> <span class=n>Document</span> <span class=n>doc</span><span class=o>)</span>
</span></span><span class=line><span class=cl>            <span class=kd>throws</span> <span class=n>Exception</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>Serializer</span> <span class=n>serializer</span> <span class=o>=</span>
</span></span><span class=line><span class=cl>                <span class=k>new</span> <span class=n>Serializer</span><span class=o>(</span><span class=n>os</span><span class=o>,</span><span class=s>&#34;ISO-8859-1&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>serializer</span><span class=o>.</span><span class=na>setIndent</span><span class=o>(</span><span class=mi>4</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>serializer</span><span class=o>.</span><span class=na>setMaxLength</span><span class=o>(</span><span class=mi>60</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>serializer</span><span class=o>.</span><span class=na>write</span><span class=o>(</span><span class=n>doc</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>serializer</span><span class=o>.</span><span class=na>flush</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=kd>throws</span> <span class=n>Exception</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>List</span><span class=o>&lt;</span><span class=n>APerson</span><span class=o>&gt;</span> <span class=n>people</span> <span class=o>=</span> <span class=n>Arrays</span><span class=o>.</span><span class=na>asList</span><span class=o>(</span>
</span></span><span class=line><span class=cl>                <span class=k>new</span> <span class=n>APerson</span><span class=o>(</span><span class=s>&#34;Dr. Bunsen&#34;</span><span class=o>,</span> <span class=s>&#34;Honeydew&#34;</span><span class=o>),</span>
</span></span><span class=line><span class=cl>                <span class=k>new</span> <span class=n>APerson</span><span class=o>(</span><span class=s>&#34;Gonzo&#34;</span><span class=o>,</span> <span class=s>&#34;The Great&#34;</span><span class=o>),</span>
</span></span><span class=line><span class=cl>                <span class=k>new</span> <span class=n>APerson</span><span class=o>(</span><span class=s>&#34;Phillip J.&#34;</span><span class=o>,</span> <span class=s>&#34;Fry&#34;</span><span class=o>));</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>people</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>Element</span> <span class=n>root</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Element</span><span class=o>(</span><span class=s>&#34;people&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span><span class=o>(</span><span class=n>APerson</span> <span class=n>p</span> <span class=o>:</span> <span class=n>people</span><span class=o>)</span>
</span></span><span class=line><span class=cl>            <span class=n>root</span><span class=o>.</span><span class=na>appendChild</span><span class=o>(</span><span class=n>p</span><span class=o>.</span><span class=na>getXML</span><span class=o>());</span>
</span></span><span class=line><span class=cl>        <span class=n>Document</span> <span class=n>doc</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Document</span><span class=o>(</span><span class=n>root</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>format</span><span class=o>(</span><span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>,</span> <span class=n>doc</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>format</span><span class=o>(</span><span class=k>new</span> <span class=n>BufferedOutputStream</span><span class=o>(</span>
</span></span><span class=line><span class=cl>                <span class=k>new</span> <span class=n>FileOutputStream</span><span class=o>(</span><span class=s>&#34;People.xml&#34;</span><span class=o>)),</span> <span class=n>doc</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>输出为：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl>[Dr. Bunsen Honeydew, Gonzo The Great, Phillip J. Fry]
</span></span><span class=line><span class=cl><span class=cp>&lt;?xml version=&#34;1.0&#34; encoding=&#34;ISO-8859-1&#34;?&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;people&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;person&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;first&gt;</span>Dr. Bunsen<span class=nt>&lt;/first&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;last&gt;</span>Honeydew<span class=nt>&lt;/last&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;/person&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;person&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;first&gt;</span>Gonzo<span class=nt>&lt;/first&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;last&gt;</span>The Great<span class=nt>&lt;/last&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;/person&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;person&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;first&gt;</span>Phillip J.<span class=nt>&lt;/first&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;last&gt;</span>Fry<span class=nt>&lt;/last&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;/person&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/people&gt;</span>
</span></span></code></pre></div><p>XOM 的方法都具有相当的自解释性，可以在 XOM 文档中找到它们。XOM 还包含一个 Serializer 类，你可以在 format() 方法中看到它被用来将 XML 转换为更具可读性的格式。如果只调用 toXML()，那么所有东西都会混在一起，因此 Serializer 是一种便利工具。</p><p>从 XML 文件中反序列化 Person 对象也很简单：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// serialization/People.java
</span></span></span><span class=line><span class=cl><span class=c1>// nu.xom.Node comes from http://www.xom.nu
</span></span></span><span class=line><span class=cl><span class=c1>// {RunFirst: APerson}
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>import</span> <span class=nn>nu.xom.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>java.io.File</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>java.util.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>People</span> <span class=kd>extends</span> <span class=n>ArrayList</span><span class=o>&lt;</span><span class=n>APerson</span><span class=o>&gt;</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=nf>People</span><span class=o>(</span><span class=n>String</span> <span class=n>fileName</span><span class=o>)</span> <span class=kd>throws</span> <span class=n>Exception</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>Document</span> <span class=n>doc</span> <span class=o>=</span>
</span></span><span class=line><span class=cl>                <span class=k>new</span> <span class=n>Builder</span><span class=o>().</span><span class=na>build</span><span class=o>(</span><span class=k>new</span> <span class=n>File</span><span class=o>(</span><span class=n>fileName</span><span class=o>));</span>
</span></span><span class=line><span class=cl>        <span class=n>Elements</span> <span class=n>elements</span> <span class=o>=</span>
</span></span><span class=line><span class=cl>                <span class=n>doc</span><span class=o>.</span><span class=na>getRootElement</span><span class=o>().</span><span class=na>getChildElements</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span><span class=o>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=o>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>elements</span><span class=o>.</span><span class=na>size</span><span class=o>();</span> <span class=n>i</span><span class=o>++)</span>
</span></span><span class=line><span class=cl>            <span class=n>add</span><span class=o>(</span><span class=k>new</span> <span class=n>APerson</span><span class=o>(</span><span class=n>elements</span><span class=o>.</span><span class=na>get</span><span class=o>(</span><span class=n>i</span><span class=o>)));</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=kd>throws</span> <span class=n>Exception</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>People</span> <span class=n>p</span> <span class=o>=</span> <span class=k>new</span> <span class=n>People</span><span class=o>(</span><span class=s>&#34;People.xml&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>p</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=cm>/* Output:
</span></span></span><span class=line><span class=cl><span class=cm>[Dr. Bunsen Honeydew, Gonzo The Great, Phillip J. Fry]
</span></span></span><span class=line><span class=cl><span class=cm>*/</span>
</span></span></code></pre></div><p>People 构造器使用 XOM 的 Builder.build() 方法打开并读取一个文件，而 getChildElements() 方法产生了一个 Elements 列表（不是标准的 Java List，只是一个拥有 size() 和 get() 方法的对象，因为 Harold 不想强制人们使用特定版本的 Java，但是仍旧希望使用类型安全的容器）。在这个列表中的每个 Element 都表示一个 Person 对象，因此它可以传递给第二个 Person 构造器。注意，这要求你提前知道 XML 文件的确切结构，但是这经常会有些问题。如果文件结构与你预期的结构不匹配，那么 XOM 将抛出异常。对你来说，如果你缺乏有关将来的 XML 结构的信息，那么就有可能会编写更复杂的代码去探测 XML 文档，而不是只对其做出假设。</p><p>为了获取这些示例去编译它们，你必须将 XOM 发布包中的 JAR 文件放置到你的类路径中。</p><p>这里只给出了用 Java 和 XOM 类库进行 XML 编程的简介，更详细的信息可以浏览 <a href=https://www.xom.nu target=_blank rel=noopener>www.xom.nu</a> 。</p><div style=page-break-after:always></div></div><div class=article-widget><div class="container-xl row post-nav"><div class="col-6 post-nav-item"><div class=meta-nav>上一页</div><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/appendix-new-io/ rel=next>Appendix-New-IO</a></div><div class="col-6 post-nav-item"><div class=meta-nav>下一页</div><a href=/books/java-series/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/appendix-passing-and-returning-objects/ rel=prev>Appendix-Passing-and-Returning-Objects</a></div></div></div><div class=body-footer><p>最近更新于 0001-01-01</p><section id=comments class="mb-3 pt-0"><div id=disqus_thread></div><script>var disqus_config=function(){};(function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="https://ngte.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)})()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></section></div></article><footer class=site-footer><div class="copyright py-4 bg-footer"><div class="row justify-content-center"><div class="text-center footer-color"><p class=mb-0>© 2017-2022 NGTE all rights reserved</p></div></div></div></footer></main></div></div><script src=//unpkg.com/heti/umd/heti-addon.min.js></script>
<script>const heti=new Heti(".article");heti.autoSpacing()</script><script type=text/javascript>window.$crisp=[],window.CRISP_WEBSITE_ID="12adcc35-9621-4313-8262-62dc654b29d8",function(){setTimeout(function(){d=document,s=d.createElement("script"),s.src="https://client.crisp.chat/l.js",s.async=1,d.getElementsByTagName("head")[0].appendChild(s)},2500)}()</script></div><div class=page-footer></div><script src=/js/vendor-bundle.min.d26509351aa0ff874abbee824e982e9b.js></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.1/highlight.min.js integrity="sha512-Ypjm0o7jOxAd4hpdoppSEN0TQOC19UtPAqD+4s5AlXmUvbmmS/YMxYqAqarQYyxTnB6/rqip9qcxlNB/3U9Wdg==" crossorigin=anonymous></script>
<script id=search-hit-algolia-template type=text/html><div class=search-hit><div class=search-hit-content><div class=search-hit-name><a href={{relpermalink}}>{{#helpers.highlight}}{ "attribute": "title" }{{/helpers.highlight}}</a></div><div class="article-metadata search-hit-type">{{type}}</div><p class=search-hit-description>{{#helpers.highlight}}{ "attribute": "summary" }{{/helpers.highlight}}</p></div></div></script><script src=https://cdn.jsdelivr.net/npm/instantsearch.js@4/dist/instantsearch.production.min.js crossorigin=anonymous></script>
<script id=dsq-count-scr src=https://ngte.disqus.com/count.js async></script>
<script src=/zh/js/algolia-search-built.min.4387d694ca1258194aaf562b8cd1c400.js type=module></script>
<script id=page-data type=application/json>{"use_headroom":false}</script><script src=/zh/js/wowchemy.min.d1673c7a11d1238516cbe12a1e84257f.js></script>
<script>var mybutton=document.getElementById("backTopBtn");window.onscroll=function(){scrollFunction()};function scrollFunction(){document.body.scrollTop>20||document.documentElement.scrollTop>20?mybutton.style.display="block":mybutton.style.display="none"}function topFunction(){document.body.scrollTop=0,document.documentElement.scrollTop=0}</script><script src=https://cdn.jsdelivr.net/gh/bryanbraun/anchorjs@4.2.2/anchor.min.js integrity="sha512-I7w3ZdSFzw5j3jU3ZkNikBNeIrl3i+hEuEdwNmqUJvwNcaBUNcijnP2gd9DtGlgVYDplfjGoD8vTNsID+lCjqg==" crossorigin=anonymous></script>
<script>anchors.add()</script><script>(function(){"use strict";if(!document.queryCommandSupported("copy"))return;function e(e,t){e.className="highlight-copy-btn",e.textContent=t,setTimeout(function(){e.textContent="",e.className="highlight-copy-btn fa fa-copy"},1e3)}function t(e){var t=window.getSelection(),n=document.createRange();return n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n),t}function n(n){var o,s=document.createElement("button");s.className="highlight-copy-btn fa fa-copy",s.textContent="",o=n.firstElementChild,s.addEventListener("click",function(){try{var n=t(o);document.execCommand("copy"),n.removeAllRanges(),e(s,"已复制")}catch(t){console&&console.log(t),e(s,"Failed :'(")}}),n.appendChild(s)}var s=document.getElementsByClassName("highlight");Array.prototype.forEach.call(s,n)})()</script></body></html>