<!doctype html><html lang=zh><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=generator content="Wowchemy 5.5.0 for Hugo"><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=preload as=style href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap"><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap" media=print onload='this.media="all"'><meta name=google-site-verification content="google69a5cccb61297807"><meta name=baidu-site-verification content="cqmZHEleVh"><meta name=description content="第十七章 文件 在丑陋的 Java I/O 编程方式诞生多年以后，Java 终于简化了文件读写的基本操作。 这种&#34;困难方式&#34;的全部细节都在 Appendix: I/O Streams。如果你读过这个部分，就会认同 Java 设计者毫不在意他"><link rel=alternate hreflang=zh href=https://ng-tech.icu/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/17-files/><meta name=theme-color content="#0a55a7"><link rel=stylesheet href=/css/vendor-bundle.min.c7b8d9abd591ba2253ea42747e3ac3f5.css media=print onload='this.media="all"'><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.1/styles/github.min.css crossorigin=anonymous title=hl-light media=print onload='this.media="all"'><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.1/styles/dracula.min.css crossorigin=anonymous title=hl-dark media=print onload='this.media="all"' disabled><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/instantsearch.css@7.4.5/themes/satellite-min.css integrity="sha256-TehzF/2QvNKhGQrrNpoOb2Ck4iGZ1J/DI4pkd2oUsBc=" crossorigin=anonymous><link rel=stylesheet href=/css/wowchemy.63df6ae9fc2b4cc71b83f1774d780209.css><script async src="https://www.googletagmanager.com/gtag/js?id=G-40NYXJ8823"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-40NYXJ8823")</script><script>var _hmt=_hmt||[];(function(){var e,t=document.createElement("script");t.src="https://hm.baidu.com/hm.js?56df1177bce405601b0ecdd7208f75c6",e=document.getElementsByTagName("script")[0],e.parentNode.insertBefore(t,e)})()</script><link rel=manifest href=/manifest.webmanifest><link rel=icon type=image/png href=/media/icon_hu0f7d075e895d6f5f1f5fdbc1e33dc138_10087_32x32_fill_lanczos_center_3.png><link rel=apple-touch-icon type=image/png href=/media/icon_hu0f7d075e895d6f5f1f5fdbc1e33dc138_10087_180x180_fill_lanczos_center_3.png><link rel=canonical href=https://ng-tech.icu/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/17-files/><meta property="twitter:card" content="summary_large_image"><meta property="twitter:site" content="@wx-chevalier"><meta property="twitter:creator" content="@wx-chevalier"><meta property="og:site_name" content="Next-gen Tech Edu"><meta property="og:url" content="https://ng-tech.icu/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/17-files/"><meta property="og:title" content="17-Files | Next-gen Tech Edu"><meta property="og:description" content="第十七章 文件 在丑陋的 Java I/O 编程方式诞生多年以后，Java 终于简化了文件读写的基本操作。 这种&#34;困难方式&#34;的全部细节都在 Appendix: I/O Streams。如果你读过这个部分，就会认同 Java 设计者毫不在意他"><meta property="og:image" content="https://ng-tech.icu/media/sharing.png"><meta property="twitter:image" content="https://ng-tech.icu/media/sharing.png"><meta property="og:locale" content="zh"><title>17-Files | Next-gen Tech Edu</title></head><body id=top data-spy=scroll data-offset=70 data-target=#TableOfContents class=page-wrapper data-wc-page-id=db000a9d2c3fbcb8bfe53193cd0f7352><button onclick=topFunction() id=backTopBtn title="Go to top"><i class="fa-solid fa-circle-up" aria-hidden=true></i></button>
<script src=/js/wowchemy-init.min.14a0ed61c6dbd594b9c75193b25be179.js></script><aside class=search-modal id=search><div class=container><section class=search-header><div class="row no-gutters justify-content-between mb-3"><div class="col-6 search-title"><p>搜索</p></div><div class="col-6 col-search-close"><a class=js-search href=# aria-label=关闭><i class="fas fa-times-circle text-muted" aria-hidden=true></i></a></div></div><div id=search-box></div></section><section class=section-search-results><div id=search-hits></div><div id=search-common-queries></div></section></div></aside><div class=page-header><header class=header--fixed><nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id=navbar-main><div class=container-xl><div class="d-none d-lg-inline-flex"><a class=navbar-brand href=/>Next-gen Tech Edu</a></div><button type=button class=navbar-toggler data-toggle=collapse data-target=#navbar-content aria-controls=navbar-content aria-expanded=false aria-label=切换导航>
<span><i class="fas fa-bars"></i></span></button><div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none"><a class=navbar-brand href=/>Next-gen Tech Edu</a></div><div class="navbar-collapse main-menu-item collapse justify-content-start" id=navbar-content><ul class="navbar-nav d-md-inline-flex"><li class=nav-item><a class=nav-link href=/books-gallery><span>笔记（万篇）</span></a></li><li class=nav-item><a class=nav-link href=/#knowledge-map><span>知识图谱</span></a></li><style>.dropdown-item{display:inline-flex}</style><li class="nav-item dropdown"><a href=# class="nav-link dropdown-toggle" data-toggle=dropdown aria-haspopup=true><span>实验室</span><span class=caret></span></a><div class=dropdown-menu><a class=dropdown-item href=/galaxy-home/gh-craft><span>Craft 方块世界</span></a>
<a class=dropdown-item href=/galaxy-home/glossary-cards><span>3D 知识卡牌</span></a></div></li><style>.dropdown-item{display:inline-flex}</style><li class="nav-item dropdown"><a href=# class="nav-link dropdown-toggle" data-toggle=dropdown aria-haspopup=true><span>其他阅读渠道</span><span class=caret></span></a><div class=dropdown-menu><a class=dropdown-item href=https://zhuanlan.zhihu.com/wxyyxc1992><img style=width:16px;height:16px;display:inline-block;margin-right:8px src=https://ngte-superbed.oss-cn-beijing.aliyuncs.com/item/20230218234451.png></img><span>知乎</span></a>
<a class=dropdown-item href=https://segmentfault.com/blog/wxyyxc1992><img style=width:16px;height:16px;display:inline-block;margin-right:8px src=https://ngte-superbed.oss-cn-beijing.aliyuncs.com/item/20230219113556.png></img><span>SegmentFault</span></a>
<a class=dropdown-item href=https://zhuanlan.zhihu.com/wxyyxc1992><img style=width:16px;height:16px;display:inline-block;margin-right:8px src=https://ngte-superbed.oss-cn-beijing.aliyuncs.com/item/20230219113519.png></img><span>掘金</span></a></div></li></ul></div><ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2"><li class=nav-item><a class="nav-link js-search" href=# aria-label=搜索><i class="fas fa-search" aria-hidden=true></i></a></li><li class=nav-item><a class=nav-link href=https://github.com/wx-chevalier aria-label=GitHub><i class="fa-brands fa-github" aria-hidden=true></i></a></li><div></div><style>@media only screen and (max-width:600px){.jimmysong-template{display:none!important}}</style><li class=jimmysong-template style=color:#fff;font-size:12px><a href=https://jimmysong.io style=color:#fff>By Jimmy Song's Template</a></li></ul></div></nav></header></div><div class=page-body><link rel=stylesheet href=//unpkg.com/heti/umd/heti.min.css><div class="container-xl docs"><div class="row flex-xl-nowrap"><div class=docs-sidebar><form class="docs-search d-flex align-items-center"><button class="btn docs-toggle d-md-none p-0 mr-md-3 w-100" type=button data-toggle=collapse data-target=#docs-nav aria-controls=docs-nav aria-expanded=false aria-label="Toggle section navigation"><div class=d-flex><span class="d-md-none pl-1 flex-grow-1 text-left overflow-hidden">On Java 8</span>
<span><i class="fas fa-chevron-down"></i></span></div></button>
<button class="form-control sidebar-search js-search d-none d-md-flex">
<i class="fas fa-search pr-2"></i>
<span class=sidebar-search-text>搜索...</span>
<span class=sidebar-search-shortcut>/</span></button></form><nav class="collapse docs-links" id=docs-nav><ul class="nav docs-sidenav"><li style=display:inline-flex><a style=cursor:pointer onclick=window.history.back()><i class="fas fa-arrow-left pr-1"></i>
Back</a>
<span>|</span>
<a href=/books/><i class="fa-solid fa-house" style=margin-right:4px></i>
Books</a></li></ul><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-idb2e20681920018e3a6e20318a9804534")' href=#idb2e20681920018e3a6e20318a9804534 aria-expanded=false aria-controls=idb2e20681920018e3a6e20318a9804534 aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/>999.参考资料</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#idb2e20681920018e3a6e20318a9804534 aria-expanded=false aria-controls=idb2e20681920018e3a6e20318a9804534><i class="fa-solid fa-angle-down" id=caret-idb2e20681920018e3a6e20318a9804534></i></a></div><ul class="nav docs-sidenav collapse show" id=idb2e20681920018e3a6e20318a9804534><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-id4d84ffe3754d5f34aa3c13b4d1952b31")' href=#id4d84ffe3754d5f34aa3c13b4d1952b31 aria-expanded=false aria-controls=id4d84ffe3754d5f34aa3c13b4d1952b31 aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/>On Java 8</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#id4d84ffe3754d5f34aa3c13b4d1952b31 aria-expanded=false aria-controls=id4d84ffe3754d5f34aa3c13b4d1952b31><i class="fa-solid fa-angle-down" id=caret-id4d84ffe3754d5f34aa3c13b4d1952b31></i></a></div><ul class="nav docs-sidenav collapse show" id=id4d84ffe3754d5f34aa3c13b4d1952b31><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/00-introduction/>00-Introduction</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/01-what-is-an-object/>01-What-is-an-Object</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/02-installing-java-and-the-book-examples/>02-Installing-Java-and-the-Book-Examples</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/03-objects-everywhere/>03-Objects-Everywhere</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/04-operators/>04-Operators</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/05-control-flow/>05-Control-Flow</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/06-housekeeping/>06-Housekeeping</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/07-implementation-hiding/>07-Implementation-Hiding</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/08-reuse/>08-Reuse</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/09-polymorphism/>09-Polymorphism</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/10-interfaces/>10-Interfaces</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/11-inner-classes/>11-Inner-Classes</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/12-collections/>12-Collections</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/13-functional-programming/>13-Functional-Programming</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/14-streams/>14-Streams</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/15-exceptions/>15-Exceptions</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/16-validating-your-code/>16-Validating-Your-Code</a></li><li class="child level active"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/17-files/>17-Files</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/18-strings/>18-Strings</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/19-type-information/>19-Type-Information</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/20-generics/>20-Generics</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/21-arrays/>21-Arrays</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/22-enumerations/>22-Enumerations</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/23-annotations/>23-Annotations</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/24-concurrent-programming/>24-Concurrent-Programming</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/25-patterns/>25-Patterns</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/appendix-becoming-a-programmer/>Appendix-Becoming-a-Programmer</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/appendix-benefits-and-costs-of-static-type-checking/>Appendix-Benefits-and-Costs-of-Static-Type-Checking</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/appendix-collection-topics/>Appendix-Collection-Topics</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/appendix-data-compression/>Appendix-Data-Compression</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/appendix-io-streams/>Appendix-IO-Streams</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/appendix-javadoc/>Appendix-Javadoc</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/appendix-low-level-concurrency/>Appendix-Low-Level-Concurrency</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/appendix-new-io/>Appendix-New-IO</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/appendix-object-serialization/>Appendix-Object-Serialization</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/appendix-passing-and-returning-objects/>Appendix-Passing-and-Returning-Objects</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/appendix-programming-guidelines/>Appendix-Programming-Guidelines</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/appendix-standard-io/>Appendix-Standard-IO</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/appendix-supplements/>Appendix-Supplements</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/appendix-the-positive-legacy-of-c-plus-plus-and-java/>Appendix-The-Positive-Legacy-of-C-plus-plus-and-Java</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/appendix-understanding-equals-and-hashcode/>Appendix-Understanding-equals-and-hashCode</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/glossary/>GLOSSARY</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-id214ecc87c188b2007b2d478ce6167fb1")' href=#id214ecc87c188b2007b2d478ce6167fb1 aria-expanded=false aria-controls=id214ecc87c188b2007b2d478ce6167fb1 aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/>Think in Java</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#id214ecc87c188b2007b2d478ce6167fb1 aria-expanded=false aria-controls=id214ecc87c188b2007b2d478ce6167fb1><i class="fa-solid fa-angle-right" id=caret-id214ecc87c188b2007b2d478ce6167fb1></i></a></div><ul class="nav docs-sidenav collapse" id=id214ecc87c188b2007b2d478ce6167fb1><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-idca73ee751e8224db415e54c000dd27fb")' href=#idca73ee751e8224db415e54c000dd27fb aria-expanded=false aria-controls=idca73ee751e8224db415e54c000dd27fb aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/1.%E5%AF%B9%E8%B1%A1%E5%85%A5%E9%97%A8/>1.对象入门</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#idca73ee751e8224db415e54c000dd27fb aria-expanded=false aria-controls=idca73ee751e8224db415e54c000dd27fb><i class="fa-solid fa-angle-right" id=caret-idca73ee751e8224db415e54c000dd27fb></i></a></div><ul class="nav docs-sidenav collapse" id=idca73ee751e8224db415e54c000dd27fb><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/1.%E5%AF%B9%E8%B1%A1%E5%85%A5%E9%97%A8/1.1-%E6%8A%BD%E8%B1%A1%E7%9A%84%E8%BF%9B%E6%AD%A5/>1.1 抽象的进步</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/1.%E5%AF%B9%E8%B1%A1%E5%85%A5%E9%97%A8/1.10-%E6%B0%B8%E4%B9%85%E6%80%A7/>1.10 永久性</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/1.%E5%AF%B9%E8%B1%A1%E5%85%A5%E9%97%A8/1.11-java%E5%92%8C%E5%9B%A0%E7%89%B9%E7%BD%91/>1.11 Java和因特网</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/1.%E5%AF%B9%E8%B1%A1%E5%85%A5%E9%97%A8/1.12-%E5%88%86%E6%9E%90%E5%92%8C%E8%AE%BE%E8%AE%A1/>1.12 分析和设计</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/1.%E5%AF%B9%E8%B1%A1%E5%85%A5%E9%97%A8/1.13-java%E8%BF%98%E6%98%AFc++/>1.13 Java还是C++</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/1.%E5%AF%B9%E8%B1%A1%E5%85%A5%E9%97%A8/1.2-%E5%AF%B9%E8%B1%A1%E7%9A%84%E6%8E%A5%E5%8F%A3/>1.2 对象的接口</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/1.%E5%AF%B9%E8%B1%A1%E5%85%A5%E9%97%A8/1.3-%E5%AE%9E%E7%8E%B0%E6%96%B9%E6%A1%88%E7%9A%84%E9%9A%90%E8%97%8F/>1.3 实现方案的隐藏</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/1.%E5%AF%B9%E8%B1%A1%E5%85%A5%E9%97%A8/1.4-%E6%96%B9%E6%A1%88%E7%9A%84%E9%87%8D%E5%A4%8D%E4%BD%BF%E7%94%A8/>1.4 方案的重复使用</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/1.%E5%AF%B9%E8%B1%A1%E5%85%A5%E9%97%A8/1.5-%E7%BB%A7%E6%89%BF%E9%87%8D%E6%96%B0%E4%BD%BF%E7%94%A8%E6%8E%A5%E5%8F%A3/>1.5 继承：重新使用接口</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/1.%E5%AF%B9%E8%B1%A1%E5%85%A5%E9%97%A8/1.6-%E5%A4%9A%E6%80%81%E5%AF%B9%E8%B1%A1%E7%9A%84%E4%BA%92%E6%8D%A2%E4%BD%BF%E7%94%A8/>1.6 多态对象的互换使用</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/1.%E5%AF%B9%E8%B1%A1%E5%85%A5%E9%97%A8/1.7-%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%88%9B%E5%BB%BA%E5%92%8C%E5%AD%98%E5%9C%A8%E6%97%B6%E9%97%B4/>1.7 对象的创建和存在时间</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/1.%E5%AF%B9%E8%B1%A1%E5%85%A5%E9%97%A8/1.9-%E5%A4%9A%E7%BA%BF%E7%A8%8B/>1.9 多线程</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-ide41bfd2e5eef4f5cc967d0bf0d3beae5")' href=#ide41bfd2e5eef4f5cc967d0bf0d3beae5 aria-expanded=false aria-controls=ide41bfd2e5eef4f5cc967d0bf0d3beae5 aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/10.java-io-%E7%B3%BB%E7%BB%9F/>10.Java IO 系统</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#ide41bfd2e5eef4f5cc967d0bf0d3beae5 aria-expanded=false aria-controls=ide41bfd2e5eef4f5cc967d0bf0d3beae5><i class="fa-solid fa-angle-right" id=caret-ide41bfd2e5eef4f5cc967d0bf0d3beae5></i></a></div><ul class="nav docs-sidenav collapse" id=ide41bfd2e5eef4f5cc967d0bf0d3beae5><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/10.java-io-%E7%B3%BB%E7%BB%9F/10.1-%E8%BE%93%E5%85%A5%E5%92%8C%E8%BE%93%E5%87%BA/>10.1 输入和输出</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/10.java-io-%E7%B3%BB%E7%BB%9F/10.10-%E6%80%BB%E7%BB%93/>10.10 总结</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/10.java-io-%E7%B3%BB%E7%BB%9F/10.11-%E7%BB%83%E4%B9%A0/>10.11 练习</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/10.java-io-%E7%B3%BB%E7%BB%9F/10.2-%E5%A2%9E%E6%B7%BB%E5%B1%9E%E6%80%A7%E5%92%8C%E6%9C%89%E7%94%A8%E7%9A%84%E6%8E%A5%E5%8F%A3/>10.2 增添属性和有用的接口</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/10.java-io-%E7%B3%BB%E7%BB%9F/10.3-%E6%9C%AC%E8%BA%AB%E7%9A%84%E7%BC%BA%E9%99%B7randomaccessfile/>10.3 本身的缺陷：RandomAccessFile</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/10.java-io-%E7%B3%BB%E7%BB%9F/10.4-file%E7%B1%BB/>10.4 File类</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/10.java-io-%E7%B3%BB%E7%BB%9F/10.5-io%E6%B5%81%E7%9A%84%E5%85%B8%E5%9E%8B%E5%BA%94%E7%94%A8/>10.5 IO流的典型应用</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/10.java-io-%E7%B3%BB%E7%BB%9F/10.6-streamtokenizer/>10.6 StreamTokenizer</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/10.java-io-%E7%B3%BB%E7%BB%9F/10.7-java-1.1%E7%9A%84io%E6%B5%81/>10.7 Java 1.1的IO流</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/10.java-io-%E7%B3%BB%E7%BB%9F/10.8-%E5%8E%8B%E7%BC%A9/>10.8 压缩</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/10.java-io-%E7%B3%BB%E7%BB%9F/10.9-%E5%AF%B9%E8%B1%A1%E5%BA%8F%E5%88%97%E5%8C%96/>10.9 对象序列化</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-idb836ac598092c15afaccbaa2c465c59e")' href=#idb836ac598092c15afaccbaa2c465c59e aria-expanded=false aria-controls=idb836ac598092c15afaccbaa2c465c59e aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/11.%E8%BF%90%E8%A1%8C%E6%9C%9F%E7%B1%BB%E5%9E%8B%E9%89%B4%E5%AE%9A/>11.运行期类型鉴定</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#idb836ac598092c15afaccbaa2c465c59e aria-expanded=false aria-controls=idb836ac598092c15afaccbaa2c465c59e><i class="fa-solid fa-angle-right" id=caret-idb836ac598092c15afaccbaa2c465c59e></i></a></div><ul class="nav docs-sidenav collapse" id=idb836ac598092c15afaccbaa2c465c59e><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/11.%E8%BF%90%E8%A1%8C%E6%9C%9F%E7%B1%BB%E5%9E%8B%E9%89%B4%E5%AE%9A/11.1-%E5%AF%B9rtti%E7%9A%84%E9%9C%80%E8%A6%81/>11.1 对RTTI的需要</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/11.%E8%BF%90%E8%A1%8C%E6%9C%9F%E7%B1%BB%E5%9E%8B%E9%89%B4%E5%AE%9A/11.2-rtti-%E8%AF%AD%E6%B3%95/>11.2 RTTI 语法</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/11.%E8%BF%90%E8%A1%8C%E6%9C%9F%E7%B1%BB%E5%9E%8B%E9%89%B4%E5%AE%9A/11.3-%E5%8F%8D%E5%B0%84%E8%BF%90%E8%A1%8C%E6%9C%9F%E7%B1%BB%E4%BF%A1%E6%81%AF/>11.3 反射：运行期类信息</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/11.%E8%BF%90%E8%A1%8C%E6%9C%9F%E7%B1%BB%E5%9E%8B%E9%89%B4%E5%AE%9A/11.4-%E6%80%BB%E7%BB%93/>11.4 总结</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/11.%E8%BF%90%E8%A1%8C%E6%9C%9F%E7%B1%BB%E5%9E%8B%E9%89%B4%E5%AE%9A/11.5-%E7%BB%83%E4%B9%A0/>11.5 练习</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-ide320911890134774be5931d1a0a20cc9")' href=#ide320911890134774be5931d1a0a20cc9 aria-expanded=false aria-controls=ide320911890134774be5931d1a0a20cc9 aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/12.%E4%BC%A0%E9%80%92%E5%92%8C%E8%BF%94%E5%9B%9E%E5%AF%B9%E8%B1%A1/>12.传递和返回对象</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#ide320911890134774be5931d1a0a20cc9 aria-expanded=false aria-controls=ide320911890134774be5931d1a0a20cc9><i class="fa-solid fa-angle-right" id=caret-ide320911890134774be5931d1a0a20cc9></i></a></div><ul class="nav docs-sidenav collapse" id=ide320911890134774be5931d1a0a20cc9><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/12.%E4%BC%A0%E9%80%92%E5%92%8C%E8%BF%94%E5%9B%9E%E5%AF%B9%E8%B1%A1/12.1-%E4%BC%A0%E9%80%92%E6%8C%87%E9%92%88/>12.1 传递指针</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/12.%E4%BC%A0%E9%80%92%E5%92%8C%E8%BF%94%E5%9B%9E%E5%AF%B9%E8%B1%A1/12.2-%E5%88%B6%E4%BD%9C%E6%9C%AC%E5%9C%B0%E5%89%AF%E6%9C%AC/>12.2 制作本地副本</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/12.%E4%BC%A0%E9%80%92%E5%92%8C%E8%BF%94%E5%9B%9E%E5%AF%B9%E8%B1%A1/12.3-%E5%85%8B%E9%9A%86%E7%9A%84%E6%8E%A7%E5%88%B6/>12.3 克隆的控制</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/12.%E4%BC%A0%E9%80%92%E5%92%8C%E8%BF%94%E5%9B%9E%E5%AF%B9%E8%B1%A1/12.4-%E5%8F%AA%E8%AF%BB%E7%B1%BB/>12.4 只读类</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/12.%E4%BC%A0%E9%80%92%E5%92%8C%E8%BF%94%E5%9B%9E%E5%AF%B9%E8%B1%A1/12.5-%E6%80%BB%E7%BB%93/>12.5 总结</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/12.%E4%BC%A0%E9%80%92%E5%92%8C%E8%BF%94%E5%9B%9E%E5%AF%B9%E8%B1%A1/12.6-%E7%BB%83%E4%B9%A0/>12.6 练习</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-iddba1dfa22d26f49d68205d3c67fa5695")' href=#iddba1dfa22d26f49d68205d3c67fa5695 aria-expanded=false aria-controls=iddba1dfa22d26f49d68205d3c67fa5695 aria-hidden=false data-toggle=collapse></div></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-idbb7b9ed9f3766574125ce978e02ab9b3")' href=#idbb7b9ed9f3766574125ce978e02ab9b3 aria-expanded=false aria-controls=idbb7b9ed9f3766574125ce978e02ab9b3 aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/14.%E5%A4%9A%E7%BA%BF%E7%A8%8B/>14.多线程</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#idbb7b9ed9f3766574125ce978e02ab9b3 aria-expanded=false aria-controls=idbb7b9ed9f3766574125ce978e02ab9b3><i class="fa-solid fa-angle-right" id=caret-idbb7b9ed9f3766574125ce978e02ab9b3></i></a></div><ul class="nav docs-sidenav collapse" id=idbb7b9ed9f3766574125ce978e02ab9b3><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/14.%E5%A4%9A%E7%BA%BF%E7%A8%8B/14.1-%E5%8F%8D%E5%BA%94%E7%81%B5%E6%95%8F%E7%9A%84%E7%94%A8%E6%88%B7%E7%95%8C%E9%9D%A2/>14.1 反应灵敏的用户界面</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/14.%E5%A4%9A%E7%BA%BF%E7%A8%8B/14.2-%E5%85%B1%E4%BA%AB%E6%9C%89%E9%99%90%E7%9A%84%E8%B5%84%E6%BA%90/>14.2 共享有限的资源</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/14.%E5%A4%9A%E7%BA%BF%E7%A8%8B/14.3-%E5%A0%B5%E5%A1%9E/>14.3 堵塞</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/14.%E5%A4%9A%E7%BA%BF%E7%A8%8B/14.4-%E4%BC%98%E5%85%88%E7%BA%A7/>14.4 优先级</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/14.%E5%A4%9A%E7%BA%BF%E7%A8%8B/14.5-%E5%9B%9E%E9%A1%BErunnable/>14.5 回顾runnable</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/14.%E5%A4%9A%E7%BA%BF%E7%A8%8B/14.6-%E6%80%BB%E7%BB%93/>14.6 总结</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/14.%E5%A4%9A%E7%BA%BF%E7%A8%8B/14.7-%E7%BB%83%E4%B9%A0/>14.7 练习</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-id0717cbd205b42e749ff12487fe013a48")' href=#id0717cbd205b42e749ff12487fe013a48 aria-expanded=false aria-controls=id0717cbd205b42e749ff12487fe013a48 aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/15.%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/>15.网络编程</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#id0717cbd205b42e749ff12487fe013a48 aria-expanded=false aria-controls=id0717cbd205b42e749ff12487fe013a48><i class="fa-solid fa-angle-right" id=caret-id0717cbd205b42e749ff12487fe013a48></i></a></div><ul class="nav docs-sidenav collapse" id=id0717cbd205b42e749ff12487fe013a48><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/15.%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/15.1-%E6%9C%BA%E5%99%A8%E7%9A%84%E6%A0%87%E8%AF%86/>15.1 机器的标识</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/15.%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/15.10-%E7%BB%83%E4%B9%A0/>15.10 练习</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/15.%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/15.2-%E5%A5%97%E6%8E%A5%E5%AD%97/>15.2 套接字</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/15.%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/15.3-%E6%9C%8D%E5%8A%A1%E5%A4%9A%E4%B8%AA%E5%AE%A2%E6%88%B7/>15.3 服务多个客户</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/15.%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/15.4-%E6%95%B0%E6%8D%AE%E6%8A%A5/>15.4 数据报</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/15.%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/15.5-%E4%B8%80%E4%B8%AAweb%E5%BA%94%E7%94%A8/>15.5 一个Web应用</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/15.%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/15.6-java%E4%B8%8Ecgi%E7%9A%84%E6%B2%9F%E9%80%9A/>15.6 Java与CGI的沟通</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/15.%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/15.7-%E7%94%A8jdbc%E8%BF%9E%E6%8E%A5%E6%95%B0%E6%8D%AE%E5%BA%93/>15.7 用JDBC连接数据库</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/15.%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/15.8-%E8%BF%9C%E7%A8%8B%E6%96%B9%E6%B3%95/>15.8 远程方法</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/15.%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/15.9-%E6%80%BB%E7%BB%93/>15.9 总结</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-idb45833a961ce68d05972119f0bd5689d")' href=#idb45833a961ce68d05972119f0bd5689d aria-expanded=false aria-controls=idb45833a961ce68d05972119f0bd5689d aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/16.%E8%AE%BE%E8%AE%A1%E8%8C%83%E5%BC%8F/>16.设计范式</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#idb45833a961ce68d05972119f0bd5689d aria-expanded=false aria-controls=idb45833a961ce68d05972119f0bd5689d><i class="fa-solid fa-angle-right" id=caret-idb45833a961ce68d05972119f0bd5689d></i></a></div><ul class="nav docs-sidenav collapse" id=idb45833a961ce68d05972119f0bd5689d><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/16.%E8%AE%BE%E8%AE%A1%E8%8C%83%E5%BC%8F/16.1-%E8%8C%83%E5%BC%8F%E7%9A%84%E6%A6%82%E5%BF%B5/>16.1 范式的概念</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/16.%E8%AE%BE%E8%AE%A1%E8%8C%83%E5%BC%8F/16.10-%E7%BB%83%E4%B9%A0/>16.10 练习</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/16.%E8%AE%BE%E8%AE%A1%E8%8C%83%E5%BC%8F/16.2-%E8%A7%82%E5%AF%9F%E5%99%A8%E8%8C%83%E5%BC%8F/>16.2 观察器范式</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/16.%E8%AE%BE%E8%AE%A1%E8%8C%83%E5%BC%8F/16.3-%E6%A8%A1%E6%8B%9F%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6%E7%AB%99/>16.3 模拟垃圾回收站</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/16.%E8%AE%BE%E8%AE%A1%E8%8C%83%E5%BC%8F/16.4-%E6%94%B9%E8%BF%9B%E8%AE%BE%E8%AE%A1/>16.4 改进设计</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/16.%E8%AE%BE%E8%AE%A1%E8%8C%83%E5%BC%8F/16.5-%E6%8A%BD%E8%B1%A1%E7%9A%84%E5%BA%94%E7%94%A8/>16.5 抽象的应用</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/16.%E8%AE%BE%E8%AE%A1%E8%8C%83%E5%BC%8F/16.6-%E5%A4%9A%E9%87%8D%E6%B4%BE%E9%81%A3/>16.6 多重派遣</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/16.%E8%AE%BE%E8%AE%A1%E8%8C%83%E5%BC%8F/16.7-%E8%AE%BF%E9%97%AE%E5%99%A8%E8%8C%83%E5%BC%8F/>16.7 访问器范式</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/16.%E8%AE%BE%E8%AE%A1%E8%8C%83%E5%BC%8F/16.8-rtti%E7%9C%9F%E7%9A%84%E6%9C%89%E5%AE%B3%E5%90%97/>16.8 RTTI真的有害吗</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/16.%E8%AE%BE%E8%AE%A1%E8%8C%83%E5%BC%8F/16.9-%E6%80%BB%E7%BB%93/>16.9 总结</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-id9dcdb57b589db03f63de5260a0331b23")' href=#id9dcdb57b589db03f63de5260a0331b23 aria-expanded=false aria-controls=id9dcdb57b589db03f63de5260a0331b23 aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/17.%E9%A1%B9%E7%9B%AE/>17.项目</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#id9dcdb57b589db03f63de5260a0331b23 aria-expanded=false aria-controls=id9dcdb57b589db03f63de5260a0331b23><i class="fa-solid fa-angle-right" id=caret-id9dcdb57b589db03f63de5260a0331b23></i></a></div><ul class="nav docs-sidenav collapse" id=id9dcdb57b589db03f63de5260a0331b23><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/17.%E9%A1%B9%E7%9B%AE/17.1-%E6%96%87%E5%AD%97%E5%A4%84%E7%90%86/>17.1 文字处理</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/17.%E9%A1%B9%E7%9B%AE/17.2-%E6%96%B9%E6%B3%95%E6%9F%A5%E6%89%BE%E5%B7%A5%E5%85%B7/>17.2 方法查找工具</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/17.%E9%A1%B9%E7%9B%AE/17.3-%E5%A4%8D%E6%9D%82%E6%80%A7%E7%90%86%E8%AE%BA/>17.3 复杂性理论</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/17.%E9%A1%B9%E7%9B%AE/17.4-%E6%80%BB%E7%BB%93/>17.4 总结</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/17.%E9%A1%B9%E7%9B%AE/17.5-%E7%BB%83%E4%B9%A0/>17.5 练习</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-idf0960bbb6faeb4cccffb1ac69252ea28")' href=#idf0960bbb6faeb4cccffb1ac69252ea28 aria-expanded=false aria-controls=idf0960bbb6faeb4cccffb1ac69252ea28 aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/2.%E4%B8%80%E5%88%87%E9%83%BD%E6%98%AF%E5%AF%B9%E8%B1%A1/>2.一切都是对象</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#idf0960bbb6faeb4cccffb1ac69252ea28 aria-expanded=false aria-controls=idf0960bbb6faeb4cccffb1ac69252ea28><i class="fa-solid fa-angle-right" id=caret-idf0960bbb6faeb4cccffb1ac69252ea28></i></a></div><ul class="nav docs-sidenav collapse" id=idf0960bbb6faeb4cccffb1ac69252ea28><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/2.%E4%B8%80%E5%88%87%E9%83%BD%E6%98%AF%E5%AF%B9%E8%B1%A1/2.1-%E7%94%A8%E6%8C%87%E9%92%88%E6%93%8D%E7%BA%B5%E5%AF%B9%E8%B1%A1/>2.1 用指针操纵对象</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/2.%E4%B8%80%E5%88%87%E9%83%BD%E6%98%AF%E5%AF%B9%E8%B1%A1/2.10-%E6%80%BB%E7%BB%93/>2.10 总结</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/2.%E4%B8%80%E5%88%87%E9%83%BD%E6%98%AF%E5%AF%B9%E8%B1%A1/2.11-%E7%BB%83%E4%B9%A0/>2.11 练习</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/2.%E4%B8%80%E5%88%87%E9%83%BD%E6%98%AF%E5%AF%B9%E8%B1%A1/2.2-%E6%89%80%E6%9C%89%E5%AF%B9%E8%B1%A1%E9%83%BD%E5%BF%85%E9%A1%BB%E5%88%9B%E5%BB%BA/>2.2 所有对象都必须创建</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/2.%E4%B8%80%E5%88%87%E9%83%BD%E6%98%AF%E5%AF%B9%E8%B1%A1/2.3-%E7%BB%9D%E5%AF%B9%E4%B8%8D%E8%A6%81%E6%B8%85%E9%99%A4%E5%AF%B9%E8%B1%A1/>2.3 绝对不要清除对象</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/2.%E4%B8%80%E5%88%87%E9%83%BD%E6%98%AF%E5%AF%B9%E8%B1%A1/2.4-%E6%96%B0%E5%BB%BA%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E7%B1%BB/>2.4 新建数据类型：类</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/2.%E4%B8%80%E5%88%87%E9%83%BD%E6%98%AF%E5%AF%B9%E8%B1%A1/2.5-%E6%96%B9%E6%B3%95%E8%87%AA%E5%8F%98%E9%87%8F%E5%92%8C%E8%BF%94%E5%9B%9E%E5%80%BC/>2.5 方法、自变量和返回值</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/2.%E4%B8%80%E5%88%87%E9%83%BD%E6%98%AF%E5%AF%B9%E8%B1%A1/2.6-%E6%9E%84%E5%BB%BAjava%E7%A8%8B%E5%BA%8F/>2.6 构建Java程序</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/2.%E4%B8%80%E5%88%87%E9%83%BD%E6%98%AF%E5%AF%B9%E8%B1%A1/2.7-%E6%88%91%E4%BB%AC%E7%9A%84%E7%AC%AC%E4%B8%80%E4%B8%AAjava%E7%A8%8B%E5%BA%8F/>2.7 我们的第一个Java程序</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/2.%E4%B8%80%E5%88%87%E9%83%BD%E6%98%AF%E5%AF%B9%E8%B1%A1/2.8-%E6%B3%A8%E9%87%8A%E5%92%8C%E5%B5%8C%E5%85%A5%E6%96%87%E6%A1%A3/>2.8 注释和嵌入文档</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/2.%E4%B8%80%E5%88%87%E9%83%BD%E6%98%AF%E5%AF%B9%E8%B1%A1/2.9-%E7%BC%96%E7%A0%81%E6%A0%B7%E5%BC%8F/>2.9 编码样式</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-id742622a5c8a24c8f9f9a1ecc037a0f62")' href=#id742622a5c8a24c8f9f9a1ecc037a0f62 aria-expanded=false aria-controls=id742622a5c8a24c8f9f9a1ecc037a0f62 aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/3.%E6%8E%A7%E5%88%B6%E7%A8%8B%E5%BA%8F%E6%B5%81%E7%A8%8B/>3.控制程序流程</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#id742622a5c8a24c8f9f9a1ecc037a0f62 aria-expanded=false aria-controls=id742622a5c8a24c8f9f9a1ecc037a0f62><i class="fa-solid fa-angle-right" id=caret-id742622a5c8a24c8f9f9a1ecc037a0f62></i></a></div><ul class="nav docs-sidenav collapse" id=id742622a5c8a24c8f9f9a1ecc037a0f62><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/3.%E6%8E%A7%E5%88%B6%E7%A8%8B%E5%BA%8F%E6%B5%81%E7%A8%8B/3.1-%E4%BD%BF%E7%94%A8java%E8%BF%90%E7%AE%97%E7%AC%A6/>3.1 使用Java运算符</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/3.%E6%8E%A7%E5%88%B6%E7%A8%8B%E5%BA%8F%E6%B5%81%E7%A8%8B/3.2-%E6%89%A7%E8%A1%8C%E6%8E%A7%E5%88%B6/>3.2 执行控制</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/3.%E6%8E%A7%E5%88%B6%E7%A8%8B%E5%BA%8F%E6%B5%81%E7%A8%8B/3.3-%E6%80%BB%E7%BB%93/>3.3 总结</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/3.%E6%8E%A7%E5%88%B6%E7%A8%8B%E5%BA%8F%E6%B5%81%E7%A8%8B/3.4-%E7%BB%83%E4%B9%A0/>3.4 练习</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-idada88f416ec1dfab89f033bf872d6408")' href=#idada88f416ec1dfab89f033bf872d6408 aria-expanded=false aria-controls=idada88f416ec1dfab89f033bf872d6408 aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/4.%E5%88%9D%E5%A7%8B%E5%8C%96%E5%92%8C%E6%B8%85%E9%99%A4/>4.初始化和清除</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#idada88f416ec1dfab89f033bf872d6408 aria-expanded=false aria-controls=idada88f416ec1dfab89f033bf872d6408><i class="fa-solid fa-angle-right" id=caret-idada88f416ec1dfab89f033bf872d6408></i></a></div><ul class="nav docs-sidenav collapse" id=idada88f416ec1dfab89f033bf872d6408><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/4.%E5%88%9D%E5%A7%8B%E5%8C%96%E5%92%8C%E6%B8%85%E9%99%A4/4.1-%E7%94%A8%E6%9E%84%E9%80%A0%E5%99%A8%E8%87%AA%E5%8A%A8%E5%88%9D%E5%A7%8B%E5%8C%96/>4.1 用构造器自动初始化</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/4.%E5%88%9D%E5%A7%8B%E5%8C%96%E5%92%8C%E6%B8%85%E9%99%A4/4.2-%E6%96%B9%E6%B3%95%E9%87%8D%E8%BD%BD/>4.2 方法重载</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/4.%E5%88%9D%E5%A7%8B%E5%8C%96%E5%92%8C%E6%B8%85%E9%99%A4/4.3-%E6%B8%85%E9%99%A4%E6%94%B6%E5%B0%BE%E5%92%8C%E5%9E%83%E5%9C%BE%E6%94%B6%E9%9B%86/>4.3 清除：收尾和垃圾收集</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/4.%E5%88%9D%E5%A7%8B%E5%8C%96%E5%92%8C%E6%B8%85%E9%99%A4/4.4-%E6%88%90%E5%91%98%E5%88%9D%E5%A7%8B%E5%8C%96/>4.4 成员初始化</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/4.%E5%88%9D%E5%A7%8B%E5%8C%96%E5%92%8C%E6%B8%85%E9%99%A4/4.5-%E6%95%B0%E7%BB%84%E5%88%9D%E5%A7%8B%E5%8C%96/>4.5 数组初始化</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/4.%E5%88%9D%E5%A7%8B%E5%8C%96%E5%92%8C%E6%B8%85%E9%99%A4/4.6-%E6%80%BB%E7%BB%93/>4.6 总结</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/4.%E5%88%9D%E5%A7%8B%E5%8C%96%E5%92%8C%E6%B8%85%E9%99%A4/4.7-%E7%BB%83%E4%B9%A0/>4.7 练习</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-idadcf0cac1c984df3c4fe242a8cf5b932")' href=#idadcf0cac1c984df3c4fe242a8cf5b932 aria-expanded=false aria-controls=idadcf0cac1c984df3c4fe242a8cf5b932 aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/5.%E9%9A%90%E8%97%8F%E5%AE%9E%E6%96%BD%E8%BF%87%E7%A8%8B/>5.隐藏实施过程</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#idadcf0cac1c984df3c4fe242a8cf5b932 aria-expanded=false aria-controls=idadcf0cac1c984df3c4fe242a8cf5b932><i class="fa-solid fa-angle-right" id=caret-idadcf0cac1c984df3c4fe242a8cf5b932></i></a></div><ul class="nav docs-sidenav collapse" id=idadcf0cac1c984df3c4fe242a8cf5b932><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/5.%E9%9A%90%E8%97%8F%E5%AE%9E%E6%96%BD%E8%BF%87%E7%A8%8B/5.1-%E5%8C%85%E5%BA%93%E5%8D%95%E5%85%83/>5.1 包：库单元</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/5.%E9%9A%90%E8%97%8F%E5%AE%9E%E6%96%BD%E8%BF%87%E7%A8%8B/5.2-java%E8%AE%BF%E9%97%AE%E6%8C%87%E7%A4%BA%E7%AC%A6/>5.2 Java访问指示符</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/5.%E9%9A%90%E8%97%8F%E5%AE%9E%E6%96%BD%E8%BF%87%E7%A8%8B/5.3-%E6%8E%A5%E5%8F%A3%E4%B8%8E%E5%AE%9E%E7%8E%B0/>5.3 接口与实现</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/5.%E9%9A%90%E8%97%8F%E5%AE%9E%E6%96%BD%E8%BF%87%E7%A8%8B/5.4-%E7%B1%BB%E8%AE%BF%E9%97%AE/>5.4 类访问</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/5.%E9%9A%90%E8%97%8F%E5%AE%9E%E6%96%BD%E8%BF%87%E7%A8%8B/5.5-%E6%80%BB%E7%BB%93/>5.5 总结</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/5.%E9%9A%90%E8%97%8F%E5%AE%9E%E6%96%BD%E8%BF%87%E7%A8%8B/5.6-%E7%BB%83%E4%B9%A0/>5.6 练习</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-id867e4ec83e2a44d87f6aed649979a0c1")' href=#id867e4ec83e2a44d87f6aed649979a0c1 aria-expanded=false aria-controls=id867e4ec83e2a44d87f6aed649979a0c1 aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/6.%E7%B1%BB%E5%86%8D%E7%94%9F/>6.类再生</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#id867e4ec83e2a44d87f6aed649979a0c1 aria-expanded=false aria-controls=id867e4ec83e2a44d87f6aed649979a0c1><i class="fa-solid fa-angle-right" id=caret-id867e4ec83e2a44d87f6aed649979a0c1></i></a></div><ul class="nav docs-sidenav collapse" id=id867e4ec83e2a44d87f6aed649979a0c1><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/6.%E7%B1%BB%E5%86%8D%E7%94%9F/6.1-%E5%90%88%E6%88%90%E7%9A%84%E8%AF%AD%E6%B3%95/>6.1 合成的语法</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/6.%E7%B1%BB%E5%86%8D%E7%94%9F/6.10-%E6%80%BB%E7%BB%93/>6.10 总结</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/6.%E7%B1%BB%E5%86%8D%E7%94%9F/6.11-%E7%BB%83%E4%B9%A0/>6.11 练习</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/6.%E7%B1%BB%E5%86%8D%E7%94%9F/6.2-%E7%BB%A7%E6%89%BF%E7%9A%84%E8%AF%AD%E6%B3%95/>6.2 继承的语法</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/6.%E7%B1%BB%E5%86%8D%E7%94%9F/6.3-%E5%90%88%E6%88%90%E4%B8%8E%E7%BB%A7%E6%89%BF%E7%9A%84%E7%BB%93%E5%90%88/>6.3 合成与继承的结合</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/6.%E7%B1%BB%E5%86%8D%E7%94%9F/6.4-%E5%88%B0%E5%BA%95%E9%80%89%E6%8B%A9%E5%90%88%E6%88%90%E8%BF%98%E6%98%AF%E7%BB%A7%E6%89%BF/>6.4 到底选择合成还是继承</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/6.%E7%B1%BB%E5%86%8D%E7%94%9F/6.5-protected/>6.5 protected</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/6.%E7%B1%BB%E5%86%8D%E7%94%9F/6.6-%E7%B4%AF%E7%A7%AF%E5%BC%80%E5%8F%91/>6.6 累积开发</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/6.%E7%B1%BB%E5%86%8D%E7%94%9F/6.7-%E4%B8%8A%E6%BA%AF%E9%80%A0%E5%9E%8B/>6.7 上溯造型</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/6.%E7%B1%BB%E5%86%8D%E7%94%9F/6.8-final%E5%85%B3%E9%94%AE%E5%AD%97/>6.8 final关键字</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/6.%E7%B1%BB%E5%86%8D%E7%94%9F/6.9-%E5%88%9D%E5%A7%8B%E5%8C%96%E5%92%8C%E7%B1%BB%E8%A3%85%E8%BD%BD/>6.9 初始化和类装载</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-idf3d9d72d599cb56e323c67f4c3e5106c")' href=#idf3d9d72d599cb56e323c67f4c3e5106c aria-expanded=false aria-controls=idf3d9d72d599cb56e323c67f4c3e5106c aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/7.%E5%A4%9A%E6%80%81%E6%80%A7/>7.多态性</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#idf3d9d72d599cb56e323c67f4c3e5106c aria-expanded=false aria-controls=idf3d9d72d599cb56e323c67f4c3e5106c><i class="fa-solid fa-angle-right" id=caret-idf3d9d72d599cb56e323c67f4c3e5106c></i></a></div><ul class="nav docs-sidenav collapse" id=idf3d9d72d599cb56e323c67f4c3e5106c><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/7.%E5%A4%9A%E6%80%81%E6%80%A7/7.1-%E4%B8%8A%E6%BA%AF%E9%80%A0%E5%9E%8B/>7.1 上溯造型</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/7.%E5%A4%9A%E6%80%81%E6%80%A7/7.10-%E7%BB%83%E4%B9%A0/>7.10 练习</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/7.%E5%A4%9A%E6%80%81%E6%80%A7/7.2-%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3/>7.2 深入理解</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/7.%E5%A4%9A%E6%80%81%E6%80%A7/7.3-%E8%A6%86%E7%9B%96%E4%B8%8E%E9%87%8D%E8%BD%BD/>7.3 覆盖与重载</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/7.%E5%A4%9A%E6%80%81%E6%80%A7/7.4-%E6%8A%BD%E8%B1%A1%E7%B1%BB%E5%92%8C%E6%96%B9%E6%B3%95/>7.4 抽象类和方法</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/7.%E5%A4%9A%E6%80%81%E6%80%A7/7.5-%E6%8E%A5%E5%8F%A3/>7.5 接口</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/7.%E5%A4%9A%E6%80%81%E6%80%A7/7.6-%E5%86%85%E9%83%A8%E7%B1%BB/>7.6 内部类</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/7.%E5%A4%9A%E6%80%81%E6%80%A7/7.7-%E6%9E%84%E9%80%A0%E5%99%A8%E5%92%8C%E5%A4%9A%E6%80%81%E6%80%A7/>7.7 构造器和多态性</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/7.%E5%A4%9A%E6%80%81%E6%80%A7/7.8-%E9%80%9A%E8%BF%87%E7%BB%A7%E6%89%BF%E8%BF%9B%E8%A1%8C%E8%AE%BE%E8%AE%A1/>7.8 通过继承进行设计</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/7.%E5%A4%9A%E6%80%81%E6%80%A7/7.9-%E6%80%BB%E7%BB%93/>7.9 总结</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-ide8fec1c6956e847a0af483b3edf921cd")' href=#ide8fec1c6956e847a0af483b3edf921cd aria-expanded=false aria-controls=ide8fec1c6956e847a0af483b3edf921cd aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/8.%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%AE%B9%E7%BA%B3/>8.对象的容纳</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#ide8fec1c6956e847a0af483b3edf921cd aria-expanded=false aria-controls=ide8fec1c6956e847a0af483b3edf921cd><i class="fa-solid fa-angle-right" id=caret-ide8fec1c6956e847a0af483b3edf921cd></i></a></div><ul class="nav docs-sidenav collapse" id=ide8fec1c6956e847a0af483b3edf921cd><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/8.%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%AE%B9%E7%BA%B3/8.1-%E6%95%B0%E7%BB%84/>8.1 数组</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/8.%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%AE%B9%E7%BA%B3/8.2-%E9%9B%86%E5%90%88/>8.2 集合</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/8.%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%AE%B9%E7%BA%B3/8.3-%E8%BF%AD%E4%BB%A3%E5%99%A8/>8.3 迭代器</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/8.%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%AE%B9%E7%BA%B3/8.4-%E9%9B%86%E5%90%88%E7%9A%84%E7%B1%BB%E5%9E%8B/>8.4 集合的类型</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/8.%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%AE%B9%E7%BA%B3/8.5-%E6%8E%92%E5%BA%8F/>8.5 排序</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/8.%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%AE%B9%E7%BA%B3/8.6-%E9%80%9A%E7%94%A8%E9%9B%86%E5%90%88%E5%BA%93/>8.6 通用集合库</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/8.%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%AE%B9%E7%BA%B3/8.7-%E6%96%B0%E9%9B%86%E5%90%88/>8.7 新集合</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/8.%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%AE%B9%E7%BA%B3/8.8-%E6%80%BB%E7%BB%93/>8.8 总结</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/8.%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%AE%B9%E7%BA%B3/8.9-%E7%BB%83%E4%B9%A0/>8.9 练习</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-id24b0f4bf6b1849b1d34cc1cf59d9a598")' href=#id24b0f4bf6b1849b1d34cc1cf59d9a598 aria-expanded=false aria-controls=id24b0f4bf6b1849b1d34cc1cf59d9a598 aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/9.%E5%BC%82%E5%B8%B8%E5%B7%AE%E9%94%99%E6%8E%A7%E5%88%B6/>9.异常差错控制</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#id24b0f4bf6b1849b1d34cc1cf59d9a598 aria-expanded=false aria-controls=id24b0f4bf6b1849b1d34cc1cf59d9a598><i class="fa-solid fa-angle-right" id=caret-id24b0f4bf6b1849b1d34cc1cf59d9a598></i></a></div><ul class="nav docs-sidenav collapse" id=id24b0f4bf6b1849b1d34cc1cf59d9a598><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/9.%E5%BC%82%E5%B8%B8%E5%B7%AE%E9%94%99%E6%8E%A7%E5%88%B6/9.10-%E7%BB%83%E4%B9%A0/>9.10 练习</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/9.%E5%BC%82%E5%B8%B8%E5%B7%AE%E9%94%99%E6%8E%A7%E5%88%B6/9.6-%E7%94%A8finally%E6%B8%85%E9%99%A4/>9.6 用finally清除</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/9.%E5%BC%82%E5%B8%B8%E5%B7%AE%E9%94%99%E6%8E%A7%E5%88%B6/9.7-%E6%9E%84%E9%80%A0%E5%99%A8/>9.7 构造器</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/9.%E5%BC%82%E5%B8%B8%E5%B7%AE%E9%94%99%E6%8E%A7%E5%88%B6/9.9-%E6%80%BB%E7%BB%93/>9.9 总结</a></li></ul></div><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/%E9%99%84%E5%BD%95a-%E4%BD%BF%E7%94%A8%E9%9D%9Ejava%E4%BB%A3%E7%A0%81/>附录A 使用非JAVA代码</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/%E9%99%84%E5%BD%95b-%E5%AF%B9%E6%AF%94c++%E5%92%8Cjava/>附录B 对比C++和Java</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/%E9%99%84%E5%BD%95c-java%E7%BC%96%E7%A8%8B%E8%A7%84%E5%88%99/>附录C Java编程规则</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/%E9%99%84%E5%BD%95d-%E6%80%A7%E8%83%BD/>附录D 性能</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/%E9%99%84%E5%BD%95e-%E5%85%B3%E4%BA%8E%E5%9E%83%E5%9C%BE%E6%94%B6%E9%9B%86%E7%9A%84%E4%B8%80%E4%BA%9B%E8%AF%9D/>附录E 关于垃圾收集的一些话</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/%E9%99%84%E5%BD%95f-%E6%8E%A8%E8%8D%90%E8%AF%BB%E7%89%A9/>附录F 推荐读物</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/%E5%86%99%E5%9C%A8%E5%89%8D%E9%9D%A2%E7%9A%84%E8%AF%9D/>写在前面的话</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/%E5%BC%95%E8%A8%80/>引言</a></li></ul></div></ul></div></nav></div><div class="d-none d-xl-block col-xl-2 docs-toc"><ul class="nav toc-top"><li><a href=# id=back_to_top class=docs-toc-title>目录</a></li></ul><nav id=TableOfContents><ul><li><a href=#文件和目录路径>文件和目录路径</a><ul><li><a href=#选取路径部分片段>选取路径部分片段</a></li><li><a href=#路径分析>路径分析</a></li><li><a href=#paths的增减修改><strong>Paths</strong>的增减修改</a></li></ul></li><li><a href=#目录>目录</a></li><li><a href=#文件系统>文件系统</a></li><li><a href=#路径监听>路径监听</a></li><li><a href=#文件查找>文件查找</a></li><li><a href=#文件读写>文件读写</a></li><li><a href=#本章小结>本章小结</a></li></ul></nav><div class="subscribe-module col-24 mt-1"><img src=https://ngte-superbed.oss-cn-beijing.aliyuncs.com/item/20230220172727.png alt=image title=王下邀月熊的微信公众号></div></div><main class="py-md-3 pl-md-3 docs-content col-xl-8" role=main><article class=article><h1>17-Files</h1><div class=article-style><h1 id=第十七章-文件>第十七章 文件</h1><blockquote><p>在丑陋的 Java I/O 编程方式诞生多年以后，Java 终于简化了文件读写的基本操作。</p></blockquote><p>这种"困难方式"的全部细节都在 <a href=./Appendix-IO-Streams.md>Appendix: I/O Streams</a>。如果你读过这个部分，就会认同 Java 设计者毫不在意他们的使用者的体验这一观念。打开并读取文件对于大多数编程语言来说是非常常用的，由于 I/O 糟糕的设计以至于
很少有人能够在不依赖其他参考代码的情况下完成打开文件的操作。</p><p>好像 Java 设计者终于意识到了 Java 使用者多年来的痛苦，在 Java7 中对此引入了巨大的改进。这些新元素被放在 <strong>java.nio.file</strong> 包下面，过去人们通常把 <strong>nio</strong> 中的 <strong>n</strong> 理解为 <strong>new</strong> 即新的 <strong>io</strong>，现在更应该当成是 <strong>non-blocking</strong> 非阻塞 <strong>io</strong>(<strong>io</strong>就是<em>input/output 输入/输出</em>)。<strong>java.nio.file</strong> 库终于将 Java 文件操作带到与其他编程语言相同的水平。最重要的是 Java8 新增的 streams 与文件结合使得文件操作编程变得更加优雅。我们将看一下文件操作的两个基本组件：</p><ol><li>文件或者目录的路径；</li><li>文件本身。</li></ol><h2 id=文件和目录路径>文件和目录路径</h2><p>一个 <strong>Path</strong> 对象表示一个文件或者目录的路径，是一个跨操作系统（OS）和文件系统的抽象，目的是在构造路径时不必关注底层操作系统，代码可以在不进行修改的情况下运行在不同的操作系统上。<strong>java.nio.file.Paths</strong> 类包含一个重载方法 <strong>static get()</strong>，该方法接受一系列 <strong>String</strong> 字符串或一个<em>统一资源标识符</em>(URI)作为参数，并且进行转换返回一个 <strong>Path</strong> 对象：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// files/PathInfo.java
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>import</span> <span class=nn>java.nio.file.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>java.net.URI</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>java.io.File</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>java.io.IOException</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>PathInfo</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>static</span> <span class=kt>void</span> <span class=nf>show</span><span class=o>(</span><span class=n>String</span> <span class=n>id</span><span class=o>,</span> <span class=n>Object</span> <span class=n>p</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>id</span> <span class=o>+</span> <span class=s>&#34;: &#34;</span> <span class=o>+</span> <span class=n>p</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>static</span> <span class=kt>void</span> <span class=nf>info</span><span class=o>(</span><span class=n>Path</span> <span class=n>p</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>show</span><span class=o>(</span><span class=s>&#34;toString&#34;</span><span class=o>,</span> <span class=n>p</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>show</span><span class=o>(</span><span class=s>&#34;Exists&#34;</span><span class=o>,</span> <span class=n>Files</span><span class=o>.</span><span class=na>exists</span><span class=o>(</span><span class=n>p</span><span class=o>));</span>
</span></span><span class=line><span class=cl>        <span class=n>show</span><span class=o>(</span><span class=s>&#34;RegularFile&#34;</span><span class=o>,</span> <span class=n>Files</span><span class=o>.</span><span class=na>isRegularFile</span><span class=o>(</span><span class=n>p</span><span class=o>));</span>
</span></span><span class=line><span class=cl>        <span class=n>show</span><span class=o>(</span><span class=s>&#34;Directory&#34;</span><span class=o>,</span> <span class=n>Files</span><span class=o>.</span><span class=na>isDirectory</span><span class=o>(</span><span class=n>p</span><span class=o>));</span>
</span></span><span class=line><span class=cl>        <span class=n>show</span><span class=o>(</span><span class=s>&#34;Absolute&#34;</span><span class=o>,</span> <span class=n>p</span><span class=o>.</span><span class=na>isAbsolute</span><span class=o>());</span>
</span></span><span class=line><span class=cl>        <span class=n>show</span><span class=o>(</span><span class=s>&#34;FileName&#34;</span><span class=o>,</span> <span class=n>p</span><span class=o>.</span><span class=na>getFileName</span><span class=o>());</span>
</span></span><span class=line><span class=cl>        <span class=n>show</span><span class=o>(</span><span class=s>&#34;Parent&#34;</span><span class=o>,</span> <span class=n>p</span><span class=o>.</span><span class=na>getParent</span><span class=o>());</span>
</span></span><span class=line><span class=cl>        <span class=n>show</span><span class=o>(</span><span class=s>&#34;Root&#34;</span><span class=o>,</span> <span class=n>p</span><span class=o>.</span><span class=na>getRoot</span><span class=o>());</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;******************&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>System</span><span class=o>.</span><span class=na>getProperty</span><span class=o>(</span><span class=s>&#34;os.name&#34;</span><span class=o>));</span>
</span></span><span class=line><span class=cl>        <span class=n>info</span><span class=o>(</span><span class=n>Paths</span><span class=o>.</span><span class=na>get</span><span class=o>(</span><span class=s>&#34;C:&#34;</span><span class=o>,</span> <span class=s>&#34;path&#34;</span><span class=o>,</span> <span class=s>&#34;to&#34;</span><span class=o>,</span> <span class=s>&#34;nowhere&#34;</span><span class=o>,</span> <span class=s>&#34;NoFile.txt&#34;</span><span class=o>));</span>
</span></span><span class=line><span class=cl>        <span class=n>Path</span> <span class=n>p</span> <span class=o>=</span> <span class=n>Paths</span><span class=o>.</span><span class=na>get</span><span class=o>(</span><span class=s>&#34;PathInfo.java&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>info</span><span class=o>(</span><span class=n>p</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>Path</span> <span class=n>ap</span> <span class=o>=</span> <span class=n>p</span><span class=o>.</span><span class=na>toAbsolutePath</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=n>info</span><span class=o>(</span><span class=n>ap</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>info</span><span class=o>(</span><span class=n>ap</span><span class=o>.</span><span class=na>getParent</span><span class=o>());</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=n>info</span><span class=o>(</span><span class=n>p</span><span class=o>.</span><span class=na>toRealPath</span><span class=o>());</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span> <span class=k>catch</span><span class=o>(</span><span class=n>IOException</span> <span class=n>e</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>           <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>e</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=n>URI</span> <span class=n>u</span> <span class=o>=</span> <span class=n>p</span><span class=o>.</span><span class=na>toUri</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;URI: &#34;</span> <span class=o>+</span> <span class=n>u</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>Path</span> <span class=n>puri</span> <span class=o>=</span> <span class=n>Paths</span><span class=o>.</span><span class=na>get</span><span class=o>(</span><span class=n>u</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>Files</span><span class=o>.</span><span class=na>exists</span><span class=o>(</span><span class=n>puri</span><span class=o>));</span>
</span></span><span class=line><span class=cl>        <span class=n>File</span> <span class=n>f</span> <span class=o>=</span> <span class=n>ap</span><span class=o>.</span><span class=na>toFile</span><span class=o>();</span> <span class=c1>// Don&#39;t be fooled
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=cm>/* 输出:
</span></span></span><span class=line><span class=cl><span class=cm>Windows 10
</span></span></span><span class=line><span class=cl><span class=cm>toString: C:\path\to\nowhere\NoFile.txt
</span></span></span><span class=line><span class=cl><span class=cm>Exists: false
</span></span></span><span class=line><span class=cl><span class=cm>RegularFile: false
</span></span></span><span class=line><span class=cl><span class=cm>Directory: false
</span></span></span><span class=line><span class=cl><span class=cm>Absolute: true
</span></span></span><span class=line><span class=cl><span class=cm>FileName: NoFile.txt
</span></span></span><span class=line><span class=cl><span class=cm>Parent: C:\path\to\nowhere
</span></span></span><span class=line><span class=cl><span class=cm>Root: C:\
</span></span></span><span class=line><span class=cl><span class=cm>******************
</span></span></span><span class=line><span class=cl><span class=cm>toString: PathInfo.java
</span></span></span><span class=line><span class=cl><span class=cm>Exists: true
</span></span></span><span class=line><span class=cl><span class=cm>RegularFile: true
</span></span></span><span class=line><span class=cl><span class=cm>Directory: false
</span></span></span><span class=line><span class=cl><span class=cm>Absolute: false
</span></span></span><span class=line><span class=cl><span class=cm>FileName: PathInfo.java
</span></span></span><span class=line><span class=cl><span class=cm>Parent: null
</span></span></span><span class=line><span class=cl><span class=cm>Root: null
</span></span></span><span class=line><span class=cl><span class=cm>******************
</span></span></span><span class=line><span class=cl><span class=cm>toString: C:\Users\Bruce\Documents\GitHub\onjava\
</span></span></span><span class=line><span class=cl><span class=cm>ExtractedExamples\files\PathInfo.java
</span></span></span><span class=line><span class=cl><span class=cm>Exists: true
</span></span></span><span class=line><span class=cl><span class=cm>RegularFile: true
</span></span></span><span class=line><span class=cl><span class=cm>Directory: false
</span></span></span><span class=line><span class=cl><span class=cm>Absolute: true
</span></span></span><span class=line><span class=cl><span class=cm>FileName: PathInfo.java
</span></span></span><span class=line><span class=cl><span class=cm>Parent: C:\Users\Bruce\Documents\GitHub\onjava\
</span></span></span><span class=line><span class=cl><span class=cm>ExtractedExamples\files
</span></span></span><span class=line><span class=cl><span class=cm>Root: C:\
</span></span></span><span class=line><span class=cl><span class=cm>******************
</span></span></span><span class=line><span class=cl><span class=cm>toString: C:\Users\Bruce\Documents\GitHub\onjava\
</span></span></span><span class=line><span class=cl><span class=cm>ExtractedExamples\files
</span></span></span><span class=line><span class=cl><span class=cm>Exists: true
</span></span></span><span class=line><span class=cl><span class=cm>RegularFile: false
</span></span></span><span class=line><span class=cl><span class=cm>Directory: true
</span></span></span><span class=line><span class=cl><span class=cm>Absolute: true
</span></span></span><span class=line><span class=cl><span class=cm>FileName: files
</span></span></span><span class=line><span class=cl><span class=cm>Parent: C:\Users\Bruce\Documents\GitHub\onjava\
</span></span></span><span class=line><span class=cl><span class=cm>ExtractedExamples
</span></span></span><span class=line><span class=cl><span class=cm>Root: C:\
</span></span></span><span class=line><span class=cl><span class=cm>******************
</span></span></span><span class=line><span class=cl><span class=cm>toString: C:\Users\Bruce\Documents\GitHub\onjava\
</span></span></span><span class=line><span class=cl><span class=cm>ExtractedExamples\files\PathInfo.java
</span></span></span><span class=line><span class=cl><span class=cm>Exists: true
</span></span></span><span class=line><span class=cl><span class=cm>RegularFile: true
</span></span></span><span class=line><span class=cl><span class=cm>Directory: false
</span></span></span><span class=line><span class=cl><span class=cm>Absolute: true
</span></span></span><span class=line><span class=cl><span class=cm>FileName: PathInfo.java
</span></span></span><span class=line><span class=cl><span class=cm>Parent: C:\Users\Bruce\Documents\GitHub\onjava\
</span></span></span><span class=line><span class=cl><span class=cm>ExtractedExamples\files
</span></span></span><span class=line><span class=cl><span class=cm>Root: C:\
</span></span></span><span class=line><span class=cl><span class=cm>******************
</span></span></span><span class=line><span class=cl><span class=cm>URI: file:///C:/Users/Bruce/Documents/GitHub/onjava/
</span></span></span><span class=line><span class=cl><span class=cm>ExtractedExamples/files/PathInfo.java
</span></span></span><span class=line><span class=cl><span class=cm>true
</span></span></span><span class=line><span class=cl><span class=cm>*/</span>
</span></span></code></pre></div><p>我已经在这一章第一个程序的 <strong>main()</strong> 方法添加了第一行用于展示操作系统的名称，因此你可以看到不同操作系统之间存在哪些差异。理想情况下，差别会相对较小，并且使用 <strong>/</strong> 或者 <strong>\</strong> 路径分隔符进行分隔。你可以看到我运行在 Windows 10 上的程序输出。</p><p>当 <strong>toString()</strong> 方法生成完整形式的路径，你可以看到 <strong>getFileName()</strong> 方法总是返回当前文件名。
通过使用 <strong>Files</strong> 工具类(我们接下来将会更多地使用它)，可以测试一个文件是否存在，测试是否是一个"普通"文件还是一个目录等等。&ldquo;Nofile.txt"这个示例展示我们描述的文件可能并不在指定的位置；这样可以允许你创建一个新的路径。&ldquo;PathInfo.java"存在于当前目录中，最初它只是没有路径的文件名，但它仍然被检测为"存在&rdquo;。一旦我们将其转换为绝对路径，我们将会得到一个从"C:&ldquo;盘(因为我们是在 Windows 机器下进行测试)开始的完整路径，现在它也拥有一个父路径。“真实”路径的定义在文档中有点模糊，因为它取决于具体的文件系统。例如，如果文件名不区分大小写，即使路径由于大小写的缘故而不是完全相同，也可能得到肯定的匹配结果。在这样的平台上，<strong>toRealPath()</strong> 将返回实际情况下的 <strong>Path</strong>，并且还会删除任何冗余元素。</p><p>这里你会看到 <strong>URI</strong> 看起来只能用于描述文件，实际上 <strong>URI</strong> 可以用于描述更多的东西；通过 <a href=https://en.wikipedia.org/wiki/Uniform_Resource_Identifier target=_blank rel=noopener>维基百科</a> 可以了解更多细节。现在我们成功地将 <strong>URI</strong> 转为一个 <strong>Path</strong> 对象。</p><p>最后，你会在 <strong>Path</strong> 中看到一些有点欺骗的东西，这就是调用 <strong>toFile()</strong> 方法会生成一个 <strong>File</strong> 对象。听起来似乎可以得到一个类似文件的东西(毕竟被称为 <strong>File</strong> )，但是这个方法的存在仅仅是为了向后兼容。虽然看上去应该被称为"路径&rdquo;，实际上却应该表示目录或者文件本身。这是个非常草率并且令人困惑的命名，但是由于 <strong>java.nio.file</strong> 的存在我们可以安全地忽略它的存在。</p><h3 id=选取路径部分片段>选取路径部分片段</h3><p><strong>Path</strong> 对象可以非常容易地生成路径的某一部分：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// files/PartsOfPaths.java
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>import</span> <span class=nn>java.nio.file.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>PartsOfPaths</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>System</span><span class=o>.</span><span class=na>getProperty</span><span class=o>(</span><span class=s>&#34;os.name&#34;</span><span class=o>));</span>
</span></span><span class=line><span class=cl>        <span class=n>Path</span> <span class=n>p</span> <span class=o>=</span> <span class=n>Paths</span><span class=o>.</span><span class=na>get</span><span class=o>(</span><span class=s>&#34;PartsOfPaths.java&#34;</span><span class=o>).</span><span class=na>toAbsolutePath</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span><span class=o>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=o>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>p</span><span class=o>.</span><span class=na>getNameCount</span><span class=o>();</span> <span class=n>i</span><span class=o>++)</span>
</span></span><span class=line><span class=cl>            <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>p</span><span class=o>.</span><span class=na>getName</span><span class=o>(</span><span class=n>i</span><span class=o>));</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;ends with &#39;.java&#39;: &#34;</span> <span class=o>+</span>
</span></span><span class=line><span class=cl>        <span class=n>p</span><span class=o>.</span><span class=na>endsWith</span><span class=o>(</span><span class=s>&#34;.java&#34;</span><span class=o>));</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span><span class=o>(</span><span class=n>Path</span> <span class=n>pp</span> <span class=o>:</span> <span class=n>p</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>print</span><span class=o>(</span><span class=n>pp</span> <span class=o>+</span> <span class=s>&#34;: &#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>            <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>print</span><span class=o>(</span><span class=n>p</span><span class=o>.</span><span class=na>startsWith</span><span class=o>(</span><span class=n>pp</span><span class=o>)</span> <span class=o>+</span> <span class=s>&#34; : &#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>            <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>p</span><span class=o>.</span><span class=na>endsWith</span><span class=o>(</span><span class=n>pp</span><span class=o>));</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;Starts with &#34;</span> <span class=o>+</span> <span class=n>p</span><span class=o>.</span><span class=na>getRoot</span><span class=o>()</span> <span class=o>+</span> <span class=s>&#34; &#34;</span> <span class=o>+</span> <span class=n>p</span><span class=o>.</span><span class=na>startsWith</span><span class=o>(</span><span class=n>p</span><span class=o>.</span><span class=na>getRoot</span><span class=o>()));</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=cm>/* 输出:
</span></span></span><span class=line><span class=cl><span class=cm>Windows 10
</span></span></span><span class=line><span class=cl><span class=cm>Users
</span></span></span><span class=line><span class=cl><span class=cm>Bruce
</span></span></span><span class=line><span class=cl><span class=cm>Documents
</span></span></span><span class=line><span class=cl><span class=cm>GitHub
</span></span></span><span class=line><span class=cl><span class=cm>on-java
</span></span></span><span class=line><span class=cl><span class=cm>ExtractedExamples
</span></span></span><span class=line><span class=cl><span class=cm>files
</span></span></span><span class=line><span class=cl><span class=cm>PartsOfPaths.java
</span></span></span><span class=line><span class=cl><span class=cm>ends with &#39;.java&#39;: false
</span></span></span><span class=line><span class=cl><span class=cm>Users: false : false
</span></span></span><span class=line><span class=cl><span class=cm>Bruce: false : false
</span></span></span><span class=line><span class=cl><span class=cm>Documents: false : false
</span></span></span><span class=line><span class=cl><span class=cm>GitHub: false : false
</span></span></span><span class=line><span class=cl><span class=cm>on-java: false : false
</span></span></span><span class=line><span class=cl><span class=cm>ExtractedExamples: false : false
</span></span></span><span class=line><span class=cl><span class=cm>files: false : false
</span></span></span><span class=line><span class=cl><span class=cm>PartsOfPaths.java: false : true
</span></span></span><span class=line><span class=cl><span class=cm>Starts with C:\ true
</span></span></span><span class=line><span class=cl><span class=cm>*/</span>
</span></span></code></pre></div><p>可以通过 <strong>getName()</strong> 来索引 <strong>Path</strong> 的各个部分，直到达到上限 <strong>getNameCount()</strong>。<strong>Path</strong> 也实现了 <strong>Iterable</strong> 接口，因此我们也可以通过增强的 for-each 进行遍历。请注意，即使路径以 <strong>.java</strong> 结尾，使用 <strong>endsWith()</strong> 方法也会返回 <strong>false</strong>。这是因为使用 <strong>endsWith()</strong> 比较的是整个路径部分，而不会包含文件路径的后缀。通过使用 <strong>startsWith()</strong> 和 <strong>endsWith()</strong> 也可以完成路径的遍历。但是我们可以看到，遍历 <strong>Path</strong> 对象并不包含根路径，只有使用 <strong>startsWith()</strong> 检测根路径时才会返回 <strong>true</strong>。</p><h3 id=路径分析>路径分析</h3><p><strong>Files</strong> 工具类包含一系列完整的方法用于获得 <strong>Path</strong> 相关的信息。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// files/PathAnalysis.java
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>import</span> <span class=nn>java.nio.file.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>java.io.IOException</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>PathAnalysis</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>static</span> <span class=kt>void</span> <span class=nf>say</span><span class=o>(</span><span class=n>String</span> <span class=n>id</span><span class=o>,</span> <span class=n>Object</span> <span class=n>result</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>print</span><span class=o>(</span><span class=n>id</span> <span class=o>+</span> <span class=s>&#34;: &#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>result</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=kd>throws</span> <span class=n>IOException</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>System</span><span class=o>.</span><span class=na>getProperty</span><span class=o>(</span><span class=s>&#34;os.name&#34;</span><span class=o>));</span>
</span></span><span class=line><span class=cl>        <span class=n>Path</span> <span class=n>p</span> <span class=o>=</span> <span class=n>Paths</span><span class=o>.</span><span class=na>get</span><span class=o>(</span><span class=s>&#34;PathAnalysis.java&#34;</span><span class=o>).</span><span class=na>toAbsolutePath</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=n>say</span><span class=o>(</span><span class=s>&#34;Exists&#34;</span><span class=o>,</span> <span class=n>Files</span><span class=o>.</span><span class=na>exists</span><span class=o>(</span><span class=n>p</span><span class=o>));</span>
</span></span><span class=line><span class=cl>        <span class=n>say</span><span class=o>(</span><span class=s>&#34;Directory&#34;</span><span class=o>,</span> <span class=n>Files</span><span class=o>.</span><span class=na>isDirectory</span><span class=o>(</span><span class=n>p</span><span class=o>));</span>
</span></span><span class=line><span class=cl>        <span class=n>say</span><span class=o>(</span><span class=s>&#34;Executable&#34;</span><span class=o>,</span> <span class=n>Files</span><span class=o>.</span><span class=na>isExecutable</span><span class=o>(</span><span class=n>p</span><span class=o>));</span>
</span></span><span class=line><span class=cl>        <span class=n>say</span><span class=o>(</span><span class=s>&#34;Readable&#34;</span><span class=o>,</span> <span class=n>Files</span><span class=o>.</span><span class=na>isReadable</span><span class=o>(</span><span class=n>p</span><span class=o>));</span>
</span></span><span class=line><span class=cl>        <span class=n>say</span><span class=o>(</span><span class=s>&#34;RegularFile&#34;</span><span class=o>,</span> <span class=n>Files</span><span class=o>.</span><span class=na>isRegularFile</span><span class=o>(</span><span class=n>p</span><span class=o>));</span>
</span></span><span class=line><span class=cl>        <span class=n>say</span><span class=o>(</span><span class=s>&#34;Writable&#34;</span><span class=o>,</span> <span class=n>Files</span><span class=o>.</span><span class=na>isWritable</span><span class=o>(</span><span class=n>p</span><span class=o>));</span>
</span></span><span class=line><span class=cl>        <span class=n>say</span><span class=o>(</span><span class=s>&#34;notExists&#34;</span><span class=o>,</span> <span class=n>Files</span><span class=o>.</span><span class=na>notExists</span><span class=o>(</span><span class=n>p</span><span class=o>));</span>
</span></span><span class=line><span class=cl>        <span class=n>say</span><span class=o>(</span><span class=s>&#34;Hidden&#34;</span><span class=o>,</span> <span class=n>Files</span><span class=o>.</span><span class=na>isHidden</span><span class=o>(</span><span class=n>p</span><span class=o>));</span>
</span></span><span class=line><span class=cl>        <span class=n>say</span><span class=o>(</span><span class=s>&#34;size&#34;</span><span class=o>,</span> <span class=n>Files</span><span class=o>.</span><span class=na>size</span><span class=o>(</span><span class=n>p</span><span class=o>));</span>
</span></span><span class=line><span class=cl>        <span class=n>say</span><span class=o>(</span><span class=s>&#34;FileStore&#34;</span><span class=o>,</span> <span class=n>Files</span><span class=o>.</span><span class=na>getFileStore</span><span class=o>(</span><span class=n>p</span><span class=o>));</span>
</span></span><span class=line><span class=cl>        <span class=n>say</span><span class=o>(</span><span class=s>&#34;LastModified: &#34;</span><span class=o>,</span> <span class=n>Files</span><span class=o>.</span><span class=na>getLastModifiedTime</span><span class=o>(</span><span class=n>p</span><span class=o>));</span>
</span></span><span class=line><span class=cl>        <span class=n>say</span><span class=o>(</span><span class=s>&#34;Owner&#34;</span><span class=o>,</span> <span class=n>Files</span><span class=o>.</span><span class=na>getOwner</span><span class=o>(</span><span class=n>p</span><span class=o>));</span>
</span></span><span class=line><span class=cl>        <span class=n>say</span><span class=o>(</span><span class=s>&#34;ContentType&#34;</span><span class=o>,</span> <span class=n>Files</span><span class=o>.</span><span class=na>probeContentType</span><span class=o>(</span><span class=n>p</span><span class=o>));</span>
</span></span><span class=line><span class=cl>        <span class=n>say</span><span class=o>(</span><span class=s>&#34;SymbolicLink&#34;</span><span class=o>,</span> <span class=n>Files</span><span class=o>.</span><span class=na>isSymbolicLink</span><span class=o>(</span><span class=n>p</span><span class=o>));</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span><span class=o>(</span><span class=n>Files</span><span class=o>.</span><span class=na>isSymbolicLink</span><span class=o>(</span><span class=n>p</span><span class=o>))</span>
</span></span><span class=line><span class=cl>            <span class=n>say</span><span class=o>(</span><span class=s>&#34;SymbolicLink&#34;</span><span class=o>,</span> <span class=n>Files</span><span class=o>.</span><span class=na>readSymbolicLink</span><span class=o>(</span><span class=n>p</span><span class=o>));</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span><span class=o>(</span><span class=n>FileSystems</span><span class=o>.</span><span class=na>getDefault</span><span class=o>().</span><span class=na>supportedFileAttributeViews</span><span class=o>().</span><span class=na>contains</span><span class=o>(</span><span class=s>&#34;posix&#34;</span><span class=o>))</span>
</span></span><span class=line><span class=cl>            <span class=n>say</span><span class=o>(</span><span class=s>&#34;PosixFilePermissions&#34;</span><span class=o>,</span>
</span></span><span class=line><span class=cl>        <span class=n>Files</span><span class=o>.</span><span class=na>getPosixFilePermissions</span><span class=o>(</span><span class=n>p</span><span class=o>));</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=cm>/* 输出:
</span></span></span><span class=line><span class=cl><span class=cm>Windows 10
</span></span></span><span class=line><span class=cl><span class=cm>Exists: true
</span></span></span><span class=line><span class=cl><span class=cm>Directory: false
</span></span></span><span class=line><span class=cl><span class=cm>Executable: true
</span></span></span><span class=line><span class=cl><span class=cm>Readable: true
</span></span></span><span class=line><span class=cl><span class=cm>RegularFile: true
</span></span></span><span class=line><span class=cl><span class=cm>Writable: true
</span></span></span><span class=line><span class=cl><span class=cm>notExists: false
</span></span></span><span class=line><span class=cl><span class=cm>Hidden: false
</span></span></span><span class=line><span class=cl><span class=cm>size: 1631
</span></span></span><span class=line><span class=cl><span class=cm>FileStore: SSD (C:)
</span></span></span><span class=line><span class=cl><span class=cm>LastModified: : 2017-05-09T12:07:00.428366Z
</span></span></span><span class=line><span class=cl><span class=cm>Owner: MINDVIEWTOSHIBA\Bruce (User)
</span></span></span><span class=line><span class=cl><span class=cm>ContentType: null
</span></span></span><span class=line><span class=cl><span class=cm>SymbolicLink: false
</span></span></span><span class=line><span class=cl><span class=cm>*/</span>
</span></span></code></pre></div><p>在调用最后一个测试方法 <strong>getPosixFilePermissions()</strong> 之前我们需要确认一下当前文件系统是否支持 <strong>Posix</strong> 接口，否则会抛出运行时异常。</p><h3 id=paths的增减修改><strong>Paths</strong>的增减修改</h3><p>我们必须能通过对 <strong>Path</strong> 对象增加或者删除一部分来构造一个新的 <strong>Path</strong> 对象。我们使用 <strong>relativize()</strong> 移除 <strong>Path</strong> 的根路径，使用 <strong>resolve()</strong> 添加 <strong>Path</strong> 的尾路径(不一定是“可发现”的名称)。</p><p>对于下面代码中的示例，我使用 <strong>relativize()</strong> 方法从所有的输出中移除根路径，部分原因是为了示范，部分原因是为了简化输出结果，这说明你可以使用该方法将绝对路径转为相对路径。
这个版本的代码中包含 <strong>id</strong>，以便于跟踪输出结果：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// files/AddAndSubtractPaths.java
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>import</span> <span class=nn>java.nio.file.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>java.io.IOException</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>AddAndSubtractPaths</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>static</span> <span class=n>Path</span> <span class=n>base</span> <span class=o>=</span> <span class=n>Paths</span><span class=o>.</span><span class=na>get</span><span class=o>(</span><span class=s>&#34;..&#34;</span><span class=o>,</span> <span class=s>&#34;..&#34;</span><span class=o>,</span> <span class=s>&#34;..&#34;</span><span class=o>).</span><span class=na>toAbsolutePath</span><span class=o>().</span><span class=na>normalize</span><span class=o>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>static</span> <span class=kt>void</span> <span class=nf>show</span><span class=o>(</span><span class=kt>int</span> <span class=n>id</span><span class=o>,</span> <span class=n>Path</span> <span class=n>result</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span><span class=o>(</span><span class=n>result</span><span class=o>.</span><span class=na>isAbsolute</span><span class=o>())</span>
</span></span><span class=line><span class=cl>            <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;(&#34;</span> <span class=o>+</span> <span class=n>id</span> <span class=o>+</span> <span class=s>&#34;)r &#34;</span> <span class=o>+</span> <span class=n>base</span><span class=o>.</span><span class=na>relativize</span><span class=o>(</span><span class=n>result</span><span class=o>));</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span>
</span></span><span class=line><span class=cl>            <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;(&#34;</span> <span class=o>+</span> <span class=n>id</span> <span class=o>+</span> <span class=s>&#34;) &#34;</span> <span class=o>+</span> <span class=n>result</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;RealPath: &#34;</span> <span class=o>+</span> <span class=n>result</span><span class=o>.</span><span class=na>toRealPath</span><span class=o>());</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span> <span class=k>catch</span><span class=o>(</span><span class=n>IOException</span> <span class=n>e</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>e</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>System</span><span class=o>.</span><span class=na>getProperty</span><span class=o>(</span><span class=s>&#34;os.name&#34;</span><span class=o>));</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>base</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>Path</span> <span class=n>p</span> <span class=o>=</span> <span class=n>Paths</span><span class=o>.</span><span class=na>get</span><span class=o>(</span><span class=s>&#34;AddAndSubtractPaths.java&#34;</span><span class=o>).</span><span class=na>toAbsolutePath</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=n>show</span><span class=o>(</span><span class=mi>1</span><span class=o>,</span> <span class=n>p</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>Path</span> <span class=n>convoluted</span> <span class=o>=</span> <span class=n>p</span><span class=o>.</span><span class=na>getParent</span><span class=o>().</span><span class=na>getParent</span><span class=o>()</span>
</span></span><span class=line><span class=cl>        <span class=o>.</span><span class=na>resolve</span><span class=o>(</span><span class=s>&#34;strings&#34;</span><span class=o>).</span><span class=na>resolve</span><span class=o>(</span><span class=s>&#34;..&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl>        <span class=o>.</span><span class=na>resolve</span><span class=o>(</span><span class=n>p</span><span class=o>.</span><span class=na>getParent</span><span class=o>().</span><span class=na>getFileName</span><span class=o>());</span>
</span></span><span class=line><span class=cl>        <span class=n>show</span><span class=o>(</span><span class=mi>2</span><span class=o>,</span> <span class=n>convoluted</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>show</span><span class=o>(</span><span class=mi>3</span><span class=o>,</span> <span class=n>convoluted</span><span class=o>.</span><span class=na>normalize</span><span class=o>());</span>
</span></span><span class=line><span class=cl>        <span class=n>Path</span> <span class=n>p2</span> <span class=o>=</span> <span class=n>Paths</span><span class=o>.</span><span class=na>get</span><span class=o>(</span><span class=s>&#34;..&#34;</span><span class=o>,</span> <span class=s>&#34;..&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>show</span><span class=o>(</span><span class=mi>4</span><span class=o>,</span> <span class=n>p2</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>show</span><span class=o>(</span><span class=mi>5</span><span class=o>,</span> <span class=n>p2</span><span class=o>.</span><span class=na>normalize</span><span class=o>());</span>
</span></span><span class=line><span class=cl>        <span class=n>show</span><span class=o>(</span><span class=mi>6</span><span class=o>,</span> <span class=n>p2</span><span class=o>.</span><span class=na>toAbsolutePath</span><span class=o>().</span><span class=na>normalize</span><span class=o>());</span>
</span></span><span class=line><span class=cl>        <span class=n>Path</span> <span class=n>p3</span> <span class=o>=</span> <span class=n>Paths</span><span class=o>.</span><span class=na>get</span><span class=o>(</span><span class=s>&#34;.&#34;</span><span class=o>).</span><span class=na>toAbsolutePath</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=n>Path</span> <span class=n>p4</span> <span class=o>=</span> <span class=n>p3</span><span class=o>.</span><span class=na>resolve</span><span class=o>(</span><span class=n>p2</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>show</span><span class=o>(</span><span class=mi>7</span><span class=o>,</span> <span class=n>p4</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>show</span><span class=o>(</span><span class=mi>8</span><span class=o>,</span> <span class=n>p4</span><span class=o>.</span><span class=na>normalize</span><span class=o>());</span>
</span></span><span class=line><span class=cl>        <span class=n>Path</span> <span class=n>p5</span> <span class=o>=</span> <span class=n>Paths</span><span class=o>.</span><span class=na>get</span><span class=o>(</span><span class=s>&#34;&#34;</span><span class=o>).</span><span class=na>toAbsolutePath</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=n>show</span><span class=o>(</span><span class=mi>9</span><span class=o>,</span> <span class=n>p5</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>show</span><span class=o>(</span><span class=mi>10</span><span class=o>,</span> <span class=n>p5</span><span class=o>.</span><span class=na>resolveSibling</span><span class=o>(</span><span class=s>&#34;strings&#34;</span><span class=o>));</span>
</span></span><span class=line><span class=cl>        <span class=n>show</span><span class=o>(</span><span class=mi>11</span><span class=o>,</span> <span class=n>Paths</span><span class=o>.</span><span class=na>get</span><span class=o>(</span><span class=s>&#34;nonexistent&#34;</span><span class=o>));</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=cm>/* 输出:
</span></span></span><span class=line><span class=cl><span class=cm>Windows 10
</span></span></span><span class=line><span class=cl><span class=cm>C:\Users\Bruce\Documents\GitHub
</span></span></span><span class=line><span class=cl><span class=cm>(1)r onjava\
</span></span></span><span class=line><span class=cl><span class=cm>ExtractedExamples\files\AddAndSubtractPaths.java
</span></span></span><span class=line><span class=cl><span class=cm>RealPath: C:\Users\Bruce\Documents\GitHub\onjava\
</span></span></span><span class=line><span class=cl><span class=cm>ExtractedExamples\files\AddAndSubtractPaths.java
</span></span></span><span class=line><span class=cl><span class=cm>(2)r on-java\ExtractedExamples\strings\..\files
</span></span></span><span class=line><span class=cl><span class=cm>RealPath: C:\Users\Bruce\Documents\GitHub\onjava\
</span></span></span><span class=line><span class=cl><span class=cm>ExtractedExamples\files
</span></span></span><span class=line><span class=cl><span class=cm>(3)r on-java\ExtractedExamples\files
</span></span></span><span class=line><span class=cl><span class=cm>RealPath: C:\Users\Bruce\Documents\GitHub\onjava\
</span></span></span><span class=line><span class=cl><span class=cm>ExtractedExamples\files
</span></span></span><span class=line><span class=cl><span class=cm>(4) ..\..
</span></span></span><span class=line><span class=cl><span class=cm>RealPath: C:\Users\Bruce\Documents\GitHub\on-java
</span></span></span><span class=line><span class=cl><span class=cm>(5) ..\..
</span></span></span><span class=line><span class=cl><span class=cm>RealPath: C:\Users\Bruce\Documents\GitHub\on-java
</span></span></span><span class=line><span class=cl><span class=cm>(6)r on-java
</span></span></span><span class=line><span class=cl><span class=cm>RealPath: C:\Users\Bruce\Documents\GitHub\on-java
</span></span></span><span class=line><span class=cl><span class=cm>(7)r on-java\ExtractedExamples\files\.\..\..
</span></span></span><span class=line><span class=cl><span class=cm>RealPath: C:\Users\Bruce\Documents\GitHub\on-java
</span></span></span><span class=line><span class=cl><span class=cm>(8)r on-java
</span></span></span><span class=line><span class=cl><span class=cm>RealPath: C:\Users\Bruce\Documents\GitHub\on-java
</span></span></span><span class=line><span class=cl><span class=cm>(9)r on-java\ExtractedExamples\files
</span></span></span><span class=line><span class=cl><span class=cm>RealPath: C:\Users\Bruce\Documents\GitHub\onjava\
</span></span></span><span class=line><span class=cl><span class=cm>ExtractedExamples\files
</span></span></span><span class=line><span class=cl><span class=cm>(10)r on-java\ExtractedExamples\strings
</span></span></span><span class=line><span class=cl><span class=cm>RealPath: C:\Users\Bruce\Documents\GitHub\onjava\
</span></span></span><span class=line><span class=cl><span class=cm>ExtractedExamples\strings
</span></span></span><span class=line><span class=cl><span class=cm>(11) nonexistent
</span></span></span><span class=line><span class=cl><span class=cm>java.nio.file.NoSuchFileException:
</span></span></span><span class=line><span class=cl><span class=cm>C:\Users\Bruce\Documents\GitHub\onjava\
</span></span></span><span class=line><span class=cl><span class=cm>ExtractedExamples\files\nonexistent
</span></span></span><span class=line><span class=cl><span class=cm>*/</span>
</span></span></code></pre></div><p>我还为 <strong>toRealPath()</strong> 添加了更多的测试，这是为了扩展和规则化，防止路径不存在时抛出运行时异常。</p><h2 id=目录>目录</h2><p><strong>Files</strong> 工具类包含大部分我们需要的目录操作和文件操作方法。出于某种原因，它们没有包含删除目录树相关的方法，因此我们将实现并将其添加到 <strong>onjava</strong> 库中。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// onjava/RmDir.java
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>package</span> <span class=nn>onjava</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>java.nio.file.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>java.nio.file.attribute.BasicFileAttributes</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>java.io.IOException</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>RmDir</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>rmdir</span><span class=o>(</span><span class=n>Path</span> <span class=n>dir</span><span class=o>)</span> <span class=kd>throws</span> <span class=n>IOException</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>Files</span><span class=o>.</span><span class=na>walkFileTree</span><span class=o>(</span><span class=n>dir</span><span class=o>,</span> <span class=k>new</span> <span class=n>SimpleFileVisitor</span><span class=o>&lt;</span><span class=n>Path</span><span class=o>&gt;()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>            <span class=kd>public</span> <span class=n>FileVisitResult</span> <span class=nf>visitFile</span><span class=o>(</span><span class=n>Path</span> <span class=n>file</span><span class=o>,</span> <span class=n>BasicFileAttributes</span> <span class=n>attrs</span><span class=o>)</span> <span class=kd>throws</span> <span class=n>IOException</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                <span class=n>Files</span><span class=o>.</span><span class=na>delete</span><span class=o>(</span><span class=n>file</span><span class=o>);</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=n>FileVisitResult</span><span class=o>.</span><span class=na>CONTINUE</span><span class=o>;</span>
</span></span><span class=line><span class=cl>            <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>            <span class=kd>public</span> <span class=n>FileVisitResult</span> <span class=nf>postVisitDirectory</span><span class=o>(</span><span class=n>Path</span> <span class=n>dir</span><span class=o>,</span> <span class=n>IOException</span> <span class=n>exc</span><span class=o>)</span> <span class=kd>throws</span> <span class=n>IOException</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                <span class=n>Files</span><span class=o>.</span><span class=na>delete</span><span class=o>(</span><span class=n>dir</span><span class=o>);</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=n>FileVisitResult</span><span class=o>.</span><span class=na>CONTINUE</span><span class=o>;</span>
</span></span><span class=line><span class=cl>            <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=o>});</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>删除目录树的方法实现依赖于 <strong>Files.walkFileTree()</strong>，&ldquo;walking&rdquo; 目录树意味着遍历每个子目录和文件。<em>Visitor</em> 设计模式提供了一种标准机制来访问集合中的每个对象，然后你需要提供在每个对象上执行的操作。
此操作的定义取决于实现的 <strong>FileVisitor</strong> 的四个抽象方法，包括：</p><pre><code>1.  **preVisitDirectory()**：在访问目录中条目之前在目录上运行。
2.  **visitFile()**：运行目录中的每一个文件。
3.  **visitFileFailed()**：调用无法访问的文件。
4.  **postVisitDirectory()**：在访问目录中条目之后在目录上运行，包括所有的子目录。
</code></pre><p>为了简化，<strong>java.nio.file.SimpleFileVisitor</strong> 提供了所有方法的默认实现。这样，在我们的匿名内部类中，我们只需要重写非标准行为的方法：<strong>visitFile()</strong> 和 <strong>postVisitDirectory()</strong> 实现删除文件和删除目录。两者都应该返回标志位决定是否继续访问(这样就可以继续访问，直到找到所需要的)。
作为探索目录操作的一部分，现在我们可以有条件地删除已存在的目录。在以下例子中，<strong>makeVariant()</strong> 接受基本目录测试，并通过旋转部件列表生成不同的子目录路径。这些旋转与路径分隔符 <strong>sep</strong> 使用 <strong>String.join()</strong> 贴在一起，然后返回一个 <strong>Path</strong> 对象。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// files/Directories.java
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>import</span> <span class=nn>java.util.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>java.nio.file.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>onjava.RmDir</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>Directories</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>static</span> <span class=n>Path</span> <span class=n>test</span> <span class=o>=</span> <span class=n>Paths</span><span class=o>.</span><span class=na>get</span><span class=o>(</span><span class=s>&#34;test&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=kd>static</span> <span class=n>String</span> <span class=n>sep</span> <span class=o>=</span> <span class=n>FileSystems</span><span class=o>.</span><span class=na>getDefault</span><span class=o>().</span><span class=na>getSeparator</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=kd>static</span> <span class=n>List</span><span class=o>&lt;</span><span class=n>String</span><span class=o>&gt;</span> <span class=n>parts</span> <span class=o>=</span> <span class=n>Arrays</span><span class=o>.</span><span class=na>asList</span><span class=o>(</span><span class=s>&#34;foo&#34;</span><span class=o>,</span> <span class=s>&#34;bar&#34;</span><span class=o>,</span> <span class=s>&#34;baz&#34;</span><span class=o>,</span> <span class=s>&#34;bag&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>static</span> <span class=n>Path</span> <span class=nf>makeVariant</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>Collections</span><span class=o>.</span><span class=na>rotate</span><span class=o>(</span><span class=n>parts</span><span class=o>,</span> <span class=mi>1</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>Paths</span><span class=o>.</span><span class=na>get</span><span class=o>(</span><span class=s>&#34;test&#34;</span><span class=o>,</span> <span class=n>String</span><span class=o>.</span><span class=na>join</span><span class=o>(</span><span class=n>sep</span><span class=o>,</span> <span class=n>parts</span><span class=o>));</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>static</span> <span class=kt>void</span> <span class=nf>refreshTestDir</span><span class=o>()</span> <span class=kd>throws</span> <span class=n>Exception</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span><span class=o>(</span><span class=n>Files</span><span class=o>.</span><span class=na>exists</span><span class=o>(</span><span class=n>test</span><span class=o>))</span>
</span></span><span class=line><span class=cl>        <span class=n>RmDir</span><span class=o>.</span><span class=na>rmdir</span><span class=o>(</span><span class=n>test</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span><span class=o>(!</span><span class=n>Files</span><span class=o>.</span><span class=na>exists</span><span class=o>(</span><span class=n>test</span><span class=o>))</span>
</span></span><span class=line><span class=cl>        <span class=n>Files</span><span class=o>.</span><span class=na>createDirectory</span><span class=o>(</span><span class=n>test</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=kd>throws</span> <span class=n>Exception</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>refreshTestDir</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=n>Files</span><span class=o>.</span><span class=na>createFile</span><span class=o>(</span><span class=n>test</span><span class=o>.</span><span class=na>resolve</span><span class=o>(</span><span class=s>&#34;Hello.txt&#34;</span><span class=o>));</span>
</span></span><span class=line><span class=cl>        <span class=n>Path</span> <span class=n>variant</span> <span class=o>=</span> <span class=n>makeVariant</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=c1>// Throws exception (too many levels):
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>try</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=n>Files</span><span class=o>.</span><span class=na>createDirectory</span><span class=o>(</span><span class=n>variant</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span> <span class=k>catch</span><span class=o>(</span><span class=n>Exception</span> <span class=n>e</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;Nope, that doesn&#39;t work.&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=n>populateTestDir</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=n>Path</span> <span class=n>tempdir</span> <span class=o>=</span> <span class=n>Files</span><span class=o>.</span><span class=na>createTempDirectory</span><span class=o>(</span><span class=n>test</span><span class=o>,</span> <span class=s>&#34;DIR_&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>Files</span><span class=o>.</span><span class=na>createTempFile</span><span class=o>(</span><span class=n>tempdir</span><span class=o>,</span> <span class=s>&#34;pre&#34;</span><span class=o>,</span> <span class=s>&#34;.non&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>Files</span><span class=o>.</span><span class=na>newDirectoryStream</span><span class=o>(</span><span class=n>test</span><span class=o>).</span><span class=na>forEach</span><span class=o>(</span><span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>::</span><span class=n>println</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;*********&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>Files</span><span class=o>.</span><span class=na>walk</span><span class=o>(</span><span class=n>test</span><span class=o>).</span><span class=na>forEach</span><span class=o>(</span><span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>::</span><span class=n>println</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>static</span> <span class=kt>void</span> <span class=nf>populateTestDir</span><span class=o>()</span> <span class=kd>throws</span> <span class=n>Exception</span>  <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span><span class=o>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=o>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>parts</span><span class=o>.</span><span class=na>size</span><span class=o>();</span> <span class=n>i</span><span class=o>++)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=n>Path</span> <span class=n>variant</span> <span class=o>=</span> <span class=n>makeVariant</span><span class=o>();</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span><span class=o>(!</span><span class=n>Files</span><span class=o>.</span><span class=na>exists</span><span class=o>(</span><span class=n>variant</span><span class=o>))</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                <span class=n>Files</span><span class=o>.</span><span class=na>createDirectories</span><span class=o>(</span><span class=n>variant</span><span class=o>);</span>
</span></span><span class=line><span class=cl>                <span class=n>Files</span><span class=o>.</span><span class=na>copy</span><span class=o>(</span><span class=n>Paths</span><span class=o>.</span><span class=na>get</span><span class=o>(</span><span class=s>&#34;Directories.java&#34;</span><span class=o>),</span>
</span></span><span class=line><span class=cl>                    <span class=n>variant</span><span class=o>.</span><span class=na>resolve</span><span class=o>(</span><span class=s>&#34;File.txt&#34;</span><span class=o>));</span>
</span></span><span class=line><span class=cl>                <span class=n>Files</span><span class=o>.</span><span class=na>createTempFile</span><span class=o>(</span><span class=n>variant</span><span class=o>,</span> <span class=kc>null</span><span class=o>,</span> <span class=kc>null</span><span class=o>);</span>
</span></span><span class=line><span class=cl>            <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=cm>/* 输出:
</span></span></span><span class=line><span class=cl><span class=cm>Nope, that doesn&#39;t work.
</span></span></span><span class=line><span class=cl><span class=cm>test\bag
</span></span></span><span class=line><span class=cl><span class=cm>test\bar
</span></span></span><span class=line><span class=cl><span class=cm>test\baz
</span></span></span><span class=line><span class=cl><span class=cm>test\DIR_5142667942049986036
</span></span></span><span class=line><span class=cl><span class=cm>test\foo
</span></span></span><span class=line><span class=cl><span class=cm>test\Hello.txt
</span></span></span><span class=line><span class=cl><span class=cm>*********
</span></span></span><span class=line><span class=cl><span class=cm>test
</span></span></span><span class=line><span class=cl><span class=cm>test\bag
</span></span></span><span class=line><span class=cl><span class=cm>test\bag\foo
</span></span></span><span class=line><span class=cl><span class=cm>test\bag\foo\bar
</span></span></span><span class=line><span class=cl><span class=cm>test\bag\foo\bar\baz
</span></span></span><span class=line><span class=cl><span class=cm>test\bag\foo\bar\baz\8279660869874696036.tmp
</span></span></span><span class=line><span class=cl><span class=cm>test\bag\foo\bar\baz\File.txt
</span></span></span><span class=line><span class=cl><span class=cm>test\bar
</span></span></span><span class=line><span class=cl><span class=cm>test\bar\baz
</span></span></span><span class=line><span class=cl><span class=cm>test\bar\baz\bag
</span></span></span><span class=line><span class=cl><span class=cm>test\bar\baz\bag\foo
</span></span></span><span class=line><span class=cl><span class=cm>test\bar\baz\bag\foo\1274043134240426261.tmp
</span></span></span><span class=line><span class=cl><span class=cm>test\bar\baz\bag\foo\File.txt
</span></span></span><span class=line><span class=cl><span class=cm>test\baz
</span></span></span><span class=line><span class=cl><span class=cm>test\baz\bag
</span></span></span><span class=line><span class=cl><span class=cm>test\baz\bag\foo
</span></span></span><span class=line><span class=cl><span class=cm>test\baz\bag\foo\bar
</span></span></span><span class=line><span class=cl><span class=cm>test\baz\bag\foo\bar\6130572530014544105.tmp
</span></span></span><span class=line><span class=cl><span class=cm>test\baz\bag\foo\bar\File.txt
</span></span></span><span class=line><span class=cl><span class=cm>test\DIR_5142667942049986036
</span></span></span><span class=line><span class=cl><span class=cm>test\DIR_5142667942049986036\pre7704286843227113253.non
</span></span></span><span class=line><span class=cl><span class=cm>test\foo
</span></span></span><span class=line><span class=cl><span class=cm>test\foo\bar
</span></span></span><span class=line><span class=cl><span class=cm>test\foo\bar\baz
</span></span></span><span class=line><span class=cl><span class=cm>test\foo\bar\baz\bag
</span></span></span><span class=line><span class=cl><span class=cm>test\foo\bar\baz\bag\5412864507741775436.tmp
</span></span></span><span class=line><span class=cl><span class=cm>test\foo\bar\baz\bag\File.txt
</span></span></span><span class=line><span class=cl><span class=cm>test\Hello.txt
</span></span></span><span class=line><span class=cl><span class=cm>*/</span>
</span></span></code></pre></div><p>首先，<strong>refreshTestDir()</strong> 用于检测 <strong>test</strong> 目录是否已经存在。若存在，则使用我们新工具类 <strong>rmdir()</strong> 删除其整个目录。检查是否 <strong>exists</strong> 是多余的，但我想说明一点，因为如果你对于已经存在的目录调用 <strong>createDirectory()</strong> 将会抛出异常。<strong>createFile()</strong> 使用参数 <strong>Path</strong> 创建一个空文件; <strong>resolve()</strong> 将文件名添加到 <strong>test Path</strong> 的末尾。</p><p>我们尝试使用 <strong>createDirectory()</strong> 来创建多级路径，但是这样会抛出异常，因为这个方法只能创建单级路径。我已经将 <strong>populateTestDir()</strong> 作为一个单独的方法，因为它将在后面的例子中被重用。对于每一个变量 <strong>variant</strong>，我们都能使用 <strong>createDirectories()</strong> 创建完整的目录路径，然后使用此文件的副本以不同的目标名称填充该终端目录。然后我们使用 <strong>createTempFile()</strong> 生成一个临时文件。</p><p>在调用 <strong>populateTestDir()</strong> 之后，我们在 <strong>test</strong> 目录下面创建一个临时目录。请注意，<strong>createTempDirectory()</strong> 只有名称的前缀选项。与 <strong>createTempFile()</strong> 不同，我们再次使用它将临时文件放入新的临时目录中。你可以从输出中看到，如果未指定后缀，它将默认使用&rdquo;.tmp"作为后缀。</p><p>为了展示结果，我们首次使用看起来很有希望的 <strong>newDirectoryStream()</strong>，但事实证明这个方法只是返回 <strong>test</strong> 目录内容的 Stream 流，并没有更多的内容。要获取目录树的全部内容的流，请使用 <strong>Files.walk()</strong>。</p><h2 id=文件系统>文件系统</h2><p>为了完整起见，我们需要一种方法查找文件系统相关的其他信息。在这里，我们使用静态的 <strong>FileSystems</strong> 工具类获取"默认"的文件系统，但你同样也可以在 <strong>Path</strong> 对象上调用 <strong>getFileSystem()</strong> 以获取创建该 <strong>Path</strong> 的文件系统。你可以获得给定 <em>URI</em> 的文件系统，还可以构建新的文件系统(对于支持它的操作系统)。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// files/FileSystemDemo.java
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>import</span> <span class=nn>java.nio.file.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>FileSystemDemo</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>static</span> <span class=kt>void</span> <span class=nf>show</span><span class=o>(</span><span class=n>String</span> <span class=n>id</span><span class=o>,</span> <span class=n>Object</span> <span class=n>o</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>id</span> <span class=o>+</span> <span class=s>&#34;: &#34;</span> <span class=o>+</span> <span class=n>o</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>System</span><span class=o>.</span><span class=na>getProperty</span><span class=o>(</span><span class=s>&#34;os.name&#34;</span><span class=o>));</span>
</span></span><span class=line><span class=cl>        <span class=n>FileSystem</span> <span class=n>fsys</span> <span class=o>=</span> <span class=n>FileSystems</span><span class=o>.</span><span class=na>getDefault</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span><span class=o>(</span><span class=n>FileStore</span> <span class=n>fs</span> <span class=o>:</span> <span class=n>fsys</span><span class=o>.</span><span class=na>getFileStores</span><span class=o>())</span>
</span></span><span class=line><span class=cl>            <span class=n>show</span><span class=o>(</span><span class=s>&#34;File Store&#34;</span><span class=o>,</span> <span class=n>fs</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span><span class=o>(</span><span class=n>Path</span> <span class=n>rd</span> <span class=o>:</span> <span class=n>fsys</span><span class=o>.</span><span class=na>getRootDirectories</span><span class=o>())</span>
</span></span><span class=line><span class=cl>            <span class=n>show</span><span class=o>(</span><span class=s>&#34;Root Directory&#34;</span><span class=o>,</span> <span class=n>rd</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>show</span><span class=o>(</span><span class=s>&#34;Separator&#34;</span><span class=o>,</span> <span class=n>fsys</span><span class=o>.</span><span class=na>getSeparator</span><span class=o>());</span>
</span></span><span class=line><span class=cl>        <span class=n>show</span><span class=o>(</span><span class=s>&#34;UserPrincipalLookupService&#34;</span><span class=o>,</span>
</span></span><span class=line><span class=cl>            <span class=n>fsys</span><span class=o>.</span><span class=na>getUserPrincipalLookupService</span><span class=o>());</span>
</span></span><span class=line><span class=cl>        <span class=n>show</span><span class=o>(</span><span class=s>&#34;isOpen&#34;</span><span class=o>,</span> <span class=n>fsys</span><span class=o>.</span><span class=na>isOpen</span><span class=o>());</span>
</span></span><span class=line><span class=cl>        <span class=n>show</span><span class=o>(</span><span class=s>&#34;isReadOnly&#34;</span><span class=o>,</span> <span class=n>fsys</span><span class=o>.</span><span class=na>isReadOnly</span><span class=o>());</span>
</span></span><span class=line><span class=cl>        <span class=n>show</span><span class=o>(</span><span class=s>&#34;FileSystemProvider&#34;</span><span class=o>,</span> <span class=n>fsys</span><span class=o>.</span><span class=na>provider</span><span class=o>());</span>
</span></span><span class=line><span class=cl>        <span class=n>show</span><span class=o>(</span><span class=s>&#34;File Attribute Views&#34;</span><span class=o>,</span>
</span></span><span class=line><span class=cl>        <span class=n>fsys</span><span class=o>.</span><span class=na>supportedFileAttributeViews</span><span class=o>());</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=cm>/* 输出:
</span></span></span><span class=line><span class=cl><span class=cm>Windows 10
</span></span></span><span class=line><span class=cl><span class=cm>File Store: SSD (C:)
</span></span></span><span class=line><span class=cl><span class=cm>Root Directory: C:\
</span></span></span><span class=line><span class=cl><span class=cm>Root Directory: D:\
</span></span></span><span class=line><span class=cl><span class=cm>Separator: \
</span></span></span><span class=line><span class=cl><span class=cm>UserPrincipalLookupService:
</span></span></span><span class=line><span class=cl><span class=cm>sun.nio.fs.WindowsFileSystem$LookupService$1@15db9742
</span></span></span><span class=line><span class=cl><span class=cm>isOpen: true
</span></span></span><span class=line><span class=cl><span class=cm>isReadOnly: false
</span></span></span><span class=line><span class=cl><span class=cm>FileSystemProvider:
</span></span></span><span class=line><span class=cl><span class=cm>sun.nio.fs.WindowsFileSystemProvider@6d06d69c
</span></span></span><span class=line><span class=cl><span class=cm>File Attribute Views: [owner, dos, acl, basic, user]
</span></span></span><span class=line><span class=cl><span class=cm>*/</span>
</span></span></code></pre></div><p>一个 <strong>FileSystem</strong> 对象也能生成 <strong>WatchService</strong> 和 <strong>PathMatcher</strong> 对象，将会在接下来两章中详细讲解。</p><h2 id=路径监听>路径监听</h2><p>通过 <strong>WatchService</strong> 可以设置一个进程对目录中的更改做出响应。在这个例子中，<strong>delTxtFiles()</strong> 作为一个单独的任务执行，该任务将遍历整个目录并删除以 <strong>.txt</strong> 结尾的所有文件，<strong>WatchService</strong> 会对文件删除操作做出反应：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// files/PathWatcher.java
</span></span></span><span class=line><span class=cl><span class=c1>// {ExcludeFromGradle}
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>import</span> <span class=nn>java.io.IOException</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>java.nio.file.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import static</span> <span class=nn>java.nio.file.StandardWatchEventKinds.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>java.util.concurrent.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>PathWatcher</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>static</span> <span class=n>Path</span> <span class=n>test</span> <span class=o>=</span> <span class=n>Paths</span><span class=o>.</span><span class=na>get</span><span class=o>(</span><span class=s>&#34;test&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>static</span> <span class=kt>void</span> <span class=nf>delTxtFiles</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=n>Files</span><span class=o>.</span><span class=na>walk</span><span class=o>(</span><span class=n>test</span><span class=o>)</span>
</span></span><span class=line><span class=cl>            <span class=o>.</span><span class=na>filter</span><span class=o>(</span><span class=n>f</span> <span class=o>-&gt;</span>
</span></span><span class=line><span class=cl>                <span class=n>f</span><span class=o>.</span><span class=na>toString</span><span class=o>()</span>
</span></span><span class=line><span class=cl>                <span class=o>.</span><span class=na>endsWith</span><span class=o>(</span><span class=s>&#34;.txt&#34;</span><span class=o>))</span>
</span></span><span class=line><span class=cl>                <span class=o>.</span><span class=na>forEach</span><span class=o>(</span><span class=n>f</span> <span class=o>-&gt;</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                <span class=k>try</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;deleting &#34;</span> <span class=o>+</span> <span class=n>f</span><span class=o>);</span>
</span></span><span class=line><span class=cl>                    <span class=n>Files</span><span class=o>.</span><span class=na>delete</span><span class=o>(</span><span class=n>f</span><span class=o>);</span>
</span></span><span class=line><span class=cl>                <span class=o>}</span> <span class=k>catch</span><span class=o>(</span><span class=n>IOException</span> <span class=n>e</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                    <span class=k>throw</span> <span class=k>new</span> <span class=n>RuntimeException</span><span class=o>(</span><span class=n>e</span><span class=o>);</span>
</span></span><span class=line><span class=cl>                <span class=o>}</span>
</span></span><span class=line><span class=cl>            <span class=o>});</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span> <span class=k>catch</span><span class=o>(</span><span class=n>IOException</span> <span class=n>e</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=k>throw</span> <span class=k>new</span> <span class=n>RuntimeException</span><span class=o>(</span><span class=n>e</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=kd>throws</span> <span class=n>Exception</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>Directories</span><span class=o>.</span><span class=na>refreshTestDir</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=n>Directories</span><span class=o>.</span><span class=na>populateTestDir</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=n>Files</span><span class=o>.</span><span class=na>createFile</span><span class=o>(</span><span class=n>test</span><span class=o>.</span><span class=na>resolve</span><span class=o>(</span><span class=s>&#34;Hello.txt&#34;</span><span class=o>));</span>
</span></span><span class=line><span class=cl>        <span class=n>WatchService</span> <span class=n>watcher</span> <span class=o>=</span> <span class=n>FileSystems</span><span class=o>.</span><span class=na>getDefault</span><span class=o>().</span><span class=na>newWatchService</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=n>test</span><span class=o>.</span><span class=na>register</span><span class=o>(</span><span class=n>watcher</span><span class=o>,</span> <span class=n>ENTRY_DELETE</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>Executors</span><span class=o>.</span><span class=na>newSingleThreadScheduledExecutor</span><span class=o>()</span>
</span></span><span class=line><span class=cl>        <span class=o>.</span><span class=na>schedule</span><span class=o>(</span><span class=n>PathWatcher</span><span class=o>::</span><span class=n>delTxtFiles</span><span class=o>,</span>
</span></span><span class=line><span class=cl>        <span class=mi>250</span><span class=o>,</span> <span class=n>TimeUnit</span><span class=o>.</span><span class=na>MILLISECONDS</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>WatchKey</span> <span class=n>key</span> <span class=o>=</span> <span class=n>watcher</span><span class=o>.</span><span class=na>take</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span><span class=o>(</span><span class=n>WatchEvent</span> <span class=n>evt</span> <span class=o>:</span> <span class=n>key</span><span class=o>.</span><span class=na>pollEvents</span><span class=o>())</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;evt.context(): &#34;</span> <span class=o>+</span> <span class=n>evt</span><span class=o>.</span><span class=na>context</span><span class=o>()</span> <span class=o>+</span>
</span></span><span class=line><span class=cl>            <span class=s>&#34;\nevt.count(): &#34;</span> <span class=o>+</span> <span class=n>evt</span><span class=o>.</span><span class=na>count</span><span class=o>()</span> <span class=o>+</span>
</span></span><span class=line><span class=cl>            <span class=s>&#34;\nevt.kind(): &#34;</span> <span class=o>+</span> <span class=n>evt</span><span class=o>.</span><span class=na>kind</span><span class=o>());</span>
</span></span><span class=line><span class=cl>            <span class=n>System</span><span class=o>.</span><span class=na>exit</span><span class=o>(</span><span class=mi>0</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=cm>/* Output:
</span></span></span><span class=line><span class=cl><span class=cm>deleting test\bag\foo\bar\baz\File.txt
</span></span></span><span class=line><span class=cl><span class=cm>deleting test\bar\baz\bag\foo\File.txt
</span></span></span><span class=line><span class=cl><span class=cm>deleting test\baz\bag\foo\bar\File.txt
</span></span></span><span class=line><span class=cl><span class=cm>deleting test\foo\bar\baz\bag\File.txt
</span></span></span><span class=line><span class=cl><span class=cm>deleting test\Hello.txt
</span></span></span><span class=line><span class=cl><span class=cm>evt.context(): Hello.txt
</span></span></span><span class=line><span class=cl><span class=cm>evt.count(): 1
</span></span></span><span class=line><span class=cl><span class=cm>evt.kind(): ENTRY_DELETE
</span></span></span><span class=line><span class=cl><span class=cm>*/</span>
</span></span></code></pre></div><p><strong>delTxtFiles()</strong> 中的 <strong>try</strong> 代码块看起来有些多余，因为它们捕获的是同一种类型的异常，外部的 <strong>try</strong> 语句似乎已经足够了。然而出于某种原因，Java 要求两者都必须存在(这也可能是一个 bug)。还要注意的是在 <strong>filter()</strong> 中，我们必须显式地使用 <strong>f.toString()</strong> 转为字符串，否则我们调用 <strong>endsWith()</strong> 将会与整个 <strong>Path</strong> 对象进行比较，而不是路径名称字符串的一部分进行比较。</p><p>一旦我们从 <strong>FileSystem</strong> 中得到了 <strong>WatchService</strong> 对象，我们将其注册到 <strong>test</strong> 路径以及我们感兴趣的项目的变量参数列表中，可以选择 <strong>ENTRY_CREATE</strong>，<strong>ENTRY_DELETE</strong> 或 <strong>ENTRY_MODIFY</strong>(其中创建和删除不属于修改)。</p><p>因为接下来对 <strong>watcher.take()</strong> 的调用会在发生某些事情之前停止所有操作，所以我们希望 <strong>deltxtfiles()</strong> 能够并行运行以便生成我们感兴趣的事件。为了实现这个目的，我通过调用 <strong>Executors.newSingleThreadScheduledExecutor()</strong> 产生一个 <strong>ScheduledExecutorService</strong> 对象，然后调用 <strong>schedule()</strong> 方法传递所需函数的方法引用，并且设置在运行之前应该等待的时间。</p><p>此时，<strong>watcher.take()</strong> 将等待并阻塞在这里。当目标事件发生时，会返回一个包含 <strong>WatchEvent</strong> 的 <strong>Watchkey</strong> 对象。展示的这三种方法是能对 <strong>WatchEvent</strong> 执行的全部操作。</p><p>查看输出的具体内容。即使我们正在删除以 <strong>.txt</strong> 结尾的文件，在 <strong>Hello.txt</strong> 被删除之前，<strong>WatchService</strong> 也不会被触发。你可能认为，如果说"监视这个目录"，自然会包含整个目录和下面子目录，但实际上：只会监视给定的目录，而不是下面的所有内容。如果需要监视整个树目录，必须在整个树的每个子目录上放置一个 <strong>Watchservice</strong>。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// files/TreeWatcher.java
</span></span></span><span class=line><span class=cl><span class=c1>// {ExcludeFromGradle}
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>import</span> <span class=nn>java.io.IOException</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>java.nio.file.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import static</span> <span class=nn>java.nio.file.StandardWatchEventKinds.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>java.util.concurrent.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>TreeWatcher</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>static</span> <span class=kt>void</span> <span class=nf>watchDir</span><span class=o>(</span><span class=n>Path</span> <span class=n>dir</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=n>WatchService</span> <span class=n>watcher</span> <span class=o>=</span>
</span></span><span class=line><span class=cl>            <span class=n>FileSystems</span><span class=o>.</span><span class=na>getDefault</span><span class=o>().</span><span class=na>newWatchService</span><span class=o>();</span>
</span></span><span class=line><span class=cl>            <span class=n>dir</span><span class=o>.</span><span class=na>register</span><span class=o>(</span><span class=n>watcher</span><span class=o>,</span> <span class=n>ENTRY_DELETE</span><span class=o>);</span>
</span></span><span class=line><span class=cl>            <span class=n>Executors</span><span class=o>.</span><span class=na>newSingleThreadExecutor</span><span class=o>().</span><span class=na>submit</span><span class=o>(()</span> <span class=o>-&gt;</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                <span class=k>try</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                    <span class=n>WatchKey</span> <span class=n>key</span> <span class=o>=</span> <span class=n>watcher</span><span class=o>.</span><span class=na>take</span><span class=o>();</span>
</span></span><span class=line><span class=cl>                    <span class=k>for</span><span class=o>(</span><span class=n>WatchEvent</span> <span class=n>evt</span> <span class=o>:</span> <span class=n>key</span><span class=o>.</span><span class=na>pollEvents</span><span class=o>())</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span>
</span></span><span class=line><span class=cl>                        <span class=s>&#34;evt.context(): &#34;</span> <span class=o>+</span> <span class=n>evt</span><span class=o>.</span><span class=na>context</span><span class=o>()</span> <span class=o>+</span>
</span></span><span class=line><span class=cl>                        <span class=s>&#34;\nevt.count(): &#34;</span> <span class=o>+</span> <span class=n>evt</span><span class=o>.</span><span class=na>count</span><span class=o>()</span> <span class=o>+</span>
</span></span><span class=line><span class=cl>                        <span class=s>&#34;\nevt.kind(): &#34;</span> <span class=o>+</span> <span class=n>evt</span><span class=o>.</span><span class=na>kind</span><span class=o>());</span>
</span></span><span class=line><span class=cl>                        <span class=n>System</span><span class=o>.</span><span class=na>exit</span><span class=o>(</span><span class=mi>0</span><span class=o>);</span>
</span></span><span class=line><span class=cl>                    <span class=o>}</span>
</span></span><span class=line><span class=cl>                <span class=o>}</span> <span class=k>catch</span><span class=o>(</span><span class=n>InterruptedException</span> <span class=n>e</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                    <span class=k>return</span><span class=o>;</span>
</span></span><span class=line><span class=cl>                <span class=o>}</span>
</span></span><span class=line><span class=cl>            <span class=o>});</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span> <span class=k>catch</span><span class=o>(</span><span class=n>IOException</span> <span class=n>e</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=k>throw</span> <span class=k>new</span> <span class=n>RuntimeException</span><span class=o>(</span><span class=n>e</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=kd>throws</span> <span class=n>Exception</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>Directories</span><span class=o>.</span><span class=na>refreshTestDir</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=n>Directories</span><span class=o>.</span><span class=na>populateTestDir</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=n>Files</span><span class=o>.</span><span class=na>walk</span><span class=o>(</span><span class=n>Paths</span><span class=o>.</span><span class=na>get</span><span class=o>(</span><span class=s>&#34;test&#34;</span><span class=o>))</span>
</span></span><span class=line><span class=cl>            <span class=o>.</span><span class=na>filter</span><span class=o>(</span><span class=n>Files</span><span class=o>::</span><span class=n>isDirectory</span><span class=o>)</span>
</span></span><span class=line><span class=cl>            <span class=o>.</span><span class=na>forEach</span><span class=o>(</span><span class=n>TreeWatcher</span><span class=o>::</span><span class=n>watchDir</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>PathWatcher</span><span class=o>.</span><span class=na>delTxtFiles</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=cm>/* Output:
</span></span></span><span class=line><span class=cl><span class=cm>deleting test\bag\foo\bar\baz\File.txt
</span></span></span><span class=line><span class=cl><span class=cm>deleting test\bar\baz\bag\foo\File.txt
</span></span></span><span class=line><span class=cl><span class=cm>evt.context(): File.txt
</span></span></span><span class=line><span class=cl><span class=cm>evt.count(): 1
</span></span></span><span class=line><span class=cl><span class=cm>evt.kind(): ENTRY_DELETE
</span></span></span><span class=line><span class=cl><span class=cm>*/</span>
</span></span></code></pre></div><p>在 <strong>watchDir()</strong> 方法中给 <strong>WatchSevice</strong> 提供参数 <strong>ENTRY_DELETE</strong>，并启动一个独立的线程来监视该<strong>Watchservice</strong>。这里我们没有使用 <strong>schedule()</strong> 进行启动，而是使用 <strong>submit()</strong> 启动线程。我们遍历整个目录树，并将 <strong>watchDir()</strong> 应用于每个子目录。现在，当我们运行 <strong>deltxtfiles()</strong> 时，其中一个 <strong>Watchservice</strong> 会检测到每一次文件删除。</p><h2 id=文件查找>文件查找</h2><p>到目前为止，为了找到文件，我们一直使用相当粗糙的方法，在 <code>path</code> 上调用 <code>toString()</code>，然后使用 <code>string</code> 操作查看结果。事实证明，<code>java.nio.file</code> 有更好的解决方案：通过在 <code>FileSystem</code> 对象上调用 <code>getPathMatcher()</code> 获得一个 <code>PathMatcher</code>，然后传入您感兴趣的模式。模式有两个选项：<code>glob</code> 和 <code>regex</code>。<code>glob</code> 比较简单，实际上功能非常强大，因此您可以使用 <code>glob</code> 解决许多问题。如果您的问题更复杂，可以使用 <code>regex</code>，这将在接下来的 <code>Strings</code> 一章中解释。</p><p>在这里，我们使用 <code>glob</code> 查找以 <code>.tmp</code> 或 <code>.txt</code> 结尾的所有 <code>Path</code>：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// files/Find.java
</span></span></span><span class=line><span class=cl><span class=c1>// {ExcludeFromGradle}
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>import</span> <span class=nn>java.nio.file.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>Find</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=kd>throws</span> <span class=n>Exception</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>Path</span> <span class=n>test</span> <span class=o>=</span> <span class=n>Paths</span><span class=o>.</span><span class=na>get</span><span class=o>(</span><span class=s>&#34;test&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>Directories</span><span class=o>.</span><span class=na>refreshTestDir</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=n>Directories</span><span class=o>.</span><span class=na>populateTestDir</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=c1>// Creating a *directory*, not a file:
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>Files</span><span class=o>.</span><span class=na>createDirectory</span><span class=o>(</span><span class=n>test</span><span class=o>.</span><span class=na>resolve</span><span class=o>(</span><span class=s>&#34;dir.tmp&#34;</span><span class=o>));</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>PathMatcher</span> <span class=n>matcher</span> <span class=o>=</span> <span class=n>FileSystems</span><span class=o>.</span><span class=na>getDefault</span><span class=o>()</span>
</span></span><span class=line><span class=cl>          <span class=o>.</span><span class=na>getPathMatcher</span><span class=o>(</span><span class=s>&#34;glob:**/*.{tmp,txt}&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>Files</span><span class=o>.</span><span class=na>walk</span><span class=o>(</span><span class=n>test</span><span class=o>)</span>
</span></span><span class=line><span class=cl>          <span class=o>.</span><span class=na>filter</span><span class=o>(</span><span class=n>matcher</span><span class=o>::</span><span class=n>matches</span><span class=o>)</span>
</span></span><span class=line><span class=cl>          <span class=o>.</span><span class=na>forEach</span><span class=o>(</span><span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>::</span><span class=n>println</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;***************&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>PathMatcher</span> <span class=n>matcher2</span> <span class=o>=</span> <span class=n>FileSystems</span><span class=o>.</span><span class=na>getDefault</span><span class=o>()</span>
</span></span><span class=line><span class=cl>          <span class=o>.</span><span class=na>getPathMatcher</span><span class=o>(</span><span class=s>&#34;glob:*.tmp&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>Files</span><span class=o>.</span><span class=na>walk</span><span class=o>(</span><span class=n>test</span><span class=o>)</span>
</span></span><span class=line><span class=cl>          <span class=o>.</span><span class=na>map</span><span class=o>(</span><span class=n>Path</span><span class=o>::</span><span class=n>getFileName</span><span class=o>)</span>
</span></span><span class=line><span class=cl>          <span class=o>.</span><span class=na>filter</span><span class=o>(</span><span class=n>matcher2</span><span class=o>::</span><span class=n>matches</span><span class=o>)</span>
</span></span><span class=line><span class=cl>          <span class=o>.</span><span class=na>forEach</span><span class=o>(</span><span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>::</span><span class=n>println</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;***************&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>Files</span><span class=o>.</span><span class=na>walk</span><span class=o>(</span><span class=n>test</span><span class=o>)</span> <span class=c1>// Only look for files
</span></span></span><span class=line><span class=cl><span class=c1></span>          <span class=o>.</span><span class=na>filter</span><span class=o>(</span><span class=n>Files</span><span class=o>::</span><span class=n>isRegularFile</span><span class=o>)</span>
</span></span><span class=line><span class=cl>          <span class=o>.</span><span class=na>map</span><span class=o>(</span><span class=n>Path</span><span class=o>::</span><span class=n>getFileName</span><span class=o>)</span>
</span></span><span class=line><span class=cl>          <span class=o>.</span><span class=na>filter</span><span class=o>(</span><span class=n>matcher2</span><span class=o>::</span><span class=n>matches</span><span class=o>)</span>
</span></span><span class=line><span class=cl>          <span class=o>.</span><span class=na>forEach</span><span class=o>(</span><span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>::</span><span class=n>println</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=cm>/* Output:
</span></span></span><span class=line><span class=cl><span class=cm>test\bag\foo\bar\baz\5208762845883213974.tmp
</span></span></span><span class=line><span class=cl><span class=cm>test\bag\foo\bar\baz\File.txt
</span></span></span><span class=line><span class=cl><span class=cm>test\bar\baz\bag\foo\7918367201207778677.tmp
</span></span></span><span class=line><span class=cl><span class=cm>test\bar\baz\bag\foo\File.txt
</span></span></span><span class=line><span class=cl><span class=cm>test\baz\bag\foo\bar\8016595521026696632.tmp
</span></span></span><span class=line><span class=cl><span class=cm>test\baz\bag\foo\bar\File.txt
</span></span></span><span class=line><span class=cl><span class=cm>test\dir.tmp
</span></span></span><span class=line><span class=cl><span class=cm>test\foo\bar\baz\bag\5832319279813617280.tmp
</span></span></span><span class=line><span class=cl><span class=cm>test\foo\bar\baz\bag\File.txt
</span></span></span><span class=line><span class=cl><span class=cm>***************
</span></span></span><span class=line><span class=cl><span class=cm>5208762845883213974.tmp
</span></span></span><span class=line><span class=cl><span class=cm>7918367201207778677.tmp
</span></span></span><span class=line><span class=cl><span class=cm>8016595521026696632.tmp
</span></span></span><span class=line><span class=cl><span class=cm>dir.tmp
</span></span></span><span class=line><span class=cl><span class=cm>5832319279813617280.tmp
</span></span></span><span class=line><span class=cl><span class=cm>***************
</span></span></span><span class=line><span class=cl><span class=cm>5208762845883213974.tmp
</span></span></span><span class=line><span class=cl><span class=cm>7918367201207778677.tmp
</span></span></span><span class=line><span class=cl><span class=cm>8016595521026696632.tmp
</span></span></span><span class=line><span class=cl><span class=cm>5832319279813617280.tmp
</span></span></span><span class=line><span class=cl><span class=cm>*/</span>
</span></span></code></pre></div><p>在 <code>matcher</code> 中，<code>glob</code> 表达式开头的 <code>**/</code> 表示“当前目录及所有子目录”，这在当你不仅仅要匹配当前目录下特定结尾的 <code>Path</code> 时非常有用。单 <code>*</code> 表示“任何东西”，然后是一个点，然后大括号表示一系列的可能性&mdash;我们正在寻找以 <code>.tmp</code> 或 <code>.txt</code> 结尾的东西。您可以在 <code>getPathMatcher()</code> 文档中找到更多详细信息。</p><p><code>matcher2</code> 只使用 <code>*.tmp</code>，通常不匹配任何内容，但是添加 <code>map()</code> 操作会将完整路径减少到末尾的名称。</p><p>注意，在这两种情况下，输出中都会出现 <code>dir.tmp</code>，即使它是一个目录而不是一个文件。要只查找文件，必须像在最后 <code>files.walk()</code> 中那样对其进行筛选。</p><h2 id=文件读写>文件读写</h2><p>此时，我们可以对路径和目录做任何事情。 现在让我们看一下操纵文件本身的内容。</p><p>如果一个文件很“小”，也就是说“它运行得足够快且占用内存小”，那么 <code>java.nio.file.Files</code> 类中的实用程序将帮助你轻松读写文本和二进制文件。</p><p><code>Files.readAllLines()</code> 一次读取整个文件（因此，“小”文件很有必要），产生一个<code>List&lt;String></code>。 对于示例文件，我们将重用<code>streams/Cheese.dat</code>：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// files/ListOfLines.java
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>import</span> <span class=nn>java.util.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>java.nio.file.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>ListOfLines</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=kd>throws</span> <span class=n>Exception</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>Files</span><span class=o>.</span><span class=na>readAllLines</span><span class=o>(</span>
</span></span><span class=line><span class=cl>        <span class=n>Paths</span><span class=o>.</span><span class=na>get</span><span class=o>(</span><span class=s>&#34;../streams/Cheese.dat&#34;</span><span class=o>))</span>
</span></span><span class=line><span class=cl>        <span class=o>.</span><span class=na>stream</span><span class=o>()</span>
</span></span><span class=line><span class=cl>        <span class=o>.</span><span class=na>filter</span><span class=o>(</span><span class=n>line</span> <span class=o>-&gt;</span> <span class=o>!</span><span class=n>line</span><span class=o>.</span><span class=na>startsWith</span><span class=o>(</span><span class=s>&#34;//&#34;</span><span class=o>))</span>
</span></span><span class=line><span class=cl>        <span class=o>.</span><span class=na>map</span><span class=o>(</span><span class=n>line</span> <span class=o>-&gt;</span>
</span></span><span class=line><span class=cl>            <span class=n>line</span><span class=o>.</span><span class=na>substring</span><span class=o>(</span><span class=mi>0</span><span class=o>,</span> <span class=n>line</span><span class=o>.</span><span class=na>length</span><span class=o>()/</span><span class=mi>2</span><span class=o>))</span>
</span></span><span class=line><span class=cl>        <span class=o>.</span><span class=na>forEach</span><span class=o>(</span><span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>::</span><span class=n>println</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=cm>/* Output:
</span></span></span><span class=line><span class=cl><span class=cm>Not much of a cheese
</span></span></span><span class=line><span class=cl><span class=cm>Finest in the
</span></span></span><span class=line><span class=cl><span class=cm>And what leads you
</span></span></span><span class=line><span class=cl><span class=cm>Well, it&#39;s
</span></span></span><span class=line><span class=cl><span class=cm>It&#39;s certainly uncon
</span></span></span><span class=line><span class=cl><span class=cm>*/</span>
</span></span></code></pre></div><p>跳过注释行，其余的内容每行只打印一半。 这实现起来很简单：你只需将 <code>Path</code> 传递给 <code>readAllLines()</code> （以前的 java 实现这个功能很复杂）。<code>readAllLines()</code> 有一个重载版本，包含一个 <code>Charset</code> 参数来存储文件的 Unicode 编码。</p><p><code>Files.write()</code> 被重载以写入 <code>byte</code> 数组或任何 <code>Iterable</code> 对象（它也有 <code>Charset</code> 选项）：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// files/Writing.java
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>import</span> <span class=nn>java.util.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>java.nio.file.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>Writing</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>static</span> <span class=n>Random</span> <span class=n>rand</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Random</span><span class=o>(</span><span class=mi>47</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=kd>static</span> <span class=kd>final</span> <span class=kt>int</span> <span class=n>SIZE</span> <span class=o>=</span> <span class=mi>1000</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=kd>throws</span> <span class=n>Exception</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// Write bytes to a file:
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=kt>byte</span><span class=o>[]</span> <span class=n>bytes</span> <span class=o>=</span> <span class=k>new</span> <span class=kt>byte</span><span class=o>[</span><span class=n>SIZE</span><span class=o>];</span>
</span></span><span class=line><span class=cl>        <span class=n>rand</span><span class=o>.</span><span class=na>nextBytes</span><span class=o>(</span><span class=n>bytes</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>Files</span><span class=o>.</span><span class=na>write</span><span class=o>(</span><span class=n>Paths</span><span class=o>.</span><span class=na>get</span><span class=o>(</span><span class=s>&#34;bytes.dat&#34;</span><span class=o>),</span> <span class=n>bytes</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;bytes.dat: &#34;</span> <span class=o>+</span> <span class=n>Files</span><span class=o>.</span><span class=na>size</span><span class=o>(</span><span class=n>Paths</span><span class=o>.</span><span class=na>get</span><span class=o>(</span><span class=s>&#34;bytes.dat&#34;</span><span class=o>)));</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1>// Write an iterable to a file:
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>List</span><span class=o>&lt;</span><span class=n>String</span><span class=o>&gt;</span> <span class=n>lines</span> <span class=o>=</span> <span class=n>Files</span><span class=o>.</span><span class=na>readAllLines</span><span class=o>(</span>
</span></span><span class=line><span class=cl>          <span class=n>Paths</span><span class=o>.</span><span class=na>get</span><span class=o>(</span><span class=s>&#34;../streams/Cheese.dat&#34;</span><span class=o>));</span>
</span></span><span class=line><span class=cl>        <span class=n>Files</span><span class=o>.</span><span class=na>write</span><span class=o>(</span><span class=n>Paths</span><span class=o>.</span><span class=na>get</span><span class=o>(</span><span class=s>&#34;Cheese.txt&#34;</span><span class=o>),</span> <span class=n>lines</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;Cheese.txt: &#34;</span> <span class=o>+</span> <span class=n>Files</span><span class=o>.</span><span class=na>size</span><span class=o>(</span><span class=n>Paths</span><span class=o>.</span><span class=na>get</span><span class=o>(</span><span class=s>&#34;Cheese.txt&#34;</span><span class=o>)));</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=cm>/* Output:
</span></span></span><span class=line><span class=cl><span class=cm>bytes.dat: 1000
</span></span></span><span class=line><span class=cl><span class=cm>Cheese.txt: 199
</span></span></span><span class=line><span class=cl><span class=cm>*/</span>
</span></span></code></pre></div><p>我们使用 <code>Random</code> 来创建一个随机的 <code>byte</code> 数组; 你可以看到生成的文件大小是 1000。</p><p>一个 <code>List</code> 被写入文件，任何 <code>Iterable</code> 对象也可以这么做。</p><p>如果文件大小有问题怎么办？ 比如说：</p><ol><li><p>文件太大，如果你一次性读完整个文件，你可能会耗尽内存。</p></li><li><p>您只需要在文件的中途工作以获得所需的结果，因此读取整个文件会浪费时间。</p></li></ol><p><code>Files.lines()</code> 方便地将文件转换为行的 <code>Stream</code>：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// files/ReadLineStream.java
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>import</span> <span class=nn>java.nio.file.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>ReadLineStream</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=kd>throws</span> <span class=n>Exception</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>Files</span><span class=o>.</span><span class=na>lines</span><span class=o>(</span><span class=n>Paths</span><span class=o>.</span><span class=na>get</span><span class=o>(</span><span class=s>&#34;PathInfo.java&#34;</span><span class=o>))</span>
</span></span><span class=line><span class=cl>          <span class=o>.</span><span class=na>skip</span><span class=o>(</span><span class=mi>13</span><span class=o>)</span>
</span></span><span class=line><span class=cl>          <span class=o>.</span><span class=na>findFirst</span><span class=o>()</span>
</span></span><span class=line><span class=cl>          <span class=o>.</span><span class=na>ifPresent</span><span class=o>(</span><span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>::</span><span class=n>println</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=cm>/* Output:
</span></span></span><span class=line><span class=cl><span class=cm>    show(&#34;RegularFile&#34;, Files.isRegularFile(p));
</span></span></span><span class=line><span class=cl><span class=cm>*/</span>
</span></span></code></pre></div><p>这对本章中第一个示例代码做了流式处理，跳过 13 行，然后选择下一行并将其打印出来。</p><p><code>Files.lines()</code> 对于把文件处理行的传入流时非常有用，但是如果你想在 <code>Stream</code> 中读取，处理或写入怎么办？这就需要稍微复杂的代码：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// files/StreamInAndOut.java
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>import</span> <span class=nn>java.io.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>java.nio.file.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>java.util.stream.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>StreamInAndOut</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span><span class=o>(</span>
</span></span><span class=line><span class=cl>          <span class=n>Stream</span><span class=o>&lt;</span><span class=n>String</span><span class=o>&gt;</span> <span class=n>input</span> <span class=o>=</span>
</span></span><span class=line><span class=cl>            <span class=n>Files</span><span class=o>.</span><span class=na>lines</span><span class=o>(</span><span class=n>Paths</span><span class=o>.</span><span class=na>get</span><span class=o>(</span><span class=s>&#34;StreamInAndOut.java&#34;</span><span class=o>));</span>
</span></span><span class=line><span class=cl>          <span class=n>PrintWriter</span> <span class=n>output</span> <span class=o>=</span>
</span></span><span class=line><span class=cl>            <span class=k>new</span> <span class=n>PrintWriter</span><span class=o>(</span><span class=s>&#34;StreamInAndOut.txt&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl>        <span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=n>input</span><span class=o>.</span><span class=na>map</span><span class=o>(</span><span class=n>String</span><span class=o>::</span><span class=n>toUpperCase</span><span class=o>)</span>
</span></span><span class=line><span class=cl>              <span class=o>.</span><span class=na>forEachOrdered</span><span class=o>(</span><span class=n>output</span><span class=o>::</span><span class=n>println</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span> <span class=k>catch</span><span class=o>(</span><span class=n>Exception</span> <span class=n>e</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=k>throw</span> <span class=k>new</span> <span class=n>RuntimeException</span><span class=o>(</span><span class=n>e</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>因为我们在同一个块中执行所有操作，所以这两个文件都可以在相同的 try-with-resources 语句中打开。<code>PrintWriter</code> 是一个旧式的 <code>java.io</code> 类，允许你“打印”到一个文件，所以它是这个应用的理想选择。如果你看一下 <code>StreamInAndOut.txt</code>，你会发现它里面的内容确实是大写的。</p><h2 id=本章小结>本章小结</h2><p>虽然本章对文件和目录操作做了相当全面的介绍，但是仍然有没被介绍的类库中的功能——一定要研究 <code>java.nio.file</code> 的 Javadocs，尤其是 <code>java.nio.file.Files</code> 这个类。</p><p>Java 7 和 8 对于处理文件和目录的类库做了大量改进。如果您刚刚开始使用 Java，那么您很幸运。在过去，它令人非常不愉快，我确信 Java 设计者以前对于文件操作不够重视才没做简化。对于初学者来说这是一件很棒的事，对于教学者来说也一样。我不明白为什么花了这么长时间来解决这个明显的问题，但不管怎么说它被解决了，我很高兴。使用文件现在很简单，甚至很有趣，这是你以前永远想不到的。</p><div style=page-break-after:always></div></div><div class=article-widget><div class="container-xl row post-nav"><div class="col-6 post-nav-item"><div class=meta-nav>上一页</div><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/16-validating-your-code/ rel=next>16-Validating-Your-Code</a></div><div class="col-6 post-nav-item"><div class=meta-nav>下一页</div><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/18-strings/ rel=prev>18-Strings</a></div></div></div><div class=body-footer><p>最近更新于 0001-01-01</p><section id=comments class="mb-3 pt-0"><div id=disqus_thread></div><script>var disqus_config=function(){};(function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="https://ngte.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)})()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></section></div></article><footer class=site-footer><div class="copyright py-4 bg-footer"><div class="row justify-content-center"><div class="text-center footer-color"><p class=mb-0>© 2017-2022 NGTE all rights reserved</p></div></div></div></footer></main></div></div><script src=//unpkg.com/heti/umd/heti-addon.min.js></script>
<script>const heti=new Heti(".article");heti.autoSpacing()</script><script type=text/javascript>window.$crisp=[],window.CRISP_WEBSITE_ID="12adcc35-9621-4313-8262-62dc654b29d8",function(){setTimeout(function(){d=document,s=d.createElement("script"),s.src="https://client.crisp.chat/l.js",s.async=1,d.getElementsByTagName("head")[0].appendChild(s)},2500)}()</script></div><div class=page-footer></div><script src=/js/vendor-bundle.min.d26509351aa0ff874abbee824e982e9b.js></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.1/highlight.min.js integrity="sha512-Ypjm0o7jOxAd4hpdoppSEN0TQOC19UtPAqD+4s5AlXmUvbmmS/YMxYqAqarQYyxTnB6/rqip9qcxlNB/3U9Wdg==" crossorigin=anonymous></script>
<script id=search-hit-algolia-template type=text/html><div class=search-hit><div class=search-hit-content><div class=search-hit-name><a href={{relpermalink}}>{{#helpers.highlight}}{ "attribute": "title" }{{/helpers.highlight}}</a></div><div class="article-metadata search-hit-type">{{type}}</div><p class=search-hit-description>{{#helpers.highlight}}{ "attribute": "summary" }{{/helpers.highlight}}</p></div></div></script><script src=https://cdn.jsdelivr.net/npm/instantsearch.js@4/dist/instantsearch.production.min.js crossorigin=anonymous></script>
<script id=dsq-count-scr src=https://ngte.disqus.com/count.js async></script>
<script src=/zh/js/algolia-search-built.min.4387d694ca1258194aaf562b8cd1c400.js type=module></script>
<script id=page-data type=application/json>{"use_headroom":false}</script><script src=/zh/js/wowchemy.min.d1673c7a11d1238516cbe12a1e84257f.js></script>
<script>var mybutton=document.getElementById("backTopBtn");window.onscroll=function(){scrollFunction()};function scrollFunction(){document.body.scrollTop>20||document.documentElement.scrollTop>20?mybutton.style.display="block":mybutton.style.display="none"}function topFunction(){document.body.scrollTop=0,document.documentElement.scrollTop=0}</script><script src=https://cdn.jsdelivr.net/gh/bryanbraun/anchorjs@4.2.2/anchor.min.js integrity="sha512-I7w3ZdSFzw5j3jU3ZkNikBNeIrl3i+hEuEdwNmqUJvwNcaBUNcijnP2gd9DtGlgVYDplfjGoD8vTNsID+lCjqg==" crossorigin=anonymous></script>
<script>anchors.add()</script><script>(function(){"use strict";if(!document.queryCommandSupported("copy"))return;function e(e,t){e.className="highlight-copy-btn",e.textContent=t,setTimeout(function(){e.textContent="",e.className="highlight-copy-btn fa fa-copy"},1e3)}function t(e){var t=window.getSelection(),n=document.createRange();return n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n),t}function n(n){var o,s=document.createElement("button");s.className="highlight-copy-btn fa fa-copy",s.textContent="",o=n.firstElementChild,s.addEventListener("click",function(){try{var n=t(o);document.execCommand("copy"),n.removeAllRanges(),e(s,"已复制")}catch(t){console&&console.log(t),e(s,"Failed :'(")}}),n.appendChild(s)}var s=document.getElementsByClassName("highlight");Array.prototype.forEach.call(s,n)})()</script></body></html>