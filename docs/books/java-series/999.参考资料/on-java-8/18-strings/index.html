<!doctype html><html lang=zh><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=generator content="Wowchemy 5.5.0 for Hugo"><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=preload as=style href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap"><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap" media=print onload='this.media="all"'><meta name=google-site-verification content="google69a5cccb61297807"><meta name=baidu-site-verification content="cqmZHEleVh"><meta name=description content="第十八章 字符串 字符串操作毫无疑问是计算机程序设计中最常见的行为之一。 在 Java 大展拳脚的 Web 系统中更是如此。在本章中，我们将深入学习在 Java 语言中应用最广泛的 String 类，并研究与之相关的类及工具。 字符串的不可变 String 对象是"><link rel=alternate hreflang=zh href=https://ng-tech.icu/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/18-strings/><meta name=theme-color content="#0a55a7"><link rel=stylesheet href=/css/vendor-bundle.min.c7b8d9abd591ba2253ea42747e3ac3f5.css media=print onload='this.media="all"'><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.1/styles/github.min.css crossorigin=anonymous title=hl-light media=print onload='this.media="all"'><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.1/styles/dracula.min.css crossorigin=anonymous title=hl-dark media=print onload='this.media="all"' disabled><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/instantsearch.css@7.4.5/themes/satellite-min.css integrity="sha256-TehzF/2QvNKhGQrrNpoOb2Ck4iGZ1J/DI4pkd2oUsBc=" crossorigin=anonymous><link rel=stylesheet href=/css/wowchemy.63df6ae9fc2b4cc71b83f1774d780209.css><script async src="https://www.googletagmanager.com/gtag/js?id=G-40NYXJ8823"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-40NYXJ8823")</script><script>var _hmt=_hmt||[];(function(){var e,t=document.createElement("script");t.src="https://hm.baidu.com/hm.js?56df1177bce405601b0ecdd7208f75c6",e=document.getElementsByTagName("script")[0],e.parentNode.insertBefore(t,e)})()</script><link rel=manifest href=/manifest.webmanifest><link rel=icon type=image/png href=/media/icon_hu0f7d075e895d6f5f1f5fdbc1e33dc138_10087_32x32_fill_lanczos_center_3.png><link rel=apple-touch-icon type=image/png href=/media/icon_hu0f7d075e895d6f5f1f5fdbc1e33dc138_10087_180x180_fill_lanczos_center_3.png><link rel=canonical href=https://ng-tech.icu/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/18-strings/><meta property="twitter:card" content="summary_large_image"><meta property="twitter:site" content="@wx-chevalier"><meta property="twitter:creator" content="@wx-chevalier"><meta property="og:site_name" content="Next-gen Tech Edu"><meta property="og:url" content="https://ng-tech.icu/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/18-strings/"><meta property="og:title" content="18-Strings | Next-gen Tech Edu"><meta property="og:description" content="第十八章 字符串 字符串操作毫无疑问是计算机程序设计中最常见的行为之一。 在 Java 大展拳脚的 Web 系统中更是如此。在本章中，我们将深入学习在 Java 语言中应用最广泛的 String 类，并研究与之相关的类及工具。 字符串的不可变 String 对象是"><meta property="og:image" content="https://ng-tech.icu/media/sharing.png"><meta property="twitter:image" content="https://ng-tech.icu/media/sharing.png"><meta property="og:locale" content="zh"><title>18-Strings | Next-gen Tech Edu</title></head><body id=top data-spy=scroll data-offset=70 data-target=#TableOfContents class=page-wrapper data-wc-page-id=7d09ff476ea02fa28a914bf4b90959fd><button onclick=topFunction() id=backTopBtn title="Go to top"><i class="fa-solid fa-circle-up" aria-hidden=true></i></button>
<script src=/js/wowchemy-init.min.14a0ed61c6dbd594b9c75193b25be179.js></script><aside class=search-modal id=search><div class=container><section class=search-header><div class="row no-gutters justify-content-between mb-3"><div class="col-6 search-title"><p>搜索</p></div><div class="col-6 col-search-close"><a class=js-search href=# aria-label=关闭><i class="fas fa-times-circle text-muted" aria-hidden=true></i></a></div></div><div id=search-box></div></section><section class=section-search-results><div id=search-hits></div><div id=search-common-queries></div></section></div></aside><div class=page-header><header class=header--fixed><nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id=navbar-main><div class=container-xl><div class="d-none d-lg-inline-flex"><a class=navbar-brand href=/>Next-gen Tech Edu</a></div><button type=button class=navbar-toggler data-toggle=collapse data-target=#navbar-content aria-controls=navbar-content aria-expanded=false aria-label=切换导航>
<span><i class="fas fa-bars"></i></span></button><div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none"><a class=navbar-brand href=/>Next-gen Tech Edu</a></div><div class="navbar-collapse main-menu-item collapse justify-content-start" id=navbar-content><ul class="navbar-nav d-md-inline-flex"><li class=nav-item><a class=nav-link href=/books-gallery><span>笔记（万篇）</span></a></li><li class=nav-item><a class=nav-link href=/#knowledge-map><span>知识图谱</span></a></li><style>.dropdown-item{display:inline-flex}</style><li class="nav-item dropdown"><a href=# class="nav-link dropdown-toggle" data-toggle=dropdown aria-haspopup=true><span>实验室</span><span class=caret></span></a><div class=dropdown-menu><a class=dropdown-item href=/galaxy-home/gh-craft><span>Craft 方块世界</span></a>
<a class=dropdown-item href=/galaxy-home/glossary-cards><span>3D 知识卡牌</span></a></div></li><style>.dropdown-item{display:inline-flex}</style><li class="nav-item dropdown"><a href=# class="nav-link dropdown-toggle" data-toggle=dropdown aria-haspopup=true><span>其他阅读渠道</span><span class=caret></span></a><div class=dropdown-menu><a class=dropdown-item href=https://zhuanlan.zhihu.com/wxyyxc1992><img style=width:16px;height:16px;display:inline-block;margin-right:8px src=https://ngte-superbed.oss-cn-beijing.aliyuncs.com/item/20230218234451.png></img><span>知乎</span></a>
<a class=dropdown-item href=https://segmentfault.com/blog/wxyyxc1992><img style=width:16px;height:16px;display:inline-block;margin-right:8px src=https://ngte-superbed.oss-cn-beijing.aliyuncs.com/item/20230219113556.png></img><span>SegmentFault</span></a>
<a class=dropdown-item href=https://zhuanlan.zhihu.com/wxyyxc1992><img style=width:16px;height:16px;display:inline-block;margin-right:8px src=https://ngte-superbed.oss-cn-beijing.aliyuncs.com/item/20230219113519.png></img><span>掘金</span></a></div></li></ul></div><ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2"><li class=nav-item><a class="nav-link js-search" href=# aria-label=搜索><i class="fas fa-search" aria-hidden=true></i></a></li><li class=nav-item><a class=nav-link href=https://github.com/wx-chevalier aria-label=GitHub><i class="fa-brands fa-github" aria-hidden=true></i></a></li><div></div><style>@media only screen and (max-width:600px){.jimmysong-template{display:none!important}}</style><li class=jimmysong-template style=color:#fff;font-size:12px><a href=https://jimmysong.io style=color:#fff>By Jimmy Song's Template</a></li></ul></div></nav></header></div><div class=page-body><link rel=stylesheet href=//unpkg.com/heti/umd/heti.min.css><div class="container-xl docs"><div class="row flex-xl-nowrap"><div class=docs-sidebar><form class="docs-search d-flex align-items-center"><button class="btn docs-toggle d-md-none p-0 mr-md-3 w-100" type=button data-toggle=collapse data-target=#docs-nav aria-controls=docs-nav aria-expanded=false aria-label="Toggle section navigation"><div class=d-flex><span class="d-md-none pl-1 flex-grow-1 text-left overflow-hidden">On Java 8</span>
<span><i class="fas fa-chevron-down"></i></span></div></button>
<button class="form-control sidebar-search js-search d-none d-md-flex">
<i class="fas fa-search pr-2"></i>
<span class=sidebar-search-text>搜索...</span>
<span class=sidebar-search-shortcut>/</span></button></form><nav class="collapse docs-links" id=docs-nav><ul class="nav docs-sidenav"><li style=display:inline-flex><a style=cursor:pointer onclick=window.history.back()><i class="fas fa-arrow-left pr-1"></i>
Back</a>
<span>|</span>
<a href=/books/><i class="fa-solid fa-house" style=margin-right:4px></i>
Books</a></li></ul><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-idb2e20681920018e3a6e20318a9804534")' href=#idb2e20681920018e3a6e20318a9804534 aria-expanded=false aria-controls=idb2e20681920018e3a6e20318a9804534 aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/>999.参考资料</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#idb2e20681920018e3a6e20318a9804534 aria-expanded=false aria-controls=idb2e20681920018e3a6e20318a9804534><i class="fa-solid fa-angle-down" id=caret-idb2e20681920018e3a6e20318a9804534></i></a></div><ul class="nav docs-sidenav collapse show" id=idb2e20681920018e3a6e20318a9804534><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-id4d84ffe3754d5f34aa3c13b4d1952b31")' href=#id4d84ffe3754d5f34aa3c13b4d1952b31 aria-expanded=false aria-controls=id4d84ffe3754d5f34aa3c13b4d1952b31 aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/>On Java 8</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#id4d84ffe3754d5f34aa3c13b4d1952b31 aria-expanded=false aria-controls=id4d84ffe3754d5f34aa3c13b4d1952b31><i class="fa-solid fa-angle-down" id=caret-id4d84ffe3754d5f34aa3c13b4d1952b31></i></a></div><ul class="nav docs-sidenav collapse show" id=id4d84ffe3754d5f34aa3c13b4d1952b31><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/00-introduction/>00-Introduction</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/01-what-is-an-object/>01-What-is-an-Object</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/02-installing-java-and-the-book-examples/>02-Installing-Java-and-the-Book-Examples</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/03-objects-everywhere/>03-Objects-Everywhere</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/04-operators/>04-Operators</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/05-control-flow/>05-Control-Flow</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/06-housekeeping/>06-Housekeeping</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/07-implementation-hiding/>07-Implementation-Hiding</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/08-reuse/>08-Reuse</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/09-polymorphism/>09-Polymorphism</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/10-interfaces/>10-Interfaces</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/11-inner-classes/>11-Inner-Classes</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/12-collections/>12-Collections</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/13-functional-programming/>13-Functional-Programming</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/14-streams/>14-Streams</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/15-exceptions/>15-Exceptions</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/16-validating-your-code/>16-Validating-Your-Code</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/17-files/>17-Files</a></li><li class="child level active"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/18-strings/>18-Strings</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/19-type-information/>19-Type-Information</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/20-generics/>20-Generics</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/21-arrays/>21-Arrays</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/22-enumerations/>22-Enumerations</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/23-annotations/>23-Annotations</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/24-concurrent-programming/>24-Concurrent-Programming</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/25-patterns/>25-Patterns</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/appendix-becoming-a-programmer/>Appendix-Becoming-a-Programmer</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/appendix-benefits-and-costs-of-static-type-checking/>Appendix-Benefits-and-Costs-of-Static-Type-Checking</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/appendix-collection-topics/>Appendix-Collection-Topics</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/appendix-data-compression/>Appendix-Data-Compression</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/appendix-io-streams/>Appendix-IO-Streams</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/appendix-javadoc/>Appendix-Javadoc</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/appendix-low-level-concurrency/>Appendix-Low-Level-Concurrency</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/appendix-new-io/>Appendix-New-IO</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/appendix-object-serialization/>Appendix-Object-Serialization</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/appendix-passing-and-returning-objects/>Appendix-Passing-and-Returning-Objects</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/appendix-programming-guidelines/>Appendix-Programming-Guidelines</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/appendix-standard-io/>Appendix-Standard-IO</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/appendix-supplements/>Appendix-Supplements</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/appendix-the-positive-legacy-of-c-plus-plus-and-java/>Appendix-The-Positive-Legacy-of-C-plus-plus-and-Java</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/appendix-understanding-equals-and-hashcode/>Appendix-Understanding-equals-and-hashCode</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/glossary/>GLOSSARY</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-id214ecc87c188b2007b2d478ce6167fb1")' href=#id214ecc87c188b2007b2d478ce6167fb1 aria-expanded=false aria-controls=id214ecc87c188b2007b2d478ce6167fb1 aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/>Think in Java</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#id214ecc87c188b2007b2d478ce6167fb1 aria-expanded=false aria-controls=id214ecc87c188b2007b2d478ce6167fb1><i class="fa-solid fa-angle-right" id=caret-id214ecc87c188b2007b2d478ce6167fb1></i></a></div><ul class="nav docs-sidenav collapse" id=id214ecc87c188b2007b2d478ce6167fb1><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-idca73ee751e8224db415e54c000dd27fb")' href=#idca73ee751e8224db415e54c000dd27fb aria-expanded=false aria-controls=idca73ee751e8224db415e54c000dd27fb aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/1.%E5%AF%B9%E8%B1%A1%E5%85%A5%E9%97%A8/>1.对象入门</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#idca73ee751e8224db415e54c000dd27fb aria-expanded=false aria-controls=idca73ee751e8224db415e54c000dd27fb><i class="fa-solid fa-angle-right" id=caret-idca73ee751e8224db415e54c000dd27fb></i></a></div><ul class="nav docs-sidenav collapse" id=idca73ee751e8224db415e54c000dd27fb><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/1.%E5%AF%B9%E8%B1%A1%E5%85%A5%E9%97%A8/1.1-%E6%8A%BD%E8%B1%A1%E7%9A%84%E8%BF%9B%E6%AD%A5/>1.1 抽象的进步</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/1.%E5%AF%B9%E8%B1%A1%E5%85%A5%E9%97%A8/1.10-%E6%B0%B8%E4%B9%85%E6%80%A7/>1.10 永久性</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/1.%E5%AF%B9%E8%B1%A1%E5%85%A5%E9%97%A8/1.11-java%E5%92%8C%E5%9B%A0%E7%89%B9%E7%BD%91/>1.11 Java和因特网</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/1.%E5%AF%B9%E8%B1%A1%E5%85%A5%E9%97%A8/1.12-%E5%88%86%E6%9E%90%E5%92%8C%E8%AE%BE%E8%AE%A1/>1.12 分析和设计</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/1.%E5%AF%B9%E8%B1%A1%E5%85%A5%E9%97%A8/1.13-java%E8%BF%98%E6%98%AFc++/>1.13 Java还是C++</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/1.%E5%AF%B9%E8%B1%A1%E5%85%A5%E9%97%A8/1.2-%E5%AF%B9%E8%B1%A1%E7%9A%84%E6%8E%A5%E5%8F%A3/>1.2 对象的接口</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/1.%E5%AF%B9%E8%B1%A1%E5%85%A5%E9%97%A8/1.3-%E5%AE%9E%E7%8E%B0%E6%96%B9%E6%A1%88%E7%9A%84%E9%9A%90%E8%97%8F/>1.3 实现方案的隐藏</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/1.%E5%AF%B9%E8%B1%A1%E5%85%A5%E9%97%A8/1.4-%E6%96%B9%E6%A1%88%E7%9A%84%E9%87%8D%E5%A4%8D%E4%BD%BF%E7%94%A8/>1.4 方案的重复使用</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/1.%E5%AF%B9%E8%B1%A1%E5%85%A5%E9%97%A8/1.5-%E7%BB%A7%E6%89%BF%E9%87%8D%E6%96%B0%E4%BD%BF%E7%94%A8%E6%8E%A5%E5%8F%A3/>1.5 继承：重新使用接口</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/1.%E5%AF%B9%E8%B1%A1%E5%85%A5%E9%97%A8/1.6-%E5%A4%9A%E6%80%81%E5%AF%B9%E8%B1%A1%E7%9A%84%E4%BA%92%E6%8D%A2%E4%BD%BF%E7%94%A8/>1.6 多态对象的互换使用</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/1.%E5%AF%B9%E8%B1%A1%E5%85%A5%E9%97%A8/1.7-%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%88%9B%E5%BB%BA%E5%92%8C%E5%AD%98%E5%9C%A8%E6%97%B6%E9%97%B4/>1.7 对象的创建和存在时间</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/1.%E5%AF%B9%E8%B1%A1%E5%85%A5%E9%97%A8/1.9-%E5%A4%9A%E7%BA%BF%E7%A8%8B/>1.9 多线程</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-ide41bfd2e5eef4f5cc967d0bf0d3beae5")' href=#ide41bfd2e5eef4f5cc967d0bf0d3beae5 aria-expanded=false aria-controls=ide41bfd2e5eef4f5cc967d0bf0d3beae5 aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/10.java-io-%E7%B3%BB%E7%BB%9F/>10.Java IO 系统</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#ide41bfd2e5eef4f5cc967d0bf0d3beae5 aria-expanded=false aria-controls=ide41bfd2e5eef4f5cc967d0bf0d3beae5><i class="fa-solid fa-angle-right" id=caret-ide41bfd2e5eef4f5cc967d0bf0d3beae5></i></a></div><ul class="nav docs-sidenav collapse" id=ide41bfd2e5eef4f5cc967d0bf0d3beae5><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/10.java-io-%E7%B3%BB%E7%BB%9F/10.1-%E8%BE%93%E5%85%A5%E5%92%8C%E8%BE%93%E5%87%BA/>10.1 输入和输出</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/10.java-io-%E7%B3%BB%E7%BB%9F/10.10-%E6%80%BB%E7%BB%93/>10.10 总结</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/10.java-io-%E7%B3%BB%E7%BB%9F/10.11-%E7%BB%83%E4%B9%A0/>10.11 练习</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/10.java-io-%E7%B3%BB%E7%BB%9F/10.2-%E5%A2%9E%E6%B7%BB%E5%B1%9E%E6%80%A7%E5%92%8C%E6%9C%89%E7%94%A8%E7%9A%84%E6%8E%A5%E5%8F%A3/>10.2 增添属性和有用的接口</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/10.java-io-%E7%B3%BB%E7%BB%9F/10.3-%E6%9C%AC%E8%BA%AB%E7%9A%84%E7%BC%BA%E9%99%B7randomaccessfile/>10.3 本身的缺陷：RandomAccessFile</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/10.java-io-%E7%B3%BB%E7%BB%9F/10.4-file%E7%B1%BB/>10.4 File类</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/10.java-io-%E7%B3%BB%E7%BB%9F/10.5-io%E6%B5%81%E7%9A%84%E5%85%B8%E5%9E%8B%E5%BA%94%E7%94%A8/>10.5 IO流的典型应用</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/10.java-io-%E7%B3%BB%E7%BB%9F/10.6-streamtokenizer/>10.6 StreamTokenizer</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/10.java-io-%E7%B3%BB%E7%BB%9F/10.7-java-1.1%E7%9A%84io%E6%B5%81/>10.7 Java 1.1的IO流</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/10.java-io-%E7%B3%BB%E7%BB%9F/10.8-%E5%8E%8B%E7%BC%A9/>10.8 压缩</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/10.java-io-%E7%B3%BB%E7%BB%9F/10.9-%E5%AF%B9%E8%B1%A1%E5%BA%8F%E5%88%97%E5%8C%96/>10.9 对象序列化</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-idb836ac598092c15afaccbaa2c465c59e")' href=#idb836ac598092c15afaccbaa2c465c59e aria-expanded=false aria-controls=idb836ac598092c15afaccbaa2c465c59e aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/11.%E8%BF%90%E8%A1%8C%E6%9C%9F%E7%B1%BB%E5%9E%8B%E9%89%B4%E5%AE%9A/>11.运行期类型鉴定</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#idb836ac598092c15afaccbaa2c465c59e aria-expanded=false aria-controls=idb836ac598092c15afaccbaa2c465c59e><i class="fa-solid fa-angle-right" id=caret-idb836ac598092c15afaccbaa2c465c59e></i></a></div><ul class="nav docs-sidenav collapse" id=idb836ac598092c15afaccbaa2c465c59e><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/11.%E8%BF%90%E8%A1%8C%E6%9C%9F%E7%B1%BB%E5%9E%8B%E9%89%B4%E5%AE%9A/11.1-%E5%AF%B9rtti%E7%9A%84%E9%9C%80%E8%A6%81/>11.1 对RTTI的需要</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/11.%E8%BF%90%E8%A1%8C%E6%9C%9F%E7%B1%BB%E5%9E%8B%E9%89%B4%E5%AE%9A/11.2-rtti-%E8%AF%AD%E6%B3%95/>11.2 RTTI 语法</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/11.%E8%BF%90%E8%A1%8C%E6%9C%9F%E7%B1%BB%E5%9E%8B%E9%89%B4%E5%AE%9A/11.3-%E5%8F%8D%E5%B0%84%E8%BF%90%E8%A1%8C%E6%9C%9F%E7%B1%BB%E4%BF%A1%E6%81%AF/>11.3 反射：运行期类信息</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/11.%E8%BF%90%E8%A1%8C%E6%9C%9F%E7%B1%BB%E5%9E%8B%E9%89%B4%E5%AE%9A/11.4-%E6%80%BB%E7%BB%93/>11.4 总结</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/11.%E8%BF%90%E8%A1%8C%E6%9C%9F%E7%B1%BB%E5%9E%8B%E9%89%B4%E5%AE%9A/11.5-%E7%BB%83%E4%B9%A0/>11.5 练习</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-ide320911890134774be5931d1a0a20cc9")' href=#ide320911890134774be5931d1a0a20cc9 aria-expanded=false aria-controls=ide320911890134774be5931d1a0a20cc9 aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/12.%E4%BC%A0%E9%80%92%E5%92%8C%E8%BF%94%E5%9B%9E%E5%AF%B9%E8%B1%A1/>12.传递和返回对象</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#ide320911890134774be5931d1a0a20cc9 aria-expanded=false aria-controls=ide320911890134774be5931d1a0a20cc9><i class="fa-solid fa-angle-right" id=caret-ide320911890134774be5931d1a0a20cc9></i></a></div><ul class="nav docs-sidenav collapse" id=ide320911890134774be5931d1a0a20cc9><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/12.%E4%BC%A0%E9%80%92%E5%92%8C%E8%BF%94%E5%9B%9E%E5%AF%B9%E8%B1%A1/12.1-%E4%BC%A0%E9%80%92%E6%8C%87%E9%92%88/>12.1 传递指针</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/12.%E4%BC%A0%E9%80%92%E5%92%8C%E8%BF%94%E5%9B%9E%E5%AF%B9%E8%B1%A1/12.2-%E5%88%B6%E4%BD%9C%E6%9C%AC%E5%9C%B0%E5%89%AF%E6%9C%AC/>12.2 制作本地副本</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/12.%E4%BC%A0%E9%80%92%E5%92%8C%E8%BF%94%E5%9B%9E%E5%AF%B9%E8%B1%A1/12.3-%E5%85%8B%E9%9A%86%E7%9A%84%E6%8E%A7%E5%88%B6/>12.3 克隆的控制</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/12.%E4%BC%A0%E9%80%92%E5%92%8C%E8%BF%94%E5%9B%9E%E5%AF%B9%E8%B1%A1/12.4-%E5%8F%AA%E8%AF%BB%E7%B1%BB/>12.4 只读类</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/12.%E4%BC%A0%E9%80%92%E5%92%8C%E8%BF%94%E5%9B%9E%E5%AF%B9%E8%B1%A1/12.5-%E6%80%BB%E7%BB%93/>12.5 总结</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/12.%E4%BC%A0%E9%80%92%E5%92%8C%E8%BF%94%E5%9B%9E%E5%AF%B9%E8%B1%A1/12.6-%E7%BB%83%E4%B9%A0/>12.6 练习</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-iddba1dfa22d26f49d68205d3c67fa5695")' href=#iddba1dfa22d26f49d68205d3c67fa5695 aria-expanded=false aria-controls=iddba1dfa22d26f49d68205d3c67fa5695 aria-hidden=false data-toggle=collapse></div></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-idbb7b9ed9f3766574125ce978e02ab9b3")' href=#idbb7b9ed9f3766574125ce978e02ab9b3 aria-expanded=false aria-controls=idbb7b9ed9f3766574125ce978e02ab9b3 aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/14.%E5%A4%9A%E7%BA%BF%E7%A8%8B/>14.多线程</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#idbb7b9ed9f3766574125ce978e02ab9b3 aria-expanded=false aria-controls=idbb7b9ed9f3766574125ce978e02ab9b3><i class="fa-solid fa-angle-right" id=caret-idbb7b9ed9f3766574125ce978e02ab9b3></i></a></div><ul class="nav docs-sidenav collapse" id=idbb7b9ed9f3766574125ce978e02ab9b3><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/14.%E5%A4%9A%E7%BA%BF%E7%A8%8B/14.1-%E5%8F%8D%E5%BA%94%E7%81%B5%E6%95%8F%E7%9A%84%E7%94%A8%E6%88%B7%E7%95%8C%E9%9D%A2/>14.1 反应灵敏的用户界面</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/14.%E5%A4%9A%E7%BA%BF%E7%A8%8B/14.2-%E5%85%B1%E4%BA%AB%E6%9C%89%E9%99%90%E7%9A%84%E8%B5%84%E6%BA%90/>14.2 共享有限的资源</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/14.%E5%A4%9A%E7%BA%BF%E7%A8%8B/14.3-%E5%A0%B5%E5%A1%9E/>14.3 堵塞</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/14.%E5%A4%9A%E7%BA%BF%E7%A8%8B/14.4-%E4%BC%98%E5%85%88%E7%BA%A7/>14.4 优先级</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/14.%E5%A4%9A%E7%BA%BF%E7%A8%8B/14.5-%E5%9B%9E%E9%A1%BErunnable/>14.5 回顾runnable</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/14.%E5%A4%9A%E7%BA%BF%E7%A8%8B/14.6-%E6%80%BB%E7%BB%93/>14.6 总结</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/14.%E5%A4%9A%E7%BA%BF%E7%A8%8B/14.7-%E7%BB%83%E4%B9%A0/>14.7 练习</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-id0717cbd205b42e749ff12487fe013a48")' href=#id0717cbd205b42e749ff12487fe013a48 aria-expanded=false aria-controls=id0717cbd205b42e749ff12487fe013a48 aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/15.%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/>15.网络编程</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#id0717cbd205b42e749ff12487fe013a48 aria-expanded=false aria-controls=id0717cbd205b42e749ff12487fe013a48><i class="fa-solid fa-angle-right" id=caret-id0717cbd205b42e749ff12487fe013a48></i></a></div><ul class="nav docs-sidenav collapse" id=id0717cbd205b42e749ff12487fe013a48><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/15.%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/15.1-%E6%9C%BA%E5%99%A8%E7%9A%84%E6%A0%87%E8%AF%86/>15.1 机器的标识</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/15.%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/15.10-%E7%BB%83%E4%B9%A0/>15.10 练习</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/15.%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/15.2-%E5%A5%97%E6%8E%A5%E5%AD%97/>15.2 套接字</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/15.%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/15.3-%E6%9C%8D%E5%8A%A1%E5%A4%9A%E4%B8%AA%E5%AE%A2%E6%88%B7/>15.3 服务多个客户</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/15.%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/15.4-%E6%95%B0%E6%8D%AE%E6%8A%A5/>15.4 数据报</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/15.%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/15.5-%E4%B8%80%E4%B8%AAweb%E5%BA%94%E7%94%A8/>15.5 一个Web应用</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/15.%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/15.6-java%E4%B8%8Ecgi%E7%9A%84%E6%B2%9F%E9%80%9A/>15.6 Java与CGI的沟通</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/15.%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/15.7-%E7%94%A8jdbc%E8%BF%9E%E6%8E%A5%E6%95%B0%E6%8D%AE%E5%BA%93/>15.7 用JDBC连接数据库</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/15.%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/15.8-%E8%BF%9C%E7%A8%8B%E6%96%B9%E6%B3%95/>15.8 远程方法</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/15.%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/15.9-%E6%80%BB%E7%BB%93/>15.9 总结</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-idb45833a961ce68d05972119f0bd5689d")' href=#idb45833a961ce68d05972119f0bd5689d aria-expanded=false aria-controls=idb45833a961ce68d05972119f0bd5689d aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/16.%E8%AE%BE%E8%AE%A1%E8%8C%83%E5%BC%8F/>16.设计范式</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#idb45833a961ce68d05972119f0bd5689d aria-expanded=false aria-controls=idb45833a961ce68d05972119f0bd5689d><i class="fa-solid fa-angle-right" id=caret-idb45833a961ce68d05972119f0bd5689d></i></a></div><ul class="nav docs-sidenav collapse" id=idb45833a961ce68d05972119f0bd5689d><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/16.%E8%AE%BE%E8%AE%A1%E8%8C%83%E5%BC%8F/16.1-%E8%8C%83%E5%BC%8F%E7%9A%84%E6%A6%82%E5%BF%B5/>16.1 范式的概念</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/16.%E8%AE%BE%E8%AE%A1%E8%8C%83%E5%BC%8F/16.10-%E7%BB%83%E4%B9%A0/>16.10 练习</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/16.%E8%AE%BE%E8%AE%A1%E8%8C%83%E5%BC%8F/16.2-%E8%A7%82%E5%AF%9F%E5%99%A8%E8%8C%83%E5%BC%8F/>16.2 观察器范式</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/16.%E8%AE%BE%E8%AE%A1%E8%8C%83%E5%BC%8F/16.3-%E6%A8%A1%E6%8B%9F%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6%E7%AB%99/>16.3 模拟垃圾回收站</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/16.%E8%AE%BE%E8%AE%A1%E8%8C%83%E5%BC%8F/16.4-%E6%94%B9%E8%BF%9B%E8%AE%BE%E8%AE%A1/>16.4 改进设计</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/16.%E8%AE%BE%E8%AE%A1%E8%8C%83%E5%BC%8F/16.5-%E6%8A%BD%E8%B1%A1%E7%9A%84%E5%BA%94%E7%94%A8/>16.5 抽象的应用</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/16.%E8%AE%BE%E8%AE%A1%E8%8C%83%E5%BC%8F/16.6-%E5%A4%9A%E9%87%8D%E6%B4%BE%E9%81%A3/>16.6 多重派遣</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/16.%E8%AE%BE%E8%AE%A1%E8%8C%83%E5%BC%8F/16.7-%E8%AE%BF%E9%97%AE%E5%99%A8%E8%8C%83%E5%BC%8F/>16.7 访问器范式</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/16.%E8%AE%BE%E8%AE%A1%E8%8C%83%E5%BC%8F/16.8-rtti%E7%9C%9F%E7%9A%84%E6%9C%89%E5%AE%B3%E5%90%97/>16.8 RTTI真的有害吗</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/16.%E8%AE%BE%E8%AE%A1%E8%8C%83%E5%BC%8F/16.9-%E6%80%BB%E7%BB%93/>16.9 总结</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-id9dcdb57b589db03f63de5260a0331b23")' href=#id9dcdb57b589db03f63de5260a0331b23 aria-expanded=false aria-controls=id9dcdb57b589db03f63de5260a0331b23 aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/17.%E9%A1%B9%E7%9B%AE/>17.项目</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#id9dcdb57b589db03f63de5260a0331b23 aria-expanded=false aria-controls=id9dcdb57b589db03f63de5260a0331b23><i class="fa-solid fa-angle-right" id=caret-id9dcdb57b589db03f63de5260a0331b23></i></a></div><ul class="nav docs-sidenav collapse" id=id9dcdb57b589db03f63de5260a0331b23><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/17.%E9%A1%B9%E7%9B%AE/17.1-%E6%96%87%E5%AD%97%E5%A4%84%E7%90%86/>17.1 文字处理</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/17.%E9%A1%B9%E7%9B%AE/17.2-%E6%96%B9%E6%B3%95%E6%9F%A5%E6%89%BE%E5%B7%A5%E5%85%B7/>17.2 方法查找工具</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/17.%E9%A1%B9%E7%9B%AE/17.3-%E5%A4%8D%E6%9D%82%E6%80%A7%E7%90%86%E8%AE%BA/>17.3 复杂性理论</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/17.%E9%A1%B9%E7%9B%AE/17.4-%E6%80%BB%E7%BB%93/>17.4 总结</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/17.%E9%A1%B9%E7%9B%AE/17.5-%E7%BB%83%E4%B9%A0/>17.5 练习</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-idf0960bbb6faeb4cccffb1ac69252ea28")' href=#idf0960bbb6faeb4cccffb1ac69252ea28 aria-expanded=false aria-controls=idf0960bbb6faeb4cccffb1ac69252ea28 aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/2.%E4%B8%80%E5%88%87%E9%83%BD%E6%98%AF%E5%AF%B9%E8%B1%A1/>2.一切都是对象</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#idf0960bbb6faeb4cccffb1ac69252ea28 aria-expanded=false aria-controls=idf0960bbb6faeb4cccffb1ac69252ea28><i class="fa-solid fa-angle-right" id=caret-idf0960bbb6faeb4cccffb1ac69252ea28></i></a></div><ul class="nav docs-sidenav collapse" id=idf0960bbb6faeb4cccffb1ac69252ea28><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/2.%E4%B8%80%E5%88%87%E9%83%BD%E6%98%AF%E5%AF%B9%E8%B1%A1/2.1-%E7%94%A8%E6%8C%87%E9%92%88%E6%93%8D%E7%BA%B5%E5%AF%B9%E8%B1%A1/>2.1 用指针操纵对象</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/2.%E4%B8%80%E5%88%87%E9%83%BD%E6%98%AF%E5%AF%B9%E8%B1%A1/2.10-%E6%80%BB%E7%BB%93/>2.10 总结</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/2.%E4%B8%80%E5%88%87%E9%83%BD%E6%98%AF%E5%AF%B9%E8%B1%A1/2.11-%E7%BB%83%E4%B9%A0/>2.11 练习</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/2.%E4%B8%80%E5%88%87%E9%83%BD%E6%98%AF%E5%AF%B9%E8%B1%A1/2.2-%E6%89%80%E6%9C%89%E5%AF%B9%E8%B1%A1%E9%83%BD%E5%BF%85%E9%A1%BB%E5%88%9B%E5%BB%BA/>2.2 所有对象都必须创建</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/2.%E4%B8%80%E5%88%87%E9%83%BD%E6%98%AF%E5%AF%B9%E8%B1%A1/2.3-%E7%BB%9D%E5%AF%B9%E4%B8%8D%E8%A6%81%E6%B8%85%E9%99%A4%E5%AF%B9%E8%B1%A1/>2.3 绝对不要清除对象</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/2.%E4%B8%80%E5%88%87%E9%83%BD%E6%98%AF%E5%AF%B9%E8%B1%A1/2.4-%E6%96%B0%E5%BB%BA%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E7%B1%BB/>2.4 新建数据类型：类</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/2.%E4%B8%80%E5%88%87%E9%83%BD%E6%98%AF%E5%AF%B9%E8%B1%A1/2.5-%E6%96%B9%E6%B3%95%E8%87%AA%E5%8F%98%E9%87%8F%E5%92%8C%E8%BF%94%E5%9B%9E%E5%80%BC/>2.5 方法、自变量和返回值</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/2.%E4%B8%80%E5%88%87%E9%83%BD%E6%98%AF%E5%AF%B9%E8%B1%A1/2.6-%E6%9E%84%E5%BB%BAjava%E7%A8%8B%E5%BA%8F/>2.6 构建Java程序</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/2.%E4%B8%80%E5%88%87%E9%83%BD%E6%98%AF%E5%AF%B9%E8%B1%A1/2.7-%E6%88%91%E4%BB%AC%E7%9A%84%E7%AC%AC%E4%B8%80%E4%B8%AAjava%E7%A8%8B%E5%BA%8F/>2.7 我们的第一个Java程序</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/2.%E4%B8%80%E5%88%87%E9%83%BD%E6%98%AF%E5%AF%B9%E8%B1%A1/2.8-%E6%B3%A8%E9%87%8A%E5%92%8C%E5%B5%8C%E5%85%A5%E6%96%87%E6%A1%A3/>2.8 注释和嵌入文档</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/2.%E4%B8%80%E5%88%87%E9%83%BD%E6%98%AF%E5%AF%B9%E8%B1%A1/2.9-%E7%BC%96%E7%A0%81%E6%A0%B7%E5%BC%8F/>2.9 编码样式</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-id742622a5c8a24c8f9f9a1ecc037a0f62")' href=#id742622a5c8a24c8f9f9a1ecc037a0f62 aria-expanded=false aria-controls=id742622a5c8a24c8f9f9a1ecc037a0f62 aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/3.%E6%8E%A7%E5%88%B6%E7%A8%8B%E5%BA%8F%E6%B5%81%E7%A8%8B/>3.控制程序流程</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#id742622a5c8a24c8f9f9a1ecc037a0f62 aria-expanded=false aria-controls=id742622a5c8a24c8f9f9a1ecc037a0f62><i class="fa-solid fa-angle-right" id=caret-id742622a5c8a24c8f9f9a1ecc037a0f62></i></a></div><ul class="nav docs-sidenav collapse" id=id742622a5c8a24c8f9f9a1ecc037a0f62><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/3.%E6%8E%A7%E5%88%B6%E7%A8%8B%E5%BA%8F%E6%B5%81%E7%A8%8B/3.1-%E4%BD%BF%E7%94%A8java%E8%BF%90%E7%AE%97%E7%AC%A6/>3.1 使用Java运算符</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/3.%E6%8E%A7%E5%88%B6%E7%A8%8B%E5%BA%8F%E6%B5%81%E7%A8%8B/3.2-%E6%89%A7%E8%A1%8C%E6%8E%A7%E5%88%B6/>3.2 执行控制</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/3.%E6%8E%A7%E5%88%B6%E7%A8%8B%E5%BA%8F%E6%B5%81%E7%A8%8B/3.3-%E6%80%BB%E7%BB%93/>3.3 总结</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/3.%E6%8E%A7%E5%88%B6%E7%A8%8B%E5%BA%8F%E6%B5%81%E7%A8%8B/3.4-%E7%BB%83%E4%B9%A0/>3.4 练习</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-idada88f416ec1dfab89f033bf872d6408")' href=#idada88f416ec1dfab89f033bf872d6408 aria-expanded=false aria-controls=idada88f416ec1dfab89f033bf872d6408 aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/4.%E5%88%9D%E5%A7%8B%E5%8C%96%E5%92%8C%E6%B8%85%E9%99%A4/>4.初始化和清除</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#idada88f416ec1dfab89f033bf872d6408 aria-expanded=false aria-controls=idada88f416ec1dfab89f033bf872d6408><i class="fa-solid fa-angle-right" id=caret-idada88f416ec1dfab89f033bf872d6408></i></a></div><ul class="nav docs-sidenav collapse" id=idada88f416ec1dfab89f033bf872d6408><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/4.%E5%88%9D%E5%A7%8B%E5%8C%96%E5%92%8C%E6%B8%85%E9%99%A4/4.1-%E7%94%A8%E6%9E%84%E9%80%A0%E5%99%A8%E8%87%AA%E5%8A%A8%E5%88%9D%E5%A7%8B%E5%8C%96/>4.1 用构造器自动初始化</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/4.%E5%88%9D%E5%A7%8B%E5%8C%96%E5%92%8C%E6%B8%85%E9%99%A4/4.2-%E6%96%B9%E6%B3%95%E9%87%8D%E8%BD%BD/>4.2 方法重载</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/4.%E5%88%9D%E5%A7%8B%E5%8C%96%E5%92%8C%E6%B8%85%E9%99%A4/4.3-%E6%B8%85%E9%99%A4%E6%94%B6%E5%B0%BE%E5%92%8C%E5%9E%83%E5%9C%BE%E6%94%B6%E9%9B%86/>4.3 清除：收尾和垃圾收集</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/4.%E5%88%9D%E5%A7%8B%E5%8C%96%E5%92%8C%E6%B8%85%E9%99%A4/4.4-%E6%88%90%E5%91%98%E5%88%9D%E5%A7%8B%E5%8C%96/>4.4 成员初始化</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/4.%E5%88%9D%E5%A7%8B%E5%8C%96%E5%92%8C%E6%B8%85%E9%99%A4/4.5-%E6%95%B0%E7%BB%84%E5%88%9D%E5%A7%8B%E5%8C%96/>4.5 数组初始化</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/4.%E5%88%9D%E5%A7%8B%E5%8C%96%E5%92%8C%E6%B8%85%E9%99%A4/4.6-%E6%80%BB%E7%BB%93/>4.6 总结</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/4.%E5%88%9D%E5%A7%8B%E5%8C%96%E5%92%8C%E6%B8%85%E9%99%A4/4.7-%E7%BB%83%E4%B9%A0/>4.7 练习</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-idadcf0cac1c984df3c4fe242a8cf5b932")' href=#idadcf0cac1c984df3c4fe242a8cf5b932 aria-expanded=false aria-controls=idadcf0cac1c984df3c4fe242a8cf5b932 aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/5.%E9%9A%90%E8%97%8F%E5%AE%9E%E6%96%BD%E8%BF%87%E7%A8%8B/>5.隐藏实施过程</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#idadcf0cac1c984df3c4fe242a8cf5b932 aria-expanded=false aria-controls=idadcf0cac1c984df3c4fe242a8cf5b932><i class="fa-solid fa-angle-right" id=caret-idadcf0cac1c984df3c4fe242a8cf5b932></i></a></div><ul class="nav docs-sidenav collapse" id=idadcf0cac1c984df3c4fe242a8cf5b932><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/5.%E9%9A%90%E8%97%8F%E5%AE%9E%E6%96%BD%E8%BF%87%E7%A8%8B/5.1-%E5%8C%85%E5%BA%93%E5%8D%95%E5%85%83/>5.1 包：库单元</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/5.%E9%9A%90%E8%97%8F%E5%AE%9E%E6%96%BD%E8%BF%87%E7%A8%8B/5.2-java%E8%AE%BF%E9%97%AE%E6%8C%87%E7%A4%BA%E7%AC%A6/>5.2 Java访问指示符</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/5.%E9%9A%90%E8%97%8F%E5%AE%9E%E6%96%BD%E8%BF%87%E7%A8%8B/5.3-%E6%8E%A5%E5%8F%A3%E4%B8%8E%E5%AE%9E%E7%8E%B0/>5.3 接口与实现</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/5.%E9%9A%90%E8%97%8F%E5%AE%9E%E6%96%BD%E8%BF%87%E7%A8%8B/5.4-%E7%B1%BB%E8%AE%BF%E9%97%AE/>5.4 类访问</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/5.%E9%9A%90%E8%97%8F%E5%AE%9E%E6%96%BD%E8%BF%87%E7%A8%8B/5.5-%E6%80%BB%E7%BB%93/>5.5 总结</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/5.%E9%9A%90%E8%97%8F%E5%AE%9E%E6%96%BD%E8%BF%87%E7%A8%8B/5.6-%E7%BB%83%E4%B9%A0/>5.6 练习</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-id867e4ec83e2a44d87f6aed649979a0c1")' href=#id867e4ec83e2a44d87f6aed649979a0c1 aria-expanded=false aria-controls=id867e4ec83e2a44d87f6aed649979a0c1 aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/6.%E7%B1%BB%E5%86%8D%E7%94%9F/>6.类再生</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#id867e4ec83e2a44d87f6aed649979a0c1 aria-expanded=false aria-controls=id867e4ec83e2a44d87f6aed649979a0c1><i class="fa-solid fa-angle-right" id=caret-id867e4ec83e2a44d87f6aed649979a0c1></i></a></div><ul class="nav docs-sidenav collapse" id=id867e4ec83e2a44d87f6aed649979a0c1><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/6.%E7%B1%BB%E5%86%8D%E7%94%9F/6.1-%E5%90%88%E6%88%90%E7%9A%84%E8%AF%AD%E6%B3%95/>6.1 合成的语法</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/6.%E7%B1%BB%E5%86%8D%E7%94%9F/6.10-%E6%80%BB%E7%BB%93/>6.10 总结</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/6.%E7%B1%BB%E5%86%8D%E7%94%9F/6.11-%E7%BB%83%E4%B9%A0/>6.11 练习</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/6.%E7%B1%BB%E5%86%8D%E7%94%9F/6.2-%E7%BB%A7%E6%89%BF%E7%9A%84%E8%AF%AD%E6%B3%95/>6.2 继承的语法</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/6.%E7%B1%BB%E5%86%8D%E7%94%9F/6.3-%E5%90%88%E6%88%90%E4%B8%8E%E7%BB%A7%E6%89%BF%E7%9A%84%E7%BB%93%E5%90%88/>6.3 合成与继承的结合</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/6.%E7%B1%BB%E5%86%8D%E7%94%9F/6.4-%E5%88%B0%E5%BA%95%E9%80%89%E6%8B%A9%E5%90%88%E6%88%90%E8%BF%98%E6%98%AF%E7%BB%A7%E6%89%BF/>6.4 到底选择合成还是继承</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/6.%E7%B1%BB%E5%86%8D%E7%94%9F/6.5-protected/>6.5 protected</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/6.%E7%B1%BB%E5%86%8D%E7%94%9F/6.6-%E7%B4%AF%E7%A7%AF%E5%BC%80%E5%8F%91/>6.6 累积开发</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/6.%E7%B1%BB%E5%86%8D%E7%94%9F/6.7-%E4%B8%8A%E6%BA%AF%E9%80%A0%E5%9E%8B/>6.7 上溯造型</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/6.%E7%B1%BB%E5%86%8D%E7%94%9F/6.8-final%E5%85%B3%E9%94%AE%E5%AD%97/>6.8 final关键字</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/6.%E7%B1%BB%E5%86%8D%E7%94%9F/6.9-%E5%88%9D%E5%A7%8B%E5%8C%96%E5%92%8C%E7%B1%BB%E8%A3%85%E8%BD%BD/>6.9 初始化和类装载</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-idf3d9d72d599cb56e323c67f4c3e5106c")' href=#idf3d9d72d599cb56e323c67f4c3e5106c aria-expanded=false aria-controls=idf3d9d72d599cb56e323c67f4c3e5106c aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/7.%E5%A4%9A%E6%80%81%E6%80%A7/>7.多态性</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#idf3d9d72d599cb56e323c67f4c3e5106c aria-expanded=false aria-controls=idf3d9d72d599cb56e323c67f4c3e5106c><i class="fa-solid fa-angle-right" id=caret-idf3d9d72d599cb56e323c67f4c3e5106c></i></a></div><ul class="nav docs-sidenav collapse" id=idf3d9d72d599cb56e323c67f4c3e5106c><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/7.%E5%A4%9A%E6%80%81%E6%80%A7/7.1-%E4%B8%8A%E6%BA%AF%E9%80%A0%E5%9E%8B/>7.1 上溯造型</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/7.%E5%A4%9A%E6%80%81%E6%80%A7/7.10-%E7%BB%83%E4%B9%A0/>7.10 练习</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/7.%E5%A4%9A%E6%80%81%E6%80%A7/7.2-%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3/>7.2 深入理解</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/7.%E5%A4%9A%E6%80%81%E6%80%A7/7.3-%E8%A6%86%E7%9B%96%E4%B8%8E%E9%87%8D%E8%BD%BD/>7.3 覆盖与重载</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/7.%E5%A4%9A%E6%80%81%E6%80%A7/7.4-%E6%8A%BD%E8%B1%A1%E7%B1%BB%E5%92%8C%E6%96%B9%E6%B3%95/>7.4 抽象类和方法</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/7.%E5%A4%9A%E6%80%81%E6%80%A7/7.5-%E6%8E%A5%E5%8F%A3/>7.5 接口</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/7.%E5%A4%9A%E6%80%81%E6%80%A7/7.6-%E5%86%85%E9%83%A8%E7%B1%BB/>7.6 内部类</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/7.%E5%A4%9A%E6%80%81%E6%80%A7/7.7-%E6%9E%84%E9%80%A0%E5%99%A8%E5%92%8C%E5%A4%9A%E6%80%81%E6%80%A7/>7.7 构造器和多态性</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/7.%E5%A4%9A%E6%80%81%E6%80%A7/7.8-%E9%80%9A%E8%BF%87%E7%BB%A7%E6%89%BF%E8%BF%9B%E8%A1%8C%E8%AE%BE%E8%AE%A1/>7.8 通过继承进行设计</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/7.%E5%A4%9A%E6%80%81%E6%80%A7/7.9-%E6%80%BB%E7%BB%93/>7.9 总结</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-ide8fec1c6956e847a0af483b3edf921cd")' href=#ide8fec1c6956e847a0af483b3edf921cd aria-expanded=false aria-controls=ide8fec1c6956e847a0af483b3edf921cd aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/8.%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%AE%B9%E7%BA%B3/>8.对象的容纳</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#ide8fec1c6956e847a0af483b3edf921cd aria-expanded=false aria-controls=ide8fec1c6956e847a0af483b3edf921cd><i class="fa-solid fa-angle-right" id=caret-ide8fec1c6956e847a0af483b3edf921cd></i></a></div><ul class="nav docs-sidenav collapse" id=ide8fec1c6956e847a0af483b3edf921cd><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/8.%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%AE%B9%E7%BA%B3/8.1-%E6%95%B0%E7%BB%84/>8.1 数组</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/8.%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%AE%B9%E7%BA%B3/8.2-%E9%9B%86%E5%90%88/>8.2 集合</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/8.%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%AE%B9%E7%BA%B3/8.3-%E8%BF%AD%E4%BB%A3%E5%99%A8/>8.3 迭代器</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/8.%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%AE%B9%E7%BA%B3/8.4-%E9%9B%86%E5%90%88%E7%9A%84%E7%B1%BB%E5%9E%8B/>8.4 集合的类型</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/8.%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%AE%B9%E7%BA%B3/8.5-%E6%8E%92%E5%BA%8F/>8.5 排序</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/8.%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%AE%B9%E7%BA%B3/8.6-%E9%80%9A%E7%94%A8%E9%9B%86%E5%90%88%E5%BA%93/>8.6 通用集合库</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/8.%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%AE%B9%E7%BA%B3/8.7-%E6%96%B0%E9%9B%86%E5%90%88/>8.7 新集合</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/8.%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%AE%B9%E7%BA%B3/8.8-%E6%80%BB%E7%BB%93/>8.8 总结</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/8.%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%AE%B9%E7%BA%B3/8.9-%E7%BB%83%E4%B9%A0/>8.9 练习</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-id24b0f4bf6b1849b1d34cc1cf59d9a598")' href=#id24b0f4bf6b1849b1d34cc1cf59d9a598 aria-expanded=false aria-controls=id24b0f4bf6b1849b1d34cc1cf59d9a598 aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/9.%E5%BC%82%E5%B8%B8%E5%B7%AE%E9%94%99%E6%8E%A7%E5%88%B6/>9.异常差错控制</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#id24b0f4bf6b1849b1d34cc1cf59d9a598 aria-expanded=false aria-controls=id24b0f4bf6b1849b1d34cc1cf59d9a598><i class="fa-solid fa-angle-right" id=caret-id24b0f4bf6b1849b1d34cc1cf59d9a598></i></a></div><ul class="nav docs-sidenav collapse" id=id24b0f4bf6b1849b1d34cc1cf59d9a598><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/9.%E5%BC%82%E5%B8%B8%E5%B7%AE%E9%94%99%E6%8E%A7%E5%88%B6/9.10-%E7%BB%83%E4%B9%A0/>9.10 练习</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/9.%E5%BC%82%E5%B8%B8%E5%B7%AE%E9%94%99%E6%8E%A7%E5%88%B6/9.6-%E7%94%A8finally%E6%B8%85%E9%99%A4/>9.6 用finally清除</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/9.%E5%BC%82%E5%B8%B8%E5%B7%AE%E9%94%99%E6%8E%A7%E5%88%B6/9.7-%E6%9E%84%E9%80%A0%E5%99%A8/>9.7 构造器</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/9.%E5%BC%82%E5%B8%B8%E5%B7%AE%E9%94%99%E6%8E%A7%E5%88%B6/9.9-%E6%80%BB%E7%BB%93/>9.9 总结</a></li></ul></div><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/%E9%99%84%E5%BD%95a-%E4%BD%BF%E7%94%A8%E9%9D%9Ejava%E4%BB%A3%E7%A0%81/>附录A 使用非JAVA代码</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/%E9%99%84%E5%BD%95b-%E5%AF%B9%E6%AF%94c++%E5%92%8Cjava/>附录B 对比C++和Java</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/%E9%99%84%E5%BD%95c-java%E7%BC%96%E7%A8%8B%E8%A7%84%E5%88%99/>附录C Java编程规则</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/%E9%99%84%E5%BD%95d-%E6%80%A7%E8%83%BD/>附录D 性能</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/%E9%99%84%E5%BD%95e-%E5%85%B3%E4%BA%8E%E5%9E%83%E5%9C%BE%E6%94%B6%E9%9B%86%E7%9A%84%E4%B8%80%E4%BA%9B%E8%AF%9D/>附录E 关于垃圾收集的一些话</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/%E9%99%84%E5%BD%95f-%E6%8E%A8%E8%8D%90%E8%AF%BB%E7%89%A9/>附录F 推荐读物</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/%E5%86%99%E5%9C%A8%E5%89%8D%E9%9D%A2%E7%9A%84%E8%AF%9D/>写在前面的话</a></li><li class="child level"><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/%E5%BC%95%E8%A8%80/>引言</a></li></ul></div></ul></div></nav></div><div class="d-none d-xl-block col-xl-2 docs-toc"><ul class="nav toc-top"><li><a href=# id=back_to_top class=docs-toc-title>目录</a></li></ul><nav id=TableOfContents><ul><li><a href=#字符串的不可变>字符串的不可变</a></li><li><a href=#-的重载与-stringbuilder>+ 的重载与 StringBuilder</a></li><li><a href=#意外递归>意外递归</a></li><li><a href=#字符串操作>字符串操作</a></li><li><a href=#格式化输出>格式化输出</a><ul><li><a href=#printf><code>printf()</code></a></li><li><a href=#systemoutformat><code>System.out.format()</code></a></li><li><a href=#formatter-类><code>Formatter</code> 类</a></li><li><a href=#格式化修饰符>格式化修饰符</a></li><li><a href=#formatter-转换><code>Formatter</code> 转换</a></li><li><a href=#stringformat><code>String.format()</code></a></li></ul></li><li><a href=#正则表达式>正则表达式</a><ul><li><a href=#基础>基础</a></li><li><a href=#创建正则表达式>创建正则表达式</a></li><li><a href=#量词>量词</a></li><li><a href=#charsequence><code>CharSequence</code></a></li><li><a href=#pattern-和-matcher><code>Pattern</code> 和 <code>Matcher</code></a></li><li><a href=#find><code>find()</code></a></li><li><a href=#组groups>组（Groups）</a></li><li><a href=#start-和-end><code>start()</code> 和 <code>end()</code></a></li><li><a href=#pattern-标记><code>Pattern</code> 标记</a></li><li><a href=#split><code>split()</code></a></li><li><a href=#替换操作>替换操作</a></li><li><a href=#reset><code>reset()</code></a></li><li><a href=#正则表达式与-java-io>正则表达式与 Java I/O</a></li></ul></li><li><a href=#扫描输入>扫描输入</a><ul><li><a href=#scanner-分隔符><code>Scanner</code> 分隔符</a></li><li><a href=#用正则表达式扫描>用正则表达式扫描</a></li></ul></li><li><a href=#stringtokenizer-类>StringTokenizer 类</a></li><li><a href=#本章小结>本章小结</a></li></ul></nav><div class="subscribe-module col-24 mt-1"><img src=https://ngte-superbed.oss-cn-beijing.aliyuncs.com/item/20230220172727.png alt=image title=王下邀月熊的微信公众号></div></div><main class="py-md-3 pl-md-3 docs-content col-xl-8" role=main><article class=article><h1>18-Strings</h1><div class=article-style><h1 id=第十八章-字符串>第十八章 字符串</h1><blockquote><p>字符串操作毫无疑问是计算机程序设计中最常见的行为之一。</p></blockquote><p>在 Java 大展拳脚的 Web 系统中更是如此。在本章中，我们将深入学习在 Java 语言中应用最广泛的 <code>String</code> 类，并研究与之相关的类及工具。</p><h2 id=字符串的不可变>字符串的不可变</h2><p><code>String</code> 对象是不可变的。查看 JDK 文档你就会发现，<code>String</code> 类中每一个看起来会修改 <code>String</code> 值的方法，实际上都是创建了一个全新的 <code>String</code> 对象，以包含修改后的字符串内容。而最初的 <code>String</code> 对象则丝毫未动。</p><p>看看下面的代码：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// strings/Immutable.java
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>public</span> <span class=kd>class</span> <span class=nc>Immutable</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=n>String</span> <span class=nf>upcase</span><span class=o>(</span><span class=n>String</span> <span class=n>s</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>s</span><span class=o>.</span><span class=na>toUpperCase</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>String</span> <span class=n>q</span> <span class=o>=</span> <span class=s>&#34;howdy&#34;</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>q</span><span class=o>);</span> <span class=c1>// howdy
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>String</span> <span class=n>qq</span> <span class=o>=</span> <span class=n>upcase</span><span class=o>(</span><span class=n>q</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>qq</span><span class=o>);</span> <span class=c1>// HOWDY
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>q</span><span class=o>);</span> <span class=c1>// howdy
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=cm>/* Output:
</span></span></span><span class=line><span class=cl><span class=cm>howdy
</span></span></span><span class=line><span class=cl><span class=cm>HOWDY
</span></span></span><span class=line><span class=cl><span class=cm>howdy
</span></span></span><span class=line><span class=cl><span class=cm>*/</span>
</span></span></code></pre></div><p>当把 <code>q</code> 传递给 <code>upcase()</code> 方法时，实际传递的是引用的一个拷贝。其实，每当把 String 对象作为方法的参数时，都会复制一份引用，而该引用所指向的对象其实一直待在单一的物理位置上，从未动过。</p><p>回到 <code>upcase()</code> 的定义，传入其中的引用有了名字 <code>s</code>，只有 <code>upcase()</code> 运行的时候，局部引用 <code>s</code> 才存在。一旦 <code>upcase()</code> 运行结束，<code>s</code> 就消失了。当然了，<code>upcase()</code> 的返回值，其实是最终结果的引用。这足以说明，<code>upcase()</code> 返回的引用已经指向了一个新的对象，而 <code>q</code> 仍然在原来的位置。</p><p><code>String</code> 的这种行为正是我们想要的。例如：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>String</span> <span class=n>s</span> <span class=o>=</span> <span class=s>&#34;asdf&#34;</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=n>String</span> <span class=n>x</span> <span class=o>=</span> <span class=n>Immutable</span><span class=o>.</span><span class=na>upcase</span><span class=o>(</span><span class=n>s</span><span class=o>);</span>
</span></span></code></pre></div><p>难道你真的希望 <code>upcase()</code> 方法改变其参数吗？对于一个方法而言，参数是为该方法提供信息的，而不是想让该方法改变自己的。在阅读这段代码时，读者自然会有这样的感觉。这一点很重要，正是有了这种保障，才使得代码易于编写和阅读。</p><h2 id=-的重载与-stringbuilder>+ 的重载与 StringBuilder</h2><p><code>String</code> 对象是不可变的，你可以给一个 <code>String</code> 对象添加任意多的别名。因为 <code>String</code> 是只读的，所以指向它的任何引用都不可能修改它的值，因此，也就不会影响到其他引用。</p><p>不可变性会带来一定的效率问题。为 <code>String</code> 对象重载的 <code>+</code> 操作符就是一个例子。重载的意思是，一个操作符在用于特定的类时，被赋予了特殊的意义（用于 <code>String</code> 的 <code>+</code> 与 <code>+=</code> 是 Java 中仅有的两个重载过的操作符，Java 不允许程序员重载任何其他的操作符 <sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>）。</p><p>操作符 <code>+</code> 可以用来连接 <code>String</code>：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// strings/Concatenation.java
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>Concatenation</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>String</span> <span class=n>mango</span> <span class=o>=</span> <span class=s>&#34;mango&#34;</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=n>String</span> <span class=n>s</span> <span class=o>=</span> <span class=s>&#34;abc&#34;</span> <span class=o>+</span> <span class=n>mango</span> <span class=o>+</span> <span class=s>&#34;def&#34;</span> <span class=o>+</span> <span class=mi>47</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>s</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=cm>/* Output:
</span></span></span><span class=line><span class=cl><span class=cm>abcmangodef47
</span></span></span><span class=line><span class=cl><span class=cm>*/</span>
</span></span></code></pre></div><p>可以想象一下，这段代码是这样工作的：<code>String</code> 可能有一个 <code>append()</code> 方法，它会生成一个新的 <code>String</code> 对象，以包含“abc”与 <code>mango</code> 连接后的字符串。该对象会再创建另一个新的 <code>String</code> 对象，然后与“def”相连，生成另一个新的对象，依此类推。</p><p>这种方式当然是可行的，但是为了生成最终的 <code>String</code> 对象，会产生一大堆需要垃圾回收的中间对象。我猜想，Java 设计者一开始就是这么做的（这也是软件设计中的一个教训：除非你用代码将系统实现，并让它运行起来，否则你无法真正了解它会有什么问题），然后他们发现其性能相当糟糕。</p><p>想看看以上代码到底是如何工作的吗？可以用 JDK 自带的 <code>javap</code> 工具来反编译以上代码。命令如下：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>javap</span> <span class=o>-</span><span class=n>c</span> <span class=n>Concatenation</span>
</span></span></code></pre></div><p>这里的 <code>-c</code> 标志表示将生成 JVM 字节码。我们剔除不感兴趣的部分，然后做细微的修改，于是有了以下的字节码：</p><pre tabindex=0><code class=language-x86asm data-lang=x86asm>public static void main(java.lang.String[]);
 Code:
  Stack=2, Locals=3, Args_size=1
  0: ldc #2; //String mango
  2: astore_1
  3: new #3; //class StringBuilder
  6: dup
  7: invokespecial #4; //StringBuilder.&#34;&lt;init&gt;&#34;:()
  10: ldc #5; //String abc
  12: invokevirtual #6; //StringBuilder.append:(String)
  15: aload_1
  16: invokevirtual #6; //StringBuilder.append:(String)
  19: ldc #7; //String def
  21: invokevirtual #6; //StringBuilder.append:(String)
  24: bipush 47
  26: invokevirtual #8; //StringBuilder.append:(I)
  29: invokevirtual #9; //StringBuilder.toString:()
  32: astore_2
  33: getstatic #10; //Field System.out:PrintStream;
  36: aload_2
  37: invokevirtual #11; //PrintStream.println:(String)
  40: return
</code></pre><p>如果你有汇编语言的经验，以上代码应该很眼熟(其中的 <code>dup</code> 和 <code>invokevirtual</code> 语句相当于 Java 虚拟机上的汇编语句。即使你完全不了解汇编语言也无需担心)。需要重点注意的是：编译器自动引入了 <code>java.lang.StringBuilder</code> 类。虽然源代码中并没有使用 <code>StringBuilder</code> 类，但是编译器却自作主张地使用了它，就因为它更高效。</p><p>在这里，编译器创建了一个 <code>StringBuilder</code> 对象，用于构建最终的 <code>String</code>，并对每个字符串调用了一次 <code>append()</code> 方法，共计 4 次。最后调用 <code>toString()</code> 生成结果，并存为 <code>s</code> (使用的命令为 <code>astore_2</code>)。</p><p>现在，也许你会觉得可以随意使用 <code>String</code> 对象，反正编译器会自动为你做性能优化。可是在这之前，让我们更深入地看看编译器能为我们优化到什么程度。下面的例子采用两种方式生成一个 <code>String</code>：方法一使用了多个 <code>String</code> 对象；方法二在代码中使用了 <code>StringBuilder</code>。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// strings/WhitherStringBuilder.java
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>WhitherStringBuilder</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>String</span> <span class=nf>implicit</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>fields</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>String</span> <span class=n>result</span> <span class=o>=</span> <span class=s>&#34;&#34;</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span><span class=o>(</span><span class=n>String</span> <span class=n>field</span> <span class=o>:</span> <span class=n>fields</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=n>result</span> <span class=o>+=</span> <span class=n>field</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>result</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>String</span> <span class=nf>explicit</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>fields</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>StringBuilder</span> <span class=n>result</span> <span class=o>=</span> <span class=k>new</span> <span class=n>StringBuilder</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span><span class=o>(</span><span class=n>String</span> <span class=n>field</span> <span class=o>:</span> <span class=n>fields</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=n>result</span><span class=o>.</span><span class=na>append</span><span class=o>(</span><span class=n>field</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>result</span><span class=o>.</span><span class=na>toString</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>现在运行 <code>javap -c WhitherStringBuilder</code>，可以看到两种不同方法（我已经去掉不相关的细节）对应的字节码。首先是 <code>implicit()</code> 方法：</p><pre tabindex=0><code class=language-x86asm data-lang=x86asm>public java.lang.String implicit(java.lang.String[]);
0: ldc #2 // String
2: astore_2
3: aload_1
4: astore_3
5: aload_3
6: arraylength
7: istore 4
9: iconst_0
10: istore 5
12: iload 5
14: iload 4
16: if_icmpge 51
19: aload_3
20: iload 5
22: aaload
23: astore 6
25: new #3 // StringBuilder
28: dup
29: invokespecial #4 // StringBuilder.&#34;&lt;init&gt;&#34;
32: aload_2
33: invokevirtual #5 // StringBuilder.append:(String)
36: aload 6
38: invokevirtual #5 // StringBuilder.append:(String;)
41: invokevirtual #6 // StringBuilder.toString:()
44: astore_2
45: iinc 5, 1
48: goto 12
51: aload_2
52: areturn
</code></pre><p>注意从第 16 行到第 48 行构成了一个循环体。第 16 行：对堆栈中的操作数进行“大于或等于的整数比较运算”，循环结束时跳转到第 51 行。第 48 行：重新回到循环体的起始位置（第 12 行）。注意：<code>StringBuilder</code> 是在循环内构造的，这意味着每进行一次循环，会创建一个新的 <code>StringBuilder</code> 对象。</p><p>下面是 <code>explicit()</code> 方法对应的字节码：</p><pre tabindex=0><code class=language-x86asm data-lang=x86asm>public java.lang.String explicit(java.lang.String[]);
0: new #3 // StringBuilder
3: dup
4: invokespecial #4 // StringBuilder.&#34;&lt;init&gt;&#34;
7: astore_2
8: aload_1
9: astore_3
10: aload_3
11: arraylength
12: istore 4
14: iconst_0
15: istore 5
17: iload 5
19: iload 4
21: if_icmpge 43
24: aload_3
25: iload 5
27: aaload
28: astore 6
30: aload_2
31: aload 6
33: invokevirtual #5 // StringBuilder.append:(String)
36: pop
37: iinc 5, 1
40: goto 17
43: aload_2
44: invokevirtual #6 // StringBuilder.toString:()
47: areturn
</code></pre><p>可以看到，不仅循环部分的代码更简短、更简单，而且它只生成了一个 <code>StringBuilder</code> 对象。显式地创建 <code>StringBuilder</code> 还允许你预先为其指定大小。如果你已经知道最终字符串的大概长度，那预先指定 <code>StringBuilder</code> 的大小可以避免频繁地重新分配缓冲。</p><p>因此，当你为一个类编写 <code>toString()</code> 方法时，如果字符串操作比较简单，那就可以信赖编译器，它会为你合理地构造最终的字符串结果。但是，如果你要在 <code>toString()</code> 方法中使用循环，且可能有性能问题，那么最好自己创建一个 <code>StringBuilder</code> 对象，用它来构建最终结果。请参考以下示例：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// strings/UsingStringBuilder.java
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>java.util.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>java.util.stream.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>UsingStringBuilder</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=n>String</span> <span class=nf>string1</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>Random</span> <span class=n>rand</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Random</span><span class=o>(</span><span class=mi>47</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>StringBuilder</span> <span class=n>result</span> <span class=o>=</span> <span class=k>new</span> <span class=n>StringBuilder</span><span class=o>(</span><span class=s>&#34;[&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span><span class=o>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=o>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=mi>25</span><span class=o>;</span> <span class=n>i</span><span class=o>++)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=n>result</span><span class=o>.</span><span class=na>append</span><span class=o>(</span><span class=n>rand</span><span class=o>.</span><span class=na>nextInt</span><span class=o>(</span><span class=mi>100</span><span class=o>));</span>
</span></span><span class=line><span class=cl>            <span class=n>result</span><span class=o>.</span><span class=na>append</span><span class=o>(</span><span class=s>&#34;, &#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=n>result</span><span class=o>.</span><span class=na>delete</span><span class=o>(</span><span class=n>result</span><span class=o>.</span><span class=na>length</span><span class=o>()-</span><span class=mi>2</span><span class=o>,</span> <span class=n>result</span><span class=o>.</span><span class=na>length</span><span class=o>());</span>
</span></span><span class=line><span class=cl>        <span class=n>result</span><span class=o>.</span><span class=na>append</span><span class=o>(</span><span class=s>&#34;]&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>result</span><span class=o>.</span><span class=na>toString</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=n>String</span> <span class=nf>string2</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>String</span> <span class=n>result</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Random</span><span class=o>(</span><span class=mi>47</span><span class=o>)</span>
</span></span><span class=line><span class=cl>            <span class=o>.</span><span class=na>ints</span><span class=o>(</span><span class=mi>25</span><span class=o>,</span> <span class=mi>0</span><span class=o>,</span> <span class=mi>100</span><span class=o>)</span>
</span></span><span class=line><span class=cl>            <span class=o>.</span><span class=na>mapToObj</span><span class=o>(</span><span class=n>Integer</span><span class=o>::</span><span class=n>toString</span><span class=o>)</span>
</span></span><span class=line><span class=cl>            <span class=o>.</span><span class=na>collect</span><span class=o>(</span><span class=n>Collectors</span><span class=o>.</span><span class=na>joining</span><span class=o>(</span><span class=s>&#34;, &#34;</span><span class=o>));</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=s>&#34;[&#34;</span> <span class=o>+</span> <span class=n>result</span> <span class=o>+</span> <span class=s>&#34;]&#34;</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>string1</span><span class=o>());</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>string2</span><span class=o>());</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=cm>/* Output:
</span></span></span><span class=line><span class=cl><span class=cm>[58, 55, 93, 61, 61, 29, 68, 0, 22, 7, 88, 28, 51, 89,
</span></span></span><span class=line><span class=cl><span class=cm>9, 78, 98, 61, 20, 58, 16, 40, 11, 22, 4]
</span></span></span><span class=line><span class=cl><span class=cm>[58, 55, 93, 61, 61, 29, 68, 0, 22, 7, 88, 28, 51, 89,
</span></span></span><span class=line><span class=cl><span class=cm>9, 78, 98, 61, 20, 58, 16, 40, 11, 22, 4]
</span></span></span><span class=line><span class=cl><span class=cm>*/</span>
</span></span></code></pre></div><p>在方法 <code>string1()</code> 中，最终结果是用 <code>append()</code> 语句拼接起来的。如果你想走捷径，例如：<code>append(a + ": " + c)</code>，编译器就会掉入陷阱，从而为你另外创建一个 <code>StringBuilder</code> 对象处理括号内的字符串操作。如果拿不准该用哪种方式，随时可以用 <code>javap</code> 来分析你的程序。</p><p><code>StringBuilder</code> 提供了丰富而全面的方法，包括 <code>insert()</code>、<code>replace()</code>、<code>substring()</code>，甚至还有<code>reverse()</code>，但是最常用的还是 <code>append()</code> 和 <code>toString()</code>。还有 <code>delete()</code>，上面的例子中我们用它删除最后一个逗号和空格，以便添加右括号。</p><p><code>string2()</code> 使用了 <code>Stream</code>，这样代码更加简洁美观。可以证明，<code>Collectors.joining()</code> 内部也是使用的 <code>StringBuilder</code>，这种写法不会影响性能！</p><p><code>StringBuilder </code>是 Java SE5 引入的，在这之前用的是 <code>StringBuffer</code>。后者是线程安全的（参见<a href=./24-Concurrent-Programming.md>并发编程</a>），因此开销也会大些。使用 <code>StringBuilder</code> 进行字符串操作更快一点。</p><h2 id=意外递归>意外递归</h2><p>Java 中的每个类从根本上都是继承自 <code>Object</code>，标准集合类也是如此，它们都有 <code>toString()</code> 方法，并且覆盖了该方法，使得它生成的 <code>String</code> 结果能够表达集合自身，以及集合包含的对象。例如 <code>ArrayList.toString()</code>，它会遍历 <code>ArrayList</code> 中包含的所有对象，调用每个元素上的 <code>toString()</code> 方法：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// strings/ArrayListDisplay.java
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>import</span> <span class=nn>java.util.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>java.util.stream.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>generics.coffee.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>ArrayListDisplay</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>List</span><span class=o>&lt;</span><span class=n>Coffee</span><span class=o>&gt;</span> <span class=n>coffees</span> <span class=o>=</span>
</span></span><span class=line><span class=cl>            <span class=n>Stream</span><span class=o>.</span><span class=na>generate</span><span class=o>(</span><span class=k>new</span> <span class=n>CoffeeSupplier</span><span class=o>())</span>
</span></span><span class=line><span class=cl>                <span class=o>.</span><span class=na>limit</span><span class=o>(</span><span class=mi>10</span><span class=o>)</span>
</span></span><span class=line><span class=cl>                <span class=o>.</span><span class=na>collect</span><span class=o>(</span><span class=n>Collectors</span><span class=o>.</span><span class=na>toList</span><span class=o>());</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>coffees</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=cm>/* Output:
</span></span></span><span class=line><span class=cl><span class=cm>[Americano 0, Latte 1, Americano 2, Mocha 3, Mocha 4,
</span></span></span><span class=line><span class=cl><span class=cm>Breve 5, Americano 6, Latte 7, Cappuccino 8, Cappuccino 9]
</span></span></span><span class=line><span class=cl><span class=cm>*/</span>
</span></span></code></pre></div><p>如果你希望 <code>toString()</code> 打印出类的内存地址，也许你会考虑使用 <code>this</code> 关键字：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// strings/InfiniteRecursion.java
</span></span></span><span class=line><span class=cl><span class=c1>// Accidental recursion
</span></span></span><span class=line><span class=cl><span class=c1>// {ThrowsException}
</span></span></span><span class=line><span class=cl><span class=c1>// {VisuallyInspectOutput} Throws very long exception
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>import</span> <span class=nn>java.util.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>java.util.stream.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>InfiniteRecursion</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>String</span> <span class=nf>toString</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=s>&#34; InfiniteRecursion address: &#34;</span> <span class=o>+</span> <span class=k>this</span> <span class=o>+</span> <span class=s>&#34;\n&#34;</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>Stream</span><span class=o>.</span><span class=na>generate</span><span class=o>(</span><span class=n>InfiniteRecursion</span><span class=o>::</span><span class=k>new</span><span class=o>)</span>
</span></span><span class=line><span class=cl>            <span class=o>.</span><span class=na>limit</span><span class=o>(</span><span class=mi>10</span><span class=o>)</span>
</span></span><span class=line><span class=cl>            <span class=o>.</span><span class=na>forEach</span><span class=o>(</span><span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>::</span><span class=n>println</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>当你创建了 <code>InfiniteRecursion</code> 对象，并将其打印出来的时候，你会得到一串很长的异常信息。如果你将该 <code>InfiniteRecursion</code> 对象存入一个 <code>ArrayList</code> 中，然后打印该 <code>ArrayList</code>，同样也会抛出异常。其实，当运行到如下代码时：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=s>&#34;InfiniteRecursion address: &#34;</span> <span class=o>+</span> <span class=k>this</span>
</span></span></code></pre></div><p>这里发生了自动类型转换，由 <code>InfiniteRecursion</code> 类型转换为 <code>String</code> 类型。因为编译器发现一个 <code>String</code> 对象后面跟着一个 “+”，而 “+” 后面的对象不是 <code>String</code>，于是编译器试着将 <code>this</code> 转换成一个 <code>String</code>。它怎么转换呢？正是通过调用 <code>this</code> 上的 <code>toString()</code> 方法，于是就发生了递归调用。</p><p>如果你真的想要打印对象的内存地址，应该调用 <code>Object.toString()</code> 方法，这才是负责此任务的方法。所以，不要使用 <code>this</code>，而是应该调用 <code>super.toString()</code> 方法。</p><h2 id=字符串操作>字符串操作</h2><p>以下是 <code>String</code> 对象具备的一些基本方法。重载的方法归纳在同一行中：</p><table><thead><tr><th>方法</th><th>参数，重载版本</th><th>作用</th></tr></thead><tbody><tr><td>构造方法</td><td>默认版本，<code>String</code>，<code>StringBuilder</code>，<code>StringBuffer</code>，<code>char</code>数组，<code>byte</code>数组</td><td>创建<code>String</code>对象</td></tr><tr><td><code>length()</code></td><td></td><td><code>String</code>中字符的个数</td></tr><tr><td><code>charAt()</code></td><td><code>int</code>索引</td><td>获取<code>String</code>中索引位置上的<code>char</code></td></tr><tr><td><code>getChars()</code>，<code>getBytes()</code></td><td>待复制部分的开始和结束索引，复制的目标数组，目标数组的开始索引</td><td>复制<code>char</code>或<code>byte</code>到一个目标数组中</td></tr><tr><td><code>toCharArray()</code></td><td></td><td>生成一个<code>char[]</code>，包含<code>String</code>中的所有字符</td></tr><tr><td><code>equals()</code>，<code>equalsIgnoreCase()</code></td><td>与之进行比较的<code>String</code></td><td>比较两个<code>String</code>的内容是否相同。如果相同，结果为<code>true</code></td></tr><tr><td><code>compareTo()</code>，<code>compareToIgnoreCase()</code></td><td>与之进行比较的<code>String</code></td><td>按词典顺序比较<code>String</code>的内容，比较结果为负数、零或正数。注意，大小写不等价</td></tr><tr><td><code>contains()</code></td><td>要搜索的<code>CharSequence</code></td><td>如果该<code>String</code>对象包含参数的内容，则返回<code>true</code></td></tr><tr><td><code>contentEquals()</code></td><td>与之进行比较的<code>CharSequence</code>或<code>StringBuffer</code></td><td>如果该<code>String</code>对象与参数的内容完全一致，则返回<code>true</code></td></tr><tr><td><code>isEmpty()</code></td><td></td><td>返回<code>boolean</code>结果，以表明<code>String</code>对象的长度是否为 0</td></tr><tr><td><code>regionMatches()</code></td><td>该<code>String</code>的索引偏移量，另一个<code>String</code>及其索引偏移量，要比较的长度。重载版本增加了“忽略大小写”功能</td><td>返回<code>boolean</code>结果，以表明所比较区域是否相等</td></tr><tr><td><code>startsWith()</code></td><td>可能的起始<code>String</code>。重载版本在参数中增加了偏移量</td><td>返回<code>boolean</code>结果，以表明该<code>String</code>是否以传入参数开始</td></tr><tr><td><code>endsWith()</code></td><td>该<code>String</code>可能的后缀<code>String</code></td><td>返回<code>boolean</code>结果，以表明此参数是否是该字符串的后缀</td></tr><tr><td><code>indexOf()</code>，<code>lastIndexOf()</code></td><td>重载版本包括：<code>char</code>，<code>char</code>与起始索引，<code>String</code>，<code>String</code>与起始索引</td><td>如果该<code>String</code>并不包含此参数，就返回-1；否则返回此参数在<code>String</code>中的起始索引。<code>lastIndexOf</code>()是从后往前搜索</td></tr><tr><td><code>matches()</code></td><td>一个正则表达式</td><td>返回<code>boolean</code>结果，以表明该<code>String</code>和给出的正则表达式是否匹配</td></tr><tr><td><code>split()</code></td><td>一个正则表达式。可选参数为需要拆分的最大数量</td><td>按照正则表达式拆分<code>String</code>，返回一个结果数组</td></tr><tr><td><code>join()</code>（Java8 引入的）</td><td>分隔符，待拼字符序列。用分隔符将字符序列拼接成一个新的<code>String</code></td><td>用分隔符拼接字符片段，产生一个新的<code>String</code></td></tr><tr><td><code>substring()</code>（即<code>subSequence()</code>）</td><td>重载版本：起始索引；起始索引+终止索引</td><td>返回一个新的<code>String</code>对象，以包含参数指定的子串</td></tr><tr><td><code>concat()</code></td><td>要连接的<code>String</code></td><td>返回一个新的<code>String</code>对象，内容为原始<code>String</code>连接上参数<code>String</code></td></tr><tr><td><code>replace()</code></td><td>要替换的字符，用来进行替换的新字符。也可以用一个<code>CharSequence</code>替换另一个<code>CharSequence</code></td><td>返回替换字符后的新<code>String</code>对象。如果没有替换发生，则返回原始的<code>String</code>对象</td></tr><tr><td><code>replaceFirst()</code></td><td>要替换的正则表达式，用来进行替换的<code>String</code></td><td>返回替换首个目标字符串后的<code>String</code>对象</td></tr><tr><td><code>replaceAll()</code></td><td>要替换的正则表达式，用来进行替换的<code>String</code></td><td>返回替换所有目标字符串后的<code>String</code>对象</td></tr><tr><td><code>toLowerCase()</code>，<code>toUpperCase()</code></td><td></td><td>将字符的大小写改变后，返回一个新的<code>String</code>对象。如果没有任何改变，则返回原始的<code>String</code>对象</td></tr><tr><td><code>trim()</code></td><td></td><td>将<code>String</code>两端的空白符删除后，返回一个新的<code>String</code>对象。如果没有任何改变，则返回原始的<code>String</code>对象</td></tr><tr><td><code>valueOf()</code>（<code>static</code>）</td><td>重载版本：<code>Object</code>；<code>char[]</code>；<code>char[]</code>，偏移量，与字符个数；<code>boolean</code>；<code>char</code>；<code>int</code>；<code>long</code>；<code>float</code>；<code>double</code></td><td>返回一个表示参数内容的<code>String</code></td></tr><tr><td><code>intern()</code></td><td></td><td>为每个唯一的字符序列生成一个且仅生成一个<code>String</code>引用</td></tr><tr><td><code>format()</code></td><td>要格式化的字符串，要替换到格式化字符串的参数</td><td>返回格式化结果<code>String</code></td></tr></tbody></table><p>从这个表可以看出，当需要改变字符串的内容时，<code>String</code> 类的方法都会返回一个新的 <code>String</code> 对象。同时，如果内容不改变，<code>String</code> 方法只是返回原始对象的一个引用而已。这可以节约存储空间以及避免额外的开销。</p><p>本章稍后还将介绍正则表达式在 <code>String</code> 方法中的应用。</p><h2 id=格式化输出>格式化输出</h2><p>在长久的等待之后，Java SE5 终于推出了 C 语言中 <code>printf()</code> 风格的格式化输出这一功能。这不仅使得控制输出的代码更加简单，同时也给与 Java 开发者对于输出格式与排列更强大的控制能力。</p><h3 id=printf><code>printf()</code></h3><p>C 语言的 <code>printf()</code> 并不像 Java 那样连接字符串，它使用一个简单的格式化字符串，加上要插入其中的值，然后将其格式化输出。 <code>printf()</code> 并不使用重载的 <code>+</code> 操作符（C 语言没有重载）来连接引号内的字符串或字符串变量，而是使用特殊的占位符来表示数据将来的位置。而且它还将插入格式化字符串的参数，以逗号分隔，排成一行。例如：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=n>System</span><span class=p>.</span><span class=n>out</span><span class=p>.</span><span class=nf>printf</span><span class=p>(</span><span class=s>&#34;Row 1: [%d %f]%n&#34;</span><span class=p>,</span> <span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>);</span>
</span></span></code></pre></div><p>这一行代码在运行的时候，首先将 <code>x</code> 的值插入到 <code>%d_</code> 的位置，然后将 <code>y</code> 的值插入到 <code>%f</code> 的位置。这些占位符叫做<em>格式修饰符</em>，它们不仅指明了插入数据的位置，同时还指明了将会插入什么类型的变量，以及如何格式化。在这个例子中 <code>%d</code> 表示 <code>x</code> 是一个整数，<code>%f</code> 表示 <code>y</code> 是一个浮点数（<code>float</code> 或者 <code>double</code>）。</p><h3 id=systemoutformat><code>System.out.format()</code></h3><p>Java SE5 引入了 <code>format()</code> 方法，可用于 <code>PrintStream</code> 或者 <code>PrintWriter</code> 对象（你可以在 <a href=./Appendix-IO-Streams.md>附录:流式 I/O</a> 了解更多内容），其中也包括 <code>System.out</code> 对象。<code>format()</code> 方法模仿了 C 语言的 <code>printf()</code>。如果你比较怀旧的话，也可以使用 <code>printf()</code>。以下是一个简单的示例：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// strings/SimpleFormat.java
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>SimpleFormat</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=kt>int</span> <span class=n>x</span> <span class=o>=</span> <span class=mi>5</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=kt>double</span> <span class=n>y</span> <span class=o>=</span> <span class=mf>5.332542</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=c1>// The old way:
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;Row 1: [&#34;</span> <span class=o>+</span> <span class=n>x</span> <span class=o>+</span> <span class=s>&#34; &#34;</span> <span class=o>+</span> <span class=n>y</span> <span class=o>+</span> <span class=s>&#34;]&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=c1>// The new way:
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>format</span><span class=o>(</span><span class=s>&#34;Row 1: [%d %f]%n&#34;</span><span class=o>,</span> <span class=n>x</span><span class=o>,</span> <span class=n>y</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=c1>// or
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>printf</span><span class=o>(</span><span class=s>&#34;Row 1: [%d %f]%n&#34;</span><span class=o>,</span> <span class=n>x</span><span class=o>,</span> <span class=n>y</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=cm>/* Output:
</span></span></span><span class=line><span class=cl><span class=cm>Row 1: [5 5.332542]
</span></span></span><span class=line><span class=cl><span class=cm>Row 1: [5 5.332542]
</span></span></span><span class=line><span class=cl><span class=cm>Row 1: [5 5.332542]
</span></span></span><span class=line><span class=cl><span class=cm>*/</span>
</span></span></code></pre></div><p>可以看到，<code>format()</code> 和 <code>printf()</code> 是等价的，它们只需要一个简单的格式化字符串，加上一串参数即可，每个参数对应一个格式修饰符。</p><p><code>String</code> 类也有一个 <code>static format()</code> 方法，可以格式化字符串。</p><h3 id=formatter-类><code>Formatter</code> 类</h3><p>在 Java 中，所有的格式化功能都是由 <code>java.util.Formatter</code> 类处理的。可以将 <code>Formatter</code> 看做一个翻译器，它将你的格式化字符串与数据翻译成需要的结果。当你创建一个 <code>Formatter</code> 对象时，需要向其构造器传递一些信息，告诉它最终的结果将向哪里输出：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// strings/Turtle.java
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>import</span> <span class=nn>java.io.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>java.util.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>Turtle</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>String</span> <span class=n>name</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>Formatter</span> <span class=n>f</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=nf>Turtle</span><span class=o>(</span><span class=n>String</span> <span class=n>name</span><span class=o>,</span> <span class=n>Formatter</span> <span class=n>f</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=o>.</span><span class=na>name</span> <span class=o>=</span> <span class=n>name</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=o>.</span><span class=na>f</span> <span class=o>=</span> <span class=n>f</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>void</span> <span class=nf>move</span><span class=o>(</span><span class=kt>int</span> <span class=n>x</span><span class=o>,</span> <span class=kt>int</span> <span class=n>y</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>f</span><span class=o>.</span><span class=na>format</span><span class=o>(</span><span class=s>&#34;%s The Turtle is at (%d,%d)%n&#34;</span><span class=o>,</span>
</span></span><span class=line><span class=cl>            <span class=n>name</span><span class=o>,</span> <span class=n>x</span><span class=o>,</span> <span class=n>y</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>PrintStream</span> <span class=n>outAlias</span> <span class=o>=</span> <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=n>Turtle</span> <span class=n>tommy</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Turtle</span><span class=o>(</span><span class=s>&#34;Tommy&#34;</span><span class=o>,</span>
</span></span><span class=line><span class=cl>            <span class=k>new</span> <span class=n>Formatter</span><span class=o>(</span><span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>));</span>
</span></span><span class=line><span class=cl>        <span class=n>Turtle</span> <span class=n>terry</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Turtle</span><span class=o>(</span><span class=s>&#34;Terry&#34;</span><span class=o>,</span>
</span></span><span class=line><span class=cl>            <span class=k>new</span> <span class=n>Formatter</span><span class=o>(</span><span class=n>outAlias</span><span class=o>));</span>
</span></span><span class=line><span class=cl>        <span class=n>tommy</span><span class=o>.</span><span class=na>move</span><span class=o>(</span><span class=mi>0</span><span class=o>,</span><span class=mi>0</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>terry</span><span class=o>.</span><span class=na>move</span><span class=o>(</span><span class=mi>4</span><span class=o>,</span><span class=mi>8</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>tommy</span><span class=o>.</span><span class=na>move</span><span class=o>(</span><span class=mi>3</span><span class=o>,</span><span class=mi>4</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>terry</span><span class=o>.</span><span class=na>move</span><span class=o>(</span><span class=mi>2</span><span class=o>,</span><span class=mi>5</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>tommy</span><span class=o>.</span><span class=na>move</span><span class=o>(</span><span class=mi>3</span><span class=o>,</span><span class=mi>3</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>terry</span><span class=o>.</span><span class=na>move</span><span class=o>(</span><span class=mi>3</span><span class=o>,</span><span class=mi>3</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=cm>/* Output:
</span></span></span><span class=line><span class=cl><span class=cm>Tommy The Turtle is at (0,0)
</span></span></span><span class=line><span class=cl><span class=cm>Terry The Turtle is at (4,8)
</span></span></span><span class=line><span class=cl><span class=cm>Tommy The Turtle is at (3,4)
</span></span></span><span class=line><span class=cl><span class=cm>Terry The Turtle is at (2,5)
</span></span></span><span class=line><span class=cl><span class=cm>Tommy The Turtle is at (3,3)
</span></span></span><span class=line><span class=cl><span class=cm>Terry The Turtle is at (3,3)
</span></span></span><span class=line><span class=cl><span class=cm>*/</span>
</span></span></code></pre></div><p>格式化修饰符 <code>%s</code> 表明这里需要 <code>String</code> 参数。</p><p>所有的 <code>tommy</code> 都将输出到 <code>System.out</code>，而所有的 <code>terry</code> 则都输出到 <code>System.out</code> 的一个别名中。<code>Formatter</code> 的重载构造器支持输出到多个路径，不过最常用的还是 <code>PrintStream()</code>（如上例）、<code>OutputStream</code> 和 <code>File</code>。你可以在 <a href=././Appendix-IO-Streams.md>附录:流式 I/O</a> 中了解更多信息。</p><h3 id=格式化修饰符>格式化修饰符</h3><p>在插入数据时，如果想要优化空格与对齐，你需要更精细复杂的格式修饰符。以下是其通用语法：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=o>%[</span><span class=n>argument_index$</span><span class=o>][</span><span class=n>flags</span><span class=o>][</span><span class=n>width</span><span class=o>][.</span><span class=na>precision</span><span class=o>]</span><span class=n>conversion</span>
</span></span></code></pre></div><p>最常见的应用是控制一个字段的最小长度，这可以通过指定 <em>width</em> 来实现。<code>Formatter </code>对象通过在必要时添加空格，来确保一个字段至少达到设定长度。默认情况下，数据是右对齐的，不过可以通过使用 <code>-</code> 标志来改变对齐方向。</p><p>与 <em>width</em> 相对的是 <em>precision</em>，用于指定最大长度。<em>width</em> 可以应用于各种类型的数据转换，并且其行为方式都一样。<em>precision</em> 则不然，当应用于不同类型的数据转换时，<em>precision</em> 的意义也不同。在将 <em>precision</em> 应用于 <code>String</code> 时，它表示打印 <code>string</code> 时输出字符的最大数量。而在将 <em>precision</em> 应用于浮点数时，它表示小数部分要显示出来的位数（默认是 6 位小数），如果小数位数过多则舍入，太少则在尾部补零。由于整数没有小数部分，所以 <em>precision</em> 无法应用于整数，如果你对整数应用 <em>precision</em>，则会触发异常。</p><p>下面的程序应用格式修饰符来打印一个购物收据。这是 <em>Builder</em> 设计模式的一个简单实现，即先创建一个初始对象，然后逐渐添加新东西，最后调用 <code>build()</code> 方法完成构建：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// strings/ReceiptBuilder.java
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>import</span> <span class=nn>java.util.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>ReceiptBuilder</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kt>double</span> <span class=n>total</span> <span class=o>=</span> <span class=mi>0</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>Formatter</span> <span class=n>f</span> <span class=o>=</span>
</span></span><span class=line><span class=cl>        <span class=k>new</span> <span class=n>Formatter</span><span class=o>(</span><span class=k>new</span> <span class=n>StringBuilder</span><span class=o>());</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=nf>ReceiptBuilder</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>f</span><span class=o>.</span><span class=na>format</span><span class=o>(</span>
</span></span><span class=line><span class=cl>          <span class=s>&#34;%-15s %5s %10s%n&#34;</span><span class=o>,</span> <span class=s>&#34;Item&#34;</span><span class=o>,</span> <span class=s>&#34;Qty&#34;</span><span class=o>,</span> <span class=s>&#34;Price&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>f</span><span class=o>.</span><span class=na>format</span><span class=o>(</span>
</span></span><span class=line><span class=cl>          <span class=s>&#34;%-15s %5s %10s%n&#34;</span><span class=o>,</span> <span class=s>&#34;----&#34;</span><span class=o>,</span> <span class=s>&#34;---&#34;</span><span class=o>,</span> <span class=s>&#34;-----&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>void</span> <span class=nf>add</span><span class=o>(</span><span class=n>String</span> <span class=n>name</span><span class=o>,</span> <span class=kt>int</span> <span class=n>qty</span><span class=o>,</span> <span class=kt>double</span> <span class=n>price</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>f</span><span class=o>.</span><span class=na>format</span><span class=o>(</span><span class=s>&#34;%-15.15s %5d %10.2f%n&#34;</span><span class=o>,</span> <span class=n>name</span><span class=o>,</span> <span class=n>qty</span><span class=o>,</span> <span class=n>price</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>total</span> <span class=o>+=</span> <span class=n>price</span> <span class=o>*</span> <span class=n>qty</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>String</span> <span class=nf>build</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>f</span><span class=o>.</span><span class=na>format</span><span class=o>(</span><span class=s>&#34;%-15s %5s %10.2f%n&#34;</span><span class=o>,</span> <span class=s>&#34;Tax&#34;</span><span class=o>,</span> <span class=s>&#34;&#34;</span><span class=o>,</span>
</span></span><span class=line><span class=cl>          <span class=n>total</span> <span class=o>*</span> <span class=mf>0.06</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>f</span><span class=o>.</span><span class=na>format</span><span class=o>(</span><span class=s>&#34;%-15s %5s %10s%n&#34;</span><span class=o>,</span> <span class=s>&#34;&#34;</span><span class=o>,</span> <span class=s>&#34;&#34;</span><span class=o>,</span> <span class=s>&#34;-----&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>f</span><span class=o>.</span><span class=na>format</span><span class=o>(</span><span class=s>&#34;%-15s %5s %10.2f%n&#34;</span><span class=o>,</span> <span class=s>&#34;Total&#34;</span><span class=o>,</span> <span class=s>&#34;&#34;</span><span class=o>,</span>
</span></span><span class=line><span class=cl>          <span class=n>total</span> <span class=o>*</span> <span class=mf>1.06</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>f</span><span class=o>.</span><span class=na>toString</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>ReceiptBuilder</span> <span class=n>receiptBuilder</span> <span class=o>=</span>
</span></span><span class=line><span class=cl>          <span class=k>new</span> <span class=n>ReceiptBuilder</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=n>receiptBuilder</span><span class=o>.</span><span class=na>add</span><span class=o>(</span><span class=s>&#34;Jack&#39;s Magic Beans&#34;</span><span class=o>,</span> <span class=mi>4</span><span class=o>,</span> <span class=mf>4.25</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>receiptBuilder</span><span class=o>.</span><span class=na>add</span><span class=o>(</span><span class=s>&#34;Princess Peas&#34;</span><span class=o>,</span> <span class=mi>3</span><span class=o>,</span> <span class=mf>5.1</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>receiptBuilder</span><span class=o>.</span><span class=na>add</span><span class=o>(</span>
</span></span><span class=line><span class=cl>          <span class=s>&#34;Three Bears Porridge&#34;</span><span class=o>,</span> <span class=mi>1</span><span class=o>,</span> <span class=mf>14.29</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>receiptBuilder</span><span class=o>.</span><span class=na>build</span><span class=o>());</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=cm>/* Output:
</span></span></span><span class=line><span class=cl><span class=cm>Item              Qty      Price
</span></span></span><span class=line><span class=cl><span class=cm>----              ---      -----
</span></span></span><span class=line><span class=cl><span class=cm>Jack&#39;s Magic Be     4       4.25
</span></span></span><span class=line><span class=cl><span class=cm>Princess Peas       3       5.10
</span></span></span><span class=line><span class=cl><span class=cm>Three Bears Por     1      14.29
</span></span></span><span class=line><span class=cl><span class=cm>Tax                         2.80
</span></span></span><span class=line><span class=cl><span class=cm>                           -----
</span></span></span><span class=line><span class=cl><span class=cm>Total                      49.39
</span></span></span><span class=line><span class=cl><span class=cm>*/</span>
</span></span></code></pre></div><p>通过传入一个 <code>StringBuilder</code> 对象到 <code>Formatter</code> 的构造器，我们指定了一个容器来构建目标 <code>String</code>。你也可以通过不同的构造器参数，把结果输出到标准输出，甚至是一个文件里。</p><p>正如你所见，通过相当简洁的语法，<code>Formatter</code> 提供了对空格与对齐的强大控制能力。在该程序中，为了恰当地控制间隔，格式化字符串被重复利用了多遍。</p><h3 id=formatter-转换><code>Formatter</code> 转换</h3><p>下面的表格展示了最常用的类型转换：</p><table><thead><tr><th style=text-align:center>类型</th><th style=text-align:left>含义</th></tr></thead><tbody><tr><td style=text-align:center><code>d</code></td><td style=text-align:left>整型（十进制）</td></tr><tr><td style=text-align:center><code>c</code></td><td style=text-align:left>Unicode 字符</td></tr><tr><td style=text-align:center><code>b</code></td><td style=text-align:left>Boolean 值</td></tr><tr><td style=text-align:center><code>s</code></td><td style=text-align:left>String</td></tr><tr><td style=text-align:center><code>f</code></td><td style=text-align:left>浮点数（十进制）</td></tr><tr><td style=text-align:center><code>e</code></td><td style=text-align:left>浮点数（科学计数）</td></tr><tr><td style=text-align:center><code>x</code></td><td style=text-align:left>整型（十六进制）</td></tr><tr><td style=text-align:center><code>h</code></td><td style=text-align:left>散列码（十六进制）</td></tr><tr><td style=text-align:center><code>%</code></td><td style=text-align:left>字面值“%”</td></tr></tbody></table><p>下面的程序演示了这些转换是如何工作的：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// strings/Conversion.java
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>import</span> <span class=nn>java.math.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>java.util.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>Conversion</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>Formatter</span> <span class=n>f</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Formatter</span><span class=o>(</span><span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=kt>char</span> <span class=n>u</span> <span class=o>=</span> <span class=sc>&#39;a&#39;</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;u = &#39;a&#39;&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>f</span><span class=o>.</span><span class=na>format</span><span class=o>(</span><span class=s>&#34;s: %s%n&#34;</span><span class=o>,</span> <span class=n>u</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=c1>// f.format(&#34;d: %d%n&#34;, u);
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>f</span><span class=o>.</span><span class=na>format</span><span class=o>(</span><span class=s>&#34;c: %c%n&#34;</span><span class=o>,</span> <span class=n>u</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>f</span><span class=o>.</span><span class=na>format</span><span class=o>(</span><span class=s>&#34;b: %b%n&#34;</span><span class=o>,</span> <span class=n>u</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=c1>// f.format(&#34;f: %f%n&#34;, u);
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=c1>// f.format(&#34;e: %e%n&#34;, u);
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=c1>// f.format(&#34;x: %x%n&#34;, u);
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>f</span><span class=o>.</span><span class=na>format</span><span class=o>(</span><span class=s>&#34;h: %h%n&#34;</span><span class=o>,</span> <span class=n>u</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=kt>int</span> <span class=n>v</span> <span class=o>=</span> <span class=mi>121</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;v = 121&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>f</span><span class=o>.</span><span class=na>format</span><span class=o>(</span><span class=s>&#34;d: %d%n&#34;</span><span class=o>,</span> <span class=n>v</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>f</span><span class=o>.</span><span class=na>format</span><span class=o>(</span><span class=s>&#34;c: %c%n&#34;</span><span class=o>,</span> <span class=n>v</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>f</span><span class=o>.</span><span class=na>format</span><span class=o>(</span><span class=s>&#34;b: %b%n&#34;</span><span class=o>,</span> <span class=n>v</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>f</span><span class=o>.</span><span class=na>format</span><span class=o>(</span><span class=s>&#34;s: %s%n&#34;</span><span class=o>,</span> <span class=n>v</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=c1>// f.format(&#34;f: %f%n&#34;, v);
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=c1>// f.format(&#34;e: %e%n&#34;, v);
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>f</span><span class=o>.</span><span class=na>format</span><span class=o>(</span><span class=s>&#34;x: %x%n&#34;</span><span class=o>,</span> <span class=n>v</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>f</span><span class=o>.</span><span class=na>format</span><span class=o>(</span><span class=s>&#34;h: %h%n&#34;</span><span class=o>,</span> <span class=n>v</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>BigInteger</span> <span class=n>w</span> <span class=o>=</span> <span class=k>new</span> <span class=n>BigInteger</span><span class=o>(</span><span class=s>&#34;50000000000000&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span>
</span></span><span class=line><span class=cl>          <span class=s>&#34;w = new BigInteger(\&#34;50000000000000\&#34;)&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>f</span><span class=o>.</span><span class=na>format</span><span class=o>(</span><span class=s>&#34;d: %d%n&#34;</span><span class=o>,</span> <span class=n>w</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=c1>// f.format(&#34;c: %c%n&#34;, w);
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>f</span><span class=o>.</span><span class=na>format</span><span class=o>(</span><span class=s>&#34;b: %b%n&#34;</span><span class=o>,</span> <span class=n>w</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>f</span><span class=o>.</span><span class=na>format</span><span class=o>(</span><span class=s>&#34;s: %s%n&#34;</span><span class=o>,</span> <span class=n>w</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=c1>// f.format(&#34;f: %f%n&#34;, w);
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=c1>// f.format(&#34;e: %e%n&#34;, w);
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>f</span><span class=o>.</span><span class=na>format</span><span class=o>(</span><span class=s>&#34;x: %x%n&#34;</span><span class=o>,</span> <span class=n>w</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>f</span><span class=o>.</span><span class=na>format</span><span class=o>(</span><span class=s>&#34;h: %h%n&#34;</span><span class=o>,</span> <span class=n>w</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=kt>double</span> <span class=n>x</span> <span class=o>=</span> <span class=mf>179.543</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;x = 179.543&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=c1>// f.format(&#34;d: %d%n&#34;, x);
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=c1>// f.format(&#34;c: %c%n&#34;, x);
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>f</span><span class=o>.</span><span class=na>format</span><span class=o>(</span><span class=s>&#34;b: %b%n&#34;</span><span class=o>,</span> <span class=n>x</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>f</span><span class=o>.</span><span class=na>format</span><span class=o>(</span><span class=s>&#34;s: %s%n&#34;</span><span class=o>,</span> <span class=n>x</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>f</span><span class=o>.</span><span class=na>format</span><span class=o>(</span><span class=s>&#34;f: %f%n&#34;</span><span class=o>,</span> <span class=n>x</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>f</span><span class=o>.</span><span class=na>format</span><span class=o>(</span><span class=s>&#34;e: %e%n&#34;</span><span class=o>,</span> <span class=n>x</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=c1>// f.format(&#34;x: %x%n&#34;, x);
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>f</span><span class=o>.</span><span class=na>format</span><span class=o>(</span><span class=s>&#34;h: %h%n&#34;</span><span class=o>,</span> <span class=n>x</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>Conversion</span> <span class=n>y</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Conversion</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;y = new Conversion()&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1>// f.format(&#34;d: %d%n&#34;, y);
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=c1>// f.format(&#34;c: %c%n&#34;, y);
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>f</span><span class=o>.</span><span class=na>format</span><span class=o>(</span><span class=s>&#34;b: %b%n&#34;</span><span class=o>,</span> <span class=n>y</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>f</span><span class=o>.</span><span class=na>format</span><span class=o>(</span><span class=s>&#34;s: %s%n&#34;</span><span class=o>,</span> <span class=n>y</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=c1>// f.format(&#34;f: %f%n&#34;, y);
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=c1>// f.format(&#34;e: %e%n&#34;, y);
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=c1>// f.format(&#34;x: %x%n&#34;, y);
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>f</span><span class=o>.</span><span class=na>format</span><span class=o>(</span><span class=s>&#34;h: %h%n&#34;</span><span class=o>,</span> <span class=n>y</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=kt>boolean</span> <span class=n>z</span> <span class=o>=</span> <span class=kc>false</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;z = false&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=c1>// f.format(&#34;d: %d%n&#34;, z);
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=c1>// f.format(&#34;c: %c%n&#34;, z);
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>f</span><span class=o>.</span><span class=na>format</span><span class=o>(</span><span class=s>&#34;b: %b%n&#34;</span><span class=o>,</span> <span class=n>z</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>f</span><span class=o>.</span><span class=na>format</span><span class=o>(</span><span class=s>&#34;s: %s%n&#34;</span><span class=o>,</span> <span class=n>z</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=c1>// f.format(&#34;f: %f%n&#34;, z);
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=c1>// f.format(&#34;e: %e%n&#34;, z);
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=c1>// f.format(&#34;x: %x%n&#34;, z);
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>f</span><span class=o>.</span><span class=na>format</span><span class=o>(</span><span class=s>&#34;h: %h%n&#34;</span><span class=o>,</span> <span class=n>z</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=cm>/* Output:
</span></span></span><span class=line><span class=cl><span class=cm>u = &#39;a&#39;
</span></span></span><span class=line><span class=cl><span class=cm>s: a
</span></span></span><span class=line><span class=cl><span class=cm>c: a
</span></span></span><span class=line><span class=cl><span class=cm>b: true
</span></span></span><span class=line><span class=cl><span class=cm>h: 61
</span></span></span><span class=line><span class=cl><span class=cm>v = 121
</span></span></span><span class=line><span class=cl><span class=cm>d: 121
</span></span></span><span class=line><span class=cl><span class=cm>c: y
</span></span></span><span class=line><span class=cl><span class=cm>b: true
</span></span></span><span class=line><span class=cl><span class=cm>s: 121
</span></span></span><span class=line><span class=cl><span class=cm>x: 79
</span></span></span><span class=line><span class=cl><span class=cm>h: 79
</span></span></span><span class=line><span class=cl><span class=cm>w = new BigInteger(&#34;50000000000000&#34;)
</span></span></span><span class=line><span class=cl><span class=cm>d: 50000000000000
</span></span></span><span class=line><span class=cl><span class=cm>b: true
</span></span></span><span class=line><span class=cl><span class=cm>s: 50000000000000
</span></span></span><span class=line><span class=cl><span class=cm>x: 2d79883d2000
</span></span></span><span class=line><span class=cl><span class=cm>h: 8842a1a7
</span></span></span><span class=line><span class=cl><span class=cm>x = 179.543
</span></span></span><span class=line><span class=cl><span class=cm>b: true
</span></span></span><span class=line><span class=cl><span class=cm>s: 179.543
</span></span></span><span class=line><span class=cl><span class=cm>f: 179.543000
</span></span></span><span class=line><span class=cl><span class=cm>e: 1.795430e+02
</span></span></span><span class=line><span class=cl><span class=cm>h: 1ef462c
</span></span></span><span class=line><span class=cl><span class=cm>y = new Conversion()
</span></span></span><span class=line><span class=cl><span class=cm>b: true
</span></span></span><span class=line><span class=cl><span class=cm>s: Conversion@15db9742
</span></span></span><span class=line><span class=cl><span class=cm>h: 15db9742
</span></span></span><span class=line><span class=cl><span class=cm>z = false
</span></span></span><span class=line><span class=cl><span class=cm>b: false
</span></span></span><span class=line><span class=cl><span class=cm>s: false
</span></span></span><span class=line><span class=cl><span class=cm>h: 4d5
</span></span></span><span class=line><span class=cl><span class=cm>*/</span>
</span></span></code></pre></div><p>被注释的代码表示，针对相应类型的变量，这些转换是无效的。如果执行这些转换，则会触发异常。</p><p>注意，程序中的每个变量都用到了 <code>b</code> 转换。虽然它对各种类型都是合法的，但其行为却不一定与你想象的一致。对于 <code>boolean</code> 基本类型或 <code>Boolean</code> 对象，其转换结果是对应的 <code>true</code> 或 <code>false</code>。但是，对其他类型的参数，只要该参数不为 <code>null</code>，其转换结果永远都是 <code>true</code>。即使是数字 0，转换结果依然为 <code>true</code>，而这在其他语言中（包括 C），往往转换为 <code>false</code>。所以，将 <code>b</code> 应用于非布尔类型的对象时请格外小心。</p><p>还有许多不常用的类型转换与格式修饰符选项，你可以在 JDK 文档中的 <code>Formatter</code> 类部分找到它们。</p><h3 id=stringformat><code>String.format()</code></h3><p>Java SE5 也参考了 C 中的 <code>sprintf()</code> 方法，以生成格式化的 <code>String</code> 对象。<code>String.format()</code> 是一个 <code>static</code> 方法，它接受与 <code>Formatter.format()</code> 方法一样的参数，但返回一个 <code>String</code> 对象。当你只需使用一次 <code>format()</code> 方法的时候，<code>String.format()</code> 用起来很方便。例如：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// strings/DatabaseException.java
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>DatabaseException</span> <span class=kd>extends</span> <span class=n>Exception</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=nf>DatabaseException</span><span class=o>(</span><span class=kt>int</span> <span class=n>transactionID</span><span class=o>,</span>
</span></span><span class=line><span class=cl>      <span class=kt>int</span> <span class=n>queryID</span><span class=o>,</span> <span class=n>String</span> <span class=n>message</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>      <span class=kd>super</span><span class=o>(</span><span class=n>String</span><span class=o>.</span><span class=na>format</span><span class=o>(</span><span class=s>&#34;(t%d, q%d) %s&#34;</span><span class=o>,</span> <span class=n>transactionID</span><span class=o>,</span>
</span></span><span class=line><span class=cl>        <span class=n>queryID</span><span class=o>,</span> <span class=n>message</span><span class=o>));</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>      <span class=k>try</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>throw</span> <span class=k>new</span> <span class=n>DatabaseException</span><span class=o>(</span><span class=mi>3</span><span class=o>,</span> <span class=mi>7</span><span class=o>,</span> <span class=s>&#34;Write failed&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>      <span class=o>}</span> <span class=k>catch</span><span class=o>(</span><span class=n>Exception</span> <span class=n>e</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>e</span><span class=o>);</span>
</span></span><span class=line><span class=cl>      <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=cm>/*
</span></span></span><span class=line><span class=cl><span class=cm>Output:
</span></span></span><span class=line><span class=cl><span class=cm>DatabaseException: (t3, q7) Write failed
</span></span></span><span class=line><span class=cl><span class=cm>*/</span>
</span></span></code></pre></div><p>其实在 <code>String.format()</code> 内部，它也是创建了一个 <code>Formatter</code> 对象，然后将你传入的参数转给 <code>Formatter</code>。不过，与其自己做这些事情，不如使用便捷的 <code>String.format()</code> 方法，何况这样的代码更清晰易读。</p><h4 id=一个十六进制转储dump工具>一个十六进制转储（dump）工具</h4><p>在第二个例子中，我们把二进制文件转换为十六进制格式。下面的小工具使用了 <code>String.format()</code> 方法，以可读的十六进制格式将字节数组打印出来：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// strings/Hex.java
</span></span></span><span class=line><span class=cl><span class=c1>// {java onjava.Hex}
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>package</span> <span class=nn>onjava</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>java.io.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>java.nio.file.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>Hex</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=n>String</span> <span class=nf>format</span><span class=o>(</span><span class=kt>byte</span><span class=o>[]</span> <span class=n>data</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>StringBuilder</span> <span class=n>result</span> <span class=o>=</span> <span class=k>new</span> <span class=n>StringBuilder</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=kt>int</span> <span class=n>n</span> <span class=o>=</span> <span class=mi>0</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span><span class=o>(</span><span class=kt>byte</span> <span class=n>b</span> <span class=o>:</span> <span class=n>data</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span><span class=o>(</span><span class=n>n</span> <span class=o>%</span> <span class=mi>16</span> <span class=o>==</span> <span class=mi>0</span><span class=o>)</span>
</span></span><span class=line><span class=cl>                <span class=n>result</span><span class=o>.</span><span class=na>append</span><span class=o>(</span><span class=n>String</span><span class=o>.</span><span class=na>format</span><span class=o>(</span><span class=s>&#34;%05X: &#34;</span><span class=o>,</span> <span class=n>n</span><span class=o>));</span>
</span></span><span class=line><span class=cl>            <span class=n>result</span><span class=o>.</span><span class=na>append</span><span class=o>(</span><span class=n>String</span><span class=o>.</span><span class=na>format</span><span class=o>(</span><span class=s>&#34;%02X &#34;</span><span class=o>,</span> <span class=n>b</span><span class=o>));</span>
</span></span><span class=line><span class=cl>            <span class=n>n</span><span class=o>++;</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span><span class=o>(</span><span class=n>n</span> <span class=o>%</span> <span class=mi>16</span> <span class=o>==</span> <span class=mi>0</span><span class=o>)</span> <span class=n>result</span><span class=o>.</span><span class=na>append</span><span class=o>(</span><span class=s>&#34;\n&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=n>result</span><span class=o>.</span><span class=na>append</span><span class=o>(</span><span class=s>&#34;\n&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>result</span><span class=o>.</span><span class=na>toString</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=kd>throws</span> <span class=n>Exception</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span><span class=o>(</span><span class=n>args</span><span class=o>.</span><span class=na>length</span> <span class=o>==</span> <span class=mi>0</span><span class=o>)</span>
</span></span><span class=line><span class=cl>            <span class=c1>// Test by displaying this class file:
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>format</span><span class=o>(</span>
</span></span><span class=line><span class=cl>                <span class=n>Files</span><span class=o>.</span><span class=na>readAllBytes</span><span class=o>(</span><span class=n>Paths</span><span class=o>.</span><span class=na>get</span><span class=o>(</span>
</span></span><span class=line><span class=cl>                  <span class=s>&#34;build/classes/main/onjava/Hex.class&#34;</span><span class=o>))));</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span>
</span></span><span class=line><span class=cl>            <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>format</span><span class=o>(</span>
</span></span><span class=line><span class=cl>                <span class=n>Files</span><span class=o>.</span><span class=na>readAllBytes</span><span class=o>(</span><span class=n>Paths</span><span class=o>.</span><span class=na>get</span><span class=o>(</span><span class=n>args</span><span class=o>[</span><span class=mi>0</span><span class=o>]))));</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=cm>/* Output: (First 6 Lines)
</span></span></span><span class=line><span class=cl><span class=cm>00000: CA FE BA BE 00 00 00 34 00 61 0A 00 05 00 31 07
</span></span></span><span class=line><span class=cl><span class=cm>00010: 00 32 0A 00 02 00 31 08 00 33 07 00 34 0A 00 35
</span></span></span><span class=line><span class=cl><span class=cm>00020: 00 36 0A 00 0F 00 37 0A 00 02 00 38 08 00 39 0A
</span></span></span><span class=line><span class=cl><span class=cm>00030: 00 3A 00 3B 08 00 3C 0A 00 02 00 3D 09 00 3E 00
</span></span></span><span class=line><span class=cl><span class=cm>00040: 3F 08 00 40 07 00 41 0A 00 42 00 43 0A 00 44 00
</span></span></span><span class=line><span class=cl><span class=cm>00050: 45 0A 00 14 00 46 0A 00 47 00 48 07 00 49 01 00
</span></span></span><span class=line><span class=cl><span class=cm>                  ...
</span></span></span><span class=line><span class=cl><span class=cm>*/</span>
</span></span></code></pre></div><p>为了打开及读入二进制文件，我们用到了另一个工具 <code>Files.readAllBytes()</code>，这已经在 <a href=./17-Files.md>Files 章节</a> 介绍过了。这里的 <code>readAllBytes()</code> 方法将整个文件以 <code>byte</code> 数组的形式返回。</p><h2 id=正则表达式>正则表达式</h2><p>很久之前，<em>正则表达式</em>就已经整合到标准 Unix 工具集之中，例如 sed、awk 和程序语言之中了，如 Python 和 Perl（有些人认为正是正则表达式促成了 Perl 的成功）。而在 Java 中，字符串操作还主要集中于<code>String</code>、<code>StringBuffer</code> 和 <code>StringTokenizer</code> 类。与正则表达式相比较，它们只能提供相当简单的功能。</p><p>正则表达式是一种强大而灵活的文本处理工具。使用正则表达式，我们能够以编程的方式，构造复杂的文本模式，并对输入 <code>String</code> 进行搜索。一旦找到了匹配这些模式的部分，你就能随心所欲地对它们进行处理。初学正则表达式时，其语法是一个难点，但它确实是一种简洁、动态的语言。正则表达式提供了一种完全通用的方式，能够解决各种 <code>String</code> 处理相关的问题：匹配、选择、编辑以及验证。</p><h3 id=基础>基础</h3><p>一般来说，正则表达式就是以某种方式来描述字符串，因此你可以说：“如果一个字符串含有这些东西，那么它就是我正在找的东西。”例如，要找一个数字，它可能有一个负号在最前面，那你就写一个负号加上一个问号，就像这样：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=o>-?</span>
</span></span></code></pre></div><p>要描述一个整数，你可以说它有一位或多位阿拉伯数字。在正则表达式中，用 <code>\d</code> 表示一位数字。如果在其他语言中使用过正则表达式，那你可能就能发现 Java 对反斜线 \ 的不同处理方式。在其他语言中，<code>\\</code> 表示“我想要在正则表达式中插入一个普通的（字面上的）反斜线，请不要给它任何特殊的意义。”而在 Java 中，<code>\\</code> 的意思是“我要插入一个正则表达式的反斜线，所以其后的字符具有特殊的意义。”例如，如果你想表示一位数字，那么正则表达式应该是 <code>\\d</code>。如果你想插入一个普通的反斜线，应该这样写 <code>\\\</code>。不过换行符和制表符之类的东西只需要使用单反斜线：<code>\n\t</code>。 <sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup></p><p>要表示“一个或多个之前的表达式”，应该使用 <code>+</code>。所以，如果要表示“可能有一个负号，后面跟着一位或多位数字”，可以这样：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=o>-?</span><span class=err>\\</span><span class=n>d</span><span class=o>+</span>
</span></span></code></pre></div><p>应用正则表达式最简单的途径，就是利用 <code>String</code> 类内建的功能。例如，你可以检查一个 <code>String</code> 是否匹配如上所述的正则表达式：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// strings/IntegerMatch.java
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>IntegerMatch</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;-1234&#34;</span><span class=o>.</span><span class=na>matches</span><span class=o>(</span><span class=s>&#34;-?\\d+&#34;</span><span class=o>));</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;5678&#34;</span><span class=o>.</span><span class=na>matches</span><span class=o>(</span><span class=s>&#34;-?\\d+&#34;</span><span class=o>));</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;+911&#34;</span><span class=o>.</span><span class=na>matches</span><span class=o>(</span><span class=s>&#34;-?\\d+&#34;</span><span class=o>));</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;+911&#34;</span><span class=o>.</span><span class=na>matches</span><span class=o>(</span><span class=s>&#34;(-|\\+)?\\d+&#34;</span><span class=o>));</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=cm>/* Output:
</span></span></span><span class=line><span class=cl><span class=cm>true
</span></span></span><span class=line><span class=cl><span class=cm>true
</span></span></span><span class=line><span class=cl><span class=cm>false
</span></span></span><span class=line><span class=cl><span class=cm>true
</span></span></span><span class=line><span class=cl><span class=cm>*/</span>
</span></span></code></pre></div><p>前两个字符串都满足对应的正则表达式，匹配成功。第三个字符串以 <code>+</code> 开头，这也是一个合法的符号，但与对应的正则表达式却不匹配。因此，我们的正则表达式应该描述为：“可能以一个加号或减号开头”。在正则表达式中，用括号将表达式进行分组，用竖线 <code>|</code> 表示或操作。也就是：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=o>(-|</span><span class=err>\\</span><span class=o>+)?</span>
</span></span></code></pre></div><p>这个正则表达式表示字符串的起始字符可能是一个 <code>-</code> 或 <code>+</code>，或者二者都没有（因为后面跟着 <code>?</code> 修饰符）。因为字符 <code>+</code> 在正则表达式中有特殊的意义，所以必须使用 <code>\\</code> 将其转义，使之成为表达式中的一个普通字符。</p><p><code>String</code>类还自带了一个非常有用的正则表达式工具——<code>split()</code> 方法，其功能是“将字符串从正则表达式匹配的地方切开。”</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// strings/Splitting.java import java.util.*;
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>Splitting</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=n>String</span> <span class=n>knights</span> <span class=o>=</span>
</span></span><span class=line><span class=cl>      <span class=s>&#34;Then, when you have found the shrubbery, &#34;</span> <span class=o>+</span>
</span></span><span class=line><span class=cl>      <span class=s>&#34;you must cut down the mightiest tree in the &#34;</span> <span class=o>+</span>
</span></span><span class=line><span class=cl>      <span class=s>&#34;forest...with... a herring!&#34;</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>split</span><span class=o>(</span><span class=n>String</span> <span class=n>regex</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span>
</span></span><span class=line><span class=cl>          <span class=n>Arrays</span><span class=o>.</span><span class=na>toString</span><span class=o>(</span><span class=n>knights</span><span class=o>.</span><span class=na>split</span><span class=o>(</span><span class=n>regex</span><span class=o>)));</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>split</span><span class=o>(</span><span class=s>&#34; &#34;</span><span class=o>);</span> <span class=c1>// Doesn&#39;t have to contain regex chars
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>split</span><span class=o>(</span><span class=s>&#34;\\W+&#34;</span><span class=o>);</span> <span class=c1>// Non-word characters
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>split</span><span class=o>(</span><span class=s>&#34;n\\W+&#34;</span><span class=o>);</span> <span class=c1>// &#39;n&#39; followed by non-words
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=cm>/* Output:
</span></span></span><span class=line><span class=cl><span class=cm>[Then,, when, you, have, found, the, shrubbery,, you,
</span></span></span><span class=line><span class=cl><span class=cm>must, cut, down, the, mightiest, tree, in, the,
</span></span></span><span class=line><span class=cl><span class=cm>forest...with..., a, herring!]
</span></span></span><span class=line><span class=cl><span class=cm>[Then, when, you, have, found, the, shrubbery, you,
</span></span></span><span class=line><span class=cl><span class=cm>must, cut, down, the, mightiest, tree, in, the, forest,
</span></span></span><span class=line><span class=cl><span class=cm>with, a, herring]
</span></span></span><span class=line><span class=cl><span class=cm>[The, whe, you have found the shrubbery, you must cut
</span></span></span><span class=line><span class=cl><span class=cm>dow, the mightiest tree i, the forest...with... a
</span></span></span><span class=line><span class=cl><span class=cm>herring!]
</span></span></span><span class=line><span class=cl><span class=cm>*/</span>
</span></span></code></pre></div><p>首先看第一个语句，注意这里用的是普通的字符作为正则表达式，其中并不包含任何特殊字符。因此第一个 <code>split()</code> 只是按空格来划分字符串。</p><p>第二个和第三个 <code>split()</code> 都用到了 <code>\\W</code>，它的意思是一个非单词字符（如果 W 小写，<code>\\w</code>，则表示一个单词字符）。通过第二个例子可以看到，它将标点字符删除了。第三个 <code>split()</code> 表示“字母 <code>n</code> 后面跟着一个或多个非单词字符。”可以看到，在原始字符串中，与正则表达式匹配的部分，在最终结果中都不存在了。</p><p><code>String.split()</code> 还有一个重载的版本，它允许你限制字符串分割的次数。</p><p>用正则表达式进行替换操作时，你可以只替换第一处匹配，也可以替换所有的匹配：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// strings/Replacing.java
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>Replacing</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>static</span> <span class=n>String</span> <span class=n>s</span> <span class=o>=</span> <span class=n>Splitting</span><span class=o>.</span><span class=na>knights</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span>
</span></span><span class=line><span class=cl>          <span class=n>s</span><span class=o>.</span><span class=na>replaceFirst</span><span class=o>(</span><span class=s>&#34;f\\w+&#34;</span><span class=o>,</span> <span class=s>&#34;located&#34;</span><span class=o>));</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span>
</span></span><span class=line><span class=cl>          <span class=n>s</span><span class=o>.</span><span class=na>replaceAll</span><span class=o>(</span><span class=s>&#34;shrubbery|tree|herring&#34;</span><span class=o>,</span><span class=s>&#34;banana&#34;</span><span class=o>));</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=cm>/* Output:
</span></span></span><span class=line><span class=cl><span class=cm>Then, when you have located the shrubbery, you must cut
</span></span></span><span class=line><span class=cl><span class=cm>down the mightiest tree in the forest...with... a
</span></span></span><span class=line><span class=cl><span class=cm>herring!
</span></span></span><span class=line><span class=cl><span class=cm>Then, when you have found the banana, you must cut down
</span></span></span><span class=line><span class=cl><span class=cm>the mightiest banana in the forest...with... a banana!
</span></span></span><span class=line><span class=cl><span class=cm>*/</span>
</span></span></code></pre></div><p>第一个表达式要匹配的是，以字母 <code>f</code> 开头，后面跟一个或多个字母（注意这里的 <code>w</code> 是小写的）。并且只替换掉第一个匹配的部分，所以 “found” 被替换成 “located”。</p><p>第二个表达式要匹配的是三个单词中的任意一个，因为它们以竖线分割表示“或”，并且替换所有匹配的部分。</p><p>稍后你会看到，<code>String</code> 之外的正则表达式还有更强大的替换工具，例如，可以通过方法调用执行替换。而且，如果正则表达式不是只使用一次的话，非 <code>String</code> 对象的正则表达式明显具备更佳的性能。</p><h3 id=创建正则表达式>创建正则表达式</h3><p>我们首先从正则表达式可能存在的构造集中选取一个很有用的子集，以此开始学习正则表达式。正则表达式的完整构造子列表，请参考 JDK 文档 <code>java.util.regex</code> 包中的 <code>Pattern</code>类。</p><table><thead><tr><th style=text-align:left>表达式</th><th style=text-align:left>含义</th></tr></thead><tbody><tr><td style=text-align:left><code>B</code></td><td style=text-align:left>指定字符<code>B</code></td></tr><tr><td style=text-align:left><code>\xhh</code></td><td style=text-align:left>十六进制值为<code>0xhh</code>的字符</td></tr><tr><td style=text-align:left><code>\uhhhh</code></td><td style=text-align:left>十六进制表现为<code>0xhhhh</code>的 Unicode 字符</td></tr><tr><td style=text-align:left><code>\t</code></td><td style=text-align:left>制表符 Tab</td></tr><tr><td style=text-align:left><code>\n</code></td><td style=text-align:left>换行符</td></tr><tr><td style=text-align:left><code>\r</code></td><td style=text-align:left>回车</td></tr><tr><td style=text-align:left><code>\f</code></td><td style=text-align:left>换页</td></tr><tr><td style=text-align:left><code>\e</code></td><td style=text-align:left>转义（Escape）</td></tr></tbody></table><p>当你学会了使用字符类（character classes）之后，正则表达式的威力才能真正显现出来。以下是一些创建字符类的典型方式，以及一些预定义的类：</p><table><thead><tr><th style=text-align:left>表达式</th><th style=text-align:left>含义</th><th></th><th></th><th></th><th></th><th></th></tr></thead><tbody><tr><td style=text-align:left><code>.</code></td><td style=text-align:left>任意字符</td><td></td><td></td><td></td><td></td><td></td></tr><tr><td style=text-align:left><code>[abc]</code></td><td style=text-align:left>包含<code>a</code>、<code>b</code>或<code>c</code>的任何字符（和`a</td><td>b</td><td>c`作用相同）</td><td></td><td></td><td></td></tr><tr><td style=text-align:left><code>[^abc]</code></td><td style=text-align:left>除<code>a</code>、<code>b</code>和<code>c</code>之外的任何字符（否定）</td><td></td><td></td><td></td><td></td><td></td></tr><tr><td style=text-align:left><code>[a-zA-Z]</code></td><td style=text-align:left>从<code>a</code>到<code>z</code>或从<code>A</code>到<code>Z</code>的任何字符（范围）</td><td></td><td></td><td></td><td></td><td></td></tr><tr><td style=text-align:left><code>[abc[hij]]</code></td><td style=text-align:left><code>a</code>、<code>b</code>、<code>c</code>、<code>h</code>、<code>i</code>、<code>j</code>中的任意字符（与`a</td><td>b</td><td>c</td><td>h</td><td>i</td><td>j`作用相同）（合并）</td></tr><tr><td style=text-align:left><code>[a-z&&[hij]]</code></td><td style=text-align:left>任意<code>h</code>、<code>i</code>或<code>j</code>（交）</td><td></td><td></td><td></td><td></td><td></td></tr><tr><td style=text-align:left><code>\s</code></td><td style=text-align:left>空白符（空格、tab、换行、换页、回车）</td><td></td><td></td><td></td><td></td><td></td></tr><tr><td style=text-align:left><code>\S</code></td><td style=text-align:left>非空白符（<code>[^\s]</code>）</td><td></td><td></td><td></td><td></td><td></td></tr><tr><td style=text-align:left><code>\d</code></td><td style=text-align:left>数字（<code>[0-9]</code>）</td><td></td><td></td><td></td><td></td><td></td></tr><tr><td style=text-align:left><code>\D</code></td><td style=text-align:left>非数字（<code>[^0-9]</code>）</td><td></td><td></td><td></td><td></td><td></td></tr><tr><td style=text-align:left><code>\w</code></td><td style=text-align:left>词字符（<code>[a-zA-Z_0-9]</code>）</td><td></td><td></td><td></td><td></td><td></td></tr><tr><td style=text-align:left><code>\W</code></td><td style=text-align:left>非词字符（<code>[^\w]</code>）</td><td></td><td></td><td></td><td></td><td></td></tr></tbody></table><p>这里只列出了部分常用的表达式，你应该将 JDK 文档中 <code>java.util.regex.Pattern</code> 那一页加入浏览器书签中，以便在需要的时候方便查询。</p><table><thead><tr><th style=text-align:center>逻辑操作符</th><th style=text-align:left>含义</th><th></th></tr></thead><tbody><tr><td style=text-align:center><code>XY</code></td><td style=text-align:left><code>Y</code>跟在<code>X</code>后面</td><td></td></tr><tr><td style=text-align:center>`X</td><td style=text-align:left>Y`</td><td><code>X</code>或<code>Y</code></td></tr><tr><td style=text-align:center><code>(X)</code></td><td style=text-align:left>捕获组（capturing group）。可以在表达式中用<code>\i</code>引用第 i 个捕获组</td><td></td></tr></tbody></table><p>下面是不同的边界匹配符：</p><table><thead><tr><th style=text-align:center>边界匹配符</th><th style=text-align:left>含义</th></tr></thead><tbody><tr><td style=text-align:center><code>^</code></td><td style=text-align:left>一行的开始</td></tr><tr><td style=text-align:center><code>$</code></td><td style=text-align:left>一行的结束</td></tr><tr><td style=text-align:center><code>\b</code></td><td style=text-align:left>词的边界</td></tr><tr><td style=text-align:center><code>\B</code></td><td style=text-align:left>非词的边界</td></tr><tr><td style=text-align:center><code>\G</code></td><td style=text-align:left>前一个匹配的结束</td></tr></tbody></table><p>作为演示，下面的每一个正则表达式都能成功匹配字符序列“Rudolph”：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// strings/Rudolph.java
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>Rudolph</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span><span class=o>(</span><span class=n>String</span> <span class=n>pattern</span> <span class=o>:</span> <span class=k>new</span> <span class=n>String</span><span class=o>[]{</span>
</span></span><span class=line><span class=cl>          <span class=s>&#34;Rudolph&#34;</span><span class=o>,</span>
</span></span><span class=line><span class=cl>          <span class=s>&#34;[rR]udolph&#34;</span><span class=o>,</span>
</span></span><span class=line><span class=cl>          <span class=s>&#34;[rR][aeiou][a-z]ol.*&#34;</span><span class=o>,</span>
</span></span><span class=line><span class=cl>          <span class=s>&#34;R.*&#34;</span> <span class=o>})</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;Rudolph&#34;</span><span class=o>.</span><span class=na>matches</span><span class=o>(</span><span class=n>pattern</span><span class=o>));</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=cm>/* Output:
</span></span></span><span class=line><span class=cl><span class=cm>true
</span></span></span><span class=line><span class=cl><span class=cm>true
</span></span></span><span class=line><span class=cl><span class=cm>true
</span></span></span><span class=line><span class=cl><span class=cm>true
</span></span></span><span class=line><span class=cl><span class=cm>*/</span>
</span></span></code></pre></div><p>我们的目的并不是编写最难理解的正则表达式，而是尽量编写能够完成任务的、最简单以及最必要的正则表达式。一旦真正开始使用正则表达式了，你就会发现，在编写新的表达式之前，你通常会参考代码中已经用到的正则表达式。</p><h3 id=量词>量词</h3><p>量词描述了一个模式捕获输入文本的方式：</p><ul><li><p><strong>贪婪型</strong>：
量词总是贪婪的，除非有其他的选项被设置。贪婪表达式会为所有可能的模式发现尽可能多的匹配。导致此问题的一个典型理由就是假定我们的模式仅能匹配第一个可能的字符组，如果它是贪婪的，那么它就会继续往下匹配。</p></li><li><p><strong>勉强型</strong>：
用问号来指定，这个量词匹配满足模式所需的最少字符数。因此也被称作懒惰的、最少匹配的、非贪婪的或不贪婪的。</p></li><li><p><strong>占有型</strong>：
目前，这种类型的量词只有在 Java 语言中才可用（在其他语言中不可用），并且也更高级，因此我们大概不会立刻用到它。当正则表达式被应用于 <code>String</code> 时，它会产生相当多的状态，以便在匹配失败时可以回溯。而“占有的”量词并不保存这些中间状态，因此它们可以防止回溯。它们常常用于防止正则表达式失控，因此可以使正则表达式执行起来更高效。</p></li></ul><table><thead><tr><th>贪婪型</th><th>勉强型</th><th>占有型</th><th>如何匹配</th></tr></thead><tbody><tr><td><code>X?</code></td><td><code>X??</code></td><td><code>X?+</code></td><td>一个或零个<code>X</code></td></tr><tr><td><code>X*</code></td><td><code>X*?</code></td><td><code>X*+</code></td><td>零个或多个<code>X</code></td></tr><tr><td><code>X+</code></td><td><code>X+?</code></td><td><code>X++</code></td><td>一个或多个<code>X</code></td></tr><tr><td><code>X{n}</code></td><td><code>X{n}?</code></td><td><code>X{n}+</code></td><td>恰好<code>n</code>次<code>X</code></td></tr><tr><td><code>X{n,}</code></td><td><code>X{n,}?</code></td><td><code>X{n,}+</code></td><td>至少<code>n</code>次<code>X</code></td></tr><tr><td><code>X{n,m}</code></td><td><code>X{n,m}?</code></td><td><code>X{n,m}+</code></td><td><code>X</code>至少<code>n</code>次，但不超过<code>m</code>次</td></tr></tbody></table><p>应该非常清楚地意识到，表达式 <code>X</code> 通常必须要用圆括号括起来，以便它能够按照我们期望的效果去执行。例如：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>abc</span><span class=o>+</span>
</span></span></code></pre></div><p>看起来它似乎应该匹配 1 个或多个<code>abc</code>序列，如果我们把它应用于输入字符串<code>abcabcabc</code>，则实际上会获得 3 个匹配。然而，这个表达式实际上表示的是：匹配<code>ab</code>，后面跟随 1 个或多个<code>c</code>。要表明匹配 1 个或多个完整的字符串<code>abc</code>，我们必须这样表示：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=o>(</span><span class=n>abc</span><span class=o>)+</span>
</span></span></code></pre></div><p>你会发现，在使用正则表达式时很容易混淆，因为它是一种在 Java 之上的新语言。</p><h3 id=charsequence><code>CharSequence</code></h3><p>接口 <code>CharSequence</code> 从 <code>CharBuffer</code>、<code>String</code>、<code>StringBuffer</code>、<code>StringBuilder</code> 类中抽象出了字符序列的一般化定义：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>interface</span> <span class=nc>CharSequence</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kt>char</span> <span class=nf>charAt</span><span class=o>(</span><span class=kt>int</span> <span class=n>i</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=nf>length</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=n>CharSequence</span> <span class=nf>subSequence</span><span class=o>(</span><span class=kt>int</span> <span class=n>start</span><span class=o>,</span> <span class=kt>int</span> <span class=n>end</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>String</span> <span class=nf>toString</span><span class=o>();</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>因此，这些类都实现了该接口。多数正则表达式操作都接受 <code>CharSequence</code> 类型参数。</p><h3 id=pattern-和-matcher><code>Pattern</code> 和 <code>Matcher</code></h3><p>通常，比起功能有限的 <code>String</code> 类，我们更愿意构造功能强大的正则表达式对象。只需导入 <code>java.util.regex</code>包，然后用 <code>static Pattern.compile()</code> 方法来编译你的正则表达式即可。它会根据你的 <code>String</code> 类型的正则表达式生成一个 <code>Pattern</code> 对象。接下来，把你想要检索的字符串传入 <code>Pattern</code> 对象的 <code>matcher()</code> 方法。<code>matcher()</code> 方法会生成一个 <code>Matcher</code> 对象，它有很多功能可用（可以参考 <code>java.util.regext.Matcher</code> 的 JDK 文档）。例如，它的 <code>replaceAll()</code> 方法能将所有匹配的部分都替换成你传入的参数。</p><p>作为第一个示例，下面的类可以用来测试正则表达式，看看它们能否匹配一个输入字符串。第一个控制台参数是将要用来搜索匹配的输入字符串，后面的一个或多个参数都是正则表达式，它们将被用来在输入的第一个字符串中查找匹配。在 Unix/Linux 上，命令行中的正则表达式必须用引号括起来。这个程序在测试正则表达式时很有用，特别是当你想验证它们是否具备你所期待的匹配功能的时候。<sup id=fnref:3><a href=#fn:3 class=footnote-ref role=doc-noteref>3</a></sup></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// strings/TestRegularExpression.java
</span></span></span><span class=line><span class=cl><span class=c1>// Simple regular expression demonstration
</span></span></span><span class=line><span class=cl><span class=c1>// {java TestRegularExpression
</span></span></span><span class=line><span class=cl><span class=c1>// abcabcabcdefabc &#34;abc+&#34; &#34;(abc)+&#34; }
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>import</span> <span class=nn>java.util.regex.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>TestRegularExpression</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span><span class=o>(</span><span class=n>args</span><span class=o>.</span><span class=na>length</span> <span class=o>&lt;</span> <span class=mi>2</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span>
</span></span><span class=line><span class=cl>              <span class=s>&#34;Usage:\njava TestRegularExpression &#34;</span> <span class=o>+</span>
</span></span><span class=line><span class=cl>              <span class=s>&#34;characterSequence regularExpression+&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>            <span class=n>System</span><span class=o>.</span><span class=na>exit</span><span class=o>(</span><span class=mi>0</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;Input: \&#34;&#34;</span> <span class=o>+</span> <span class=n>args</span><span class=o>[</span><span class=mi>0</span><span class=o>]</span> <span class=o>+</span> <span class=s>&#34;\&#34;&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span><span class=o>(</span><span class=n>String</span> <span class=n>arg</span> <span class=o>:</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span>
</span></span><span class=line><span class=cl>              <span class=s>&#34;Regular expression: \&#34;&#34;</span> <span class=o>+</span> <span class=n>arg</span> <span class=o>+</span> <span class=s>&#34;\&#34;&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>            <span class=n>Pattern</span> <span class=n>p</span> <span class=o>=</span> <span class=n>Pattern</span><span class=o>.</span><span class=na>compile</span><span class=o>(</span><span class=n>arg</span><span class=o>);</span>
</span></span><span class=line><span class=cl>            <span class=n>Matcher</span> <span class=n>m</span> <span class=o>=</span> <span class=n>p</span><span class=o>.</span><span class=na>matcher</span><span class=o>(</span><span class=n>args</span><span class=o>[</span><span class=mi>0</span><span class=o>]);</span>
</span></span><span class=line><span class=cl>            <span class=k>while</span><span class=o>(</span><span class=n>m</span><span class=o>.</span><span class=na>find</span><span class=o>())</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span>
</span></span><span class=line><span class=cl>                  <span class=s>&#34;Match \&#34;&#34;</span> <span class=o>+</span> <span class=n>m</span><span class=o>.</span><span class=na>group</span><span class=o>()</span> <span class=o>+</span> <span class=s>&#34;\&#34; at positions &#34;</span> <span class=o>+</span>
</span></span><span class=line><span class=cl>                <span class=n>m</span><span class=o>.</span><span class=na>start</span><span class=o>()</span> <span class=o>+</span> <span class=s>&#34;-&#34;</span> <span class=o>+</span> <span class=o>(</span><span class=n>m</span><span class=o>.</span><span class=na>end</span><span class=o>()</span> <span class=o>-</span> <span class=mi>1</span><span class=o>));</span>
</span></span><span class=line><span class=cl>            <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=cm>/* Output:
</span></span></span><span class=line><span class=cl><span class=cm>Input: &#34;abcabcabcdefabc&#34;
</span></span></span><span class=line><span class=cl><span class=cm>Regular expression: &#34;abcabcabcdefabc&#34;
</span></span></span><span class=line><span class=cl><span class=cm>Match &#34;abcabcabcdefabc&#34; at positions 0-14
</span></span></span><span class=line><span class=cl><span class=cm>Regular expression: &#34;abc+&#34;
</span></span></span><span class=line><span class=cl><span class=cm>Match &#34;abc&#34; at positions 0-2
</span></span></span><span class=line><span class=cl><span class=cm>Match &#34;abc&#34; at positions 3-5
</span></span></span><span class=line><span class=cl><span class=cm>Match &#34;abc&#34; at positions 6-8
</span></span></span><span class=line><span class=cl><span class=cm>Match &#34;abc&#34; at positions 12-14
</span></span></span><span class=line><span class=cl><span class=cm>Regular expression: &#34;(abc)+&#34;
</span></span></span><span class=line><span class=cl><span class=cm>Match &#34;abcabcabc&#34; at positions 0-8
</span></span></span><span class=line><span class=cl><span class=cm>Match &#34;abc&#34; at positions 12-14
</span></span></span><span class=line><span class=cl><span class=cm>*/</span>
</span></span></code></pre></div><p>还可以在控制台参数中加入<code>“(abc){2,}”</code>，看看执行结果。</p><p><code>Pattern</code> 对象表示编译后的正则表达式。从这个例子可以看到，我们使用已编译的 <code>Pattern</code> 对象上的 <code>matcher()</code> 方法，加上一个输入字符串，从而共同构造了一个 <code>Matcher</code> 对象。同时，<code>Pattern</code> 类还提供了一个<code>static</code>方法：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>static</span> <span class=kt>boolean</span> <span class=nf>matches</span><span class=o>(</span><span class=n>String</span> <span class=n>regex</span><span class=o>,</span> <span class=n>CharSequence</span> <span class=n>input</span><span class=o>)</span>
</span></span></code></pre></div><p>该方法用以检查 <code>regex</code> 是否匹配整个 <code>CharSequence</code> 类型的 <code>input</code> 参数。编译后的 <code>Pattern</code> 对象还提供了 <code>split()</code> 方法，它从匹配了 <code>regex</code> 的地方分割输入字符串，返回分割后的子字符串 <code>String</code> 数组。</p><p>通过调用 <code>Pattern.matcher()</code> 方法，并传入一个字符串参数，我们得到了一个 <code>Matcher</code> 对象。使用 <code>Matcher</code> 上的方法，我们将能够判断各种不同类型的匹配是否成功：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kt>boolean</span> <span class=nf>matches</span><span class=o>()</span>
</span></span><span class=line><span class=cl><span class=kt>boolean</span> <span class=nf>lookingAt</span><span class=o>()</span>
</span></span><span class=line><span class=cl><span class=kt>boolean</span> <span class=nf>find</span><span class=o>()</span>
</span></span><span class=line><span class=cl><span class=kt>boolean</span> <span class=nf>find</span><span class=o>(</span><span class=kt>int</span> <span class=n>start</span><span class=o>)</span>
</span></span></code></pre></div><p>其中的 <code>matches()</code> 方法用来判断整个输入字符串是否匹配正则表达式模式，而 <code>lookingAt()</code> 则用来判断该字符串（不必是整个字符串）的起始部分是否能够匹配模式。</p><h3 id=find><code>find()</code></h3><p><code>Matcher.find()</code> 方法可用来在 <code>CharSequence</code> 中查找多个匹配。例如：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// strings/Finding.java
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>import</span> <span class=nn>java.util.regex.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>Finding</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>Matcher</span> <span class=n>m</span> <span class=o>=</span> <span class=n>Pattern</span><span class=o>.</span><span class=na>compile</span><span class=o>(</span><span class=s>&#34;\\w+&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl>          <span class=o>.</span><span class=na>matcher</span><span class=o>(</span>
</span></span><span class=line><span class=cl>            <span class=s>&#34;Evening is full of the linnet&#39;s wings&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=k>while</span><span class=o>(</span><span class=n>m</span><span class=o>.</span><span class=na>find</span><span class=o>())</span>
</span></span><span class=line><span class=cl>            <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>print</span><span class=o>(</span><span class=n>m</span><span class=o>.</span><span class=na>group</span><span class=o>()</span> <span class=o>+</span> <span class=s>&#34; &#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=k>while</span><span class=o>(</span><span class=n>m</span><span class=o>.</span><span class=na>find</span><span class=o>(</span><span class=n>i</span><span class=o>))</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>print</span><span class=o>(</span><span class=n>m</span><span class=o>.</span><span class=na>group</span><span class=o>()</span> <span class=o>+</span> <span class=s>&#34; &#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>            <span class=n>i</span><span class=o>++;</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=cm>/* Output:
</span></span></span><span class=line><span class=cl><span class=cm>Evening is full of the linnet s wings
</span></span></span><span class=line><span class=cl><span class=cm>Evening vening ening ning ing ng g is is s full full
</span></span></span><span class=line><span class=cl><span class=cm>ull ll l of of f the the he e linnet linnet innet nnet
</span></span></span><span class=line><span class=cl><span class=cm>net et t s s wings wings ings ngs gs s
</span></span></span><span class=line><span class=cl><span class=cm>*/</span>
</span></span></code></pre></div><p>模式 <code>\\w+</code> 将字符串划分为词。<code>find()</code> 方法像迭代器那样向前遍历输入字符串。而第二个重载的 <code>find()</code> 接收一个整型参数，该整数表示字符串中字符的位置，并以其作为搜索的起点。从结果可以看出，后一个版本的 <code>find()</code> 方法能够根据其参数的值，不断重新设定搜索的起始位置。</p><h3 id=组groups>组（Groups）</h3><p>组是用括号划分的正则表达式，可以根据组的编号来引用某个组。组号为 0 表示整个表达式，组号 1 表示被第一对括号括起来的组，以此类推。因此，下面这个表达式，</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>A</span><span class=o>(</span><span class=n>B</span><span class=o>(</span><span class=n>C</span><span class=o>))</span><span class=n>D</span>
</span></span></code></pre></div><p>中有三个组：组 0 是 <code>ABCD</code>，组 1 是 <code>BC</code>，组 2 是 <code>C</code>。</p><p><code>Matcher</code> 对象提供了一系列方法，用以获取与组相关的信息：</p><ul><li><code>public int groupCount()</code> 返回该匹配器的模式中的分组数目，组 0 不包括在内。</li><li><code>public String group()</code> 返回前一次匹配操作（例如 <code>find()</code>）的第 0 组（整个匹配）。</li><li><code>public String group(int i)</code> 返回前一次匹配操作期间指定的组号，如果匹配成功，但是指定的组没有匹配输入字符串的任何部分，则将返回 <code>null</code>。</li><li><code>public int start(int group)</code> 返回在前一次匹配操作中寻找到的组的起始索引。</li><li><code>public int end(int group)</code> 返回在前一次匹配操作中寻找到的组的最后一个字符索引加一的值。</li></ul><p>下面是正则表达式组的例子：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// strings/Groups.java
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>import</span> <span class=nn>java.util.regex.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>Groups</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=kd>final</span> <span class=n>String</span> <span class=n>POEM</span> <span class=o>=</span>
</span></span><span class=line><span class=cl>      <span class=s>&#34;Twas brillig, and the slithy toves\n&#34;</span> <span class=o>+</span>
</span></span><span class=line><span class=cl>      <span class=s>&#34;Did gyre and gimble in the wabe.\n&#34;</span> <span class=o>+</span>
</span></span><span class=line><span class=cl>      <span class=s>&#34;All mimsy were the borogoves,\n&#34;</span> <span class=o>+</span>
</span></span><span class=line><span class=cl>      <span class=s>&#34;And the mome raths outgrabe.\n\n&#34;</span> <span class=o>+</span>
</span></span><span class=line><span class=cl>      <span class=s>&#34;Beware the Jabberwock, my son,\n&#34;</span> <span class=o>+</span>
</span></span><span class=line><span class=cl>      <span class=s>&#34;The jaws that bite, the claws that catch.\n&#34;</span> <span class=o>+</span>
</span></span><span class=line><span class=cl>      <span class=s>&#34;Beware the Jubjub bird, and shun\n&#34;</span> <span class=o>+</span>
</span></span><span class=line><span class=cl>      <span class=s>&#34;The frumious Bandersnatch.&#34;</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>Matcher</span> <span class=n>m</span> <span class=o>=</span> <span class=n>Pattern</span><span class=o>.</span><span class=na>compile</span><span class=o>(</span>
</span></span><span class=line><span class=cl>          <span class=s>&#34;(?m)(\\S+)\\s+((\\S+)\\s+(\\S+))$&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl>          <span class=o>.</span><span class=na>matcher</span><span class=o>(</span><span class=n>POEM</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=k>while</span><span class=o>(</span><span class=n>m</span><span class=o>.</span><span class=na>find</span><span class=o>())</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span><span class=o>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=mi>0</span><span class=o>;</span> <span class=n>j</span> <span class=o>&lt;=</span> <span class=n>m</span><span class=o>.</span><span class=na>groupCount</span><span class=o>();</span> <span class=n>j</span><span class=o>++)</span>
</span></span><span class=line><span class=cl>                <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>print</span><span class=o>(</span><span class=s>&#34;[&#34;</span> <span class=o>+</span> <span class=n>m</span><span class=o>.</span><span class=na>group</span><span class=o>(</span><span class=n>j</span><span class=o>)</span> <span class=o>+</span> <span class=s>&#34;]&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>            <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=cm>/* Output:
</span></span></span><span class=line><span class=cl><span class=cm>[the slithy toves][the][slithy toves][slithy][toves]
</span></span></span><span class=line><span class=cl><span class=cm>[in the wabe.][in][the wabe.][the][wabe.]
</span></span></span><span class=line><span class=cl><span class=cm>[were the borogoves,][were][the
</span></span></span><span class=line><span class=cl><span class=cm>borogoves,][the][borogoves,]
</span></span></span><span class=line><span class=cl><span class=cm>[mome raths outgrabe.][mome][raths
</span></span></span><span class=line><span class=cl><span class=cm>outgrabe.][raths][outgrabe.]
</span></span></span><span class=line><span class=cl><span class=cm>[Jabberwock, my son,][Jabberwock,][my son,][my][son,]
</span></span></span><span class=line><span class=cl><span class=cm>[claws that catch.][claws][that catch.][that][catch.]
</span></span></span><span class=line><span class=cl><span class=cm>[bird, and shun][bird,][and shun][and][shun]
</span></span></span><span class=line><span class=cl><span class=cm>[The frumious Bandersnatch.][The][frumious
</span></span></span><span class=line><span class=cl><span class=cm>Bandersnatch.][frumious][Bandersnatch.]
</span></span></span><span class=line><span class=cl><span class=cm>*/</span>
</span></span></code></pre></div><p>这首诗来自于 Lewis Carroll 所写的 <em>Through the Looking Glass</em> 中的 “Jabberwocky”。可以看到这个正则表达式模式有许多圆括号分组，由任意数目的非空白符（<code>\\S+</code>）及随后的任意数目的空白符（<code>\\s+</code>）所组成。目的是捕获每行的最后 3 个词，每行最后以 <code>\$</code> 结束。不过，在正常情况下是将 <code>\$</code> 与整个输入序列的末端相匹配。所以我们一定要显式地告知正则表达式注意输入序列中的换行符。这可以由序列开头的模式标记 <code>(?m)</code> 来完成（模式标记马上就会介绍）。</p><h3 id=start-和-end><code>start()</code> 和 <code>end()</code></h3><p>在匹配操作成功之后，<code>start()</code> 返回先前匹配的起始位置的索引，而 <code>end()</code> 返回所匹配的最后字符的索引加一的值。匹配操作失败之后（或先于一个正在进行的匹配操作去尝试）调用 <code>start()</code> 或 <code>end()</code> 将会产生 <code>IllegalStateException</code>。下面的示例还同时展示了 <code>matches()</code> 和 <code>lookingAt()</code> 的用法 <sup id=fnref:4><a href=#fn:4 class=footnote-ref role=doc-noteref>4</a></sup>：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// strings/StartEnd.java
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>import</span> <span class=nn>java.util.regex.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>StartEnd</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=n>String</span> <span class=n>input</span> <span class=o>=</span>
</span></span><span class=line><span class=cl>      <span class=s>&#34;As long as there is injustice, whenever a\n&#34;</span> <span class=o>+</span>
</span></span><span class=line><span class=cl>      <span class=s>&#34;Targathian baby cries out, wherever a distress\n&#34;</span> <span class=o>+</span>
</span></span><span class=line><span class=cl>      <span class=s>&#34;signal sounds among the stars &#34;</span> <span class=o>+</span>
</span></span><span class=line><span class=cl>      <span class=s>&#34;... We&#39;ll be there.\n&#34;</span><span class=o>+</span>
</span></span><span class=line><span class=cl>      <span class=s>&#34;This fine ship, and this fine crew ...\n&#34;</span> <span class=o>+</span>
</span></span><span class=line><span class=cl>      <span class=s>&#34;Never give up! Never surrender!&#34;</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kd>static</span> <span class=kd>class</span> <span class=nc>Display</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=kd>private</span> <span class=kt>boolean</span> <span class=n>regexPrinted</span> <span class=o>=</span> <span class=kc>false</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=kd>private</span> <span class=n>String</span> <span class=n>regex</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=n>Display</span><span class=o>(</span><span class=n>String</span> <span class=n>regex</span><span class=o>)</span> <span class=o>{</span> <span class=k>this</span><span class=o>.</span><span class=na>regex</span> <span class=o>=</span> <span class=n>regex</span><span class=o>;</span> <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=kt>void</span> <span class=nf>display</span><span class=o>(</span><span class=n>String</span> <span class=n>message</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span><span class=o>(!</span><span class=n>regexPrinted</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>regex</span><span class=o>);</span>
</span></span><span class=line><span class=cl>                <span class=n>regexPrinted</span> <span class=o>=</span> <span class=kc>true</span><span class=o>;</span>
</span></span><span class=line><span class=cl>            <span class=o>}</span>
</span></span><span class=line><span class=cl>            <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>message</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>static</span> <span class=kt>void</span> <span class=nf>examine</span><span class=o>(</span><span class=n>String</span> <span class=n>s</span><span class=o>,</span> <span class=n>String</span> <span class=n>regex</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>Display</span> <span class=n>d</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Display</span><span class=o>(</span><span class=n>regex</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>Pattern</span> <span class=n>p</span> <span class=o>=</span> <span class=n>Pattern</span><span class=o>.</span><span class=na>compile</span><span class=o>(</span><span class=n>regex</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>Matcher</span> <span class=n>m</span> <span class=o>=</span> <span class=n>p</span><span class=o>.</span><span class=na>matcher</span><span class=o>(</span><span class=n>s</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=k>while</span><span class=o>(</span><span class=n>m</span><span class=o>.</span><span class=na>find</span><span class=o>())</span>
</span></span><span class=line><span class=cl>            <span class=n>d</span><span class=o>.</span><span class=na>display</span><span class=o>(</span><span class=s>&#34;find() &#39;&#34;</span> <span class=o>+</span> <span class=n>m</span><span class=o>.</span><span class=na>group</span><span class=o>()</span> <span class=o>+</span>
</span></span><span class=line><span class=cl>              <span class=s>&#34;&#39; start = &#34;</span><span class=o>+</span> <span class=n>m</span><span class=o>.</span><span class=na>start</span><span class=o>()</span> <span class=o>+</span> <span class=s>&#34; end = &#34;</span> <span class=o>+</span> <span class=n>m</span><span class=o>.</span><span class=na>end</span><span class=o>());</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span><span class=o>(</span><span class=n>m</span><span class=o>.</span><span class=na>lookingAt</span><span class=o>())</span> <span class=c1>// No reset() necessary
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=n>d</span><span class=o>.</span><span class=na>display</span><span class=o>(</span><span class=s>&#34;lookingAt() start = &#34;</span>
</span></span><span class=line><span class=cl>              <span class=o>+</span> <span class=n>m</span><span class=o>.</span><span class=na>start</span><span class=o>()</span> <span class=o>+</span> <span class=s>&#34; end = &#34;</span> <span class=o>+</span> <span class=n>m</span><span class=o>.</span><span class=na>end</span><span class=o>());</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span><span class=o>(</span><span class=n>m</span><span class=o>.</span><span class=na>matches</span><span class=o>())</span> <span class=c1>// No reset() necessary
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=n>d</span><span class=o>.</span><span class=na>display</span><span class=o>(</span><span class=s>&#34;matches() start = &#34;</span>
</span></span><span class=line><span class=cl>              <span class=o>+</span> <span class=n>m</span><span class=o>.</span><span class=na>start</span><span class=o>()</span> <span class=o>+</span> <span class=s>&#34; end = &#34;</span> <span class=o>+</span> <span class=n>m</span><span class=o>.</span><span class=na>end</span><span class=o>());</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span><span class=o>(</span><span class=n>String</span> <span class=n>in</span> <span class=o>:</span> <span class=n>input</span><span class=o>.</span><span class=na>split</span><span class=o>(</span><span class=s>&#34;\n&#34;</span><span class=o>))</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;input : &#34;</span> <span class=o>+</span> <span class=n>in</span><span class=o>);</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span><span class=o>(</span><span class=n>String</span> <span class=n>regex</span> <span class=o>:</span> <span class=k>new</span> <span class=n>String</span><span class=o>[]{</span><span class=s>&#34;\\w*ere\\w*&#34;</span><span class=o>,</span>
</span></span><span class=line><span class=cl>              <span class=s>&#34;\\w*ever&#34;</span><span class=o>,</span> <span class=s>&#34;T\\w+&#34;</span><span class=o>,</span> <span class=s>&#34;Never.*?!&#34;</span><span class=o>})</span>
</span></span><span class=line><span class=cl>                <span class=n>examine</span><span class=o>(</span><span class=n>in</span><span class=o>,</span> <span class=n>regex</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=cm>/* Output:
</span></span></span><span class=line><span class=cl><span class=cm>input : As long as there is injustice, whenever a
</span></span></span><span class=line><span class=cl><span class=cm>\w*ere\w*
</span></span></span><span class=line><span class=cl><span class=cm>find() &#39;there&#39; start = 11 end = 16
</span></span></span><span class=line><span class=cl><span class=cm>\w*ever
</span></span></span><span class=line><span class=cl><span class=cm>find() &#39;whenever&#39; start = 31 end = 39
</span></span></span><span class=line><span class=cl><span class=cm>input : Targathian baby cries out, wherever a distress
</span></span></span><span class=line><span class=cl><span class=cm>\w*ere\w*
</span></span></span><span class=line><span class=cl><span class=cm>find() &#39;wherever&#39; start = 27 end = 35
</span></span></span><span class=line><span class=cl><span class=cm>\w*ever
</span></span></span><span class=line><span class=cl><span class=cm>find() &#39;wherever&#39; start = 27 end = 35
</span></span></span><span class=line><span class=cl><span class=cm>T\w+ find() &#39;Targathian&#39; start = 0 end = 10
</span></span></span><span class=line><span class=cl><span class=cm>lookingAt() start = 0 end = 10
</span></span></span><span class=line><span class=cl><span class=cm>input : signal sounds among the stars ... We&#39;ll be
</span></span></span><span class=line><span class=cl><span class=cm>there.
</span></span></span><span class=line><span class=cl><span class=cm>\w*ere\w*
</span></span></span><span class=line><span class=cl><span class=cm>find() &#39;there&#39; start = 43 end = 48
</span></span></span><span class=line><span class=cl><span class=cm>input : This fine ship, and this fine crew ...
</span></span></span><span class=line><span class=cl><span class=cm>T\w+ find() &#39;This&#39; start = 0 end = 4
</span></span></span><span class=line><span class=cl><span class=cm>lookingAt() start = 0 end = 4
</span></span></span><span class=line><span class=cl><span class=cm>input : Never give up! Never surrender!
</span></span></span><span class=line><span class=cl><span class=cm>\w*ever
</span></span></span><span class=line><span class=cl><span class=cm>find() &#39;Never&#39; start = 0 end = 5
</span></span></span><span class=line><span class=cl><span class=cm>find() &#39;Never&#39; start = 15 end = 20
</span></span></span><span class=line><span class=cl><span class=cm>lookingAt() start = 0 end = 5
</span></span></span><span class=line><span class=cl><span class=cm>Never.*?!
</span></span></span><span class=line><span class=cl><span class=cm>find() &#39;Never give up!&#39; start = 0 end = 14
</span></span></span><span class=line><span class=cl><span class=cm>find() &#39;Never surrender!&#39; start = 15 end = 31
</span></span></span><span class=line><span class=cl><span class=cm>lookingAt() start = 0 end = 14
</span></span></span><span class=line><span class=cl><span class=cm>matches() start = 0 end = 31
</span></span></span><span class=line><span class=cl><span class=cm>*/</span>
</span></span></code></pre></div><p>注意，<code>find()</code> 可以在输入的任意位置定位正则表达式，而 <code>lookingAt()</code> 和 <code>matches()</code> 只有在正则表达式与输入的最开始处就开始匹配时才会成功。<code>matches()</code> 只有在整个输入都匹配正则表达式时才会成功，而 <code>lookingAt()</code> <sup id=fnref:5><a href=#fn:5 class=footnote-ref role=doc-noteref>5</a></sup> 只要输入的第一部分匹配就会成功。</p><h3 id=pattern-标记><code>Pattern</code> 标记</h3><p><code>Pattern</code> 类的 <code>compile()</code> 方法还有另一个版本，它接受一个标记参数，以调整匹配行为：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>Pattern</span> <span class=n>Pattern</span><span class=o>.</span><span class=na>compile</span><span class=o>(</span><span class=n>String</span> <span class=n>regex</span><span class=o>,</span> <span class=kt>int</span> <span class=n>flag</span><span class=o>)</span>
</span></span></code></pre></div><p>其中的 <code>flag</code> 来自以下 <code>Pattern</code> 类中的常量</p><table><thead><tr><th>编译标记</th><th>效果</th></tr></thead><tbody><tr><td><code>Pattern.CANON_EQ</code></td><td>当且仅当两个字符的完全规范分解相匹配时，才认为它们是匹配的。例如，如果我们指定这个标记，表达式<code>\u003F</code>就会匹配字符串<code>?</code>。默认情况下，匹配不考虑规范的等价性</td></tr><tr><td><code>Pattern.CASE_INSENSITIVE(?i)</code></td><td>默认情况下，大小写不敏感的匹配假定只有 US-ASCII 字符集中的字符才能进行。这个标记允许模式匹配不考虑大小写（大写或小写）。通过指定<code>UNICODE_CASE</code>标记及结合此标记。基于 Unicode 的大小写不敏感的匹配就可以开启了</td></tr><tr><td><code>Pattern.COMMENTS(?x)</code></td><td>在这种模式下，空格符将被忽略掉，并且以<code>#</code>开始直到行末的注释也会被忽略掉。通过嵌入的标记表达式也可以开启 Unix 的行模式</td></tr><tr><td><code>Pattern.DOTALL(?s)</code></td><td>在 dotall 模式下，表达式<code>.</code>匹配所有字符，包括行终止符。默认情况下，<code>.</code>不会匹配行终止符</td></tr><tr><td><code>Pattern.MULTILINE(?m)</code></td><td>在多行模式下，表达式<code>^</code>和<code>$</code>分别匹配一行的开始和结束。<code>^</code>还匹配输入字符串的开始，而<code>$</code>还匹配输入字符串的结尾。默认情况下，这些表达式仅匹配输入的完整字符串的开始和结束</td></tr><tr><td><code>Pattern.UNICODE_CASE(?u)</code></td><td>当指定这个标记，并且开启<code>CASE_INSENSITIVE</code>时，大小写不敏感的匹配将按照与 Unicode 标准相一致的方式进行。默认情况下，大小写不敏感的匹配假定只能在 US-ASCII 字符集中的字符才能进行</td></tr><tr><td><code>Pattern.UNIX_LINES(?d)</code></td><td>在这种模式下，在<code>.</code>、<code>^</code>和<code>$</code>的行为中，只识别行终止符<code>\n</code></td></tr></tbody></table><p>在这些标记中，<code>Pattern.CASE_INSENSITIVE</code>、<code>Pattern.MULTILINE</code> 以及 <code>Pattern.COMMENTS</code>（对声明或文档有用）特别有用。请注意，你可以直接在正则表达式中使用其中的大多数标记，只需要将上表中括号括起来的字符插入到正则表达式中，你希望它起作用的位置即可。</p><p>你还可以通过“或”(<code>|</code>)操作符组合多个标记的功能：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// strings/ReFlags.java
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>import</span> <span class=nn>java.util.regex.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>ReFlags</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>Pattern</span> <span class=n>p</span> <span class=o>=</span>  <span class=n>Pattern</span><span class=o>.</span><span class=na>compile</span><span class=o>(</span><span class=s>&#34;^java&#34;</span><span class=o>,</span>
</span></span><span class=line><span class=cl>          <span class=n>Pattern</span><span class=o>.</span><span class=na>CASE_INSENSITIVE</span> <span class=o>|</span> <span class=n>Pattern</span><span class=o>.</span><span class=na>MULTILINE</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>Matcher</span> <span class=n>m</span> <span class=o>=</span> <span class=n>p</span><span class=o>.</span><span class=na>matcher</span><span class=o>(</span>
</span></span><span class=line><span class=cl>          <span class=s>&#34;java has regex\nJava has regex\n&#34;</span> <span class=o>+</span>
</span></span><span class=line><span class=cl>          <span class=s>&#34;JAVA has pretty good regular expressions\n&#34;</span> <span class=o>+</span>
</span></span><span class=line><span class=cl>          <span class=s>&#34;Regular expressions are in Java&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=k>while</span><span class=o>(</span><span class=n>m</span><span class=o>.</span><span class=na>find</span><span class=o>())</span>
</span></span><span class=line><span class=cl>            <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>m</span><span class=o>.</span><span class=na>group</span><span class=o>());</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=cm>/* Output:
</span></span></span><span class=line><span class=cl><span class=cm>java
</span></span></span><span class=line><span class=cl><span class=cm>Java
</span></span></span><span class=line><span class=cl><span class=cm>JAVA
</span></span></span><span class=line><span class=cl><span class=cm>*/</span>
</span></span></code></pre></div><p>在这个例子中，我们创建了一个模式，它将匹配所有以“java”、“Java”和“JAVA”等开头的行，并且是在设置了多行标记的状态下，对每一行（从字符序列的第一个字符开始，至每一个行终止符）都进行匹配。注意，<code>group()</code> 方法只返回已匹配的部分。</p><h3 id=split><code>split()</code></h3><p><code>split()</code>方法将输入 <code>String</code> 断开成 <code>String</code> 对象数组，断开边界由正则表达式确定：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>String</span><span class=o>[]</span> <span class=nf>split</span><span class=o>(</span><span class=n>CharSequence</span> <span class=n>input</span><span class=o>)</span>
</span></span><span class=line><span class=cl><span class=n>String</span><span class=o>[]</span> <span class=nf>split</span><span class=o>(</span><span class=n>CharSequence</span> <span class=n>input</span><span class=o>,</span> <span class=kt>int</span> <span class=n>limit</span><span class=o>)</span>
</span></span></code></pre></div><p>这是一个快速而方便的方法，可以按照通用边界断开输入文本：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// strings/SplitDemo.java
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>import</span> <span class=nn>java.util.regex.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>java.util.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>SplitDemo</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>String</span> <span class=n>input</span> <span class=o>=</span>
</span></span><span class=line><span class=cl>          <span class=s>&#34;This!!unusual use!!of exclamation!!points&#34;</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>Arrays</span><span class=o>.</span><span class=na>toString</span><span class=o>(</span>
</span></span><span class=line><span class=cl>        <span class=n>Pattern</span><span class=o>.</span><span class=na>compile</span><span class=o>(</span><span class=s>&#34;!!&#34;</span><span class=o>).</span><span class=na>split</span><span class=o>(</span><span class=n>input</span><span class=o>)));</span>
</span></span><span class=line><span class=cl>        <span class=c1>// Only do the first three:
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>Arrays</span><span class=o>.</span><span class=na>toString</span><span class=o>(</span>
</span></span><span class=line><span class=cl>        <span class=n>Pattern</span><span class=o>.</span><span class=na>compile</span><span class=o>(</span><span class=s>&#34;!!&#34;</span><span class=o>).</span><span class=na>split</span><span class=o>(</span><span class=n>input</span><span class=o>,</span> <span class=mi>3</span><span class=o>)));</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=cm>/* Output:
</span></span></span><span class=line><span class=cl><span class=cm>[This, unusual use, of exclamation, points]
</span></span></span><span class=line><span class=cl><span class=cm>[This, unusual use, of exclamation!!points]
</span></span></span><span class=line><span class=cl><span class=cm>*/</span>
</span></span></code></pre></div><p>第二种形式的 <code>split()</code> 方法可以限制将输入分割成字符串的数量。</p><h3 id=替换操作>替换操作</h3><p>正则表达式在进行文本替换时特别方便，它提供了许多方法：</p><ul><li><code>replaceFirst(String replacement)</code> 以参数字符串 <code>replacement</code> 替换掉第一个匹配成功的部分。</li><li><code>replaceAll(String replacement)</code> 以参数字符串 <code>replacement</code> 替换所有匹配成功的部分。</li><li><code>appendReplacement(StringBuffer sbuf, String replacement)</code> 执行渐进式的替换，而不是像 <code>replaceFirst()</code> 和 <code>replaceAll()</code> 那样只替换第一个匹配或全部匹配。这是一个非常重要的方法。它允许你调用其他方法来生成或处理 <code>replacement</code>（<code>replaceFirst()</code> 和 <code>replaceAll()</code> 则只能使用一个固定的字符串），使你能够以编程的方式将目标分割成组，从而具备更强大的替换功能。</li><li><code>appendTail(StringBuffer sbuf)</code> 在执行了一次或多次 <code>appendReplacement()</code> 之后，调用此方法可以将输入字符串余下的部分复制到 <code>sbuf</code> 中。</li></ul><p>下面的程序演示了如何使用这些替换方法。开头部分注释掉的文本，就是正则表达式要处理的输入字符串：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// strings/TheReplacements.java
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>import</span> <span class=nn>java.util.regex.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>java.nio.file.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>java.util.stream.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=cm>/*! Here&#39;s a block of text to use as input to
</span></span></span><span class=line><span class=cl><span class=cm>    the regular expression matcher. Note that we
</span></span></span><span class=line><span class=cl><span class=cm>    first extract the block of text by looking for
</span></span></span><span class=line><span class=cl><span class=cm>    the special delimiters, then process the
</span></span></span><span class=line><span class=cl><span class=cm>    extracted block. !*/</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>TheReplacements</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=kd>throws</span> <span class=n>Exception</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>String</span> <span class=n>s</span> <span class=o>=</span> <span class=n>Files</span><span class=o>.</span><span class=na>lines</span><span class=o>(</span>
</span></span><span class=line><span class=cl>          <span class=n>Paths</span><span class=o>.</span><span class=na>get</span><span class=o>(</span><span class=s>&#34;TheReplacements.java&#34;</span><span class=o>))</span>
</span></span><span class=line><span class=cl>          <span class=o>.</span><span class=na>collect</span><span class=o>(</span><span class=n>Collectors</span><span class=o>.</span><span class=na>joining</span><span class=o>(</span><span class=s>&#34;\n&#34;</span><span class=o>));</span>
</span></span><span class=line><span class=cl>        <span class=c1>// Match specially commented block of text above:
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>Matcher</span> <span class=n>mInput</span> <span class=o>=</span> <span class=n>Pattern</span><span class=o>.</span><span class=na>compile</span><span class=o>(</span>
</span></span><span class=line><span class=cl>          <span class=s>&#34;/\\*!(.*)!\\*/&#34;</span><span class=o>,</span> <span class=n>Pattern</span><span class=o>.</span><span class=na>DOTALL</span><span class=o>).</span><span class=na>matcher</span><span class=o>(</span><span class=n>s</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span><span class=o>(</span><span class=n>mInput</span><span class=o>.</span><span class=na>find</span><span class=o>())</span>
</span></span><span class=line><span class=cl>            <span class=n>s</span> <span class=o>=</span> <span class=n>mInput</span><span class=o>.</span><span class=na>group</span><span class=o>(</span><span class=mi>1</span><span class=o>);</span> <span class=c1>// Captured by parentheses
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=c1>// Replace two or more spaces with a single space:
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>s</span> <span class=o>=</span> <span class=n>s</span><span class=o>.</span><span class=na>replaceAll</span><span class=o>(</span><span class=s>&#34; {2,}&#34;</span><span class=o>,</span> <span class=s>&#34; &#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=c1>// Replace 1+ spaces at the beginning of each
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=c1>// line with no spaces. Must enable MULTILINE mode:
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>s</span> <span class=o>=</span> <span class=n>s</span><span class=o>.</span><span class=na>replaceAll</span><span class=o>(</span><span class=s>&#34;(?m)^ +&#34;</span><span class=o>,</span> <span class=s>&#34;&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>s</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>s</span> <span class=o>=</span> <span class=n>s</span><span class=o>.</span><span class=na>replaceFirst</span><span class=o>(</span><span class=s>&#34;[aeiou]&#34;</span><span class=o>,</span> <span class=s>&#34;(VOWEL1)&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>StringBuffer</span> <span class=n>sbuf</span> <span class=o>=</span> <span class=k>new</span> <span class=n>StringBuffer</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=n>Pattern</span> <span class=n>p</span> <span class=o>=</span> <span class=n>Pattern</span><span class=o>.</span><span class=na>compile</span><span class=o>(</span><span class=s>&#34;[aeiou]&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>Matcher</span> <span class=n>m</span> <span class=o>=</span> <span class=n>p</span><span class=o>.</span><span class=na>matcher</span><span class=o>(</span><span class=n>s</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=c1>// Process the find information as you
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=c1>// perform the replacements:
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>while</span><span class=o>(</span><span class=n>m</span><span class=o>.</span><span class=na>find</span><span class=o>())</span>
</span></span><span class=line><span class=cl>            <span class=n>m</span><span class=o>.</span><span class=na>appendReplacement</span><span class=o>(</span><span class=n>sbuf</span><span class=o>,</span> <span class=n>m</span><span class=o>.</span><span class=na>group</span><span class=o>().</span><span class=na>toUpperCase</span><span class=o>());</span>
</span></span><span class=line><span class=cl>        <span class=c1>// Put in the remainder of the text:
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>m</span><span class=o>.</span><span class=na>appendTail</span><span class=o>(</span><span class=n>sbuf</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>sbuf</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=cm>/* Output:
</span></span></span><span class=line><span class=cl><span class=cm>Here&#39;s a block of text to use as input to
</span></span></span><span class=line><span class=cl><span class=cm>the regular expression matcher. Note that we
</span></span></span><span class=line><span class=cl><span class=cm>first extract the block of text by looking for
</span></span></span><span class=line><span class=cl><span class=cm>the special delimiters, then process the
</span></span></span><span class=line><span class=cl><span class=cm>extracted block.
</span></span></span><span class=line><span class=cl><span class=cm>H(VOWEL1)rE&#39;s A blOck Of tExt tO UsE As InpUt tO
</span></span></span><span class=line><span class=cl><span class=cm>thE rEgUlAr ExprEssIOn mAtchEr. NOtE thAt wE
</span></span></span><span class=line><span class=cl><span class=cm>fIrst ExtrAct thE blOck Of tExt by lOOkIng fOr
</span></span></span><span class=line><span class=cl><span class=cm>thE spEcIAl dElImItErs, thEn prOcEss thE
</span></span></span><span class=line><span class=cl><span class=cm>ExtrActEd blOck.
</span></span></span><span class=line><span class=cl><span class=cm>*/</span>
</span></span></code></pre></div><p>此处使用上一章介绍过的 <a href=./17-Files.md><code>Files</code></a> 类打开并读入文件。<code>Files.lines()</code> 返回一个 <code>Stream</code> 对象，包含读入的所有行，<code>Collectors.joining()</code> 在每一行的结尾追加参数字符序列，最终拼接成一个 <code>String</code> 对象。</p><p><code>mInput</code> 匹配 <code>/*!</code> 和 <code>！*/</code> 之间的所有文字（注意分组的括号）。接下来，将存在两个或两个以上空格的地方，缩减为一个空格，并且删除每行开头部分的所有空格（为了使每一行都达到这个效果，而不仅仅是删除文本开头部分的空格，这里特意开启了多行模式）。这两个替换操作所使用的的 <code>replaceAll()</code> 是 <code>String</code> 对象自带的方法，在这里，使用此方法更方便。注意，因为这两个替换操作都只使用了一次 <code>replaceAll()</code>，所以，与其编译为 <code>Pattern</code>，不如直接使用 <code>String</code> 的 <code>replaceAll()</code> 方法，而且开销也更小些。</p><p><code>replaceFirst()</code> 只对找到的第一个匹配进行替换。此外，<code>replaceFirst()</code> 和 <code>replaceAll()</code> 方法用来替换的只是普通字符串，所以，如果想对这些替换字符串进行某些特殊处理，这两个方法时无法胜任的。如果你想要那么做，就应该使用 <code>appendReplacement()</code> 方法。该方法允许你在执行替换的过程中，操作用来替换的字符串。在这个例子中，先构造了 <code>sbuf</code> 用来保存最终结果，然后用 <code>group()</code> 选择一个组，并对其进行处理，将正则表达式找到的元音字母替换成大些字母。一般情况下，你应该遍历执行所有的替换操作，然后再调用 <code>appendTail()</code> 方法，但是，如果你想模拟 <code>replaceFirst()</code>（或替换 n 次）的行为，那就只需要执行一次替换，然后调用 <code>appendTail()</code> 方法，将剩余未处理的部分存入 <code>sbuf</code> 即可。</p><p>同时，<code>appendReplacement()</code> 方法还允许你通过 <code>\$g</code> 直接找到匹配的某个组，这里的 <code>g</code> 就是组号。然而，它只能应付一些简单的处理，无法实现类似前面这个例子中的功能。</p><h3 id=reset><code>reset()</code></h3><p>通过 <code>reset()</code> 方法，可以将现有的 <code>Matcher</code> 对象应用于一个新的字符序列：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// strings/Resetting.java
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>import</span> <span class=nn>java.util.regex.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>Resetting</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=kd>throws</span> <span class=n>Exception</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>Matcher</span> <span class=n>m</span> <span class=o>=</span> <span class=n>Pattern</span><span class=o>.</span><span class=na>compile</span><span class=o>(</span><span class=s>&#34;[frb][aiu][gx]&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl>          <span class=o>.</span><span class=na>matcher</span><span class=o>(</span><span class=s>&#34;fix the rug with bags&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=k>while</span><span class=o>(</span><span class=n>m</span><span class=o>.</span><span class=na>find</span><span class=o>())</span>
</span></span><span class=line><span class=cl>            <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>print</span><span class=o>(</span><span class=n>m</span><span class=o>.</span><span class=na>group</span><span class=o>()</span> <span class=o>+</span> <span class=s>&#34; &#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=n>m</span><span class=o>.</span><span class=na>reset</span><span class=o>(</span><span class=s>&#34;fix the rig with rags&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=k>while</span><span class=o>(</span><span class=n>m</span><span class=o>.</span><span class=na>find</span><span class=o>())</span>
</span></span><span class=line><span class=cl>            <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>print</span><span class=o>(</span><span class=n>m</span><span class=o>.</span><span class=na>group</span><span class=o>()</span> <span class=o>+</span> <span class=s>&#34; &#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=cm>/* Output:
</span></span></span><span class=line><span class=cl><span class=cm>fix rug bag
</span></span></span><span class=line><span class=cl><span class=cm>fix rig rag
</span></span></span><span class=line><span class=cl><span class=cm>*/</span>
</span></span></code></pre></div><p>使用不带参数的 <code>reset()</code> 方法，可以将 <code>Matcher</code> 对象重新设置到当前字符序列的起始位置。</p><h3 id=正则表达式与-java-io>正则表达式与 Java I/O</h3><p>到目前为止，我们看到的例子都是将正则表达式用于静态的字符串。下面的例子将向你演示，如何应用正则表达式在一个文件中进行搜索匹配操作。<code>JGrep.java</code> 的灵感源自于 Unix 上的 <em>grep</em>。它有两个参数：文件名以及要匹配的正则表达式。输出的是每行有匹配的部分以及匹配部分在行中的位置。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// strings/JGrep.java
</span></span></span><span class=line><span class=cl><span class=c1>// A very simple version of the &#34;grep&#34; program
</span></span></span><span class=line><span class=cl><span class=c1>// {java JGrep
</span></span></span><span class=line><span class=cl><span class=c1>// WhitherStringBuilder.java &#39;return|for|String&#39;}
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>import</span> <span class=nn>java.util.regex.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>java.nio.file.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>java.util.stream.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>JGrep</span> <span class=o>{</span> <span class=err> </span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=kd>throws</span> <span class=n>Exception</span> <span class=o>{</span> <span class=err> </span> <span class=err> </span>
</span></span><span class=line><span class=cl>        <span class=k>if</span><span class=o>(</span><span class=n>args</span><span class=o>.</span><span class=na>length</span> <span class=o>&lt;</span> <span class=mi>2</span><span class=o>)</span> <span class=o>{</span> <span class=err> </span> <span class=err> </span> <span class=err> </span>
</span></span><span class=line><span class=cl>            <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span>
</span></span><span class=line><span class=cl>              <span class=s>&#34;Usage: java JGrep file regex&#34;</span><span class=o>);</span> <span class=err> </span> <span class=err> </span> <span class=err> </span>
</span></span><span class=line><span class=cl>            <span class=n>System</span><span class=o>.</span><span class=na>exit</span><span class=o>(</span><span class=mi>0</span><span class=o>);</span> <span class=err> </span>
</span></span><span class=line><span class=cl>        <span class=o>}</span> <span class=err> </span> <span class=err> </span>
</span></span><span class=line><span class=cl>        <span class=n>Pattern</span> <span class=n>p</span> <span class=o>=</span> <span class=n>Pattern</span><span class=o>.</span><span class=na>compile</span><span class=o>(</span><span class=n>args</span><span class=o>[</span><span class=mi>1</span><span class=o>]);</span> <span class=err> </span> <span class=err> </span>
</span></span><span class=line><span class=cl>        <span class=c1>// Iterate through the lines of the input file:    
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=kt>int</span> <span class=n>index</span> <span class=o>=</span> <span class=mi>0</span><span class=o>;</span> <span class=err> </span> <span class=err> </span>
</span></span><span class=line><span class=cl>        <span class=n>Matcher</span> <span class=n>m</span> <span class=o>=</span> <span class=n>p</span><span class=o>.</span><span class=na>matcher</span><span class=o>(</span><span class=s>&#34;&#34;</span><span class=o>);</span> <span class=err> </span> <span class=err> </span>
</span></span><span class=line><span class=cl>        <span class=k>for</span><span class=o>(</span><span class=n>String</span> <span class=n>line</span><span class=o>:</span> <span class=n>Files</span><span class=o>.</span><span class=na>readAllLines</span><span class=o>(</span><span class=n>Paths</span><span class=o>.</span><span class=na>get</span><span class=o>(</span><span class=n>args</span><span class=o>[</span><span class=mi>0</span><span class=o>])))</span> <span class=o>{</span> <span class=err> </span> <span class=err> </span> <span class=err> </span>
</span></span><span class=line><span class=cl>            <span class=n>m</span><span class=o>.</span><span class=na>reset</span><span class=o>(</span><span class=n>line</span><span class=o>);</span> <span class=err> </span> <span class=err> </span> <span class=err> </span>
</span></span><span class=line><span class=cl>            <span class=k>while</span><span class=o>(</span><span class=n>m</span><span class=o>.</span><span class=na>find</span><span class=o>())</span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span>
</span></span><span class=line><span class=cl>                <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>index</span><span class=o>++</span> <span class=o>+</span> <span class=s>&#34;: &#34;</span> <span class=o>+</span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span>
</span></span><span class=line><span class=cl>                  <span class=n>m</span><span class=o>.</span><span class=na>group</span><span class=o>()</span> <span class=o>+</span> <span class=s>&#34;: &#34;</span> <span class=o>+</span> <span class=n>m</span><span class=o>.</span><span class=na>start</span><span class=o>());</span> <span class=err> </span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=cm>/* Output:
</span></span></span><span class=line><span class=cl><span class=cm>0: for: 4
</span></span></span><span class=line><span class=cl><span class=cm>1: for: 4
</span></span></span><span class=line><span class=cl><span class=cm>*/</span>
</span></span></code></pre></div><p><code>Files.readAllLines()</code> 返回一个 <code>List&lt;String></code> 对象，这意味着可以用 <em>for-in</em> 进行遍历。虽然可以在 <code>for</code> 循环内部创建一个新的 <code>Matcher</code> 对象，但是，在循环体外创建一个空的 <code>Matcher</code> 对象，然后用 <code>reset()</code> 方法每次为 <code>Matcher</code> 加载一行输入，这种处理会有一定的性能优化。最后用 <code>find()</code> 搜索结果。</p><p>这里读入的测试参数是 <code>JGrep.java</code> 文件，然后搜索以 <code>[Ssct]</code> 开头的单词。</p><p>如果想要更深入地学习正则表达式，你可以阅读 Jeffrey E. F. Friedl 的《精通正则表达式（第 2 版）》。网络上也有很多正则表达式的介绍，你还可以从 Perl 和 Python 等其他语言的文档中找到有用的信息。</p><h2 id=扫描输入>扫描输入</h2><p>到目前为止，从文件或标准输入读取数据还是一件相当痛苦的事情。一般的解决办法就是读入一行文本，对其进行分词，然后使用 <code>Integer</code>、<code>Double</code> 等类的各种解析方法来解析数据：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// strings/SimpleRead.java
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>import</span> <span class=nn>java.io.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>SimpleRead</span> <span class=o>{</span> <span class=err> </span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=n>BufferedReader</span> <span class=n>input</span> <span class=o>=</span> <span class=err> </span> <span class=err> </span>
</span></span><span class=line><span class=cl>      <span class=k>new</span> <span class=n>BufferedReader</span><span class=o>(</span><span class=k>new</span> <span class=n>StringReader</span><span class=o>(</span> <span class=err> </span> <span class=err> </span>
</span></span><span class=line><span class=cl>        <span class=s>&#34;Sir Robin of Camelot\n22 1.61803&#34;</span><span class=o>));</span> <span class=err> </span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span> <span class=err> </span> <span class=err> </span>
</span></span><span class=line><span class=cl>        <span class=k>try</span> <span class=o>{</span> <span class=err> </span> <span class=err> </span> <span class=err> </span>
</span></span><span class=line><span class=cl>            <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;What is your name?&#34;</span><span class=o>);</span> <span class=err> </span> <span class=err> </span> <span class=err> </span>
</span></span><span class=line><span class=cl>            <span class=n>String</span> <span class=n>name</span> <span class=o>=</span> <span class=n>input</span><span class=o>.</span><span class=na>readLine</span><span class=o>();</span> <span class=err> </span> <span class=err> </span> <span class=err> </span>
</span></span><span class=line><span class=cl>            <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>name</span><span class=o>);</span> <span class=err> </span> <span class=err> </span> <span class=err> </span>
</span></span><span class=line><span class=cl>            <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;How old are you? &#34;</span> <span class=o>+</span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span>
</span></span><span class=line><span class=cl>              <span class=s>&#34;What is your favorite double?&#34;</span><span class=o>);</span> <span class=err> </span> <span class=err> </span> <span class=err> </span>
</span></span><span class=line><span class=cl>            <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;(input: &lt;age&gt; &lt;double&gt;)&#34;</span><span class=o>);</span> <span class=err> </span> <span class=err> </span> <span class=err> </span>
</span></span><span class=line><span class=cl>            <span class=n>String</span> <span class=n>numbers</span> <span class=o>=</span> <span class=n>input</span><span class=o>.</span><span class=na>readLine</span><span class=o>();</span> <span class=err> </span> <span class=err> </span> <span class=err> </span>
</span></span><span class=line><span class=cl>            <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>numbers</span><span class=o>);</span> <span class=err> </span> <span class=err> </span> <span class=err> </span>
</span></span><span class=line><span class=cl>            <span class=n>String</span><span class=o>[]</span> <span class=n>numArray</span> <span class=o>=</span> <span class=n>numbers</span><span class=o>.</span><span class=na>split</span><span class=o>(</span><span class=s>&#34; &#34;</span><span class=o>);</span> <span class=err> </span> <span class=err> </span> <span class=err> </span>
</span></span><span class=line><span class=cl>            <span class=kt>int</span> <span class=n>age</span> <span class=o>=</span> <span class=n>Integer</span><span class=o>.</span><span class=na>parseInt</span><span class=o>(</span><span class=n>numArray</span><span class=o>[</span><span class=mi>0</span><span class=o>]);</span> <span class=err> </span> <span class=err> </span> <span class=err> </span>
</span></span><span class=line><span class=cl>            <span class=kt>double</span> <span class=n>favorite</span> <span class=o>=</span> <span class=n>Double</span><span class=o>.</span><span class=na>parseDouble</span><span class=o>(</span><span class=n>numArray</span><span class=o>[</span><span class=mi>1</span><span class=o>]);</span> <span class=err> </span> <span class=err> </span> <span class=err> </span>
</span></span><span class=line><span class=cl>            <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>format</span><span class=o>(</span><span class=s>&#34;Hi %s.%n&#34;</span><span class=o>,</span> <span class=n>name</span><span class=o>);</span> <span class=err> </span> <span class=err> </span> <span class=err> </span>
</span></span><span class=line><span class=cl>            <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>format</span><span class=o>(</span><span class=s>&#34;In 5 years you will be %d.%n&#34;</span><span class=o>,</span> <span class=n>age</span> <span class=o>+</span> <span class=mi>5</span><span class=o>);</span> <span class=err> </span> <span class=err> </span> <span class=err> </span>
</span></span><span class=line><span class=cl>            <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>format</span><span class=o>(</span><span class=s>&#34;My favorite double is %f.&#34;</span><span class=o>,</span> <span class=n>favorite</span> <span class=o>/</span> <span class=mi>2</span><span class=o>);</span> <span class=err> </span>
</span></span><span class=line><span class=cl>        <span class=o>}</span> <span class=k>catch</span><span class=o>(</span><span class=n>IOException</span> <span class=n>e</span><span class=o>)</span> <span class=o>{</span> <span class=err> </span> <span class=err> </span> <span class=err> </span>
</span></span><span class=line><span class=cl>            <span class=n>System</span><span class=o>.</span><span class=na>err</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;I/O exception&#34;</span><span class=o>);</span> <span class=err> </span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=cm>/* Output:
</span></span></span><span class=line><span class=cl><span class=cm>What is your name?
</span></span></span><span class=line><span class=cl><span class=cm>Sir Robin of Camelot
</span></span></span><span class=line><span class=cl><span class=cm>How old are you? What is your favorite double?
</span></span></span><span class=line><span class=cl><span class=cm>(input: &lt;age&gt; &lt;double&gt;)
</span></span></span><span class=line><span class=cl><span class=cm>22 1.61803
</span></span></span><span class=line><span class=cl><span class=cm>Hi Sir Robin of Camelot.
</span></span></span><span class=line><span class=cl><span class=cm>In 5 years you will be 27.
</span></span></span><span class=line><span class=cl><span class=cm>My favorite double is 0.809015.
</span></span></span><span class=line><span class=cl><span class=cm>*/</span>
</span></span></code></pre></div><p><code>input</code> 字段使用的类来自 <code>java.io</code>，<a href=./Appendix-IO-Streams.md>附录:流式 I/O</a> 详细介绍了相关内容。<code>StringReader</code> 将 <code>String</code> 转化为可读的流对象，然后用这个对象来构造 <code>BufferedReader</code> 对象，因为我们要使用 <code>BufferedReader</code> 的 <code>readLine()</code> 方法。最终，我们可以使用 <code>input</code> 对象一次读取一行文本，就像从控制台读入标准输入一样。</p><p><code>readLine()</code> 方法将一行输入转为 <code>String</code> 对象。如果每一行数据正好对应一个输入值，那这个方法也还可行。但是，如果两个输入值在同一行中，事情就不好办了，我们必须分解这个行，才能分别解析所需的输入值。在这个例子中，分解的操作发生在创建 <code>numArray</code>时。</p><p>终于，Java SE5 新增了 <code>Scanner</code> 类，它可以大大减轻扫描输入的工作负担：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// strings/BetterRead.java
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>import</span> <span class=nn>java.util.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>BetterRead</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>  <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>Scanner</span> <span class=n>stdin</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Scanner</span><span class=o>(</span><span class=n>SimpleRead</span><span class=o>.</span><span class=na>input</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;What is your name?&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>String</span> <span class=n>name</span> <span class=o>=</span> <span class=n>stdin</span><span class=o>.</span><span class=na>nextLine</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>name</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span>
</span></span><span class=line><span class=cl>      <span class=s>&#34;How old are you? What is your favorite double?&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;(input: &lt;age&gt; &lt;double&gt;)&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>age</span> <span class=o>=</span> <span class=n>stdin</span><span class=o>.</span><span class=na>nextInt</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=kt>double</span> <span class=n>favorite</span> <span class=o>=</span> <span class=n>stdin</span><span class=o>.</span><span class=na>nextDouble</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>age</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>favorite</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>format</span><span class=o>(</span><span class=s>&#34;Hi %s.%n&#34;</span><span class=o>,</span> <span class=n>name</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>format</span><span class=o>(</span><span class=s>&#34;In 5 years you will be %d.%n&#34;</span><span class=o>,</span>
</span></span><span class=line><span class=cl>      <span class=n>age</span> <span class=o>+</span> <span class=mi>5</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>format</span><span class=o>(</span><span class=s>&#34;My favorite double is %f.&#34;</span><span class=o>,</span>
</span></span><span class=line><span class=cl>      <span class=n>favorite</span> <span class=o>/</span> <span class=mi>2</span><span class=o>);</span>
</span></span><span class=line><span class=cl>  <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=cm>/* Output:
</span></span></span><span class=line><span class=cl><span class=cm>What is your name?
</span></span></span><span class=line><span class=cl><span class=cm>Sir Robin of Camelot
</span></span></span><span class=line><span class=cl><span class=cm>How old are you? What is your favorite double?
</span></span></span><span class=line><span class=cl><span class=cm>(input: &lt;age&gt; &lt;double&gt;)
</span></span></span><span class=line><span class=cl><span class=cm>22
</span></span></span><span class=line><span class=cl><span class=cm>1.61803
</span></span></span><span class=line><span class=cl><span class=cm>Hi Sir Robin of Camelot.
</span></span></span><span class=line><span class=cl><span class=cm>In 5 years you will be 27.
</span></span></span><span class=line><span class=cl><span class=cm>My favorite double is 0.809015.
</span></span></span><span class=line><span class=cl><span class=cm>*/</span>
</span></span></code></pre></div><p><code>Scanner</code> 的构造器可以接收任意类型的输入对象，包括 <code>File</code>、<code>InputStream</code>、<code>String</code> 或者像此例中的<code>Readable</code> 实现类。<code>Readable</code> 是 Java SE5 中新加入的一个接口，表示“具有 <code>read()</code> 方法的某种东西”。上一个例子中的 <code>BufferedReader</code> 也归于这一类。</p><p>有了 <code>Scanner</code>，所有的输入、分词、以及解析的操作都隐藏在不同类型的 <code>next</code> 方法中。普通的 <code>next()</code> 方法返回下一个 <code>String</code>。所有的基本类型（除 <code>char</code> 之外）都有对应的 <code>next</code> 方法，包括 <code>BigDecimal</code> 和 <code>BigInteger</code>。所有的 next 方法，只有在找到一个完整的分词之后才会返回。<code>Scanner</code> 还有相应的 <code>hasNext</code> 方法，用以判断下一个输入分词是否是所需的类型，如果是则返回 <code>true</code>。</p><p>在 <code>BetterRead.java</code> 中没有用 <code>try</code> 区块捕获<code>IOException</code>。因为，<code>Scanner</code> 有一个假设，在输入结束时会抛出 <code>IOException</code>，所以 <code>Scanner</code> 会把 <code>IOException</code> 吞掉。不过，通过 <code>ioException()</code> 方法，你可以找到最近发生的异常，因此，你可以在必要时检查它。</p><h3 id=scanner-分隔符><code>Scanner</code> 分隔符</h3><p>默认情况下，<code>Scanner</code> 根据空白字符对输入进行分词，但是你可以用正则表达式指定自己所需的分隔符：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// strings/ScannerDelimiter.java
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>import</span> <span class=nn>java.util.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>ScannerDelimiter</span> <span class=o>{</span> <span class=err> </span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span> <span class=err> </span> <span class=err> </span>
</span></span><span class=line><span class=cl>        <span class=n>Scanner</span> <span class=n>scanner</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Scanner</span><span class=o>(</span><span class=s>&#34;12, 42, 78, 99, 42&#34;</span><span class=o>);</span> <span class=err> </span> <span class=err> </span>
</span></span><span class=line><span class=cl>        <span class=n>scanner</span><span class=o>.</span><span class=na>useDelimiter</span><span class=o>(</span><span class=s>&#34;\\s*,\\s*&#34;</span><span class=o>);</span> <span class=err> </span> <span class=err> </span>
</span></span><span class=line><span class=cl>        <span class=k>while</span><span class=o>(</span><span class=n>scanner</span><span class=o>.</span><span class=na>hasNextInt</span><span class=o>())</span> <span class=err> </span> <span class=err> </span>
</span></span><span class=line><span class=cl>            <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>scanner</span><span class=o>.</span><span class=na>nextInt</span><span class=o>());</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=cm>/* Output:
</span></span></span><span class=line><span class=cl><span class=cm>12
</span></span></span><span class=line><span class=cl><span class=cm>42
</span></span></span><span class=line><span class=cl><span class=cm>78
</span></span></span><span class=line><span class=cl><span class=cm>99
</span></span></span><span class=line><span class=cl><span class=cm>42
</span></span></span><span class=line><span class=cl><span class=cm>*/</span>
</span></span></code></pre></div><p>这个例子使用逗号（包括逗号前后任意的空白字符）作为分隔符，同样的技术也可以用来读取逗号分隔的文件。我们可以用 <code>useDelimiter()</code> 来设置分隔符，同时，还有一个 <code>delimiter()</code> 方法，用来返回当前正在作为分隔符使用的 <code>Pattern</code> 对象。</p><h3 id=用正则表达式扫描>用正则表达式扫描</h3><p>除了能够扫描基本类型之外，你还可以使用自定义的正则表达式进行扫描，这在扫描复杂数据时非常有用。下面的例子将扫描一个防火墙日志文件中的威胁数据：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// strings/ThreatAnalyzer.java
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>import</span> <span class=nn>java.util.regex.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>java.util.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>ThreatAnalyzer</span> <span class=o>{</span><span class=err> </span>
</span></span><span class=line><span class=cl>    <span class=kd>static</span> <span class=n>String</span> <span class=n>threatData</span> <span class=o>=</span> <span class=err> </span> <span class=err> </span>
</span></span><span class=line><span class=cl>      <span class=s>&#34;58.27.82.161@08/10/2015\n&#34;</span> <span class=o>+</span><span class=err> </span> <span class=err> </span>
</span></span><span class=line><span class=cl>      <span class=s>&#34;204.45.234.40@08/11/2015\n&#34;</span> <span class=o>+</span> <span class=err> </span> <span class=err> </span>
</span></span><span class=line><span class=cl>      <span class=s>&#34;58.27.82.161@08/11/2015\n&#34;</span> <span class=o>+</span> <span class=err> </span> <span class=err> </span>
</span></span><span class=line><span class=cl>      <span class=s>&#34;58.27.82.161@08/12/2015\n&#34;</span> <span class=o>+</span> <span class=err> </span> <span class=err> </span>
</span></span><span class=line><span class=cl>      <span class=s>&#34;58.27.82.161@08/12/2015\n&#34;</span> <span class=o>+</span>
</span></span><span class=line><span class=cl> <span class=err> </span> <span class=err> </span>  <span class=s>&#34;[Next log section with different data format]&#34;</span><span class=o>;</span> <span class=err> </span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span><span class=err> </span>
</span></span><span class=line><span class=cl>        <span class=n>Scanner</span> <span class=n>scanner</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Scanner</span><span class=o>(</span><span class=n>threatData</span><span class=o>);</span> <span class=err> </span> <span class=err> </span>
</span></span><span class=line><span class=cl>        <span class=n>String</span> <span class=n>pattern</span> <span class=o>=</span> <span class=s>&#34;(\\d+[.]\\d+[.]\\d+[.]\\d+)@&#34;</span> <span class=o>+</span> <span class=err> </span> <span class=err> </span> <span class=err> </span>
</span></span><span class=line><span class=cl>            <span class=s>&#34;(\\d{2}/\\d{2}/\\d{4})&#34;</span><span class=o>;</span> <span class=err> </span> <span class=err> </span>
</span></span><span class=line><span class=cl>        <span class=k>while</span><span class=o>(</span><span class=n>scanner</span><span class=o>.</span><span class=na>hasNext</span><span class=o>(</span><span class=n>pattern</span><span class=o>))</span> <span class=o>{</span> <span class=err> </span> <span class=err> </span> <span class=err> </span>
</span></span><span class=line><span class=cl>            <span class=n>scanner</span><span class=o>.</span><span class=na>next</span><span class=o>(</span><span class=n>pattern</span><span class=o>);</span> <span class=err> </span> <span class=err> </span> <span class=err> </span>
</span></span><span class=line><span class=cl>            <span class=n>MatchResult</span> <span class=n>match</span> <span class=o>=</span> <span class=n>scanner</span><span class=o>.</span><span class=na>match</span><span class=o>();</span> <span class=err> </span> <span class=err> </span> <span class=err> </span>
</span></span><span class=line><span class=cl>            <span class=n>String</span> <span class=n>ip</span> <span class=o>=</span> <span class=n>match</span><span class=o>.</span><span class=na>group</span><span class=o>(</span><span class=mi>1</span><span class=o>);</span> <span class=err> </span> <span class=err> </span> <span class=err> </span>
</span></span><span class=line><span class=cl>            <span class=n>String</span> <span class=n>date</span> <span class=o>=</span> <span class=n>match</span><span class=o>.</span><span class=na>group</span><span class=o>(</span><span class=mi>2</span><span class=o>);</span> <span class=err> </span> <span class=err> </span> <span class=err> </span>
</span></span><span class=line><span class=cl>            <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>format</span><span class=o>(</span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span>
</span></span><span class=line><span class=cl>                <span class=s>&#34;Threat on %s from %s%n&#34;</span><span class=o>,</span> <span class=n>date</span><span class=o>,</span><span class=n>ip</span><span class=o>);</span> <span class=err> </span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=cm>/* Output:
</span></span></span><span class=line><span class=cl><span class=cm>Threat on 08/10/2015 from 58.27.82.161
</span></span></span><span class=line><span class=cl><span class=cm>Threat on 08/11/2015 from 204.45.234.40
</span></span></span><span class=line><span class=cl><span class=cm>Threat on 08/11/2015 from 58.27.82.161
</span></span></span><span class=line><span class=cl><span class=cm>Threat on 08/12/2015 from 58.27.82.161
</span></span></span><span class=line><span class=cl><span class=cm>Threat on 08/12/2015 from 58.27.82.161
</span></span></span><span class=line><span class=cl><span class=cm>*/</span>
</span></span></code></pre></div><p>当 <code>next()</code> 方法配合指定的正则表达式使用时，将找到下一个匹配该模式的输入部分，调用 <code>match()</code> 方法就可以获得匹配的结果。如上所示，它的工作方式与之前看到的正则表达式匹配相似。</p><p>在配合正则表达式使用扫描时，有一点需要注意：它仅仅针对下一个输入分词进行匹配，如果你的正则表达式中含有分隔符，那永远不可能匹配成功。</p><h2 id=stringtokenizer-类>StringTokenizer 类</h2><p>在 Java 引入正则表达式（J2SE1.4）和 <code>Scanner</code> 类（Java SE5）之前，分割字符串的唯一方法是使用 <code>StringTokenizer</code> 来分词。不过，现在有了正则表达式和 <code>Scanner</code>，我们可以使用更加简单、更加简洁的方式来完成同样的工作了。下面的例子中，我们将 <code>StringTokenizer</code> 与另外两种技术简单地做了一个比较：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// strings/ReplacingStringTokenizer.java
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>import</span> <span class=nn>java.util.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>ReplacingStringTokenizer</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>String</span> <span class=n>input</span> <span class=o>=</span>
</span></span><span class=line><span class=cl>          <span class=s>&#34;But I&#39;m not dead yet! I feel happy!&#34;</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=n>StringTokenizer</span> <span class=n>stoke</span> <span class=o>=</span> <span class=k>new</span> <span class=n>StringTokenizer</span><span class=o>(</span><span class=n>input</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=k>while</span><span class=o>(</span><span class=n>stoke</span><span class=o>.</span><span class=na>hasMoreElements</span><span class=o>())</span>
</span></span><span class=line><span class=cl>            <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>print</span><span class=o>(</span><span class=n>stoke</span><span class=o>.</span><span class=na>nextToken</span><span class=o>()</span> <span class=o>+</span> <span class=s>&#34; &#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>Arrays</span><span class=o>.</span><span class=na>toString</span><span class=o>(</span><span class=n>input</span><span class=o>.</span><span class=na>split</span><span class=o>(</span><span class=s>&#34; &#34;</span><span class=o>)));</span>
</span></span><span class=line><span class=cl>        <span class=n>Scanner</span> <span class=n>scanner</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Scanner</span><span class=o>(</span><span class=n>input</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=k>while</span><span class=o>(</span><span class=n>scanner</span><span class=o>.</span><span class=na>hasNext</span><span class=o>())</span>
</span></span><span class=line><span class=cl>            <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>print</span><span class=o>(</span><span class=n>scanner</span><span class=o>.</span><span class=na>next</span><span class=o>()</span> <span class=o>+</span> <span class=s>&#34; &#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=cm>/* Output:
</span></span></span><span class=line><span class=cl><span class=cm>But I&#39;m not dead yet! I feel happy!
</span></span></span><span class=line><span class=cl><span class=cm>[But, I&#39;m, not, dead, yet!, I, feel, happy!]
</span></span></span><span class=line><span class=cl><span class=cm>But I&#39;m not dead yet! I feel happy!
</span></span></span><span class=line><span class=cl><span class=cm>*/</span>
</span></span></code></pre></div><p>使用正则表达式或 <code>Scanner</code> 对象，我们能够以更加复杂的模式来分割一个字符串，而这对于 <code>StringTokenizer</code> 来说就很困难了。基本上，我们可以放心地说，<code>StringTokenizer</code> 已经可以废弃不用了。</p><h2 id=本章小结>本章小结</h2><p>过去，Java 对于字符串操作的技术相当不完善。不过随着近几个版本的升级，我们可以看到，Java 已经从其他语言中吸取了许多成熟的经验。到目前为止，它对字符串操作的支持已经很完善了。不过，有时你还要在细节上注意效率问题，例如恰当地使用 <code>StringBuilder</code> 等。</p><div style=page-break-after:always></div><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p>C++允许编程人员任意重载操作符。这通常是很复杂的过程（参见 Prentice Hall 于 2000 年编写的《Thinking in C++（第 2 版）》第 10 章），因此 Java 设计者认为这是很糟糕的功能，不应该纳入到 Java 中。起始重载操作符并没有糟糕到只能自己去重载的地步，但具有讽刺意味的是，与 C++相比，在 Java 中使用操作符重载要容易得多。这一点可以在 Python(参见<a href=http://www.python.org target=_blank rel=noopener>www.Python.org</a>)和 C#中看到，它们都有垃圾回收机制，操作符重载也简单易懂。&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2><p>Java 并非在一开始就支持正则表达式，因此这个令人费解的语法是硬塞进来的。&#160;<a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:3><p>网上还有很多实用并且成熟的正则表达式工具。&#160;<a href=#fnref:3 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:4><p>input 来自于<a href=https://en.wikipedia.org/wiki/Galaxy_Quest target=_blank rel=noopener>Galaxy Quest</a>中 Taggart 司令的一篇演讲。&#160;<a href=#fnref:4 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:5><p>我不知道他们是如何想出这个方法名的，或者它到底指的什么。这只是代码审查很重要的原因之一。&#160;<a href=#fnref:5 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div></div><div class=article-widget><div class="container-xl row post-nav"><div class="col-6 post-nav-item"><div class=meta-nav>上一页</div><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/17-files/ rel=next>17-Files</a></div><div class="col-6 post-nav-item"><div class=meta-nav>下一页</div><a href=/books/java-series/999.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/19-type-information/ rel=prev>19-Type-Information</a></div></div></div><div class=body-footer><p>最近更新于 0001-01-01</p><section id=comments class="mb-3 pt-0"><div id=disqus_thread></div><script>var disqus_config=function(){};(function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="https://ngte.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)})()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></section></div></article><footer class=site-footer><div class="copyright py-4 bg-footer"><div class="row justify-content-center"><div class="text-center footer-color"><p class=mb-0>© 2017-2022 NGTE all rights reserved</p></div></div></div></footer></main></div></div><script src=//unpkg.com/heti/umd/heti-addon.min.js></script>
<script>const heti=new Heti(".article");heti.autoSpacing()</script><script type=text/javascript>window.$crisp=[],window.CRISP_WEBSITE_ID="12adcc35-9621-4313-8262-62dc654b29d8",function(){setTimeout(function(){d=document,s=d.createElement("script"),s.src="https://client.crisp.chat/l.js",s.async=1,d.getElementsByTagName("head")[0].appendChild(s)},2500)}()</script></div><div class=page-footer></div><script src=/js/vendor-bundle.min.d26509351aa0ff874abbee824e982e9b.js></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.1/highlight.min.js integrity="sha512-Ypjm0o7jOxAd4hpdoppSEN0TQOC19UtPAqD+4s5AlXmUvbmmS/YMxYqAqarQYyxTnB6/rqip9qcxlNB/3U9Wdg==" crossorigin=anonymous></script>
<script id=search-hit-algolia-template type=text/html><div class=search-hit><div class=search-hit-content><div class=search-hit-name><a href={{relpermalink}}>{{#helpers.highlight}}{ "attribute": "title" }{{/helpers.highlight}}</a></div><div class="article-metadata search-hit-type">{{type}}</div><p class=search-hit-description>{{#helpers.highlight}}{ "attribute": "summary" }{{/helpers.highlight}}</p></div></div></script><script src=https://cdn.jsdelivr.net/npm/instantsearch.js@4/dist/instantsearch.production.min.js crossorigin=anonymous></script>
<script id=dsq-count-scr src=https://ngte.disqus.com/count.js async></script>
<script src=/zh/js/algolia-search-built.min.4387d694ca1258194aaf562b8cd1c400.js type=module></script>
<script id=page-data type=application/json>{"use_headroom":false}</script><script src=/zh/js/wowchemy.min.d1673c7a11d1238516cbe12a1e84257f.js></script>
<script>var mybutton=document.getElementById("backTopBtn");window.onscroll=function(){scrollFunction()};function scrollFunction(){document.body.scrollTop>20||document.documentElement.scrollTop>20?mybutton.style.display="block":mybutton.style.display="none"}function topFunction(){document.body.scrollTop=0,document.documentElement.scrollTop=0}</script><script src=https://cdn.jsdelivr.net/gh/bryanbraun/anchorjs@4.2.2/anchor.min.js integrity="sha512-I7w3ZdSFzw5j3jU3ZkNikBNeIrl3i+hEuEdwNmqUJvwNcaBUNcijnP2gd9DtGlgVYDplfjGoD8vTNsID+lCjqg==" crossorigin=anonymous></script>
<script>anchors.add()</script><script>(function(){"use strict";if(!document.queryCommandSupported("copy"))return;function e(e,t){e.className="highlight-copy-btn",e.textContent=t,setTimeout(function(){e.textContent="",e.className="highlight-copy-btn fa fa-copy"},1e3)}function t(e){var t=window.getSelection(),n=document.createRange();return n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n),t}function n(n){var o,s=document.createElement("button");s.className="highlight-copy-btn fa fa-copy",s.textContent="",o=n.firstElementChild,s.addEventListener("click",function(){try{var n=t(o);document.execCommand("copy"),n.removeAllRanges(),e(s,"已复制")}catch(t){console&&console.log(t),e(s,"Failed :'(")}}),n.appendChild(s)}var s=document.getElementsByClassName("highlight");Array.prototype.forEach.call(s,n)})()</script></body></html>