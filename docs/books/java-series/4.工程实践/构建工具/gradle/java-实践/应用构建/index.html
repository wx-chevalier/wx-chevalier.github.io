<!doctype html><html lang=zh><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=generator content="Wowchemy 5.5.0 for Hugo"><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=preload as=style href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap"><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap" media=print onload='this.media="all"'><meta name=google-site-verification content="google69a5cccb61297807"><meta name=baidu-site-verification content="cqmZHEleVh"><meta name=description content="Java & JVM 应用构建 一个 Java 项目的最简单的构建脚本应用了 Java 库插件，并可选择设置项目版本和选择要使用的 Java 工具链。 plugins { id 'java-library' } java { toolchain { languageVersion = JavaLanguageVersion.of(11) } } version = '1.2.1' 通过应用 Java 库插件，你可以得到一大堆的功能。 一个 compileJava 任务，编译src"><link rel=alternate hreflang=zh href=https://ng-tech.icu/books/java-series/4.%E5%B7%A5%E7%A8%8B%E5%AE%9E%E8%B7%B5/%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/gradle/java-%E5%AE%9E%E8%B7%B5/%E5%BA%94%E7%94%A8%E6%9E%84%E5%BB%BA/><meta name=theme-color content="#0a55a7"><link rel=stylesheet href=/css/vendor-bundle.min.c7b8d9abd591ba2253ea42747e3ac3f5.css media=print onload='this.media="all"'><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.1/styles/github.min.css crossorigin=anonymous title=hl-light media=print onload='this.media="all"'><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.1/styles/dracula.min.css crossorigin=anonymous title=hl-dark media=print onload='this.media="all"' disabled><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/instantsearch.css@7.4.5/themes/satellite-min.css integrity="sha256-TehzF/2QvNKhGQrrNpoOb2Ck4iGZ1J/DI4pkd2oUsBc=" crossorigin=anonymous><link rel=stylesheet href=/css/wowchemy.63df6ae9fc2b4cc71b83f1774d780209.css><script async src="https://www.googletagmanager.com/gtag/js?id=G-40NYXJ8823"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-40NYXJ8823")</script><script>var _hmt=_hmt||[];(function(){var e,t=document.createElement("script");t.src="https://hm.baidu.com/hm.js?56df1177bce405601b0ecdd7208f75c6",e=document.getElementsByTagName("script")[0],e.parentNode.insertBefore(t,e)})()</script><link rel=manifest href=/manifest.webmanifest><link rel=icon type=image/png href=/media/icon_hu0f7d075e895d6f5f1f5fdbc1e33dc138_10087_32x32_fill_lanczos_center_3.png><link rel=apple-touch-icon type=image/png href=/media/icon_hu0f7d075e895d6f5f1f5fdbc1e33dc138_10087_180x180_fill_lanczos_center_3.png><link rel=canonical href=https://ng-tech.icu/books/java-series/4.%E5%B7%A5%E7%A8%8B%E5%AE%9E%E8%B7%B5/%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/gradle/java-%E5%AE%9E%E8%B7%B5/%E5%BA%94%E7%94%A8%E6%9E%84%E5%BB%BA/><meta property="twitter:card" content="summary_large_image"><meta property="twitter:site" content="@wx-chevalier"><meta property="twitter:creator" content="@wx-chevalier"><meta property="og:site_name" content="Next-gen Tech Edu"><meta property="og:url" content="https://ng-tech.icu/books/java-series/4.%E5%B7%A5%E7%A8%8B%E5%AE%9E%E8%B7%B5/%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/gradle/java-%E5%AE%9E%E8%B7%B5/%E5%BA%94%E7%94%A8%E6%9E%84%E5%BB%BA/"><meta property="og:title" content="应用构建 | Next-gen Tech Edu"><meta property="og:description" content="Java & JVM 应用构建 一个 Java 项目的最简单的构建脚本应用了 Java 库插件，并可选择设置项目版本和选择要使用的 Java 工具链。 plugins { id 'java-library' } java { toolchain { languageVersion = JavaLanguageVersion.of(11) } } version = '1.2.1' 通过应用 Java 库插件，你可以得到一大堆的功能。 一个 compileJava 任务，编译src"><meta property="og:image" content="https://ng-tech.icu/media/sharing.png"><meta property="twitter:image" content="https://ng-tech.icu/media/sharing.png"><meta property="og:locale" content="zh"><title>应用构建 | Next-gen Tech Edu</title></head><body id=top data-spy=scroll data-offset=70 data-target=#TableOfContents class=page-wrapper data-wc-page-id=29956c5ad7c748e7f0bb52109d9c7cb4><button onclick=topFunction() id=backTopBtn title="Go to top"><i class="fa-solid fa-circle-up" aria-hidden=true></i></button>
<script src=/js/wowchemy-init.min.14a0ed61c6dbd594b9c75193b25be179.js></script><aside class=search-modal id=search><div class=container><section class=search-header><div class="row no-gutters justify-content-between mb-3"><div class="col-6 search-title"><p>搜索</p></div><div class="col-6 col-search-close"><a class=js-search href=# aria-label=关闭><i class="fas fa-times-circle text-muted" aria-hidden=true></i></a></div></div><div id=search-box></div></section><section class=section-search-results><div id=search-hits></div><div id=search-common-queries></div></section></div></aside><div class=page-header><header class=header--fixed><nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id=navbar-main><div class=container-xl><div class="d-none d-lg-inline-flex"><a class=navbar-brand href=/>Next-gen Tech Edu</a></div><button type=button class=navbar-toggler data-toggle=collapse data-target=#navbar-content aria-controls=navbar-content aria-expanded=false aria-label=切换导航>
<span><i class="fas fa-bars"></i></span></button><div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none"><a class=navbar-brand href=/>Next-gen Tech Edu</a></div><div class="navbar-collapse main-menu-item collapse justify-content-start" id=navbar-content><ul class="navbar-nav d-md-inline-flex"><li class=nav-item><a class=nav-link href=/books-gallery><span>笔记（万篇）</span></a></li><li class=nav-item><a class=nav-link href=/#knowledge-map><span>知识图谱</span></a></li><style>.dropdown-item{display:inline-flex}</style><li class="nav-item dropdown"><a href=# class="nav-link dropdown-toggle" data-toggle=dropdown aria-haspopup=true><span>实验室</span><span class=caret></span></a><div class=dropdown-menu><a class=dropdown-item href=/galaxy-home/gh-craft><span>Craft 方块世界</span></a>
<a class=dropdown-item href=/galaxy-home/glossary-cards><span>3D 知识卡牌</span></a></div></li><style>.dropdown-item{display:inline-flex}</style><li class="nav-item dropdown"><a href=# class="nav-link dropdown-toggle" data-toggle=dropdown aria-haspopup=true><span>其他阅读渠道</span><span class=caret></span></a><div class=dropdown-menu><a class=dropdown-item href=https://zhuanlan.zhihu.com/wxyyxc1992><img style=width:16px;height:16px;display:inline-block;margin-right:8px src=https://ngte-superbed.oss-cn-beijing.aliyuncs.com/item/20230218234451.png></img><span>知乎</span></a>
<a class=dropdown-item href=https://segmentfault.com/blog/wxyyxc1992><img style=width:16px;height:16px;display:inline-block;margin-right:8px src=https://ngte-superbed.oss-cn-beijing.aliyuncs.com/item/20230219113556.png></img><span>SegmentFault</span></a>
<a class=dropdown-item href=https://zhuanlan.zhihu.com/wxyyxc1992><img style=width:16px;height:16px;display:inline-block;margin-right:8px src=https://ngte-superbed.oss-cn-beijing.aliyuncs.com/item/20230219113519.png></img><span>掘金</span></a></div></li></ul></div><ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2"><li class=nav-item><a class="nav-link js-search" href=# aria-label=搜索><i class="fas fa-search" aria-hidden=true></i></a></li><li class=nav-item><a class=nav-link href=https://github.com/wx-chevalier aria-label=GitHub><i class="fa-brands fa-github" aria-hidden=true></i></a></li><div></div><style>@media only screen and (max-width:600px){.jimmysong-template{display:none!important}}</style><li class=jimmysong-template style=color:#fff;font-size:12px><a href=https://jimmysong.io style=color:#fff>By Jimmy Song's Template</a></li></ul></div></nav></header></div><div class=page-body><link rel=stylesheet href=//unpkg.com/heti/umd/heti.min.css><div class="container-xl docs"><div class="row flex-xl-nowrap"><div class=docs-sidebar><form class="docs-search d-flex align-items-center"><button class="btn docs-toggle d-md-none p-0 mr-md-3 w-100" type=button data-toggle=collapse data-target=#docs-nav aria-controls=docs-nav aria-expanded=false aria-label="Toggle section navigation"><div class=d-flex><span class="d-md-none pl-1 flex-grow-1 text-left overflow-hidden">Java 实践</span>
<span><i class="fas fa-chevron-down"></i></span></div></button>
<button class="form-control sidebar-search js-search d-none d-md-flex">
<i class="fas fa-search pr-2"></i>
<span class=sidebar-search-text>搜索...</span>
<span class=sidebar-search-shortcut>/</span></button></form><nav class="collapse docs-links" id=docs-nav><ul class="nav docs-sidenav"><li style=display:inline-flex><a style=cursor:pointer onclick=window.history.back()><i class="fas fa-arrow-left pr-1"></i>
Back</a>
<span>|</span>
<a href=/books/><i class="fa-solid fa-house" style=margin-right:4px></i>
Books</a></li></ul><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-idd18efe20abf36b01046301b8983db84a")' href=#idd18efe20abf36b01046301b8983db84a aria-expanded=false aria-controls=idd18efe20abf36b01046301b8983db84a aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/java-series/4.%E5%B7%A5%E7%A8%8B%E5%AE%9E%E8%B7%B5/%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/gradle/>Gradle</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#idd18efe20abf36b01046301b8983db84a aria-expanded=false aria-controls=idd18efe20abf36b01046301b8983db84a><i class="fa-solid fa-angle-down" id=caret-idd18efe20abf36b01046301b8983db84a></i></a></div><ul class="nav docs-sidenav collapse show" id=idd18efe20abf36b01046301b8983db84a><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-id38d205ab62f649d66d812a30be7c7dfc")' href=#id38d205ab62f649d66d812a30be7c7dfc aria-expanded=false aria-controls=id38d205ab62f649d66d812a30be7c7dfc aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/java-series/4.%E5%B7%A5%E7%A8%8B%E5%AE%9E%E8%B7%B5/%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/gradle/java-%E5%AE%9E%E8%B7%B5/>Java 实践</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#id38d205ab62f649d66d812a30be7c7dfc aria-expanded=false aria-controls=id38d205ab62f649d66d812a30be7c7dfc><i class="fa-solid fa-angle-down" id=caret-id38d205ab62f649d66d812a30be7c7dfc></i></a></div><ul class="nav docs-sidenav collapse show" id=id38d205ab62f649d66d812a30be7c7dfc><li class="child level"><a href=/books/java-series/4.%E5%B7%A5%E7%A8%8B%E5%AE%9E%E8%B7%B5/%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/gradle/java-%E5%AE%9E%E8%B7%B5/%E5%A4%9A%E9%A1%B9%E7%9B%AE%E7%BB%93%E6%9E%84/>多项目结构</a></li><li class="child level"><a href=/books/java-series/4.%E5%B7%A5%E7%A8%8B%E5%AE%9E%E8%B7%B5/%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/gradle/java-%E5%AE%9E%E8%B7%B5/%E4%BE%9D%E8%B5%96%E7%AE%A1%E7%90%86/>依赖管理</a></li><li class="child level active"><a href=/books/java-series/4.%E5%B7%A5%E7%A8%8B%E5%AE%9E%E8%B7%B5/%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/gradle/java-%E5%AE%9E%E8%B7%B5/%E5%BA%94%E7%94%A8%E6%9E%84%E5%BB%BA/>应用构建</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-idbe8cc35caa8ff403f6a328b736067ffc")' href=#idbe8cc35caa8ff403f6a328b736067ffc aria-expanded=false aria-controls=idbe8cc35caa8ff403f6a328b736067ffc aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/java-series/4.%E5%B7%A5%E7%A8%8B%E5%AE%9E%E8%B7%B5/%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/gradle/%E6%8F%92%E4%BB%B6/>插件</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#idbe8cc35caa8ff403f6a328b736067ffc aria-expanded=false aria-controls=idbe8cc35caa8ff403f6a328b736067ffc><i class="fa-solid fa-angle-right" id=caret-idbe8cc35caa8ff403f6a328b736067ffc></i></a></div><ul class="nav docs-sidenav collapse" id=idbe8cc35caa8ff403f6a328b736067ffc><li class="child level"><a href=/books/java-series/4.%E5%B7%A5%E7%A8%8B%E5%AE%9E%E8%B7%B5/%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/gradle/%E6%8F%92%E4%BB%B6/%E6%8F%92%E4%BB%B6/>插件</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-id69b35b25638ff90a46afb3f746a14e2d")' href=#id69b35b25638ff90a46afb3f746a14e2d aria-expanded=false aria-controls=id69b35b25638ff90a46afb3f746a14e2d aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/java-series/4.%E5%B7%A5%E7%A8%8B%E5%AE%9E%E8%B7%B5/%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/gradle/%E6%9E%84%E5%BB%BA%E8%84%9A%E6%9C%AC/>构建脚本</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#id69b35b25638ff90a46afb3f746a14e2d aria-expanded=false aria-controls=id69b35b25638ff90a46afb3f746a14e2d><i class="fa-solid fa-angle-right" id=caret-id69b35b25638ff90a46afb3f746a14e2d></i></a></div><ul class="nav docs-sidenav collapse" id=id69b35b25638ff90a46afb3f746a14e2d><li class="child level"><a href=/books/java-series/4.%E5%B7%A5%E7%A8%8B%E5%AE%9E%E8%B7%B5/%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/gradle/%E6%9E%84%E5%BB%BA%E8%84%9A%E6%9C%AC/%E5%85%AC%E5%85%B1%E8%84%9A%E6%9C%AC/>公共脚本</a></li><li class="child level"><a href=/books/java-series/4.%E5%B7%A5%E7%A8%8B%E5%AE%9E%E8%B7%B5/%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/gradle/%E6%9E%84%E5%BB%BA%E8%84%9A%E6%9C%AC/%E4%BB%BB%E5%8A%A1/>任务</a></li><li class="child level"><a href=/books/java-series/4.%E5%B7%A5%E7%A8%8B%E5%AE%9E%E8%B7%B5/%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/gradle/%E6%9E%84%E5%BB%BA%E8%84%9A%E6%9C%AC/%E9%A1%B9%E7%9B%AE%E4%B8%8E%E8%B5%84%E6%BA%90/>项目与资源</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-id7f441ada716b3a802f04df1ed8e1b722")' href=#id7f441ada716b3a802f04df1ed8e1b722 aria-expanded=false aria-controls=id7f441ada716b3a802f04df1ed8e1b722 aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/java-series/4.%E5%B7%A5%E7%A8%8B%E5%AE%9E%E8%B7%B5/%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/gradle/%E5%BF%AB%E9%80%9F%E5%BC%80%E5%A7%8B/>快速开始</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#id7f441ada716b3a802f04df1ed8e1b722 aria-expanded=false aria-controls=id7f441ada716b3a802f04df1ed8e1b722><i class="fa-solid fa-angle-right" id=caret-id7f441ada716b3a802f04df1ed8e1b722></i></a></div><ul class="nav docs-sidenav collapse" id=id7f441ada716b3a802f04df1ed8e1b722><li class="child level"><a href=/books/java-series/4.%E5%B7%A5%E7%A8%8B%E5%AE%9E%E8%B7%B5/%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/gradle/%E5%BF%AB%E9%80%9F%E5%BC%80%E5%A7%8B/%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AE/>安装配置</a></li><li class="child level"><a href=/books/java-series/4.%E5%B7%A5%E7%A8%8B%E5%AE%9E%E8%B7%B5/%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/gradle/%E5%BF%AB%E9%80%9F%E5%BC%80%E5%A7%8B/%E9%A1%B9%E7%9B%AE%E5%88%9D%E5%A7%8B%E5%8C%96/>项目初始化</a></li></ul></div></ul></div></nav></div><div class="d-none d-xl-block col-xl-2 docs-toc"><ul class="nav toc-top"><li><a href=# id=back_to_top class=docs-toc-title>目录</a></li></ul><nav id=TableOfContents><ul><li><a href=#自定义属性>自定义属性</a></li></ul><ul><li><a href=#修改-jar-包元定义>修改 Jar 包元定义</a></li></ul></nav><div class="subscribe-module col-24 mt-1"><img src=https://ngte-superbed.oss-cn-beijing.aliyuncs.com/item/20230220172727.png alt=image title=王下邀月熊的微信公众号></div></div><main class="py-md-3 pl-md-3 docs-content col-xl-8" role=main><article class=article><h1>应用构建</h1><div class=article-style><h1 id=java--jvm-应用构建>Java & JVM 应用构建</h1><p>一个 Java 项目的最简单的构建脚本应用了 Java 库插件，并可选择设置项目版本和选择要使用的 Java 工具链。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-groovy data-lang=groovy><span class=line><span class=cl><span class=n>plugins</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>id</span> <span class=s1>&#39;java-library&#39;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>java</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>toolchain</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>languageVersion</span> <span class=o>=</span> <span class=n>JavaLanguageVersion</span><span class=o>.</span><span class=na>of</span><span class=o>(</span><span class=mi>11</span><span class=o>)</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>version</span> <span class=o>=</span> <span class=s1>&#39;1.2.1&#39;</span>
</span></span></code></pre></div><p>通过应用 Java 库插件，你可以得到一大堆的功能。</p><ul><li>一个 compileJava 任务，编译<code>src/main/java</code>下的所有 Java 源文件。</li><li>为 <code>src/test/java</code> 下的源文件制定的 <code>compileTestJava</code> 任务</li><li>一个<code>test</code>任务，运行<code>src/test/java</code>下的测试。</li><li>一个 jar 任务，将<code>src/main/resources</code>下的 main 编译的类和资源打包成一个名为<code>&lt;project>-&lt;version>.jar</code>的 JAR。</li><li>一个<code>javadoc</code>任务，为<code>main</code>类生成 Javadoc。</li></ul><p>这并不足以构建任何非复杂的 Java 项目，至少，你可能会有一些文件的依赖性。但这意味着你的构建脚本只需要你的项目所特有的信息。</p><h1 id=source-sets>Source sets</h1><p>Gradle 的 Java 支持是第一个为构建基于源的项目引入新概念的：Source sets。其主要思想是，源文件和资源通常按类型进行逻辑分组，如应用程序代码、单元测试和集成测试。每个逻辑组通常都有自己的文件依赖性、classpaths 等的集合。值得注意的是，构成源文件集的文件不一定要位于同一个目录中，这一点很重要。</p><p>Source sets 是一个强大的概念，它把编译的几个方面联系在一起。</p><ul><li>源文件和它们的位置</li><li>编译的 classpath，包括任何必要的依赖关系</li><li>编译后的类文件的位置</li></ul><p><figure><div class="d-flex justify-content-center"><div class=w-100><img src=https://ngte-superbed.oss-cn-beijing.aliyuncs.com/superbed/2021/07/17/60f27a4d5132923bf87800e7.png alt="Source sets and Java compilation" loading=lazy data-zoomable></div></div></figure></p><p>阴影框代表 Source sets 本身的属性。在此基础上，Java 库插件为你或插件定义的每个 Source sets 自动创建一个编译任务，名为 compileSourceSetJava 和几个依赖配置。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-groovy data-lang=groovy><span class=line><span class=cl><span class=c1>// Replaces conventional source code directory with list of different directories
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>sourceSets</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>main</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>java</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=n>srcDirs</span> <span class=o>=</span> <span class=o>[</span><span class=s1>&#39;src&#39;</span><span class=o>]</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=c1>// Replaces conventional test source code directory with list of different directories
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>test</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>java</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=n>srcDirs</span> <span class=o>=</span> <span class=o>[</span><span class=s1>&#39;test&#39;</span><span class=o>]</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Changes project output property to directory out
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>buildDir</span> <span class=o>=</span> <span class=s1>&#39;out&#39;</span>
</span></span></code></pre></div><p>现在 Gradle 只会直接在 src 和 test 中搜索相应的源代码。如果你不想覆盖这个惯例，而只是想增加一个额外的源码目录，也许是包含一些你想保持独立的第三方源码的目录呢？语法是类似的。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-groovy data-lang=groovy><span class=line><span class=cl><span class=n>sourceSets</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>main</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>java</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=n>srcDir</span> <span class=s1>&#39;thirdParty/src/main/java&#39;</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>我们也可以指定直接在项目根目录下存放源代码文件：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-groovy data-lang=groovy><span class=line><span class=cl><span class=n>sourceSets</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>main</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>java</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=n>srcDirs</span> <span class=o>+=</span> <span class=o>[</span><span class=s2>&#34;$projectDir&#34;</span><span class=o>]</span>
</span></span><span class=line><span class=cl>            <span class=n>srcDirs</span> <span class=o>+=</span> <span class=o>[</span><span class=s2>&#34;$projectDir/cadex&#34;</span><span class=o>]</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>Java 项目通常包括源文件以外的资源，如属性文件，这些资源可能需要处理，例如替换文件中的令牌并打包到最终的 JAR 中。Java 库插件通过为每个定义的 Source sets 自动创建一个专门的任务来处理这个问题，这个任务叫做 processSourceSetResources（或者主 Source sets 的 processResources）。下图显示了 Source sets 是如何与这个任务配合的。</p><p><figure><div class="d-flex justify-content-center"><div class=w-100><img src=https://ngte-superbed.oss-cn-beijing.aliyuncs.com/superbed/2021/07/17/60f27a955132923bf87aa4e6.png alt="Processing non-source files for a source set" loading=lazy data-zoomable></div></div></figure></p><p>像以前一样，阴影框代表 Source sets 的属性，在这种情况下，它包括资源文件的位置和它们被复制到哪里。除了主 Source sets，Java 库插件还定义了一个测试 Source sets，代表项目的测试。这个 Source sets 被测试任务所使用，它运行测试。你可以在 Java 测试章节中了解更多关于这个任务和相关主题。</p><p>项目通常将这个 Source sets 用于单元测试，但如果你愿意，你也可以将它用于集成、验收和其他类型的测试。另一种方法是为你的每个其他测试类型定义一个新的 Source sets，这通常是出于以下一个或两个原因。为了美观和可管理性，你想保持测试彼此分离，不同的测试类型需要不同的编译或运行时 classpaths 或其他一些设置上的差异</p><h1 id=依赖管理>依赖管理</h1><p>绝大多数的 Java 项目都依赖于库，所以管理项目的依赖关系是建立 Java 项目的一个重要部分。依赖关系管理是一个很大的话题，所以我们在这里将重点介绍 Java 项目的基础知识。为你的 Java 项目指定依赖关系只需要三条信息。</p><ul><li>你需要哪个依赖，例如名称和版本</li><li>需要它做什么，比如说编译或运行</li><li>在哪里可以找到它</li></ul><p>前两个在依赖关系 {} 块中指定，第三个在资源库 {} 块中指定。例如，要告诉 Gradle 你的项目需要 3.6.7 版的 Hibernate Core 来编译和运行生产代码，并且要从 Maven Central 仓库下载该库，你可以使用下面的片段。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-groovy data-lang=groovy><span class=line><span class=cl><span class=n>repositories</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>mavenCentral</span><span class=o>()</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>dependencies</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>implementation</span> <span class=s1>&#39;org.hibernate:hibernate-core:3.6.7.Final&#39;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>这三个要素的 Gradle 术语如下。</p><ul><li>仓库"（例如：&ldquo;mavenCentral()"）&ndash;在那里可以找到你声明为依赖的模块</li><li>配置&rdquo;（ex: <code>implementation</code>）&ndash;命名的依赖关系集合，为特定目标（如编译或运行模块）而分组&ndash;是 Maven 作用域的更灵活形式</li><li>模块坐标"（例如：<code>org.hibernate:hibernate-core-3.6.7.Final</code>）&ndash;依赖关系的 ID，通常采用"<code>&lt;组></code>:<code>&lt;模块></code>:<code>&lt;版本></code>&ldquo;的形式（或 Maven 术语中的&rdquo;<code>&lt;组ID></code>:<code>&lt;工件ID></code>:<code>&lt;版本></code>"）。</li></ul><p>你可以找到一份更全面的依赖性管理术语表<a href=https://docs.gradle.org/current/userguide/dependency_management_terminology.html#dependency_management_terminology target=_blank rel=noopener>这里</a>。</p><p>就配置而言，主要有以下几种。</p><ul><li><code>compileOnly</code>&ndash;用于编译生产代码所需的依赖项，但不应该成为运行时 classpath 的一部分。</li><li><code>implementation</code> (取代<code>compile</code>) - 用于编译和运行时。</li><li><code>runtimeOnly</code> (取代<code>runtime</code>) - 只在运行时使用，不用于编译</li><li><code>testCompileOnly</code> - 与<code>compileOnly</code>相同，只是用于测试。</li><li><code>testImplementation</code> - 测试相当于<code>implementation</code>。</li><li><code>testRuntimeOnly</code>&ndash;相当于<code>runtimeOnly</code>的测试。</li></ul><h1 id=编译>编译</h1><p><figure><div class="d-flex justify-content-center"><div class=w-100><img src=https://lippiouyang.gitbooks.io/gradle-in-action-cn/content/images/dag12.png alt loading=lazy data-zoomable></div></div></figure></p><p>现在你可以构建你的项目了，java 插件添加了一个 build 任务到你项目中，build 任务编译你的代码、运行测试然后打包成 jar 文件，所有都是按序执行的。运行 gradle build 之后你的输出应该是类似这样的：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>$ gradle build
</span></span><span class=line><span class=cl>:compileJava
</span></span><span class=line><span class=cl>:processResources UP-TO-DATE
</span></span><span class=line><span class=cl>:classes
</span></span><span class=line><span class=cl>:jar
</span></span><span class=line><span class=cl>:assemble
</span></span><span class=line><span class=cl>:compileTestJava UP-TO-DATE
</span></span><span class=line><span class=cl>:processTestResources UP-TO-DATE
</span></span><span class=line><span class=cl>:testClasses UP-TO-DATE
</span></span><span class=line><span class=cl>:test
</span></span><span class=line><span class=cl>:check
</span></span><span class=line><span class=cl>:build
</span></span></code></pre></div><p>输出的每一行都表示一个可执行的任务，你可能注意到有一些任务标记为 UP_TO-DATE,这意味着这些任务被跳过了，gradle 能够自动检查哪些部分没有发生改变，就把这部分标记下来，省的重复执行。在大型的企业项目中可以节省不少时间。执行完 gradle build 之后项目结构应该是类似这样的：</p><p><figure><div class="d-flex justify-content-center"><div class=w-100><img src=https://lippiouyang.gitbooks.io/gradle-in-action-cn/content/images/dag13.png alt loading=lazy data-zoomable></div></div></figure></p><p><figure><div class="d-flex justify-content-center"><div class=w-100><img src=https://lippiouyang.gitbooks.io/gradle-in-action-cn/content/images/dag14.png alt loading=lazy data-zoomable></div></div></figure></p><p>在项目的根目录你可以找到一个 build 目录，这里包含了所有的输出，包含 class 文件，测试报告，打包的 jar 文件，以及一些用来归档的临时文件。如果你之前使用过 maven，它的标准输出是 target，这两个结构应该很类似。jar 文件目录 build/libs 下可以直接运行，jar 文件的名称直接由项目名称得来的。</p><h2 id=自定义属性>自定义属性</h2><p>Java 插件是一个非常固执的框架，对于项目很多的方面它都假定有默认值，比如项目布局，如果你看待世界的方法是不一样的，Gradle 给你提供了一个自定义约定的选项。想知道哪些东西是可以配置的？可以参考这个手册：http://www.gradle.org/docs/current/dsl/，之前提到过，运行命令行 gradle properties 可以列出可配置的标准和插件属性以及他们的默认值。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-groovy data-lang=groovy><span class=line><span class=cl><span class=c1>// Identifies project’sversion through a number scheme
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>version</span> <span class=o>=</span> <span class=mf>0.1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Sets Java version compilation compatibility to 1.6
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>sourceCompatibility</span> <span class=o>=</span> <span class=mf>1.6</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Adds Main-Class header to JAR file’s manifest
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>jar</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>manifest</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>attributes</span> <span class=s1>&#39;Main-Class&#39;</span><span class=o>:</span> <span class=s1>&#39;com.manning.gia.todo.ToDoApp&#39;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>打包成 JAR 之后，你会发现 JAR 文件的名称变成了 todo-app-0.1.jar，这个 jar 包含了 main-class 首部，你就可以通过命令 java -jar build/libs/todo-app-0.1.jar 运行了。</p><h1 id=打包与发布>打包与发布</h1><p>你如何打包并可能发布你的 Java 项目，取决于它是什么类型的项目：库、应用程序、Web 应用程序和企业应用程序都有不同的要求。默认情况下，Java Library Plugin 提供了 jar 任务，将所有编译好的生产类和资源打包成一个 JAR。这个 JAR 也是由 assemble 任务自动构建的。此外，如果需要的话，该插件可以被配置为提供 javadocJar 和 sourcesJar 任务来打包 Javadoc 和源代码。如果使用了一个发布插件，这些任务将在发布过程中自动运行，或者可以直接调用。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>java</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>withJavadocJar</span><span class=o>()</span>
</span></span><span class=line><span class=cl>    <span class=n>withSourcesJar</span><span class=o>()</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>如果你想创建一个 &ldquo;超级&rdquo;（又称 Fat）JAR，那么你可以使用这样的任务定义。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-groovy data-lang=groovy><span class=line><span class=cl><span class=n>plugins</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>id</span> <span class=s1>&#39;java&#39;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>version</span> <span class=o>=</span> <span class=s1>&#39;1.0.0&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>repositories</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>mavenCentral</span><span class=o>()</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>dependencies</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>implementation</span> <span class=s1>&#39;commons-io:commons-io:2.6&#39;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>tasks</span><span class=o>.</span><span class=na>register</span><span class=o>(</span><span class=s1>&#39;uberJar&#39;</span><span class=o>,</span> <span class=n>Jar</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>archiveClassifier</span> <span class=o>=</span> <span class=s1>&#39;uber&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>from</span> <span class=n>sourceSets</span><span class=o>.</span><span class=na>main</span><span class=o>.</span><span class=na>output</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>dependsOn</span> <span class=n>configurations</span><span class=o>.</span><span class=na>runtimeClasspath</span>
</span></span><span class=line><span class=cl>    <span class=n>from</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>configurations</span><span class=o>.</span><span class=na>runtimeClasspath</span><span class=o>.</span><span class=na>findAll</span> <span class=o>{</span> <span class=n>it</span><span class=o>.</span><span class=na>name</span><span class=o>.</span><span class=na>endsWith</span><span class=o>(</span><span class=s1>&#39;jar&#39;</span><span class=o>)</span> <span class=o>}.</span><span class=na>collect</span> <span class=o>{</span> <span class=n>zipTree</span><span class=o>(</span><span class=n>it</span><span class=o>)</span> <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><h2 id=修改-jar-包元定义>修改 Jar 包元定义</h2><p>Jar、War 和 Ear 任务的每个实例都有一个清单属性，允许您自定义进入相应存档的 MANIFEST.MF 文件。下面的例子演示了如何在 JAR 的清单中设置属性。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-groovy data-lang=groovy><span class=line><span class=cl><span class=n>jar</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>manifest</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>attributes</span><span class=o>(</span><span class=s2>&#34;Implementation-Title&#34;</span><span class=o>:</span> <span class=s2>&#34;Gradle&#34;</span><span class=o>,</span>
</span></span><span class=line><span class=cl>                   <span class=s2>&#34;Implementation-Version&#34;</span><span class=o>:</span> <span class=n>archiveVersion</span><span class=o>)</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>您还可以创建 Manifest 的独立实例。这样做的一个原因是为了在 JAR 之间共享清单信息。下面的例子演示了如何在 JAR 之间共享共同属性。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>ext</span><span class=o>.</span><span class=na>sharedManifest</span> <span class=o>=</span> <span class=n>manifest</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>attributes</span><span class=o>(</span><span class=s>&#34;Implementation-Title&#34;</span><span class=o>:</span> <span class=s>&#34;Gradle&#34;</span><span class=o>,</span>
</span></span><span class=line><span class=cl>               <span class=s>&#34;Implementation-Version&#34;</span><span class=o>:</span> <span class=n>version</span><span class=o>)</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=n>tasks</span><span class=o>.</span><span class=na>register</span><span class=o>(</span><span class=err>&#39;</span><span class=n>fooJar</span><span class=err>&#39;</span><span class=o>,</span> <span class=n>Jar</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>manifest</span> <span class=o>=</span> <span class=n>project</span><span class=o>.</span><span class=na>manifest</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>from</span> <span class=n>sharedManifest</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>另一个可供您使用的选项是将舱单合并到一个舱单对象中。这些源清单的形式可以是文本，也可以是另一个 Manifest 对象。在下面的例子中，源清单都是文本文件，只有 sharedManifest 除外，它是前面例子中的清单对象。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>tasks</span><span class=o>.</span><span class=na>register</span><span class=o>(</span><span class=err>&#39;</span><span class=n>barJar</span><span class=err>&#39;</span><span class=o>,</span> <span class=n>Jar</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>manifest</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>attributes</span> <span class=n>key1</span><span class=o>:</span> <span class=err>&#39;</span><span class=n>value1</span><span class=err>&#39;</span>
</span></span><span class=line><span class=cl>        <span class=n>from</span> <span class=n>sharedManifest</span><span class=o>,</span> <span class=err>&#39;</span><span class=n>src</span><span class=o>/</span><span class=n>config</span><span class=o>/</span><span class=n>basemanifest</span><span class=o>.</span><span class=na>txt</span><span class=err>&#39;</span>
</span></span><span class=line><span class=cl>        <span class=n>from</span><span class=o>([</span><span class=err>&#39;</span><span class=n>src</span><span class=o>/</span><span class=n>config</span><span class=o>/</span><span class=n>javabasemanifest</span><span class=o>.</span><span class=na>txt</span><span class=err>&#39;</span><span class=o>,</span> <span class=err>&#39;</span><span class=n>src</span><span class=o>/</span><span class=n>config</span><span class=o>/</span><span class=n>libbasemanifest</span><span class=o>.</span><span class=na>txt</span><span class=err>&#39;</span><span class=o>])</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=n>eachEntry</span> <span class=o>{</span> <span class=n>details</span> <span class=o>-&gt;</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=o>(</span><span class=n>details</span><span class=o>.</span><span class=na>baseValue</span> <span class=o>!=</span> <span class=n>details</span><span class=o>.</span><span class=na>mergeValue</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                    <span class=n>details</span><span class=o>.</span><span class=na>value</span> <span class=o>=</span> <span class=n>baseValue</span>
</span></span><span class=line><span class=cl>                <span class=o>}</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=o>(</span><span class=n>details</span><span class=o>.</span><span class=na>key</span> <span class=o>==</span> <span class=err>&#39;</span><span class=n>foo</span><span class=err>&#39;</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                    <span class=n>details</span><span class=o>.</span><span class=na>exclude</span><span class=o>()</span>
</span></span><span class=line><span class=cl>                <span class=o>}</span>
</span></span><span class=line><span class=cl>            <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div></div><div class=article-widget><div class="container-xl row post-nav"><div class="col-6 post-nav-item"><div class=meta-nav>上一页</div><a href=/books/java-series/4.%E5%B7%A5%E7%A8%8B%E5%AE%9E%E8%B7%B5/%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/gradle/java-%E5%AE%9E%E8%B7%B5/%E4%BE%9D%E8%B5%96%E7%AE%A1%E7%90%86/ rel=next>依赖管理</a></div></div></div><div class=body-footer><p>最近更新于 0001-01-01</p><section id=comments class="mb-3 pt-0"><div id=disqus_thread></div><script>var disqus_config=function(){};(function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="https://ngte-website.oss-accelerate.aliyuncs.com/disqus/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)})()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></section></div></article><footer class=site-footer><div class="copyright py-4 bg-footer"><div class="row justify-content-center"><div class="text-center footer-color"><p class=mb-0>© 2017-2022 NGTE all rights reserved</p></div></div></div></footer></main></div></div><script src=//unpkg.com/heti/umd/heti-addon.min.js></script>
<script>const heti=new Heti(".article");heti.autoSpacing()</script><script type=text/javascript>window.$crisp=[],window.CRISP_WEBSITE_ID="12adcc35-9621-4313-8262-62dc654b29d8",function(){setTimeout(function(){d=document,s=d.createElement("script"),s.src="https://client.crisp.chat/l.js",s.async=1,d.getElementsByTagName("head")[0].appendChild(s)},2500)}()</script></div><div class=page-footer></div><script src=/js/vendor-bundle.min.d26509351aa0ff874abbee824e982e9b.js></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.1/highlight.min.js integrity="sha512-Ypjm0o7jOxAd4hpdoppSEN0TQOC19UtPAqD+4s5AlXmUvbmmS/YMxYqAqarQYyxTnB6/rqip9qcxlNB/3U9Wdg==" crossorigin=anonymous></script>
<script id=search-hit-algolia-template type=text/html><div class=search-hit><div class=search-hit-content><div class=search-hit-name><a href={{relpermalink}}>{{#helpers.highlight}}{ "attribute": "title" }{{/helpers.highlight}}</a></div><div class="article-metadata search-hit-type">{{type}}</div><p class=search-hit-description>{{#helpers.highlight}}{ "attribute": "summary" }{{/helpers.highlight}}</p></div></div></script><script src=https://cdn.jsdelivr.net/npm/instantsearch.js@4/dist/instantsearch.production.min.js crossorigin=anonymous></script>
<script id=dsq-count-scr src=https://ngte-website.oss-accelerate.aliyuncs.com/disqus/count.js async></script>
<script src=/zh/js/algolia-search-built.min.4387d694ca1258194aaf562b8cd1c400.js type=module></script>
<script id=page-data type=application/json>{"use_headroom":false}</script><script src=/zh/js/wowchemy.min.d1673c7a11d1238516cbe12a1e84257f.js></script>
<script>var mybutton=document.getElementById("backTopBtn");window.onscroll=function(){scrollFunction()};function scrollFunction(){document.body.scrollTop>20||document.documentElement.scrollTop>20?mybutton.style.display="block":mybutton.style.display="none"}function topFunction(){document.body.scrollTop=0,document.documentElement.scrollTop=0}</script><script src=https://cdn.jsdelivr.net/gh/bryanbraun/anchorjs@4.2.2/anchor.min.js integrity="sha512-I7w3ZdSFzw5j3jU3ZkNikBNeIrl3i+hEuEdwNmqUJvwNcaBUNcijnP2gd9DtGlgVYDplfjGoD8vTNsID+lCjqg==" crossorigin=anonymous></script>
<script>anchors.add()</script><script>(function(){"use strict";if(!document.queryCommandSupported("copy"))return;function e(e,t){e.className="highlight-copy-btn",e.textContent=t,setTimeout(function(){e.textContent="",e.className="highlight-copy-btn fa fa-copy"},1e3)}function t(e){var t=window.getSelection(),n=document.createRange();return n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n),t}function n(n){var o,s=document.createElement("button");s.className="highlight-copy-btn fa fa-copy",s.textContent="",o=n.firstElementChild,s.addEventListener("click",function(){try{var n=t(o);document.execCommand("copy"),n.removeAllRanges(),e(s,"已复制")}catch(t){console&&console.log(t),e(s,"Failed :'(")}}),n.appendChild(s)}var s=document.getElementsByClassName("highlight");Array.prototype.forEach.call(s,n)})()</script></body></html>