<!doctype html><html lang=zh><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=generator content="Wowchemy 5.5.0 for Hugo"><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=preload as=style href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap"><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap" media=print onload='this.media="all"'><meta name=google-site-verification content="google69a5cccb61297807"><meta name=baidu-site-verification content="cqmZHEleVh"><meta name=description content="第二十二章 枚举 关键字 enum 可以将一组具名的值的有限集合创建为一种新的类型，而这些具名的值可以作为常规的程序组件使用。这是一种非常有用的功能 在初始化和清理 这章结束的时候，我们已经简单地介绍了枚举的概念。现在"><link rel=alternate hreflang=zh href=https://ng-tech.icu/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/22-enumerations/><meta name=theme-color content="#0a55a7"><link rel=stylesheet href=/css/vendor-bundle.min.c7b8d9abd591ba2253ea42747e3ac3f5.css media=print onload='this.media="all"'><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.1/styles/github.min.css crossorigin=anonymous title=hl-light media=print onload='this.media="all"'><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.1/styles/dracula.min.css crossorigin=anonymous title=hl-dark media=print onload='this.media="all"' disabled><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/instantsearch.css@7.4.5/themes/satellite-min.css integrity="sha256-TehzF/2QvNKhGQrrNpoOb2Ck4iGZ1J/DI4pkd2oUsBc=" crossorigin=anonymous><link rel=stylesheet href=/css/wowchemy.fab3cd1900ae35687457073b2d518207.css><script async src="https://www.googletagmanager.com/gtag/js?id=G-40NYXJ8823"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-40NYXJ8823")</script><script>var _hmt=_hmt||[];(function(){var e,t=document.createElement("script");t.src="https://hm.baidu.com/hm.js?56df1177bce405601b0ecdd7208f75c6",e=document.getElementsByTagName("script")[0],e.parentNode.insertBefore(t,e)})()</script><link rel=manifest href=/manifest.webmanifest><link rel=icon type=image/png href=/media/icon_hu0f7d075e895d6f5f1f5fdbc1e33dc138_10087_32x32_fill_lanczos_center_3.png><link rel=apple-touch-icon type=image/png href=/media/icon_hu0f7d075e895d6f5f1f5fdbc1e33dc138_10087_180x180_fill_lanczos_center_3.png><link rel=canonical href=https://ng-tech.icu/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/22-enumerations/><meta property="twitter:card" content="summary_large_image"><meta property="twitter:site" content="@wx-chevalier"><meta property="twitter:creator" content="@wx-chevalier"><meta property="og:site_name" content="Next-gen Tech Edu"><meta property="og:url" content="https://ng-tech.icu/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/22-enumerations/"><meta property="og:title" content="22-Enumerations | Next-gen Tech Edu"><meta property="og:description" content="第二十二章 枚举 关键字 enum 可以将一组具名的值的有限集合创建为一种新的类型，而这些具名的值可以作为常规的程序组件使用。这是一种非常有用的功能 在初始化和清理 这章结束的时候，我们已经简单地介绍了枚举的概念。现在"><meta property="og:image" content="https://ng-tech.icu/media/sharing.png"><meta property="twitter:image" content="https://ng-tech.icu/media/sharing.png"><meta property="og:locale" content="zh"><title>22-Enumerations | Next-gen Tech Edu</title></head><body id=top data-spy=scroll data-offset=70 data-target=#TableOfContents class=page-wrapper data-wc-page-id=cdd6d7b9ca2a3e3c4fd2202d6b00c541><button onclick=topFunction() id=backTopBtn title="Go to top"><i class="fa-solid fa-circle-up" aria-hidden=true></i></button>
<script src=/js/wowchemy-init.min.14a0ed61c6dbd594b9c75193b25be179.js></script><aside class=search-modal id=search><div class=container><section class=search-header><div class="row no-gutters justify-content-between mb-3"><div class="col-6 search-title"><p>搜索</p></div><div class="col-6 col-search-close"><a class=js-search href=# aria-label=关闭><i class="fas fa-times-circle text-muted" aria-hidden=true></i></a></div></div><div id=search-box></div></section><section class=section-search-results><div id=search-hits></div><div id=search-common-queries></div></section></div></aside><div class=page-header><header class=header--fixed><nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id=navbar-main><div class=container-xl><div class="d-none d-lg-inline-flex"><a class=navbar-brand href=/>Next-gen Tech Edu</a></div><button type=button class=navbar-toggler data-toggle=collapse data-target=#navbar-content aria-controls=navbar-content aria-expanded=false aria-label=切换导航>
<span><i class="fas fa-bars"></i></span></button><div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none"><a class=navbar-brand href=/>Next-gen Tech Edu</a></div><div class="navbar-collapse main-menu-item collapse justify-content-start" id=navbar-content><ul class="navbar-nav d-md-inline-flex"><li class=nav-item><a class=nav-link href=/books-gallery><span>笔记（万篇）</span></a></li><li class=nav-item><a class=nav-link href=/#knowledge-map><span>知识图谱</span></a></li><style>.dropdown-item{display:inline-flex}</style><li class="nav-item dropdown"><a href=# class="nav-link dropdown-toggle" data-toggle=dropdown aria-haspopup=true><span>实验室</span><span class=caret></span></a><div class=dropdown-menu><a class=dropdown-item href=/galaxy-home/gh-craft><span>Craft 方块世界</span></a>
<a class=dropdown-item href=/galaxy-home/glossary-cards><span>3D 知识卡牌</span></a></div></li><style>.dropdown-item{display:inline-flex}</style><li class="nav-item dropdown"><a href=# class="nav-link dropdown-toggle" data-toggle=dropdown aria-haspopup=true><span>其他阅读渠道</span><span class=caret></span></a><div class=dropdown-menu><a class=dropdown-item href=https://zhuanlan.zhihu.com/wxyyxc1992><img style=width:16px;height:16px;display:inline-block;margin-right:8px src=https://ngte-superbed.oss-cn-beijing.aliyuncs.com/item/20230218234451.png></img><span>知乎</span></a>
<a class=dropdown-item href=https://segmentfault.com/blog/wxyyxc1992><img style=width:16px;height:16px;display:inline-block;margin-right:8px src=https://ngte-superbed.oss-cn-beijing.aliyuncs.com/item/20230219113556.png></img><span>SegmentFault</span></a>
<a class=dropdown-item href=https://zhuanlan.zhihu.com/wxyyxc1992><img style=width:16px;height:16px;display:inline-block;margin-right:8px src=https://ngte-superbed.oss-cn-beijing.aliyuncs.com/item/20230219113519.png></img><span>掘金</span></a></div></li></ul></div><ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2"><li class=nav-item><a class="nav-link js-search" href=# aria-label=搜索><i class="fas fa-search" aria-hidden=true></i></a></li><li class=nav-item><a class=nav-link href=https://github.com/wx-chevalier aria-label=GitHub><i class="fa-brands fa-github" aria-hidden=true></i></a></li><div></div><style>@media only screen and (max-width:600px){.jimmysong-template{display:none!important}}</style><li class=jimmysong-template style=color:#fff;font-size:12px><a href=https://jimmysong.io style=color:#fff>By Jimmy Song's Template</a></li></ul></div></nav></header></div><div class=page-body><link rel=stylesheet href=//unpkg.com/heti/umd/heti.min.css><div class="container-xl docs"><div class="row flex-xl-nowrap"><div class=docs-sidebar><form class="docs-search d-flex align-items-center"><button class="btn docs-toggle d-md-none p-0 mr-md-3 w-100" type=button data-toggle=collapse data-target=#docs-nav aria-controls=docs-nav aria-expanded=false aria-label="Toggle section navigation"><div class=d-flex><span class="d-md-none pl-1 flex-grow-1 text-left overflow-hidden">On Java 8</span>
<span><i class="fas fa-chevron-down"></i></span></div></button>
<button class="form-control sidebar-search js-search d-none d-md-flex">
<i class="fas fa-search pr-2"></i>
<span class=sidebar-search-text>搜索...</span>
<span class=sidebar-search-shortcut>/</span></button></form><nav class="collapse docs-links" id=docs-nav><ul class="nav docs-sidenav"><li style=display:inline-flex><a style=cursor:pointer onclick=window.history.back()><i class="fas fa-arrow-left pr-1"></i>
Back</a>
<span>|</span>
<a href=/books/><i class="fa-solid fa-house" style=margin-right:4px></i>
Books</a></li></ul><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-idb9e60239e3d748bf31eb7c5de38f5561")' href=#idb9e60239e3d748bf31eb7c5de38f5561 aria-expanded=false aria-controls=idb9e60239e3d748bf31eb7c5de38f5561 aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/>99.参考资料</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#idb9e60239e3d748bf31eb7c5de38f5561 aria-expanded=false aria-controls=idb9e60239e3d748bf31eb7c5de38f5561><i class="fa-solid fa-angle-down" id=caret-idb9e60239e3d748bf31eb7c5de38f5561></i></a></div><ul class="nav docs-sidenav collapse show" id=idb9e60239e3d748bf31eb7c5de38f5561><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-id51f028053e6be7c11b12b7b0d4faa770")' href=#id51f028053e6be7c11b12b7b0d4faa770 aria-expanded=false aria-controls=id51f028053e6be7c11b12b7b0d4faa770 aria-hidden=false data-toggle=collapse></div></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-idd95d813603af3028b9bceaec8ff661e1")' href=#idd95d813603af3028b9bceaec8ff661e1 aria-expanded=false aria-controls=idd95d813603af3028b9bceaec8ff661e1 aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/>On Java 8</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#idd95d813603af3028b9bceaec8ff661e1 aria-expanded=false aria-controls=idd95d813603af3028b9bceaec8ff661e1><i class="fa-solid fa-angle-down" id=caret-idd95d813603af3028b9bceaec8ff661e1></i></a></div><ul class="nav docs-sidenav collapse show" id=idd95d813603af3028b9bceaec8ff661e1><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/00-introduction/>00-Introduction</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/01-what-is-an-object/>01-What-is-an-Object</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/02-installing-java-and-the-book-examples/>02-Installing-Java-and-the-Book-Examples</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/03-objects-everywhere/>03-Objects-Everywhere</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/04-operators/>04-Operators</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/05-control-flow/>05-Control-Flow</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/06-housekeeping/>06-Housekeeping</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/07-implementation-hiding/>07-Implementation-Hiding</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/08-reuse/>08-Reuse</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/09-polymorphism/>09-Polymorphism</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/10-interfaces/>10-Interfaces</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/11-inner-classes/>11-Inner-Classes</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/12-collections/>12-Collections</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/13-functional-programming/>13-Functional-Programming</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/14-streams/>14-Streams</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/15-exceptions/>15-Exceptions</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/16-validating-your-code/>16-Validating-Your-Code</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/17-files/>17-Files</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/18-strings/>18-Strings</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/19-type-information/>19-Type-Information</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/20-generics/>20-Generics</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/21-arrays/>21-Arrays</a></li><li class="child level active"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/22-enumerations/>22-Enumerations</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/23-annotations/>23-Annotations</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/24-concurrent-programming/>24-Concurrent-Programming</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/25-patterns/>25-Patterns</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/appendix-becoming-a-programmer/>Appendix-Becoming-a-Programmer</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/appendix-benefits-and-costs-of-static-type-checking/>Appendix-Benefits-and-Costs-of-Static-Type-Checking</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/appendix-collection-topics/>Appendix-Collection-Topics</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/appendix-data-compression/>Appendix-Data-Compression</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/appendix-io-streams/>Appendix-IO-Streams</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/appendix-javadoc/>Appendix-Javadoc</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/appendix-low-level-concurrency/>Appendix-Low-Level-Concurrency</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/appendix-new-io/>Appendix-New-IO</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/appendix-object-serialization/>Appendix-Object-Serialization</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/appendix-passing-and-returning-objects/>Appendix-Passing-and-Returning-Objects</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/appendix-programming-guidelines/>Appendix-Programming-Guidelines</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/appendix-standard-io/>Appendix-Standard-IO</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/appendix-supplements/>Appendix-Supplements</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/appendix-the-positive-legacy-of-c-plus-plus-and-java/>Appendix-The-Positive-Legacy-of-C-plus-plus-and-Java</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/appendix-understanding-equals-and-hashcode/>Appendix-Understanding-equals-and-hashCode</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/glossary/>GLOSSARY</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-id775c4a5ac3467743f5bb8deee7e9fdbf")' href=#id775c4a5ac3467743f5bb8deee7e9fdbf aria-expanded=false aria-controls=id775c4a5ac3467743f5bb8deee7e9fdbf aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/>Think in Java</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#id775c4a5ac3467743f5bb8deee7e9fdbf aria-expanded=false aria-controls=id775c4a5ac3467743f5bb8deee7e9fdbf><i class="fa-solid fa-angle-right" id=caret-id775c4a5ac3467743f5bb8deee7e9fdbf></i></a></div><ul class="nav docs-sidenav collapse" id=id775c4a5ac3467743f5bb8deee7e9fdbf><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-id525871933f7d0cc39b215ee01317566e")' href=#id525871933f7d0cc39b215ee01317566e aria-expanded=false aria-controls=id525871933f7d0cc39b215ee01317566e aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/01.%E5%AF%B9%E8%B1%A1%E5%85%A5%E9%97%A8/>01.对象入门</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#id525871933f7d0cc39b215ee01317566e aria-expanded=false aria-controls=id525871933f7d0cc39b215ee01317566e><i class="fa-solid fa-angle-right" id=caret-id525871933f7d0cc39b215ee01317566e></i></a></div><ul class="nav docs-sidenav collapse" id=id525871933f7d0cc39b215ee01317566e><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/01.%E5%AF%B9%E8%B1%A1%E5%85%A5%E9%97%A8/1.1-%E6%8A%BD%E8%B1%A1%E7%9A%84%E8%BF%9B%E6%AD%A5/>1.1 抽象的进步</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/01.%E5%AF%B9%E8%B1%A1%E5%85%A5%E9%97%A8/1.10-%E6%B0%B8%E4%B9%85%E6%80%A7/>1.10 永久性</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/01.%E5%AF%B9%E8%B1%A1%E5%85%A5%E9%97%A8/1.11-java%E5%92%8C%E5%9B%A0%E7%89%B9%E7%BD%91/>1.11 Java和因特网</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/01.%E5%AF%B9%E8%B1%A1%E5%85%A5%E9%97%A8/1.12-%E5%88%86%E6%9E%90%E5%92%8C%E8%AE%BE%E8%AE%A1/>1.12 分析和设计</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/01.%E5%AF%B9%E8%B1%A1%E5%85%A5%E9%97%A8/1.13-java%E8%BF%98%E6%98%AFc++/>1.13 Java还是C++</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/01.%E5%AF%B9%E8%B1%A1%E5%85%A5%E9%97%A8/1.2-%E5%AF%B9%E8%B1%A1%E7%9A%84%E6%8E%A5%E5%8F%A3/>1.2 对象的接口</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/01.%E5%AF%B9%E8%B1%A1%E5%85%A5%E9%97%A8/1.3-%E5%AE%9E%E7%8E%B0%E6%96%B9%E6%A1%88%E7%9A%84%E9%9A%90%E8%97%8F/>1.3 实现方案的隐藏</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/01.%E5%AF%B9%E8%B1%A1%E5%85%A5%E9%97%A8/1.4-%E6%96%B9%E6%A1%88%E7%9A%84%E9%87%8D%E5%A4%8D%E4%BD%BF%E7%94%A8/>1.4 方案的重复使用</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/01.%E5%AF%B9%E8%B1%A1%E5%85%A5%E9%97%A8/1.5-%E7%BB%A7%E6%89%BF%E9%87%8D%E6%96%B0%E4%BD%BF%E7%94%A8%E6%8E%A5%E5%8F%A3/>1.5 继承：重新使用接口</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/01.%E5%AF%B9%E8%B1%A1%E5%85%A5%E9%97%A8/1.6-%E5%A4%9A%E6%80%81%E5%AF%B9%E8%B1%A1%E7%9A%84%E4%BA%92%E6%8D%A2%E4%BD%BF%E7%94%A8/>1.6 多态对象的互换使用</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/01.%E5%AF%B9%E8%B1%A1%E5%85%A5%E9%97%A8/1.7-%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%88%9B%E5%BB%BA%E5%92%8C%E5%AD%98%E5%9C%A8%E6%97%B6%E9%97%B4/>1.7 对象的创建和存在时间</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/01.%E5%AF%B9%E8%B1%A1%E5%85%A5%E9%97%A8/1.9-%E5%A4%9A%E7%BA%BF%E7%A8%8B/>1.9 多线程</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-id6e74b2031f353ee0d7c0be1f38b16030")' href=#id6e74b2031f353ee0d7c0be1f38b16030 aria-expanded=false aria-controls=id6e74b2031f353ee0d7c0be1f38b16030 aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/02.%E4%B8%80%E5%88%87%E9%83%BD%E6%98%AF%E5%AF%B9%E8%B1%A1/>02.一切都是对象</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#id6e74b2031f353ee0d7c0be1f38b16030 aria-expanded=false aria-controls=id6e74b2031f353ee0d7c0be1f38b16030><i class="fa-solid fa-angle-right" id=caret-id6e74b2031f353ee0d7c0be1f38b16030></i></a></div><ul class="nav docs-sidenav collapse" id=id6e74b2031f353ee0d7c0be1f38b16030><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/02.%E4%B8%80%E5%88%87%E9%83%BD%E6%98%AF%E5%AF%B9%E8%B1%A1/2.1-%E7%94%A8%E6%8C%87%E9%92%88%E6%93%8D%E7%BA%B5%E5%AF%B9%E8%B1%A1/>2.1 用指针操纵对象</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/02.%E4%B8%80%E5%88%87%E9%83%BD%E6%98%AF%E5%AF%B9%E8%B1%A1/2.10-%E6%80%BB%E7%BB%93/>2.10 总结</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/02.%E4%B8%80%E5%88%87%E9%83%BD%E6%98%AF%E5%AF%B9%E8%B1%A1/2.11-%E7%BB%83%E4%B9%A0/>2.11 练习</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/02.%E4%B8%80%E5%88%87%E9%83%BD%E6%98%AF%E5%AF%B9%E8%B1%A1/2.2-%E6%89%80%E6%9C%89%E5%AF%B9%E8%B1%A1%E9%83%BD%E5%BF%85%E9%A1%BB%E5%88%9B%E5%BB%BA/>2.2 所有对象都必须创建</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/02.%E4%B8%80%E5%88%87%E9%83%BD%E6%98%AF%E5%AF%B9%E8%B1%A1/2.3-%E7%BB%9D%E5%AF%B9%E4%B8%8D%E8%A6%81%E6%B8%85%E9%99%A4%E5%AF%B9%E8%B1%A1/>2.3 绝对不要清除对象</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/02.%E4%B8%80%E5%88%87%E9%83%BD%E6%98%AF%E5%AF%B9%E8%B1%A1/2.4-%E6%96%B0%E5%BB%BA%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E7%B1%BB/>2.4 新建数据类型：类</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/02.%E4%B8%80%E5%88%87%E9%83%BD%E6%98%AF%E5%AF%B9%E8%B1%A1/2.5-%E6%96%B9%E6%B3%95%E8%87%AA%E5%8F%98%E9%87%8F%E5%92%8C%E8%BF%94%E5%9B%9E%E5%80%BC/>2.5 方法、自变量和返回值</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/02.%E4%B8%80%E5%88%87%E9%83%BD%E6%98%AF%E5%AF%B9%E8%B1%A1/2.6-%E6%9E%84%E5%BB%BAjava%E7%A8%8B%E5%BA%8F/>2.6 构建Java程序</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/02.%E4%B8%80%E5%88%87%E9%83%BD%E6%98%AF%E5%AF%B9%E8%B1%A1/2.7-%E6%88%91%E4%BB%AC%E7%9A%84%E7%AC%AC%E4%B8%80%E4%B8%AAjava%E7%A8%8B%E5%BA%8F/>2.7 我们的第一个Java程序</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/02.%E4%B8%80%E5%88%87%E9%83%BD%E6%98%AF%E5%AF%B9%E8%B1%A1/2.8-%E6%B3%A8%E9%87%8A%E5%92%8C%E5%B5%8C%E5%85%A5%E6%96%87%E6%A1%A3/>2.8 注释和嵌入文档</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/02.%E4%B8%80%E5%88%87%E9%83%BD%E6%98%AF%E5%AF%B9%E8%B1%A1/2.9-%E7%BC%96%E7%A0%81%E6%A0%B7%E5%BC%8F/>2.9 编码样式</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-id0b455eccb2d5251702c12cae8b51f71f")' href=#id0b455eccb2d5251702c12cae8b51f71f aria-expanded=false aria-controls=id0b455eccb2d5251702c12cae8b51f71f aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/03.%E6%8E%A7%E5%88%B6%E7%A8%8B%E5%BA%8F%E6%B5%81%E7%A8%8B/>03.控制程序流程</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#id0b455eccb2d5251702c12cae8b51f71f aria-expanded=false aria-controls=id0b455eccb2d5251702c12cae8b51f71f><i class="fa-solid fa-angle-right" id=caret-id0b455eccb2d5251702c12cae8b51f71f></i></a></div><ul class="nav docs-sidenav collapse" id=id0b455eccb2d5251702c12cae8b51f71f><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/03.%E6%8E%A7%E5%88%B6%E7%A8%8B%E5%BA%8F%E6%B5%81%E7%A8%8B/3.1-%E4%BD%BF%E7%94%A8java%E8%BF%90%E7%AE%97%E7%AC%A6/>3.1 使用Java运算符</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/03.%E6%8E%A7%E5%88%B6%E7%A8%8B%E5%BA%8F%E6%B5%81%E7%A8%8B/3.2-%E6%89%A7%E8%A1%8C%E6%8E%A7%E5%88%B6/>3.2 执行控制</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/03.%E6%8E%A7%E5%88%B6%E7%A8%8B%E5%BA%8F%E6%B5%81%E7%A8%8B/3.3-%E6%80%BB%E7%BB%93/>3.3 总结</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/03.%E6%8E%A7%E5%88%B6%E7%A8%8B%E5%BA%8F%E6%B5%81%E7%A8%8B/3.4-%E7%BB%83%E4%B9%A0/>3.4 练习</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-idc03315e84905a55e301cb35219ba082d")' href=#idc03315e84905a55e301cb35219ba082d aria-expanded=false aria-controls=idc03315e84905a55e301cb35219ba082d aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/04.%E5%88%9D%E5%A7%8B%E5%8C%96%E5%92%8C%E6%B8%85%E9%99%A4/>04.初始化和清除</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#idc03315e84905a55e301cb35219ba082d aria-expanded=false aria-controls=idc03315e84905a55e301cb35219ba082d><i class="fa-solid fa-angle-right" id=caret-idc03315e84905a55e301cb35219ba082d></i></a></div><ul class="nav docs-sidenav collapse" id=idc03315e84905a55e301cb35219ba082d><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/04.%E5%88%9D%E5%A7%8B%E5%8C%96%E5%92%8C%E6%B8%85%E9%99%A4/4.1-%E7%94%A8%E6%9E%84%E9%80%A0%E5%99%A8%E8%87%AA%E5%8A%A8%E5%88%9D%E5%A7%8B%E5%8C%96/>4.1 用构造器自动初始化</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/04.%E5%88%9D%E5%A7%8B%E5%8C%96%E5%92%8C%E6%B8%85%E9%99%A4/4.2-%E6%96%B9%E6%B3%95%E9%87%8D%E8%BD%BD/>4.2 方法重载</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/04.%E5%88%9D%E5%A7%8B%E5%8C%96%E5%92%8C%E6%B8%85%E9%99%A4/4.3-%E6%B8%85%E9%99%A4%E6%94%B6%E5%B0%BE%E5%92%8C%E5%9E%83%E5%9C%BE%E6%94%B6%E9%9B%86/>4.3 清除：收尾和垃圾收集</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/04.%E5%88%9D%E5%A7%8B%E5%8C%96%E5%92%8C%E6%B8%85%E9%99%A4/4.4-%E6%88%90%E5%91%98%E5%88%9D%E5%A7%8B%E5%8C%96/>4.4 成员初始化</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/04.%E5%88%9D%E5%A7%8B%E5%8C%96%E5%92%8C%E6%B8%85%E9%99%A4/4.5-%E6%95%B0%E7%BB%84%E5%88%9D%E5%A7%8B%E5%8C%96/>4.5 数组初始化</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/04.%E5%88%9D%E5%A7%8B%E5%8C%96%E5%92%8C%E6%B8%85%E9%99%A4/4.6-%E6%80%BB%E7%BB%93/>4.6 总结</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/04.%E5%88%9D%E5%A7%8B%E5%8C%96%E5%92%8C%E6%B8%85%E9%99%A4/4.7-%E7%BB%83%E4%B9%A0/>4.7 练习</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-id6fef31548d834cfab9ca7921ca0ffbc7")' href=#id6fef31548d834cfab9ca7921ca0ffbc7 aria-expanded=false aria-controls=id6fef31548d834cfab9ca7921ca0ffbc7 aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/05.%E9%9A%90%E8%97%8F%E5%AE%9E%E6%96%BD%E8%BF%87%E7%A8%8B/>05.隐藏实施过程</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#id6fef31548d834cfab9ca7921ca0ffbc7 aria-expanded=false aria-controls=id6fef31548d834cfab9ca7921ca0ffbc7><i class="fa-solid fa-angle-right" id=caret-id6fef31548d834cfab9ca7921ca0ffbc7></i></a></div><ul class="nav docs-sidenav collapse" id=id6fef31548d834cfab9ca7921ca0ffbc7><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/05.%E9%9A%90%E8%97%8F%E5%AE%9E%E6%96%BD%E8%BF%87%E7%A8%8B/5.1-%E5%8C%85%E5%BA%93%E5%8D%95%E5%85%83/>5.1 包：库单元</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/05.%E9%9A%90%E8%97%8F%E5%AE%9E%E6%96%BD%E8%BF%87%E7%A8%8B/5.2-java%E8%AE%BF%E9%97%AE%E6%8C%87%E7%A4%BA%E7%AC%A6/>5.2 Java访问指示符</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/05.%E9%9A%90%E8%97%8F%E5%AE%9E%E6%96%BD%E8%BF%87%E7%A8%8B/5.3-%E6%8E%A5%E5%8F%A3%E4%B8%8E%E5%AE%9E%E7%8E%B0/>5.3 接口与实现</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/05.%E9%9A%90%E8%97%8F%E5%AE%9E%E6%96%BD%E8%BF%87%E7%A8%8B/5.4-%E7%B1%BB%E8%AE%BF%E9%97%AE/>5.4 类访问</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/05.%E9%9A%90%E8%97%8F%E5%AE%9E%E6%96%BD%E8%BF%87%E7%A8%8B/5.5-%E6%80%BB%E7%BB%93/>5.5 总结</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/05.%E9%9A%90%E8%97%8F%E5%AE%9E%E6%96%BD%E8%BF%87%E7%A8%8B/5.6-%E7%BB%83%E4%B9%A0/>5.6 练习</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-id1e5c8731a846b682af97a54cf15b18cd")' href=#id1e5c8731a846b682af97a54cf15b18cd aria-expanded=false aria-controls=id1e5c8731a846b682af97a54cf15b18cd aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/06.%E7%B1%BB%E5%86%8D%E7%94%9F/>06.类再生</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#id1e5c8731a846b682af97a54cf15b18cd aria-expanded=false aria-controls=id1e5c8731a846b682af97a54cf15b18cd><i class="fa-solid fa-angle-right" id=caret-id1e5c8731a846b682af97a54cf15b18cd></i></a></div><ul class="nav docs-sidenav collapse" id=id1e5c8731a846b682af97a54cf15b18cd><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/06.%E7%B1%BB%E5%86%8D%E7%94%9F/6.1-%E5%90%88%E6%88%90%E7%9A%84%E8%AF%AD%E6%B3%95/>6.1 合成的语法</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/06.%E7%B1%BB%E5%86%8D%E7%94%9F/6.10-%E6%80%BB%E7%BB%93/>6.10 总结</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/06.%E7%B1%BB%E5%86%8D%E7%94%9F/6.11-%E7%BB%83%E4%B9%A0/>6.11 练习</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/06.%E7%B1%BB%E5%86%8D%E7%94%9F/6.2-%E7%BB%A7%E6%89%BF%E7%9A%84%E8%AF%AD%E6%B3%95/>6.2 继承的语法</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/06.%E7%B1%BB%E5%86%8D%E7%94%9F/6.3-%E5%90%88%E6%88%90%E4%B8%8E%E7%BB%A7%E6%89%BF%E7%9A%84%E7%BB%93%E5%90%88/>6.3 合成与继承的结合</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/06.%E7%B1%BB%E5%86%8D%E7%94%9F/6.4-%E5%88%B0%E5%BA%95%E9%80%89%E6%8B%A9%E5%90%88%E6%88%90%E8%BF%98%E6%98%AF%E7%BB%A7%E6%89%BF/>6.4 到底选择合成还是继承</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/06.%E7%B1%BB%E5%86%8D%E7%94%9F/6.5-protected/>6.5 protected</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/06.%E7%B1%BB%E5%86%8D%E7%94%9F/6.6-%E7%B4%AF%E7%A7%AF%E5%BC%80%E5%8F%91/>6.6 累积开发</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/06.%E7%B1%BB%E5%86%8D%E7%94%9F/6.7-%E4%B8%8A%E6%BA%AF%E9%80%A0%E5%9E%8B/>6.7 上溯造型</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/06.%E7%B1%BB%E5%86%8D%E7%94%9F/6.8-final%E5%85%B3%E9%94%AE%E5%AD%97/>6.8 final关键字</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/06.%E7%B1%BB%E5%86%8D%E7%94%9F/6.9-%E5%88%9D%E5%A7%8B%E5%8C%96%E5%92%8C%E7%B1%BB%E8%A3%85%E8%BD%BD/>6.9 初始化和类装载</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-id45922a3318a25b4e4144ca245e79e889")' href=#id45922a3318a25b4e4144ca245e79e889 aria-expanded=false aria-controls=id45922a3318a25b4e4144ca245e79e889 aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/07.%E5%A4%9A%E6%80%81%E6%80%A7/>07.多态性</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#id45922a3318a25b4e4144ca245e79e889 aria-expanded=false aria-controls=id45922a3318a25b4e4144ca245e79e889><i class="fa-solid fa-angle-right" id=caret-id45922a3318a25b4e4144ca245e79e889></i></a></div><ul class="nav docs-sidenav collapse" id=id45922a3318a25b4e4144ca245e79e889><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/07.%E5%A4%9A%E6%80%81%E6%80%A7/7.1-%E4%B8%8A%E6%BA%AF%E9%80%A0%E5%9E%8B/>7.1 上溯造型</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/07.%E5%A4%9A%E6%80%81%E6%80%A7/7.10-%E7%BB%83%E4%B9%A0/>7.10 练习</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/07.%E5%A4%9A%E6%80%81%E6%80%A7/7.2-%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3/>7.2 深入理解</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/07.%E5%A4%9A%E6%80%81%E6%80%A7/7.3-%E8%A6%86%E7%9B%96%E4%B8%8E%E9%87%8D%E8%BD%BD/>7.3 覆盖与重载</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/07.%E5%A4%9A%E6%80%81%E6%80%A7/7.4-%E6%8A%BD%E8%B1%A1%E7%B1%BB%E5%92%8C%E6%96%B9%E6%B3%95/>7.4 抽象类和方法</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/07.%E5%A4%9A%E6%80%81%E6%80%A7/7.5-%E6%8E%A5%E5%8F%A3/>7.5 接口</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/07.%E5%A4%9A%E6%80%81%E6%80%A7/7.6-%E5%86%85%E9%83%A8%E7%B1%BB/>7.6 内部类</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/07.%E5%A4%9A%E6%80%81%E6%80%A7/7.7-%E6%9E%84%E9%80%A0%E5%99%A8%E5%92%8C%E5%A4%9A%E6%80%81%E6%80%A7/>7.7 构造器和多态性</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/07.%E5%A4%9A%E6%80%81%E6%80%A7/7.8-%E9%80%9A%E8%BF%87%E7%BB%A7%E6%89%BF%E8%BF%9B%E8%A1%8C%E8%AE%BE%E8%AE%A1/>7.8 通过继承进行设计</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/07.%E5%A4%9A%E6%80%81%E6%80%A7/7.9-%E6%80%BB%E7%BB%93/>7.9 总结</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-id27abd1286c9d000b592443d2141c9a55")' href=#id27abd1286c9d000b592443d2141c9a55 aria-expanded=false aria-controls=id27abd1286c9d000b592443d2141c9a55 aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/08.%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%AE%B9%E7%BA%B3/>08.对象的容纳</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#id27abd1286c9d000b592443d2141c9a55 aria-expanded=false aria-controls=id27abd1286c9d000b592443d2141c9a55><i class="fa-solid fa-angle-right" id=caret-id27abd1286c9d000b592443d2141c9a55></i></a></div><ul class="nav docs-sidenav collapse" id=id27abd1286c9d000b592443d2141c9a55><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/08.%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%AE%B9%E7%BA%B3/8.1-%E6%95%B0%E7%BB%84/>8.1 数组</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/08.%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%AE%B9%E7%BA%B3/8.2-%E9%9B%86%E5%90%88/>8.2 集合</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/08.%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%AE%B9%E7%BA%B3/8.3-%E8%BF%AD%E4%BB%A3%E5%99%A8/>8.3 迭代器</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/08.%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%AE%B9%E7%BA%B3/8.4-%E9%9B%86%E5%90%88%E7%9A%84%E7%B1%BB%E5%9E%8B/>8.4 集合的类型</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/08.%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%AE%B9%E7%BA%B3/8.5-%E6%8E%92%E5%BA%8F/>8.5 排序</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/08.%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%AE%B9%E7%BA%B3/8.6-%E9%80%9A%E7%94%A8%E9%9B%86%E5%90%88%E5%BA%93/>8.6 通用集合库</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/08.%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%AE%B9%E7%BA%B3/8.7-%E6%96%B0%E9%9B%86%E5%90%88/>8.7 新集合</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/08.%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%AE%B9%E7%BA%B3/8.8-%E6%80%BB%E7%BB%93/>8.8 总结</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/08.%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%AE%B9%E7%BA%B3/8.9-%E7%BB%83%E4%B9%A0/>8.9 练习</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-id223a02026171e117fd7610f7a814d5db")' href=#id223a02026171e117fd7610f7a814d5db aria-expanded=false aria-controls=id223a02026171e117fd7610f7a814d5db aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/09.%E5%BC%82%E5%B8%B8%E5%B7%AE%E9%94%99%E6%8E%A7%E5%88%B6/>09.异常差错控制</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#id223a02026171e117fd7610f7a814d5db aria-expanded=false aria-controls=id223a02026171e117fd7610f7a814d5db><i class="fa-solid fa-angle-right" id=caret-id223a02026171e117fd7610f7a814d5db></i></a></div><ul class="nav docs-sidenav collapse" id=id223a02026171e117fd7610f7a814d5db><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/09.%E5%BC%82%E5%B8%B8%E5%B7%AE%E9%94%99%E6%8E%A7%E5%88%B6/9.10-%E7%BB%83%E4%B9%A0/>9.10 练习</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/09.%E5%BC%82%E5%B8%B8%E5%B7%AE%E9%94%99%E6%8E%A7%E5%88%B6/9.6-%E7%94%A8finally%E6%B8%85%E9%99%A4/>9.6 用finally清除</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/09.%E5%BC%82%E5%B8%B8%E5%B7%AE%E9%94%99%E6%8E%A7%E5%88%B6/9.7-%E6%9E%84%E9%80%A0%E5%99%A8/>9.7 构造器</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/09.%E5%BC%82%E5%B8%B8%E5%B7%AE%E9%94%99%E6%8E%A7%E5%88%B6/9.9-%E6%80%BB%E7%BB%93/>9.9 总结</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-idcac6e18458602ce17bd9b0b2c3e18daa")' href=#idcac6e18458602ce17bd9b0b2c3e18daa aria-expanded=false aria-controls=idcac6e18458602ce17bd9b0b2c3e18daa aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/10.java-io-%E7%B3%BB%E7%BB%9F/>10.Java IO 系统</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#idcac6e18458602ce17bd9b0b2c3e18daa aria-expanded=false aria-controls=idcac6e18458602ce17bd9b0b2c3e18daa><i class="fa-solid fa-angle-right" id=caret-idcac6e18458602ce17bd9b0b2c3e18daa></i></a></div><ul class="nav docs-sidenav collapse" id=idcac6e18458602ce17bd9b0b2c3e18daa><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/10.java-io-%E7%B3%BB%E7%BB%9F/10.1-%E8%BE%93%E5%85%A5%E5%92%8C%E8%BE%93%E5%87%BA/>10.1 输入和输出</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/10.java-io-%E7%B3%BB%E7%BB%9F/10.10-%E6%80%BB%E7%BB%93/>10.10 总结</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/10.java-io-%E7%B3%BB%E7%BB%9F/10.11-%E7%BB%83%E4%B9%A0/>10.11 练习</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/10.java-io-%E7%B3%BB%E7%BB%9F/10.2-%E5%A2%9E%E6%B7%BB%E5%B1%9E%E6%80%A7%E5%92%8C%E6%9C%89%E7%94%A8%E7%9A%84%E6%8E%A5%E5%8F%A3/>10.2 增添属性和有用的接口</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/10.java-io-%E7%B3%BB%E7%BB%9F/10.3-%E6%9C%AC%E8%BA%AB%E7%9A%84%E7%BC%BA%E9%99%B7randomaccessfile/>10.3 本身的缺陷：RandomAccessFile</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/10.java-io-%E7%B3%BB%E7%BB%9F/10.4-file%E7%B1%BB/>10.4 File类</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/10.java-io-%E7%B3%BB%E7%BB%9F/10.5-io%E6%B5%81%E7%9A%84%E5%85%B8%E5%9E%8B%E5%BA%94%E7%94%A8/>10.5 IO流的典型应用</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/10.java-io-%E7%B3%BB%E7%BB%9F/10.6-streamtokenizer/>10.6 StreamTokenizer</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/10.java-io-%E7%B3%BB%E7%BB%9F/10.7-java-1.1%E7%9A%84io%E6%B5%81/>10.7 Java 1.1的IO流</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/10.java-io-%E7%B3%BB%E7%BB%9F/10.8-%E5%8E%8B%E7%BC%A9/>10.8 压缩</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/10.java-io-%E7%B3%BB%E7%BB%9F/10.9-%E5%AF%B9%E8%B1%A1%E5%BA%8F%E5%88%97%E5%8C%96/>10.9 对象序列化</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-idfe15c0b7d69e1eea4a39a92683a168d4")' href=#idfe15c0b7d69e1eea4a39a92683a168d4 aria-expanded=false aria-controls=idfe15c0b7d69e1eea4a39a92683a168d4 aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/11.%E8%BF%90%E8%A1%8C%E6%9C%9F%E7%B1%BB%E5%9E%8B%E9%89%B4%E5%AE%9A/>11.运行期类型鉴定</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#idfe15c0b7d69e1eea4a39a92683a168d4 aria-expanded=false aria-controls=idfe15c0b7d69e1eea4a39a92683a168d4><i class="fa-solid fa-angle-right" id=caret-idfe15c0b7d69e1eea4a39a92683a168d4></i></a></div><ul class="nav docs-sidenav collapse" id=idfe15c0b7d69e1eea4a39a92683a168d4><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/11.%E8%BF%90%E8%A1%8C%E6%9C%9F%E7%B1%BB%E5%9E%8B%E9%89%B4%E5%AE%9A/11.1-%E5%AF%B9rtti%E7%9A%84%E9%9C%80%E8%A6%81/>11.1 对RTTI的需要</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/11.%E8%BF%90%E8%A1%8C%E6%9C%9F%E7%B1%BB%E5%9E%8B%E9%89%B4%E5%AE%9A/11.2-rtti-%E8%AF%AD%E6%B3%95/>11.2 RTTI 语法</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/11.%E8%BF%90%E8%A1%8C%E6%9C%9F%E7%B1%BB%E5%9E%8B%E9%89%B4%E5%AE%9A/11.3-%E5%8F%8D%E5%B0%84%E8%BF%90%E8%A1%8C%E6%9C%9F%E7%B1%BB%E4%BF%A1%E6%81%AF/>11.3 反射：运行期类信息</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/11.%E8%BF%90%E8%A1%8C%E6%9C%9F%E7%B1%BB%E5%9E%8B%E9%89%B4%E5%AE%9A/11.4-%E6%80%BB%E7%BB%93/>11.4 总结</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/11.%E8%BF%90%E8%A1%8C%E6%9C%9F%E7%B1%BB%E5%9E%8B%E9%89%B4%E5%AE%9A/11.5-%E7%BB%83%E4%B9%A0/>11.5 练习</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-iddf7cc690622f50701352bac88f5de264")' href=#iddf7cc690622f50701352bac88f5de264 aria-expanded=false aria-controls=iddf7cc690622f50701352bac88f5de264 aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/12.%E4%BC%A0%E9%80%92%E5%92%8C%E8%BF%94%E5%9B%9E%E5%AF%B9%E8%B1%A1/>12.传递和返回对象</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#iddf7cc690622f50701352bac88f5de264 aria-expanded=false aria-controls=iddf7cc690622f50701352bac88f5de264><i class="fa-solid fa-angle-right" id=caret-iddf7cc690622f50701352bac88f5de264></i></a></div><ul class="nav docs-sidenav collapse" id=iddf7cc690622f50701352bac88f5de264><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/12.%E4%BC%A0%E9%80%92%E5%92%8C%E8%BF%94%E5%9B%9E%E5%AF%B9%E8%B1%A1/12.1-%E4%BC%A0%E9%80%92%E6%8C%87%E9%92%88/>12.1 传递指针</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/12.%E4%BC%A0%E9%80%92%E5%92%8C%E8%BF%94%E5%9B%9E%E5%AF%B9%E8%B1%A1/12.2-%E5%88%B6%E4%BD%9C%E6%9C%AC%E5%9C%B0%E5%89%AF%E6%9C%AC/>12.2 制作本地副本</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/12.%E4%BC%A0%E9%80%92%E5%92%8C%E8%BF%94%E5%9B%9E%E5%AF%B9%E8%B1%A1/12.3-%E5%85%8B%E9%9A%86%E7%9A%84%E6%8E%A7%E5%88%B6/>12.3 克隆的控制</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/12.%E4%BC%A0%E9%80%92%E5%92%8C%E8%BF%94%E5%9B%9E%E5%AF%B9%E8%B1%A1/12.4-%E5%8F%AA%E8%AF%BB%E7%B1%BB/>12.4 只读类</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/12.%E4%BC%A0%E9%80%92%E5%92%8C%E8%BF%94%E5%9B%9E%E5%AF%B9%E8%B1%A1/12.5-%E6%80%BB%E7%BB%93/>12.5 总结</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/12.%E4%BC%A0%E9%80%92%E5%92%8C%E8%BF%94%E5%9B%9E%E5%AF%B9%E8%B1%A1/12.6-%E7%BB%83%E4%B9%A0/>12.6 练习</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-idb1a9edc38a9b424eca8c6736e315c5f2")' href=#idb1a9edc38a9b424eca8c6736e315c5f2 aria-expanded=false aria-controls=idb1a9edc38a9b424eca8c6736e315c5f2 aria-hidden=false data-toggle=collapse></div></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-id80c764609525f094184dd5b161c7244d")' href=#id80c764609525f094184dd5b161c7244d aria-expanded=false aria-controls=id80c764609525f094184dd5b161c7244d aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/14.%E5%A4%9A%E7%BA%BF%E7%A8%8B/>14.多线程</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#id80c764609525f094184dd5b161c7244d aria-expanded=false aria-controls=id80c764609525f094184dd5b161c7244d><i class="fa-solid fa-angle-right" id=caret-id80c764609525f094184dd5b161c7244d></i></a></div><ul class="nav docs-sidenav collapse" id=id80c764609525f094184dd5b161c7244d><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/14.%E5%A4%9A%E7%BA%BF%E7%A8%8B/14.1-%E5%8F%8D%E5%BA%94%E7%81%B5%E6%95%8F%E7%9A%84%E7%94%A8%E6%88%B7%E7%95%8C%E9%9D%A2/>14.1 反应灵敏的用户界面</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/14.%E5%A4%9A%E7%BA%BF%E7%A8%8B/14.2-%E5%85%B1%E4%BA%AB%E6%9C%89%E9%99%90%E7%9A%84%E8%B5%84%E6%BA%90/>14.2 共享有限的资源</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/14.%E5%A4%9A%E7%BA%BF%E7%A8%8B/14.3-%E5%A0%B5%E5%A1%9E/>14.3 堵塞</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/14.%E5%A4%9A%E7%BA%BF%E7%A8%8B/14.4-%E4%BC%98%E5%85%88%E7%BA%A7/>14.4 优先级</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/14.%E5%A4%9A%E7%BA%BF%E7%A8%8B/14.5-%E5%9B%9E%E9%A1%BErunnable/>14.5 回顾runnable</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/14.%E5%A4%9A%E7%BA%BF%E7%A8%8B/14.6-%E6%80%BB%E7%BB%93/>14.6 总结</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/14.%E5%A4%9A%E7%BA%BF%E7%A8%8B/14.7-%E7%BB%83%E4%B9%A0/>14.7 练习</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-id72c1a5699f783ea8a67f0eb1d1d396e1")' href=#id72c1a5699f783ea8a67f0eb1d1d396e1 aria-expanded=false aria-controls=id72c1a5699f783ea8a67f0eb1d1d396e1 aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/15.%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/>15.网络编程</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#id72c1a5699f783ea8a67f0eb1d1d396e1 aria-expanded=false aria-controls=id72c1a5699f783ea8a67f0eb1d1d396e1><i class="fa-solid fa-angle-right" id=caret-id72c1a5699f783ea8a67f0eb1d1d396e1></i></a></div><ul class="nav docs-sidenav collapse" id=id72c1a5699f783ea8a67f0eb1d1d396e1><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/15.%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/15.1-%E6%9C%BA%E5%99%A8%E7%9A%84%E6%A0%87%E8%AF%86/>15.1 机器的标识</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/15.%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/15.10-%E7%BB%83%E4%B9%A0/>15.10 练习</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/15.%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/15.2-%E5%A5%97%E6%8E%A5%E5%AD%97/>15.2 套接字</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/15.%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/15.3-%E6%9C%8D%E5%8A%A1%E5%A4%9A%E4%B8%AA%E5%AE%A2%E6%88%B7/>15.3 服务多个客户</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/15.%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/15.4-%E6%95%B0%E6%8D%AE%E6%8A%A5/>15.4 数据报</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/15.%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/15.5-%E4%B8%80%E4%B8%AAweb%E5%BA%94%E7%94%A8/>15.5 一个Web应用</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/15.%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/15.6-java%E4%B8%8Ecgi%E7%9A%84%E6%B2%9F%E9%80%9A/>15.6 Java与CGI的沟通</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/15.%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/15.7-%E7%94%A8jdbc%E8%BF%9E%E6%8E%A5%E6%95%B0%E6%8D%AE%E5%BA%93/>15.7 用JDBC连接数据库</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/15.%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/15.8-%E8%BF%9C%E7%A8%8B%E6%96%B9%E6%B3%95/>15.8 远程方法</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/15.%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/15.9-%E6%80%BB%E7%BB%93/>15.9 总结</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-idbee59bdc5aaf46677af95b12ea99ff64")' href=#idbee59bdc5aaf46677af95b12ea99ff64 aria-expanded=false aria-controls=idbee59bdc5aaf46677af95b12ea99ff64 aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/16.%E8%AE%BE%E8%AE%A1%E8%8C%83%E5%BC%8F/>16.设计范式</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#idbee59bdc5aaf46677af95b12ea99ff64 aria-expanded=false aria-controls=idbee59bdc5aaf46677af95b12ea99ff64><i class="fa-solid fa-angle-right" id=caret-idbee59bdc5aaf46677af95b12ea99ff64></i></a></div><ul class="nav docs-sidenav collapse" id=idbee59bdc5aaf46677af95b12ea99ff64><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/16.%E8%AE%BE%E8%AE%A1%E8%8C%83%E5%BC%8F/16.1-%E8%8C%83%E5%BC%8F%E7%9A%84%E6%A6%82%E5%BF%B5/>16.1 范式的概念</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/16.%E8%AE%BE%E8%AE%A1%E8%8C%83%E5%BC%8F/16.10-%E7%BB%83%E4%B9%A0/>16.10 练习</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/16.%E8%AE%BE%E8%AE%A1%E8%8C%83%E5%BC%8F/16.2-%E8%A7%82%E5%AF%9F%E5%99%A8%E8%8C%83%E5%BC%8F/>16.2 观察器范式</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/16.%E8%AE%BE%E8%AE%A1%E8%8C%83%E5%BC%8F/16.3-%E6%A8%A1%E6%8B%9F%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6%E7%AB%99/>16.3 模拟垃圾回收站</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/16.%E8%AE%BE%E8%AE%A1%E8%8C%83%E5%BC%8F/16.4-%E6%94%B9%E8%BF%9B%E8%AE%BE%E8%AE%A1/>16.4 改进设计</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/16.%E8%AE%BE%E8%AE%A1%E8%8C%83%E5%BC%8F/16.5-%E6%8A%BD%E8%B1%A1%E7%9A%84%E5%BA%94%E7%94%A8/>16.5 抽象的应用</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/16.%E8%AE%BE%E8%AE%A1%E8%8C%83%E5%BC%8F/16.6-%E5%A4%9A%E9%87%8D%E6%B4%BE%E9%81%A3/>16.6 多重派遣</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/16.%E8%AE%BE%E8%AE%A1%E8%8C%83%E5%BC%8F/16.7-%E8%AE%BF%E9%97%AE%E5%99%A8%E8%8C%83%E5%BC%8F/>16.7 访问器范式</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/16.%E8%AE%BE%E8%AE%A1%E8%8C%83%E5%BC%8F/16.8-rtti%E7%9C%9F%E7%9A%84%E6%9C%89%E5%AE%B3%E5%90%97/>16.8 RTTI真的有害吗</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/16.%E8%AE%BE%E8%AE%A1%E8%8C%83%E5%BC%8F/16.9-%E6%80%BB%E7%BB%93/>16.9 总结</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-ida6b4113de6e02470653070d2ebd17b83")' href=#ida6b4113de6e02470653070d2ebd17b83 aria-expanded=false aria-controls=ida6b4113de6e02470653070d2ebd17b83 aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/17.%E9%A1%B9%E7%9B%AE/>17.项目</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#ida6b4113de6e02470653070d2ebd17b83 aria-expanded=false aria-controls=ida6b4113de6e02470653070d2ebd17b83><i class="fa-solid fa-angle-right" id=caret-ida6b4113de6e02470653070d2ebd17b83></i></a></div><ul class="nav docs-sidenav collapse" id=ida6b4113de6e02470653070d2ebd17b83><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/17.%E9%A1%B9%E7%9B%AE/17.1-%E6%96%87%E5%AD%97%E5%A4%84%E7%90%86/>17.1 文字处理</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/17.%E9%A1%B9%E7%9B%AE/17.2-%E6%96%B9%E6%B3%95%E6%9F%A5%E6%89%BE%E5%B7%A5%E5%85%B7/>17.2 方法查找工具</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/17.%E9%A1%B9%E7%9B%AE/17.3-%E5%A4%8D%E6%9D%82%E6%80%A7%E7%90%86%E8%AE%BA/>17.3 复杂性理论</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/17.%E9%A1%B9%E7%9B%AE/17.4-%E6%80%BB%E7%BB%93/>17.4 总结</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/17.%E9%A1%B9%E7%9B%AE/17.5-%E7%BB%83%E4%B9%A0/>17.5 练习</a></li></ul></div><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/%E9%99%84%E5%BD%95a-%E4%BD%BF%E7%94%A8%E9%9D%9Ejava%E4%BB%A3%E7%A0%81/>附录A 使用非JAVA代码</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/%E9%99%84%E5%BD%95b-%E5%AF%B9%E6%AF%94c++%E5%92%8Cjava/>附录B 对比C++和Java</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/%E9%99%84%E5%BD%95c-java%E7%BC%96%E7%A8%8B%E8%A7%84%E5%88%99/>附录C Java编程规则</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/%E9%99%84%E5%BD%95d-%E6%80%A7%E8%83%BD/>附录D 性能</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/%E9%99%84%E5%BD%95e-%E5%85%B3%E4%BA%8E%E5%9E%83%E5%9C%BE%E6%94%B6%E9%9B%86%E7%9A%84%E4%B8%80%E4%BA%9B%E8%AF%9D/>附录E 关于垃圾收集的一些话</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/%E9%99%84%E5%BD%95f-%E6%8E%A8%E8%8D%90%E8%AF%BB%E7%89%A9/>附录F 推荐读物</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/%E5%86%99%E5%9C%A8%E5%89%8D%E9%9D%A2%E7%9A%84%E8%AF%9D/>写在前面的话</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/%E5%BC%95%E8%A8%80/>引言</a></li></ul></div></ul></div></nav></div><div class="d-none d-xl-block col-xl-2 docs-toc"><ul class="nav toc-top"><li><a href=# id=back_to_top class=docs-toc-title>目录</a></li></ul><nav id=TableOfContents><ul><li><a href=#基本-enum-特性>基本 enum 特性</a><ul><li><a href=#将静态类型导入用于-enum>将静态类型导入用于 enum</a></li></ul></li><li><a href=#方法添加>方法添加</a><ul><li><a href=#覆盖-enum-的方法>覆盖 enum 的方法</a></li></ul></li><li><a href=#switch-语句中的-enum>switch 语句中的 enum</a></li><li><a href=#values-方法的神秘之处>values 方法的神秘之处</a></li><li><a href=#实现而非继承>实现而非继承</a></li><li><a href=#随机选择>随机选择</a></li><li><a href=#使用接口组织枚举>使用接口组织枚举</a></li><li><a href=#使用-enumset-替代-flags>使用 EnumSet 替代 Flags</a></li><li><a href=#使用-enummap>使用 EnumMap</a></li><li><a href=#常量特定方法>常量特定方法</a><ul><li><a href=#使用-enum-的职责链>使用 enum 的职责链</a></li><li><a href=#使用-enum-的状态机>使用 enum 的状态机</a></li></ul></li><li><a href=#多路分发>多路分发</a><ul><li><a href=#使用-enum-分发>使用 enum 分发</a></li><li><a href=#使用常量相关的方法>使用常量相关的方法</a></li><li><a href=#使用-enummap-进行分发>使用 EnumMap 进行分发</a></li><li><a href=#使用二维数组>使用二维数组</a></li></ul></li><li><a href=#本章小结>本章小结</a></li></ul></nav><div class="subscribe-module col-24 mt-1"><img src=https://ngte-superbed.oss-cn-beijing.aliyuncs.com/item/20230220172727.png alt=image title=王下邀月熊的微信公众号></div></div><main class="py-md-3 pl-md-3 docs-content col-xl-8" role=main><article class=article><h1>22-Enumerations</h1><div class=article-style><h1 id=第二十二章-枚举>第二十二章 枚举</h1><blockquote><p>关键字 enum 可以将一组具名的值的有限集合创建为一种新的类型，而这些具名的值可以作为常规的程序组件使用。这是一种非常有用的功能</p></blockquote><p>在<a href>初始化和清理</a> 这章结束的时候，我们已经简单地介绍了枚举的概念。现在，你对 Java 已经有了更深刻的理解，因此可以更深入地学习 Java 中的枚举了。你将在本章中看到，使用 enum 可以做很多有趣的事情，同时，我们也会深入其他的 Java 特性，例如泛型和反射。在这个过程中，我们还将学习一些设计模式。</p><h2 id=基本-enum-特性>基本 enum 特性</h2><p>我们已经在<a href>初始化和清理</a> 这章章看到，调用 enum 的 values() 方法，可以遍历 enum 实例 .values() 方法返回 enum 实例的数组，而且该数组中的元素严格保持其在 enum 中声明时的顺序，因此你可以在循环中使用 values() 返回的数组。</p><p>创建 enum 时，编译器会为你生成一个相关的类，这个类继承自 Java.lang.Enum。下面的例子演示了 Enum 提供的一些功能：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// enums/EnumClass.java
</span></span></span><span class=line><span class=cl><span class=c1>// Capabilities of the Enum class
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>enum</span> <span class=n>Shrubbery</span> <span class=o>{</span> <span class=n>GROUND</span><span class=o>,</span> <span class=n>CRAWLING</span><span class=o>,</span> <span class=n>HANGING</span> <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>EnumClass</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span><span class=o>(</span><span class=n>Shrubbery</span> <span class=n>s</span> <span class=o>:</span> <span class=n>Shrubbery</span><span class=o>.</span><span class=na>values</span><span class=o>())</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span>
</span></span><span class=line><span class=cl>                    <span class=n>s</span> <span class=o>+</span> <span class=s>&#34; ordinal: &#34;</span> <span class=o>+</span> <span class=n>s</span><span class=o>.</span><span class=na>ordinal</span><span class=o>());</span>
</span></span><span class=line><span class=cl>            <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>print</span><span class=o>(</span>
</span></span><span class=line><span class=cl>                    <span class=n>s</span><span class=o>.</span><span class=na>compareTo</span><span class=o>(</span><span class=n>Shrubbery</span><span class=o>.</span><span class=na>CRAWLING</span><span class=o>)</span> <span class=o>+</span> <span class=s>&#34; &#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>            <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>print</span><span class=o>(</span>
</span></span><span class=line><span class=cl>                    <span class=n>s</span><span class=o>.</span><span class=na>equals</span><span class=o>(</span><span class=n>Shrubbery</span><span class=o>.</span><span class=na>CRAWLING</span><span class=o>)</span> <span class=o>+</span> <span class=s>&#34; &#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>            <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>s</span> <span class=o>==</span> <span class=n>Shrubbery</span><span class=o>.</span><span class=na>CRAWLING</span><span class=o>);</span>
</span></span><span class=line><span class=cl>            <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>s</span><span class=o>.</span><span class=na>getDeclaringClass</span><span class=o>());</span>
</span></span><span class=line><span class=cl>            <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>s</span><span class=o>.</span><span class=na>name</span><span class=o>());</span>
</span></span><span class=line><span class=cl>            <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;********************&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=c1>// Produce an enum value from a String name:
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>for</span><span class=o>(</span><span class=n>String</span> <span class=n>s</span> <span class=o>:</span>
</span></span><span class=line><span class=cl>                <span class=s>&#34;HANGING CRAWLING GROUND&#34;</span><span class=o>.</span><span class=na>split</span><span class=o>(</span><span class=s>&#34; &#34;</span><span class=o>))</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=n>Shrubbery</span> <span class=n>shrub</span> <span class=o>=</span>
</span></span><span class=line><span class=cl>                    <span class=n>Enum</span><span class=o>.</span><span class=na>valueOf</span><span class=o>(</span><span class=n>Shrubbery</span><span class=o>.</span><span class=na>class</span><span class=o>,</span> <span class=n>s</span><span class=o>);</span>
</span></span><span class=line><span class=cl>            <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>shrub</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>输出：</p><pre tabindex=0><code>GROUND ordinal: 0
-1 false false
class Shrubbery
GROUND
********************
CRAWLING ordinal: 1
0 true true
class Shrubbery
CRAWLING
********************
HANGING ordinal: 2
1 false false
class Shrubbery
HANGING
********************
HANGING
CRAWLING
GROUND
</code></pre><p>ordinal() 方法返回一个 int 值，这是每个 enum 实例在声明时的次序，从 0 开始。可以使用==来比较 enum 实例，编译器会自动为你提供 equals() 和 hashCode() 方法。Enum 类实现了 Comparable 接口，所以它具有 compareTo() 方法。同时，它还实现了 Serializable 接口。</p><p>如果在 enum 实例上调用 getDeclaringClass() 方法，我们就能知道其所属的 enum 类。</p><p>name() 方法返回 enum 实例声明时的名字，这与使用 toString() 方法效果相同。valueOf() 是在 Enum 中定义的 static 方法，它根据给定的名字返回相应的 enum 实例，如果不存在给定名字的实例，将会抛出异常。</p><h3 id=将静态类型导入用于-enum>将静态类型导入用于 enum</h3><p>先看一看 <a href>初始化和清理</a> 这章中 Burrito.java 的另一个版本：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// enums/SpicinessEnum.java
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>package</span> <span class=nn>enums</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>enum</span> <span class=n>SpicinessEnum</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>NOT</span><span class=o>,</span> <span class=n>MILD</span><span class=o>,</span> <span class=n>MEDIUM</span><span class=o>,</span> <span class=n>HOT</span><span class=o>,</span> <span class=n>FLAMING</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=c1>// enums/Burrito2.java
</span></span></span><span class=line><span class=cl><span class=c1>// {java enums.Burrito2}
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>package</span> <span class=nn>enums</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import static</span> <span class=nn>enums.SpicinessEnum.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>Burrito2</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>SpicinessEnum</span> <span class=n>degree</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=nf>Burrito2</span><span class=o>(</span><span class=n>SpicinessEnum</span> <span class=n>degree</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=o>.</span><span class=na>degree</span> <span class=o>=</span> <span class=n>degree</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>String</span> <span class=nf>toString</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=s>&#34;Burrito is &#34;</span><span class=o>+</span> <span class=n>degree</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=k>new</span> <span class=n>Burrito2</span><span class=o>(</span><span class=n>NOT</span><span class=o>));</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=k>new</span> <span class=n>Burrito2</span><span class=o>(</span><span class=n>MEDIUM</span><span class=o>));</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=k>new</span> <span class=n>Burrito2</span><span class=o>(</span><span class=n>HOT</span><span class=o>));</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>输出为：</p><pre tabindex=0><code>Burrito is NOT
Burrito is MEDIUM
Burrito is HOT
</code></pre><p>使用 static import 能够将 enum 实例的标识符带入当前的命名空间，所以无需再用 enum 类型来修饰 enum 实例。这是一个好的想法吗？或者还是显式地修饰 enum 实例更好？这要看代码的复杂程度了。编译器可以确保你使用的是正确的类型，所以唯一需要担心的是，使用静态导入会不会导致你的代码令人难以理解。多数情况下，使用 static import 还是有好处的，不过，程序员还是应该对具体情况进行具体分析。</p><p>注意，在定义 enum 的同一个文件中，这种技巧无法使用，如果是在默认包中定义 enum，这种技巧也无法使用（在 Sun 内部对这一点显然也有不同意见）。</p><h2 id=方法添加>方法添加</h2><p>除了不能继承自一个 enum 之外，我们基本上可以将 enum 看作一个常规的类。也就是说我们可以向 enum 中添加方法。enum 甚至可以有 main() 方法。</p><p>一般来说，我们希望每个枚举实例能够返回对自身的描述，而不仅仅只是默认的 toString() 实现，这只能返回枚举实例的名字。为此，你可以提供一个构造器，专门负责处理这个额外的信息，然后添加一个方法，返回这个描述信息。看一看下面的示例：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// enums/OzWitch.java
</span></span></span><span class=line><span class=cl><span class=c1>// The witches in the land of Oz
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>public</span> <span class=kd>enum</span> <span class=n>OzWitch</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// Instances must be defined first, before methods:
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>WEST</span><span class=o>(</span><span class=s>&#34;Miss Gulch, aka the Wicked Witch of the West&#34;</span><span class=o>),</span>
</span></span><span class=line><span class=cl>    <span class=n>NORTH</span><span class=o>(</span><span class=s>&#34;Glinda, the Good Witch of the North&#34;</span><span class=o>),</span>
</span></span><span class=line><span class=cl>    <span class=n>EAST</span><span class=o>(</span><span class=s>&#34;Wicked Witch of the East, wearer of the Ruby &#34;</span> <span class=o>+</span>
</span></span><span class=line><span class=cl>            <span class=s>&#34;Slippers, crushed by Dorothy&#39;s house&#34;</span><span class=o>),</span>
</span></span><span class=line><span class=cl>    <span class=n>SOUTH</span><span class=o>(</span><span class=s>&#34;Good by inference, but missing&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>String</span> <span class=n>description</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=c1>// Constructor must be package or private access:
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kd>private</span> <span class=nf>OzWitch</span><span class=o>(</span><span class=n>String</span> <span class=n>description</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=o>.</span><span class=na>description</span> <span class=o>=</span> <span class=n>description</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>String</span> <span class=nf>getDescription</span><span class=o>()</span> <span class=o>{</span> <span class=k>return</span> <span class=n>description</span><span class=o>;</span> <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span><span class=o>(</span><span class=n>OzWitch</span> <span class=n>witch</span> <span class=o>:</span> <span class=n>OzWitch</span><span class=o>.</span><span class=na>values</span><span class=o>())</span>
</span></span><span class=line><span class=cl>            <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span>
</span></span><span class=line><span class=cl>                    <span class=n>witch</span> <span class=o>+</span> <span class=s>&#34;: &#34;</span> <span class=o>+</span> <span class=n>witch</span><span class=o>.</span><span class=na>getDescription</span><span class=o>());</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>输出为：</p><pre tabindex=0><code>WEST: Miss Gulch, aka the Wicked Witch of the West
NORTH: Glinda, the Good Witch of the North
EAST: Wicked Witch of the East, wearer of the Ruby
Slippers, crushed by Dorothy&#39;s house
SOUTH: Good by inference, but missing
</code></pre><p>注意，如果你打算定义自己的方法，那么必须在 enum 实例序列的最后添加一个分号。同时，Java 要求你必须先定义 enum 实例。如果在定义 enum 实例之前定义了任何方法或属性，那么在编译时就会得到错误信息。</p><p>enum 中的构造器与方法和普通的类没有区别，因为除了有少许限制之外，enum 就是一个普通的类。所以，我们可以使用 enum 做许多事情（虽然，我们一般只使用普通的枚举类型）</p><p>在这个例子中，虽然我们有意识地将 enum 的构造器声明为 private，但对于它的可访问性而言，其实并没有什么变化，因为（即使不声明为 private）我们只能在 enum 定义的内部使用其构造器创建 enum 实例。一旦 enum 的定义结束，编译器就不允许我们再使用其构造器来创建任何实例了。</p><h3 id=覆盖-enum-的方法>覆盖 enum 的方法</h3><p>覆盖 toSring() 方法，给我们提供了另一种方式来为枚举实例生成不同的字符串描述信息。
在下面的示例中，我们使用的就是实例的名字，不过我们希望改变其格式。覆盖 enum 的 toSring() 方法与覆盖一般类的方法没有区别：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// enums/SpaceShip.java
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>import</span> <span class=nn>java.util.stream.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>enum</span> <span class=n>SpaceShip</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>SCOUT</span><span class=o>,</span> <span class=n>CARGO</span><span class=o>,</span> <span class=n>TRANSPORT</span><span class=o>,</span>
</span></span><span class=line><span class=cl>    <span class=n>CRUISER</span><span class=o>,</span> <span class=n>BATTLESHIP</span><span class=o>,</span> <span class=n>MOTHERSHIP</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>String</span> <span class=nf>toString</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>String</span> <span class=n>id</span> <span class=o>=</span> <span class=n>name</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=n>String</span> <span class=n>lower</span> <span class=o>=</span> <span class=n>id</span><span class=o>.</span><span class=na>substring</span><span class=o>(</span><span class=mi>1</span><span class=o>).</span><span class=na>toLowerCase</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>id</span><span class=o>.</span><span class=na>charAt</span><span class=o>(</span><span class=mi>0</span><span class=o>)</span> <span class=o>+</span> <span class=n>lower</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>Stream</span><span class=o>.</span><span class=na>of</span><span class=o>(</span><span class=n>values</span><span class=o>())</span>
</span></span><span class=line><span class=cl>                <span class=o>.</span><span class=na>forEach</span><span class=o>(</span><span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>::</span><span class=n>println</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>输出为：</p><pre tabindex=0><code>Scout
Cargo
Transport
Cruiser
Battleship
Mothership
</code></pre><p>toString() 方法通过调用 name() 方法取得 SpaceShip 的名字，然后将其修改为只有首字母大写的格式。</p><h2 id=switch-语句中的-enum>switch 语句中的 enum</h2><p>在 switch 中使用 enum，是 enum 提供的一项非常便利的功能。一般来说，在 switch 中只能使用整数值，而枚举实例天生就具备整数值的次序，并且可以通过 ordinal() 方法取得其次序（显然编译器帮我们做了类似的工作），因此我们可以在 switch 语句中使用 enum。</p><p>虽然一般情况下我们必须使用 enum 类型来修饰一个 enum 实例，但是在 case 语句中却不必如此。下面的例子使用 enum 构造了一个小型状态机：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// enums/TrafficLight.java
</span></span></span><span class=line><span class=cl><span class=c1>// Enums in switch statements
</span></span></span><span class=line><span class=cl><span class=c1>// Define an enum type:
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>enum</span> <span class=n>Signal</span> <span class=o>{</span> <span class=n>GREEN</span><span class=o>,</span> <span class=n>YELLOW</span><span class=o>,</span> <span class=n>RED</span><span class=o>,</span> <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>TrafficLight</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>Signal</span> <span class=n>color</span> <span class=o>=</span> <span class=n>Signal</span><span class=o>.</span><span class=na>RED</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>void</span> <span class=nf>change</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>switch</span><span class=o>(</span><span class=n>color</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>           <span class=c1>// Note you don&#39;t have to say Signal.RED
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=c1>// in the case statement:
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=k>case</span> <span class=n>RED</span><span class=o>:</span> <span class=n>color</span> <span class=o>=</span> <span class=n>Signal</span><span class=o>.</span><span class=na>GREEN</span><span class=o>;</span>
</span></span><span class=line><span class=cl>                <span class=k>break</span><span class=o>;</span>
</span></span><span class=line><span class=cl>            <span class=k>case</span> <span class=n>GREEN</span><span class=o>:</span> <span class=n>color</span> <span class=o>=</span> <span class=n>Signal</span><span class=o>.</span><span class=na>YELLOW</span><span class=o>;</span>
</span></span><span class=line><span class=cl>                <span class=k>break</span><span class=o>;</span>
</span></span><span class=line><span class=cl>            <span class=k>case</span> <span class=n>YELLOW</span><span class=o>:</span> <span class=n>color</span> <span class=o>=</span> <span class=n>Signal</span><span class=o>.</span><span class=na>RED</span><span class=o>;</span>
</span></span><span class=line><span class=cl>                <span class=k>break</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>String</span> <span class=nf>toString</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=s>&#34;The traffic light is &#34;</span> <span class=o>+</span> <span class=n>color</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>TrafficLight</span> <span class=n>t</span> <span class=o>=</span> <span class=k>new</span> <span class=n>TrafficLight</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span><span class=o>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=o>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=mi>7</span><span class=o>;</span> <span class=n>i</span><span class=o>++)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>t</span><span class=o>);</span>
</span></span><span class=line><span class=cl>            <span class=n>t</span><span class=o>.</span><span class=na>change</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>输出为：</p><pre tabindex=0><code>The traffic light is RED
The traffic light is GREEN
The traffic light is YELLOW
The traffic light is RED
The traffic light is GREEN
The traffic light is YELLOW
The traffic light is RED
</code></pre><p>编译器并没有抱怨 switch 中没有 default 语句，但这并不是因为每一个 Signal 都有对应的 case 语句。如果你注释掉其中的某个 case 语句，编译器同样不会抱怨什么。这意味着，你必须确保自己覆盖了所有的分支。但是，如果在 case 语句中调用 return，那么编译器就会抱怨缺少 default 语句了。这与是否覆盖了 enum 的所有实例无关。</p><h2 id=values-方法的神秘之处>values 方法的神秘之处</h2><p>前面已经提到，编译器为你创建的 enum 类都继承自 Enum 类。然而，如果你研究一下 Enum 类就会发现，它并没有 values() 方法。可我们明明已经用过该方法了，难道存在某种“隐藏的”方法吗？我们可以利用反射机制编写一个简单的程序，来查看其中的究竟：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// enums/Reflection.java
</span></span></span><span class=line><span class=cl><span class=c1>// Analyzing enums using reflection
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>import</span> <span class=nn>java.lang.reflect.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>java.util.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>onjava.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kd>enum</span> <span class=n>Explore</span> <span class=o>{</span> <span class=n>HERE</span><span class=o>,</span> <span class=n>THERE</span> <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>Reflection</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span>
</span></span><span class=line><span class=cl>    <span class=n>Set</span><span class=o>&lt;</span><span class=n>String</span><span class=o>&gt;</span> <span class=nf>analyze</span><span class=o>(</span><span class=n>Class</span><span class=o>&lt;?&gt;</span> <span class=n>enumClass</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span>
</span></span><span class=line><span class=cl>                <span class=s>&#34;_____ Analyzing &#34;</span> <span class=o>+</span> <span class=n>enumClass</span> <span class=o>+</span> <span class=s>&#34; _____&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;Interfaces:&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span><span class=o>(</span><span class=n>Type</span> <span class=n>t</span> <span class=o>:</span> <span class=n>enumClass</span><span class=o>.</span><span class=na>getGenericInterfaces</span><span class=o>())</span>
</span></span><span class=line><span class=cl>            <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>t</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span>
</span></span><span class=line><span class=cl>                <span class=s>&#34;Base: &#34;</span> <span class=o>+</span> <span class=n>enumClass</span><span class=o>.</span><span class=na>getSuperclass</span><span class=o>());</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;Methods: &#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>Set</span><span class=o>&lt;</span><span class=n>String</span><span class=o>&gt;</span> <span class=n>methods</span> <span class=o>=</span> <span class=k>new</span> <span class=n>TreeSet</span><span class=o>&lt;&gt;();</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span><span class=o>(</span><span class=n>Method</span> <span class=n>m</span> <span class=o>:</span> <span class=n>enumClass</span><span class=o>.</span><span class=na>getMethods</span><span class=o>())</span>
</span></span><span class=line><span class=cl>            <span class=n>methods</span><span class=o>.</span><span class=na>add</span><span class=o>(</span><span class=n>m</span><span class=o>.</span><span class=na>getName</span><span class=o>());</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>methods</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>methods</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>Set</span><span class=o>&lt;</span><span class=n>String</span><span class=o>&gt;</span> <span class=n>exploreMethods</span> <span class=o>=</span>
</span></span><span class=line><span class=cl>                <span class=n>analyze</span><span class=o>(</span><span class=n>Explore</span><span class=o>.</span><span class=na>class</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>Set</span><span class=o>&lt;</span><span class=n>String</span><span class=o>&gt;</span> <span class=n>enumMethods</span> <span class=o>=</span> <span class=n>analyze</span><span class=o>(</span><span class=n>Enum</span><span class=o>.</span><span class=na>class</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span>
</span></span><span class=line><span class=cl>                <span class=s>&#34;Explore.containsAll(Enum)? &#34;</span> <span class=o>+</span>
</span></span><span class=line><span class=cl>                        <span class=n>exploreMethods</span><span class=o>.</span><span class=na>containsAll</span><span class=o>(</span><span class=n>enumMethods</span><span class=o>));</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>print</span><span class=o>(</span><span class=s>&#34;Explore.removeAll(Enum): &#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>exploreMethods</span><span class=o>.</span><span class=na>removeAll</span><span class=o>(</span><span class=n>enumMethods</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>exploreMethods</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=c1>// Decompile the code for the enum:
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>OSExecute</span><span class=o>.</span><span class=na>command</span><span class=o>(</span>
</span></span><span class=line><span class=cl>                <span class=s>&#34;javap -cp build/classes/main Explore&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>输出为：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>_____</span> <span class=n>Analyzing</span> <span class=kd>class</span> <span class=nc>Explore</span> <span class=n>_____</span>
</span></span><span class=line><span class=cl><span class=nl>Interfaces:</span>
</span></span><span class=line><span class=cl><span class=nl>Base:</span> <span class=kd>class</span> <span class=nc>java</span><span class=o>.</span><span class=na>lang</span><span class=o>.</span><span class=na>Enum</span>
</span></span><span class=line><span class=cl><span class=nl>Methods:</span>
</span></span><span class=line><span class=cl><span class=o>[</span><span class=n>compareTo</span><span class=o>,</span> <span class=n>equals</span><span class=o>,</span> <span class=n>getClass</span><span class=o>,</span> <span class=n>getDeclaringClass</span><span class=o>,</span>
</span></span><span class=line><span class=cl><span class=n>hashCode</span><span class=o>,</span> <span class=n>name</span><span class=o>,</span> <span class=n>notify</span><span class=o>,</span> <span class=n>notifyAll</span><span class=o>,</span> <span class=n>ordinal</span><span class=o>,</span> <span class=n>toString</span><span class=o>,</span>
</span></span><span class=line><span class=cl><span class=n>valueOf</span><span class=o>,</span> <span class=n>values</span><span class=o>,</span> <span class=n>wait</span><span class=o>]</span>
</span></span><span class=line><span class=cl><span class=n>_____</span> <span class=n>Analyzing</span> <span class=kd>class</span> <span class=nc>java</span><span class=o>.</span><span class=na>lang</span><span class=o>.</span><span class=na>Enum</span> <span class=n>_____</span>
</span></span><span class=line><span class=cl><span class=nl>Interfaces:</span>
</span></span><span class=line><span class=cl><span class=n>java</span><span class=o>.</span><span class=na>lang</span><span class=o>.</span><span class=na>Comparable</span><span class=o>&lt;</span><span class=n>E</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=kd>interface</span> <span class=nc>java</span><span class=o>.</span><span class=na>io</span><span class=o>.</span><span class=na>Serializable</span>
</span></span><span class=line><span class=cl><span class=nl>Base:</span> <span class=kd>class</span> <span class=nc>java</span><span class=o>.</span><span class=na>lang</span><span class=o>.</span><span class=na>Object</span>
</span></span><span class=line><span class=cl><span class=nl>Methods:</span>
</span></span><span class=line><span class=cl><span class=o>[</span><span class=n>compareTo</span><span class=o>,</span> <span class=n>equals</span><span class=o>,</span> <span class=n>getClass</span><span class=o>,</span> <span class=n>getDeclaringClass</span><span class=o>,</span>
</span></span><span class=line><span class=cl><span class=n>hashCode</span><span class=o>,</span> <span class=n>name</span><span class=o>,</span> <span class=n>notify</span><span class=o>,</span> <span class=n>notifyAll</span><span class=o>,</span> <span class=n>ordinal</span><span class=o>,</span> <span class=n>toString</span><span class=o>,</span>
</span></span><span class=line><span class=cl><span class=n>valueOf</span><span class=o>,</span> <span class=n>wait</span><span class=o>]</span>
</span></span><span class=line><span class=cl><span class=n>Explore</span><span class=o>.</span><span class=na>containsAll</span><span class=o>(</span><span class=n>Enum</span><span class=o>)?</span> <span class=kc>true</span>
</span></span><span class=line><span class=cl><span class=n>Explore</span><span class=o>.</span><span class=na>removeAll</span><span class=o>(</span><span class=n>Enum</span><span class=o>):</span> <span class=o>[</span><span class=n>values</span><span class=o>]</span>
</span></span><span class=line><span class=cl><span class=n>Compiled</span> <span class=n>from</span> <span class=s>&#34;Reflection.java&#34;</span>
</span></span><span class=line><span class=cl><span class=kd>final</span> <span class=kd>class</span> <span class=nc>Explore</span> <span class=kd>extends</span> <span class=n>java</span><span class=o>.</span><span class=na>lang</span><span class=o>.</span><span class=na>Enum</span><span class=o>&lt;</span><span class=n>Explore</span><span class=o>&gt;</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>  <span class=kd>public</span> <span class=kd>static</span> <span class=kd>final</span> <span class=n>Explore</span> <span class=n>HERE</span><span class=o>;</span>
</span></span><span class=line><span class=cl>  <span class=kd>public</span> <span class=kd>static</span> <span class=kd>final</span> <span class=n>Explore</span> <span class=n>THERE</span><span class=o>;</span>
</span></span><span class=line><span class=cl>  <span class=kd>public</span> <span class=kd>static</span> <span class=n>Explore</span><span class=o>[]</span> <span class=nf>values</span><span class=o>();</span>
</span></span><span class=line><span class=cl>  <span class=kd>public</span> <span class=kd>static</span> <span class=n>Explore</span> <span class=nf>valueOf</span><span class=o>(</span><span class=n>java</span><span class=o>.</span><span class=na>lang</span><span class=o>.</span><span class=na>String</span><span class=o>);</span>
</span></span><span class=line><span class=cl>  <span class=kd>static</span> <span class=o>{};</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>答案是，values() 是由编译器添加的 static 方法。可以看出，在创建 Explore 的过程中，编译器还为其添加了 valueOf() 方法。这可能有点令人迷惑，Enum 类不是已经有 valueOf() 方法了吗。</p><p>不过 Enum 中的 valueOf() 方法需要两个参数，而这个新增的方法只需一个参数。由于这里使用的 Set 只存储方法的名字，而不考虑方法的签名，所以在调用 Explore.removeAll(Enum) 之后，就只剩下[values] 了。</p><p>从最后的输出中可以看到，编译器将 Explore 标记为 final 类，所以无法继承自 enum，其中还有一个 static 的初始化子句，稍后我们将学习如何重定义该句。</p><p>由于擦除效应（在<a href>泛型</a> 章节中介绍过），反编译无法得到 Enum 的完整信息，所以它展示的 Explore 的父类只是一个原始的 Enum，而非事实上的 Enum&lt;Explore>。</p><p>由于 values() 方法是由编译器插入到 enum 定义中的 static 方法，所以，如果你将 enum 实例向上转型为 Enum，那么 values() 方法就不可访问了。不过，在 Class 中有一个 getEnumConstants() 方法，所以即便 Enum 接口中没有 values() 方法，我们仍然可以通过 Class 对象取得所有 enum 实例。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// enums/UpcastEnum.java
</span></span></span><span class=line><span class=cl><span class=c1>// No values() method if you upcast an enum
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>enum</span> <span class=n>Search</span> <span class=o>{</span> <span class=n>HITHER</span><span class=o>,</span> <span class=n>YON</span> <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>UpcastEnum</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>Search</span><span class=o>[]</span> <span class=n>vals</span> <span class=o>=</span> <span class=n>Search</span><span class=o>.</span><span class=na>values</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=n>Enum</span> <span class=n>e</span> <span class=o>=</span> <span class=n>Search</span><span class=o>.</span><span class=na>HITHER</span><span class=o>;</span> <span class=c1>// Upcast
</span></span></span><span class=line><span class=cl><span class=c1>// e.values(); // No values() in Enum
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>for</span><span class=o>(</span><span class=n>Enum</span> <span class=n>en</span> <span class=o>:</span> <span class=n>e</span><span class=o>.</span><span class=na>getClass</span><span class=o>().</span><span class=na>getEnumConstants</span><span class=o>())</span>
</span></span><span class=line><span class=cl>            <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>en</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>输出为：</p><pre tabindex=0><code>HITHER
YON
</code></pre><p>因为 getEnumConstants() 是 Class 上的方法，所以你甚至可以对不是枚举的类调用此方法：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// enums/NonEnum.java
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>public</span> <span class=kd>class</span> <span class=nc>NonEnum</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>Class</span><span class=o>&lt;</span><span class=n>Integer</span><span class=o>&gt;</span> <span class=n>intClass</span> <span class=o>=</span> <span class=n>Integer</span><span class=o>.</span><span class=na>class</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span><span class=o>(</span><span class=n>Object</span> <span class=n>en</span> <span class=o>:</span> <span class=n>intClass</span><span class=o>.</span><span class=na>getEnumConstants</span><span class=o>())</span>
</span></span><span class=line><span class=cl>                <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>en</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span> <span class=k>catch</span><span class=o>(</span><span class=n>Exception</span> <span class=n>e</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;Expected: &#34;</span> <span class=o>+</span> <span class=n>e</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>输出为：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nl>Expected:</span> <span class=n>java</span><span class=o>.</span><span class=na>lang</span><span class=o>.</span><span class=na>NullPointerException</span>
</span></span></code></pre></div><p>只不过，此时该方法返回 null，所以当你试图使用其返回的结果时会发生异常。</p><h2 id=实现而非继承>实现而非继承</h2><p>我们已经知道，所有的 enum 都继承自 Java.lang.Enum 类。由于 Java 不支持多重继承，所以你的 enum 不能再继承其他类：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>enum</span> <span class=n>NotPossible</span> <span class=kd>extends</span> <span class=n>Pet</span> <span class=o>{</span> <span class=o>...</span> <span class=c1>// Won&#39;t work
</span></span></span></code></pre></div><p>然而，在我们创建一个新的 enum 时，可以同时实现一个或多个接口：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// enums/cartoons/EnumImplementation.java
</span></span></span><span class=line><span class=cl><span class=c1>// An enum can implement an interface
</span></span></span><span class=line><span class=cl><span class=c1>// {java enums.cartoons.EnumImplementation}
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>package</span> <span class=nn>enums.cartoons</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>java.util.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>java.util.function.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kd>enum</span> <span class=n>CartoonCharacter</span>
</span></span><span class=line><span class=cl>        <span class=kd>implements</span> <span class=n>Supplier</span><span class=o>&lt;</span><span class=n>CartoonCharacter</span><span class=o>&gt;</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>SLAPPY</span><span class=o>,</span> <span class=n>SPANKY</span><span class=o>,</span> <span class=n>PUNCHY</span><span class=o>,</span>
</span></span><span class=line><span class=cl>    <span class=n>SILLY</span><span class=o>,</span> <span class=n>BOUNCY</span><span class=o>,</span> <span class=n>NUTTY</span><span class=o>,</span> <span class=n>BOB</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>Random</span> <span class=n>rand</span> <span class=o>=</span>
</span></span><span class=line><span class=cl>            <span class=k>new</span> <span class=n>Random</span><span class=o>(</span><span class=mi>47</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>CartoonCharacter</span> <span class=nf>get</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>values</span><span class=o>()[</span><span class=n>rand</span><span class=o>.</span><span class=na>nextInt</span><span class=o>(</span><span class=n>values</span><span class=o>().</span><span class=na>length</span><span class=o>)];</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>EnumImplementation</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=o>&lt;</span><span class=n>T</span><span class=o>&gt;</span> <span class=kt>void</span> <span class=nf>printNext</span><span class=o>(</span><span class=n>Supplier</span><span class=o>&lt;</span><span class=n>T</span><span class=o>&gt;</span> <span class=n>rg</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>print</span><span class=o>(</span><span class=n>rg</span><span class=o>.</span><span class=na>get</span><span class=o>()</span> <span class=o>+</span> <span class=s>&#34;, &#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl><span class=c1>// Choose any instance:
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>CartoonCharacter</span> <span class=n>cc</span> <span class=o>=</span> <span class=n>CartoonCharacter</span><span class=o>.</span><span class=na>BOB</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span><span class=o>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=o>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=mi>10</span><span class=o>;</span> <span class=n>i</span><span class=o>++)</span>
</span></span><span class=line><span class=cl>            <span class=n>printNext</span><span class=o>(</span><span class=n>cc</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>输出为：</p><pre tabindex=0><code>BOB, PUNCHY, BOB, SPANKY, NUTTY, PUNCHY, SLAPPY, NUTTY,
NUTTY, SLAPPY,
</code></pre><p>这个结果有点奇怪，不过你必须要有一个 enum 实例才能调用其上的方法。现在，在任何接受 Supplier 参数的方法中，例如 printNext()，都可以使用 CartoonCharacter。</p><h2 id=随机选择>随机选择</h2><p>就像你在 CartoonCharacter.get() 中看到的那样，本章中的很多示例都需要从 enum 实例中进行随机选择。我们可以利用泛型，从而使得这个工作更一般化，并将其加入到我们的工具库中。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// onjava/Enums.java
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>package</span> <span class=nn>onjava</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>java.util.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>Enums</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kd>static</span> <span class=n>Random</span> <span class=n>rand</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Random</span><span class=o>(</span><span class=mi>47</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=o>&lt;</span><span class=n>T</span> <span class=kd>extends</span> <span class=n>Enum</span><span class=o>&lt;</span><span class=n>T</span><span class=o>&gt;&gt;</span> <span class=n>T</span> <span class=nf>random</span><span class=o>(</span><span class=n>Class</span><span class=o>&lt;</span><span class=n>T</span><span class=o>&gt;</span> <span class=n>ec</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>random</span><span class=o>(</span><span class=n>ec</span><span class=o>.</span><span class=na>getEnumConstants</span><span class=o>());</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=o>&lt;</span><span class=n>T</span><span class=o>&gt;</span> <span class=n>T</span> <span class=nf>random</span><span class=o>(</span><span class=n>T</span><span class=o>[]</span> <span class=n>values</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>values</span><span class=o>[</span><span class=n>rand</span><span class=o>.</span><span class=na>nextInt</span><span class=o>(</span><span class=n>values</span><span class=o>.</span><span class=na>length</span><span class=o>)];</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>古怪的语法&lt;T extends Enum&lt;T>> 表示 T 是一个 enum 实例。而将 Class&lt;T> 作为参数的话，我们就可以利用 Class 对象得到 enum 实例的数组了。重载后的 random() 方法只需使用 T[] 作为参数，因为它并不会调用 Enum 上的任何操作，它只需从数组中随机选择一个元素即可。这样，最终的返回类型正是 enum 的类型。</p><p>下面是 random() 方法的一个简单示例：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// enums/RandomTest.java
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>import</span> <span class=nn>onjava.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kd>enum</span> <span class=n>Activity</span> <span class=o>{</span> <span class=n>SITTING</span><span class=o>,</span> <span class=n>LYING</span><span class=o>,</span> <span class=n>STANDING</span><span class=o>,</span> <span class=n>HOPPING</span><span class=o>,</span>
</span></span><span class=line><span class=cl>    <span class=n>RUNNING</span><span class=o>,</span> <span class=n>DODGING</span><span class=o>,</span> <span class=n>JUMPING</span><span class=o>,</span> <span class=n>FALLING</span><span class=o>,</span> <span class=n>FLYING</span> <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>RandomTest</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span><span class=o>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=o>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=mi>20</span><span class=o>;</span> <span class=n>i</span><span class=o>++)</span>
</span></span><span class=line><span class=cl>            <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>print</span><span class=o>(</span>
</span></span><span class=line><span class=cl>                    <span class=n>Enums</span><span class=o>.</span><span class=na>random</span><span class=o>(</span><span class=n>Activity</span><span class=o>.</span><span class=na>class</span><span class=o>)</span> <span class=o>+</span> <span class=s>&#34; &#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>输出为：</p><pre tabindex=0><code>STANDING FLYING RUNNING STANDING RUNNING STANDING LYING
DODGING SITTING RUNNING HOPPING HOPPING HOPPING RUNNING
STANDING LYING FALLING RUNNING FLYING LYING
</code></pre><h2 id=使用接口组织枚举>使用接口组织枚举</h2><p>无法从 enum 继承子类有时很令人沮丧。这种需求有时源自我们希望扩展原 enum 中的元素，有时是因为我们希望使用子类将一个 enum 中的元素进行分组。</p><p>在一个接口的内部，创建实现该接口的枚举，以此将元素进行分组，可以达到将枚举元素分类组织的目的。举例来说，假设你想用 enum 来表示不同类别的食物，同时还希望每个 enum 元素仍然保持 Food 类型。那可以这样实现：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// enums/menu/Food.java
</span></span></span><span class=line><span class=cl><span class=c1>// Subcategorization of enums within interfaces
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>package</span> <span class=nn>enums.menu</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>interface</span> <span class=nc>Food</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>enum</span> <span class=n>Appetizer</span> <span class=kd>implements</span> <span class=n>Food</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>SALAD</span><span class=o>,</span> <span class=n>SOUP</span><span class=o>,</span> <span class=n>SPRING_ROLLS</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=kd>enum</span> <span class=n>MainCourse</span> <span class=kd>implements</span> <span class=n>Food</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>LASAGNE</span><span class=o>,</span> <span class=n>BURRITO</span><span class=o>,</span> <span class=n>PAD_THAI</span><span class=o>,</span>
</span></span><span class=line><span class=cl>        <span class=n>LENTILS</span><span class=o>,</span> <span class=n>HUMMOUS</span><span class=o>,</span> <span class=n>VINDALOO</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=kd>enum</span> <span class=n>Dessert</span> <span class=kd>implements</span> <span class=n>Food</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>TIRAMISU</span><span class=o>,</span> <span class=n>GELATO</span><span class=o>,</span> <span class=n>BLACK_FOREST_CAKE</span><span class=o>,</span>
</span></span><span class=line><span class=cl>        <span class=n>FRUIT</span><span class=o>,</span> <span class=n>CREME_CARAMEL</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=kd>enum</span> <span class=n>Coffee</span> <span class=kd>implements</span> <span class=n>Food</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>BLACK_COFFEE</span><span class=o>,</span> <span class=n>DECAF_COFFEE</span><span class=o>,</span> <span class=n>ESPRESSO</span><span class=o>,</span>
</span></span><span class=line><span class=cl>        <span class=n>LATTE</span><span class=o>,</span> <span class=n>CAPPUCCINO</span><span class=o>,</span> <span class=n>TEA</span><span class=o>,</span> <span class=n>HERB_TEA</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>对于 enum 而言，实现接口是使其子类化的唯一办法，所以嵌入在 Food 中的每个 enum 都实现了 Food 接口。现在，在下面的程序中，我们可以说“所有东西都是某种类型的 Food"。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// enums/menu/TypeOfFood.java
</span></span></span><span class=line><span class=cl><span class=c1>// {java enums.menu.TypeOfFood}
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>package</span> <span class=nn>enums.menu</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import static</span> <span class=nn>enums.menu.Food.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>TypeOfFood</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>Food</span> <span class=n>food</span> <span class=o>=</span> <span class=n>Appetizer</span><span class=o>.</span><span class=na>SALAD</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=n>food</span> <span class=o>=</span> <span class=n>MainCourse</span><span class=o>.</span><span class=na>LASAGNE</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=n>food</span> <span class=o>=</span> <span class=n>Dessert</span><span class=o>.</span><span class=na>GELATO</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=n>food</span> <span class=o>=</span> <span class=n>Coffee</span><span class=o>.</span><span class=na>CAPPUCCINO</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>如果 enum 类型实现了 Food 接口，那么我们就可以将其实例向上转型为 Food，所以上例中的所有东西都是 Food。</p><p>然而，当你需要与一大堆类型打交道时，接口就不如 enum 好用了。例如，如果你想创建一个“枚举的枚举”，那么可以创建一个新的 enum，然后用其实例包装 Food 中的每一个 enum 类：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// enums/menu/Course.java
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>package</span> <span class=nn>enums.menu</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>onjava.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>enum</span> <span class=n>Course</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>APPETIZER</span><span class=o>(</span><span class=n>Food</span><span class=o>.</span><span class=na>Appetizer</span><span class=o>.</span><span class=na>class</span><span class=o>),</span>
</span></span><span class=line><span class=cl>    <span class=n>MAINCOURSE</span><span class=o>(</span><span class=n>Food</span><span class=o>.</span><span class=na>MainCourse</span><span class=o>.</span><span class=na>class</span><span class=o>),</span>
</span></span><span class=line><span class=cl>    <span class=n>DESSERT</span><span class=o>(</span><span class=n>Food</span><span class=o>.</span><span class=na>Dessert</span><span class=o>.</span><span class=na>class</span><span class=o>),</span>
</span></span><span class=line><span class=cl>    <span class=n>COFFEE</span><span class=o>(</span><span class=n>Food</span><span class=o>.</span><span class=na>Coffee</span><span class=o>.</span><span class=na>class</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>Food</span><span class=o>[]</span> <span class=n>values</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=nf>Course</span><span class=o>(</span><span class=n>Class</span><span class=o>&lt;?</span> <span class=kd>extends</span> <span class=n>Food</span><span class=o>&gt;</span> <span class=n>kind</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>values</span> <span class=o>=</span> <span class=n>kind</span><span class=o>.</span><span class=na>getEnumConstants</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>Food</span> <span class=nf>randomSelection</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>Enums</span><span class=o>.</span><span class=na>random</span><span class=o>(</span><span class=n>values</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>每一个 Course 的实例都将其对应的 Class 对象作为构造器的参数。通过 getEnumConstants0 方法，可以从该 Class 对象中取得某个 Food 子类的所有 enum 实例。这些实例在 randomSelection() 中被用到。因此，通过从每一个 Course 实例中随机地选择一个 Food，我们便能够生成一份菜单：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// enums/menu/Meal.java
</span></span></span><span class=line><span class=cl><span class=c1>// {java enums.menu.Meal}
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>package</span> <span class=nn>enums.menu</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>Meal</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span><span class=o>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=o>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=mi>5</span><span class=o>;</span> <span class=n>i</span><span class=o>++)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span><span class=o>(</span><span class=n>Course</span> <span class=n>course</span> <span class=o>:</span> <span class=n>Course</span><span class=o>.</span><span class=na>values</span><span class=o>())</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                <span class=n>Food</span> <span class=n>food</span> <span class=o>=</span> <span class=n>course</span><span class=o>.</span><span class=na>randomSelection</span><span class=o>();</span>
</span></span><span class=line><span class=cl>                <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>food</span><span class=o>);</span>
</span></span><span class=line><span class=cl>            <span class=o>}</span>
</span></span><span class=line><span class=cl>            <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;***&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>输出为：</p><pre tabindex=0><code>SPRING_ROLLS
VINDALOO
FRUIT
DECAF_COFFEE
***
SOUP
VINDALOO
FRUIT
TEA
***
SALAD
BURRITO
FRUIT
TEA
***
SALAD
BURRITO
CREME_CARAMEL
LATTE
***
SOUP
BURRITO
TIRAMISU
ESPRESSO
***
</code></pre><p>在这个例子中，我们通过遍历每一个 Course 实例来获得“枚举的枚举”的值。稍后，在 VendingMachine.java 中，我们会看到另一种组织枚举实例的方式，但其也有一些其他的限制。</p><p>此外，还有一种更简洁的管理枚举的办法，就是将一个 enum 嵌套在另一个 enum 内。就像这样：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// enums/SecurityCategory.java
</span></span></span><span class=line><span class=cl><span class=c1>// More succinct subcategorization of enums
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>import</span> <span class=nn>onjava.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kd>enum</span> <span class=n>SecurityCategory</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>STOCK</span><span class=o>(</span><span class=n>Security</span><span class=o>.</span><span class=na>Stock</span><span class=o>.</span><span class=na>class</span><span class=o>),</span>
</span></span><span class=line><span class=cl>    <span class=n>BOND</span><span class=o>(</span><span class=n>Security</span><span class=o>.</span><span class=na>Bond</span><span class=o>.</span><span class=na>class</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>Security</span><span class=o>[]</span> <span class=n>values</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=n>SecurityCategory</span><span class=o>(</span><span class=n>Class</span><span class=o>&lt;?</span> <span class=kd>extends</span> <span class=n>Security</span><span class=o>&gt;</span> <span class=n>kind</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>values</span> <span class=o>=</span> <span class=n>kind</span><span class=o>.</span><span class=na>getEnumConstants</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=kd>interface</span> <span class=nc>Security</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=kd>enum</span> <span class=n>Stock</span> <span class=kd>implements</span> <span class=n>Security</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=n>SHORT</span><span class=o>,</span> <span class=n>LONG</span><span class=o>,</span> <span class=n>MARGIN</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=kd>enum</span> <span class=n>Bond</span> <span class=kd>implements</span> <span class=n>Security</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=n>MUNICIPAL</span><span class=o>,</span> <span class=n>JUNK</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>Security</span> <span class=nf>randomSelection</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>Enums</span><span class=o>.</span><span class=na>random</span><span class=o>(</span><span class=n>values</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span><span class=o>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=o>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=mi>10</span><span class=o>;</span> <span class=n>i</span><span class=o>++)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=n>SecurityCategory</span> <span class=n>category</span> <span class=o>=</span>
</span></span><span class=line><span class=cl>                    <span class=n>Enums</span><span class=o>.</span><span class=na>random</span><span class=o>(</span><span class=n>SecurityCategory</span><span class=o>.</span><span class=na>class</span><span class=o>);</span>
</span></span><span class=line><span class=cl>            <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>category</span> <span class=o>+</span> <span class=s>&#34;: &#34;</span> <span class=o>+</span>
</span></span><span class=line><span class=cl>                    <span class=n>category</span><span class=o>.</span><span class=na>randomSelection</span><span class=o>());</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>输出为：</p><pre tabindex=0><code>BOND: MUNICIPAL
BOND: MUNICIPAL
STOCK: MARGIN
STOCK: MARGIN
BOND: JUNK
STOCK: SHORT
STOCK: LONG
STOCK: LONG
BOND: MUNICIPAL
BOND: JUNK
</code></pre><p>Security 接口的作用是将其所包含的 enum 组合成一个公共类型，这一点是有必要的。然后，SecurityCategory 才能将 Security 中的 enum 作为其构造器的参数使用，以起到组织的效果。</p><p>如果我们将这种方式应用于 Food 的例子，结果应该这样：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// enums/menu/Meal2.java
</span></span></span><span class=line><span class=cl><span class=c1>// {java enums.menu.Meal2}
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>package</span> <span class=nn>enums.menu</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>onjava.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>enum</span> <span class=n>Meal2</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>APPETIZER</span><span class=o>(</span><span class=n>Food</span><span class=o>.</span><span class=na>Appetizer</span><span class=o>.</span><span class=na>class</span><span class=o>),</span>
</span></span><span class=line><span class=cl>    <span class=n>MAINCOURSE</span><span class=o>(</span><span class=n>Food</span><span class=o>.</span><span class=na>MainCourse</span><span class=o>.</span><span class=na>class</span><span class=o>),</span>
</span></span><span class=line><span class=cl>    <span class=n>DESSERT</span><span class=o>(</span><span class=n>Food</span><span class=o>.</span><span class=na>Dessert</span><span class=o>.</span><span class=na>class</span><span class=o>),</span>
</span></span><span class=line><span class=cl>    <span class=n>COFFEE</span><span class=o>(</span><span class=n>Food</span><span class=o>.</span><span class=na>Coffee</span><span class=o>.</span><span class=na>class</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>Food</span><span class=o>[]</span> <span class=n>values</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=nf>Meal2</span><span class=o>(</span><span class=n>Class</span><span class=o>&lt;?</span> <span class=kd>extends</span> <span class=n>Food</span><span class=o>&gt;</span> <span class=n>kind</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>values</span> <span class=o>=</span> <span class=n>kind</span><span class=o>.</span><span class=na>getEnumConstants</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>interface</span> <span class=nc>Food</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=kd>enum</span> <span class=n>Appetizer</span> <span class=kd>implements</span> <span class=n>Food</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=n>SALAD</span><span class=o>,</span> <span class=n>SOUP</span><span class=o>,</span> <span class=n>SPRING_ROLLS</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=kd>enum</span> <span class=n>MainCourse</span> <span class=kd>implements</span> <span class=n>Food</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=n>LASAGNE</span><span class=o>,</span> <span class=n>BURRITO</span><span class=o>,</span> <span class=n>PAD_THAI</span><span class=o>,</span>
</span></span><span class=line><span class=cl>            <span class=n>LENTILS</span><span class=o>,</span> <span class=n>HUMMOUS</span><span class=o>,</span> <span class=n>VINDALOO</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=kd>enum</span> <span class=n>Dessert</span> <span class=kd>implements</span> <span class=n>Food</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=n>TIRAMISU</span><span class=o>,</span> <span class=n>GELATO</span><span class=o>,</span> <span class=n>BLACK_FOREST_CAKE</span><span class=o>,</span>
</span></span><span class=line><span class=cl>            <span class=n>FRUIT</span><span class=o>,</span> <span class=n>CREME_CARAMEL</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=kd>enum</span> <span class=n>Coffee</span> <span class=kd>implements</span> <span class=n>Food</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=n>BLACK_COFFEE</span><span class=o>,</span> <span class=n>DECAF_COFFEE</span><span class=o>,</span> <span class=n>ESPRESSO</span><span class=o>,</span>
</span></span><span class=line><span class=cl>            <span class=n>LATTE</span><span class=o>,</span> <span class=n>CAPPUCCINO</span><span class=o>,</span> <span class=n>TEA</span><span class=o>,</span> <span class=n>HERB_TEA</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>Food</span> <span class=nf>randomSelection</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>Enums</span><span class=o>.</span><span class=na>random</span><span class=o>(</span><span class=n>values</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span><span class=o>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=o>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=mi>5</span><span class=o>;</span> <span class=n>i</span><span class=o>++)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span><span class=o>(</span><span class=n>Meal2</span> <span class=n>meal</span> <span class=o>:</span> <span class=n>Meal2</span><span class=o>.</span><span class=na>values</span><span class=o>())</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                <span class=n>Food</span> <span class=n>food</span> <span class=o>=</span> <span class=n>meal</span><span class=o>.</span><span class=na>randomSelection</span><span class=o>();</span>
</span></span><span class=line><span class=cl>                <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>food</span><span class=o>);</span>
</span></span><span class=line><span class=cl>            <span class=o>}</span>
</span></span><span class=line><span class=cl>            <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;***&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>输出为：</p><pre tabindex=0><code>SPRING_ROLLS
VINDALOO
FRUIT
DECAF_COFFEE
***
SOUP
VINDALOO
FRUIT
TEA
***
SALAD
BURRITO
FRUIT
TEA
***
SALAD
BURRITO
CREME_CARAMEL
LATTE
***
SOUP
BURRITO
TIRAMISU
ESPRESSO
***
</code></pre><p>其实，这仅仅是重新组织了一下代码，不过多数情况下，这种方式使你的代码具有更清晰的结构。</p><h2 id=使用-enumset-替代-flags>使用 EnumSet 替代 Flags</h2><p>Set 是一种集合，只能向其中添加不重复的对象。当然，enum 也要求其成员都是唯一的，所以 enum 看起来也具有集合的行为。不过，由于不能从 enum 中删除或添加元素，所以它只能算是不太有用的集合。Java SE5 引入 EnumSet，是为了通过 enum 创建一种替代品，以替代传统的基于 int 的“位标志”。这种标志可以用来表示某种“开/关”信息，不过，使用这种标志，我们最终操作的只是一些 bit，而不是这些 bit 想要表达的概念，因此很容易写出令人难以理解的代码。</p><p>EnumSet 的设计充分考虑到了速度因素，因为它必须与非常高效的 bit 标志相竞争（其操作与 HashSet 相比，非常地快），就其内部而言，它（可能）就是将一个 long 值作为比特向量，所以 EnumSet 非常快速高效。使用 EnumSet 的优点是，它在说明一个二进制位是否存在时，具有更好的表达能力，并且无需担心性能。</p><p>EnumSet 中的元素必须来自一个 enum。下面的 enum 表示在一座大楼中，警报传感器的安放位置：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// enums/AlarmPoints.java
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>package</span> <span class=nn>enums</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>enum</span> <span class=n>AlarmPoints</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>STAIR1</span><span class=o>,</span> <span class=n>STAIR2</span><span class=o>,</span> <span class=n>LOBBY</span><span class=o>,</span> <span class=n>OFFICE1</span><span class=o>,</span> <span class=n>OFFICE2</span><span class=o>,</span> <span class=n>OFFICE3</span><span class=o>,</span>
</span></span><span class=line><span class=cl>    <span class=n>OFFICE4</span><span class=o>,</span> <span class=n>BATHROOM</span><span class=o>,</span> <span class=n>UTILITY</span><span class=o>,</span> <span class=n>KITCHEN</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>然后，我们用 EnumSet 来跟踪报警器的状态：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// enums/EnumSets.java
</span></span></span><span class=line><span class=cl><span class=c1>// Operations on EnumSets
</span></span></span><span class=line><span class=cl><span class=c1>// {java enums.EnumSets}
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>package</span> <span class=nn>enums</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>java.util.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import static</span> <span class=nn>enums.AlarmPoints.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>EnumSets</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>EnumSet</span><span class=o>&lt;</span><span class=n>AlarmPoints</span><span class=o>&gt;</span> <span class=n>points</span> <span class=o>=</span>
</span></span><span class=line><span class=cl>                <span class=n>EnumSet</span><span class=o>.</span><span class=na>noneOf</span><span class=o>(</span><span class=n>AlarmPoints</span><span class=o>.</span><span class=na>class</span><span class=o>);</span> <span class=c1>// Empty
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>points</span><span class=o>.</span><span class=na>add</span><span class=o>(</span><span class=n>BATHROOM</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>points</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>points</span><span class=o>.</span><span class=na>addAll</span><span class=o>(</span>
</span></span><span class=line><span class=cl>                <span class=n>EnumSet</span><span class=o>.</span><span class=na>of</span><span class=o>(</span><span class=n>STAIR1</span><span class=o>,</span> <span class=n>STAIR2</span><span class=o>,</span> <span class=n>KITCHEN</span><span class=o>));</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>points</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>points</span> <span class=o>=</span> <span class=n>EnumSet</span><span class=o>.</span><span class=na>allOf</span><span class=o>(</span><span class=n>AlarmPoints</span><span class=o>.</span><span class=na>class</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>points</span><span class=o>.</span><span class=na>removeAll</span><span class=o>(</span>
</span></span><span class=line><span class=cl>                <span class=n>EnumSet</span><span class=o>.</span><span class=na>of</span><span class=o>(</span><span class=n>STAIR1</span><span class=o>,</span> <span class=n>STAIR2</span><span class=o>,</span> <span class=n>KITCHEN</span><span class=o>));</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>points</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>points</span><span class=o>.</span><span class=na>removeAll</span><span class=o>(</span>
</span></span><span class=line><span class=cl>                <span class=n>EnumSet</span><span class=o>.</span><span class=na>range</span><span class=o>(</span><span class=n>OFFICE1</span><span class=o>,</span> <span class=n>OFFICE4</span><span class=o>));</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>points</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>points</span> <span class=o>=</span> <span class=n>EnumSet</span><span class=o>.</span><span class=na>complementOf</span><span class=o>(</span><span class=n>points</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>points</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>输出为：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=o>[</span><span class=n>BATHROOM</span><span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>[</span><span class=n>STAIR1</span><span class=o>,</span> <span class=n>STAIR2</span><span class=o>,</span> <span class=n>BATHROOM</span><span class=o>,</span> <span class=n>KITCHEN</span><span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>[</span><span class=n>LOBBY</span><span class=o>,</span> <span class=n>OFFICE1</span><span class=o>,</span> <span class=n>OFFICE2</span><span class=o>,</span> <span class=n>OFFICE3</span><span class=o>,</span> <span class=n>OFFICE4</span><span class=o>,</span> <span class=n>BATHROOM</span><span class=o>,</span>
</span></span><span class=line><span class=cl><span class=n>UTILITY</span><span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>[</span><span class=n>LOBBY</span><span class=o>,</span> <span class=n>BATHROOM</span><span class=o>,</span> <span class=n>UTILITY</span><span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>[</span><span class=n>STAIR1</span><span class=o>,</span> <span class=n>STAIR2</span><span class=o>,</span> <span class=n>OFFICE1</span><span class=o>,</span> <span class=n>OFFICE2</span><span class=o>,</span> <span class=n>OFFICE3</span><span class=o>,</span> <span class=n>OFFICE4</span><span class=o>,</span>
</span></span><span class=line><span class=cl><span class=n>KITCHEN</span><span class=o>]</span>
</span></span></code></pre></div><p>使用 static import 可以简化 enum 常量的使用。EnumSet 的方法的名字都相当直观，你可以查阅 JDK 文档找到其完整详细的描述。如果仔细研究了 EnumSet 的文档，你还会发现 of() 方法被重载了很多次，不但为可变数量参数进行了重载，而且为接收 2 至 5 个显式的参数的情况都进行了重载。这也从侧面表现了 EnumSet 对性能的关注。因为，其实只使用单独的 of() 方法解决可变参数已经可以解决整个问题了，但是对比显式的参数，会有一点性能损失。采用现在这种设计，当你只使用 2 到 5 个参数调用 of() 方法时，你可以调用对应的重载过的方法（速度稍快一点），而当你使用一个参数或多过 5 个参数时，你调用的将是使用可变参数的 of() 方法。注意，如果你只使用一个参数，编译器并不会构造可变参数的数组，所以与调用只有一个参数的方法相比，也就不会有额外的性能损耗。</p><p>EnumSet 的基础是 long，一个 long 值有 64 位，而一个 enum 实例只需一位 bit 表示其是否存在。
也就是说，在不超过一个 long 的表达能力的情况下，你的 EnumSet 可以应用于最多不超过 64 个元素的 enum。如果 enum 超过了 64 个元素会发生什么呢？</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// enums/BigEnumSet.java
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>import</span> <span class=nn>java.util.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>BigEnumSet</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>enum</span> <span class=n>Big</span> <span class=o>{</span> <span class=n>A0</span><span class=o>,</span> <span class=n>A1</span><span class=o>,</span> <span class=n>A2</span><span class=o>,</span> <span class=n>A3</span><span class=o>,</span> <span class=n>A4</span><span class=o>,</span> <span class=n>A5</span><span class=o>,</span> <span class=n>A6</span><span class=o>,</span> <span class=n>A7</span><span class=o>,</span> <span class=n>A8</span><span class=o>,</span> <span class=n>A9</span><span class=o>,</span>
</span></span><span class=line><span class=cl>        <span class=n>A10</span><span class=o>,</span> <span class=n>A11</span><span class=o>,</span> <span class=n>A12</span><span class=o>,</span> <span class=n>A13</span><span class=o>,</span> <span class=n>A14</span><span class=o>,</span> <span class=n>A15</span><span class=o>,</span> <span class=n>A16</span><span class=o>,</span> <span class=n>A17</span><span class=o>,</span> <span class=n>A18</span><span class=o>,</span> <span class=n>A19</span><span class=o>,</span>
</span></span><span class=line><span class=cl>        <span class=n>A20</span><span class=o>,</span> <span class=n>A21</span><span class=o>,</span> <span class=n>A22</span><span class=o>,</span> <span class=n>A23</span><span class=o>,</span> <span class=n>A24</span><span class=o>,</span> <span class=n>A25</span><span class=o>,</span> <span class=n>A26</span><span class=o>,</span> <span class=n>A27</span><span class=o>,</span> <span class=n>A28</span><span class=o>,</span> <span class=n>A29</span><span class=o>,</span>
</span></span><span class=line><span class=cl>        <span class=n>A30</span><span class=o>,</span> <span class=n>A31</span><span class=o>,</span> <span class=n>A32</span><span class=o>,</span> <span class=n>A33</span><span class=o>,</span> <span class=n>A34</span><span class=o>,</span> <span class=n>A35</span><span class=o>,</span> <span class=n>A36</span><span class=o>,</span> <span class=n>A37</span><span class=o>,</span> <span class=n>A38</span><span class=o>,</span> <span class=n>A39</span><span class=o>,</span>
</span></span><span class=line><span class=cl>        <span class=n>A40</span><span class=o>,</span> <span class=n>A41</span><span class=o>,</span> <span class=n>A42</span><span class=o>,</span> <span class=n>A43</span><span class=o>,</span> <span class=n>A44</span><span class=o>,</span> <span class=n>A45</span><span class=o>,</span> <span class=n>A46</span><span class=o>,</span> <span class=n>A47</span><span class=o>,</span> <span class=n>A48</span><span class=o>,</span> <span class=n>A49</span><span class=o>,</span>
</span></span><span class=line><span class=cl>        <span class=n>A50</span><span class=o>,</span> <span class=n>A51</span><span class=o>,</span> <span class=n>A52</span><span class=o>,</span> <span class=n>A53</span><span class=o>,</span> <span class=n>A54</span><span class=o>,</span> <span class=n>A55</span><span class=o>,</span> <span class=n>A56</span><span class=o>,</span> <span class=n>A57</span><span class=o>,</span> <span class=n>A58</span><span class=o>,</span> <span class=n>A59</span><span class=o>,</span>
</span></span><span class=line><span class=cl>        <span class=n>A60</span><span class=o>,</span> <span class=n>A61</span><span class=o>,</span> <span class=n>A62</span><span class=o>,</span> <span class=n>A63</span><span class=o>,</span> <span class=n>A64</span><span class=o>,</span> <span class=n>A65</span><span class=o>,</span> <span class=n>A66</span><span class=o>,</span> <span class=n>A67</span><span class=o>,</span> <span class=n>A68</span><span class=o>,</span> <span class=n>A69</span><span class=o>,</span>
</span></span><span class=line><span class=cl>        <span class=n>A70</span><span class=o>,</span> <span class=n>A71</span><span class=o>,</span> <span class=n>A72</span><span class=o>,</span> <span class=n>A73</span><span class=o>,</span> <span class=n>A74</span><span class=o>,</span> <span class=n>A75</span> <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>EnumSet</span><span class=o>&lt;</span><span class=n>Big</span><span class=o>&gt;</span> <span class=n>bigEnumSet</span> <span class=o>=</span> <span class=n>EnumSet</span><span class=o>.</span><span class=na>allOf</span><span class=o>(</span><span class=n>Big</span><span class=o>.</span><span class=na>class</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>bigEnumSet</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>输出为：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=o>[</span><span class=n>A0</span><span class=o>,</span> <span class=n>A1</span><span class=o>,</span> <span class=n>A2</span><span class=o>,</span> <span class=n>A3</span><span class=o>,</span> <span class=n>A4</span><span class=o>,</span> <span class=n>A5</span><span class=o>,</span> <span class=n>A6</span><span class=o>,</span> <span class=n>A7</span><span class=o>,</span> <span class=n>A8</span><span class=o>,</span> <span class=n>A9</span><span class=o>,</span> <span class=n>A10</span><span class=o>,</span> <span class=n>A11</span><span class=o>,</span> <span class=n>A12</span><span class=o>,</span>
</span></span><span class=line><span class=cl><span class=n>A13</span><span class=o>,</span> <span class=n>A14</span><span class=o>,</span> <span class=n>A15</span><span class=o>,</span> <span class=n>A16</span><span class=o>,</span> <span class=n>A17</span><span class=o>,</span> <span class=n>A18</span><span class=o>,</span> <span class=n>A19</span><span class=o>,</span> <span class=n>A20</span><span class=o>,</span> <span class=n>A21</span><span class=o>,</span> <span class=n>A22</span><span class=o>,</span> <span class=n>A23</span><span class=o>,</span>
</span></span><span class=line><span class=cl><span class=n>A24</span><span class=o>,</span> <span class=n>A25</span><span class=o>,</span> <span class=n>A26</span><span class=o>,</span> <span class=n>A27</span><span class=o>,</span> <span class=n>A28</span><span class=o>,</span> <span class=n>A29</span><span class=o>,</span> <span class=n>A30</span><span class=o>,</span> <span class=n>A31</span><span class=o>,</span> <span class=n>A32</span><span class=o>,</span> <span class=n>A33</span><span class=o>,</span> <span class=n>A34</span><span class=o>,</span>
</span></span><span class=line><span class=cl><span class=n>A35</span><span class=o>,</span> <span class=n>A36</span><span class=o>,</span> <span class=n>A37</span><span class=o>,</span> <span class=n>A38</span><span class=o>,</span> <span class=n>A39</span><span class=o>,</span> <span class=n>A40</span><span class=o>,</span> <span class=n>A41</span><span class=o>,</span> <span class=n>A42</span><span class=o>,</span> <span class=n>A43</span><span class=o>,</span> <span class=n>A44</span><span class=o>,</span> <span class=n>A45</span><span class=o>,</span>
</span></span><span class=line><span class=cl><span class=n>A46</span><span class=o>,</span> <span class=n>A47</span><span class=o>,</span> <span class=n>A48</span><span class=o>,</span> <span class=n>A49</span><span class=o>,</span> <span class=n>A50</span><span class=o>,</span> <span class=n>A51</span><span class=o>,</span> <span class=n>A52</span><span class=o>,</span> <span class=n>A53</span><span class=o>,</span> <span class=n>A54</span><span class=o>,</span> <span class=n>A55</span><span class=o>,</span> <span class=n>A56</span><span class=o>,</span>
</span></span><span class=line><span class=cl><span class=n>A57</span><span class=o>,</span> <span class=n>A58</span><span class=o>,</span> <span class=n>A59</span><span class=o>,</span> <span class=n>A60</span><span class=o>,</span> <span class=n>A61</span><span class=o>,</span> <span class=n>A62</span><span class=o>,</span> <span class=n>A63</span><span class=o>,</span> <span class=n>A64</span><span class=o>,</span> <span class=n>A65</span><span class=o>,</span> <span class=n>A66</span><span class=o>,</span> <span class=n>A67</span><span class=o>,</span>
</span></span><span class=line><span class=cl><span class=n>A68</span><span class=o>,</span> <span class=n>A69</span><span class=o>,</span> <span class=n>A70</span><span class=o>,</span> <span class=n>A71</span><span class=o>,</span> <span class=n>A72</span><span class=o>,</span> <span class=n>A73</span><span class=o>,</span> <span class=n>A74</span><span class=o>,</span> <span class=n>A75</span><span class=o>]</span>
</span></span></code></pre></div><p>显然，EnumSet 可以应用于多过 64 个元素的 enum，所以我猜测，Enum 会在必要的时候增加一个 long。</p><h2 id=使用-enummap>使用 EnumMap</h2><p>EnumMap 是一种特殊的 Map，它要求其中的键（key）必须来自一个 enum，由于 enum 本身的限制，所以 EnumMap 在内部可由数组实现。因此 EnumMap 的速度很快，我们可以放心地使用 enum 实例在 EnumMap 中进行查找操作。不过，我们只能将 enum 的实例作为键来调用 put() 可方法，其他操作与使用一般的 Map 差不多。</p><p>下面的例子演示了<em>命令设计模式</em>的用法。一般来说，命令模式首先需要一个只有单一方法的接口，然后从该接口实现具有各自不同的行为的多个子类。接下来，程序员就可以构造命令对象，并在需要的时候使用它们了：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// enums/EnumMaps.java
</span></span></span><span class=line><span class=cl><span class=c1>// Basics of EnumMaps
</span></span></span><span class=line><span class=cl><span class=c1>// {java enums.EnumMaps}
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>package</span> <span class=nn>enums</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>java.util.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import static</span> <span class=nn>enums.AlarmPoints.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kd>interface</span> <span class=nc>Command</span> <span class=o>{</span> <span class=kt>void</span> <span class=nf>action</span><span class=o>();</span> <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>EnumMaps</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>EnumMap</span><span class=o>&lt;</span><span class=n>AlarmPoints</span><span class=o>,</span><span class=n>Command</span><span class=o>&gt;</span> <span class=n>em</span> <span class=o>=</span>
</span></span><span class=line><span class=cl>                <span class=k>new</span> <span class=n>EnumMap</span><span class=o>&lt;&gt;(</span><span class=n>AlarmPoints</span><span class=o>.</span><span class=na>class</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>em</span><span class=o>.</span><span class=na>put</span><span class=o>(</span><span class=n>KITCHEN</span><span class=o>,</span>
</span></span><span class=line><span class=cl>                <span class=o>()</span> <span class=o>-&gt;</span> <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;Kitchen fire!&#34;</span><span class=o>));</span>
</span></span><span class=line><span class=cl>        <span class=n>em</span><span class=o>.</span><span class=na>put</span><span class=o>(</span><span class=n>BATHROOM</span><span class=o>,</span>
</span></span><span class=line><span class=cl>                <span class=o>()</span> <span class=o>-&gt;</span> <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;Bathroom alert!&#34;</span><span class=o>));</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span><span class=o>(</span><span class=n>Map</span><span class=o>.</span><span class=na>Entry</span><span class=o>&lt;</span><span class=n>AlarmPoints</span><span class=o>,</span><span class=n>Command</span><span class=o>&gt;</span> <span class=n>e</span><span class=o>:</span>
</span></span><span class=line><span class=cl>                <span class=n>em</span><span class=o>.</span><span class=na>entrySet</span><span class=o>())</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>print</span><span class=o>(</span><span class=n>e</span><span class=o>.</span><span class=na>getKey</span><span class=o>()</span> <span class=o>+</span> <span class=s>&#34;: &#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>            <span class=n>e</span><span class=o>.</span><span class=na>getValue</span><span class=o>().</span><span class=na>action</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span> <span class=o>{</span> <span class=c1>// If there&#39;s no value for a particular key:
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=n>em</span><span class=o>.</span><span class=na>get</span><span class=o>(</span><span class=n>UTILITY</span><span class=o>).</span><span class=na>action</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span> <span class=k>catch</span><span class=o>(</span><span class=n>Exception</span> <span class=n>e</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;Expected: &#34;</span> <span class=o>+</span> <span class=n>e</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>输出为：</p><pre tabindex=0><code>BATHROOM: Bathroom alert!
KITCHEN: Kitchen fire!
Expected: java.lang.NullPointerException
</code></pre><p>与 EnumSet 一样，enum 实例定义时的次序决定了其在 EnumMap 中的顺序。</p><p>main() 方法的最后部分说明，enum 的每个实例作为一个键，总是存在的。但是，如果你没有为这个键调用 put() 方法来存入相应的值的话，其对应的值就是 null。</p><p>与常量相关的方法（constant-specific methods 将在下一节中介绍）相比，EnumMap 有一个优点，那 EnumMap 允许程序员改变值对象，而常量相关的方法在编译期就被固定了。稍后你会看到，在你有多种类型的 enum，而且它们之间存在互操作的情况下，我们可以用 EnumMap 实现多路分发（multiple dispatching）。</p><h2 id=常量特定方法>常量特定方法</h2><p>Java 的 enum 有一个非常有趣的特性，即它允许程序员为 enum 实例编写方法，从而为每个 enum 实例赋予各自不同的行为。要实现常量相关的方法，你需要为 enum 定义一个或多个 abstract 方法，然后为每个 enum 实例实现该抽象方法。参考下面的例子：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// enums/ConstantSpecificMethod.java
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>import</span> <span class=nn>java.util.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>java.text.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>enum</span> <span class=n>ConstantSpecificMethod</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>DATE_TIME</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>        <span class=n>String</span> <span class=nf>getInfo</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span>
</span></span><span class=line><span class=cl>                    <span class=n>DateFormat</span><span class=o>.</span><span class=na>getDateInstance</span><span class=o>()</span>
</span></span><span class=line><span class=cl>                            <span class=o>.</span><span class=na>format</span><span class=o>(</span><span class=k>new</span> <span class=n>Date</span><span class=o>());</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>},</span>
</span></span><span class=line><span class=cl>    <span class=n>CLASSPATH</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>        <span class=n>String</span> <span class=nf>getInfo</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>System</span><span class=o>.</span><span class=na>getenv</span><span class=o>(</span><span class=s>&#34;CLASSPATH&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>},</span>
</span></span><span class=line><span class=cl>    <span class=n>VERSION</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>        <span class=n>String</span> <span class=nf>getInfo</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>System</span><span class=o>.</span><span class=na>getProperty</span><span class=o>(</span><span class=s>&#34;java.version&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>};</span>
</span></span><span class=line><span class=cl>    <span class=kd>abstract</span> <span class=n>String</span> <span class=nf>getInfo</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span><span class=o>(</span><span class=n>ConstantSpecificMethod</span> <span class=n>csm</span> <span class=o>:</span> <span class=n>values</span><span class=o>())</span>
</span></span><span class=line><span class=cl>            <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>csm</span><span class=o>.</span><span class=na>getInfo</span><span class=o>());</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>输出为：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>May</span> <span class=mi>9</span><span class=o>,</span> <span class=mi>2017</span>
</span></span><span class=line><span class=cl><span class=nl>C:</span><span class=err>\</span><span class=n>Users</span><span class=err>\</span><span class=n>Bruce</span><span class=err>\</span><span class=n>Documents</span><span class=err>\</span><span class=n>GitHub</span><span class=err>\</span><span class=n>on</span><span class=o>-</span>
</span></span><span class=line><span class=cl><span class=n>java</span><span class=err>\</span><span class=n>ExtractedExamples</span><span class=err>\\</span><span class=n>gradle</span><span class=err>\</span><span class=n>wrapper</span><span class=err>\</span><span class=n>gradle</span><span class=o>-</span>
</span></span><span class=line><span class=cl><span class=n>wrapper</span><span class=o>.</span><span class=na>jar</span>
</span></span><span class=line><span class=cl><span class=mf>1.8.0_112</span>
</span></span></code></pre></div><p>通过相应的 enum 实例，我们可以调用其上的方法。这通常也称为表驱动的代码（table-driven code，请注意它与前面提到的命令模式的相似之处）。</p><p>在面向对象的程序设计中，不同的行为与不同的类关联。而通过常量相关的方法，每个 enum 实例可以具备自己独特的行为，这似乎说明每个 enum 实例就像一个独特的类。在上面的例子中，enum 实例似乎被当作其“超类”ConstantSpecificMethod 来使用，在调用 getInfo() 方法时，体现出多态的行为。</p><p>然而，enum 实例与类的相似之处也仅限于此了。我们并不能真的将 enum 实例作为一个类型来使用：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// enums/NotClasses.java
</span></span></span><span class=line><span class=cl><span class=c1>// {javap -c LikeClasses}
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>enum</span> <span class=n>LikeClasses</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>WINKEN</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>        <span class=kt>void</span> <span class=nf>behavior</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;Behavior1&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>},</span>
</span></span><span class=line><span class=cl>    <span class=n>BLINKEN</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>        <span class=kt>void</span> <span class=nf>behavior</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;Behavior2&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>},</span>
</span></span><span class=line><span class=cl>    <span class=n>NOD</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>        <span class=kt>void</span> <span class=nf>behavior</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;Behavior3&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>};</span>
</span></span><span class=line><span class=cl>    <span class=kd>abstract</span> <span class=kt>void</span> <span class=nf>behavior</span><span class=o>();</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>NotClasses</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// void f1(LikeClasses.WINKEN instance) {} // Nope
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=o>}</span>
</span></span></code></pre></div><p>输出为（前 12 行）：</p><pre tabindex=0><code>Compiled from &#34;NotClasses.java&#34;
abstract class LikeClasses extends
java.lang.Enum&lt;LikeClasses&gt; {
public static final LikeClasses WINKEN;
public static final LikeClasses BLINKEN;
public static final LikeClasses NOD;
public static LikeClasses[] values();
Code:
0: getstatic #2 // Field
$VALUES:[LLikeClasses;
3: invokevirtual #3 // Method
&#34;[LLikeClasses;&#34;.clone:()Ljava/lang/Object;
...
</code></pre><p>在方法 f1() 中，编译器不允许我们将一个 enum 实例当作 class 类型。如果我们分析一下编译器生成的代码，就知道这种行为也是很正常的。因为每个 enum 元素都是一个 LikeClasses 类型的 static final 实例。</p><p>同时，由于它们是 static 实例，无法访问外部类的非 static 元素或方法，所以对于内部的 enum 的实例而言，其行为与一般的内部类并不相同。</p><p>再看一个更有趣的关于洗车的例子。每个顾客在洗车时，都有一个选择菜单，每个选择对应一个不同的动作。可以将一个常量相关的方法关联到一个选择上，再使用一个 EnumSet 来保存客户的选择：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// enums/CarWash.java
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>import</span> <span class=nn>java.util.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>CarWash</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>enum</span> <span class=n>Cycle</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>UNDERBODY</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>            <span class=kt>void</span> <span class=nf>action</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;Spraying the underbody&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>            <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=o>},</span>
</span></span><span class=line><span class=cl>        <span class=n>WHEELWASH</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>            <span class=kt>void</span> <span class=nf>action</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;Washing the wheels&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>            <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=o>},</span>
</span></span><span class=line><span class=cl>        <span class=n>PREWASH</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>            <span class=kt>void</span> <span class=nf>action</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;Loosening the dirt&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>            <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=o>},</span>
</span></span><span class=line><span class=cl>        <span class=n>BASIC</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>            <span class=kt>void</span> <span class=nf>action</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;The basic wash&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>            <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=o>},</span>
</span></span><span class=line><span class=cl>        <span class=n>HOTWAX</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>            <span class=kt>void</span> <span class=nf>action</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;Applying hot wax&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>            <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=o>},</span>
</span></span><span class=line><span class=cl>        <span class=n>RINSE</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>            <span class=kt>void</span> <span class=nf>action</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;Rinsing&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>            <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=o>},</span>
</span></span><span class=line><span class=cl>        <span class=n>BLOWDRY</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>            <span class=kt>void</span> <span class=nf>action</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;Blowing dry&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>            <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=o>};</span>
</span></span><span class=line><span class=cl>        <span class=kd>abstract</span> <span class=kt>void</span> <span class=nf>action</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=n>EnumSet</span><span class=o>&lt;</span><span class=n>Cycle</span><span class=o>&gt;</span> <span class=n>cycles</span> <span class=o>=</span>
</span></span><span class=line><span class=cl>            <span class=n>EnumSet</span><span class=o>.</span><span class=na>of</span><span class=o>(</span><span class=n>Cycle</span><span class=o>.</span><span class=na>BASIC</span><span class=o>,</span> <span class=n>Cycle</span><span class=o>.</span><span class=na>RINSE</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>void</span> <span class=nf>add</span><span class=o>(</span><span class=n>Cycle</span> <span class=n>cycle</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>cycles</span><span class=o>.</span><span class=na>add</span><span class=o>(</span><span class=n>cycle</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>void</span> <span class=nf>washCar</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span><span class=o>(</span><span class=n>Cycle</span> <span class=n>c</span> <span class=o>:</span> <span class=n>cycles</span><span class=o>)</span>
</span></span><span class=line><span class=cl>            <span class=n>c</span><span class=o>.</span><span class=na>action</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>String</span> <span class=nf>toString</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>cycles</span><span class=o>.</span><span class=na>toString</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>CarWash</span> <span class=n>wash</span> <span class=o>=</span> <span class=k>new</span> <span class=n>CarWash</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>wash</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>wash</span><span class=o>.</span><span class=na>washCar</span><span class=o>();</span>
</span></span><span class=line><span class=cl><span class=c1>// Order of addition is unimportant:
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>wash</span><span class=o>.</span><span class=na>add</span><span class=o>(</span><span class=n>Cycle</span><span class=o>.</span><span class=na>BLOWDRY</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>wash</span><span class=o>.</span><span class=na>add</span><span class=o>(</span><span class=n>Cycle</span><span class=o>.</span><span class=na>BLOWDRY</span><span class=o>);</span> <span class=c1>// Duplicates ignored
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>wash</span><span class=o>.</span><span class=na>add</span><span class=o>(</span><span class=n>Cycle</span><span class=o>.</span><span class=na>RINSE</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>wash</span><span class=o>.</span><span class=na>add</span><span class=o>(</span><span class=n>Cycle</span><span class=o>.</span><span class=na>HOTWAX</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>wash</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>wash</span><span class=o>.</span><span class=na>washCar</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>输出为：</p><pre tabindex=0><code>[BASIC, RINSE]
The basic wash
Rinsing
[BASIC, HOTWAX, RINSE, BLOWDRY]
The basic wash
Applying hot wax
Rinsing
Blowing dry
</code></pre><p>与使用匿名内部类相比较，定义常量相关方法的语法更高效、简洁。</p><p>这个例子也展示了 EnumSet 了一些特性。因为它是一个集合，所以对于同一个元素而言，只能出现一次，因此对同一个参数重复地调用 add0 方法会被忽略掉（这是正确的行为，因为一个 bit 位开关只能“打开”一次），同样地，向 EnumSet 添加 enum 实例的顺序并不重要，因为其输出的次序决定于 enum 实例定义时的次序。</p><p>除了实现 abstract 方法以外，程序员是否可以覆盖常量相关的方法呢？答案是肯定的，参考下面的程序：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// enums/OverrideConstantSpecific.java
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>public</span> <span class=kd>enum</span> <span class=n>OverrideConstantSpecific</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>NUT</span><span class=o>,</span> <span class=n>BOLT</span><span class=o>,</span>
</span></span><span class=line><span class=cl>    <span class=n>WASHER</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>        <span class=kt>void</span> <span class=nf>f</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;Overridden method&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>};</span>
</span></span><span class=line><span class=cl>    <span class=kt>void</span> <span class=nf>f</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;default behavior&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span><span class=o>(</span><span class=n>OverrideConstantSpecific</span> <span class=n>ocs</span> <span class=o>:</span> <span class=n>values</span><span class=o>())</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>print</span><span class=o>(</span><span class=n>ocs</span> <span class=o>+</span> <span class=s>&#34;: &#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>            <span class=n>ocs</span><span class=o>.</span><span class=na>f</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>输出为：</p><pre tabindex=0><code>NUT: default behavior
BOLT: default behavior
WASHER: Overridden method
</code></pre><p>虽然 enum 有某些限制，但是一般而言，我们还是可以将其看作是类。</p><h3 id=使用-enum-的职责链>使用 enum 的职责链</h3><p>在职责链（Chain of Responsibility）设计模式中，程序员以多种不同的方式来解决一个问题，然后将它们链接在一起。当一个请求到来时，它遍历这个链，直到链中的某个解决方案能够处理该请求。</p><p>通过常量相关的方法，我们可以很容易地实现一个简单的职责链。我们以一个邮局的模型为例。邮局需要以尽可能通用的方式来处理每一封邮件，并且要不断尝试处理邮件，直到该邮件最终被确定为一封死信。其中的每一次尝试可以看作为一个策略（也是一个设计模式），而完整的处理方式列表就是一个职责链。</p><p>我们先来描述一下邮件。邮件的每个关键特征都可以用 enum 来表示。程序将随机地生成 Mail 对象，如果要减小一封邮件的 GeneralDelivery 为 YES 的概率，那最简单的方法就是多创建几个不是 YES 的 enum 实例，所以 enum 的定义看起来有点古怪。</p><p>我们看到 Mail 中有一个 randomMail() 方法，它负责随机地创建用于测试的邮件。而 generator() 方法生成一个 Iterable 对象，该对象在你调用 next() 方法时，在其内部使用 randomMail() 来创建 Mail 对象。这样的结构使程序员可以通过调用 Mail.generator() 方法，很容易地构造出一个 foreach 循环：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// enums/PostOffice.java
</span></span></span><span class=line><span class=cl><span class=c1>// Modeling a post office
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>import</span> <span class=nn>java.util.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>onjava.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kd>class</span> <span class=nc>Mail</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// The NO&#39;s reduce probability of random selection:
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kd>enum</span> <span class=n>GeneralDelivery</span> <span class=o>{</span><span class=n>YES</span><span class=o>,</span><span class=n>NO1</span><span class=o>,</span><span class=n>NO2</span><span class=o>,</span><span class=n>NO3</span><span class=o>,</span><span class=n>NO4</span><span class=o>,</span><span class=n>NO5</span><span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=kd>enum</span> <span class=n>Scannability</span> <span class=o>{</span><span class=n>UNSCANNABLE</span><span class=o>,</span><span class=n>YES1</span><span class=o>,</span><span class=n>YES2</span><span class=o>,</span><span class=n>YES3</span><span class=o>,</span><span class=n>YES4</span><span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=kd>enum</span> <span class=n>Readability</span> <span class=o>{</span><span class=n>ILLEGIBLE</span><span class=o>,</span><span class=n>YES1</span><span class=o>,</span><span class=n>YES2</span><span class=o>,</span><span class=n>YES3</span><span class=o>,</span><span class=n>YES4</span><span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=kd>enum</span> <span class=n>Address</span> <span class=o>{</span><span class=n>INCORRECT</span><span class=o>,</span><span class=n>OK1</span><span class=o>,</span><span class=n>OK2</span><span class=o>,</span><span class=n>OK3</span><span class=o>,</span><span class=n>OK4</span><span class=o>,</span><span class=n>OK5</span><span class=o>,</span><span class=n>OK6</span><span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=kd>enum</span> <span class=n>ReturnAddress</span> <span class=o>{</span><span class=n>MISSING</span><span class=o>,</span><span class=n>OK1</span><span class=o>,</span><span class=n>OK2</span><span class=o>,</span><span class=n>OK3</span><span class=o>,</span><span class=n>OK4</span><span class=o>,</span><span class=n>OK5</span><span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=n>GeneralDelivery</span> <span class=n>generalDelivery</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=n>Scannability</span> <span class=n>scannability</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=n>Readability</span> <span class=n>readability</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=n>Address</span> <span class=n>address</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=n>ReturnAddress</span> <span class=n>returnAddress</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>static</span> <span class=kt>long</span> <span class=n>counter</span> <span class=o>=</span> <span class=mi>0</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kt>long</span> <span class=n>id</span> <span class=o>=</span> <span class=n>counter</span><span class=o>++;</span>
</span></span><span class=line><span class=cl>    <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>String</span> <span class=nf>toString</span><span class=o>()</span> <span class=o>{</span> <span class=k>return</span> <span class=s>&#34;Mail &#34;</span> <span class=o>+</span> <span class=n>id</span><span class=o>;</span> <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>String</span> <span class=nf>details</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>toString</span><span class=o>()</span> <span class=o>+</span>
</span></span><span class=line><span class=cl>                <span class=s>&#34;, General Delivery: &#34;</span> <span class=o>+</span> <span class=n>generalDelivery</span> <span class=o>+</span>
</span></span><span class=line><span class=cl>                <span class=s>&#34;, Address Scanability: &#34;</span> <span class=o>+</span> <span class=n>scannability</span> <span class=o>+</span>
</span></span><span class=line><span class=cl>                <span class=s>&#34;, Address Readability: &#34;</span> <span class=o>+</span> <span class=n>readability</span> <span class=o>+</span>
</span></span><span class=line><span class=cl>                <span class=s>&#34;, Address Address: &#34;</span> <span class=o>+</span> <span class=n>address</span> <span class=o>+</span>
</span></span><span class=line><span class=cl>                <span class=s>&#34;, Return address: &#34;</span> <span class=o>+</span> <span class=n>returnAddress</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=c1>// Generate test Mail:
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kd>public</span> <span class=kd>static</span> <span class=n>Mail</span> <span class=nf>randomMail</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>Mail</span> <span class=n>m</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Mail</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=n>m</span><span class=o>.</span><span class=na>generalDelivery</span> <span class=o>=</span>
</span></span><span class=line><span class=cl>                <span class=n>Enums</span><span class=o>.</span><span class=na>random</span><span class=o>(</span><span class=n>GeneralDelivery</span><span class=o>.</span><span class=na>class</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>m</span><span class=o>.</span><span class=na>scannability</span> <span class=o>=</span>
</span></span><span class=line><span class=cl>                <span class=n>Enums</span><span class=o>.</span><span class=na>random</span><span class=o>(</span><span class=n>Scannability</span><span class=o>.</span><span class=na>class</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>m</span><span class=o>.</span><span class=na>readability</span> <span class=o>=</span>
</span></span><span class=line><span class=cl>                <span class=n>Enums</span><span class=o>.</span><span class=na>random</span><span class=o>(</span><span class=n>Readability</span><span class=o>.</span><span class=na>class</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>m</span><span class=o>.</span><span class=na>address</span> <span class=o>=</span> <span class=n>Enums</span><span class=o>.</span><span class=na>random</span><span class=o>(</span><span class=n>Address</span><span class=o>.</span><span class=na>class</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>m</span><span class=o>.</span><span class=na>returnAddress</span> <span class=o>=</span>
</span></span><span class=line><span class=cl>                <span class=n>Enums</span><span class=o>.</span><span class=na>random</span><span class=o>(</span><span class=n>ReturnAddress</span><span class=o>.</span><span class=na>class</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>m</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span>
</span></span><span class=line><span class=cl>    <span class=n>Iterable</span><span class=o>&lt;</span><span class=n>Mail</span><span class=o>&gt;</span> <span class=nf>generator</span><span class=o>(</span><span class=kd>final</span> <span class=kt>int</span> <span class=n>count</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=k>new</span> <span class=n>Iterable</span><span class=o>&lt;</span><span class=n>Mail</span><span class=o>&gt;()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=kt>int</span> <span class=n>n</span> <span class=o>=</span> <span class=n>count</span><span class=o>;</span>
</span></span><span class=line><span class=cl>            <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>            <span class=kd>public</span> <span class=n>Iterator</span><span class=o>&lt;</span><span class=n>Mail</span><span class=o>&gt;</span> <span class=nf>iterator</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=k>new</span> <span class=n>Iterator</span><span class=o>&lt;</span><span class=n>Mail</span><span class=o>&gt;()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                    <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>                    <span class=kd>public</span> <span class=kt>boolean</span> <span class=nf>hasNext</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                        <span class=k>return</span> <span class=n>n</span><span class=o>--</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=o>;</span>
</span></span><span class=line><span class=cl>                    <span class=o>}</span>
</span></span><span class=line><span class=cl>                    <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>                    <span class=kd>public</span> <span class=n>Mail</span> <span class=nf>next</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                        <span class=k>return</span> <span class=n>randomMail</span><span class=o>();</span>
</span></span><span class=line><span class=cl>                    <span class=o>}</span>
</span></span><span class=line><span class=cl>                    <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>                    <span class=kd>public</span> <span class=kt>void</span> <span class=nf>remove</span><span class=o>()</span> <span class=o>{</span> <span class=c1>// Not implemented
</span></span></span><span class=line><span class=cl><span class=c1></span>                        <span class=k>throw</span> <span class=k>new</span> <span class=n>UnsupportedOperationException</span><span class=o>();</span>
</span></span><span class=line><span class=cl>                    <span class=o>}</span>
</span></span><span class=line><span class=cl>                <span class=o>};</span>
</span></span><span class=line><span class=cl>            <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=o>};</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>PostOffice</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>enum</span> <span class=n>MailHandler</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>GENERAL_DELIVERY</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>            <span class=kt>boolean</span> <span class=nf>handle</span><span class=o>(</span><span class=n>Mail</span> <span class=n>m</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                <span class=k>switch</span><span class=o>(</span><span class=n>m</span><span class=o>.</span><span class=na>generalDelivery</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                    <span class=k>case</span> <span class=n>YES</span><span class=o>:</span>
</span></span><span class=line><span class=cl>                        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span>
</span></span><span class=line><span class=cl>                                <span class=s>&#34;Using general delivery for &#34;</span> <span class=o>+</span> <span class=n>m</span><span class=o>);</span>
</span></span><span class=line><span class=cl>                        <span class=k>return</span> <span class=kc>true</span><span class=o>;</span>
</span></span><span class=line><span class=cl>                    <span class=k>default</span><span class=o>:</span> <span class=k>return</span> <span class=kc>false</span><span class=o>;</span>
</span></span><span class=line><span class=cl>                <span class=o>}</span>
</span></span><span class=line><span class=cl>            <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=o>},</span>
</span></span><span class=line><span class=cl>        <span class=n>MACHINE_SCAN</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>            <span class=kt>boolean</span> <span class=nf>handle</span><span class=o>(</span><span class=n>Mail</span> <span class=n>m</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                <span class=k>switch</span><span class=o>(</span><span class=n>m</span><span class=o>.</span><span class=na>scannability</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                    <span class=k>case</span> <span class=n>UNSCANNABLE</span><span class=o>:</span> <span class=k>return</span> <span class=kc>false</span><span class=o>;</span>
</span></span><span class=line><span class=cl>                    <span class=k>default</span><span class=o>:</span>
</span></span><span class=line><span class=cl>                        <span class=k>switch</span><span class=o>(</span><span class=n>m</span><span class=o>.</span><span class=na>address</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                            <span class=k>case</span> <span class=n>INCORRECT</span><span class=o>:</span> <span class=k>return</span> <span class=kc>false</span><span class=o>;</span>
</span></span><span class=line><span class=cl>                            <span class=k>default</span><span class=o>:</span>
</span></span><span class=line><span class=cl>                                <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span>
</span></span><span class=line><span class=cl>                                        <span class=s>&#34;Delivering &#34;</span><span class=o>+</span> <span class=n>m</span> <span class=o>+</span> <span class=s>&#34; automatically&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>                                <span class=k>return</span> <span class=kc>true</span><span class=o>;</span>
</span></span><span class=line><span class=cl>                        <span class=o>}</span>
</span></span><span class=line><span class=cl>                <span class=o>}</span>
</span></span><span class=line><span class=cl>            <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=o>},</span>
</span></span><span class=line><span class=cl>        <span class=n>VISUAL_INSPECTION</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>            <span class=kt>boolean</span> <span class=nf>handle</span><span class=o>(</span><span class=n>Mail</span> <span class=n>m</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                <span class=k>switch</span><span class=o>(</span><span class=n>m</span><span class=o>.</span><span class=na>readability</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                    <span class=k>case</span> <span class=n>ILLEGIBLE</span><span class=o>:</span> <span class=k>return</span> <span class=kc>false</span><span class=o>;</span>
</span></span><span class=line><span class=cl>                    <span class=k>default</span><span class=o>:</span>
</span></span><span class=line><span class=cl>                        <span class=k>switch</span><span class=o>(</span><span class=n>m</span><span class=o>.</span><span class=na>address</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                            <span class=k>case</span> <span class=n>INCORRECT</span><span class=o>:</span> <span class=k>return</span> <span class=kc>false</span><span class=o>;</span>
</span></span><span class=line><span class=cl>                            <span class=k>default</span><span class=o>:</span>
</span></span><span class=line><span class=cl>                                <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span>
</span></span><span class=line><span class=cl>                                        <span class=s>&#34;Delivering &#34;</span> <span class=o>+</span> <span class=n>m</span> <span class=o>+</span> <span class=s>&#34; normally&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>                                <span class=k>return</span> <span class=kc>true</span><span class=o>;</span>
</span></span><span class=line><span class=cl>                        <span class=o>}</span>
</span></span><span class=line><span class=cl>                <span class=o>}</span>
</span></span><span class=line><span class=cl>            <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=o>},</span>
</span></span><span class=line><span class=cl>        <span class=n>RETURN_TO_SENDER</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>            <span class=kt>boolean</span> <span class=nf>handle</span><span class=o>(</span><span class=n>Mail</span> <span class=n>m</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                <span class=k>switch</span><span class=o>(</span><span class=n>m</span><span class=o>.</span><span class=na>returnAddress</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                    <span class=k>case</span> <span class=n>MISSING</span><span class=o>:</span> <span class=k>return</span> <span class=kc>false</span><span class=o>;</span>
</span></span><span class=line><span class=cl>                    <span class=k>default</span><span class=o>:</span>
</span></span><span class=line><span class=cl>                        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span>
</span></span><span class=line><span class=cl>                                <span class=s>&#34;Returning &#34;</span> <span class=o>+</span> <span class=n>m</span> <span class=o>+</span> <span class=s>&#34; to sender&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>                        <span class=k>return</span> <span class=kc>true</span><span class=o>;</span>
</span></span><span class=line><span class=cl>                <span class=o>}</span>
</span></span><span class=line><span class=cl>            <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=o>};</span>
</span></span><span class=line><span class=cl>        <span class=kd>abstract</span> <span class=kt>boolean</span> <span class=nf>handle</span><span class=o>(</span><span class=n>Mail</span> <span class=n>m</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=kd>static</span> <span class=kt>void</span> <span class=nf>handle</span><span class=o>(</span><span class=n>Mail</span> <span class=n>m</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span><span class=o>(</span><span class=n>MailHandler</span> <span class=n>handler</span> <span class=o>:</span> <span class=n>MailHandler</span><span class=o>.</span><span class=na>values</span><span class=o>())</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span><span class=o>(</span><span class=n>handler</span><span class=o>.</span><span class=na>handle</span><span class=o>(</span><span class=n>m</span><span class=o>))</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>m</span> <span class=o>+</span> <span class=s>&#34; is a dead letter&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span><span class=o>(</span><span class=n>Mail</span> <span class=n>mail</span> <span class=o>:</span> <span class=n>Mail</span><span class=o>.</span><span class=na>generator</span><span class=o>(</span><span class=mi>10</span><span class=o>))</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>mail</span><span class=o>.</span><span class=na>details</span><span class=o>());</span>
</span></span><span class=line><span class=cl>            <span class=n>handle</span><span class=o>(</span><span class=n>mail</span><span class=o>);</span>
</span></span><span class=line><span class=cl>            <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;*****&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>输出为：</p><pre tabindex=0><code>Mail 0, General Delivery: NO2, Address Scanability:
UNSCANNABLE, Address Readability: YES3, Address
Address: OK1, Return address: OK1
Delivering Mail 0 normally
*****
Mail 1, General Delivery: NO5, Address Scanability:
YES3, Address Readability: ILLEGIBLE, Address Address:
OK5, Return address: OK1
Delivering Mail 1 automatically
*****
Mail 2, General Delivery: YES, Address Scanability:
YES3, Address Readability: YES1, Address Address: OK1,
Return address: OK5
Using general delivery for Mail 2
*****
Mail 3, General Delivery: NO4, Address Scanability:
YES3, Address Readability: YES1, Address Address:
INCORRECT, Return address: OK4
Returning Mail 3 to sender
*****
Mail 4, General Delivery: NO4, Address Scanability:
UNSCANNABLE, Address Readability: YES1, Address
Address: INCORRECT, Return address: OK2
Returning Mail 4 to sender
*****
Mail 5, General Delivery: NO3, Address Scanability:
YES1, Address Readability: ILLEGIBLE, Address Address:
OK4, Return address: OK2
Delivering Mail 5 automatically
*****
Mail 6, General Delivery: YES, Address Scanability:
YES4, Address Readability: ILLEGIBLE, Address Address:
OK4, Return address: OK4
Using general delivery for Mail 6
*****
Mail 7, General Delivery: YES, Address Scanability:
YES3, Address Readability: YES4, Address Address: OK2,
Return address: MISSING
Using general delivery for Mail 7
*****
Mail 8, General Delivery: NO3, Address Scanability:
YES1, Address Readability: YES3, Address Address:
INCORRECT, Return address: MISSING
Mail 8 is a dead letter
*****
Mail 9, General Delivery: NO1, Address Scanability:
UNSCANNABLE, Address Readability: YES2, Address
Address: OK1, Return address: OK4
Delivering Mail 9 normally
*****
</code></pre><p>职责链由 enum MailHandler 实现，而 enum 定义的次序决定了各个解决策略在应用时的次序。对每一封邮件，都要按此顺序尝试每个解决策略，直到其中一个能够成功地处理该邮件，如果所有的策略都失败了，那么该邮件将被判定为一封死信。</p><h3 id=使用-enum-的状态机>使用 enum 的状态机</h3><p>枚举类型非常适合用来创建状态机。一个状态机可以具有有限个特定的状态，它通常根据输入，从一个状态转移到下一个状态，不过也可能存在瞬时状态（transient states），而一旦任务执行结束，状态机就会立刻离开瞬时状态。</p><p>每个状态都具有某些可接受的输入，不同的输入会使状态机从当前状态转移到不同的新状态。由于 enum 对其实例有严格限制，非常适合用来表现不同的状态和输入。一般而言，每个状态都具有一些相关的输出。</p><p>自动售贷机是一个很好的状态机的例子。首先，我们用一个 enum 定义各种输入：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// enums/Input.java
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>import</span> <span class=nn>java.util.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>enum</span> <span class=n>Input</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>NICKEL</span><span class=o>(</span><span class=mi>5</span><span class=o>),</span> <span class=n>DIME</span><span class=o>(</span><span class=mi>10</span><span class=o>),</span> <span class=n>QUARTER</span><span class=o>(</span><span class=mi>25</span><span class=o>),</span> <span class=n>DOLLAR</span><span class=o>(</span><span class=mi>100</span><span class=o>),</span>
</span></span><span class=line><span class=cl>    <span class=n>TOOTHPASTE</span><span class=o>(</span><span class=mi>200</span><span class=o>),</span> <span class=n>CHIPS</span><span class=o>(</span><span class=mi>75</span><span class=o>),</span> <span class=n>SODA</span><span class=o>(</span><span class=mi>100</span><span class=o>),</span> <span class=n>SOAP</span><span class=o>(</span><span class=mi>50</span><span class=o>),</span>
</span></span><span class=line><span class=cl>    <span class=n>ABORT_TRANSACTION</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>        <span class=kd>public</span> <span class=kt>int</span> <span class=nf>amount</span><span class=o>()</span> <span class=o>{</span> <span class=c1>// Disallow
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=k>throw</span> <span class=k>new</span> <span class=n>RuntimeException</span><span class=o>(</span><span class=s>&#34;ABORT.amount()&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>},</span>
</span></span><span class=line><span class=cl>    <span class=n>STOP</span> <span class=o>{</span> <span class=c1>// This must be the last instance.
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>        <span class=kd>public</span> <span class=kt>int</span> <span class=nf>amount</span><span class=o>()</span> <span class=o>{</span> <span class=c1>// Disallow
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=k>throw</span> <span class=k>new</span> <span class=n>RuntimeException</span><span class=o>(</span><span class=s>&#34;SHUT_DOWN.amount()&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>};</span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>value</span><span class=o>;</span> <span class=c1>// In cents
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>Input</span><span class=o>(</span><span class=kt>int</span> <span class=n>value</span><span class=o>)</span> <span class=o>{</span> <span class=k>this</span><span class=o>.</span><span class=na>value</span> <span class=o>=</span> <span class=n>value</span><span class=o>;</span> <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=n>Input</span><span class=o>()</span> <span class=o>{}</span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=nf>amount</span><span class=o>()</span> <span class=o>{</span> <span class=k>return</span> <span class=n>value</span><span class=o>;</span> <span class=o>};</span> <span class=c1>// In cents
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kd>static</span> <span class=n>Random</span> <span class=n>rand</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Random</span><span class=o>(</span><span class=mi>47</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=n>Input</span> <span class=nf>randomSelection</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// Don&#39;t include STOP:
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>return</span> <span class=n>values</span><span class=o>()[</span><span class=n>rand</span><span class=o>.</span><span class=na>nextInt</span><span class=o>(</span><span class=n>values</span><span class=o>().</span><span class=na>length</span> <span class=o>-</span> <span class=mi>1</span><span class=o>)];</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>注意，除了两个特殊的 Input 实例之外，其他的 Input 都有相应的价格，因此在接口中定义了 amount（方法。然而，对那两个特殊 Input 实例而言，调用 amount（方法并不合适，所以如果程序员调用它们的 amount）方法就会有异常抛出（在接口内定义了一个方法，然后在你调用该方法的某个实现时就会抛出异常），这似乎有点奇怪，但由于 enum 的限制，我们不得不采用这种方式。</p><p>VendingMachine 对输入的第一个反应是将其归类为 Category enum 中的某一个 enum 实例，这可以通过 switch 实现。下面的例子演示了 enum 是如何使代码变得更加清晰且易于管理的：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// enums/VendingMachine.java
</span></span></span><span class=line><span class=cl><span class=c1>// {java VendingMachine VendingMachineInput.txt}
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>import</span> <span class=nn>java.util.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>java.io.IOException</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>java.util.function.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>java.nio.file.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>java.util.stream.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kd>enum</span> <span class=n>Category</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>MONEY</span><span class=o>(</span><span class=n>Input</span><span class=o>.</span><span class=na>NICKEL</span><span class=o>,</span> <span class=n>Input</span><span class=o>.</span><span class=na>DIME</span><span class=o>,</span>
</span></span><span class=line><span class=cl>            <span class=n>Input</span><span class=o>.</span><span class=na>QUARTER</span><span class=o>,</span> <span class=n>Input</span><span class=o>.</span><span class=na>DOLLAR</span><span class=o>),</span>
</span></span><span class=line><span class=cl>    <span class=n>ITEM_SELECTION</span><span class=o>(</span><span class=n>Input</span><span class=o>.</span><span class=na>TOOTHPASTE</span><span class=o>,</span> <span class=n>Input</span><span class=o>.</span><span class=na>CHIPS</span><span class=o>,</span>
</span></span><span class=line><span class=cl>            <span class=n>Input</span><span class=o>.</span><span class=na>SODA</span><span class=o>,</span> <span class=n>Input</span><span class=o>.</span><span class=na>SOAP</span><span class=o>),</span>
</span></span><span class=line><span class=cl>    <span class=n>QUIT_TRANSACTION</span><span class=o>(</span><span class=n>Input</span><span class=o>.</span><span class=na>ABORT_TRANSACTION</span><span class=o>),</span>
</span></span><span class=line><span class=cl>    <span class=n>SHUT_DOWN</span><span class=o>(</span><span class=n>Input</span><span class=o>.</span><span class=na>STOP</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>Input</span><span class=o>[]</span> <span class=n>values</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=n>Category</span><span class=o>(</span><span class=n>Input</span><span class=o>...</span> <span class=n>types</span><span class=o>)</span> <span class=o>{</span> <span class=n>values</span> <span class=o>=</span> <span class=n>types</span><span class=o>;</span> <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kd>static</span> <span class=n>EnumMap</span><span class=o>&lt;</span><span class=n>Input</span><span class=o>,</span><span class=n>Category</span><span class=o>&gt;</span> <span class=n>categories</span> <span class=o>=</span>
</span></span><span class=line><span class=cl>            <span class=k>new</span> <span class=n>EnumMap</span><span class=o>&lt;&gt;(</span><span class=n>Input</span><span class=o>.</span><span class=na>class</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=kd>static</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span><span class=o>(</span><span class=n>Category</span> <span class=n>c</span> <span class=o>:</span> <span class=n>Category</span><span class=o>.</span><span class=na>class</span><span class=o>.</span><span class=na>getEnumConstants</span><span class=o>())</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span><span class=o>(</span><span class=n>Input</span> <span class=n>type</span> <span class=o>:</span> <span class=n>c</span><span class=o>.</span><span class=na>values</span><span class=o>)</span>
</span></span><span class=line><span class=cl>                <span class=n>categories</span><span class=o>.</span><span class=na>put</span><span class=o>(</span><span class=n>type</span><span class=o>,</span> <span class=n>c</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=n>Category</span> <span class=nf>categorize</span><span class=o>(</span><span class=n>Input</span> <span class=n>input</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>categories</span><span class=o>.</span><span class=na>get</span><span class=o>(</span><span class=n>input</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>VendingMachine</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kd>static</span> <span class=n>State</span> <span class=n>state</span> <span class=o>=</span> <span class=n>State</span><span class=o>.</span><span class=na>RESTING</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kd>static</span> <span class=kt>int</span> <span class=n>amount</span> <span class=o>=</span> <span class=mi>0</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kd>static</span> <span class=n>Input</span> <span class=n>selection</span> <span class=o>=</span> <span class=kc>null</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>enum</span> <span class=n>StateDuration</span> <span class=o>{</span> <span class=n>TRANSIENT</span> <span class=o>}</span> <span class=c1>// Tagging enum
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kd>enum</span> <span class=n>State</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>RESTING</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>            <span class=kt>void</span> <span class=nf>next</span><span class=o>(</span><span class=n>Input</span> <span class=n>input</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                <span class=k>switch</span><span class=o>(</span><span class=n>Category</span><span class=o>.</span><span class=na>categorize</span><span class=o>(</span><span class=n>input</span><span class=o>))</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                    <span class=k>case</span> <span class=n>MONEY</span><span class=o>:</span>
</span></span><span class=line><span class=cl>                        <span class=n>amount</span> <span class=o>+=</span> <span class=n>input</span><span class=o>.</span><span class=na>amount</span><span class=o>();</span>
</span></span><span class=line><span class=cl>                        <span class=n>state</span> <span class=o>=</span> <span class=n>ADDING_MONEY</span><span class=o>;</span>
</span></span><span class=line><span class=cl>                        <span class=k>break</span><span class=o>;</span>
</span></span><span class=line><span class=cl>                    <span class=k>case</span> <span class=n>SHUT_DOWN</span><span class=o>:</span>
</span></span><span class=line><span class=cl>                        <span class=n>state</span> <span class=o>=</span> <span class=n>TERMINAL</span><span class=o>;</span>
</span></span><span class=line><span class=cl>                    <span class=k>default</span><span class=o>:</span>
</span></span><span class=line><span class=cl>                <span class=o>}</span>
</span></span><span class=line><span class=cl>            <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=o>},</span>
</span></span><span class=line><span class=cl>        <span class=n>ADDING_MONEY</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>            <span class=kt>void</span> <span class=nf>next</span><span class=o>(</span><span class=n>Input</span> <span class=n>input</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                <span class=k>switch</span><span class=o>(</span><span class=n>Category</span><span class=o>.</span><span class=na>categorize</span><span class=o>(</span><span class=n>input</span><span class=o>))</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                    <span class=k>case</span> <span class=n>MONEY</span><span class=o>:</span>
</span></span><span class=line><span class=cl>                        <span class=n>amount</span> <span class=o>+=</span> <span class=n>input</span><span class=o>.</span><span class=na>amount</span><span class=o>();</span>
</span></span><span class=line><span class=cl>                        <span class=k>break</span><span class=o>;</span>
</span></span><span class=line><span class=cl>                    <span class=k>case</span> <span class=n>ITEM_SELECTION</span><span class=o>:</span>
</span></span><span class=line><span class=cl>                        <span class=n>selection</span> <span class=o>=</span> <span class=n>input</span><span class=o>;</span>
</span></span><span class=line><span class=cl>                        <span class=k>if</span><span class=o>(</span><span class=n>amount</span> <span class=o>&lt;</span> <span class=n>selection</span><span class=o>.</span><span class=na>amount</span><span class=o>())</span>
</span></span><span class=line><span class=cl>                            <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span>
</span></span><span class=line><span class=cl>                                    <span class=s>&#34;Insufficient money for &#34;</span> <span class=o>+</span> <span class=n>selection</span><span class=o>);</span>
</span></span><span class=line><span class=cl>                        <span class=k>else</span> <span class=n>state</span> <span class=o>=</span> <span class=n>DISPENSING</span><span class=o>;</span>
</span></span><span class=line><span class=cl>                        <span class=k>break</span><span class=o>;</span>
</span></span><span class=line><span class=cl>                    <span class=k>case</span> <span class=n>QUIT_TRANSACTION</span><span class=o>:</span>
</span></span><span class=line><span class=cl>                        <span class=n>state</span> <span class=o>=</span> <span class=n>GIVING_CHANGE</span><span class=o>;</span>
</span></span><span class=line><span class=cl>                        <span class=k>break</span><span class=o>;</span>
</span></span><span class=line><span class=cl>                    <span class=k>case</span> <span class=n>SHUT_DOWN</span><span class=o>:</span>
</span></span><span class=line><span class=cl>                        <span class=n>state</span> <span class=o>=</span> <span class=n>TERMINAL</span><span class=o>;</span>
</span></span><span class=line><span class=cl>                    <span class=k>default</span><span class=o>:</span>
</span></span><span class=line><span class=cl>                <span class=o>}</span>
</span></span><span class=line><span class=cl>            <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=o>},</span>
</span></span><span class=line><span class=cl>        <span class=n>DISPENSING</span><span class=o>(</span><span class=n>StateDuration</span><span class=o>.</span><span class=na>TRANSIENT</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>            <span class=kt>void</span> <span class=nf>next</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;here is your &#34;</span> <span class=o>+</span> <span class=n>selection</span><span class=o>);</span>
</span></span><span class=line><span class=cl>                <span class=n>amount</span> <span class=o>-=</span> <span class=n>selection</span><span class=o>.</span><span class=na>amount</span><span class=o>();</span>
</span></span><span class=line><span class=cl>                <span class=n>state</span> <span class=o>=</span> <span class=n>GIVING_CHANGE</span><span class=o>;</span>
</span></span><span class=line><span class=cl>            <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=o>},</span>
</span></span><span class=line><span class=cl>        <span class=n>GIVING_CHANGE</span><span class=o>(</span><span class=n>StateDuration</span><span class=o>.</span><span class=na>TRANSIENT</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>            <span class=kt>void</span> <span class=nf>next</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span><span class=o>(</span><span class=n>amount</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;Your change: &#34;</span> <span class=o>+</span> <span class=n>amount</span><span class=o>);</span>
</span></span><span class=line><span class=cl>                    <span class=n>amount</span> <span class=o>=</span> <span class=mi>0</span><span class=o>;</span>
</span></span><span class=line><span class=cl>                <span class=o>}</span>
</span></span><span class=line><span class=cl>                <span class=n>state</span> <span class=o>=</span> <span class=n>RESTING</span><span class=o>;</span>
</span></span><span class=line><span class=cl>            <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=o>},</span>
</span></span><span class=line><span class=cl>        <span class=n>TERMINAL</span> <span class=o>{</span><span class=nd>@Override</span>
</span></span><span class=line><span class=cl>        <span class=kt>void</span> <span class=nf>output</span><span class=o>()</span> <span class=o>{</span> <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;Halted&#34;</span><span class=o>);</span> <span class=o>}</span> <span class=o>};</span>
</span></span><span class=line><span class=cl>        <span class=kd>private</span> <span class=kt>boolean</span> <span class=n>isTransient</span> <span class=o>=</span> <span class=kc>false</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=n>State</span><span class=o>()</span> <span class=o>{}</span>
</span></span><span class=line><span class=cl>        <span class=n>State</span><span class=o>(</span><span class=n>StateDuration</span> <span class=n>trans</span><span class=o>)</span> <span class=o>{</span> <span class=n>isTransient</span> <span class=o>=</span> <span class=kc>true</span><span class=o>;</span> <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=kt>void</span> <span class=nf>next</span><span class=o>(</span><span class=n>Input</span> <span class=n>input</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=k>throw</span> <span class=k>new</span> <span class=n>RuntimeException</span><span class=o>(</span><span class=s>&#34;Only call &#34;</span> <span class=o>+</span>
</span></span><span class=line><span class=cl>                    <span class=s>&#34;next(Input input) for non-transient states&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=kt>void</span> <span class=nf>next</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=k>throw</span> <span class=k>new</span> <span class=n>RuntimeException</span><span class=o>(</span>
</span></span><span class=line><span class=cl>                    <span class=s>&#34;Only call next() for &#34;</span> <span class=o>+</span>
</span></span><span class=line><span class=cl>                            <span class=s>&#34;StateDuration.TRANSIENT states&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=kt>void</span> <span class=nf>output</span><span class=o>()</span> <span class=o>{</span> <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>amount</span><span class=o>);</span> <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=kd>static</span> <span class=kt>void</span> <span class=nf>run</span><span class=o>(</span><span class=n>Supplier</span><span class=o>&lt;</span><span class=n>Input</span><span class=o>&gt;</span> <span class=n>gen</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>while</span><span class=o>(</span><span class=n>state</span> <span class=o>!=</span> <span class=n>State</span><span class=o>.</span><span class=na>TERMINAL</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=n>state</span><span class=o>.</span><span class=na>next</span><span class=o>(</span><span class=n>gen</span><span class=o>.</span><span class=na>get</span><span class=o>());</span>
</span></span><span class=line><span class=cl>            <span class=k>while</span><span class=o>(</span><span class=n>state</span><span class=o>.</span><span class=na>isTransient</span><span class=o>)</span>
</span></span><span class=line><span class=cl>                <span class=n>state</span><span class=o>.</span><span class=na>next</span><span class=o>();</span>
</span></span><span class=line><span class=cl>            <span class=n>state</span><span class=o>.</span><span class=na>output</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>Supplier</span><span class=o>&lt;</span><span class=n>Input</span><span class=o>&gt;</span> <span class=n>gen</span> <span class=o>=</span> <span class=k>new</span> <span class=n>RandomInputSupplier</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span><span class=o>(</span><span class=n>args</span><span class=o>.</span><span class=na>length</span> <span class=o>==</span> <span class=mi>1</span><span class=o>)</span>
</span></span><span class=line><span class=cl>            <span class=n>gen</span> <span class=o>=</span> <span class=k>new</span> <span class=n>FileInputSupplier</span><span class=o>(</span><span class=n>args</span><span class=o>[</span><span class=mi>0</span><span class=o>]);</span>
</span></span><span class=line><span class=cl>        <span class=n>run</span><span class=o>(</span><span class=n>gen</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// For a basic sanity check:
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>class</span> <span class=nc>RandomInputSupplier</span> <span class=kd>implements</span> <span class=n>Supplier</span><span class=o>&lt;</span><span class=n>Input</span><span class=o>&gt;</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>Input</span> <span class=nf>get</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>Input</span><span class=o>.</span><span class=na>randomSelection</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Create Inputs from a file of &#39;;&#39;-separated strings:
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>class</span> <span class=nc>FileInputSupplier</span> <span class=kd>implements</span> <span class=n>Supplier</span><span class=o>&lt;</span><span class=n>Input</span><span class=o>&gt;</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>Iterator</span><span class=o>&lt;</span><span class=n>String</span><span class=o>&gt;</span> <span class=n>input</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=n>FileInputSupplier</span><span class=o>(</span><span class=n>String</span> <span class=n>fileName</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=n>input</span> <span class=o>=</span> <span class=n>Files</span><span class=o>.</span><span class=na>lines</span><span class=o>(</span><span class=n>Paths</span><span class=o>.</span><span class=na>get</span><span class=o>(</span><span class=n>fileName</span><span class=o>))</span>
</span></span><span class=line><span class=cl>                    <span class=o>.</span><span class=na>skip</span><span class=o>(</span><span class=mi>1</span><span class=o>)</span> <span class=c1>// Skip the comment line
</span></span></span><span class=line><span class=cl><span class=c1></span>                    <span class=o>.</span><span class=na>flatMap</span><span class=o>(</span><span class=n>s</span> <span class=o>-&gt;</span> <span class=n>Arrays</span><span class=o>.</span><span class=na>stream</span><span class=o>(</span><span class=n>s</span><span class=o>.</span><span class=na>split</span><span class=o>(</span><span class=s>&#34;;&#34;</span><span class=o>)))</span>
</span></span><span class=line><span class=cl>                    <span class=o>.</span><span class=na>map</span><span class=o>(</span><span class=n>String</span><span class=o>::</span><span class=n>trim</span><span class=o>)</span>
</span></span><span class=line><span class=cl>                    <span class=o>.</span><span class=na>collect</span><span class=o>(</span><span class=n>Collectors</span><span class=o>.</span><span class=na>toList</span><span class=o>())</span>
</span></span><span class=line><span class=cl>                    <span class=o>.</span><span class=na>iterator</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span> <span class=k>catch</span><span class=o>(</span><span class=n>IOException</span> <span class=n>e</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=k>throw</span> <span class=k>new</span> <span class=n>RuntimeException</span><span class=o>(</span><span class=n>e</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>Input</span> <span class=nf>get</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span><span class=o>(!</span><span class=n>input</span><span class=o>.</span><span class=na>hasNext</span><span class=o>())</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=kc>null</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>Enum</span><span class=o>.</span><span class=na>valueOf</span><span class=o>(</span><span class=n>Input</span><span class=o>.</span><span class=na>class</span><span class=o>,</span> <span class=n>input</span><span class=o>.</span><span class=na>next</span><span class=o>().</span><span class=na>trim</span><span class=o>());</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>输出为：</p><pre tabindex=0><code>25
50
75
here is your CHIPS
0
100
200
here is your TOOTHPASTE
0
25
35
Your change: 35
0
25
35
Insufficient money for SODA
35
60
70
75
Insufficient money for SODA
75
Your change: 75
0
Halted
</code></pre><p>由于用 switch 语句从 enum 实例中进行选择是最常见的一种方式（请注意，为了使 enum 在 switch 语句中的使用变得简单，我们是需要付出其他代价的），所以，我们经常遇到这样的问题：将多个 enum 进行分类时，“我们希望在什么 enum 中使用 switch 语句？”我们通过 VendingMachine 的例子来研究一下这个问题。对于每一个 State，我们都需要在输入动作的基本分类中进行查找：用户塞入钞票，选择了某个货物，操作被取消，以及机器停止。然而，在这些基本分类之下，我们又可以塞人不同类型的钞票，可以选择不同的货物。Category enum 将不同类型的 Input 进行分组，因而，可以使用 categorize0 方法为 switch 语句生成恰当的 Cateroy 实例。并且，该方法使用的 EnumMap 确保了在其中进行查询时的效率与安全。</p><p>如果读者仔细研究 VendingMachine 类，就会发现每种状态的不同之处，以及对于输入的不同响应，其中还有两个瞬时状态。在 run() 方法中，状态机等待着下一个 Input，并一直在各个状态中移动，直到它不再处于瞬时状态。</p><p>通过两种不同的 Generator 对象，我们可以使用不同的 Supplier 对象来测试 VendingMachine，首先是 RandomInputSupplier，它会不停地生成除了 SHUT-DOWN 之外的各种输入。通过长时间地运行 RandomInputSupplier，可以起到健全测试（sanity test）的作用，能够确保该状态机不会进入一个错误状态。另一个是 FileInputSupplier，使用文件以文本的方式来描述输入，然后将它们转换成 enum 实例，并创建对应的 Input 对象。上面的程序使用的正是如下的文本文件：</p><pre tabindex=0><code>// enums/VendingMachineInput.txt
QUARTER; QUARTER; QUARTER; CHIPS;
DOLLAR; DOLLAR; TOOTHPASTE;
QUARTER; DIME; ABORT_TRANSACTION;
QUARTER; DIME; SODA;
QUARTER; DIME; NICKEL; SODA;
ABORT_TRANSACTION;
STOP;
</code></pre><p>FileInputSupplier 构造函数将此文件转换为流，并跳过注释行。然后它使用 String.split() 以分号进行分割。这会生成一个 String 数组，并可以通过将其转换为 Stream，然后应用 flatMap() 来将其输入到流中。其输出结果将去除所有空格空格，并转换为 List&lt;String>，且从中获取 Iterator&lt;String>。</p><p>这种设计有一个缺陷，它要求 enum State 实例访问的 VendingMachine 属性必须声明为 static，这意味着，你只能有一个 VendingMachine 实例。不过如果我们思考一下实际的（嵌入式 Java）应用，这也许并不是一个大问题，因为在一台机器上，我们可能只有一个应用程序。</p><h2 id=多路分发>多路分发</h2><p>当你要处理多种交互类型时，程序可能会变得相当杂乱。举例来说，如果一个系统要分析和执行数学表达式。我们可能会声明 Number.plus(Number)，Number.multiple(Number) 等等，其中 Number 是各种数字对象的超类。然而，当你声明 a.plus(b) 时，你并不知道 a 或 b 的确切类型，那你如何能让它们正确地交互呢？</p><p>你可能从未思考过这个问题的答案.Java 只支持单路分发。也就是说，如果要执行的操作包含了不止一个类型未知的对象时，那么 Java 的动态绑定机制只能处理其中一个的类型。这就无法解决我们上面提到的问题。所以，你必须自己来判定其他的类型，从而实现自己的动态线定行为。</p><p>解决上面问题的办法就是多路分发（在那个例子中，只有两个分发，一般称之为两路分发）.多态只能发生在方法调用时，所以，如果你想使用两路分发，那么就必须有两个方法调用：第一个方法调用决定第一个未知类型，第二个方法调用决定第二个未知的类型。要利用多路分发，程序员必须为每一个类型提供一个实际的方法调用，如果你要处理两个不同的类型体系，就需要为每个类型体系执行一个方法调用。一般而言，程序员需要有设定好的某种配置，以便一个方法调用能够引出更多的方法调用，从而能够在这个过程中处理多种类型。为了达到这种效果，我们需要与多个方法一同工作：因为每个分发都需要一个方法调用。在下面的例子中（实现了 “石头、剪刀、布”游戏，也称为 RoShamBo）对应的方法是 compete() 和 eval()，二者都是同一个类型的成员，它们可以产生三种 Outcome 实例中的一个作为结果：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// enums/Outcome.java
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>package</span> <span class=nn>enums</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>enum</span> <span class=n>Outcome</span> <span class=o>{</span> <span class=n>WIN</span><span class=o>,</span> <span class=n>LOSE</span><span class=o>,</span> <span class=n>DRAW</span> <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=c1>// enums/RoShamBo1.java
</span></span></span><span class=line><span class=cl><span class=c1>// Demonstration of multiple dispatching
</span></span></span><span class=line><span class=cl><span class=c1>// {java enums.RoShamBo1}
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>package</span> <span class=nn>enums</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=kn>import</span> <span class=nn>java.util.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=kn>import static</span> <span class=nn>enums.Outcome.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kd>interface</span> <span class=nc>Item</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>Outcome</span> <span class=nf>compete</span><span class=o>(</span><span class=n>Item</span> <span class=n>it</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>Outcome</span> <span class=nf>eval</span><span class=o>(</span><span class=n>Paper</span> <span class=n>p</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>Outcome</span> <span class=nf>eval</span><span class=o>(</span><span class=n>Scissors</span> <span class=n>s</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>Outcome</span> <span class=nf>eval</span><span class=o>(</span><span class=n>Rock</span> <span class=n>r</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=kd>class</span> <span class=nc>Paper</span> <span class=kd>implements</span> <span class=n>Item</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>Outcome</span> <span class=nf>compete</span><span class=o>(</span><span class=n>Item</span> <span class=n>it</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>it</span><span class=o>.</span><span class=na>eval</span><span class=o>(</span><span class=k>this</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>Outcome</span> <span class=nf>eval</span><span class=o>(</span><span class=n>Paper</span> <span class=n>p</span><span class=o>)</span> <span class=o>{</span> <span class=k>return</span> <span class=n>DRAW</span><span class=o>;</span> <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>Outcome</span> <span class=nf>eval</span><span class=o>(</span><span class=n>Scissors</span> <span class=n>s</span><span class=o>)</span> <span class=o>{</span> <span class=k>return</span> <span class=n>WIN</span><span class=o>;</span> <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>Outcome</span> <span class=nf>eval</span><span class=o>(</span><span class=n>Rock</span> <span class=n>r</span><span class=o>)</span> <span class=o>{</span> <span class=k>return</span> <span class=n>LOSE</span><span class=o>;</span> <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>String</span> <span class=nf>toString</span><span class=o>()</span> <span class=o>{</span> <span class=k>return</span> <span class=s>&#34;Paper&#34;</span><span class=o>;</span> <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=kd>class</span> <span class=nc>Scissors</span> <span class=kd>implements</span> <span class=n>Item</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>Outcome</span> <span class=nf>compete</span><span class=o>(</span><span class=n>Item</span> <span class=n>it</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>it</span><span class=o>.</span><span class=na>eval</span><span class=o>(</span><span class=k>this</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>Outcome</span> <span class=nf>eval</span><span class=o>(</span><span class=n>Paper</span> <span class=n>p</span><span class=o>)</span> <span class=o>{</span> <span class=k>return</span> <span class=n>LOSE</span><span class=o>;</span> <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>Outcome</span> <span class=nf>eval</span><span class=o>(</span><span class=n>Scissors</span> <span class=n>s</span><span class=o>)</span> <span class=o>{</span> <span class=k>return</span> <span class=n>DRAW</span><span class=o>;</span> <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>Outcome</span> <span class=nf>eval</span><span class=o>(</span><span class=n>Rock</span> <span class=n>r</span><span class=o>)</span> <span class=o>{</span> <span class=k>return</span> <span class=n>WIN</span><span class=o>;</span> <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>String</span> <span class=nf>toString</span><span class=o>()</span> <span class=o>{</span> <span class=k>return</span> <span class=s>&#34;Scissors&#34;</span><span class=o>;</span> <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=kd>class</span> <span class=nc>Rock</span> <span class=kd>implements</span> <span class=n>Item</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>Outcome</span> <span class=nf>compete</span><span class=o>(</span><span class=n>Item</span> <span class=n>it</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>it</span><span class=o>.</span><span class=na>eval</span><span class=o>(</span><span class=k>this</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>Outcome</span> <span class=nf>eval</span><span class=o>(</span><span class=n>Paper</span> <span class=n>p</span><span class=o>)</span> <span class=o>{</span> <span class=k>return</span> <span class=n>WIN</span><span class=o>;</span> <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>Outcome</span> <span class=nf>eval</span><span class=o>(</span><span class=n>Scissors</span> <span class=n>s</span><span class=o>)</span> <span class=o>{</span> <span class=k>return</span> <span class=n>LOSE</span><span class=o>;</span> <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>Outcome</span> <span class=nf>eval</span><span class=o>(</span><span class=n>Rock</span> <span class=n>r</span><span class=o>)</span> <span class=o>{</span> <span class=k>return</span> <span class=n>DRAW</span><span class=o>;</span> <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>String</span> <span class=nf>toString</span><span class=o>()</span> <span class=o>{</span> <span class=k>return</span> <span class=s>&#34;Rock&#34;</span><span class=o>;</span> <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>RoShamBo1</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>static</span> <span class=kd>final</span> <span class=kt>int</span> <span class=n>SIZE</span> <span class=o>=</span> <span class=mi>20</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kd>static</span> <span class=n>Random</span> <span class=n>rand</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Random</span><span class=o>(</span><span class=mi>47</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=n>Item</span> <span class=nf>newItem</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>switch</span><span class=o>(</span><span class=n>rand</span><span class=o>.</span><span class=na>nextInt</span><span class=o>(</span><span class=mi>3</span><span class=o>))</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=k>default</span><span class=o>:</span>
</span></span><span class=line><span class=cl>            <span class=k>case</span> <span class=mi>0</span><span class=o>:</span> <span class=k>return</span> <span class=k>new</span> <span class=n>Scissors</span><span class=o>();</span>
</span></span><span class=line><span class=cl>            <span class=k>case</span> <span class=mi>1</span><span class=o>:</span> <span class=k>return</span> <span class=k>new</span> <span class=n>Paper</span><span class=o>();</span>
</span></span><span class=line><span class=cl>            <span class=k>case</span> <span class=mi>2</span><span class=o>:</span> <span class=k>return</span> <span class=k>new</span> <span class=n>Rock</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>match</span><span class=o>(</span><span class=n>Item</span> <span class=n>a</span><span class=o>,</span> <span class=n>Item</span> <span class=n>b</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span>
</span></span><span class=line><span class=cl>                <span class=n>a</span> <span class=o>+</span> <span class=s>&#34; vs. &#34;</span> <span class=o>+</span> <span class=n>b</span> <span class=o>+</span> <span class=s>&#34;: &#34;</span> <span class=o>+</span> <span class=n>a</span><span class=o>.</span><span class=na>compete</span><span class=o>(</span><span class=n>b</span><span class=o>));</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span><span class=o>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=o>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>SIZE</span><span class=o>;</span> <span class=n>i</span><span class=o>++)</span>
</span></span><span class=line><span class=cl>            <span class=n>match</span><span class=o>(</span><span class=n>newItem</span><span class=o>(),</span> <span class=n>newItem</span><span class=o>());</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>输出为：</p><pre tabindex=0><code>Rock vs. Rock: DRAW
Paper vs. Rock: WIN
Paper vs. Rock: WIN
Paper vs. Rock: WIN
Scissors vs. Paper: WIN
Scissors vs. Scissors: DRAW
Scissors vs. Paper: WIN
Rock vs. Paper: LOSE
Paper vs. Paper: DRAW
Rock vs. Paper: LOSE
Paper vs. Scissors: LOSE
Paper vs. Scissors: LOSE
Rock vs. Scissors: WIN
Rock vs. Paper: LOSE
Paper vs. Rock: WIN
Scissors vs. Paper: WIN
Paper vs. Scissors: LOSE
Paper vs. Scissors: LOSE
Paper vs. Scissors: LOSE
Paper vs. Scissors: LOSE
</code></pre><p>Item 是这几种类型的接口，将会被用作多路分发。RoShamBo1.match() 有两个 Item 参数，通过调用 Item.compete90) 方法开始两路分发。要判定 a 的类型，分发机制会在 a 的实际类型的 compete（内部起到分发的作用。compete() 方法通过调用 eval() 来为另一个类型实现第二次分法。</p><p>将自身（this）作为参数调用 evalo，能够调用重载过的 eval() 方法，这能够保留第一次分发的类型信息。当第二次分发完成时，你就能够知道两个 Item 对象的具体类型了。</p><p>要配置好多路分发需要很多的工序，不过要记住，它的好处在于方法调用时的优雅的话法，这避免了在一个方法中判定多个对象的类型的丑陋代码，你只需说，“嘿，你们两个，我不在乎你们是什么类型，请你们自己交流！”不过，在使用多路分发前，请先明确，这种优雅的代码对你确实有重要的意义。</p><h3 id=使用-enum-分发>使用 enum 分发</h3><p>直接将 RoShamBol.java 翻译为基于 enum 的版本是有问题的，因为 enum 实例不是类型，不能将 enum 实例作为参数的类型，所以无法重载 eval() 方法。不过，还有很多方式可以实现多路分发，并从 enum 中获益。</p><p>一种方式是使用构造器来初始化每个 enum 实例，并以“一组”结果作为参数。这二者放在一块，形成了类似查询表的结构：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// enums/RoShamBo2.java
</span></span></span><span class=line><span class=cl><span class=c1>// Switching one enum on another
</span></span></span><span class=line><span class=cl><span class=c1>// {java enums.RoShamBo2}
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>package</span> <span class=nn>enums</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import static</span> <span class=nn>enums.Outcome.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>enum</span> <span class=n>RoShamBo2</span> <span class=kd>implements</span> <span class=n>Competitor</span><span class=o>&lt;</span><span class=n>RoShamBo2</span><span class=o>&gt;</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>PAPER</span><span class=o>(</span><span class=n>DRAW</span><span class=o>,</span> <span class=n>LOSE</span><span class=o>,</span> <span class=n>WIN</span><span class=o>),</span>
</span></span><span class=line><span class=cl>    <span class=n>SCISSORS</span><span class=o>(</span><span class=n>WIN</span><span class=o>,</span> <span class=n>DRAW</span><span class=o>,</span> <span class=n>LOSE</span><span class=o>),</span>
</span></span><span class=line><span class=cl>    <span class=n>ROCK</span><span class=o>(</span><span class=n>LOSE</span><span class=o>,</span> <span class=n>WIN</span><span class=o>,</span> <span class=n>DRAW</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>Outcome</span> <span class=n>vPAPER</span><span class=o>,</span> <span class=n>vSCISSORS</span><span class=o>,</span> <span class=n>vROCK</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=n>RoShamBo2</span><span class=o>(</span><span class=n>Outcome</span> <span class=n>paper</span><span class=o>,</span>
</span></span><span class=line><span class=cl>              <span class=n>Outcome</span> <span class=n>scissors</span><span class=o>,</span> <span class=n>Outcome</span> <span class=n>rock</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=o>.</span><span class=na>vPAPER</span> <span class=o>=</span> <span class=n>paper</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=o>.</span><span class=na>vSCISSORS</span> <span class=o>=</span> <span class=n>scissors</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=o>.</span><span class=na>vROCK</span> <span class=o>=</span> <span class=n>rock</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>Outcome</span> <span class=nf>compete</span><span class=o>(</span><span class=n>RoShamBo2</span> <span class=n>it</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>switch</span><span class=o>(</span><span class=n>it</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=k>default</span><span class=o>:</span>
</span></span><span class=line><span class=cl>            <span class=k>case</span> <span class=n>PAPER</span><span class=o>:</span> <span class=k>return</span> <span class=n>vPAPER</span><span class=o>;</span>
</span></span><span class=line><span class=cl>            <span class=k>case</span> <span class=n>SCISSORS</span><span class=o>:</span> <span class=k>return</span> <span class=n>vSCISSORS</span><span class=o>;</span>
</span></span><span class=line><span class=cl>            <span class=k>case</span> <span class=n>ROCK</span><span class=o>:</span> <span class=k>return</span> <span class=n>vROCK</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>RoShamBo</span><span class=o>.</span><span class=na>play</span><span class=o>(</span><span class=n>RoShamBo2</span><span class=o>.</span><span class=na>class</span><span class=o>,</span> <span class=mi>20</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>输出为：</p><pre tabindex=0><code>ROCK vs. ROCK: DRAW
SCISSORS vs. ROCK: LOSE
SCISSORS vs. ROCK: LOSE
SCISSORS vs. ROCK: LOSE
PAPER vs. SCISSORS: LOSE
PAPER vs. PAPER: DRAW
PAPER vs. SCISSORS: LOSE
ROCK vs. SCISSORS: WIN
SCISSORS vs. SCISSORS: DRAW
ROCK vs. SCISSORS: WIN
SCISSORS vs. PAPER: WIN
SCISSORS vs. PAPER: WIN
ROCK vs. PAPER: LOSE
ROCK vs. SCISSORS: WIN
SCISSORS vs. ROCK: LOSE
PAPER vs. SCISSORS: LOSE
SCISSORS vs. PAPER: WIN
SCISSORS vs. PAPER: WIN
SCISSORS vs. PAPER: WIN
SCISSORS vs. PAPER: WIN
</code></pre><p>在 compete() 方法中，一旦两种类型都被确定了，那么唯一的操作就是返回结果 Outcome 然而，你可能还需要调用其他的方法，（例如）甚至是调用在构造器中指定的某个命令对象上的方法。</p><p>RoShamBo2.javal 之前的例子短小得多，而且更直接，更易于理解。注意，我们仍然是使用两路分发来判定两个对象的类型。在 RoShamBol.java 中，两次分发都是通过实际的方法调用实现，而在这个例子中，只有第一次分发是实际的方法调用。第二个分发使用的是 switch，不过这样做是安全的，因为 enum 限制了 switch 语句的选择分支。</p><p>在代码中，enum 被单独抽取出来，因此它可以应用在其他例子中。首先，Competitor 接口定义了一种类型，该类型的对象可以与另一个 Competitor 相竞争：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// enums/Competitor.java
</span></span></span><span class=line><span class=cl><span class=c1>// Switching one enum on another
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>package</span> <span class=nn>enums</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>interface</span> <span class=nc>Competitor</span><span class=o>&lt;</span><span class=n>T</span> <span class=kd>extends</span> <span class=n>Competitor</span><span class=o>&lt;</span><span class=n>T</span><span class=o>&gt;&gt;</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>Outcome</span> <span class=nf>compete</span><span class=o>(</span><span class=n>T</span> <span class=n>competitor</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>然后，我们定义两个 static 方法（static 可以避免显式地指明参数类型），第一个是 match() 方法，它会为一个 Competitor 对象调用 compete() 方法，并与另一个 Competitor 对象作比较。在这个例子中，我们看到，match()方法的参数需要是 Competitor&lt;T> 类型。但是在 play() 方法中，类型参数必须同时是 Enum&lt;T> 类型（因为它将在 Enums.random() 中使用）和 Competitor&lt;T> 类型（因为它将被传递给 match() 方法）：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// enums/RoShamBo.java
</span></span></span><span class=line><span class=cl><span class=c1>// Common tools for RoShamBo examples
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>package</span> <span class=nn>enums</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>onjava.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>RoShamBo</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=o>&lt;</span><span class=n>T</span> <span class=kd>extends</span> <span class=n>Competitor</span><span class=o>&lt;</span><span class=n>T</span><span class=o>&gt;&gt;</span>
</span></span><span class=line><span class=cl>    <span class=kt>void</span> <span class=nf>match</span><span class=o>(</span><span class=n>T</span> <span class=n>a</span><span class=o>,</span> <span class=n>T</span> <span class=n>b</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span>
</span></span><span class=line><span class=cl>                <span class=n>a</span> <span class=o>+</span> <span class=s>&#34; vs. &#34;</span> <span class=o>+</span> <span class=n>b</span> <span class=o>+</span> <span class=s>&#34;: &#34;</span> <span class=o>+</span> <span class=n>a</span><span class=o>.</span><span class=na>compete</span><span class=o>(</span><span class=n>b</span><span class=o>));</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=o>&lt;</span><span class=n>T</span> <span class=kd>extends</span> <span class=n>Enum</span><span class=o>&lt;</span><span class=n>T</span><span class=o>&gt;</span> <span class=o>&amp;</span> <span class=n>Competitor</span><span class=o>&lt;</span><span class=n>T</span><span class=o>&gt;&gt;</span>
</span></span><span class=line><span class=cl>    <span class=kt>void</span> <span class=nf>play</span><span class=o>(</span><span class=n>Class</span><span class=o>&lt;</span><span class=n>T</span><span class=o>&gt;</span> <span class=n>rsbClass</span><span class=o>,</span> <span class=kt>int</span> <span class=n>size</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span><span class=o>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=o>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>size</span><span class=o>;</span> <span class=n>i</span><span class=o>++)</span>
</span></span><span class=line><span class=cl>            <span class=n>match</span><span class=o>(</span><span class=n>Enums</span><span class=o>.</span><span class=na>random</span><span class=o>(</span><span class=n>rsbClass</span><span class=o>),</span><span class=n>Enums</span><span class=o>.</span><span class=na>random</span><span class=o>(</span><span class=n>rsbClass</span><span class=o>));</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>play() 方法没有将类型参数 T 作为返回值类型，因此，似乎我们应该在 Class&lt;T> 中使用通配符来代替上面的参数声明。然而，通配符不能扩展多个基类，所以我们必须采用以上的表达式。</p><h3 id=使用常量相关的方法>使用常量相关的方法</h3><p>常量相关的方法允许我们为每个 enum 实例提供方法的不同实现，这使得常量相关的方法似乎是实现多路分发的完美解决方案。不过，通过这种方式，enum 实例虽然可以具有不同的行为，但它们仍然不是类型，不能将其作为方法签名中的参数类型来使用。最好的办法是将 enum 用在 switch 语句中，见下例：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// enums/RoShamBo3.java
</span></span></span><span class=line><span class=cl><span class=c1>// Using constant-specific methods
</span></span></span><span class=line><span class=cl><span class=c1>// {java enums.RoShamBo3}
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>package</span> <span class=nn>enums</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import static</span> <span class=nn>enums.Outcome.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>enum</span> <span class=n>RoShamBo3</span> <span class=kd>implements</span> <span class=n>Competitor</span><span class=o>&lt;</span><span class=n>RoShamBo3</span><span class=o>&gt;</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>PAPER</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>        <span class=kd>public</span> <span class=n>Outcome</span> <span class=nf>compete</span><span class=o>(</span><span class=n>RoShamBo3</span> <span class=n>it</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=k>switch</span><span class=o>(</span><span class=n>it</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                <span class=k>default</span><span class=o>:</span> <span class=c1>// To placate the compiler
</span></span></span><span class=line><span class=cl><span class=c1></span>                <span class=k>case</span> <span class=n>PAPER</span><span class=o>:</span> <span class=k>return</span> <span class=n>DRAW</span><span class=o>;</span>
</span></span><span class=line><span class=cl>                <span class=k>case</span> <span class=n>SCISSORS</span><span class=o>:</span> <span class=k>return</span> <span class=n>LOSE</span><span class=o>;</span>
</span></span><span class=line><span class=cl>                <span class=k>case</span> <span class=n>ROCK</span><span class=o>:</span> <span class=k>return</span> <span class=n>WIN</span><span class=o>;</span>
</span></span><span class=line><span class=cl>            <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>},</span>
</span></span><span class=line><span class=cl>    <span class=n>SCISSORS</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>        <span class=kd>public</span> <span class=n>Outcome</span> <span class=nf>compete</span><span class=o>(</span><span class=n>RoShamBo3</span> <span class=n>it</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=k>switch</span><span class=o>(</span><span class=n>it</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                <span class=k>default</span><span class=o>:</span>
</span></span><span class=line><span class=cl>                <span class=k>case</span> <span class=n>PAPER</span><span class=o>:</span> <span class=k>return</span> <span class=n>WIN</span><span class=o>;</span>
</span></span><span class=line><span class=cl>                <span class=k>case</span> <span class=n>SCISSORS</span><span class=o>:</span> <span class=k>return</span> <span class=n>DRAW</span><span class=o>;</span>
</span></span><span class=line><span class=cl>                <span class=k>case</span> <span class=n>ROCK</span><span class=o>:</span> <span class=k>return</span> <span class=n>LOSE</span><span class=o>;</span>
</span></span><span class=line><span class=cl>            <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>},</span>
</span></span><span class=line><span class=cl>    <span class=n>ROCK</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>        <span class=kd>public</span> <span class=n>Outcome</span> <span class=nf>compete</span><span class=o>(</span><span class=n>RoShamBo3</span> <span class=n>it</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=k>switch</span><span class=o>(</span><span class=n>it</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                <span class=k>default</span><span class=o>:</span>
</span></span><span class=line><span class=cl>                <span class=k>case</span> <span class=n>PAPER</span><span class=o>:</span> <span class=k>return</span> <span class=n>LOSE</span><span class=o>;</span>
</span></span><span class=line><span class=cl>                <span class=k>case</span> <span class=n>SCISSORS</span><span class=o>:</span> <span class=k>return</span> <span class=n>WIN</span><span class=o>;</span>
</span></span><span class=line><span class=cl>                <span class=k>case</span> <span class=n>ROCK</span><span class=o>:</span> <span class=k>return</span> <span class=n>DRAW</span><span class=o>;</span>
</span></span><span class=line><span class=cl>            <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>};</span>
</span></span><span class=line><span class=cl>    <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>abstract</span> <span class=n>Outcome</span> <span class=nf>compete</span><span class=o>(</span><span class=n>RoShamBo3</span> <span class=n>it</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>RoShamBo</span><span class=o>.</span><span class=na>play</span><span class=o>(</span><span class=n>RoShamBo3</span><span class=o>.</span><span class=na>class</span><span class=o>,</span> <span class=mi>20</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>输出为：</p><pre tabindex=0><code>ROCK vs. ROCK: DRAW
SCISSORS vs. ROCK: LOSE
SCISSORS vs. ROCK: LOSE
SCISSORS vs. ROCK: LOSE
PAPER vs. SCISSORS: LOSE
PAPER vs. PAPER: DRAW
PAPER vs. SCISSORS: LOSE
ROCK vs. SCISSORS: WIN
SCISSORS vs. SCISSORS: DRAW
ROCK vs. SCISSORS: WIN
SCISSORS vs. PAPER: WIN
SCISSORS vs. PAPER: WIN
ROCK vs. PAPER: LOSE
ROCK vs. SCISSORS: WIN
SCISSORS vs. ROCK: LOSE
PAPER vs. SCISSORS: LOSE
SCISSORS vs. PAPER: WIN
SCISSORS vs. PAPER: WIN
SCISSORS vs. PAPER: WIN
SCISSORS vs. PAPER: WIN
</code></pre><p>虽然这种方式可以工作，但是却不甚合理，如果采用 RoShamB02.java 的解决方案，那么在添加一个新的类型时，只需更少的代码，而且也更直接。</p><p>:然而，RoShamBo3.java 还可以压缩简化一下：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// enums/RoShamBo4.java
</span></span></span><span class=line><span class=cl><span class=c1>// {java enums.RoShamBo4}
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>package</span> <span class=nn>enums</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>enum</span> <span class=n>RoShamBo4</span> <span class=kd>implements</span> <span class=n>Competitor</span><span class=o>&lt;</span><span class=n>RoShamBo4</span><span class=o>&gt;</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>ROCK</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>        <span class=kd>public</span> <span class=n>Outcome</span> <span class=nf>compete</span><span class=o>(</span><span class=n>RoShamBo4</span> <span class=n>opponent</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>compete</span><span class=o>(</span><span class=n>SCISSORS</span><span class=o>,</span> <span class=n>opponent</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>},</span>
</span></span><span class=line><span class=cl>    <span class=n>SCISSORS</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>        <span class=kd>public</span> <span class=n>Outcome</span> <span class=nf>compete</span><span class=o>(</span><span class=n>RoShamBo4</span> <span class=n>opponent</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>compete</span><span class=o>(</span><span class=n>PAPER</span><span class=o>,</span> <span class=n>opponent</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>},</span>
</span></span><span class=line><span class=cl>    <span class=n>PAPER</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>        <span class=kd>public</span> <span class=n>Outcome</span> <span class=nf>compete</span><span class=o>(</span><span class=n>RoShamBo4</span> <span class=n>opponent</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>compete</span><span class=o>(</span><span class=n>ROCK</span><span class=o>,</span> <span class=n>opponent</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>};</span>
</span></span><span class=line><span class=cl>    <span class=n>Outcome</span> <span class=nf>compete</span><span class=o>(</span><span class=n>RoShamBo4</span> <span class=n>loser</span><span class=o>,</span> <span class=n>RoShamBo4</span> <span class=n>opponent</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=o>((</span><span class=n>opponent</span> <span class=o>==</span> <span class=k>this</span><span class=o>)</span> <span class=o>?</span> <span class=n>Outcome</span><span class=o>.</span><span class=na>DRAW</span>
</span></span><span class=line><span class=cl>                <span class=o>:</span> <span class=o>((</span><span class=n>opponent</span> <span class=o>==</span> <span class=n>loser</span><span class=o>)</span> <span class=o>?</span> <span class=n>Outcome</span><span class=o>.</span><span class=na>WIN</span>
</span></span><span class=line><span class=cl>                <span class=o>:</span> <span class=n>Outcome</span><span class=o>.</span><span class=na>LOSE</span><span class=o>));</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>RoShamBo</span><span class=o>.</span><span class=na>play</span><span class=o>(</span><span class=n>RoShamBo4</span><span class=o>.</span><span class=na>class</span><span class=o>,</span> <span class=mi>20</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>输出为：</p><pre tabindex=0><code>PAPER vs. PAPER: DRAW
SCISSORS vs. PAPER: WIN
SCISSORS vs. PAPER: WIN
SCISSORS vs. PAPER: WIN
ROCK vs. SCISSORS: WIN
ROCK vs. ROCK: DRAW
ROCK vs. SCISSORS: WIN
PAPER vs. SCISSORS: LOSE
SCISSORS vs. SCISSORS: DRAW
PAPER vs. SCISSORS: LOSE
SCISSORS vs. ROCK: LOSE
SCISSORS vs. ROCK: LOSE
PAPER vs. ROCK: WIN
PAPER vs. SCISSORS: LOSE
SCISSORS vs. PAPER: WIN
ROCK vs. SCISSORS: WIN
SCISSORS vs. ROCK: LOSE
SCISSORS vs. ROCK: LOSE
SCISSORS vs. ROCK: LOSE
SCISSORS vs. ROCK: LOSE
</code></pre><p>其中，具有两个参数的 compete() 方法执行第二个分发，该方法执行一系列的比较，其行为类似 switch 语句。这个版本的程序更简短，不过却比较难理解，对于一个大型系统而言，难以理解的代码将导致整个系统不够健壮。</p><h3 id=使用-enummap-进行分发>使用 EnumMap 进行分发</h3><p>使用 EnumMap 能够实现“真正的”两路分发。EnumMap 是为 enum 专门设计的一种性能非常好的特殊 Map。由于我们的目的是摸索出两种未知的类型，所以可以用一个 EnumMap 的 EnumMap 来实现两路分发：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// enums/RoShamBo5.java
</span></span></span><span class=line><span class=cl><span class=c1>// Multiple dispatching using an EnumMap of EnumMaps
</span></span></span><span class=line><span class=cl><span class=c1>// {java enums.RoShamBo5}
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>package</span> <span class=nn>enums</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>java.util.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import static</span> <span class=nn>enums.Outcome.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kd>enum</span> <span class=n>RoShamBo5</span> <span class=kd>implements</span> <span class=n>Competitor</span><span class=o>&lt;</span><span class=n>RoShamBo5</span><span class=o>&gt;</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>PAPER</span><span class=o>,</span> <span class=n>SCISSORS</span><span class=o>,</span> <span class=n>ROCK</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>static</span> <span class=n>EnumMap</span><span class=o>&lt;</span><span class=n>RoShamBo5</span><span class=o>,</span><span class=n>EnumMap</span><span class=o>&lt;</span><span class=n>RoShamBo5</span><span class=o>,</span><span class=n>Outcome</span><span class=o>&gt;&gt;</span>
</span></span><span class=line><span class=cl>            <span class=n>table</span> <span class=o>=</span> <span class=k>new</span> <span class=n>EnumMap</span><span class=o>&lt;&gt;(</span><span class=n>RoShamBo5</span><span class=o>.</span><span class=na>class</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=kd>static</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span><span class=o>(</span><span class=n>RoShamBo5</span> <span class=n>it</span> <span class=o>:</span> <span class=n>RoShamBo5</span><span class=o>.</span><span class=na>values</span><span class=o>())</span>
</span></span><span class=line><span class=cl>            <span class=n>table</span><span class=o>.</span><span class=na>put</span><span class=o>(</span><span class=n>it</span><span class=o>,</span> <span class=k>new</span> <span class=n>EnumMap</span><span class=o>&lt;&gt;(</span><span class=n>RoShamBo5</span><span class=o>.</span><span class=na>class</span><span class=o>));</span>
</span></span><span class=line><span class=cl>        <span class=n>initRow</span><span class=o>(</span><span class=n>PAPER</span><span class=o>,</span> <span class=n>DRAW</span><span class=o>,</span> <span class=n>LOSE</span><span class=o>,</span> <span class=n>WIN</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>initRow</span><span class=o>(</span><span class=n>SCISSORS</span><span class=o>,</span> <span class=n>WIN</span><span class=o>,</span> <span class=n>DRAW</span><span class=o>,</span> <span class=n>LOSE</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>initRow</span><span class=o>(</span><span class=n>ROCK</span><span class=o>,</span> <span class=n>LOSE</span><span class=o>,</span> <span class=n>WIN</span><span class=o>,</span> <span class=n>DRAW</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=kd>static</span> <span class=kt>void</span> <span class=nf>initRow</span><span class=o>(</span><span class=n>RoShamBo5</span> <span class=n>it</span><span class=o>,</span>
</span></span><span class=line><span class=cl>                        <span class=n>Outcome</span> <span class=n>vPAPER</span><span class=o>,</span> <span class=n>Outcome</span> <span class=n>vSCISSORS</span><span class=o>,</span> <span class=n>Outcome</span> <span class=n>vROCK</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>EnumMap</span><span class=o>&lt;</span><span class=n>RoShamBo5</span><span class=o>,</span><span class=n>Outcome</span><span class=o>&gt;</span> <span class=n>row</span> <span class=o>=</span>
</span></span><span class=line><span class=cl>                <span class=n>RoShamBo5</span><span class=o>.</span><span class=na>table</span><span class=o>.</span><span class=na>get</span><span class=o>(</span><span class=n>it</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>row</span><span class=o>.</span><span class=na>put</span><span class=o>(</span><span class=n>RoShamBo5</span><span class=o>.</span><span class=na>PAPER</span><span class=o>,</span> <span class=n>vPAPER</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>row</span><span class=o>.</span><span class=na>put</span><span class=o>(</span><span class=n>RoShamBo5</span><span class=o>.</span><span class=na>SCISSORS</span><span class=o>,</span> <span class=n>vSCISSORS</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>row</span><span class=o>.</span><span class=na>put</span><span class=o>(</span><span class=n>RoShamBo5</span><span class=o>.</span><span class=na>ROCK</span><span class=o>,</span> <span class=n>vROCK</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>Outcome</span> <span class=nf>compete</span><span class=o>(</span><span class=n>RoShamBo5</span> <span class=n>it</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>table</span><span class=o>.</span><span class=na>get</span><span class=o>(</span><span class=k>this</span><span class=o>).</span><span class=na>get</span><span class=o>(</span><span class=n>it</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>RoShamBo</span><span class=o>.</span><span class=na>play</span><span class=o>(</span><span class=n>RoShamBo5</span><span class=o>.</span><span class=na>class</span><span class=o>,</span> <span class=mi>20</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>输出为：</p><pre tabindex=0><code>ROCK vs. ROCK: DRAW
SCISSORS vs. ROCK: LOSE
SCISSORS vs. ROCK: LOSE
SCISSORS vs. ROCK: LOSE
PAPER vs. SCISSORS: LOSE
PAPER vs. PAPER: DRAW
PAPER vs. SCISSORS: LOSE
ROCK vs. SCISSORS: WIN
SCISSORS vs. SCISSORS: DRAW
ROCK vs. SCISSORS: WIN
SCISSORS vs. PAPER: WIN
SCISSORS vs. PAPER: WIN
ROCK vs. PAPER: LOSE
ROCK vs. SCISSORS: WIN
SCISSORS vs. ROCK: LOSE
PAPER vs. SCISSORS: LOSE
SCISSORS vs. PAPER: WIN
SCISSORS vs. PAPER: WIN
SCISSORS vs. PAPER: WIN
SCISSORS vs. PAPER: WIN
</code></pre><p>该程序在一个 static 子句中初始化 EnumMap 对象，具体见表格似的 initRow() 方法调用。请注意 compete() 方法，您可以看到，在一行语句中发生了两次分发。</p><h3 id=使用二维数组>使用二维数组</h3><p>我们还可以进一步简化实现两路分发的解决方案。我们注意到，每个 enum 实例都有一个固定的值（基于其声明的次序），并且可以通过 ordinal() 方法取得该值。因此我们可以使用二维数组，将竞争者映射到竞争结果。采用这种方式能够获得最简洁、最直接的解决方案（很可能也是最快速的，虽然我们知道 EnumMap 内部其实也是使用数组实现的）。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>We</span> <span class=n>can</span> <span class=n>simplify</span> <span class=n>the</span> <span class=n>solution</span> <span class=n>even</span> <span class=n>more</span> <span class=n>by</span> <span class=n>noting</span> <span class=n>that</span> <span class=n>each</span>  <span class=kd>enum</span> <span class=n>instance</span> <span class=n>has</span> <span class=n>a</span> <span class=n>fixed</span>
</span></span><span class=line><span class=cl>        <span class=nf>value</span> <span class=o>(</span><span class=n>based</span> <span class=n>on</span> <span class=n>its</span> <span class=n>declaration</span> <span class=n>order</span><span class=o>)</span> <span class=n>and</span> <span class=n>that</span>  <span class=nf>ordinal</span><span class=o>()</span> <span class=n>produces</span> <span class=k>this</span> <span class=n>value</span><span class=o>.</span> <span class=n>A</span> <span class=n>two</span><span class=o>-</span>
</span></span><span class=line><span class=cl>        <span class=n>dimensional</span> <span class=n>array</span> <span class=n>mapping</span> <span class=n>the</span> <span class=n>competitors</span> <span class=n>onto</span> <span class=n>the</span> <span class=n>outcomes</span> <span class=n>produces</span> <span class=n>the</span> <span class=n>smallest</span>
</span></span><span class=line><span class=cl>        <span class=n>and</span> <span class=n>most</span> <span class=n>straightforward</span> <span class=nf>solution</span> <span class=o>(</span><span class=n>and</span> <span class=n>possibly</span> <span class=n>the</span> <span class=n>fastest</span><span class=o>,</span> <span class=n>although</span> <span class=n>remember</span> <span class=n>that</span>
</span></span><span class=line><span class=cl>        <span class=n>EnumMap</span> <span class=n>uses</span> <span class=n>an</span> <span class=n>internal</span> <span class=n>array</span><span class=o>):</span>
</span></span><span class=line><span class=cl><span class=c1>// enums/RoShamBo6.java
</span></span></span><span class=line><span class=cl><span class=c1>// Enums using &#34;tables&#34; instead of multiple dispatch
</span></span></span><span class=line><span class=cl><span class=c1>// {java enums.RoShamBo6}
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=kn>package</span> <span class=nn>enums</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=kn>import static</span> <span class=nn>enums.Outcome.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kd>enum</span> <span class=n>RoShamBo6</span> <span class=kd>implements</span> <span class=n>Competitor</span><span class=o>&lt;</span><span class=n>RoShamBo6</span><span class=o>&gt;</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>PAPER</span><span class=o>,</span> <span class=n>SCISSORS</span><span class=o>,</span> <span class=n>ROCK</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kd>static</span> <span class=n>Outcome</span><span class=o>[][]</span> <span class=n>table</span> <span class=o>=</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=o>{</span> <span class=n>DRAW</span><span class=o>,</span> <span class=n>LOSE</span><span class=o>,</span> <span class=n>WIN</span> <span class=o>},</span> <span class=c1>// PAPER
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=o>{</span> <span class=n>WIN</span><span class=o>,</span> <span class=n>DRAW</span><span class=o>,</span> <span class=n>LOSE</span> <span class=o>},</span> <span class=c1>// SCISSORS
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=o>{</span> <span class=n>LOSE</span><span class=o>,</span> <span class=n>WIN</span><span class=o>,</span> <span class=n>DRAW</span> <span class=o>},</span> <span class=c1>// ROCK
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=o>};</span>
</span></span><span class=line><span class=cl>    <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>Outcome</span> <span class=nf>compete</span><span class=o>(</span><span class=n>RoShamBo6</span> <span class=n>other</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>table</span><span class=o>[</span><span class=k>this</span><span class=o>.</span><span class=na>ordinal</span><span class=o>()][</span><span class=n>other</span><span class=o>.</span><span class=na>ordinal</span><span class=o>()];</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>RoShamBo</span><span class=o>.</span><span class=na>play</span><span class=o>(</span><span class=n>RoShamBo6</span><span class=o>.</span><span class=na>class</span><span class=o>,</span> <span class=mi>20</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>输出为：</p><pre tabindex=0><code>ROCK vs. ROCK: DRAW
SCISSORS vs. ROCK: LOSE
SCISSORS vs. ROCK: LOSE
SCISSORS vs. ROCK: LOSE
PAPER vs. SCISSORS: LOSE
PAPER vs. PAPER: DRAW
PAPER vs. SCISSORS: LOSE
ROCK vs. SCISSORS: WIN
SCISSORS vs. SCISSORS: DRAW
ROCK vs. SCISSORS: WIN
SCISSORS vs. PAPER: WIN
SCISSORS vs. PAPER: WIN
ROCK vs. PAPER: LOSE
ROCK vs. SCISSORS: WIN
SCISSORS vs. ROCK: LOSE
PAPER vs. SCISSORS: LOSE
SCISSORS vs. PAPER: WIN
SCISSORS vs. PAPER: WIN
SCISSORS vs. PAPER: WIN
SCISSORS vs. PAPER: WIN
</code></pre><p>table 与前一个例子中 initRow() 方法的调用次序完全相同。</p><p>与前面一个例子相比，这个程序代码虽然简短，但表达能力却更强，部分原因是其代码更易于理解与修改，而且也更直接。不过，由于它使用的是数组，所以这种方式不太“安全”。如果使用一个大型数组，可能会不小心使用了错误的尺寸，而且，如果你的测试不能覆盖所有的可能性，有些错误可能会从你眼前溜过。</p><p>事实上，以上所有的解决方案只是各种不同类型的表罢了。不过，分析各种表的表现形式，找出最适合的那一种，还是很有价值的。注意，虽然上例是最简洁的一种解决方案，但它也是相当僵硬的方案，因为它只能针对给定的常量输入产生常量输出。然而，也没有什么特别的理由阻止你用 table 来生成功能对象。对于某类问题而言，“表驱动式编码”的概念具有非常强大的功能。</p><h2 id=本章小结>本章小结</h2><p>虽然枚举类型本身并不是特别复杂，但我还是将本章安排在全书比较靠后的位置，这是因为，程序员可以将 enum 与 Java 语言的其他功能结合使用，例如多态、泛型和反射。</p><p>虽然 Java 中的枚举比 C 或 C++中的 enum 更成熟，但它仍然是一个“小”功能，Java 没有它也已经（虽然有点笨拙）存在很多年了。而本章正好说明了一个“小”功能所能带来的价值。有时恰恰因为它，你才能够优雅而干净地解决问题。正如我在本书中一再强调的那样，优雅与清晰很重要，正是它们区别了成功的解决方案与失败的解决方案。而失败的解决方案就是因为其他人无法理解它。</p><p>关于清晰的话题，Java 1.0 对术语 enumeration 的选择正是一个不幸的反例。对于一个专门用于从序列中选择每一个元素的对象而言，Java 竟然没有使用更通用、更普遍接受的术语 iterator 来表示它（参见<a href>集合</a> 章节），有些语言甚至将枚举的数据类型称为 “enumerators”！Java 修正了这个错误，但是 Enumeration 接口已经无法轻易地抹去了，因此它将一直存在于旧的（甚至有些新的）代码、类库以及文档中。</p><div style=page-break-after:always></div></div><div class=article-widget><div class="container-xl row post-nav"><div class="col-6 post-nav-item"><div class=meta-nav>上一页</div><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/21-arrays/ rel=next>21-Arrays</a></div><div class="col-6 post-nav-item"><div class=meta-nav>下一页</div><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/23-annotations/ rel=prev>23-Annotations</a></div></div></div><div class=body-footer><p>最近更新于 0001-01-01</p><section id=comments class="mb-3 pt-0"><div id=disqus_thread></div><script>var disqus_config=function(){};(function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="https://ngte.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)})()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></section></div></article><footer class=site-footer><div class="copyright py-4 bg-footer"><div class="row justify-content-center"><div class="text-center footer-color"><p class=mb-0>© 2017-2022 NGTE all rights reserved</p></div></div></div><script type=text/javascript id=clstr_globe async src="//clustrmaps.com/globe.js?d=kgpJG5sWZQpKujBmD-uW1B54-WBPol-DuDtrB2KFjKs"></script></footer></main></div></div><script src=//unpkg.com/heti/umd/heti-addon.min.js></script>
<script>const heti=new Heti(".article");heti.autoSpacing()</script><script type=text/javascript>window.$crisp=[],window.CRISP_WEBSITE_ID="12adcc35-9621-4313-8262-62dc654b29d8",function(){setTimeout(function(){d=document,s=d.createElement("script"),s.src="https://client.crisp.chat/l.js",s.async=1,d.getElementsByTagName("head")[0].appendChild(s)},2500)}()</script></div><div class=page-footer></div><script src=/js/vendor-bundle.min.d26509351aa0ff874abbee824e982e9b.js></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.1/highlight.min.js integrity="sha512-Ypjm0o7jOxAd4hpdoppSEN0TQOC19UtPAqD+4s5AlXmUvbmmS/YMxYqAqarQYyxTnB6/rqip9qcxlNB/3U9Wdg==" crossorigin=anonymous></script>
<script id=search-hit-algolia-template type=text/html><div class=search-hit><div class=search-hit-content><div class=search-hit-name><a href={{relpermalink}}>{{#helpers.highlight}}{ "attribute": "title" }{{/helpers.highlight}}</a></div><div class="article-metadata search-hit-type">{{type}}</div><p class=search-hit-description>{{#helpers.highlight}}{ "attribute": "summary" }{{/helpers.highlight}}</p></div></div></script><script src=https://cdn.jsdelivr.net/npm/instantsearch.js@4/dist/instantsearch.production.min.js crossorigin=anonymous></script>
<script id=dsq-count-scr src=https://ngte.disqus.com/count.js async></script>
<script src=/zh/js/algolia-search-built.min.4387d694ca1258194aaf562b8cd1c400.js type=module></script>
<script id=page-data type=application/json>{"use_headroom":false}</script><script src=/zh/js/wowchemy.min.d1673c7a11d1238516cbe12a1e84257f.js></script>
<script>var mybutton=document.getElementById("backTopBtn");window.onscroll=function(){scrollFunction()};function scrollFunction(){document.body.scrollTop>20||document.documentElement.scrollTop>20?mybutton.style.display="block":mybutton.style.display="none"}function topFunction(){document.body.scrollTop=0,document.documentElement.scrollTop=0}</script><script src=https://cdn.jsdelivr.net/gh/bryanbraun/anchorjs@4.2.2/anchor.min.js integrity="sha512-I7w3ZdSFzw5j3jU3ZkNikBNeIrl3i+hEuEdwNmqUJvwNcaBUNcijnP2gd9DtGlgVYDplfjGoD8vTNsID+lCjqg==" crossorigin=anonymous></script>
<script>anchors.add()</script><script>(function(){"use strict";if(!document.queryCommandSupported("copy"))return;function e(e,t){e.className="highlight-copy-btn",e.textContent=t,setTimeout(function(){e.textContent="",e.className="highlight-copy-btn fa fa-copy"},1e3)}function t(e){var t=window.getSelection(),n=document.createRange();return n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n),t}function n(n){var o,s=document.createElement("button");s.className="highlight-copy-btn fa fa-copy",s.textContent="",o=n.firstElementChild,s.addEventListener("click",function(){try{var n=t(o);document.execCommand("copy"),n.removeAllRanges(),e(s,"已复制")}catch(t){console&&console.log(t),e(s,"Failed :'(")}}),n.appendChild(s)}var s=document.getElementsByClassName("highlight");Array.prototype.forEach.call(s,n)})()</script></body></html>