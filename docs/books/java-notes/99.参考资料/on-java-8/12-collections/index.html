<!doctype html><html lang=zh><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=generator content="Wowchemy 5.5.0 for Hugo"><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=preload as=style href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap"><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap" media=print onload='this.media="all"'><meta name=google-site-verification content="google69a5cccb61297807"><meta name=baidu-site-verification content="cqmZHEleVh"><meta name=description content="第十二章 集合 如果一个程序只包含固定数量的对象且对象的生命周期都是已知的，那么这是一个非常简单的程序。 通常，程序总是根据运行时才知道的某些条件去创建新的对象。在此之前，无法知道所需对象的数量甚至确切类型"><link rel=alternate hreflang=zh href=https://ng-tech.icu/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/12-collections/><meta name=theme-color content="#0a55a7"><link rel=stylesheet href=/css/vendor-bundle.min.c7b8d9abd591ba2253ea42747e3ac3f5.css media=print onload='this.media="all"'><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.1/styles/github.min.css crossorigin=anonymous title=hl-light media=print onload='this.media="all"'><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.1/styles/dracula.min.css crossorigin=anonymous title=hl-dark media=print onload='this.media="all"' disabled><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/instantsearch.css@7.4.5/themes/satellite-min.css integrity="sha256-TehzF/2QvNKhGQrrNpoOb2Ck4iGZ1J/DI4pkd2oUsBc=" crossorigin=anonymous><link rel=stylesheet href=/css/wowchemy.fab3cd1900ae35687457073b2d518207.css><script async src="https://www.googletagmanager.com/gtag/js?id=G-40NYXJ8823"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-40NYXJ8823")</script><script>var _hmt=_hmt||[];(function(){var e,t=document.createElement("script");t.src="https://hm.baidu.com/hm.js?56df1177bce405601b0ecdd7208f75c6",e=document.getElementsByTagName("script")[0],e.parentNode.insertBefore(t,e)})()</script><link rel=manifest href=/manifest.webmanifest><link rel=icon type=image/png href=/media/icon_hu0f7d075e895d6f5f1f5fdbc1e33dc138_10087_32x32_fill_lanczos_center_3.png><link rel=apple-touch-icon type=image/png href=/media/icon_hu0f7d075e895d6f5f1f5fdbc1e33dc138_10087_180x180_fill_lanczos_center_3.png><link rel=canonical href=https://ng-tech.icu/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/12-collections/><meta property="twitter:card" content="summary_large_image"><meta property="twitter:site" content="@wx-chevalier"><meta property="twitter:creator" content="@wx-chevalier"><meta property="og:site_name" content="Next-gen Tech Edu"><meta property="og:url" content="https://ng-tech.icu/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/12-collections/"><meta property="og:title" content="12-Collections | Next-gen Tech Edu"><meta property="og:description" content="第十二章 集合 如果一个程序只包含固定数量的对象且对象的生命周期都是已知的，那么这是一个非常简单的程序。 通常，程序总是根据运行时才知道的某些条件去创建新的对象。在此之前，无法知道所需对象的数量甚至确切类型"><meta property="og:image" content="https://ng-tech.icu/media/sharing.png"><meta property="twitter:image" content="https://ng-tech.icu/media/sharing.png"><meta property="og:locale" content="zh"><title>12-Collections | Next-gen Tech Edu</title></head><body id=top data-spy=scroll data-offset=70 data-target=#TableOfContents class=page-wrapper data-wc-page-id=c8a79a4ab9747888be44e87558183748><button onclick=topFunction() id=backTopBtn title="Go to top"><i class="fa-solid fa-circle-up" aria-hidden=true></i></button>
<script src=/js/wowchemy-init.min.14a0ed61c6dbd594b9c75193b25be179.js></script><aside class=search-modal id=search><div class=container><section class=search-header><div class="row no-gutters justify-content-between mb-3"><div class="col-6 search-title"><p>搜索</p></div><div class="col-6 col-search-close"><a class=js-search href=# aria-label=关闭><i class="fas fa-times-circle text-muted" aria-hidden=true></i></a></div></div><div id=search-box></div></section><section class=section-search-results><div id=search-hits></div><div id=search-common-queries></div></section></div></aside><div class=page-header><header class=header--fixed><nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id=navbar-main><div class=container-xl><div class="d-none d-lg-inline-flex"><a class=navbar-brand href=/>Next-gen Tech Edu</a></div><button type=button class=navbar-toggler data-toggle=collapse data-target=#navbar-content aria-controls=navbar-content aria-expanded=false aria-label=切换导航>
<span><i class="fas fa-bars"></i></span></button><div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none"><a class=navbar-brand href=/>Next-gen Tech Edu</a></div><div class="navbar-collapse main-menu-item collapse justify-content-start" id=navbar-content><ul class="navbar-nav d-md-inline-flex"><li class=nav-item><a class=nav-link href=/books-gallery><span>笔记（万篇）</span></a></li><li class=nav-item><a class=nav-link href=/#knowledge-map><span>知识图谱</span></a></li><style>.dropdown-item{display:inline-flex}</style><li class="nav-item dropdown"><a href=# class="nav-link dropdown-toggle" data-toggle=dropdown aria-haspopup=true><span>实验室</span><span class=caret></span></a><div class=dropdown-menu><a class=dropdown-item href=/galaxy-home/gh-craft><span>Craft 方块世界</span></a>
<a class=dropdown-item href=/galaxy-home/glossary-cards><span>3D 知识卡牌</span></a></div></li><style>.dropdown-item{display:inline-flex}</style><li class="nav-item dropdown"><a href=# class="nav-link dropdown-toggle" data-toggle=dropdown aria-haspopup=true><span>其他阅读渠道</span><span class=caret></span></a><div class=dropdown-menu><a class=dropdown-item href=https://zhuanlan.zhihu.com/wxyyxc1992><img style=width:16px;height:16px;display:inline-block;margin-right:8px src=https://ngte-superbed.oss-cn-beijing.aliyuncs.com/item/20230218234451.png></img><span>知乎</span></a>
<a class=dropdown-item href=https://segmentfault.com/blog/wxyyxc1992><img style=width:16px;height:16px;display:inline-block;margin-right:8px src=https://ngte-superbed.oss-cn-beijing.aliyuncs.com/item/20230219113556.png></img><span>SegmentFault</span></a>
<a class=dropdown-item href=https://zhuanlan.zhihu.com/wxyyxc1992><img style=width:16px;height:16px;display:inline-block;margin-right:8px src=https://ngte-superbed.oss-cn-beijing.aliyuncs.com/item/20230219113519.png></img><span>掘金</span></a></div></li></ul></div><ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2"><li class=nav-item><a class="nav-link js-search" href=# aria-label=搜索><i class="fas fa-search" aria-hidden=true></i></a></li><li class=nav-item><a class=nav-link href=https://github.com/wx-chevalier aria-label=GitHub><i class="fa-brands fa-github" aria-hidden=true></i></a></li><div></div><style>@media only screen and (max-width:600px){.jimmysong-template{display:none!important}}</style><li class=jimmysong-template style=color:#fff;font-size:12px><a href=https://jimmysong.io style=color:#fff>By Jimmy Song's Template</a></li></ul></div></nav></header></div><div class=page-body><link rel=stylesheet href=//unpkg.com/heti/umd/heti.min.css><div class="container-xl docs"><div class="row flex-xl-nowrap"><div class=docs-sidebar><form class="docs-search d-flex align-items-center"><button class="btn docs-toggle d-md-none p-0 mr-md-3 w-100" type=button data-toggle=collapse data-target=#docs-nav aria-controls=docs-nav aria-expanded=false aria-label="Toggle section navigation"><div class=d-flex><span class="d-md-none pl-1 flex-grow-1 text-left overflow-hidden">On Java 8</span>
<span><i class="fas fa-chevron-down"></i></span></div></button>
<button class="form-control sidebar-search js-search d-none d-md-flex">
<i class="fas fa-search pr-2"></i>
<span class=sidebar-search-text>搜索...</span>
<span class=sidebar-search-shortcut>/</span></button></form><nav class="collapse docs-links" id=docs-nav><ul class="nav docs-sidenav"><li style=display:inline-flex><a style=cursor:pointer onclick=window.history.back()><i class="fas fa-arrow-left pr-1"></i>
Back</a>
<span>|</span>
<a href=/books/><i class="fa-solid fa-house" style=margin-right:4px></i>
Books</a></li></ul><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-idb9e60239e3d748bf31eb7c5de38f5561")' href=#idb9e60239e3d748bf31eb7c5de38f5561 aria-expanded=false aria-controls=idb9e60239e3d748bf31eb7c5de38f5561 aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/>99.参考资料</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#idb9e60239e3d748bf31eb7c5de38f5561 aria-expanded=false aria-controls=idb9e60239e3d748bf31eb7c5de38f5561><i class="fa-solid fa-angle-down" id=caret-idb9e60239e3d748bf31eb7c5de38f5561></i></a></div><ul class="nav docs-sidenav collapse show" id=idb9e60239e3d748bf31eb7c5de38f5561><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-id51f028053e6be7c11b12b7b0d4faa770")' href=#id51f028053e6be7c11b12b7b0d4faa770 aria-expanded=false aria-controls=id51f028053e6be7c11b12b7b0d4faa770 aria-hidden=false data-toggle=collapse></div></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-idd95d813603af3028b9bceaec8ff661e1")' href=#idd95d813603af3028b9bceaec8ff661e1 aria-expanded=false aria-controls=idd95d813603af3028b9bceaec8ff661e1 aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/>On Java 8</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#idd95d813603af3028b9bceaec8ff661e1 aria-expanded=false aria-controls=idd95d813603af3028b9bceaec8ff661e1><i class="fa-solid fa-angle-down" id=caret-idd95d813603af3028b9bceaec8ff661e1></i></a></div><ul class="nav docs-sidenav collapse show" id=idd95d813603af3028b9bceaec8ff661e1><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/00-introduction/>00-Introduction</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/01-what-is-an-object/>01-What-is-an-Object</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/02-installing-java-and-the-book-examples/>02-Installing-Java-and-the-Book-Examples</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/03-objects-everywhere/>03-Objects-Everywhere</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/04-operators/>04-Operators</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/05-control-flow/>05-Control-Flow</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/06-housekeeping/>06-Housekeeping</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/07-implementation-hiding/>07-Implementation-Hiding</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/08-reuse/>08-Reuse</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/09-polymorphism/>09-Polymorphism</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/10-interfaces/>10-Interfaces</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/11-inner-classes/>11-Inner-Classes</a></li><li class="child level active"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/12-collections/>12-Collections</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/13-functional-programming/>13-Functional-Programming</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/14-streams/>14-Streams</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/15-exceptions/>15-Exceptions</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/16-validating-your-code/>16-Validating-Your-Code</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/17-files/>17-Files</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/18-strings/>18-Strings</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/19-type-information/>19-Type-Information</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/20-generics/>20-Generics</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/21-arrays/>21-Arrays</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/22-enumerations/>22-Enumerations</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/23-annotations/>23-Annotations</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/24-concurrent-programming/>24-Concurrent-Programming</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/25-patterns/>25-Patterns</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/appendix-becoming-a-programmer/>Appendix-Becoming-a-Programmer</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/appendix-benefits-and-costs-of-static-type-checking/>Appendix-Benefits-and-Costs-of-Static-Type-Checking</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/appendix-collection-topics/>Appendix-Collection-Topics</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/appendix-data-compression/>Appendix-Data-Compression</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/appendix-io-streams/>Appendix-IO-Streams</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/appendix-javadoc/>Appendix-Javadoc</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/appendix-low-level-concurrency/>Appendix-Low-Level-Concurrency</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/appendix-new-io/>Appendix-New-IO</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/appendix-object-serialization/>Appendix-Object-Serialization</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/appendix-passing-and-returning-objects/>Appendix-Passing-and-Returning-Objects</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/appendix-programming-guidelines/>Appendix-Programming-Guidelines</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/appendix-standard-io/>Appendix-Standard-IO</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/appendix-supplements/>Appendix-Supplements</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/appendix-the-positive-legacy-of-c-plus-plus-and-java/>Appendix-The-Positive-Legacy-of-C-plus-plus-and-Java</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/appendix-understanding-equals-and-hashcode/>Appendix-Understanding-equals-and-hashCode</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/glossary/>GLOSSARY</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-id775c4a5ac3467743f5bb8deee7e9fdbf")' href=#id775c4a5ac3467743f5bb8deee7e9fdbf aria-expanded=false aria-controls=id775c4a5ac3467743f5bb8deee7e9fdbf aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/>Think in Java</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#id775c4a5ac3467743f5bb8deee7e9fdbf aria-expanded=false aria-controls=id775c4a5ac3467743f5bb8deee7e9fdbf><i class="fa-solid fa-angle-right" id=caret-id775c4a5ac3467743f5bb8deee7e9fdbf></i></a></div><ul class="nav docs-sidenav collapse" id=id775c4a5ac3467743f5bb8deee7e9fdbf><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-id525871933f7d0cc39b215ee01317566e")' href=#id525871933f7d0cc39b215ee01317566e aria-expanded=false aria-controls=id525871933f7d0cc39b215ee01317566e aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/01.%E5%AF%B9%E8%B1%A1%E5%85%A5%E9%97%A8/>01.对象入门</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#id525871933f7d0cc39b215ee01317566e aria-expanded=false aria-controls=id525871933f7d0cc39b215ee01317566e><i class="fa-solid fa-angle-right" id=caret-id525871933f7d0cc39b215ee01317566e></i></a></div><ul class="nav docs-sidenav collapse" id=id525871933f7d0cc39b215ee01317566e><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/01.%E5%AF%B9%E8%B1%A1%E5%85%A5%E9%97%A8/1.1-%E6%8A%BD%E8%B1%A1%E7%9A%84%E8%BF%9B%E6%AD%A5/>1.1 抽象的进步</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/01.%E5%AF%B9%E8%B1%A1%E5%85%A5%E9%97%A8/1.10-%E6%B0%B8%E4%B9%85%E6%80%A7/>1.10 永久性</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/01.%E5%AF%B9%E8%B1%A1%E5%85%A5%E9%97%A8/1.11-java%E5%92%8C%E5%9B%A0%E7%89%B9%E7%BD%91/>1.11 Java和因特网</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/01.%E5%AF%B9%E8%B1%A1%E5%85%A5%E9%97%A8/1.12-%E5%88%86%E6%9E%90%E5%92%8C%E8%AE%BE%E8%AE%A1/>1.12 分析和设计</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/01.%E5%AF%B9%E8%B1%A1%E5%85%A5%E9%97%A8/1.13-java%E8%BF%98%E6%98%AFc++/>1.13 Java还是C++</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/01.%E5%AF%B9%E8%B1%A1%E5%85%A5%E9%97%A8/1.2-%E5%AF%B9%E8%B1%A1%E7%9A%84%E6%8E%A5%E5%8F%A3/>1.2 对象的接口</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/01.%E5%AF%B9%E8%B1%A1%E5%85%A5%E9%97%A8/1.3-%E5%AE%9E%E7%8E%B0%E6%96%B9%E6%A1%88%E7%9A%84%E9%9A%90%E8%97%8F/>1.3 实现方案的隐藏</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/01.%E5%AF%B9%E8%B1%A1%E5%85%A5%E9%97%A8/1.4-%E6%96%B9%E6%A1%88%E7%9A%84%E9%87%8D%E5%A4%8D%E4%BD%BF%E7%94%A8/>1.4 方案的重复使用</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/01.%E5%AF%B9%E8%B1%A1%E5%85%A5%E9%97%A8/1.5-%E7%BB%A7%E6%89%BF%E9%87%8D%E6%96%B0%E4%BD%BF%E7%94%A8%E6%8E%A5%E5%8F%A3/>1.5 继承：重新使用接口</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/01.%E5%AF%B9%E8%B1%A1%E5%85%A5%E9%97%A8/1.6-%E5%A4%9A%E6%80%81%E5%AF%B9%E8%B1%A1%E7%9A%84%E4%BA%92%E6%8D%A2%E4%BD%BF%E7%94%A8/>1.6 多态对象的互换使用</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/01.%E5%AF%B9%E8%B1%A1%E5%85%A5%E9%97%A8/1.7-%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%88%9B%E5%BB%BA%E5%92%8C%E5%AD%98%E5%9C%A8%E6%97%B6%E9%97%B4/>1.7 对象的创建和存在时间</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/01.%E5%AF%B9%E8%B1%A1%E5%85%A5%E9%97%A8/1.9-%E5%A4%9A%E7%BA%BF%E7%A8%8B/>1.9 多线程</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-id6e74b2031f353ee0d7c0be1f38b16030")' href=#id6e74b2031f353ee0d7c0be1f38b16030 aria-expanded=false aria-controls=id6e74b2031f353ee0d7c0be1f38b16030 aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/02.%E4%B8%80%E5%88%87%E9%83%BD%E6%98%AF%E5%AF%B9%E8%B1%A1/>02.一切都是对象</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#id6e74b2031f353ee0d7c0be1f38b16030 aria-expanded=false aria-controls=id6e74b2031f353ee0d7c0be1f38b16030><i class="fa-solid fa-angle-right" id=caret-id6e74b2031f353ee0d7c0be1f38b16030></i></a></div><ul class="nav docs-sidenav collapse" id=id6e74b2031f353ee0d7c0be1f38b16030><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/02.%E4%B8%80%E5%88%87%E9%83%BD%E6%98%AF%E5%AF%B9%E8%B1%A1/2.1-%E7%94%A8%E6%8C%87%E9%92%88%E6%93%8D%E7%BA%B5%E5%AF%B9%E8%B1%A1/>2.1 用指针操纵对象</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/02.%E4%B8%80%E5%88%87%E9%83%BD%E6%98%AF%E5%AF%B9%E8%B1%A1/2.10-%E6%80%BB%E7%BB%93/>2.10 总结</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/02.%E4%B8%80%E5%88%87%E9%83%BD%E6%98%AF%E5%AF%B9%E8%B1%A1/2.11-%E7%BB%83%E4%B9%A0/>2.11 练习</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/02.%E4%B8%80%E5%88%87%E9%83%BD%E6%98%AF%E5%AF%B9%E8%B1%A1/2.2-%E6%89%80%E6%9C%89%E5%AF%B9%E8%B1%A1%E9%83%BD%E5%BF%85%E9%A1%BB%E5%88%9B%E5%BB%BA/>2.2 所有对象都必须创建</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/02.%E4%B8%80%E5%88%87%E9%83%BD%E6%98%AF%E5%AF%B9%E8%B1%A1/2.3-%E7%BB%9D%E5%AF%B9%E4%B8%8D%E8%A6%81%E6%B8%85%E9%99%A4%E5%AF%B9%E8%B1%A1/>2.3 绝对不要清除对象</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/02.%E4%B8%80%E5%88%87%E9%83%BD%E6%98%AF%E5%AF%B9%E8%B1%A1/2.4-%E6%96%B0%E5%BB%BA%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E7%B1%BB/>2.4 新建数据类型：类</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/02.%E4%B8%80%E5%88%87%E9%83%BD%E6%98%AF%E5%AF%B9%E8%B1%A1/2.5-%E6%96%B9%E6%B3%95%E8%87%AA%E5%8F%98%E9%87%8F%E5%92%8C%E8%BF%94%E5%9B%9E%E5%80%BC/>2.5 方法、自变量和返回值</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/02.%E4%B8%80%E5%88%87%E9%83%BD%E6%98%AF%E5%AF%B9%E8%B1%A1/2.6-%E6%9E%84%E5%BB%BAjava%E7%A8%8B%E5%BA%8F/>2.6 构建Java程序</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/02.%E4%B8%80%E5%88%87%E9%83%BD%E6%98%AF%E5%AF%B9%E8%B1%A1/2.7-%E6%88%91%E4%BB%AC%E7%9A%84%E7%AC%AC%E4%B8%80%E4%B8%AAjava%E7%A8%8B%E5%BA%8F/>2.7 我们的第一个Java程序</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/02.%E4%B8%80%E5%88%87%E9%83%BD%E6%98%AF%E5%AF%B9%E8%B1%A1/2.8-%E6%B3%A8%E9%87%8A%E5%92%8C%E5%B5%8C%E5%85%A5%E6%96%87%E6%A1%A3/>2.8 注释和嵌入文档</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/02.%E4%B8%80%E5%88%87%E9%83%BD%E6%98%AF%E5%AF%B9%E8%B1%A1/2.9-%E7%BC%96%E7%A0%81%E6%A0%B7%E5%BC%8F/>2.9 编码样式</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-id0b455eccb2d5251702c12cae8b51f71f")' href=#id0b455eccb2d5251702c12cae8b51f71f aria-expanded=false aria-controls=id0b455eccb2d5251702c12cae8b51f71f aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/03.%E6%8E%A7%E5%88%B6%E7%A8%8B%E5%BA%8F%E6%B5%81%E7%A8%8B/>03.控制程序流程</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#id0b455eccb2d5251702c12cae8b51f71f aria-expanded=false aria-controls=id0b455eccb2d5251702c12cae8b51f71f><i class="fa-solid fa-angle-right" id=caret-id0b455eccb2d5251702c12cae8b51f71f></i></a></div><ul class="nav docs-sidenav collapse" id=id0b455eccb2d5251702c12cae8b51f71f><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/03.%E6%8E%A7%E5%88%B6%E7%A8%8B%E5%BA%8F%E6%B5%81%E7%A8%8B/3.1-%E4%BD%BF%E7%94%A8java%E8%BF%90%E7%AE%97%E7%AC%A6/>3.1 使用Java运算符</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/03.%E6%8E%A7%E5%88%B6%E7%A8%8B%E5%BA%8F%E6%B5%81%E7%A8%8B/3.2-%E6%89%A7%E8%A1%8C%E6%8E%A7%E5%88%B6/>3.2 执行控制</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/03.%E6%8E%A7%E5%88%B6%E7%A8%8B%E5%BA%8F%E6%B5%81%E7%A8%8B/3.3-%E6%80%BB%E7%BB%93/>3.3 总结</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/03.%E6%8E%A7%E5%88%B6%E7%A8%8B%E5%BA%8F%E6%B5%81%E7%A8%8B/3.4-%E7%BB%83%E4%B9%A0/>3.4 练习</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-idc03315e84905a55e301cb35219ba082d")' href=#idc03315e84905a55e301cb35219ba082d aria-expanded=false aria-controls=idc03315e84905a55e301cb35219ba082d aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/04.%E5%88%9D%E5%A7%8B%E5%8C%96%E5%92%8C%E6%B8%85%E9%99%A4/>04.初始化和清除</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#idc03315e84905a55e301cb35219ba082d aria-expanded=false aria-controls=idc03315e84905a55e301cb35219ba082d><i class="fa-solid fa-angle-right" id=caret-idc03315e84905a55e301cb35219ba082d></i></a></div><ul class="nav docs-sidenav collapse" id=idc03315e84905a55e301cb35219ba082d><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/04.%E5%88%9D%E5%A7%8B%E5%8C%96%E5%92%8C%E6%B8%85%E9%99%A4/4.1-%E7%94%A8%E6%9E%84%E9%80%A0%E5%99%A8%E8%87%AA%E5%8A%A8%E5%88%9D%E5%A7%8B%E5%8C%96/>4.1 用构造器自动初始化</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/04.%E5%88%9D%E5%A7%8B%E5%8C%96%E5%92%8C%E6%B8%85%E9%99%A4/4.2-%E6%96%B9%E6%B3%95%E9%87%8D%E8%BD%BD/>4.2 方法重载</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/04.%E5%88%9D%E5%A7%8B%E5%8C%96%E5%92%8C%E6%B8%85%E9%99%A4/4.3-%E6%B8%85%E9%99%A4%E6%94%B6%E5%B0%BE%E5%92%8C%E5%9E%83%E5%9C%BE%E6%94%B6%E9%9B%86/>4.3 清除：收尾和垃圾收集</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/04.%E5%88%9D%E5%A7%8B%E5%8C%96%E5%92%8C%E6%B8%85%E9%99%A4/4.4-%E6%88%90%E5%91%98%E5%88%9D%E5%A7%8B%E5%8C%96/>4.4 成员初始化</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/04.%E5%88%9D%E5%A7%8B%E5%8C%96%E5%92%8C%E6%B8%85%E9%99%A4/4.5-%E6%95%B0%E7%BB%84%E5%88%9D%E5%A7%8B%E5%8C%96/>4.5 数组初始化</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/04.%E5%88%9D%E5%A7%8B%E5%8C%96%E5%92%8C%E6%B8%85%E9%99%A4/4.6-%E6%80%BB%E7%BB%93/>4.6 总结</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/04.%E5%88%9D%E5%A7%8B%E5%8C%96%E5%92%8C%E6%B8%85%E9%99%A4/4.7-%E7%BB%83%E4%B9%A0/>4.7 练习</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-id6fef31548d834cfab9ca7921ca0ffbc7")' href=#id6fef31548d834cfab9ca7921ca0ffbc7 aria-expanded=false aria-controls=id6fef31548d834cfab9ca7921ca0ffbc7 aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/05.%E9%9A%90%E8%97%8F%E5%AE%9E%E6%96%BD%E8%BF%87%E7%A8%8B/>05.隐藏实施过程</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#id6fef31548d834cfab9ca7921ca0ffbc7 aria-expanded=false aria-controls=id6fef31548d834cfab9ca7921ca0ffbc7><i class="fa-solid fa-angle-right" id=caret-id6fef31548d834cfab9ca7921ca0ffbc7></i></a></div><ul class="nav docs-sidenav collapse" id=id6fef31548d834cfab9ca7921ca0ffbc7><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/05.%E9%9A%90%E8%97%8F%E5%AE%9E%E6%96%BD%E8%BF%87%E7%A8%8B/5.1-%E5%8C%85%E5%BA%93%E5%8D%95%E5%85%83/>5.1 包：库单元</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/05.%E9%9A%90%E8%97%8F%E5%AE%9E%E6%96%BD%E8%BF%87%E7%A8%8B/5.2-java%E8%AE%BF%E9%97%AE%E6%8C%87%E7%A4%BA%E7%AC%A6/>5.2 Java访问指示符</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/05.%E9%9A%90%E8%97%8F%E5%AE%9E%E6%96%BD%E8%BF%87%E7%A8%8B/5.3-%E6%8E%A5%E5%8F%A3%E4%B8%8E%E5%AE%9E%E7%8E%B0/>5.3 接口与实现</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/05.%E9%9A%90%E8%97%8F%E5%AE%9E%E6%96%BD%E8%BF%87%E7%A8%8B/5.4-%E7%B1%BB%E8%AE%BF%E9%97%AE/>5.4 类访问</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/05.%E9%9A%90%E8%97%8F%E5%AE%9E%E6%96%BD%E8%BF%87%E7%A8%8B/5.5-%E6%80%BB%E7%BB%93/>5.5 总结</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/05.%E9%9A%90%E8%97%8F%E5%AE%9E%E6%96%BD%E8%BF%87%E7%A8%8B/5.6-%E7%BB%83%E4%B9%A0/>5.6 练习</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-id1e5c8731a846b682af97a54cf15b18cd")' href=#id1e5c8731a846b682af97a54cf15b18cd aria-expanded=false aria-controls=id1e5c8731a846b682af97a54cf15b18cd aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/06.%E7%B1%BB%E5%86%8D%E7%94%9F/>06.类再生</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#id1e5c8731a846b682af97a54cf15b18cd aria-expanded=false aria-controls=id1e5c8731a846b682af97a54cf15b18cd><i class="fa-solid fa-angle-right" id=caret-id1e5c8731a846b682af97a54cf15b18cd></i></a></div><ul class="nav docs-sidenav collapse" id=id1e5c8731a846b682af97a54cf15b18cd><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/06.%E7%B1%BB%E5%86%8D%E7%94%9F/6.1-%E5%90%88%E6%88%90%E7%9A%84%E8%AF%AD%E6%B3%95/>6.1 合成的语法</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/06.%E7%B1%BB%E5%86%8D%E7%94%9F/6.10-%E6%80%BB%E7%BB%93/>6.10 总结</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/06.%E7%B1%BB%E5%86%8D%E7%94%9F/6.11-%E7%BB%83%E4%B9%A0/>6.11 练习</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/06.%E7%B1%BB%E5%86%8D%E7%94%9F/6.2-%E7%BB%A7%E6%89%BF%E7%9A%84%E8%AF%AD%E6%B3%95/>6.2 继承的语法</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/06.%E7%B1%BB%E5%86%8D%E7%94%9F/6.3-%E5%90%88%E6%88%90%E4%B8%8E%E7%BB%A7%E6%89%BF%E7%9A%84%E7%BB%93%E5%90%88/>6.3 合成与继承的结合</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/06.%E7%B1%BB%E5%86%8D%E7%94%9F/6.4-%E5%88%B0%E5%BA%95%E9%80%89%E6%8B%A9%E5%90%88%E6%88%90%E8%BF%98%E6%98%AF%E7%BB%A7%E6%89%BF/>6.4 到底选择合成还是继承</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/06.%E7%B1%BB%E5%86%8D%E7%94%9F/6.5-protected/>6.5 protected</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/06.%E7%B1%BB%E5%86%8D%E7%94%9F/6.6-%E7%B4%AF%E7%A7%AF%E5%BC%80%E5%8F%91/>6.6 累积开发</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/06.%E7%B1%BB%E5%86%8D%E7%94%9F/6.7-%E4%B8%8A%E6%BA%AF%E9%80%A0%E5%9E%8B/>6.7 上溯造型</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/06.%E7%B1%BB%E5%86%8D%E7%94%9F/6.8-final%E5%85%B3%E9%94%AE%E5%AD%97/>6.8 final关键字</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/06.%E7%B1%BB%E5%86%8D%E7%94%9F/6.9-%E5%88%9D%E5%A7%8B%E5%8C%96%E5%92%8C%E7%B1%BB%E8%A3%85%E8%BD%BD/>6.9 初始化和类装载</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-id45922a3318a25b4e4144ca245e79e889")' href=#id45922a3318a25b4e4144ca245e79e889 aria-expanded=false aria-controls=id45922a3318a25b4e4144ca245e79e889 aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/07.%E5%A4%9A%E6%80%81%E6%80%A7/>07.多态性</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#id45922a3318a25b4e4144ca245e79e889 aria-expanded=false aria-controls=id45922a3318a25b4e4144ca245e79e889><i class="fa-solid fa-angle-right" id=caret-id45922a3318a25b4e4144ca245e79e889></i></a></div><ul class="nav docs-sidenav collapse" id=id45922a3318a25b4e4144ca245e79e889><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/07.%E5%A4%9A%E6%80%81%E6%80%A7/7.1-%E4%B8%8A%E6%BA%AF%E9%80%A0%E5%9E%8B/>7.1 上溯造型</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/07.%E5%A4%9A%E6%80%81%E6%80%A7/7.10-%E7%BB%83%E4%B9%A0/>7.10 练习</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/07.%E5%A4%9A%E6%80%81%E6%80%A7/7.2-%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3/>7.2 深入理解</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/07.%E5%A4%9A%E6%80%81%E6%80%A7/7.3-%E8%A6%86%E7%9B%96%E4%B8%8E%E9%87%8D%E8%BD%BD/>7.3 覆盖与重载</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/07.%E5%A4%9A%E6%80%81%E6%80%A7/7.4-%E6%8A%BD%E8%B1%A1%E7%B1%BB%E5%92%8C%E6%96%B9%E6%B3%95/>7.4 抽象类和方法</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/07.%E5%A4%9A%E6%80%81%E6%80%A7/7.5-%E6%8E%A5%E5%8F%A3/>7.5 接口</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/07.%E5%A4%9A%E6%80%81%E6%80%A7/7.6-%E5%86%85%E9%83%A8%E7%B1%BB/>7.6 内部类</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/07.%E5%A4%9A%E6%80%81%E6%80%A7/7.7-%E6%9E%84%E9%80%A0%E5%99%A8%E5%92%8C%E5%A4%9A%E6%80%81%E6%80%A7/>7.7 构造器和多态性</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/07.%E5%A4%9A%E6%80%81%E6%80%A7/7.8-%E9%80%9A%E8%BF%87%E7%BB%A7%E6%89%BF%E8%BF%9B%E8%A1%8C%E8%AE%BE%E8%AE%A1/>7.8 通过继承进行设计</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/07.%E5%A4%9A%E6%80%81%E6%80%A7/7.9-%E6%80%BB%E7%BB%93/>7.9 总结</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-id27abd1286c9d000b592443d2141c9a55")' href=#id27abd1286c9d000b592443d2141c9a55 aria-expanded=false aria-controls=id27abd1286c9d000b592443d2141c9a55 aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/08.%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%AE%B9%E7%BA%B3/>08.对象的容纳</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#id27abd1286c9d000b592443d2141c9a55 aria-expanded=false aria-controls=id27abd1286c9d000b592443d2141c9a55><i class="fa-solid fa-angle-right" id=caret-id27abd1286c9d000b592443d2141c9a55></i></a></div><ul class="nav docs-sidenav collapse" id=id27abd1286c9d000b592443d2141c9a55><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/08.%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%AE%B9%E7%BA%B3/8.1-%E6%95%B0%E7%BB%84/>8.1 数组</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/08.%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%AE%B9%E7%BA%B3/8.2-%E9%9B%86%E5%90%88/>8.2 集合</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/08.%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%AE%B9%E7%BA%B3/8.3-%E8%BF%AD%E4%BB%A3%E5%99%A8/>8.3 迭代器</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/08.%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%AE%B9%E7%BA%B3/8.4-%E9%9B%86%E5%90%88%E7%9A%84%E7%B1%BB%E5%9E%8B/>8.4 集合的类型</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/08.%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%AE%B9%E7%BA%B3/8.5-%E6%8E%92%E5%BA%8F/>8.5 排序</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/08.%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%AE%B9%E7%BA%B3/8.6-%E9%80%9A%E7%94%A8%E9%9B%86%E5%90%88%E5%BA%93/>8.6 通用集合库</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/08.%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%AE%B9%E7%BA%B3/8.7-%E6%96%B0%E9%9B%86%E5%90%88/>8.7 新集合</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/08.%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%AE%B9%E7%BA%B3/8.8-%E6%80%BB%E7%BB%93/>8.8 总结</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/08.%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%AE%B9%E7%BA%B3/8.9-%E7%BB%83%E4%B9%A0/>8.9 练习</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-id223a02026171e117fd7610f7a814d5db")' href=#id223a02026171e117fd7610f7a814d5db aria-expanded=false aria-controls=id223a02026171e117fd7610f7a814d5db aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/09.%E5%BC%82%E5%B8%B8%E5%B7%AE%E9%94%99%E6%8E%A7%E5%88%B6/>09.异常差错控制</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#id223a02026171e117fd7610f7a814d5db aria-expanded=false aria-controls=id223a02026171e117fd7610f7a814d5db><i class="fa-solid fa-angle-right" id=caret-id223a02026171e117fd7610f7a814d5db></i></a></div><ul class="nav docs-sidenav collapse" id=id223a02026171e117fd7610f7a814d5db><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/09.%E5%BC%82%E5%B8%B8%E5%B7%AE%E9%94%99%E6%8E%A7%E5%88%B6/9.10-%E7%BB%83%E4%B9%A0/>9.10 练习</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/09.%E5%BC%82%E5%B8%B8%E5%B7%AE%E9%94%99%E6%8E%A7%E5%88%B6/9.6-%E7%94%A8finally%E6%B8%85%E9%99%A4/>9.6 用finally清除</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/09.%E5%BC%82%E5%B8%B8%E5%B7%AE%E9%94%99%E6%8E%A7%E5%88%B6/9.7-%E6%9E%84%E9%80%A0%E5%99%A8/>9.7 构造器</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/09.%E5%BC%82%E5%B8%B8%E5%B7%AE%E9%94%99%E6%8E%A7%E5%88%B6/9.9-%E6%80%BB%E7%BB%93/>9.9 总结</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-idcac6e18458602ce17bd9b0b2c3e18daa")' href=#idcac6e18458602ce17bd9b0b2c3e18daa aria-expanded=false aria-controls=idcac6e18458602ce17bd9b0b2c3e18daa aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/10.java-io-%E7%B3%BB%E7%BB%9F/>10.Java IO 系统</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#idcac6e18458602ce17bd9b0b2c3e18daa aria-expanded=false aria-controls=idcac6e18458602ce17bd9b0b2c3e18daa><i class="fa-solid fa-angle-right" id=caret-idcac6e18458602ce17bd9b0b2c3e18daa></i></a></div><ul class="nav docs-sidenav collapse" id=idcac6e18458602ce17bd9b0b2c3e18daa><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/10.java-io-%E7%B3%BB%E7%BB%9F/10.1-%E8%BE%93%E5%85%A5%E5%92%8C%E8%BE%93%E5%87%BA/>10.1 输入和输出</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/10.java-io-%E7%B3%BB%E7%BB%9F/10.10-%E6%80%BB%E7%BB%93/>10.10 总结</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/10.java-io-%E7%B3%BB%E7%BB%9F/10.11-%E7%BB%83%E4%B9%A0/>10.11 练习</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/10.java-io-%E7%B3%BB%E7%BB%9F/10.2-%E5%A2%9E%E6%B7%BB%E5%B1%9E%E6%80%A7%E5%92%8C%E6%9C%89%E7%94%A8%E7%9A%84%E6%8E%A5%E5%8F%A3/>10.2 增添属性和有用的接口</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/10.java-io-%E7%B3%BB%E7%BB%9F/10.3-%E6%9C%AC%E8%BA%AB%E7%9A%84%E7%BC%BA%E9%99%B7randomaccessfile/>10.3 本身的缺陷：RandomAccessFile</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/10.java-io-%E7%B3%BB%E7%BB%9F/10.4-file%E7%B1%BB/>10.4 File类</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/10.java-io-%E7%B3%BB%E7%BB%9F/10.5-io%E6%B5%81%E7%9A%84%E5%85%B8%E5%9E%8B%E5%BA%94%E7%94%A8/>10.5 IO流的典型应用</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/10.java-io-%E7%B3%BB%E7%BB%9F/10.6-streamtokenizer/>10.6 StreamTokenizer</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/10.java-io-%E7%B3%BB%E7%BB%9F/10.7-java-1.1%E7%9A%84io%E6%B5%81/>10.7 Java 1.1的IO流</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/10.java-io-%E7%B3%BB%E7%BB%9F/10.8-%E5%8E%8B%E7%BC%A9/>10.8 压缩</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/10.java-io-%E7%B3%BB%E7%BB%9F/10.9-%E5%AF%B9%E8%B1%A1%E5%BA%8F%E5%88%97%E5%8C%96/>10.9 对象序列化</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-idfe15c0b7d69e1eea4a39a92683a168d4")' href=#idfe15c0b7d69e1eea4a39a92683a168d4 aria-expanded=false aria-controls=idfe15c0b7d69e1eea4a39a92683a168d4 aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/11.%E8%BF%90%E8%A1%8C%E6%9C%9F%E7%B1%BB%E5%9E%8B%E9%89%B4%E5%AE%9A/>11.运行期类型鉴定</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#idfe15c0b7d69e1eea4a39a92683a168d4 aria-expanded=false aria-controls=idfe15c0b7d69e1eea4a39a92683a168d4><i class="fa-solid fa-angle-right" id=caret-idfe15c0b7d69e1eea4a39a92683a168d4></i></a></div><ul class="nav docs-sidenav collapse" id=idfe15c0b7d69e1eea4a39a92683a168d4><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/11.%E8%BF%90%E8%A1%8C%E6%9C%9F%E7%B1%BB%E5%9E%8B%E9%89%B4%E5%AE%9A/11.1-%E5%AF%B9rtti%E7%9A%84%E9%9C%80%E8%A6%81/>11.1 对RTTI的需要</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/11.%E8%BF%90%E8%A1%8C%E6%9C%9F%E7%B1%BB%E5%9E%8B%E9%89%B4%E5%AE%9A/11.2-rtti-%E8%AF%AD%E6%B3%95/>11.2 RTTI 语法</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/11.%E8%BF%90%E8%A1%8C%E6%9C%9F%E7%B1%BB%E5%9E%8B%E9%89%B4%E5%AE%9A/11.3-%E5%8F%8D%E5%B0%84%E8%BF%90%E8%A1%8C%E6%9C%9F%E7%B1%BB%E4%BF%A1%E6%81%AF/>11.3 反射：运行期类信息</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/11.%E8%BF%90%E8%A1%8C%E6%9C%9F%E7%B1%BB%E5%9E%8B%E9%89%B4%E5%AE%9A/11.4-%E6%80%BB%E7%BB%93/>11.4 总结</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/11.%E8%BF%90%E8%A1%8C%E6%9C%9F%E7%B1%BB%E5%9E%8B%E9%89%B4%E5%AE%9A/11.5-%E7%BB%83%E4%B9%A0/>11.5 练习</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-iddf7cc690622f50701352bac88f5de264")' href=#iddf7cc690622f50701352bac88f5de264 aria-expanded=false aria-controls=iddf7cc690622f50701352bac88f5de264 aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/12.%E4%BC%A0%E9%80%92%E5%92%8C%E8%BF%94%E5%9B%9E%E5%AF%B9%E8%B1%A1/>12.传递和返回对象</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#iddf7cc690622f50701352bac88f5de264 aria-expanded=false aria-controls=iddf7cc690622f50701352bac88f5de264><i class="fa-solid fa-angle-right" id=caret-iddf7cc690622f50701352bac88f5de264></i></a></div><ul class="nav docs-sidenav collapse" id=iddf7cc690622f50701352bac88f5de264><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/12.%E4%BC%A0%E9%80%92%E5%92%8C%E8%BF%94%E5%9B%9E%E5%AF%B9%E8%B1%A1/12.1-%E4%BC%A0%E9%80%92%E6%8C%87%E9%92%88/>12.1 传递指针</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/12.%E4%BC%A0%E9%80%92%E5%92%8C%E8%BF%94%E5%9B%9E%E5%AF%B9%E8%B1%A1/12.2-%E5%88%B6%E4%BD%9C%E6%9C%AC%E5%9C%B0%E5%89%AF%E6%9C%AC/>12.2 制作本地副本</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/12.%E4%BC%A0%E9%80%92%E5%92%8C%E8%BF%94%E5%9B%9E%E5%AF%B9%E8%B1%A1/12.3-%E5%85%8B%E9%9A%86%E7%9A%84%E6%8E%A7%E5%88%B6/>12.3 克隆的控制</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/12.%E4%BC%A0%E9%80%92%E5%92%8C%E8%BF%94%E5%9B%9E%E5%AF%B9%E8%B1%A1/12.4-%E5%8F%AA%E8%AF%BB%E7%B1%BB/>12.4 只读类</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/12.%E4%BC%A0%E9%80%92%E5%92%8C%E8%BF%94%E5%9B%9E%E5%AF%B9%E8%B1%A1/12.5-%E6%80%BB%E7%BB%93/>12.5 总结</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/12.%E4%BC%A0%E9%80%92%E5%92%8C%E8%BF%94%E5%9B%9E%E5%AF%B9%E8%B1%A1/12.6-%E7%BB%83%E4%B9%A0/>12.6 练习</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-idb1a9edc38a9b424eca8c6736e315c5f2")' href=#idb1a9edc38a9b424eca8c6736e315c5f2 aria-expanded=false aria-controls=idb1a9edc38a9b424eca8c6736e315c5f2 aria-hidden=false data-toggle=collapse></div></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-id80c764609525f094184dd5b161c7244d")' href=#id80c764609525f094184dd5b161c7244d aria-expanded=false aria-controls=id80c764609525f094184dd5b161c7244d aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/14.%E5%A4%9A%E7%BA%BF%E7%A8%8B/>14.多线程</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#id80c764609525f094184dd5b161c7244d aria-expanded=false aria-controls=id80c764609525f094184dd5b161c7244d><i class="fa-solid fa-angle-right" id=caret-id80c764609525f094184dd5b161c7244d></i></a></div><ul class="nav docs-sidenav collapse" id=id80c764609525f094184dd5b161c7244d><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/14.%E5%A4%9A%E7%BA%BF%E7%A8%8B/14.1-%E5%8F%8D%E5%BA%94%E7%81%B5%E6%95%8F%E7%9A%84%E7%94%A8%E6%88%B7%E7%95%8C%E9%9D%A2/>14.1 反应灵敏的用户界面</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/14.%E5%A4%9A%E7%BA%BF%E7%A8%8B/14.2-%E5%85%B1%E4%BA%AB%E6%9C%89%E9%99%90%E7%9A%84%E8%B5%84%E6%BA%90/>14.2 共享有限的资源</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/14.%E5%A4%9A%E7%BA%BF%E7%A8%8B/14.3-%E5%A0%B5%E5%A1%9E/>14.3 堵塞</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/14.%E5%A4%9A%E7%BA%BF%E7%A8%8B/14.4-%E4%BC%98%E5%85%88%E7%BA%A7/>14.4 优先级</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/14.%E5%A4%9A%E7%BA%BF%E7%A8%8B/14.5-%E5%9B%9E%E9%A1%BErunnable/>14.5 回顾runnable</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/14.%E5%A4%9A%E7%BA%BF%E7%A8%8B/14.6-%E6%80%BB%E7%BB%93/>14.6 总结</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/14.%E5%A4%9A%E7%BA%BF%E7%A8%8B/14.7-%E7%BB%83%E4%B9%A0/>14.7 练习</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-id72c1a5699f783ea8a67f0eb1d1d396e1")' href=#id72c1a5699f783ea8a67f0eb1d1d396e1 aria-expanded=false aria-controls=id72c1a5699f783ea8a67f0eb1d1d396e1 aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/15.%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/>15.网络编程</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#id72c1a5699f783ea8a67f0eb1d1d396e1 aria-expanded=false aria-controls=id72c1a5699f783ea8a67f0eb1d1d396e1><i class="fa-solid fa-angle-right" id=caret-id72c1a5699f783ea8a67f0eb1d1d396e1></i></a></div><ul class="nav docs-sidenav collapse" id=id72c1a5699f783ea8a67f0eb1d1d396e1><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/15.%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/15.1-%E6%9C%BA%E5%99%A8%E7%9A%84%E6%A0%87%E8%AF%86/>15.1 机器的标识</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/15.%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/15.10-%E7%BB%83%E4%B9%A0/>15.10 练习</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/15.%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/15.2-%E5%A5%97%E6%8E%A5%E5%AD%97/>15.2 套接字</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/15.%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/15.3-%E6%9C%8D%E5%8A%A1%E5%A4%9A%E4%B8%AA%E5%AE%A2%E6%88%B7/>15.3 服务多个客户</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/15.%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/15.4-%E6%95%B0%E6%8D%AE%E6%8A%A5/>15.4 数据报</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/15.%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/15.5-%E4%B8%80%E4%B8%AAweb%E5%BA%94%E7%94%A8/>15.5 一个Web应用</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/15.%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/15.6-java%E4%B8%8Ecgi%E7%9A%84%E6%B2%9F%E9%80%9A/>15.6 Java与CGI的沟通</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/15.%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/15.7-%E7%94%A8jdbc%E8%BF%9E%E6%8E%A5%E6%95%B0%E6%8D%AE%E5%BA%93/>15.7 用JDBC连接数据库</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/15.%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/15.8-%E8%BF%9C%E7%A8%8B%E6%96%B9%E6%B3%95/>15.8 远程方法</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/15.%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/15.9-%E6%80%BB%E7%BB%93/>15.9 总结</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-idbee59bdc5aaf46677af95b12ea99ff64")' href=#idbee59bdc5aaf46677af95b12ea99ff64 aria-expanded=false aria-controls=idbee59bdc5aaf46677af95b12ea99ff64 aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/16.%E8%AE%BE%E8%AE%A1%E8%8C%83%E5%BC%8F/>16.设计范式</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#idbee59bdc5aaf46677af95b12ea99ff64 aria-expanded=false aria-controls=idbee59bdc5aaf46677af95b12ea99ff64><i class="fa-solid fa-angle-right" id=caret-idbee59bdc5aaf46677af95b12ea99ff64></i></a></div><ul class="nav docs-sidenav collapse" id=idbee59bdc5aaf46677af95b12ea99ff64><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/16.%E8%AE%BE%E8%AE%A1%E8%8C%83%E5%BC%8F/16.1-%E8%8C%83%E5%BC%8F%E7%9A%84%E6%A6%82%E5%BF%B5/>16.1 范式的概念</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/16.%E8%AE%BE%E8%AE%A1%E8%8C%83%E5%BC%8F/16.10-%E7%BB%83%E4%B9%A0/>16.10 练习</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/16.%E8%AE%BE%E8%AE%A1%E8%8C%83%E5%BC%8F/16.2-%E8%A7%82%E5%AF%9F%E5%99%A8%E8%8C%83%E5%BC%8F/>16.2 观察器范式</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/16.%E8%AE%BE%E8%AE%A1%E8%8C%83%E5%BC%8F/16.3-%E6%A8%A1%E6%8B%9F%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6%E7%AB%99/>16.3 模拟垃圾回收站</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/16.%E8%AE%BE%E8%AE%A1%E8%8C%83%E5%BC%8F/16.4-%E6%94%B9%E8%BF%9B%E8%AE%BE%E8%AE%A1/>16.4 改进设计</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/16.%E8%AE%BE%E8%AE%A1%E8%8C%83%E5%BC%8F/16.5-%E6%8A%BD%E8%B1%A1%E7%9A%84%E5%BA%94%E7%94%A8/>16.5 抽象的应用</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/16.%E8%AE%BE%E8%AE%A1%E8%8C%83%E5%BC%8F/16.6-%E5%A4%9A%E9%87%8D%E6%B4%BE%E9%81%A3/>16.6 多重派遣</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/16.%E8%AE%BE%E8%AE%A1%E8%8C%83%E5%BC%8F/16.7-%E8%AE%BF%E9%97%AE%E5%99%A8%E8%8C%83%E5%BC%8F/>16.7 访问器范式</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/16.%E8%AE%BE%E8%AE%A1%E8%8C%83%E5%BC%8F/16.8-rtti%E7%9C%9F%E7%9A%84%E6%9C%89%E5%AE%B3%E5%90%97/>16.8 RTTI真的有害吗</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/16.%E8%AE%BE%E8%AE%A1%E8%8C%83%E5%BC%8F/16.9-%E6%80%BB%E7%BB%93/>16.9 总结</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-ida6b4113de6e02470653070d2ebd17b83")' href=#ida6b4113de6e02470653070d2ebd17b83 aria-expanded=false aria-controls=ida6b4113de6e02470653070d2ebd17b83 aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/17.%E9%A1%B9%E7%9B%AE/>17.项目</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#ida6b4113de6e02470653070d2ebd17b83 aria-expanded=false aria-controls=ida6b4113de6e02470653070d2ebd17b83><i class="fa-solid fa-angle-right" id=caret-ida6b4113de6e02470653070d2ebd17b83></i></a></div><ul class="nav docs-sidenav collapse" id=ida6b4113de6e02470653070d2ebd17b83><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/17.%E9%A1%B9%E7%9B%AE/17.1-%E6%96%87%E5%AD%97%E5%A4%84%E7%90%86/>17.1 文字处理</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/17.%E9%A1%B9%E7%9B%AE/17.2-%E6%96%B9%E6%B3%95%E6%9F%A5%E6%89%BE%E5%B7%A5%E5%85%B7/>17.2 方法查找工具</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/17.%E9%A1%B9%E7%9B%AE/17.3-%E5%A4%8D%E6%9D%82%E6%80%A7%E7%90%86%E8%AE%BA/>17.3 复杂性理论</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/17.%E9%A1%B9%E7%9B%AE/17.4-%E6%80%BB%E7%BB%93/>17.4 总结</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/17.%E9%A1%B9%E7%9B%AE/17.5-%E7%BB%83%E4%B9%A0/>17.5 练习</a></li></ul></div><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/%E9%99%84%E5%BD%95a-%E4%BD%BF%E7%94%A8%E9%9D%9Ejava%E4%BB%A3%E7%A0%81/>附录A 使用非JAVA代码</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/%E9%99%84%E5%BD%95b-%E5%AF%B9%E6%AF%94c++%E5%92%8Cjava/>附录B 对比C++和Java</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/%E9%99%84%E5%BD%95c-java%E7%BC%96%E7%A8%8B%E8%A7%84%E5%88%99/>附录C Java编程规则</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/%E9%99%84%E5%BD%95d-%E6%80%A7%E8%83%BD/>附录D 性能</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/%E9%99%84%E5%BD%95e-%E5%85%B3%E4%BA%8E%E5%9E%83%E5%9C%BE%E6%94%B6%E9%9B%86%E7%9A%84%E4%B8%80%E4%BA%9B%E8%AF%9D/>附录E 关于垃圾收集的一些话</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/%E9%99%84%E5%BD%95f-%E6%8E%A8%E8%8D%90%E8%AF%BB%E7%89%A9/>附录F 推荐读物</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/%E5%86%99%E5%9C%A8%E5%89%8D%E9%9D%A2%E7%9A%84%E8%AF%9D/>写在前面的话</a></li><li class="child level"><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/think-in-java/%E5%BC%95%E8%A8%80/>引言</a></li></ul></div></ul></div></nav></div><div class="d-none d-xl-block col-xl-2 docs-toc"><ul class="nav toc-top"><li><a href=# id=back_to_top class=docs-toc-title>目录</a></li></ul><nav id=TableOfContents><ul><li><a href=#泛型和类型安全的集合>泛型和类型安全的集合</a></li><li><a href=#基本概念>基本概念</a></li><li><a href=#添加元素组>添加元素组</a></li><li><a href=#集合的打印>集合的打印</a></li><li><a href=#列表-list>列表 List</a></li><li><a href=#迭代器-iterators>迭代器 Iterators</a><ul><li><a href=#listiterator>ListIterator</a></li></ul></li><li><a href=#链表-linkedlist>链表 LinkedList</a></li><li><a href=#堆栈-stack>堆栈 Stack</a></li><li><a href=#集合-set>集合 Set</a></li><li><a href=#映射-map>映射 Map</a></li><li><a href=#队列-queue>队列 Queue</a><ul><li><a href=#优先级队列-priorityqueue>优先级队列 PriorityQueue</a></li></ul></li><li><a href=#集合与迭代器>集合与迭代器</a></li><li><a href=#for-in-和迭代器>for-in 和迭代器</a><ul><li><a href=#适配器方法惯用法>适配器方法惯用法</a></li></ul></li><li><a href=#本章小结>本章小结</a><ul><li><a href=#简单集合分类>简单集合分类</a></li></ul></li></ul></nav><div class="subscribe-module col-24 mt-1"><img src=https://ngte-superbed.oss-cn-beijing.aliyuncs.com/item/20230220172727.png alt=image title=王下邀月熊的微信公众号></div></div><main class="py-md-3 pl-md-3 docs-content col-xl-8" role=main><article class=article><h1>12-Collections</h1><div class=article-style><h1 id=第十二章-集合>第十二章 集合</h1><blockquote><p>如果一个程序只包含固定数量的对象且对象的生命周期都是已知的，那么这是一个非常简单的程序。</p></blockquote><p>通常，程序总是根据运行时才知道的某些条件去创建新的对象。在此之前，无法知道所需对象的数量甚至确切类型。为了解决这个普遍的编程问题，需要在任意时刻和任意位置创建任意数量的对象。因此，不能依靠创建命名的引用来持有每一个对象：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>MyType</span> <span class=n>aReference</span><span class=o>;</span>
</span></span></code></pre></div><p>因为从来不会知道实际需要多少个这样的引用。</p><p>大多数编程语言都提供了某种方法来解决这个基本问题。Java 有多种方式保存对象（确切地说，是对象的引用）。例如前边曾经学习过的数组，它是编译器支持的类型。数组是保存一组对象的最有效的方式，如果想要保存一组基本类型数据，也推荐使用数组。但是数组具有固定的大小尺寸，而且在更一般的情况下，在写程序的时候并不知道将需要多少个对象，或者是否需要更复杂的方式来存储对象，因此数组尺寸固定这一限制就显得太过受限了。</p><p><strong>java.util</strong> 库提供了一套相当完整的<em>集合类</em>（collection classes）来解决这个问题，其中基本的类型有 <strong>List</strong> 、 <strong>Set</strong> 、 <strong>Queue</strong> 和 <strong>Map</strong>。这些类型也被称作<em>容器类</em>（container classes），但我将使用 Java 类库使用的术语。集合提供了完善的方法来保存对象，可以使用这些工具来解决大量的问题。</p><p>集合还有一些其它特性。例如， <strong>Set</strong> 对于每个值都只保存一个对象， <strong>Map</strong> 是一个关联数组，允许将某些对象与其他对象关联起来。Java 集合类都可以自动地调整自己的大小。因此，与数组不同，在编程时，可以将任意数量的对象放置在集合中，而不用关心集合应该有多大。</p><p>尽管在 Java 中没有直接的关键字支持<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>，但集合类仍然是可以显著增强编程能力的基本工具。在本章中，将介绍 Java 集合类库的基本知识，并重点介绍一些典型用法。这里将专注于在日常编程中使用的集合。稍后，在<a href>附录：集合主题</a>中，还将学习到其余的那些集合和相关功能，以及如何使用它们的更多详细信息。</p><h2 id=泛型和类型安全的集合>泛型和类型安全的集合</h2><p>使用 Java 5 之前的集合的一个主要问题是编译器允许你向集合中插入不正确的类型。例如，考虑一个 <strong>Apple</strong> 对象的集合，这里使用最基本最可靠的 <strong>ArrayList</strong> 。现在，可以把 <strong>ArrayList</strong> 看作“可以自动扩充自身尺寸的数组”来看待。使用 <strong>ArrayList</strong> 相当简单：创建一个实例，用 <code>add()</code> 插入对象；然后用 <code>get()</code> 来访问这些对象，此时需要使用索引，就像数组那样，但是不需要方括号<sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup>。 <strong>ArrayList</strong> 还有一个 <code>size()</code> 方法，来说明集合中包含了多少个元素，所以不会不小心因数组越界而引发错误（通过抛出<em>运行时异常</em>，<a href>异常</a>章节介绍了异常）。</p><p>在本例中， <strong>Apple</strong> 和 <strong>Orange</strong> 都被放到了集合中，然后将它们取出。正常情况下，Java 编译器会给出警告，因为这个示例没有使用泛型。在这里，使用特定的注解来抑制警告信息。注解以“@”符号开头，可以带参数。这里的 <code>@SuppressWarning</code> 注解及其参数表示只抑制“unchecked”类型的警告（<a href>注解</a>章节将介绍更多有关注解的信息）：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// collections/ApplesAndOrangesWithoutGenerics.java
</span></span></span><span class=line><span class=cl><span class=c1>// Simple collection use (suppressing compiler warnings)
</span></span></span><span class=line><span class=cl><span class=c1>// {ThrowsException}
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>import</span> <span class=nn>java.util.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>class</span> <span class=nc>Apple</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>  <span class=kd>private</span> <span class=kd>static</span> <span class=kt>long</span> <span class=n>counter</span><span class=o>;</span>
</span></span><span class=line><span class=cl>  <span class=kd>private</span> <span class=kd>final</span> <span class=kt>long</span> <span class=n>id</span> <span class=o>=</span> <span class=n>counter</span><span class=o>++;</span>
</span></span><span class=line><span class=cl>  <span class=kd>public</span> <span class=kt>long</span> <span class=nf>id</span><span class=o>()</span> <span class=o>{</span> <span class=k>return</span> <span class=n>id</span><span class=o>;</span> <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>class</span> <span class=nc>Orange</span> <span class=o>{}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>ApplesAndOrangesWithoutGenerics</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>  <span class=nd>@SuppressWarnings</span><span class=o>(</span><span class=s>&#34;unchecked&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl>  <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>ArrayList</span> <span class=n>apples</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ArrayList</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span><span class=o>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=o>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=mi>3</span><span class=o>;</span> <span class=n>i</span><span class=o>++)</span>
</span></span><span class=line><span class=cl>      <span class=n>apples</span><span class=o>.</span><span class=na>add</span><span class=o>(</span><span class=k>new</span> <span class=n>Apple</span><span class=o>());</span>
</span></span><span class=line><span class=cl>    <span class=c1>// No problem adding an Orange to apples:
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>apples</span><span class=o>.</span><span class=na>add</span><span class=o>(</span><span class=k>new</span> <span class=n>Orange</span><span class=o>());</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span><span class=o>(</span><span class=n>Object</span> <span class=n>apple</span> <span class=o>:</span> <span class=n>apples</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>      <span class=o>((</span><span class=n>Apple</span><span class=o>)</span> <span class=n>apple</span><span class=o>).</span><span class=na>id</span><span class=o>();</span>
</span></span><span class=line><span class=cl>      <span class=c1>// Orange is detected only at run time
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=o>}</span>
</span></span><span class=line><span class=cl>  <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=cm>/* Output:
</span></span></span><span class=line><span class=cl><span class=cm>___[ Error Output ]___
</span></span></span><span class=line><span class=cl><span class=cm>Exception in thread &#34;main&#34;
</span></span></span><span class=line><span class=cl><span class=cm>java.lang.ClassCastException: Orange cannot be cast to Apple
</span></span></span><span class=line><span class=cl><span class=cm>        at ApplesAndOrangesWithoutGenerics.main(ApplesAndOrangesWithoutGenerics.java:23)
</span></span></span><span class=line><span class=cl><span class=cm>*/</span>
</span></span></code></pre></div><p><strong>Apple</strong> 和 <strong>Orange</strong> 是截然不同的，它们除了都是 <strong>Object</strong> 之外没有任何共同点（如果一个类没有显式地声明继承自哪个类，那么它就自动继承自 <strong>Object</strong>）。因为 <strong>ArrayList</strong> 保存的是 <strong>Object</strong> ，所以不仅可以通过 <strong>ArrayList</strong> 的 <code>add()</code> 方法将 <strong>Apple</strong> 对象放入这个集合，而且可以放入 <strong>Orange</strong> 对象，这无论在编译期还是运行时都不会有问题。当使用 <strong>ArrayList</strong> 的 <code>get()</code> 方法来取出你认为是 <strong>Apple</strong> 的对象时，得到的只是 <strong>Object</strong> 引用，必须将其转型为 <strong>Apple</strong>。然后需要将整个表达式用括号括起来，以便在调用 <strong>Apple</strong> 的 <code>id()</code> 方法之前，强制执行转型。否则，将会产生语法错误。</p><p>在运行时，当尝试将 <strong>Orange</strong> 对象转为 <strong>Apple</strong> 时，会出现输出中显示的错误。</p><p>在<a href>泛型</a>章节中，你将了解到使用 Java 泛型来创建类可能很复杂。但是，使用预先定义的泛型类却相当简单。例如，要定义一个用于保存 <strong>Apple</strong> 对象的 <strong>ArrayList</strong> ，只需要使用 <strong>ArrayList&lt;Apple></strong> 来代替 <strong>ArrayList</strong> 。尖括号括起来的是<em>类型参数</em>（可能会有多个），它指定了这个集合实例可以保存的类型。</p><p>通过使用泛型，就可以在编译期防止将错误类型的对象放置到集合中<sup id=fnref:3><a href=#fn:3 class=footnote-ref role=doc-noteref>3</a></sup>。下面还是这个示例，但是使用了泛型：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// collections/ApplesAndOrangesWithGenerics.java
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>import</span> <span class=nn>java.util.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>ApplesAndOrangesWithGenerics</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>  <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>ArrayList</span><span class=o>&lt;</span><span class=n>Apple</span><span class=o>&gt;</span> <span class=n>apples</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ArrayList</span><span class=o>&lt;&gt;();</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span><span class=o>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=o>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=mi>3</span><span class=o>;</span> <span class=n>i</span><span class=o>++)</span>
</span></span><span class=line><span class=cl>      <span class=n>apples</span><span class=o>.</span><span class=na>add</span><span class=o>(</span><span class=k>new</span> <span class=n>Apple</span><span class=o>());</span>
</span></span><span class=line><span class=cl>    <span class=c1>// Compile-time error:
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// apples.add(new Orange());
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>for</span><span class=o>(</span><span class=n>Apple</span> <span class=n>apple</span> <span class=o>:</span> <span class=n>apples</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>      <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>apple</span><span class=o>.</span><span class=na>id</span><span class=o>());</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>  <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=cm>/* Output:
</span></span></span><span class=line><span class=cl><span class=cm>0
</span></span></span><span class=line><span class=cl><span class=cm>1
</span></span></span><span class=line><span class=cl><span class=cm>2
</span></span></span><span class=line><span class=cl><span class=cm>*/</span>
</span></span></code></pre></div><p>在 <strong>apples</strong> 定义的右侧，可以看到 <code>new ArrayList&lt;>()</code> 。这有时被称为“菱形语法”（diamond syntax）。在 Java 7 之前，必须要在两端都进行类型声明，如下所示：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>ArrayList</span><span class=o>&lt;</span><span class=n>Apple</span><span class=o>&gt;</span> <span class=n>apples</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ArrayList</span><span class=o>&lt;</span><span class=n>Apple</span><span class=o>&gt;();</span>
</span></span></code></pre></div><p>随着类型变得越来越复杂，这种重复产生的代码非常混乱且难以阅读。程序员发现所有类型信息都可以从左侧获得，因此，编译器没有理由强迫右侧再重复这些。虽然<em>类型推断</em>（type inference）只是个很小的请求，Java 语言团队仍然欣然接受并进行了改进。</p><p>有了 <strong>ArrayList</strong> 声明中的类型指定，编译器会阻止将 <strong>Orange</strong> 放入 <strong>apples</strong> ，因此，这会成为一个编译期错误而不是运行时错误。</p><p>使用泛型，从 <strong>List</strong> 中获取元素不需要强制类型转换。因为 <strong>List</strong> 知道它持有什么类型，因此当调用 <code>get()</code> 时，它会替你执行转型。因此，使用泛型，你不仅知道编译器将检查放入集合的对象类型，而且在使用集合中的对象时也可以获得更清晰的语法。</p><p>当指定了某个类型为泛型参数时，并不仅限于只能将确切类型的对象放入集合中。向上转型也可以像作用于其他类型一样作用于泛型：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// collections/GenericsAndUpcasting.java
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>import</span> <span class=nn>java.util.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>class</span> <span class=nc>GrannySmith</span> <span class=kd>extends</span> <span class=n>Apple</span> <span class=o>{}</span>
</span></span><span class=line><span class=cl><span class=kd>class</span> <span class=nc>Gala</span> <span class=kd>extends</span> <span class=n>Apple</span> <span class=o>{}</span>
</span></span><span class=line><span class=cl><span class=kd>class</span> <span class=nc>Fuji</span> <span class=kd>extends</span> <span class=n>Apple</span> <span class=o>{}</span>
</span></span><span class=line><span class=cl><span class=kd>class</span> <span class=nc>Braeburn</span> <span class=kd>extends</span> <span class=n>Apple</span> <span class=o>{}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>GenericsAndUpcasting</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>  <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>ArrayList</span><span class=o>&lt;</span><span class=n>Apple</span><span class=o>&gt;</span> <span class=n>apples</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ArrayList</span><span class=o>&lt;&gt;();</span>
</span></span><span class=line><span class=cl>    <span class=n>apples</span><span class=o>.</span><span class=na>add</span><span class=o>(</span><span class=k>new</span> <span class=n>GrannySmith</span><span class=o>());</span>
</span></span><span class=line><span class=cl>    <span class=n>apples</span><span class=o>.</span><span class=na>add</span><span class=o>(</span><span class=k>new</span> <span class=n>Gala</span><span class=o>());</span>
</span></span><span class=line><span class=cl>    <span class=n>apples</span><span class=o>.</span><span class=na>add</span><span class=o>(</span><span class=k>new</span> <span class=n>Fuji</span><span class=o>());</span>
</span></span><span class=line><span class=cl>    <span class=n>apples</span><span class=o>.</span><span class=na>add</span><span class=o>(</span><span class=k>new</span> <span class=n>Braeburn</span><span class=o>());</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span><span class=o>(</span><span class=n>Apple</span> <span class=n>apple</span> <span class=o>:</span> <span class=n>apples</span><span class=o>)</span>
</span></span><span class=line><span class=cl>      <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>apple</span><span class=o>);</span>
</span></span><span class=line><span class=cl>  <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=cm>/* Output:
</span></span></span><span class=line><span class=cl><span class=cm>GrannySmith@15db9742
</span></span></span><span class=line><span class=cl><span class=cm>Gala@6d06d69c
</span></span></span><span class=line><span class=cl><span class=cm>Fuji@7852e922
</span></span></span><span class=line><span class=cl><span class=cm>Braeburn@4e25154f
</span></span></span><span class=line><span class=cl><span class=cm>*/</span>
</span></span></code></pre></div><p>因此，可以将 <strong>Apple</strong> 的子类型添加到被指定为保存 <strong>Apple</strong> 对象的集合中。</p><p>程序的输出是从 <strong>Object</strong> 默认的 <code>toString()</code> 方法产生的，该方法打印类名，后边跟着对象的散列码的无符号十六进制表示（这个散列码是通过 <code>hashCode()</code> 方法产生的）。将在<a href>附录：理解 equals 和 hashCode 方法</a>中了解有关散列码的内容。</p><h2 id=基本概念>基本概念</h2><p>Java 集合类库采用“持有对象”（holding objects）的思想，并将其分为两个不同的概念，表示为类库的基本接口：</p><ol><li><strong>集合（Collection）</strong> ：一个独立元素的序列，这些元素都服从一条或多条规则。<strong>List</strong> 必须以插入的顺序保存元素， <strong>Set</strong> 不能包含重复元素， <strong>Queue</strong> 按照<em>排队规则</em>来确定对象产生的顺序（通常与它们被插入的顺序相同）。</li><li><strong>映射（Map）</strong> ： 一组成对的“键值对”对象，允许使用键来查找值。 <strong>ArrayList</strong> 使用数字来查找对象，因此在某种意义上讲，它是将数字和对象关联在一起。 <strong>map</strong> 允许我们使用一个对象来查找另一个对象，它也被称作<em>关联数组</em>（associative array），因为它将对象和其它对象关联在一起；或者称作<em>字典</em>（dictionary），因为可以使用一个键对象来查找值对象，就像在字典中使用单词查找定义一样。 <strong>Map</strong> 是强大的编程工具。</li></ol><p>尽管并非总是可行，但在理想情况下，你编写的大部分代码都在与这些接口打交道，并且唯一需要指定所使用的精确类型的地方就是在创建的时候。因此，可以像下面这样创建一个 <strong>List</strong> ：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>List</span><span class=o>&lt;</span><span class=n>Apple</span><span class=o>&gt;</span> <span class=n>apples</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ArrayList</span><span class=o>&lt;&gt;();</span>
</span></span></code></pre></div><p>请注意， <strong>ArrayList</strong> 已经被向上转型为了 <strong>List</strong> ，这与之前示例中的处理方式正好相反。使用接口的目的是，如果想要改变具体实现，只需在创建时修改它就行了，就像下面这样：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>List</span><span class=o>&lt;</span><span class=n>Apple</span><span class=o>&gt;</span> <span class=n>apples</span> <span class=o>=</span> <span class=k>new</span> <span class=n>LinkedList</span><span class=o>&lt;&gt;();</span>
</span></span></code></pre></div><p>因此，应该创建一个具体类的对象，将其向上转型为对应的接口，然后在其余代码中都是用这个接口。</p><p>这种方式并非总是有效的，因为某些具体类有额外的功能。例如， <strong>LinkedList</strong> 具有 <strong>List</strong> 接口中未包含的额外方法，而 <strong>TreeMap</strong> 也具有在 <strong>Map</strong> 接口中未包含的方法。如果需要使用这些方法，就不能将它们向上转型为更通用的接口。</p><p><strong>Collection</strong> 接口概括了<em>序列</em>的概念——一种存放一组对象的方式。下面是个简单的示例，用 <strong>Integer</strong> 对象填充了一个 <strong>Collection</strong> （这里用 <strong>ArrayList</strong> 表示），然后打印集合中的每个元素：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// collections/SimpleCollection.java
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>import</span> <span class=nn>java.util.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>SimpleCollection</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>  <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>Collection</span><span class=o>&lt;</span><span class=n>Integer</span><span class=o>&gt;</span> <span class=n>c</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ArrayList</span><span class=o>&lt;&gt;();</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span><span class=o>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=o>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=mi>10</span><span class=o>;</span> <span class=n>i</span><span class=o>++)</span>
</span></span><span class=line><span class=cl>      <span class=n>c</span><span class=o>.</span><span class=na>add</span><span class=o>(</span><span class=n>i</span><span class=o>);</span> <span class=c1>// Autoboxing
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>for</span><span class=o>(</span><span class=n>Integer</span> <span class=n>i</span> <span class=o>:</span> <span class=n>c</span><span class=o>)</span>
</span></span><span class=line><span class=cl>      <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>print</span><span class=o>(</span><span class=n>i</span> <span class=o>+</span> <span class=s>&#34;, &#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>  <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=cm>/* Output:
</span></span></span><span class=line><span class=cl><span class=cm>0, 1, 2, 3, 4, 5, 6, 7, 8, 9,
</span></span></span><span class=line><span class=cl><span class=cm>*/</span>
</span></span></code></pre></div><p>这个例子仅使用了 <strong>Collection</strong> 中的方法（即 <code>add()</code> ），所以使用任何继承自 <strong>Collection</strong> 的类的对象都可以正常工作。但是 <strong>ArrayList</strong> 是最基本的序列类型。</p><p><code>add()</code> 方法的名称就表明它是在 <strong>Collection</strong> 中添加一个新元素。但是，文档中非常详细地叙述到 <code>add()</code> “要确保这个 <strong>Collection</strong> 包含指定的元素。”这是因为考虑到了 <strong>Set</strong> 的含义，因为在 <strong>Set</strong>中，只有当元素不存在时才会添加元素。在使用 <strong>ArrayList</strong> ，或任何其他类型的 <strong>List</strong> 时，<code>add()</code> 总是表示“把它放进去”，因为 <strong>List</strong> 不关心是否存在重复元素。</p><p>可以使用 <em>for-in</em> 语法来遍历所有的 <strong>Collection</strong> ，就像这里所展示的那样。在本章的后续部分，还将学习到一个更灵活的概念，<em>迭代器</em>。</p><h2 id=添加元素组>添加元素组</h2><p>在 <strong>java.util</strong> 包中的 <strong>Arrays</strong> 和 <strong>Collections</strong> 类中都有很多实用的方法，可以在一个 <strong>Collection</strong> 中添加一组元素。</p><p><code>Arrays.asList()</code> 方法接受一个数组或是逗号分隔的元素列表（使用可变参数），并将其转换为 <strong>List</strong> 对象。 <code>Collections.addAll()</code> 方法接受一个 <strong>Collection</strong> 对象，以及一个数组或是一个逗号分隔的列表，将其中元素添加到 <strong>Collection</strong> 中。下边的示例展示了这两个方法，以及更通用的 、所有 <strong>Collection</strong> 类型都包含的<code>addAll()</code> 方法：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// collections/AddingGroups.java
</span></span></span><span class=line><span class=cl><span class=c1>// Adding groups of elements to Collection objects
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>import</span> <span class=nn>java.util.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>AddingGroups</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>  <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>Collection</span><span class=o>&lt;</span><span class=n>Integer</span><span class=o>&gt;</span> <span class=n>collection</span> <span class=o>=</span>
</span></span><span class=line><span class=cl>      <span class=k>new</span> <span class=n>ArrayList</span><span class=o>&lt;&gt;(</span><span class=n>Arrays</span><span class=o>.</span><span class=na>asList</span><span class=o>(</span><span class=mi>1</span><span class=o>,</span> <span class=mi>2</span><span class=o>,</span> <span class=mi>3</span><span class=o>,</span> <span class=mi>4</span><span class=o>,</span> <span class=mi>5</span><span class=o>));</span>
</span></span><span class=line><span class=cl>    <span class=n>Integer</span><span class=o>[]</span> <span class=n>moreInts</span> <span class=o>=</span> <span class=o>{</span> <span class=mi>6</span><span class=o>,</span> <span class=mi>7</span><span class=o>,</span> <span class=mi>8</span><span class=o>,</span> <span class=mi>9</span><span class=o>,</span> <span class=mi>10</span> <span class=o>};</span>
</span></span><span class=line><span class=cl>    <span class=n>collection</span><span class=o>.</span><span class=na>addAll</span><span class=o>(</span><span class=n>Arrays</span><span class=o>.</span><span class=na>asList</span><span class=o>(</span><span class=n>moreInts</span><span class=o>));</span>
</span></span><span class=line><span class=cl>    <span class=c1>// Runs significantly faster, but you can&#39;t
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// construct a Collection this way:
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>Collections</span><span class=o>.</span><span class=na>addAll</span><span class=o>(</span><span class=n>collection</span><span class=o>,</span> <span class=mi>11</span><span class=o>,</span> <span class=mi>12</span><span class=o>,</span> <span class=mi>13</span><span class=o>,</span> <span class=mi>14</span><span class=o>,</span> <span class=mi>15</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>Collections</span><span class=o>.</span><span class=na>addAll</span><span class=o>(</span><span class=n>collection</span><span class=o>,</span> <span class=n>moreInts</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=c1>// Produces a list &#34;backed by&#34; an array:
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>List</span><span class=o>&lt;</span><span class=n>Integer</span><span class=o>&gt;</span> <span class=n>list</span> <span class=o>=</span> <span class=n>Arrays</span><span class=o>.</span><span class=na>asList</span><span class=o>(</span><span class=mi>16</span><span class=o>,</span><span class=mi>17</span><span class=o>,</span><span class=mi>18</span><span class=o>,</span><span class=mi>19</span><span class=o>,</span><span class=mi>20</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>list</span><span class=o>.</span><span class=na>set</span><span class=o>(</span><span class=mi>1</span><span class=o>,</span> <span class=mi>99</span><span class=o>);</span> <span class=c1>// OK -- modify an element
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// list.add(21); // Runtime error; the underlying
</span></span></span><span class=line><span class=cl><span class=c1></span>                     <span class=c1>// array cannot be resized.
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p><strong>Collection</strong> 的构造器可以接受另一个 <strong>Collection</strong>，用它来将自身初始化。因此，可以使用 <code>Arrays.asList()</code> 来为这个构造器产生输入。但是， <code>Collections.addAll()</code> 运行得更快，而且很容易构建一个不包含元素的 <strong>Collection</strong> ，然后调用 <code>Collections.addAll()</code> ，因此这是首选方式。</p><p><code>Collection.addAll()</code> 方法只能接受另一个 <strong>Collection</strong> 作为参数，因此它没有 <code>Arrays.asList()</code> 或 <code>Collections.addAll()</code> 灵活。这两个方法都使用可变参数列表。</p><p>也可以直接使用 <code>Arrays.asList()</code> 的输出作为一个 <strong>List</strong> ，但是这里的底层实现是数组，没法调整大小。如果尝试在这个 <strong>List</strong> 上调用 <code>add()</code> 或 <code>remove()</code>，由于这两个方法会尝试修改数组大小，所以会在运行时得到“Unsupported Operation（不支持的操作）”错误：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// collections/AsListInference.java
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>import</span> <span class=nn>java.util.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>class</span> <span class=nc>Snow</span> <span class=o>{}</span>
</span></span><span class=line><span class=cl><span class=kd>class</span> <span class=nc>Powder</span> <span class=kd>extends</span> <span class=n>Snow</span> <span class=o>{}</span>
</span></span><span class=line><span class=cl><span class=kd>class</span> <span class=nc>Light</span> <span class=kd>extends</span> <span class=n>Powder</span> <span class=o>{}</span>
</span></span><span class=line><span class=cl><span class=kd>class</span> <span class=nc>Heavy</span> <span class=kd>extends</span> <span class=n>Powder</span> <span class=o>{}</span>
</span></span><span class=line><span class=cl><span class=kd>class</span> <span class=nc>Crusty</span> <span class=kd>extends</span> <span class=n>Snow</span> <span class=o>{}</span>
</span></span><span class=line><span class=cl><span class=kd>class</span> <span class=nc>Slush</span> <span class=kd>extends</span> <span class=n>Snow</span> <span class=o>{}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>AsListInference</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>  <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>List</span><span class=o>&lt;</span><span class=n>Snow</span><span class=o>&gt;</span> <span class=n>snow1</span> <span class=o>=</span> <span class=n>Arrays</span><span class=o>.</span><span class=na>asList</span><span class=o>(</span>
</span></span><span class=line><span class=cl>      <span class=k>new</span> <span class=n>Crusty</span><span class=o>(),</span> <span class=k>new</span> <span class=n>Slush</span><span class=o>(),</span> <span class=k>new</span> <span class=n>Powder</span><span class=o>());</span>
</span></span><span class=line><span class=cl>    <span class=c1>//- snow1.add(new Heavy()); // Exception
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=n>List</span><span class=o>&lt;</span><span class=n>Snow</span><span class=o>&gt;</span> <span class=n>snow2</span> <span class=o>=</span> <span class=n>Arrays</span><span class=o>.</span><span class=na>asList</span><span class=o>(</span>
</span></span><span class=line><span class=cl>      <span class=k>new</span> <span class=n>Light</span><span class=o>(),</span> <span class=k>new</span> <span class=n>Heavy</span><span class=o>());</span>
</span></span><span class=line><span class=cl>    <span class=c1>//- snow2.add(new Slush()); // Exception
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=n>List</span><span class=o>&lt;</span><span class=n>Snow</span><span class=o>&gt;</span> <span class=n>snow3</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ArrayList</span><span class=o>&lt;&gt;();</span>
</span></span><span class=line><span class=cl>    <span class=n>Collections</span><span class=o>.</span><span class=na>addAll</span><span class=o>(</span><span class=n>snow3</span><span class=o>,</span>
</span></span><span class=line><span class=cl>      <span class=k>new</span> <span class=n>Light</span><span class=o>(),</span> <span class=k>new</span> <span class=n>Heavy</span><span class=o>(),</span> <span class=k>new</span> <span class=n>Powder</span><span class=o>());</span>
</span></span><span class=line><span class=cl>    <span class=n>snow3</span><span class=o>.</span><span class=na>add</span><span class=o>(</span><span class=k>new</span> <span class=n>Crusty</span><span class=o>());</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// Hint with explicit type argument specification:
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>List</span><span class=o>&lt;</span><span class=n>Snow</span><span class=o>&gt;</span> <span class=n>snow4</span> <span class=o>=</span> <span class=n>Arrays</span><span class=o>.&lt;</span><span class=n>Snow</span><span class=o>&gt;</span><span class=n>asList</span><span class=o>(</span>
</span></span><span class=line><span class=cl>       <span class=k>new</span> <span class=n>Light</span><span class=o>(),</span> <span class=k>new</span> <span class=n>Heavy</span><span class=o>(),</span> <span class=k>new</span> <span class=n>Slush</span><span class=o>());</span>
</span></span><span class=line><span class=cl>    <span class=c1>//- snow4.add(new Powder()); // Exception
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>在 <strong>snow4</strong> 中，注意 <code>Arrays.asList()</code> 中间的“暗示”（即 <code>&lt;Snow></code> ），告诉编译器 <code>Arrays.asList()</code> 生成的结果 <strong>List</strong> 类型的实际目标类型是什么。这称为<em>显式类型参数说明</em>（explicit type argument specification）。</p><h2 id=集合的打印>集合的打印</h2><p>必须使用 <code>Arrays.toString()</code> 来生成数组的可打印形式。但是打印集合无需任何帮助。下面是一个例子，这个例子中也介绍了基本的 Java 集合：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// collections/PrintingCollections.java
</span></span></span><span class=line><span class=cl><span class=c1>// Collections print themselves automatically
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>import</span> <span class=nn>java.util.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>PrintingCollections</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>  <span class=kd>static</span> <span class=n>Collection</span>
</span></span><span class=line><span class=cl>  <span class=nf>fill</span><span class=o>(</span><span class=n>Collection</span><span class=o>&lt;</span><span class=n>String</span><span class=o>&gt;</span> <span class=n>collection</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>collection</span><span class=o>.</span><span class=na>add</span><span class=o>(</span><span class=s>&#34;rat&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>collection</span><span class=o>.</span><span class=na>add</span><span class=o>(</span><span class=s>&#34;cat&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>collection</span><span class=o>.</span><span class=na>add</span><span class=o>(</span><span class=s>&#34;dog&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>collection</span><span class=o>.</span><span class=na>add</span><span class=o>(</span><span class=s>&#34;dog&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>collection</span><span class=o>;</span>
</span></span><span class=line><span class=cl>  <span class=o>}</span>
</span></span><span class=line><span class=cl>  <span class=kd>static</span> <span class=n>Map</span> <span class=nf>fill</span><span class=o>(</span><span class=n>Map</span><span class=o>&lt;</span><span class=n>String</span><span class=o>,</span> <span class=n>String</span><span class=o>&gt;</span> <span class=n>map</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>map</span><span class=o>.</span><span class=na>put</span><span class=o>(</span><span class=s>&#34;rat&#34;</span><span class=o>,</span> <span class=s>&#34;Fuzzy&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>map</span><span class=o>.</span><span class=na>put</span><span class=o>(</span><span class=s>&#34;cat&#34;</span><span class=o>,</span> <span class=s>&#34;Rags&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>map</span><span class=o>.</span><span class=na>put</span><span class=o>(</span><span class=s>&#34;dog&#34;</span><span class=o>,</span> <span class=s>&#34;Bosco&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>map</span><span class=o>.</span><span class=na>put</span><span class=o>(</span><span class=s>&#34;dog&#34;</span><span class=o>,</span> <span class=s>&#34;Spot&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>map</span><span class=o>;</span>
</span></span><span class=line><span class=cl>  <span class=o>}</span>
</span></span><span class=line><span class=cl>  <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>fill</span><span class=o>(</span><span class=k>new</span> <span class=n>ArrayList</span><span class=o>&lt;&gt;()));</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>fill</span><span class=o>(</span><span class=k>new</span> <span class=n>LinkedList</span><span class=o>&lt;&gt;()));</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>fill</span><span class=o>(</span><span class=k>new</span> <span class=n>HashSet</span><span class=o>&lt;&gt;()));</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>fill</span><span class=o>(</span><span class=k>new</span> <span class=n>TreeSet</span><span class=o>&lt;&gt;()));</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>fill</span><span class=o>(</span><span class=k>new</span> <span class=n>LinkedHashSet</span><span class=o>&lt;&gt;()));</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>fill</span><span class=o>(</span><span class=k>new</span> <span class=n>HashMap</span><span class=o>&lt;&gt;()));</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>fill</span><span class=o>(</span><span class=k>new</span> <span class=n>TreeMap</span><span class=o>&lt;&gt;()));</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>fill</span><span class=o>(</span><span class=k>new</span> <span class=n>LinkedHashMap</span><span class=o>&lt;&gt;()));</span>
</span></span><span class=line><span class=cl>  <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=cm>/* Output:
</span></span></span><span class=line><span class=cl><span class=cm>[rat, cat, dog, dog]
</span></span></span><span class=line><span class=cl><span class=cm>[rat, cat, dog, dog]
</span></span></span><span class=line><span class=cl><span class=cm>[rat, cat, dog]
</span></span></span><span class=line><span class=cl><span class=cm>[cat, dog, rat]
</span></span></span><span class=line><span class=cl><span class=cm>[rat, cat, dog]
</span></span></span><span class=line><span class=cl><span class=cm>{rat=Fuzzy, cat=Rags, dog=Spot}
</span></span></span><span class=line><span class=cl><span class=cm>{cat=Rags, dog=Spot, rat=Fuzzy}
</span></span></span><span class=line><span class=cl><span class=cm>{rat=Fuzzy, cat=Rags, dog=Spot}
</span></span></span><span class=line><span class=cl><span class=cm>*/</span>
</span></span></code></pre></div><p>这显示了 Java 集合库中的两个主要类型。它们的区别在于集合中的每个“槽”（slot）保存的元素个数。 <strong>Collection</strong> 类型在每个槽中只能保存一个元素。此类集合包括： <strong>List</strong> ，它以特定的顺序保存一组元素； <strong>Set</strong> ，其中元素不允许重复； <strong>Queue</strong> ，只能在集合一端插入对象，并从另一端移除对象（就本例而言，这只是查看序列的另一种方式，因此并没有显示它）。 <strong>Map</strong> 在每个槽中存放了两个元素，即<em>键</em> (key)和与之关联的<em>值</em> (value)。</p><p>默认的打印行为，使用集合提供的 <code>toString()</code> 方法即可生成可读性很好的结果。 <strong>Collection</strong> 打印出的内容用方括号括住，每个元素由逗号分隔。 <strong>Map</strong> 则由大括号括住，每个键和值用等号连接（键在左侧，值在右侧）。</p><p>第一个 <code>fill()</code> 方法适用于所有类型的 <strong>Collection</strong> ，这些类型都实现了 <code>add()</code> 方法以添加新元素。</p><p><strong>ArrayList</strong> 和 <strong>LinkedList</strong> 都是 <strong>List</strong> 的类型，从输出中可以看出，它们都按插入顺序保存元素。两者之间的区别不仅在于执行某些类型的操作时的性能，而且 <strong>LinkedList</strong> 包含的操作多于 <strong>ArrayList</strong> 。本章后面将对这些内容进行更全面的探讨。</p><p><strong>HashSet</strong> ， <strong>TreeSet</strong> 和 <strong>LinkedHashSet</strong> 是 <strong>Set</strong> 的类型。从输出中可以看到， <strong>Set</strong> 仅保存每个相同项中的一个，并且不同的 <strong>Set</strong> 实现存储元素的方式也不同。 <strong>HashSet</strong> 使用相当复杂的方法存储元素，这在<a href>附录：集合主题</a>中进行了探讨。现在只需要知道，这种技术是检索元素的最快方法，因此，存储顺序看上去没有什么意义（通常只关心某事物是否是 <strong>Set</strong> 的成员，而存储顺序并不重要）。如果存储顺序很重要，则可以使用 <strong>TreeSet</strong> ，它把对象按照比较规则来排序；还有 <strong>LinkedHashSet</strong> ，它把对象按照被添加的先后顺序来排序。</p><p><strong>Map</strong> （也称为<em>关联数组</em>）使用<em>键</em>来查找对象，就像一个简单的数据库。所关联的对象称为<em>值</em>。 假设有一个 <strong>Map</strong> 将美国州名与它们的首府联系在一起，如果想要俄亥俄州（Ohio）的首府，可以用“Ohio”作为键来查找，几乎就像使用数组下标一样。正是由于这种行为，对于每个键， <strong>Map</strong> 只存储一次。</p><p><code>Map.put(key, value)</code> 添加一个所想要添加的值并将它与一个键（用来查找值）相关联。 <code>Map.get(key)</code> 生成与该键相关联的值。上面的示例仅添加键值对，并没有执行查找。这将在稍后展示。</p><p>请注意，这里没有指定（或考虑） <strong>Map</strong> 的大小，因为它会自动调整大小。 此外， <strong>Map</strong> 还知道如何打印自己，它会显示相关联的键和值。</p><p>本例使用了 <strong>Map</strong> 的三种基本风格： <strong>HashMap</strong> ， <strong>TreeMap</strong> 和 <strong>LinkedHashMap</strong> 。</p><p>键和值保存在 <strong>HashMap</strong> 中的顺序不是插入顺序，因为 <strong>HashMap</strong> 实现使用了非常快速的算法来控制顺序。 <strong>TreeMap</strong> 把所有的键按照比较规则来排序， <strong>LinkedHashMap</strong> 在保持 <strong>HashMap</strong> 查找速度的同时按照键的插入顺序来排序。</p><h2 id=列表-list>列表 List</h2><p><strong>List</strong>承诺将元素保存在特定的序列中。 <strong>List</strong> 接口在 <strong>Collection</strong> 的基础上添加了许多方法，允许在 <strong>List</strong> 的中间插入和删除元素。</p><p>有两种类型的 <strong>List</strong> ：</p><ul><li>基本的 <strong>ArrayList</strong> ，擅长随机访问元素，但在 <strong>List</strong> 中间插入和删除元素时速度较慢。</li><li><strong>LinkedList</strong> ，它通过代价较低的在 <strong>List</strong> 中间进行的插入和删除操作，提供了优化的顺序访问。 <strong>LinkedList</strong> 对于随机访问来说相对较慢，但它具有比 <strong>ArrayList</strong> 更大的特征集。</li></ul><p>下面的示例导入 <strong>typeinfo.pets</strong> ，超前使用了<a href>类型信息</a>一章中的类库。这个类库包含了 <strong>Pet</strong> 类层次结构，以及用于随机生成 <strong>Pet</strong> 对象的一些工具类。此时不需要了解完整的详细信息，只需要知道两点：</p><ol><li>有一个 <strong>Pet</strong> 类，以及 <strong>Pet</strong> 的各种子类型。</li><li>静态的 <code>Pets.arrayList()</code> 方法返回一个填充了随机选取的 <strong>Pet</strong> 对象的 <strong>ArrayList</strong>：</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// collections/ListFeatures.java
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>import</span> <span class=nn>typeinfo.pets.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>java.util.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>ListFeatures</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>  <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>Random</span> <span class=n>rand</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Random</span><span class=o>(</span><span class=mi>47</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>List</span><span class=o>&lt;</span><span class=n>Pet</span><span class=o>&gt;</span> <span class=n>pets</span> <span class=o>=</span> <span class=n>Pets</span><span class=o>.</span><span class=na>list</span><span class=o>(</span><span class=mi>7</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;1: &#34;</span> <span class=o>+</span> <span class=n>pets</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>Hamster</span> <span class=n>h</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Hamster</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=n>pets</span><span class=o>.</span><span class=na>add</span><span class=o>(</span><span class=n>h</span><span class=o>);</span> <span class=c1>// Automatically resizes
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;2: &#34;</span> <span class=o>+</span> <span class=n>pets</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;3: &#34;</span> <span class=o>+</span> <span class=n>pets</span><span class=o>.</span><span class=na>contains</span><span class=o>(</span><span class=n>h</span><span class=o>));</span>
</span></span><span class=line><span class=cl>    <span class=n>pets</span><span class=o>.</span><span class=na>remove</span><span class=o>(</span><span class=n>h</span><span class=o>);</span> <span class=c1>// Remove by object
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>Pet</span> <span class=n>p</span> <span class=o>=</span> <span class=n>pets</span><span class=o>.</span><span class=na>get</span><span class=o>(</span><span class=mi>2</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span>
</span></span><span class=line><span class=cl>      <span class=s>&#34;4: &#34;</span> <span class=o>+</span>  <span class=n>p</span> <span class=o>+</span> <span class=s>&#34; &#34;</span> <span class=o>+</span> <span class=n>pets</span><span class=o>.</span><span class=na>indexOf</span><span class=o>(</span><span class=n>p</span><span class=o>));</span>
</span></span><span class=line><span class=cl>    <span class=n>Pet</span> <span class=n>cymric</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Cymric</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;5: &#34;</span> <span class=o>+</span> <span class=n>pets</span><span class=o>.</span><span class=na>indexOf</span><span class=o>(</span><span class=n>cymric</span><span class=o>));</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;6: &#34;</span> <span class=o>+</span> <span class=n>pets</span><span class=o>.</span><span class=na>remove</span><span class=o>(</span><span class=n>cymric</span><span class=o>));</span>
</span></span><span class=line><span class=cl>    <span class=c1>// Must be the exact object:
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;7: &#34;</span> <span class=o>+</span> <span class=n>pets</span><span class=o>.</span><span class=na>remove</span><span class=o>(</span><span class=n>p</span><span class=o>));</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;8: &#34;</span> <span class=o>+</span> <span class=n>pets</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>pets</span><span class=o>.</span><span class=na>add</span><span class=o>(</span><span class=mi>3</span><span class=o>,</span> <span class=k>new</span> <span class=n>Mouse</span><span class=o>());</span> <span class=c1>// Insert at an index
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;9: &#34;</span> <span class=o>+</span> <span class=n>pets</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>List</span><span class=o>&lt;</span><span class=n>Pet</span><span class=o>&gt;</span> <span class=n>sub</span> <span class=o>=</span> <span class=n>pets</span><span class=o>.</span><span class=na>subList</span><span class=o>(</span><span class=mi>1</span><span class=o>,</span> <span class=mi>4</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;subList: &#34;</span> <span class=o>+</span> <span class=n>sub</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;10: &#34;</span> <span class=o>+</span> <span class=n>pets</span><span class=o>.</span><span class=na>containsAll</span><span class=o>(</span><span class=n>sub</span><span class=o>));</span>
</span></span><span class=line><span class=cl>    <span class=n>Collections</span><span class=o>.</span><span class=na>sort</span><span class=o>(</span><span class=n>sub</span><span class=o>);</span> <span class=c1>// In-place sort
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;sorted subList: &#34;</span> <span class=o>+</span> <span class=n>sub</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=c1>// Order is not important in containsAll():
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;11: &#34;</span> <span class=o>+</span> <span class=n>pets</span><span class=o>.</span><span class=na>containsAll</span><span class=o>(</span><span class=n>sub</span><span class=o>));</span>
</span></span><span class=line><span class=cl>    <span class=n>Collections</span><span class=o>.</span><span class=na>shuffle</span><span class=o>(</span><span class=n>sub</span><span class=o>,</span> <span class=n>rand</span><span class=o>);</span> <span class=c1>// Mix it up
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;shuffled subList: &#34;</span> <span class=o>+</span> <span class=n>sub</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;12: &#34;</span> <span class=o>+</span> <span class=n>pets</span><span class=o>.</span><span class=na>containsAll</span><span class=o>(</span><span class=n>sub</span><span class=o>));</span>
</span></span><span class=line><span class=cl>    <span class=n>List</span><span class=o>&lt;</span><span class=n>Pet</span><span class=o>&gt;</span> <span class=n>copy</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ArrayList</span><span class=o>&lt;&gt;(</span><span class=n>pets</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>sub</span> <span class=o>=</span> <span class=n>Arrays</span><span class=o>.</span><span class=na>asList</span><span class=o>(</span><span class=n>pets</span><span class=o>.</span><span class=na>get</span><span class=o>(</span><span class=mi>1</span><span class=o>),</span> <span class=n>pets</span><span class=o>.</span><span class=na>get</span><span class=o>(</span><span class=mi>4</span><span class=o>));</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;sub: &#34;</span> <span class=o>+</span> <span class=n>sub</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>copy</span><span class=o>.</span><span class=na>retainAll</span><span class=o>(</span><span class=n>sub</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;13: &#34;</span> <span class=o>+</span> <span class=n>copy</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>copy</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ArrayList</span><span class=o>&lt;&gt;(</span><span class=n>pets</span><span class=o>);</span> <span class=c1>// Get a fresh copy
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>copy</span><span class=o>.</span><span class=na>remove</span><span class=o>(</span><span class=mi>2</span><span class=o>);</span> <span class=c1>// Remove by index
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;14: &#34;</span> <span class=o>+</span> <span class=n>copy</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>copy</span><span class=o>.</span><span class=na>removeAll</span><span class=o>(</span><span class=n>sub</span><span class=o>);</span> <span class=c1>// Only removes exact objects
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;15: &#34;</span> <span class=o>+</span> <span class=n>copy</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>copy</span><span class=o>.</span><span class=na>set</span><span class=o>(</span><span class=mi>1</span><span class=o>,</span> <span class=k>new</span> <span class=n>Mouse</span><span class=o>());</span> <span class=c1>// Replace an element
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;16: &#34;</span> <span class=o>+</span> <span class=n>copy</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>copy</span><span class=o>.</span><span class=na>addAll</span><span class=o>(</span><span class=mi>2</span><span class=o>,</span> <span class=n>sub</span><span class=o>);</span> <span class=c1>// Insert a list in the middle
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;17: &#34;</span> <span class=o>+</span> <span class=n>copy</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;18: &#34;</span> <span class=o>+</span> <span class=n>pets</span><span class=o>.</span><span class=na>isEmpty</span><span class=o>());</span>
</span></span><span class=line><span class=cl>    <span class=n>pets</span><span class=o>.</span><span class=na>clear</span><span class=o>();</span> <span class=c1>// Remove all elements
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;19: &#34;</span> <span class=o>+</span> <span class=n>pets</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;20: &#34;</span> <span class=o>+</span> <span class=n>pets</span><span class=o>.</span><span class=na>isEmpty</span><span class=o>());</span>
</span></span><span class=line><span class=cl>    <span class=n>pets</span><span class=o>.</span><span class=na>addAll</span><span class=o>(</span><span class=n>Pets</span><span class=o>.</span><span class=na>list</span><span class=o>(</span><span class=mi>4</span><span class=o>));</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;21: &#34;</span> <span class=o>+</span> <span class=n>pets</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>Object</span><span class=o>[]</span> <span class=n>o</span> <span class=o>=</span> <span class=n>pets</span><span class=o>.</span><span class=na>toArray</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;22: &#34;</span> <span class=o>+</span> <span class=n>o</span><span class=o>[</span><span class=mi>3</span><span class=o>]);</span>
</span></span><span class=line><span class=cl>    <span class=n>Pet</span><span class=o>[]</span> <span class=n>pa</span> <span class=o>=</span> <span class=n>pets</span><span class=o>.</span><span class=na>toArray</span><span class=o>(</span><span class=k>new</span> <span class=n>Pet</span><span class=o>[</span><span class=mi>0</span><span class=o>]);</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;23: &#34;</span> <span class=o>+</span> <span class=n>pa</span><span class=o>[</span><span class=mi>3</span><span class=o>].</span><span class=na>id</span><span class=o>());</span>
</span></span><span class=line><span class=cl>  <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=cm>/* Output:
</span></span></span><span class=line><span class=cl><span class=cm>1: [Rat, Manx, Cymric, Mutt, Pug, Cymric, Pug]
</span></span></span><span class=line><span class=cl><span class=cm>2: [Rat, Manx, Cymric, Mutt, Pug, Cymric, Pug, Hamster]
</span></span></span><span class=line><span class=cl><span class=cm>3: true
</span></span></span><span class=line><span class=cl><span class=cm>4: Cymric 2
</span></span></span><span class=line><span class=cl><span class=cm>5: -1
</span></span></span><span class=line><span class=cl><span class=cm>6: false
</span></span></span><span class=line><span class=cl><span class=cm>7: true
</span></span></span><span class=line><span class=cl><span class=cm>8: [Rat, Manx, Mutt, Pug, Cymric, Pug]
</span></span></span><span class=line><span class=cl><span class=cm>9: [Rat, Manx, Mutt, Mouse, Pug, Cymric, Pug]
</span></span></span><span class=line><span class=cl><span class=cm>subList: [Manx, Mutt, Mouse]
</span></span></span><span class=line><span class=cl><span class=cm>10: true
</span></span></span><span class=line><span class=cl><span class=cm>sorted subList: [Manx, Mouse, Mutt]
</span></span></span><span class=line><span class=cl><span class=cm>11: true
</span></span></span><span class=line><span class=cl><span class=cm>shuffled subList: [Mouse, Manx, Mutt]
</span></span></span><span class=line><span class=cl><span class=cm>12: true
</span></span></span><span class=line><span class=cl><span class=cm>sub: [Mouse, Pug]
</span></span></span><span class=line><span class=cl><span class=cm>13: [Mouse, Pug]
</span></span></span><span class=line><span class=cl><span class=cm>14: [Rat, Mouse, Mutt, Pug, Cymric, Pug]
</span></span></span><span class=line><span class=cl><span class=cm>15: [Rat, Mutt, Cymric, Pug]
</span></span></span><span class=line><span class=cl><span class=cm>16: [Rat, Mouse, Cymric, Pug]
</span></span></span><span class=line><span class=cl><span class=cm>17: [Rat, Mouse, Mouse, Pug, Cymric, Pug]
</span></span></span><span class=line><span class=cl><span class=cm>18: false
</span></span></span><span class=line><span class=cl><span class=cm>19: []
</span></span></span><span class=line><span class=cl><span class=cm>20: true
</span></span></span><span class=line><span class=cl><span class=cm>21: [Manx, Cymric, Rat, EgyptianMau]
</span></span></span><span class=line><span class=cl><span class=cm>22: EgyptianMau
</span></span></span><span class=line><span class=cl><span class=cm>23: 14
</span></span></span><span class=line><span class=cl><span class=cm>*/</span>
</span></span></code></pre></div><p>打印行都编了号，因此可从输出追溯到源代码。 第 1 行输出展示了原始的由 <strong>Pet</strong> 组成的 <strong>List</strong> 。 与数组不同， <strong>List</strong> 可以在创建后添加或删除元素，并自行调整大小。这正是它的重要价值：一种可修改的序列。在第 2 行输出中可以看到添加一个 <strong>Hamster</strong> 的结果，该对象将被追加到列表的末尾。</p><p>可以使用 <code>contains()</code> 方法确定对象是否在列表中。如果要删除一个对象，可以将该对象的引用传递给 <code>remove()</code> 方法。同样，如果有一个对象的引用，可以使用 <code>indexOf()</code> 在 <strong>List</strong> 中找到该对象所在位置的下标号，如第 4 行输出所示中所示。</p><p>当确定元素是否是属于某个 <strong>List</strong> ，寻找某个元素的索引，以及通过引用从 <strong>List</strong> 中删除元素时，都会用到 <code>equals()</code> 方法（根类 <strong>Object</strong> 的一个方法）。每个 <strong>Pet</strong> 被定义为一个唯一的对象，所以即使列表中已经有两个 <strong>Cymrics</strong> ，如果再创建一个新的 <strong>Cymric</strong> 对象并将其传递给 <code>indexOf()</code> 方法，结果仍为 <strong>-1</strong> （表示未找到），并且尝试调用 <code>remove()</code> 方法来删除这个对象将返回 <strong>false</strong> 。对于其他类， <code>equals()</code> 的定义可能有所不同。例如，如果两个 <strong>String</strong> 的内容相同，则这两个 <strong>String</strong> 相等。因此，为了防止出现意外，请务必注意 <strong>List</strong> 行为会根据 <code>equals()</code> 行为而发生变化。</p><p>第 7、8 行输出展示了删除与 <strong>List</strong> 中的对象完全匹配的对象是成功的。</p><p>可以在 <strong>List</strong> 的中间插入一个元素，就像在第 9 行输出和它之前的代码那样。但这会带来一个问题：对于 <strong>LinkedList</strong> ，在列表中间插入和删除都是廉价操作（在本例中，除了对列表中间进行的真正的随机访问），但对于 <strong>ArrayList</strong> ，这可是代价高昂的操作。这是否意味着永远不应该在 <strong>ArrayList</strong> 的中间插入元素，并最好是转换为 <strong>LinkedList</strong> ？不，它只是意味着你应该意识到这个问题，如果你开始在某个 <strong>ArrayList</strong> 中间执行很多插入操作，并且程序开始变慢，那么你应该看看你的 <strong>List</strong> 实现有可能就是罪魁祸首（发现此类瓶颈的最佳方式是使用分析器 profiler）。优化是一个很棘手的问题，最好的策略就是置之不顾，直到发现必须要去担心它了（尽管去理解这些问题总是一个很好的主意）。</p><p><code>subList()</code> 方法可以轻松地从更大的列表中创建切片，当将切片结果传递给原来这个较大的列表的 <code>containsAll()</code> 方法时，很自然地会得到 <strong>true</strong>。请注意，顺序并不重要，在第 11、12 行输出中可以看到，在 <strong>sub</strong> 上调用直观命名的 <code>Collections.sort()</code> 和 <code>Collections.shuffle()</code> 方法，不会影响 <code>containsAll()</code> 的结果。 <code>subList()</code> 所产生的列表的幕后支持就是原始列表。因此，对所返回列表的更改都将会反映在原始列表中，反之亦然。</p><p><code>retainAll()</code> 方法实际上是一个“集合交集”操作，在本例中，它保留了同时在 <strong>copy</strong> 和 <strong>sub</strong> 中的所有元素。请再次注意，所产生的结果行为依赖于 <code>equals()</code> 方法。</p><p>第 14 行输出展示了使用索引号来删除元素的结果，与通过对象引用来删除元素相比，它显得更加直观，因为在使用索引时，不必担心 <code>equals()</code> 的行为。</p><p><code>removeAll()</code> 方法也是基于 <code>equals()</code> 方法运行的。 顾名思义，它会从 <strong>List</strong> 中删除在参数 <strong>List</strong> 中的所有元素。</p><p><code>set()</code> 方法的命名显得很不合时宜，因为它与 <strong>Set</strong> 类存在潜在的冲突。在这里使用“replace”可能更适合，因为它的功能是用第二个参数替换索引处的元素（第一个参数）。</p><p>第 17 行输出表明，对于 <strong>List</strong> ，有一个重载的 <code>addAll()</code> 方法可以将新列表插入到原始列表的中间位置，而不是仅能用 <strong>Collection</strong> 的 <code>addAll()</code> 方法将其追加到列表的末尾。</p><p>第 18 - 20 行输出展示了 <code>isEmpty()</code> 和 <code>clear()</code> 方法的效果。</p><p>第 22、23 行输出展示了如何使用 <code>toArray()</code> 方法将任意的 <strong>Collection</strong> 转换为数组。这是一个重载方法，其无参版本返回一个 <strong>Object</strong> 数组，但是如果将目标类型的数组传递给这个重载版本，那么它会生成一个指定类型的数组（假设它通过了类型检查）。如果参数数组太小而无法容纳 <strong>List</strong> 中的所有元素（就像本例一样），则 <code>toArray()</code> 会创建一个具有合适尺寸的新数组。 <strong>Pet</strong> 对象有一个 <code>id()</code> 方法，可以在所产生的数组中的对象上调用这个方法。</p><h2 id=迭代器-iterators>迭代器 Iterators</h2><p>在任何集合中，都必须有某种方式可以插入元素并再次获取它们。毕竟，保存事物是集合最基本的工作。对于 <strong>List</strong> ， <code>add()</code> 是插入元素的一种方式， <code>get()</code> 是获取元素的一种方式。</p><p>如果从更高层次的角度考虑，会发现这里有个缺点：要使用集合，必须对集合的确切类型编程。这一开始可能看起来不是很糟糕，但是考虑下面的情况：如果原本是对 <strong>List</strong> 编码的，但是后来发现如果能够将相同的代码应用于 <strong>Set</strong> 会更方便，此时应该怎么做？或者假设想从一开始就编写一段通用代码，它不知道或不关心它正在使用什么类型的集合，因此它可以用于不同类型的集合，那么如何才能不重写代码就可以应用于不同类型的集合？</p><p><em>迭代器</em>（也是一种设计模式）的概念实现了这种抽象。迭代器是一个对象，它在一个序列中移动并选择该序列中的每个对象，而客户端程序员不知道或不关心该序列的底层结构。另外，迭代器通常被称为<em>轻量级对象</em>（lightweight object）：创建它的代价小。因此，经常可以看到一些对迭代器有些奇怪的约束。例如，Java 的 <strong>Iterator</strong> 只能单向移动。这个 <strong>Iterator</strong> 只能用来：</p><ol><li>使用 <code>iterator()</code> 方法要求集合返回一个 <strong>Iterator</strong>。 <strong>Iterator</strong> 将准备好返回序列中的第一个元素。</li><li>使用 <code>next()</code> 方法获得序列中的下一个元素。</li><li>使用 <code>hasNext()</code> 方法检查序列中是否还有元素。</li><li>使用 <code>remove()</code> 方法将迭代器最近返回的那个元素删除。</li></ol><p>为了观察它的工作方式，这里再次使用<a href>类型信息</a>章节中的 <strong>Pet</strong> 工具：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// collections/SimpleIteration.java
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>import</span> <span class=nn>typeinfo.pets.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>java.util.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>SimpleIteration</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>  <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>List</span><span class=o>&lt;</span><span class=n>Pet</span><span class=o>&gt;</span> <span class=n>pets</span> <span class=o>=</span> <span class=n>Pets</span><span class=o>.</span><span class=na>list</span><span class=o>(</span><span class=mi>12</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>Iterator</span><span class=o>&lt;</span><span class=n>Pet</span><span class=o>&gt;</span> <span class=n>it</span> <span class=o>=</span> <span class=n>pets</span><span class=o>.</span><span class=na>iterator</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span><span class=o>(</span><span class=n>it</span><span class=o>.</span><span class=na>hasNext</span><span class=o>())</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>      <span class=n>Pet</span> <span class=n>p</span> <span class=o>=</span> <span class=n>it</span><span class=o>.</span><span class=na>next</span><span class=o>();</span>
</span></span><span class=line><span class=cl>      <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>print</span><span class=o>(</span><span class=n>p</span><span class=o>.</span><span class=na>id</span><span class=o>()</span> <span class=o>+</span> <span class=s>&#34;:&#34;</span> <span class=o>+</span> <span class=n>p</span> <span class=o>+</span> <span class=s>&#34; &#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=c1>// A simpler approach, when possible:
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>for</span><span class=o>(</span><span class=n>Pet</span> <span class=n>p</span> <span class=o>:</span> <span class=n>pets</span><span class=o>)</span>
</span></span><span class=line><span class=cl>      <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>print</span><span class=o>(</span><span class=n>p</span><span class=o>.</span><span class=na>id</span><span class=o>()</span> <span class=o>+</span> <span class=s>&#34;:&#34;</span> <span class=o>+</span> <span class=n>p</span> <span class=o>+</span> <span class=s>&#34; &#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=c1>// An Iterator can also remove elements:
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>it</span> <span class=o>=</span> <span class=n>pets</span><span class=o>.</span><span class=na>iterator</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span><span class=o>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=o>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=mi>6</span><span class=o>;</span> <span class=n>i</span><span class=o>++)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>      <span class=n>it</span><span class=o>.</span><span class=na>next</span><span class=o>();</span>
</span></span><span class=line><span class=cl>      <span class=n>it</span><span class=o>.</span><span class=na>remove</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>pets</span><span class=o>);</span>
</span></span><span class=line><span class=cl>  <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=cm>/* Output:
</span></span></span><span class=line><span class=cl><span class=cm>0:Rat 1:Manx 2:Cymric 3:Mutt 4:Pug 5:Cymric 6:Pug
</span></span></span><span class=line><span class=cl><span class=cm>7:Manx 8:Cymric 9:Rat 10:EgyptianMau 11:Hamster
</span></span></span><span class=line><span class=cl><span class=cm>0:Rat 1:Manx 2:Cymric 3:Mutt 4:Pug 5:Cymric 6:Pug
</span></span></span><span class=line><span class=cl><span class=cm>7:Manx 8:Cymric 9:Rat 10:EgyptianMau 11:Hamster
</span></span></span><span class=line><span class=cl><span class=cm>[Pug, Manx, Cymric, Rat, EgyptianMau, Hamster]
</span></span></span><span class=line><span class=cl><span class=cm>*/</span>
</span></span></code></pre></div><p>有了 <strong>Iterator</strong> ，就不必再为集合中元素的数量操心了。这是由 <code>hasNext()</code> 和 <code>next()</code> 关心的事情。</p><p>如果只是想向前遍历 <strong>List</strong> ，并不打算修改 <strong>List</strong> 对象本身，那么使用 <em>for-in</em> 语法更加简洁。</p><p><strong>Iterator</strong> 还可以删除由 <code>next()</code> 生成的最后一个元素，这意味着在调用 <code>remove()</code> 之前必须先调用 <code>next()</code> 。<sup id=fnref:4><a href=#fn:4 class=footnote-ref role=doc-noteref>4</a></sup></p><p>在集合中的每个对象上执行操作，这种思想十分强大，并且贯穿于本书。</p><p>现在考虑创建一个 <code>display()</code> 方法，它不必知晓集合的确切类型：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// collections/CrossCollectionIteration.java
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>import</span> <span class=nn>typeinfo.pets.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>java.util.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>CrossCollectionIteration</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>  <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>display</span><span class=o>(</span><span class=n>Iterator</span><span class=o>&lt;</span><span class=n>Pet</span><span class=o>&gt;</span> <span class=n>it</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span><span class=o>(</span><span class=n>it</span><span class=o>.</span><span class=na>hasNext</span><span class=o>())</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>      <span class=n>Pet</span> <span class=n>p</span> <span class=o>=</span> <span class=n>it</span><span class=o>.</span><span class=na>next</span><span class=o>();</span>
</span></span><span class=line><span class=cl>      <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>print</span><span class=o>(</span><span class=n>p</span><span class=o>.</span><span class=na>id</span><span class=o>()</span> <span class=o>+</span> <span class=s>&#34;:&#34;</span> <span class=o>+</span> <span class=n>p</span> <span class=o>+</span> <span class=s>&#34; &#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>();</span>
</span></span><span class=line><span class=cl>  <span class=o>}</span>
</span></span><span class=line><span class=cl>  <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>List</span><span class=o>&lt;</span><span class=n>Pet</span><span class=o>&gt;</span> <span class=n>pets</span> <span class=o>=</span> <span class=n>Pets</span><span class=o>.</span><span class=na>list</span><span class=o>(</span><span class=mi>8</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>LinkedList</span><span class=o>&lt;</span><span class=n>Pet</span><span class=o>&gt;</span> <span class=n>petsLL</span> <span class=o>=</span> <span class=k>new</span> <span class=n>LinkedList</span><span class=o>&lt;&gt;(</span><span class=n>pets</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>HashSet</span><span class=o>&lt;</span><span class=n>Pet</span><span class=o>&gt;</span> <span class=n>petsHS</span> <span class=o>=</span> <span class=k>new</span> <span class=n>HashSet</span><span class=o>&lt;&gt;(</span><span class=n>pets</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>TreeSet</span><span class=o>&lt;</span><span class=n>Pet</span><span class=o>&gt;</span> <span class=n>petsTS</span> <span class=o>=</span> <span class=k>new</span> <span class=n>TreeSet</span><span class=o>&lt;&gt;(</span><span class=n>pets</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>display</span><span class=o>(</span><span class=n>pets</span><span class=o>.</span><span class=na>iterator</span><span class=o>());</span>
</span></span><span class=line><span class=cl>    <span class=n>display</span><span class=o>(</span><span class=n>petsLL</span><span class=o>.</span><span class=na>iterator</span><span class=o>());</span>
</span></span><span class=line><span class=cl>    <span class=n>display</span><span class=o>(</span><span class=n>petsHS</span><span class=o>.</span><span class=na>iterator</span><span class=o>());</span>
</span></span><span class=line><span class=cl>    <span class=n>display</span><span class=o>(</span><span class=n>petsTS</span><span class=o>.</span><span class=na>iterator</span><span class=o>());</span>
</span></span><span class=line><span class=cl>  <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=cm>/* Output:
</span></span></span><span class=line><span class=cl><span class=cm>0:Rat 1:Manx 2:Cymric 3:Mutt 4:Pug 5:Cymric 6:Pug 7:Manx
</span></span></span><span class=line><span class=cl><span class=cm>0:Rat 1:Manx 2:Cymric 3:Mutt 4:Pug 5:Cymric 6:Pug 7:Manx
</span></span></span><span class=line><span class=cl><span class=cm>0:Rat 1:Manx 2:Cymric 3:Mutt 4:Pug 5:Cymric 6:Pug 7:Manx
</span></span></span><span class=line><span class=cl><span class=cm>5:Cymric 2:Cymric 7:Manx 1:Manx 3:Mutt 6:Pug 4:Pug 0:Rat
</span></span></span><span class=line><span class=cl><span class=cm>*/</span>
</span></span></code></pre></div><p><code>display()</code> 方法不包含任何有关它所遍历的序列的类型信息。这也展示了 <strong>Iterator</strong> 的真正威力：能够将遍历序列的操作与该序列的底层结构分离。出于这个原因，我们有时会说：迭代器统一了对集合的访问方式。</p><p>我们可以使用 <strong>Iterable</strong> 接口生成上一个示例的更简洁版本，该接口描述了“可以产生 <strong>Iterator</strong> 的任何东西”：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// collections/CrossCollectionIteration2.java
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>import</span> <span class=nn>typeinfo.pets.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>java.util.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>CrossCollectionIteration2</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>  <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>display</span><span class=o>(</span><span class=n>Iterable</span><span class=o>&lt;</span><span class=n>Pet</span><span class=o>&gt;</span> <span class=n>ip</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>Iterator</span><span class=o>&lt;</span><span class=n>Pet</span><span class=o>&gt;</span> <span class=n>it</span> <span class=o>=</span> <span class=n>ip</span><span class=o>.</span><span class=na>iterator</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span><span class=o>(</span><span class=n>it</span><span class=o>.</span><span class=na>hasNext</span><span class=o>())</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>      <span class=n>Pet</span> <span class=n>p</span> <span class=o>=</span> <span class=n>it</span><span class=o>.</span><span class=na>next</span><span class=o>();</span>
</span></span><span class=line><span class=cl>      <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>print</span><span class=o>(</span><span class=n>p</span><span class=o>.</span><span class=na>id</span><span class=o>()</span> <span class=o>+</span> <span class=s>&#34;:&#34;</span> <span class=o>+</span> <span class=n>p</span> <span class=o>+</span> <span class=s>&#34; &#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>();</span>
</span></span><span class=line><span class=cl>  <span class=o>}</span>
</span></span><span class=line><span class=cl>  <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>List</span><span class=o>&lt;</span><span class=n>Pet</span><span class=o>&gt;</span> <span class=n>pets</span> <span class=o>=</span> <span class=n>Pets</span><span class=o>.</span><span class=na>list</span><span class=o>(</span><span class=mi>8</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>LinkedList</span><span class=o>&lt;</span><span class=n>Pet</span><span class=o>&gt;</span> <span class=n>petsLL</span> <span class=o>=</span> <span class=k>new</span> <span class=n>LinkedList</span><span class=o>&lt;&gt;(</span><span class=n>pets</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>HashSet</span><span class=o>&lt;</span><span class=n>Pet</span><span class=o>&gt;</span> <span class=n>petsHS</span> <span class=o>=</span> <span class=k>new</span> <span class=n>HashSet</span><span class=o>&lt;&gt;(</span><span class=n>pets</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>TreeSet</span><span class=o>&lt;</span><span class=n>Pet</span><span class=o>&gt;</span> <span class=n>petsTS</span> <span class=o>=</span> <span class=k>new</span> <span class=n>TreeSet</span><span class=o>&lt;&gt;(</span><span class=n>pets</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>display</span><span class=o>(</span><span class=n>pets</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>display</span><span class=o>(</span><span class=n>petsLL</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>display</span><span class=o>(</span><span class=n>petsHS</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>display</span><span class=o>(</span><span class=n>petsTS</span><span class=o>);</span>
</span></span><span class=line><span class=cl>  <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=cm>/* Output:
</span></span></span><span class=line><span class=cl><span class=cm>0:Rat 1:Manx 2:Cymric 3:Mutt 4:Pug 5:Cymric 6:Pug 7:Manx
</span></span></span><span class=line><span class=cl><span class=cm>0:Rat 1:Manx 2:Cymric 3:Mutt 4:Pug 5:Cymric 6:Pug 7:Manx
</span></span></span><span class=line><span class=cl><span class=cm>0:Rat 1:Manx 2:Cymric 3:Mutt 4:Pug 5:Cymric 6:Pug 7:Manx
</span></span></span><span class=line><span class=cl><span class=cm>5:Cymric 2:Cymric 7:Manx 1:Manx 3:Mutt 6:Pug 4:Pug 0:Rat
</span></span></span><span class=line><span class=cl><span class=cm>*/</span>
</span></span></code></pre></div><p>这里所有的类都是 <strong>Iterable</strong> ，所以现在对 <code>display()</code> 的调用显然更简单。</p><h3 id=listiterator>ListIterator</h3><p><strong>ListIterator</strong> 是一个更强大的 <strong>Iterator</strong> 子类型，它只能由各种 <strong>List</strong> 类生成。 <strong>Iterator</strong> 只能向前移动，而 <strong>ListIterator</strong> 可以双向移动。它可以生成迭代器在列表中指向位置的后一个和前一个元素的索引，并且可以使用 <code>set()</code> 方法替换它访问过的最近一个元素。可以通过调用 <code>listIterator()</code> 方法来生成指向 <strong>List</strong> 开头处的 <strong>ListIterator</strong> ，还可以通过调用 <code>listIterator(n)</code> 创建一个一开始就指向列表索引号为 <strong>n</strong> 的元素处的 <strong>ListIterator</strong> 。 下面的示例演示了所有这些能力：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// collections/ListIteration.java
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>import</span> <span class=nn>typeinfo.pets.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>java.util.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>ListIteration</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>  <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>List</span><span class=o>&lt;</span><span class=n>Pet</span><span class=o>&gt;</span> <span class=n>pets</span> <span class=o>=</span> <span class=n>Pets</span><span class=o>.</span><span class=na>list</span><span class=o>(</span><span class=mi>8</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>ListIterator</span><span class=o>&lt;</span><span class=n>Pet</span><span class=o>&gt;</span> <span class=n>it</span> <span class=o>=</span> <span class=n>pets</span><span class=o>.</span><span class=na>listIterator</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span><span class=o>(</span><span class=n>it</span><span class=o>.</span><span class=na>hasNext</span><span class=o>())</span>
</span></span><span class=line><span class=cl>      <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>print</span><span class=o>(</span><span class=n>it</span><span class=o>.</span><span class=na>next</span><span class=o>()</span> <span class=o>+</span>
</span></span><span class=line><span class=cl>        <span class=s>&#34;, &#34;</span> <span class=o>+</span> <span class=n>it</span><span class=o>.</span><span class=na>nextIndex</span><span class=o>()</span> <span class=o>+</span>
</span></span><span class=line><span class=cl>        <span class=s>&#34;, &#34;</span> <span class=o>+</span> <span class=n>it</span><span class=o>.</span><span class=na>previousIndex</span><span class=o>()</span> <span class=o>+</span> <span class=s>&#34;; &#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=c1>// Backwards:
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>while</span><span class=o>(</span><span class=n>it</span><span class=o>.</span><span class=na>hasPrevious</span><span class=o>())</span>
</span></span><span class=line><span class=cl>      <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>print</span><span class=o>(</span><span class=n>it</span><span class=o>.</span><span class=na>previous</span><span class=o>().</span><span class=na>id</span><span class=o>()</span> <span class=o>+</span> <span class=s>&#34; &#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>pets</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>it</span> <span class=o>=</span> <span class=n>pets</span><span class=o>.</span><span class=na>listIterator</span><span class=o>(</span><span class=mi>3</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span><span class=o>(</span><span class=n>it</span><span class=o>.</span><span class=na>hasNext</span><span class=o>())</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>      <span class=n>it</span><span class=o>.</span><span class=na>next</span><span class=o>();</span>
</span></span><span class=line><span class=cl>      <span class=n>it</span><span class=o>.</span><span class=na>set</span><span class=o>(</span><span class=n>Pets</span><span class=o>.</span><span class=na>get</span><span class=o>());</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>pets</span><span class=o>);</span>
</span></span><span class=line><span class=cl>  <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=cm>/* Output:
</span></span></span><span class=line><span class=cl><span class=cm>Rat, 1, 0; Manx, 2, 1; Cymric, 3, 2; Mutt, 4, 3; Pug, 5, 4; Cymric, 6, 5; Pug, 7, 6; Manx, 8, 7;
</span></span></span><span class=line><span class=cl><span class=cm>7 6 5 4 3 2 1 0
</span></span></span><span class=line><span class=cl><span class=cm>[Rat, Manx, Cymric, Mutt, Pug, Cymric, Pug, Manx]
</span></span></span><span class=line><span class=cl><span class=cm>[Rat, Manx, Cymric, Cymric, Rat, EgyptianMau, Hamster, EgyptianMau]
</span></span></span><span class=line><span class=cl><span class=cm>*/</span>
</span></span></code></pre></div><p><code>Pets.get()</code> 方法用来从位置 3 开始替换 <strong>List</strong> 中的所有 Pet 对象。</p><h2 id=链表-linkedlist>链表 LinkedList</h2><p><strong>LinkedList</strong> 也像 <strong>ArrayList</strong> 一样实现了基本的 <strong>List</strong> 接口，但它在 <strong>List</strong> 中间执行插入和删除操作时比 <strong>ArrayList</strong> 更高效。然而,它在随机访问操作效率方面却要逊色一些。</p><p><strong>LinkedList 还添加了一些方法，使其可以被用作栈、队列或双端队列（deque）</strong> 。在这些方法中，有些彼此之间可能只是名称有些差异，或者只存在些许差异，以使得这些名字在特定用法的上下文环境中更加适用（特别是在 <strong>Queue</strong> 中）。例如：</p><ul><li><code>getFirst()</code> 和 <code>element()</code> 是相同的，它们都返回列表的头部（第一个元素）而并不删除它，如果 <strong>List</strong> 为空，则抛出 <strong>NoSuchElementException</strong> 异常。 <code>peek()</code> 方法与这两个方法只是稍有差异，它在列表为空时返回 <strong>null</strong> 。</li><li><code>removeFirst()</code> 和 <code>remove()</code> 也是相同的，它们删除并返回列表的头部元素，并在列表为空时抛出 <strong>NoSuchElementException</strong> 异常。 <code>poll()</code> 稍有差异，它在列表为空时返回 <strong>null</strong> 。</li><li><code>addFirst()</code> 在列表的开头插入一个元素。</li><li><code>offer()</code> 与 <code>add()</code> 和 <code>addLast()</code> 相同。 它们都在列表的尾部（末尾）添加一个元素。</li><li><code>removeLast()</code> 删除并返回列表的最后一个元素。</li></ul><p>下面的示例展示了这些功能之间基本的相似性和差异性。它并不是重复执行 <strong>ListFeatures.java</strong> 中所示的行为：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// collections/LinkedListFeatures.java
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>import</span> <span class=nn>typeinfo.pets.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>java.util.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>LinkedListFeatures</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>  <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>LinkedList</span><span class=o>&lt;</span><span class=n>Pet</span><span class=o>&gt;</span> <span class=n>pets</span> <span class=o>=</span>
</span></span><span class=line><span class=cl>      <span class=k>new</span> <span class=n>LinkedList</span><span class=o>&lt;&gt;(</span><span class=n>Pets</span><span class=o>.</span><span class=na>list</span><span class=o>(</span><span class=mi>5</span><span class=o>));</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>pets</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=c1>// Identical:
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span>
</span></span><span class=line><span class=cl>      <span class=s>&#34;pets.getFirst(): &#34;</span> <span class=o>+</span> <span class=n>pets</span><span class=o>.</span><span class=na>getFirst</span><span class=o>());</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span>
</span></span><span class=line><span class=cl>      <span class=s>&#34;pets.element(): &#34;</span> <span class=o>+</span> <span class=n>pets</span><span class=o>.</span><span class=na>element</span><span class=o>());</span>
</span></span><span class=line><span class=cl>    <span class=c1>// Only differs in empty-list behavior:
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;pets.peek(): &#34;</span> <span class=o>+</span> <span class=n>pets</span><span class=o>.</span><span class=na>peek</span><span class=o>());</span>
</span></span><span class=line><span class=cl>    <span class=c1>// Identical; remove and return the first element:
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span>
</span></span><span class=line><span class=cl>      <span class=s>&#34;pets.remove(): &#34;</span> <span class=o>+</span> <span class=n>pets</span><span class=o>.</span><span class=na>remove</span><span class=o>());</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span>
</span></span><span class=line><span class=cl>      <span class=s>&#34;pets.removeFirst(): &#34;</span> <span class=o>+</span> <span class=n>pets</span><span class=o>.</span><span class=na>removeFirst</span><span class=o>());</span>
</span></span><span class=line><span class=cl>    <span class=c1>// Only differs in empty-list behavior:
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;pets.poll(): &#34;</span> <span class=o>+</span> <span class=n>pets</span><span class=o>.</span><span class=na>poll</span><span class=o>());</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>pets</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>pets</span><span class=o>.</span><span class=na>addFirst</span><span class=o>(</span><span class=k>new</span> <span class=n>Rat</span><span class=o>());</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;After addFirst(): &#34;</span> <span class=o>+</span> <span class=n>pets</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>pets</span><span class=o>.</span><span class=na>offer</span><span class=o>(</span><span class=n>Pets</span><span class=o>.</span><span class=na>get</span><span class=o>());</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;After offer(): &#34;</span> <span class=o>+</span> <span class=n>pets</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>pets</span><span class=o>.</span><span class=na>add</span><span class=o>(</span><span class=n>Pets</span><span class=o>.</span><span class=na>get</span><span class=o>());</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;After add(): &#34;</span> <span class=o>+</span> <span class=n>pets</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>pets</span><span class=o>.</span><span class=na>addLast</span><span class=o>(</span><span class=k>new</span> <span class=n>Hamster</span><span class=o>());</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;After addLast(): &#34;</span> <span class=o>+</span> <span class=n>pets</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span>
</span></span><span class=line><span class=cl>      <span class=s>&#34;pets.removeLast(): &#34;</span> <span class=o>+</span> <span class=n>pets</span><span class=o>.</span><span class=na>removeLast</span><span class=o>());</span>
</span></span><span class=line><span class=cl>  <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=cm>/* Output:
</span></span></span><span class=line><span class=cl><span class=cm>[Rat, Manx, Cymric, Mutt, Pug]
</span></span></span><span class=line><span class=cl><span class=cm>pets.getFirst(): Rat
</span></span></span><span class=line><span class=cl><span class=cm>pets.element(): Rat
</span></span></span><span class=line><span class=cl><span class=cm>pets.peek(): Rat
</span></span></span><span class=line><span class=cl><span class=cm>pets.remove(): Rat
</span></span></span><span class=line><span class=cl><span class=cm>pets.removeFirst(): Manx
</span></span></span><span class=line><span class=cl><span class=cm>pets.poll(): Cymric
</span></span></span><span class=line><span class=cl><span class=cm>[Mutt, Pug]
</span></span></span><span class=line><span class=cl><span class=cm>After addFirst(): [Rat, Mutt, Pug]
</span></span></span><span class=line><span class=cl><span class=cm>After offer(): [Rat, Mutt, Pug, Cymric]
</span></span></span><span class=line><span class=cl><span class=cm>After add(): [Rat, Mutt, Pug, Cymric, Pug]
</span></span></span><span class=line><span class=cl><span class=cm>After addLast(): [Rat, Mutt, Pug, Cymric, Pug, Hamster]
</span></span></span><span class=line><span class=cl><span class=cm>pets.removeLast(): Hamster
</span></span></span><span class=line><span class=cl><span class=cm>*/</span>
</span></span></code></pre></div><p><code>Pets.list()</code> 的结果被传递给 <strong>LinkedList</strong> 的构造器，以便使用它来填充 <strong>LinkedList</strong> 。如果查看 <strong>Queue</strong> 接口就会发现，它在 <strong>LinkedList</strong> 的基础上添加了 <code>element()</code> ， <code>offer()</code> ， <code>peek()</code> ， <code>poll()</code> 和 <code>remove()</code> 方法，以使其可以成为一个 <strong>Queue</strong> 的实现。 <strong>Queue</strong> 的完整示例将在本章稍后给出。</p><h2 id=堆栈-stack>堆栈 Stack</h2><p>堆栈是“后进先出”（LIFO）集合。它有时被称为<em>叠加栈</em>（pushdown stack），因为最后“压入”（push）栈的元素，第一个被“弹出”（pop）栈。经常用来类比栈的事物是带有弹簧支架的自助餐厅托盘。最后装入的托盘总是最先拿出来使用的。</p><p>Java 1.0 中附带了一个 <strong>Stack</strong> 类，结果设计得很糟糕（为了向后兼容，我们被迫一直忍受 Java 中的旧设计错误）。Java 6 添加了 <strong>ArrayDeque</strong> ，其中包含直接实现堆栈功能的方法：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// collections/StackTest.java
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>import</span> <span class=nn>java.util.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>StackTest</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>  <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>Deque</span><span class=o>&lt;</span><span class=n>String</span><span class=o>&gt;</span> <span class=n>stack</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ArrayDeque</span><span class=o>&lt;&gt;();</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span><span class=o>(</span><span class=n>String</span> <span class=n>s</span> <span class=o>:</span> <span class=s>&#34;My dog has fleas&#34;</span><span class=o>.</span><span class=na>split</span><span class=o>(</span><span class=s>&#34; &#34;</span><span class=o>))</span>
</span></span><span class=line><span class=cl>      <span class=n>stack</span><span class=o>.</span><span class=na>push</span><span class=o>(</span><span class=n>s</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span><span class=o>(!</span><span class=n>stack</span><span class=o>.</span><span class=na>isEmpty</span><span class=o>())</span>
</span></span><span class=line><span class=cl>      <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>print</span><span class=o>(</span><span class=n>stack</span><span class=o>.</span><span class=na>pop</span><span class=o>()</span> <span class=o>+</span> <span class=s>&#34; &#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>  <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=cm>/* Output:
</span></span></span><span class=line><span class=cl><span class=cm>fleas has dog My
</span></span></span><span class=line><span class=cl><span class=cm>*/</span>
</span></span></code></pre></div><p>即使它是作为一个堆栈在使用，我们仍然必须将其声明为 <strong>Deque</strong> 。有时一个名为 <strong>Stack</strong> 的类更能把事情讲清楚：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// onjava/Stack.java
</span></span></span><span class=line><span class=cl><span class=c1>// A Stack class built with an ArrayDeque
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>package</span> <span class=nn>onjava</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>java.util.Deque</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>java.util.ArrayDeque</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>Stack</span><span class=o>&lt;</span><span class=n>T</span><span class=o>&gt;</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>  <span class=kd>private</span> <span class=n>Deque</span><span class=o>&lt;</span><span class=n>T</span><span class=o>&gt;</span> <span class=n>storage</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ArrayDeque</span><span class=o>&lt;&gt;();</span>
</span></span><span class=line><span class=cl>  <span class=kd>public</span> <span class=kt>void</span> <span class=nf>push</span><span class=o>(</span><span class=n>T</span> <span class=n>v</span><span class=o>)</span> <span class=o>{</span> <span class=n>storage</span><span class=o>.</span><span class=na>push</span><span class=o>(</span><span class=n>v</span><span class=o>);</span> <span class=o>}</span>
</span></span><span class=line><span class=cl>  <span class=kd>public</span> <span class=n>T</span> <span class=nf>peek</span><span class=o>()</span> <span class=o>{</span> <span class=k>return</span> <span class=n>storage</span><span class=o>.</span><span class=na>peek</span><span class=o>();</span> <span class=o>}</span>
</span></span><span class=line><span class=cl>  <span class=kd>public</span> <span class=n>T</span> <span class=nf>pop</span><span class=o>()</span> <span class=o>{</span> <span class=k>return</span> <span class=n>storage</span><span class=o>.</span><span class=na>pop</span><span class=o>();</span> <span class=o>}</span>
</span></span><span class=line><span class=cl>  <span class=kd>public</span> <span class=kt>boolean</span> <span class=nf>isEmpty</span><span class=o>()</span> <span class=o>{</span> <span class=k>return</span> <span class=n>storage</span><span class=o>.</span><span class=na>isEmpty</span><span class=o>();</span> <span class=o>}</span>
</span></span><span class=line><span class=cl>  <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>  <span class=kd>public</span> <span class=n>String</span> <span class=nf>toString</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>storage</span><span class=o>.</span><span class=na>toString</span><span class=o>();</span>
</span></span><span class=line><span class=cl>  <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>这里引入了使用泛型的类定义的最简单的可能示例。类名称后面的 <strong>&lt;T></strong> 告诉编译器这是一个参数化类型，而其中的类型参数 <strong>T</strong> 会在使用类时被实际类型替换。基本上，这个类是在声明“我们在定义一个可以持有 <strong>T</strong> 类型对象的 <strong>Stack</strong> 。” <strong>Stack</strong> 是使用 <strong>ArrayDeque</strong> 实现的，而 <strong>ArrayDeque</strong> 也被告知它将持有 <strong>T</strong> 类型对象。注意， <code>push()</code> 接受类型为 <strong>T</strong> 的对象，而 <code>peek()</code> 和 <code>pop()</code> 返回类型为 <strong>T</strong> 的对象。 <code>peek()</code> 方法将返回栈顶元素，但并不将其从栈顶删除，而 <code>pop()</code> 删除并返回顶部元素。</p><p>如果只需要栈的行为，那么使用继承是不合适的，因为这将产生一个具有 <strong>ArrayDeque</strong> 的其它所有方法的类（在<a href>附录：集合主题</a>中将会看到， <strong>Java 1.0</strong> 设计者在创建 <strong>java.util.Stack</strong> 时，就犯了这个错误）。使用组合，可以选择要公开的方法以及如何命名它们。</p><p>下面将使用 <strong>StackTest.java</strong> 中的相同代码来演示这个新的 <strong>Stack</strong> 类：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// collections/StackTest2.java
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>import</span> <span class=nn>onjava.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>StackTest2</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>  <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>Stack</span><span class=o>&lt;</span><span class=n>String</span><span class=o>&gt;</span> <span class=n>stack</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Stack</span><span class=o>&lt;&gt;();</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span><span class=o>(</span><span class=n>String</span> <span class=n>s</span> <span class=o>:</span> <span class=s>&#34;My dog has fleas&#34;</span><span class=o>.</span><span class=na>split</span><span class=o>(</span><span class=s>&#34; &#34;</span><span class=o>))</span>
</span></span><span class=line><span class=cl>      <span class=n>stack</span><span class=o>.</span><span class=na>push</span><span class=o>(</span><span class=n>s</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span><span class=o>(!</span><span class=n>stack</span><span class=o>.</span><span class=na>isEmpty</span><span class=o>())</span>
</span></span><span class=line><span class=cl>      <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>print</span><span class=o>(</span><span class=n>stack</span><span class=o>.</span><span class=na>pop</span><span class=o>()</span> <span class=o>+</span> <span class=s>&#34; &#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>  <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=cm>/* Output:
</span></span></span><span class=line><span class=cl><span class=cm>fleas has dog My
</span></span></span><span class=line><span class=cl><span class=cm>*/</span>
</span></span></code></pre></div><p>如果想在自己的代码中使用这个 <strong>Stack</strong> 类，当在创建其实例时，就需要完整指定包名，或者更改这个类的名称；否则，就有可能会与 <strong>java.util</strong> 包中的 <strong>Stack</strong> 发生冲突。例如，如果我们在上面的例子中导入 <strong>java.util.*</strong>，那么就必须使用包名来防止冲突：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// collections/StackCollision.java
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>StackCollision</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>  <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>onjava</span><span class=o>.</span><span class=na>Stack</span><span class=o>&lt;</span><span class=n>String</span><span class=o>&gt;</span> <span class=n>stack</span> <span class=o>=</span> <span class=k>new</span> <span class=n>onjava</span><span class=o>.</span><span class=na>Stack</span><span class=o>&lt;&gt;();</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span><span class=o>(</span><span class=n>String</span> <span class=n>s</span> <span class=o>:</span> <span class=s>&#34;My dog has fleas&#34;</span><span class=o>.</span><span class=na>split</span><span class=o>(</span><span class=s>&#34; &#34;</span><span class=o>))</span>
</span></span><span class=line><span class=cl>      <span class=n>stack</span><span class=o>.</span><span class=na>push</span><span class=o>(</span><span class=n>s</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span><span class=o>(!</span><span class=n>stack</span><span class=o>.</span><span class=na>isEmpty</span><span class=o>())</span>
</span></span><span class=line><span class=cl>      <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>print</span><span class=o>(</span><span class=n>stack</span><span class=o>.</span><span class=na>pop</span><span class=o>()</span> <span class=o>+</span> <span class=s>&#34; &#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=n>java</span><span class=o>.</span><span class=na>util</span><span class=o>.</span><span class=na>Stack</span><span class=o>&lt;</span><span class=n>String</span><span class=o>&gt;</span> <span class=n>stack2</span> <span class=o>=</span>
</span></span><span class=line><span class=cl>      <span class=k>new</span> <span class=n>java</span><span class=o>.</span><span class=na>util</span><span class=o>.</span><span class=na>Stack</span><span class=o>&lt;&gt;();</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span><span class=o>(</span><span class=n>String</span> <span class=n>s</span> <span class=o>:</span> <span class=s>&#34;My dog has fleas&#34;</span><span class=o>.</span><span class=na>split</span><span class=o>(</span><span class=s>&#34; &#34;</span><span class=o>))</span>
</span></span><span class=line><span class=cl>      <span class=n>stack2</span><span class=o>.</span><span class=na>push</span><span class=o>(</span><span class=n>s</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span><span class=o>(!</span><span class=n>stack2</span><span class=o>.</span><span class=na>empty</span><span class=o>())</span>
</span></span><span class=line><span class=cl>      <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>print</span><span class=o>(</span><span class=n>stack2</span><span class=o>.</span><span class=na>pop</span><span class=o>()</span> <span class=o>+</span> <span class=s>&#34; &#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>  <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=cm>/* Output:
</span></span></span><span class=line><span class=cl><span class=cm>fleas has dog My
</span></span></span><span class=line><span class=cl><span class=cm>fleas has dog My
</span></span></span><span class=line><span class=cl><span class=cm>*/</span>
</span></span></code></pre></div><p>尽管已经有了 <strong>java.util.Stack</strong> ，但是 <strong>ArrayDeque</strong> 可以产生更好的 <strong>Stack</strong> ，因此更可取。</p><p>还可以使用显式导入来控制对“首选” <strong>Stack</strong> 实现的选择：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kn>import</span> <span class=nn>onjava.Stack</span><span class=o>;</span>
</span></span></code></pre></div><p>现在,任何对 <strong>Stack</strong> 的引用都将选择 <strong>onjava</strong> 版本，而在选择 <strong>java.util.Stack</strong> 时，必须使用全限定名称（full qualification）。</p><h2 id=集合-set>集合 Set</h2><p><strong>Set</strong> 不保存重复的元素。 如果试图将相同对象的多个实例添加到 <strong>Set</strong> 中，那么它会阻止这种重复行为。 <strong>Set</strong> 最常见的用途是测试归属性，可以很轻松地询问某个对象是否在一个 <strong>Set</strong> 中。因此，查找通常是 <strong>Set</strong> 最重要的操作，因此通常会选择 <strong>HashSet</strong> 实现，该实现针对快速查找进行了优化。</p><p><strong>Set</strong> 具有与 <strong>Collection</strong> 相同的接口，因此没有任何额外的功能，不像前面两种不同类型的 <strong>List</strong> 那样。实际上， <strong>Set</strong> 就是一个 <strong>Collection</strong> ，只是行为不同。（这是继承和多态思想的典型应用：表现不同的行为。）<strong>Set</strong> 根据对象的“值”确定归属性，更复杂的内容将在<a href>附录：集合主题</a>中介绍。</p><p>下面是使用存放 <strong>Integer</strong> 对象的 <strong>HashSet</strong> 的示例：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// collections/SetOfInteger.java
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>import</span> <span class=nn>java.util.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>SetOfInteger</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>  <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>Random</span> <span class=n>rand</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Random</span><span class=o>(</span><span class=mi>47</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>Set</span><span class=o>&lt;</span><span class=n>Integer</span><span class=o>&gt;</span> <span class=n>intset</span> <span class=o>=</span> <span class=k>new</span> <span class=n>HashSet</span><span class=o>&lt;&gt;();</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span><span class=o>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=o>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=mi>10000</span><span class=o>;</span> <span class=n>i</span><span class=o>++)</span>
</span></span><span class=line><span class=cl>      <span class=n>intset</span><span class=o>.</span><span class=na>add</span><span class=o>(</span><span class=n>rand</span><span class=o>.</span><span class=na>nextInt</span><span class=o>(</span><span class=mi>30</span><span class=o>));</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>intset</span><span class=o>);</span>
</span></span><span class=line><span class=cl>  <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=cm>/* Output:
</span></span></span><span class=line><span class=cl><span class=cm>[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
</span></span></span><span class=line><span class=cl><span class=cm>*/</span>
</span></span></code></pre></div><p>在 0 到 29 之间的 10000 个随机整数被添加到 <strong>Set</strong> 中，因此可以想象每个值都重复了很多次。但是从结果中可以看到，每一个数只有一个实例出现在结果中。</p><p>早期 Java 版本中的 <strong>HashSet</strong> 产生的输出没有明显的顺序。这是因为出于对速度的追求， <strong>HashSet</strong> 使用了散列，请参阅<a href>附录：集合主题</a>一章。由 <strong>HashSet</strong> 维护的顺序与 <strong>TreeSet</strong> 或 <strong>LinkedHashSet</strong> 不同，因为它们的实现具有不同的元素存储方式。 <strong>TreeSet</strong> 将元素存储在红-黑树数据结构中，而 <strong>HashSet</strong> 使用散列函数。 <strong>LinkedHashSet</strong> 也使用散列来提高查询速度，但是似乎使用了链表来维护元素的插入顺序。显然，散列算法有改动，以至于现在（上述示例中的 HashSet ） <strong>Integer</strong> 是有序的。但是，您不应该依赖此行为（下面例子就没有排序）：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// collections/SetOfString.java
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>import</span> <span class=nn>java.util.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>SetOfString</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>  <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>Set</span><span class=o>&lt;</span><span class=n>String</span><span class=o>&gt;</span> <span class=n>colors</span> <span class=o>=</span> <span class=k>new</span> <span class=n>HashSet</span><span class=o>&lt;&gt;();</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span><span class=o>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=o>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=mi>100</span><span class=o>;</span> <span class=n>i</span><span class=o>++)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>      <span class=n>colors</span><span class=o>.</span><span class=na>add</span><span class=o>(</span><span class=s>&#34;Yellow&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>      <span class=n>colors</span><span class=o>.</span><span class=na>add</span><span class=o>(</span><span class=s>&#34;Blue&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>      <span class=n>colors</span><span class=o>.</span><span class=na>add</span><span class=o>(</span><span class=s>&#34;Red&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>      <span class=n>colors</span><span class=o>.</span><span class=na>add</span><span class=o>(</span><span class=s>&#34;Red&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>      <span class=n>colors</span><span class=o>.</span><span class=na>add</span><span class=o>(</span><span class=s>&#34;Orange&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>      <span class=n>colors</span><span class=o>.</span><span class=na>add</span><span class=o>(</span><span class=s>&#34;Yellow&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>      <span class=n>colors</span><span class=o>.</span><span class=na>add</span><span class=o>(</span><span class=s>&#34;Blue&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>      <span class=n>colors</span><span class=o>.</span><span class=na>add</span><span class=o>(</span><span class=s>&#34;Purple&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>colors</span><span class=o>);</span>
</span></span><span class=line><span class=cl>  <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=cm>/* Output:
</span></span></span><span class=line><span class=cl><span class=cm>[Red, Yellow, Blue, Purple, Orange]
</span></span></span><span class=line><span class=cl><span class=cm>*/</span>
</span></span></code></pre></div><p><strong>String</strong> 对象似乎没有排序。要对结果进行排序，一种方法是使用 <strong>TreeSet</strong> 而不是 <strong>HashSet</strong> ：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// collections/SortedSetOfString.java
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>import</span> <span class=nn>java.util.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>SortedSetOfString</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>  <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>Set</span><span class=o>&lt;</span><span class=n>String</span><span class=o>&gt;</span> <span class=n>colors</span> <span class=o>=</span> <span class=k>new</span> <span class=n>TreeSet</span><span class=o>&lt;&gt;();</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span><span class=o>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=o>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=mi>100</span><span class=o>;</span> <span class=n>i</span><span class=o>++)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>      <span class=n>colors</span><span class=o>.</span><span class=na>add</span><span class=o>(</span><span class=s>&#34;Yellow&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>      <span class=n>colors</span><span class=o>.</span><span class=na>add</span><span class=o>(</span><span class=s>&#34;Blue&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>      <span class=n>colors</span><span class=o>.</span><span class=na>add</span><span class=o>(</span><span class=s>&#34;Red&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>      <span class=n>colors</span><span class=o>.</span><span class=na>add</span><span class=o>(</span><span class=s>&#34;Red&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>      <span class=n>colors</span><span class=o>.</span><span class=na>add</span><span class=o>(</span><span class=s>&#34;Orange&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>      <span class=n>colors</span><span class=o>.</span><span class=na>add</span><span class=o>(</span><span class=s>&#34;Yellow&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>      <span class=n>colors</span><span class=o>.</span><span class=na>add</span><span class=o>(</span><span class=s>&#34;Blue&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>      <span class=n>colors</span><span class=o>.</span><span class=na>add</span><span class=o>(</span><span class=s>&#34;Purple&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>colors</span><span class=o>);</span>
</span></span><span class=line><span class=cl>  <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=cm>/* Output:
</span></span></span><span class=line><span class=cl><span class=cm>[Blue, Orange, Purple, Red, Yellow]
</span></span></span><span class=line><span class=cl><span class=cm>*/</span>
</span></span></code></pre></div><p>最常见的操作之一是使用 <code>contains()</code> 测试成员归属性，但也有一些其它操作，这可能会让你想起在小学学过的维恩图（译者注：利用图形的交合表示多个集合之间的逻辑关系）：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// collections/SetOperations.java
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>import</span> <span class=nn>java.util.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>SetOperations</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>  <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>Set</span><span class=o>&lt;</span><span class=n>String</span><span class=o>&gt;</span> <span class=n>set1</span> <span class=o>=</span> <span class=k>new</span> <span class=n>HashSet</span><span class=o>&lt;&gt;();</span>
</span></span><span class=line><span class=cl>    <span class=n>Collections</span><span class=o>.</span><span class=na>addAll</span><span class=o>(</span><span class=n>set1</span><span class=o>,</span>
</span></span><span class=line><span class=cl>      <span class=s>&#34;A B C D E F G H I J K L&#34;</span><span class=o>.</span><span class=na>split</span><span class=o>(</span><span class=s>&#34; &#34;</span><span class=o>));</span>
</span></span><span class=line><span class=cl>    <span class=n>set1</span><span class=o>.</span><span class=na>add</span><span class=o>(</span><span class=s>&#34;M&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;H: &#34;</span> <span class=o>+</span> <span class=n>set1</span><span class=o>.</span><span class=na>contains</span><span class=o>(</span><span class=s>&#34;H&#34;</span><span class=o>));</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;N: &#34;</span> <span class=o>+</span> <span class=n>set1</span><span class=o>.</span><span class=na>contains</span><span class=o>(</span><span class=s>&#34;N&#34;</span><span class=o>));</span>
</span></span><span class=line><span class=cl>    <span class=n>Set</span><span class=o>&lt;</span><span class=n>String</span><span class=o>&gt;</span> <span class=n>set2</span> <span class=o>=</span> <span class=k>new</span> <span class=n>HashSet</span><span class=o>&lt;&gt;();</span>
</span></span><span class=line><span class=cl>    <span class=n>Collections</span><span class=o>.</span><span class=na>addAll</span><span class=o>(</span><span class=n>set2</span><span class=o>,</span> <span class=s>&#34;H I J K L&#34;</span><span class=o>.</span><span class=na>split</span><span class=o>(</span><span class=s>&#34; &#34;</span><span class=o>));</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span>
</span></span><span class=line><span class=cl>      <span class=s>&#34;set2 in set1: &#34;</span> <span class=o>+</span> <span class=n>set1</span><span class=o>.</span><span class=na>containsAll</span><span class=o>(</span><span class=n>set2</span><span class=o>));</span>
</span></span><span class=line><span class=cl>    <span class=n>set1</span><span class=o>.</span><span class=na>remove</span><span class=o>(</span><span class=s>&#34;H&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;set1: &#34;</span> <span class=o>+</span> <span class=n>set1</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span>
</span></span><span class=line><span class=cl>      <span class=s>&#34;set2 in set1: &#34;</span> <span class=o>+</span> <span class=n>set1</span><span class=o>.</span><span class=na>containsAll</span><span class=o>(</span><span class=n>set2</span><span class=o>));</span>
</span></span><span class=line><span class=cl>    <span class=n>set1</span><span class=o>.</span><span class=na>removeAll</span><span class=o>(</span><span class=n>set2</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span>
</span></span><span class=line><span class=cl>      <span class=s>&#34;set2 removed from set1: &#34;</span> <span class=o>+</span> <span class=n>set1</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>Collections</span><span class=o>.</span><span class=na>addAll</span><span class=o>(</span><span class=n>set1</span><span class=o>,</span> <span class=s>&#34;X Y Z&#34;</span><span class=o>.</span><span class=na>split</span><span class=o>(</span><span class=s>&#34; &#34;</span><span class=o>));</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span>
</span></span><span class=line><span class=cl>      <span class=s>&#34;&#39;X Y Z&#39; added to set1: &#34;</span> <span class=o>+</span> <span class=n>set1</span><span class=o>);</span>
</span></span><span class=line><span class=cl>  <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=cm>/* Output:
</span></span></span><span class=line><span class=cl><span class=cm>H: true
</span></span></span><span class=line><span class=cl><span class=cm>N: false
</span></span></span><span class=line><span class=cl><span class=cm>set2 in set1: true
</span></span></span><span class=line><span class=cl><span class=cm>set1: [A, B, C, D, E, F, G, I, J, K, L, M]
</span></span></span><span class=line><span class=cl><span class=cm>set2 in set1: false
</span></span></span><span class=line><span class=cl><span class=cm>set2 removed from set1: [A, B, C, D, E, F, G, M]
</span></span></span><span class=line><span class=cl><span class=cm>&#39;X Y Z&#39; added to set1: [A, B, C, D, E, F, G, M, X, Y, Z]
</span></span></span><span class=line><span class=cl><span class=cm>*/</span>
</span></span></code></pre></div><p>这些方法名都是自解释的，JDK 文档中还有一些其它的方法。</p><p>能够产生每个元素都唯一的列表是相当有用的功能。例如，假设想要列出上面的 <strong>SetOperations.java</strong> 文件中的所有单词，通过使用本书后面介绍的 <code>java.nio.file.Files.readAllLines()</code> 方法，可以打开一个文件，并将其作为一个 <strong>List&lt;String></strong> 读取，每个 <strong>String</strong> 都是输入文件中的一行：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// collections/UniqueWords.java
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>import</span> <span class=nn>java.util.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>java.nio.file.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>UniqueWords</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>  <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span>
</span></span><span class=line><span class=cl>  <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=kd>throws</span> <span class=n>Exception</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>List</span><span class=o>&lt;</span><span class=n>String</span><span class=o>&gt;</span> <span class=n>lines</span> <span class=o>=</span> <span class=n>Files</span><span class=o>.</span><span class=na>readAllLines</span><span class=o>(</span>
</span></span><span class=line><span class=cl>      <span class=n>Paths</span><span class=o>.</span><span class=na>get</span><span class=o>(</span><span class=s>&#34;SetOperations.java&#34;</span><span class=o>));</span>
</span></span><span class=line><span class=cl>    <span class=n>Set</span><span class=o>&lt;</span><span class=n>String</span><span class=o>&gt;</span> <span class=n>words</span> <span class=o>=</span> <span class=k>new</span> <span class=n>TreeSet</span><span class=o>&lt;&gt;();</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span><span class=o>(</span><span class=n>String</span> <span class=n>line</span> <span class=o>:</span> <span class=n>lines</span><span class=o>)</span>
</span></span><span class=line><span class=cl>      <span class=k>for</span><span class=o>(</span><span class=n>String</span> <span class=n>word</span> <span class=o>:</span> <span class=n>line</span><span class=o>.</span><span class=na>split</span><span class=o>(</span><span class=s>&#34;\\W+&#34;</span><span class=o>))</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span><span class=o>(</span><span class=n>word</span><span class=o>.</span><span class=na>trim</span><span class=o>().</span><span class=na>length</span><span class=o>()</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=o>)</span>
</span></span><span class=line><span class=cl>          <span class=n>words</span><span class=o>.</span><span class=na>add</span><span class=o>(</span><span class=n>word</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>words</span><span class=o>);</span>
</span></span><span class=line><span class=cl>  <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=cm>/* Output:
</span></span></span><span class=line><span class=cl><span class=cm>[A, B, C, Collections, D, E, F, G, H, HashSet, I, J, K, L, M, N, Output, Set, SetOperations, String, System, X, Y, Z, add, addAll, added, args, class, collections, contains, containsAll, false, from, import, in, java, main, new, out, println, public, remove, removeAll, removed, set1, set2, split, static, to, true, util, void]
</span></span></span><span class=line><span class=cl><span class=cm>*/</span>
</span></span></code></pre></div><p>我们逐步浏览文件中的每一行，并使用 <code>String.split()</code> 将其分解为单词，这里使用正则表达式 <strong>\\ W +</strong> ，这意味着它会依据一个或多个（即 <strong>+</strong> ）非单词字母来拆分字符串（正则表达式将在<a href>字符串</a>章节介绍）。每个结果单词都会添加到 <strong>Set words</strong> 中。因为它是 <strong>TreeSet</strong> ，所以对结果进行排序。这里，排序是按<em>字典顺序</em>（lexicographically）完成的，因此大写字母和小写字母是分开的。如果想按<em>字母顺序</em>（alphabetically）对其进行排序，可以向 <strong>TreeSet</strong> 构造器传入 <strong>String.CASE_INSENSITIVE_ORDER</strong> 比较器（比较器是一个建立排序顺序的对象）：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// collections/UniqueWordsAlphabetic.java
</span></span></span><span class=line><span class=cl><span class=c1>// Producing an alphabetic listing
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>import</span> <span class=nn>java.util.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>java.nio.file.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>UniqueWordsAlphabetic</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>  <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span>
</span></span><span class=line><span class=cl>  <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=kd>throws</span> <span class=n>Exception</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>List</span><span class=o>&lt;</span><span class=n>String</span><span class=o>&gt;</span> <span class=n>lines</span> <span class=o>=</span> <span class=n>Files</span><span class=o>.</span><span class=na>readAllLines</span><span class=o>(</span>
</span></span><span class=line><span class=cl>      <span class=n>Paths</span><span class=o>.</span><span class=na>get</span><span class=o>(</span><span class=s>&#34;SetOperations.java&#34;</span><span class=o>));</span>
</span></span><span class=line><span class=cl>    <span class=n>Set</span><span class=o>&lt;</span><span class=n>String</span><span class=o>&gt;</span> <span class=n>words</span> <span class=o>=</span>
</span></span><span class=line><span class=cl>      <span class=k>new</span> <span class=n>TreeSet</span><span class=o>&lt;&gt;(</span><span class=n>String</span><span class=o>.</span><span class=na>CASE_INSENSITIVE_ORDER</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span><span class=o>(</span><span class=n>String</span> <span class=n>line</span> <span class=o>:</span> <span class=n>lines</span><span class=o>)</span>
</span></span><span class=line><span class=cl>      <span class=k>for</span><span class=o>(</span><span class=n>String</span> <span class=n>word</span> <span class=o>:</span> <span class=n>line</span><span class=o>.</span><span class=na>split</span><span class=o>(</span><span class=s>&#34;\\W+&#34;</span><span class=o>))</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span><span class=o>(</span><span class=n>word</span><span class=o>.</span><span class=na>trim</span><span class=o>().</span><span class=na>length</span><span class=o>()</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=o>)</span>
</span></span><span class=line><span class=cl>          <span class=n>words</span><span class=o>.</span><span class=na>add</span><span class=o>(</span><span class=n>word</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>words</span><span class=o>);</span>
</span></span><span class=line><span class=cl>  <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=cm>/* Output:
</span></span></span><span class=line><span class=cl><span class=cm>[A, add, addAll, added, args, B, C, class, collections, contains, containsAll, D, E, F, false, from, G, H, HashSet, I, import, in, J, java, K, L, M, main, N, new, out, Output, println, public, remove, removeAll, removed, Set, set1, set2, SetOperations, split, static, String, System, to, true, util, void, X, Y, Z]
</span></span></span><span class=line><span class=cl><span class=cm>*/</span>
</span></span></code></pre></div><p><strong>Comparator</strong> 比较器将在<a href>数组</a>章节详细介绍。</p><h2 id=映射-map>映射 Map</h2><p>将对象映射到其他对象的能力是解决编程问题的有效方法。例如，考虑一个程序，它被用来检查 Java 的 <strong>Random</strong> 类的随机性。理想情况下， <strong>Random</strong> 会产生完美的数字分布，但为了测试这一点，则需要生成大量的随机数，并计算落在各种范围内的数字个数。 <strong>Map</strong> 可以很容易地解决这个问题。在本例中，键是 <strong>Random</strong> 生成的数字，而值是该数字出现的次数：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// collections/Statistics.java
</span></span></span><span class=line><span class=cl><span class=c1>// (c)2017 MindView LLC: see Copyright.txt
</span></span></span><span class=line><span class=cl><span class=c1>// We make no guarantees that this code is fit for any purpose.
</span></span></span><span class=line><span class=cl><span class=c1>// Visit http://OnJava8.com for more book information.
</span></span></span><span class=line><span class=cl><span class=c1>// Simple demonstration of HashMap
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>import</span> <span class=nn>java.util.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>Statistics</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>  <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>Random</span> <span class=n>rand</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Random</span><span class=o>(</span><span class=mi>47</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>Map</span><span class=o>&lt;</span><span class=n>Integer</span><span class=o>,</span> <span class=n>Integer</span><span class=o>&gt;</span> <span class=n>m</span> <span class=o>=</span> <span class=k>new</span> <span class=n>HashMap</span><span class=o>&lt;&gt;();</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span><span class=o>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=o>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=mi>10000</span><span class=o>;</span> <span class=n>i</span><span class=o>++)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>      <span class=c1>// Produce a number between 0 and 20:
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=kt>int</span> <span class=n>r</span> <span class=o>=</span> <span class=n>rand</span><span class=o>.</span><span class=na>nextInt</span><span class=o>(</span><span class=mi>20</span><span class=o>);</span>
</span></span><span class=line><span class=cl>      <span class=n>Integer</span> <span class=n>freq</span> <span class=o>=</span> <span class=n>m</span><span class=o>.</span><span class=na>get</span><span class=o>(</span><span class=n>r</span><span class=o>);</span> <span class=c1>// [1]
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=n>m</span><span class=o>.</span><span class=na>put</span><span class=o>(</span><span class=n>r</span><span class=o>,</span> <span class=n>freq</span> <span class=o>==</span> <span class=kc>null</span> <span class=o>?</span> <span class=mi>1</span> <span class=o>:</span> <span class=n>freq</span> <span class=o>+</span> <span class=mi>1</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>m</span><span class=o>);</span>
</span></span><span class=line><span class=cl>  <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=cm>/* Output:
</span></span></span><span class=line><span class=cl><span class=cm>{0=481, 1=502, 2=489, 3=508, 4=481, 5=503, 6=519, 7=471, 8=468, 9=549, 10=513, 11=531, 12=521, 13=506, 14=477, 15=497, 16=533, 17=509, 18=478, 19=464}
</span></span></span><span class=line><span class=cl><span class=cm>*/</span>
</span></span></code></pre></div><ul><li><strong>[1]</strong> 自动包装机制将随机生成的 <strong>int</strong> 转换为可以与 <strong>HashMap</strong> 一起使用的 <strong>Integer</strong> 引用（不能使用基本类型的集合）。如果键不在集合中，则 <code>get()</code> 返回 <strong>null</strong> （这意味着该数字第一次出现）。否则， <code>get()</code> 会为键生成与之关联的 <strong>Integer</strong> 值，然后该值被递增（自动包装机制再次简化了表达式，但实际上确实发生了对 <strong>Integer</strong> 的装箱和拆箱）。</li></ul><p>接下来的示例将使用一个 <strong>String</strong> 描述来查找 <strong>Pet</strong> 对象。它还展示了通过使用 <code>containsKey()</code> 和 <code>containsValue()</code> 方法去测试一个 <strong>Map</strong> ，以查看它是否包含某个键或某个值：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// collections/PetMap.java
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>import</span> <span class=nn>typeinfo.pets.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>java.util.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>PetMap</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>  <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>Map</span><span class=o>&lt;</span><span class=n>String</span><span class=o>,</span> <span class=n>Pet</span><span class=o>&gt;</span> <span class=n>petMap</span> <span class=o>=</span> <span class=k>new</span> <span class=n>HashMap</span><span class=o>&lt;&gt;();</span>
</span></span><span class=line><span class=cl>    <span class=n>petMap</span><span class=o>.</span><span class=na>put</span><span class=o>(</span><span class=s>&#34;My Cat&#34;</span><span class=o>,</span> <span class=k>new</span> <span class=n>Cat</span><span class=o>(</span><span class=s>&#34;Molly&#34;</span><span class=o>));</span>
</span></span><span class=line><span class=cl>    <span class=n>petMap</span><span class=o>.</span><span class=na>put</span><span class=o>(</span><span class=s>&#34;My Dog&#34;</span><span class=o>,</span> <span class=k>new</span> <span class=n>Dog</span><span class=o>(</span><span class=s>&#34;Ginger&#34;</span><span class=o>));</span>
</span></span><span class=line><span class=cl>    <span class=n>petMap</span><span class=o>.</span><span class=na>put</span><span class=o>(</span><span class=s>&#34;My Hamster&#34;</span><span class=o>,</span> <span class=k>new</span> <span class=n>Hamster</span><span class=o>(</span><span class=s>&#34;Bosco&#34;</span><span class=o>));</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>petMap</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>Pet</span> <span class=n>dog</span> <span class=o>=</span> <span class=n>petMap</span><span class=o>.</span><span class=na>get</span><span class=o>(</span><span class=s>&#34;My Dog&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>dog</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>petMap</span><span class=o>.</span><span class=na>containsKey</span><span class=o>(</span><span class=s>&#34;My Dog&#34;</span><span class=o>));</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>petMap</span><span class=o>.</span><span class=na>containsValue</span><span class=o>(</span><span class=n>dog</span><span class=o>));</span>
</span></span><span class=line><span class=cl>  <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=cm>/* Output:
</span></span></span><span class=line><span class=cl><span class=cm>{My Dog=Dog Ginger, My Cat=Cat Molly, My
</span></span></span><span class=line><span class=cl><span class=cm>Hamster=Hamster Bosco}
</span></span></span><span class=line><span class=cl><span class=cm>Dog Ginger
</span></span></span><span class=line><span class=cl><span class=cm>true
</span></span></span><span class=line><span class=cl><span class=cm>true
</span></span></span><span class=line><span class=cl><span class=cm>*/</span>
</span></span></code></pre></div><p><strong>Map</strong> 与数组和其他的 <strong>Collection</strong> 一样，可以轻松地扩展到多个维度：只需要创建一个 <strong>Map</strong> ，其值也是 <strong>Map</strong> (这些 <strong>Map</strong> 的值可以是其他集合，甚至是其他的 <strong>Map</strong> )。因此，能够很容易地将集合组合起来以快速生成强大的数据结构。例如，假设你正在追踪有多个宠物的人，只需要一个 <strong>Map&lt;Person, List&lt;Pet&#187;</strong> 即可：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// collections/MapOfList.java
</span></span></span><span class=line><span class=cl><span class=c1>// {java collections.MapOfList}
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>package</span> <span class=nn>collections</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>typeinfo.pets.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>java.util.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>MapOfList</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>  <span class=kd>public</span> <span class=kd>static</span> <span class=kd>final</span> <span class=n>Map</span><span class=o>&lt;</span><span class=n>Person</span><span class=o>,</span> <span class=n>List</span><span class=o>&lt;</span> <span class=o>?</span> <span class=kd>extends</span> <span class=n>Pet</span><span class=o>&gt;&gt;</span>
</span></span><span class=line><span class=cl>    <span class=n>petPeople</span> <span class=o>=</span> <span class=k>new</span> <span class=n>HashMap</span><span class=o>&lt;&gt;();</span>
</span></span><span class=line><span class=cl>  <span class=kd>static</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>petPeople</span><span class=o>.</span><span class=na>put</span><span class=o>(</span><span class=k>new</span> <span class=n>Person</span><span class=o>(</span><span class=s>&#34;Dawn&#34;</span><span class=o>),</span>
</span></span><span class=line><span class=cl>      <span class=n>Arrays</span><span class=o>.</span><span class=na>asList</span><span class=o>(</span>
</span></span><span class=line><span class=cl>        <span class=k>new</span> <span class=n>Cymric</span><span class=o>(</span><span class=s>&#34;Molly&#34;</span><span class=o>),</span>
</span></span><span class=line><span class=cl>        <span class=k>new</span> <span class=n>Mutt</span><span class=o>(</span><span class=s>&#34;Spot&#34;</span><span class=o>)));</span>
</span></span><span class=line><span class=cl>    <span class=n>petPeople</span><span class=o>.</span><span class=na>put</span><span class=o>(</span><span class=k>new</span> <span class=n>Person</span><span class=o>(</span><span class=s>&#34;Kate&#34;</span><span class=o>),</span>
</span></span><span class=line><span class=cl>      <span class=n>Arrays</span><span class=o>.</span><span class=na>asList</span><span class=o>(</span><span class=k>new</span> <span class=n>Cat</span><span class=o>(</span><span class=s>&#34;Shackleton&#34;</span><span class=o>),</span>
</span></span><span class=line><span class=cl>        <span class=k>new</span> <span class=n>Cat</span><span class=o>(</span><span class=s>&#34;Elsie May&#34;</span><span class=o>),</span> <span class=k>new</span> <span class=n>Dog</span><span class=o>(</span><span class=s>&#34;Margrett&#34;</span><span class=o>)));</span>
</span></span><span class=line><span class=cl>    <span class=n>petPeople</span><span class=o>.</span><span class=na>put</span><span class=o>(</span><span class=k>new</span> <span class=n>Person</span><span class=o>(</span><span class=s>&#34;Marilyn&#34;</span><span class=o>),</span>
</span></span><span class=line><span class=cl>      <span class=n>Arrays</span><span class=o>.</span><span class=na>asList</span><span class=o>(</span>
</span></span><span class=line><span class=cl>        <span class=k>new</span> <span class=n>Pug</span><span class=o>(</span><span class=s>&#34;Louie aka Louis Snorkelstein Dupree&#34;</span><span class=o>),</span>
</span></span><span class=line><span class=cl>        <span class=k>new</span> <span class=n>Cat</span><span class=o>(</span><span class=s>&#34;Stanford&#34;</span><span class=o>),</span>
</span></span><span class=line><span class=cl>        <span class=k>new</span> <span class=n>Cat</span><span class=o>(</span><span class=s>&#34;Pinkola&#34;</span><span class=o>)));</span>
</span></span><span class=line><span class=cl>    <span class=n>petPeople</span><span class=o>.</span><span class=na>put</span><span class=o>(</span><span class=k>new</span> <span class=n>Person</span><span class=o>(</span><span class=s>&#34;Luke&#34;</span><span class=o>),</span>
</span></span><span class=line><span class=cl>      <span class=n>Arrays</span><span class=o>.</span><span class=na>asList</span><span class=o>(</span>
</span></span><span class=line><span class=cl>        <span class=k>new</span> <span class=n>Rat</span><span class=o>(</span><span class=s>&#34;Fuzzy&#34;</span><span class=o>),</span> <span class=k>new</span> <span class=n>Rat</span><span class=o>(</span><span class=s>&#34;Fizzy&#34;</span><span class=o>)));</span>
</span></span><span class=line><span class=cl>    <span class=n>petPeople</span><span class=o>.</span><span class=na>put</span><span class=o>(</span><span class=k>new</span> <span class=n>Person</span><span class=o>(</span><span class=s>&#34;Isaac&#34;</span><span class=o>),</span>
</span></span><span class=line><span class=cl>      <span class=n>Arrays</span><span class=o>.</span><span class=na>asList</span><span class=o>(</span><span class=k>new</span> <span class=n>Rat</span><span class=o>(</span><span class=s>&#34;Freckly&#34;</span><span class=o>)));</span>
</span></span><span class=line><span class=cl>  <span class=o>}</span>
</span></span><span class=line><span class=cl>  <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;People: &#34;</span> <span class=o>+</span> <span class=n>petPeople</span><span class=o>.</span><span class=na>keySet</span><span class=o>());</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;Pets: &#34;</span> <span class=o>+</span> <span class=n>petPeople</span><span class=o>.</span><span class=na>values</span><span class=o>());</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span><span class=o>(</span><span class=n>Person</span> <span class=n>person</span> <span class=o>:</span> <span class=n>petPeople</span><span class=o>.</span><span class=na>keySet</span><span class=o>())</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>      <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>person</span> <span class=o>+</span> <span class=s>&#34; has:&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>      <span class=k>for</span><span class=o>(</span><span class=n>Pet</span> <span class=n>pet</span> <span class=o>:</span> <span class=n>petPeople</span><span class=o>.</span><span class=na>get</span><span class=o>(</span><span class=n>person</span><span class=o>))</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;    &#34;</span> <span class=o>+</span> <span class=n>pet</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>  <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=cm>/* Output:
</span></span></span><span class=line><span class=cl><span class=cm>People: [Person Dawn, Person Kate, Person Isaac, Person
</span></span></span><span class=line><span class=cl><span class=cm>Marilyn, Person Luke]
</span></span></span><span class=line><span class=cl><span class=cm>Pets: [[Cymric Molly, Mutt Spot], [Cat Shackleton, Cat
</span></span></span><span class=line><span class=cl><span class=cm>Elsie May, Dog Margrett], [Rat Freckly], [Pug Louie aka
</span></span></span><span class=line><span class=cl><span class=cm>Louis Snorkelstein Dupree, Cat Stanford, Cat Pinkola],
</span></span></span><span class=line><span class=cl><span class=cm>[Rat Fuzzy, Rat Fizzy]]
</span></span></span><span class=line><span class=cl><span class=cm>Person Dawn has:
</span></span></span><span class=line><span class=cl><span class=cm>    Cymric Molly
</span></span></span><span class=line><span class=cl><span class=cm>    Mutt Spot
</span></span></span><span class=line><span class=cl><span class=cm>Person Kate has:
</span></span></span><span class=line><span class=cl><span class=cm>    Cat Shackleton
</span></span></span><span class=line><span class=cl><span class=cm>    Cat Elsie May
</span></span></span><span class=line><span class=cl><span class=cm>    Dog Margrett
</span></span></span><span class=line><span class=cl><span class=cm>Person Isaac has:
</span></span></span><span class=line><span class=cl><span class=cm>    Rat Freckly
</span></span></span><span class=line><span class=cl><span class=cm>Person Marilyn has:
</span></span></span><span class=line><span class=cl><span class=cm>    Pug Louie aka Louis Snorkelstein Dupree
</span></span></span><span class=line><span class=cl><span class=cm>    Cat Stanford
</span></span></span><span class=line><span class=cl><span class=cm>    Cat Pinkola
</span></span></span><span class=line><span class=cl><span class=cm>Person Luke has:
</span></span></span><span class=line><span class=cl><span class=cm>    Rat Fuzzy
</span></span></span><span class=line><span class=cl><span class=cm>    Rat Fizzy
</span></span></span><span class=line><span class=cl><span class=cm>*/</span>
</span></span></code></pre></div><p><strong>Map</strong> 可以返回由其键组成的 <strong>Set</strong> ，由其值组成的 <strong>Collection</strong> ，或者其键值对的 <strong>Set</strong> 。 <code>keySet()</code> 方法生成由在 <strong>petPeople</strong> 中的所有键组成的 <strong>Set</strong> ，它在 <em>for-in</em> 语句中被用来遍历该 <strong>Map</strong> 。</p><h2 id=队列-queue>队列 Queue</h2><p>队列是一个典型的“先进先出”（FIFO）集合。 即从集合的一端放入事物，再从另一端去获取它们，事物放入集合的顺序和被取出的顺序是相同的。队列通常被当做一种可靠的将对象从程序的某个区域传输到另一个区域的途径。队列在<a href>并发编程</a>中尤为重要，因为它们可以安全地将对象从一个任务传输到另一个任务。</p><p><strong>LinkedList</strong> 实现了 <strong>Queue</strong> 接口，并且提供了一些方法以支持队列行为，因此 <strong>LinkedList</strong> 可以用作 <strong>Queue</strong> 的一种实现。 通过将 <strong>LinkedList</strong> 向上转换为 <strong>Queue</strong> ，下面的示例使用了在 <strong>Queue</strong> 接口中的 <strong>Queue</strong> 特有(Queue-specific)方法：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// collections/QueueDemo.java
</span></span></span><span class=line><span class=cl><span class=c1>// Upcasting to a Queue from a LinkedList
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>import</span> <span class=nn>java.util.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>QueueDemo</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>  <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>printQ</span><span class=o>(</span><span class=n>Queue</span> <span class=n>queue</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span><span class=o>(</span><span class=n>queue</span><span class=o>.</span><span class=na>peek</span><span class=o>()</span> <span class=o>!=</span> <span class=kc>null</span><span class=o>)</span>
</span></span><span class=line><span class=cl>      <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>print</span><span class=o>(</span><span class=n>queue</span><span class=o>.</span><span class=na>remove</span><span class=o>()</span> <span class=o>+</span> <span class=s>&#34; &#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>();</span>
</span></span><span class=line><span class=cl>  <span class=o>}</span>
</span></span><span class=line><span class=cl>  <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>Queue</span><span class=o>&lt;</span><span class=n>Integer</span><span class=o>&gt;</span> <span class=n>queue</span> <span class=o>=</span> <span class=k>new</span> <span class=n>LinkedList</span><span class=o>&lt;&gt;();</span>
</span></span><span class=line><span class=cl>    <span class=n>Random</span> <span class=n>rand</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Random</span><span class=o>(</span><span class=mi>47</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span><span class=o>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=o>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=mi>10</span><span class=o>;</span> <span class=n>i</span><span class=o>++)</span>
</span></span><span class=line><span class=cl>      <span class=n>queue</span><span class=o>.</span><span class=na>offer</span><span class=o>(</span><span class=n>rand</span><span class=o>.</span><span class=na>nextInt</span><span class=o>(</span><span class=n>i</span> <span class=o>+</span> <span class=mi>10</span><span class=o>));</span>
</span></span><span class=line><span class=cl>    <span class=n>printQ</span><span class=o>(</span><span class=n>queue</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>Queue</span><span class=o>&lt;</span><span class=n>Character</span><span class=o>&gt;</span> <span class=n>qc</span> <span class=o>=</span> <span class=k>new</span> <span class=n>LinkedList</span><span class=o>&lt;&gt;();</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span><span class=o>(</span><span class=kt>char</span> <span class=n>c</span> <span class=o>:</span> <span class=s>&#34;Brontosaurus&#34;</span><span class=o>.</span><span class=na>toCharArray</span><span class=o>())</span>
</span></span><span class=line><span class=cl>      <span class=n>qc</span><span class=o>.</span><span class=na>offer</span><span class=o>(</span><span class=n>c</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>printQ</span><span class=o>(</span><span class=n>qc</span><span class=o>);</span>
</span></span><span class=line><span class=cl>  <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=cm>/* Output:
</span></span></span><span class=line><span class=cl><span class=cm>8 1 1 1 5 14 3 1 0 1
</span></span></span><span class=line><span class=cl><span class=cm>B r o n t o s a u r u s
</span></span></span><span class=line><span class=cl><span class=cm>*/</span>
</span></span></code></pre></div><p><code>offer()</code> 是 <strong>Queue</strong> 的特有方法之一，它在允许的情况下，在队列的尾部插入一个元素，或者返回 <strong>false</strong> 。 <code>peek()</code> 和 <code>element()</code> 都返回队头元素而不删除它，但如果队列为空，则 <code>peek()</code> 返回 <strong>null</strong> ， 而 <code>element()</code> 抛出 <strong>NoSuchElementException</strong> 。 <code>poll()</code> 和 <code>remove()</code> 都删除并返回队头元素，但如果队列为空，则 <code>poll()</code> 返回 <strong>null</strong> ，而 <code>remove()</code> 抛出 <strong>NoSuchElementException</strong> 。</p><p>自动包装机制会自动将 <code>nextInt()</code> 的 <strong>int</strong> 结果转换为 <strong>queue</strong> 所需的 <strong>Integer</strong> 对象，并将 <strong>char c</strong> 转换为 <strong>qc</strong> 所需的 <strong>Character</strong> 对象。 <strong>Queue</strong> 接口窄化了对 <strong>LinkedList</strong> 方法的访问权限，因此只有适当的方法才能使用，因此能够访问到的 <strong>LinkedList</strong> 的方法会变少（这里实际上可以将 <strong>Queue</strong> 强制转换回 <strong>LinkedList</strong> ，但至少我们不鼓励这样做）。</p><p><strong>Queue</strong> 的特有方法提供了独立而完整的功能。 换句话说， <strong>Queue</strong> 无需调用继承自 <strong>Collection</strong> 的方法，（只依靠 <strong>Queue</strong> 的特有方法）就有队列的功能。</p><h3 id=优先级队列-priorityqueue>优先级队列 PriorityQueue</h3><p>先进先出（FIFO）描述了最典型的<em>队列规则</em>（queuing discipline）。队列规则是指在给定队列中的一组元素的情况下，确定下一个弹出队列的元素的规则。先进先出：下一个弹出的元素应该是等待时间最长的那一个。</p><p><em>优先级队列</em> ：下一个弹出的元素是最需要的元素（具有最高的优先级）。例如，在机场，飞机即将起飞的、尚未登机的乘客可能会被拉出队伍（作最优先的处理）。如果构建了一个消息传递系统，某些消息比其他消息更重要，应该尽快处理，而不管它们到达时间先后。在 Java 5 中添加了 <strong>PriorityQueue</strong> ，以便自动实现这种行为。</p><p>当在 <strong>PriorityQueue</strong> 上调用 <code>offer()</code> 方法来插入一个对象时，该对象会在队列中被排序。<sup id=fnref:5><a href=#fn:5 class=footnote-ref role=doc-noteref>5</a></sup>默认的排序使用队列中对象的<em>自然顺序</em>（natural order），但是可以通过提供自己的 <strong>Comparator</strong> 来修改这个顺序。 <strong>PriorityQueue</strong> 确保在调用 <code>peek()</code> ， <code>poll()</code> 或 <code>remove()</code> 方法时，获得的元素将是队列中优先级最高的元素。</p><p>让 <strong>PriorityQueue</strong> 与 <strong>Integer</strong> ， <strong>String</strong> 和 <strong>Character</strong> 这样的内置类型一起工作易如反掌。在下面的示例中，第一组值与前一个示例中的随机值相同，可以看到它们从 <strong>PriorityQueue</strong> 中弹出的顺序与前一个示例不同：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// collections/PriorityQueueDemo.java
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>import</span> <span class=nn>java.util.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>PriorityQueueDemo</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>  <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>PriorityQueue</span><span class=o>&lt;</span><span class=n>Integer</span><span class=o>&gt;</span> <span class=n>priorityQueue</span> <span class=o>=</span>
</span></span><span class=line><span class=cl>      <span class=k>new</span> <span class=n>PriorityQueue</span><span class=o>&lt;&gt;();</span>
</span></span><span class=line><span class=cl>    <span class=n>Random</span> <span class=n>rand</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Random</span><span class=o>(</span><span class=mi>47</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span><span class=o>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=o>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=mi>10</span><span class=o>;</span> <span class=n>i</span><span class=o>++)</span>
</span></span><span class=line><span class=cl>      <span class=n>priorityQueue</span><span class=o>.</span><span class=na>offer</span><span class=o>(</span><span class=n>rand</span><span class=o>.</span><span class=na>nextInt</span><span class=o>(</span><span class=n>i</span> <span class=o>+</span> <span class=mi>10</span><span class=o>));</span>
</span></span><span class=line><span class=cl>    <span class=n>QueueDemo</span><span class=o>.</span><span class=na>printQ</span><span class=o>(</span><span class=n>priorityQueue</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>List</span><span class=o>&lt;</span><span class=n>Integer</span><span class=o>&gt;</span> <span class=n>ints</span> <span class=o>=</span> <span class=n>Arrays</span><span class=o>.</span><span class=na>asList</span><span class=o>(</span><span class=mi>25</span><span class=o>,</span> <span class=mi>22</span><span class=o>,</span> <span class=mi>20</span><span class=o>,</span>
</span></span><span class=line><span class=cl>      <span class=mi>18</span><span class=o>,</span> <span class=mi>14</span><span class=o>,</span> <span class=mi>9</span><span class=o>,</span> <span class=mi>3</span><span class=o>,</span> <span class=mi>1</span><span class=o>,</span> <span class=mi>1</span><span class=o>,</span> <span class=mi>2</span><span class=o>,</span> <span class=mi>3</span><span class=o>,</span> <span class=mi>9</span><span class=o>,</span> <span class=mi>14</span><span class=o>,</span> <span class=mi>18</span><span class=o>,</span> <span class=mi>21</span><span class=o>,</span> <span class=mi>23</span><span class=o>,</span> <span class=mi>25</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>priorityQueue</span> <span class=o>=</span> <span class=k>new</span> <span class=n>PriorityQueue</span><span class=o>&lt;&gt;(</span><span class=n>ints</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>QueueDemo</span><span class=o>.</span><span class=na>printQ</span><span class=o>(</span><span class=n>priorityQueue</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>priorityQueue</span> <span class=o>=</span> <span class=k>new</span> <span class=n>PriorityQueue</span><span class=o>&lt;&gt;(</span>
</span></span><span class=line><span class=cl>        <span class=n>ints</span><span class=o>.</span><span class=na>size</span><span class=o>(),</span> <span class=n>Collections</span><span class=o>.</span><span class=na>reverseOrder</span><span class=o>());</span>
</span></span><span class=line><span class=cl>    <span class=n>priorityQueue</span><span class=o>.</span><span class=na>addAll</span><span class=o>(</span><span class=n>ints</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>QueueDemo</span><span class=o>.</span><span class=na>printQ</span><span class=o>(</span><span class=n>priorityQueue</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>String</span> <span class=n>fact</span> <span class=o>=</span> <span class=s>&#34;EDUCATION SHOULD ESCHEW OBFUSCATION&#34;</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=n>List</span><span class=o>&lt;</span><span class=n>String</span><span class=o>&gt;</span> <span class=n>strings</span> <span class=o>=</span>
</span></span><span class=line><span class=cl>      <span class=n>Arrays</span><span class=o>.</span><span class=na>asList</span><span class=o>(</span><span class=n>fact</span><span class=o>.</span><span class=na>split</span><span class=o>(</span><span class=s>&#34;&#34;</span><span class=o>));</span>
</span></span><span class=line><span class=cl>    <span class=n>PriorityQueue</span><span class=o>&lt;</span><span class=n>String</span><span class=o>&gt;</span> <span class=n>stringPQ</span> <span class=o>=</span>
</span></span><span class=line><span class=cl>      <span class=k>new</span> <span class=n>PriorityQueue</span><span class=o>&lt;&gt;(</span><span class=n>strings</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>QueueDemo</span><span class=o>.</span><span class=na>printQ</span><span class=o>(</span><span class=n>stringPQ</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>stringPQ</span> <span class=o>=</span> <span class=k>new</span> <span class=n>PriorityQueue</span><span class=o>&lt;&gt;(</span>
</span></span><span class=line><span class=cl>      <span class=n>strings</span><span class=o>.</span><span class=na>size</span><span class=o>(),</span> <span class=n>Collections</span><span class=o>.</span><span class=na>reverseOrder</span><span class=o>());</span>
</span></span><span class=line><span class=cl>    <span class=n>stringPQ</span><span class=o>.</span><span class=na>addAll</span><span class=o>(</span><span class=n>strings</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>QueueDemo</span><span class=o>.</span><span class=na>printQ</span><span class=o>(</span><span class=n>stringPQ</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>Set</span><span class=o>&lt;</span><span class=n>Character</span><span class=o>&gt;</span> <span class=n>charSet</span> <span class=o>=</span> <span class=k>new</span> <span class=n>HashSet</span><span class=o>&lt;&gt;();</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span><span class=o>(</span><span class=kt>char</span> <span class=n>c</span> <span class=o>:</span> <span class=n>fact</span><span class=o>.</span><span class=na>toCharArray</span><span class=o>())</span>
</span></span><span class=line><span class=cl>      <span class=n>charSet</span><span class=o>.</span><span class=na>add</span><span class=o>(</span><span class=n>c</span><span class=o>);</span> <span class=c1>// Autoboxing
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>PriorityQueue</span><span class=o>&lt;</span><span class=n>Character</span><span class=o>&gt;</span> <span class=n>characterPQ</span> <span class=o>=</span>
</span></span><span class=line><span class=cl>      <span class=k>new</span> <span class=n>PriorityQueue</span><span class=o>&lt;&gt;(</span><span class=n>charSet</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>QueueDemo</span><span class=o>.</span><span class=na>printQ</span><span class=o>(</span><span class=n>characterPQ</span><span class=o>);</span>
</span></span><span class=line><span class=cl>  <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=cm>/* Output:
</span></span></span><span class=line><span class=cl><span class=cm>0 1 1 1 1 1 3 5 8 14
</span></span></span><span class=line><span class=cl><span class=cm>1 1 2 3 3 9 9 14 14 18 18 20 21 22 23 25 25
</span></span></span><span class=line><span class=cl><span class=cm>25 25 23 22 21 20 18 18 14 14 9 9 3 3 2 1 1
</span></span></span><span class=line><span class=cl><span class=cm>      A A B C C C D D E E E F H H I I L N N O O O O S S
</span></span></span><span class=line><span class=cl><span class=cm>S T T U U U W
</span></span></span><span class=line><span class=cl><span class=cm>W U U U T T S S S O O O O N N L I I H H F E E E D D C C
</span></span></span><span class=line><span class=cl><span class=cm>C B A A
</span></span></span><span class=line><span class=cl><span class=cm>  A B C D E F H I L N O S T U W
</span></span></span><span class=line><span class=cl><span class=cm>*/</span>
</span></span></code></pre></div><p><strong>PriorityQueue</strong> 是允许重复的，最小的值具有最高的优先级（如果是 <strong>String</strong> ，空格也可以算作值，并且比字母的优先级高）。为了展示如何通过提供自己的 <strong>Comparator</strong> 对象来改变顺序，第三个对 <strong>PriorityQueue&lt;Integer></strong> 构造器的调用，和第二个对 <strong>PriorityQueue&lt;String></strong> 的调用使用了由 <code>Collections.reverseOrder()</code> （Java 5 中新添加的）产生的反序的 <strong>Comparator</strong> 。</p><p>最后一部分添加了一个 <strong>HashSet</strong> 来消除重复的 <strong>Character</strong>。</p><p><strong>Integer</strong> ， <strong>String</strong> 和 <strong>Character</strong> 可以与 <strong>PriorityQueue</strong> 一起使用，因为这些类已经内置了自然排序。如果想在 <strong>PriorityQueue</strong> 中使用自己的类，则必须包含额外的功能以产生自然排序，或者必须提供自己的 <strong>Comparator</strong> 。在<a href>附录：集合主题</a>中有一个更复杂的示例来演示这种情况。</p><h2 id=集合与迭代器>集合与迭代器</h2><p><strong>Collection</strong> 是所有序列集合共有的根接口。它可能会被认为是一种“附属接口”（incidental interface），即因为要表示其他若干个接口的共性而出现的接口。此外，<strong>java.util.AbstractCollection</strong> 类提供了 <strong>Collection</strong> 的默认实现，你可以创建 <strong>AbstractCollection</strong> 的子类型来避免不必要的代码重复。</p><p>使用接口的一个理由是它可以使我们创建更通用的代码。通过针对接口而非具体实现来编写代码，我们的代码可以应用于更多类型的对象。<sup id=fnref:6><a href=#fn:6 class=footnote-ref role=doc-noteref>6</a></sup>因此，如果所编写的方法接受一个 <strong>Collection</strong> ，那么该方法可以应用于任何实现了 <strong>Collection</strong> 的类——这也就使得一个新类可以选择去实现 <strong>Collection</strong> 接口，以便该方法可以使用它。标准 C++ 类库中的集合并没有共同的基类——集合之间的所有共性都是通过迭代器实现的。在 Java 中，遵循 C++ 的方式看起来似乎很明智，即用迭代器而不是 <strong>Collection</strong> 来表示集合之间的共性。但是，这两种方法绑定在了一起，因为实现 <strong>Collection</strong> 就意味着需要提供 <code>iterator()</code> 方法：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// collections/InterfaceVsIterator.java
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>import</span> <span class=nn>typeinfo.pets.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>java.util.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>InterfaceVsIterator</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>  <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>display</span><span class=o>(</span><span class=n>Iterator</span><span class=o>&lt;</span><span class=n>Pet</span><span class=o>&gt;</span> <span class=n>it</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span><span class=o>(</span><span class=n>it</span><span class=o>.</span><span class=na>hasNext</span><span class=o>())</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>      <span class=n>Pet</span> <span class=n>p</span> <span class=o>=</span> <span class=n>it</span><span class=o>.</span><span class=na>next</span><span class=o>();</span>
</span></span><span class=line><span class=cl>      <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>print</span><span class=o>(</span><span class=n>p</span><span class=o>.</span><span class=na>id</span><span class=o>()</span> <span class=o>+</span> <span class=s>&#34;:&#34;</span> <span class=o>+</span> <span class=n>p</span> <span class=o>+</span> <span class=s>&#34; &#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>();</span>
</span></span><span class=line><span class=cl>  <span class=o>}</span>
</span></span><span class=line><span class=cl>  <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>display</span><span class=o>(</span><span class=n>Collection</span><span class=o>&lt;</span><span class=n>Pet</span><span class=o>&gt;</span> <span class=n>pets</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span><span class=o>(</span><span class=n>Pet</span> <span class=n>p</span> <span class=o>:</span> <span class=n>pets</span><span class=o>)</span>
</span></span><span class=line><span class=cl>      <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>print</span><span class=o>(</span><span class=n>p</span><span class=o>.</span><span class=na>id</span><span class=o>()</span> <span class=o>+</span> <span class=s>&#34;:&#34;</span> <span class=o>+</span> <span class=n>p</span> <span class=o>+</span> <span class=s>&#34; &#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>();</span>
</span></span><span class=line><span class=cl>  <span class=o>}</span>
</span></span><span class=line><span class=cl>  <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>List</span><span class=o>&lt;</span><span class=n>Pet</span><span class=o>&gt;</span> <span class=n>petList</span> <span class=o>=</span> <span class=n>Pets</span><span class=o>.</span><span class=na>list</span><span class=o>(</span><span class=mi>8</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>Set</span><span class=o>&lt;</span><span class=n>Pet</span><span class=o>&gt;</span> <span class=n>petSet</span> <span class=o>=</span> <span class=k>new</span> <span class=n>HashSet</span><span class=o>&lt;&gt;(</span><span class=n>petList</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>Map</span><span class=o>&lt;</span><span class=n>String</span><span class=o>,</span> <span class=n>Pet</span><span class=o>&gt;</span> <span class=n>petMap</span> <span class=o>=</span> <span class=k>new</span> <span class=n>LinkedHashMap</span><span class=o>&lt;&gt;();</span>
</span></span><span class=line><span class=cl>    <span class=n>String</span><span class=o>[]</span> <span class=n>names</span> <span class=o>=</span> <span class=o>(</span><span class=s>&#34;Ralph, Eric, Robin, Lacey, &#34;</span> <span class=o>+</span>
</span></span><span class=line><span class=cl>      <span class=s>&#34;Britney, Sam, Spot, Fluffy&#34;</span><span class=o>).</span><span class=na>split</span><span class=o>(</span><span class=s>&#34;, &#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span><span class=o>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=o>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>names</span><span class=o>.</span><span class=na>length</span><span class=o>;</span> <span class=n>i</span><span class=o>++)</span>
</span></span><span class=line><span class=cl>      <span class=n>petMap</span><span class=o>.</span><span class=na>put</span><span class=o>(</span><span class=n>names</span><span class=o>[</span><span class=n>i</span><span class=o>],</span> <span class=n>petList</span><span class=o>.</span><span class=na>get</span><span class=o>(</span><span class=n>i</span><span class=o>));</span>
</span></span><span class=line><span class=cl>    <span class=n>display</span><span class=o>(</span><span class=n>petList</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>display</span><span class=o>(</span><span class=n>petSet</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>display</span><span class=o>(</span><span class=n>petList</span><span class=o>.</span><span class=na>iterator</span><span class=o>());</span>
</span></span><span class=line><span class=cl>    <span class=n>display</span><span class=o>(</span><span class=n>petSet</span><span class=o>.</span><span class=na>iterator</span><span class=o>());</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>petMap</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>petMap</span><span class=o>.</span><span class=na>keySet</span><span class=o>());</span>
</span></span><span class=line><span class=cl>    <span class=n>display</span><span class=o>(</span><span class=n>petMap</span><span class=o>.</span><span class=na>values</span><span class=o>());</span>
</span></span><span class=line><span class=cl>    <span class=n>display</span><span class=o>(</span><span class=n>petMap</span><span class=o>.</span><span class=na>values</span><span class=o>().</span><span class=na>iterator</span><span class=o>());</span>
</span></span><span class=line><span class=cl>  <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=cm>/* Output:
</span></span></span><span class=line><span class=cl><span class=cm>0:Rat 1:Manx 2:Cymric 3:Mutt 4:Pug 5:Cymric 6:Pug 7:Manx
</span></span></span><span class=line><span class=cl><span class=cm>0:Rat 1:Manx 2:Cymric 3:Mutt 4:Pug 5:Cymric 6:Pug 7:Manx
</span></span></span><span class=line><span class=cl><span class=cm>0:Rat 1:Manx 2:Cymric 3:Mutt 4:Pug 5:Cymric 6:Pug 7:Manx
</span></span></span><span class=line><span class=cl><span class=cm>0:Rat 1:Manx 2:Cymric 3:Mutt 4:Pug 5:Cymric 6:Pug 7:Manx
</span></span></span><span class=line><span class=cl><span class=cm>{Ralph=Rat, Eric=Manx, Robin=Cymric, Lacey=Mutt, Britney=Pug, Sam=Cymric, Spot=Pug, Fluffy=Manx}
</span></span></span><span class=line><span class=cl><span class=cm>[Ralph, Eric, Robin, Lacey, Britney, Sam, Spot, Fluffy]
</span></span></span><span class=line><span class=cl><span class=cm>0:Rat 1:Manx 2:Cymric 3:Mutt 4:Pug 5:Cymric 6:Pug 7:Manx
</span></span></span><span class=line><span class=cl><span class=cm>0:Rat 1:Manx 2:Cymric 3:Mutt 4:Pug 5:Cymric 6:Pug 7:Manx
</span></span></span><span class=line><span class=cl><span class=cm>*/</span>
</span></span></code></pre></div><p>两个版本的 <code>display()</code> 方法都可以使用 <strong>Map</strong> 或 <strong>Collection</strong> 的子类型来工作。 而且<strong>Collection</strong> 接口和 <strong>Iterator</strong> 都将 <code>display()</code> 方法与低层集合的特定实现解耦。</p><p>在本例中，这两种方式都可以奏效。事实上， <strong>Collection</strong> 要更方便一点，因为它是 <strong>Iterable</strong> 类型，因此在 <code>display(Collection)</code> 的实现中可以使用 <em>for-in</em> 构造，这使得代码更加清晰。</p><p>当需要实现一个不是 <strong>Collection</strong> 的外部类时，由于让它去实现 <strong>Collection</strong> 接口可能非常困难或麻烦，因此使用 <strong>Iterator</strong> 就会变得非常吸引人。例如，如果我们通过继承一个持有 <strong>Pet</strong> 对象的类来创建一个 <strong>Collection</strong> 的实现，那么我们必须实现 <strong>Collection</strong> 所有的方法，纵使我们不会在 <code>display()</code> 方法中使用它们，也要这样做。尽管通过继承 <strong>AbstractCollection</strong> 会容易些，但是 <strong>AbstractCollection</strong> 还有 <code>iterator()</code> 和 <code>size()</code>没有实现（抽象方法），而 <strong>AbstractCollection</strong> 中的其它方法会用到它们，因此必须以自己的方式实现这两个方法：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// collections/CollectionSequence.java
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>import</span> <span class=nn>typeinfo.pets.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>java.util.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>CollectionSequence</span>
</span></span><span class=line><span class=cl><span class=kd>extends</span> <span class=n>AbstractCollection</span><span class=o>&lt;</span><span class=n>Pet</span><span class=o>&gt;</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>  <span class=kd>private</span> <span class=n>Pet</span><span class=o>[]</span> <span class=n>pets</span> <span class=o>=</span> <span class=n>Pets</span><span class=o>.</span><span class=na>array</span><span class=o>(</span><span class=mi>8</span><span class=o>);</span>
</span></span><span class=line><span class=cl>  <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>  <span class=kd>public</span> <span class=kt>int</span> <span class=nf>size</span><span class=o>()</span> <span class=o>{</span> <span class=k>return</span> <span class=n>pets</span><span class=o>.</span><span class=na>length</span><span class=o>;</span> <span class=o>}</span>
</span></span><span class=line><span class=cl>  <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>  <span class=kd>public</span> <span class=n>Iterator</span><span class=o>&lt;</span><span class=n>Pet</span><span class=o>&gt;</span> <span class=nf>iterator</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=k>new</span> <span class=n>Iterator</span><span class=o>&lt;</span><span class=n>Pet</span><span class=o>&gt;()</span> <span class=o>{</span> <span class=c1>// [1]
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=kd>private</span> <span class=kt>int</span> <span class=n>index</span> <span class=o>=</span> <span class=mi>0</span><span class=o>;</span>
</span></span><span class=line><span class=cl>      <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>      <span class=kd>public</span> <span class=kt>boolean</span> <span class=nf>hasNext</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>index</span> <span class=o>&lt;</span> <span class=n>pets</span><span class=o>.</span><span class=na>length</span><span class=o>;</span>
</span></span><span class=line><span class=cl>      <span class=o>}</span>
</span></span><span class=line><span class=cl>      <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>      <span class=kd>public</span> <span class=n>Pet</span> <span class=nf>next</span><span class=o>()</span> <span class=o>{</span> <span class=k>return</span> <span class=n>pets</span><span class=o>[</span><span class=n>index</span><span class=o>++];</span> <span class=o>}</span>
</span></span><span class=line><span class=cl>      <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>      <span class=kd>public</span> <span class=kt>void</span> <span class=nf>remove</span><span class=o>()</span> <span class=o>{</span> <span class=c1>// Not implemented
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>throw</span> <span class=k>new</span> <span class=n>UnsupportedOperationException</span><span class=o>();</span>
</span></span><span class=line><span class=cl>      <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>};</span>
</span></span><span class=line><span class=cl>  <span class=o>}</span>
</span></span><span class=line><span class=cl>  <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>CollectionSequence</span> <span class=n>c</span> <span class=o>=</span> <span class=k>new</span> <span class=n>CollectionSequence</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=n>InterfaceVsIterator</span><span class=o>.</span><span class=na>display</span><span class=o>(</span><span class=n>c</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>InterfaceVsIterator</span><span class=o>.</span><span class=na>display</span><span class=o>(</span><span class=n>c</span><span class=o>.</span><span class=na>iterator</span><span class=o>());</span>
</span></span><span class=line><span class=cl>  <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=cm>/* Output:
</span></span></span><span class=line><span class=cl><span class=cm>0:Rat 1:Manx 2:Cymric 3:Mutt 4:Pug 5:Cymric 6:Pug 7:Manx
</span></span></span><span class=line><span class=cl><span class=cm>0:Rat 1:Manx 2:Cymric 3:Mutt 4:Pug 5:Cymric 6:Pug 7:Manx
</span></span></span><span class=line><span class=cl><span class=cm>*/</span>
</span></span></code></pre></div><p><code>remove()</code> 方法是一个“可选操作”，在<a href>附录：集合主题</a>中详细介绍。 这里可以不必实现它，如果你调用它，它将抛出异常。</p><ul><li><strong>[1]</strong> 你可能会认为，因为 <code>iterator()</code> 返回 <strong>Iterator&lt;Pet></strong> ，匿名内部类定义可以使用菱形语法，Java 可以推断出类型。但这不起作用，类型推断仍然非常有限。</li></ul><p>这个例子表明，如果实现了 <strong>Collection</strong> ，就必须也实现 <code>iterator()</code> ，而单独只实现 <code>iterator()</code> 和继承 <strong>AbstractCollection</strong> 相比，并没有容易多少。但是，如果类已经继承了其他的类，那么就没法再继承 <strong>AbstractCollection</strong> 了。在这种情况下，要实现 <strong>Collection</strong> ，就必须实现该接口中的所有方法。此时，继承并提供创建迭代器的能力（单独只实现 <code>iterator()</code>）要容易得多：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// collections/NonCollectionSequence.java
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>import</span> <span class=nn>typeinfo.pets.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>java.util.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>class</span> <span class=nc>PetSequence</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>  <span class=kd>protected</span> <span class=n>Pet</span><span class=o>[]</span> <span class=n>pets</span> <span class=o>=</span> <span class=n>Pets</span><span class=o>.</span><span class=na>array</span><span class=o>(</span><span class=mi>8</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>NonCollectionSequence</span> <span class=kd>extends</span> <span class=n>PetSequence</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>  <span class=kd>public</span> <span class=n>Iterator</span><span class=o>&lt;</span><span class=n>Pet</span><span class=o>&gt;</span> <span class=nf>iterator</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=k>new</span> <span class=n>Iterator</span><span class=o>&lt;</span><span class=n>Pet</span><span class=o>&gt;()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>      <span class=kd>private</span> <span class=kt>int</span> <span class=n>index</span> <span class=o>=</span> <span class=mi>0</span><span class=o>;</span>
</span></span><span class=line><span class=cl>      <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>      <span class=kd>public</span> <span class=kt>boolean</span> <span class=nf>hasNext</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>index</span> <span class=o>&lt;</span> <span class=n>pets</span><span class=o>.</span><span class=na>length</span><span class=o>;</span>
</span></span><span class=line><span class=cl>      <span class=o>}</span>
</span></span><span class=line><span class=cl>      <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>      <span class=kd>public</span> <span class=n>Pet</span> <span class=nf>next</span><span class=o>()</span> <span class=o>{</span> <span class=k>return</span> <span class=n>pets</span><span class=o>[</span><span class=n>index</span><span class=o>++];</span> <span class=o>}</span>
</span></span><span class=line><span class=cl>      <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>      <span class=kd>public</span> <span class=kt>void</span> <span class=nf>remove</span><span class=o>()</span> <span class=o>{</span> <span class=c1>// Not implemented
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>throw</span> <span class=k>new</span> <span class=n>UnsupportedOperationException</span><span class=o>();</span>
</span></span><span class=line><span class=cl>      <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>};</span>
</span></span><span class=line><span class=cl>  <span class=o>}</span>
</span></span><span class=line><span class=cl>  <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>NonCollectionSequence</span> <span class=n>nc</span> <span class=o>=</span>
</span></span><span class=line><span class=cl>      <span class=k>new</span> <span class=n>NonCollectionSequence</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=n>InterfaceVsIterator</span><span class=o>.</span><span class=na>display</span><span class=o>(</span><span class=n>nc</span><span class=o>.</span><span class=na>iterator</span><span class=o>());</span>
</span></span><span class=line><span class=cl>  <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=cm>/* Output:
</span></span></span><span class=line><span class=cl><span class=cm>0:Rat 1:Manx 2:Cymric 3:Mutt 4:Pug 5:Cymric 6:Pug 7:Manx
</span></span></span><span class=line><span class=cl><span class=cm>*/</span>
</span></span></code></pre></div><p>生成 <strong>Iterator</strong> 是将序列与消费该序列的方法连接在一起的耦合度最小的方式，并且与实现 <strong>Collection</strong> 相比，它在序列类上所施加的约束也少得多。</p><h2 id=for-in-和迭代器>for-in 和迭代器</h2><p>到目前为止，<em>for-in</em> 语法主要用于数组，但它也适用于任何 <strong>Collection</strong> 对象。实际上在使用 <strong>ArrayList</strong> 时，已经看到了一些使用它的示例，下面是它的通用性的证明：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// collections/ForInCollections.java
</span></span></span><span class=line><span class=cl><span class=c1>// All collections work with for-in
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>import</span> <span class=nn>java.util.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>ForInCollections</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>  <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>Collection</span><span class=o>&lt;</span><span class=n>String</span><span class=o>&gt;</span> <span class=n>cs</span> <span class=o>=</span> <span class=k>new</span> <span class=n>LinkedList</span><span class=o>&lt;&gt;();</span>
</span></span><span class=line><span class=cl>    <span class=n>Collections</span><span class=o>.</span><span class=na>addAll</span><span class=o>(</span><span class=n>cs</span><span class=o>,</span>
</span></span><span class=line><span class=cl>      <span class=s>&#34;Take the long way home&#34;</span><span class=o>.</span><span class=na>split</span><span class=o>(</span><span class=s>&#34; &#34;</span><span class=o>));</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span><span class=o>(</span><span class=n>String</span> <span class=n>s</span> <span class=o>:</span> <span class=n>cs</span><span class=o>)</span>
</span></span><span class=line><span class=cl>      <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>print</span><span class=o>(</span><span class=s>&#34;&#39;&#34;</span> <span class=o>+</span> <span class=n>s</span> <span class=o>+</span> <span class=s>&#34;&#39; &#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>  <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=cm>/* Output:
</span></span></span><span class=line><span class=cl><span class=cm>&#39;Take&#39; &#39;the&#39; &#39;long&#39; &#39;way&#39; &#39;home&#39;
</span></span></span><span class=line><span class=cl><span class=cm>*/</span>
</span></span></code></pre></div><p>由于 <strong>cs</strong> 是一个 <strong>Collection</strong> ，因此该代码展示了使用 <em>for-in</em> 是所有 <strong>Collection</strong> 对象的特征。</p><p>这样做的原因是 Java 5 引入了一个名为 <strong>Iterable</strong> 的接口，该接口包含一个能够生成 <strong>Iterator</strong> 的 <code>iterator()</code> 方法。<em>for-in</em> 使用此 <strong>Iterable</strong> 接口来遍历序列。因此，如果创建了任何实现了 <strong>Iterable</strong> 的类，都可以将它用于 <em>for-in</em> 语句中：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// collections/IterableClass.java
</span></span></span><span class=line><span class=cl><span class=c1>// Anything Iterable works with for-in
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>import</span> <span class=nn>java.util.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>IterableClass</span> <span class=kd>implements</span> <span class=n>Iterable</span><span class=o>&lt;</span><span class=n>String</span><span class=o>&gt;</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>  <span class=kd>protected</span> <span class=n>String</span><span class=o>[]</span> <span class=n>words</span> <span class=o>=</span> <span class=o>(</span><span class=s>&#34;And that is how &#34;</span> <span class=o>+</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;we know the Earth to be banana-shaped.&#34;</span>
</span></span><span class=line><span class=cl>    <span class=o>).</span><span class=na>split</span><span class=o>(</span><span class=s>&#34; &#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>  <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>  <span class=kd>public</span> <span class=n>Iterator</span><span class=o>&lt;</span><span class=n>String</span><span class=o>&gt;</span> <span class=nf>iterator</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=k>new</span> <span class=n>Iterator</span><span class=o>&lt;</span><span class=n>String</span><span class=o>&gt;()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>      <span class=kd>private</span> <span class=kt>int</span> <span class=n>index</span> <span class=o>=</span> <span class=mi>0</span><span class=o>;</span>
</span></span><span class=line><span class=cl>      <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>      <span class=kd>public</span> <span class=kt>boolean</span> <span class=nf>hasNext</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>index</span> <span class=o>&lt;</span> <span class=n>words</span><span class=o>.</span><span class=na>length</span><span class=o>;</span>
</span></span><span class=line><span class=cl>      <span class=o>}</span>
</span></span><span class=line><span class=cl>      <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>      <span class=kd>public</span> <span class=n>String</span> <span class=nf>next</span><span class=o>()</span> <span class=o>{</span> <span class=k>return</span> <span class=n>words</span><span class=o>[</span><span class=n>index</span><span class=o>++];</span> <span class=o>}</span>
</span></span><span class=line><span class=cl>      <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>      <span class=kd>public</span> <span class=kt>void</span> <span class=nf>remove</span><span class=o>()</span> <span class=o>{</span> <span class=c1>// Not implemented
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>throw</span> <span class=k>new</span> <span class=n>UnsupportedOperationException</span><span class=o>();</span>
</span></span><span class=line><span class=cl>      <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>};</span>
</span></span><span class=line><span class=cl>  <span class=o>}</span>
</span></span><span class=line><span class=cl>  <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span><span class=o>(</span><span class=n>String</span> <span class=n>s</span> <span class=o>:</span> <span class=k>new</span> <span class=n>IterableClass</span><span class=o>())</span>
</span></span><span class=line><span class=cl>      <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>print</span><span class=o>(</span><span class=n>s</span> <span class=o>+</span> <span class=s>&#34; &#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>  <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=cm>/* Output:
</span></span></span><span class=line><span class=cl><span class=cm>And that is how we know the Earth to be banana-shaped.
</span></span></span><span class=line><span class=cl><span class=cm>*/</span>
</span></span></code></pre></div><p><code>iterator()</code> 返回的是实现了 <strong>Iterator&lt;String></strong> 的匿名内部类的实例，该匿名内部类可以遍历数组中的每个单词。在主方法中，可以看到 <strong>IterableClass</strong> 确实可以用于 <em>for-in</em> 语句。</p><p>在 Java 5 中，许多类都是 <strong>Iterable</strong> ，主要包括所有的 <strong>Collection</strong> 类（但不包括各种 <strong>Maps</strong> ）。 例如，下面的代码可以显示所有的操作系统环境变量：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// collections/EnvironmentVariables.java
</span></span></span><span class=line><span class=cl><span class=c1>// {VisuallyInspectOutput}
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>import</span> <span class=nn>java.util.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>EnvironmentVariables</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>  <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span><span class=o>(</span><span class=n>Map</span><span class=o>.</span><span class=na>Entry</span> <span class=n>entry</span><span class=o>:</span> <span class=n>System</span><span class=o>.</span><span class=na>getenv</span><span class=o>().</span><span class=na>entrySet</span><span class=o>())</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>      <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>entry</span><span class=o>.</span><span class=na>getKey</span><span class=o>()</span> <span class=o>+</span> <span class=s>&#34;: &#34;</span> <span class=o>+</span>
</span></span><span class=line><span class=cl>        <span class=n>entry</span><span class=o>.</span><span class=na>getValue</span><span class=o>());</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>  <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p><code>System.getenv()</code> <sup id=fnref:7><a href=#fn:7 class=footnote-ref role=doc-noteref>7</a></sup>返回一个 <strong>Map</strong> ， <code>entrySet()</code> 产生一个由 <strong>Map.Entry</strong> 的元素构成的 <strong>Set</strong> ，并且这个 <strong>Set</strong> 是一个 <strong>Iterable</strong> ，因此它可以用于 <em>for-in</em> 循环。</p><p><em>for-in</em> 语句适用于数组或者其它任何 <strong>Iterable</strong> ，但这并不代表数组一定是 <strong>Iterable</strong> ，也不会发生任何自动装箱：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// collections/ArrayIsNotIterable.java
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>import</span> <span class=nn>java.util.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>ArrayIsNotIterable</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>  <span class=kd>static</span> <span class=o>&lt;</span><span class=n>T</span><span class=o>&gt;</span> <span class=kt>void</span> <span class=nf>test</span><span class=o>(</span><span class=n>Iterable</span><span class=o>&lt;</span><span class=n>T</span><span class=o>&gt;</span> <span class=n>ib</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span><span class=o>(</span><span class=n>T</span> <span class=n>t</span> <span class=o>:</span> <span class=n>ib</span><span class=o>)</span>
</span></span><span class=line><span class=cl>      <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>print</span><span class=o>(</span><span class=n>t</span> <span class=o>+</span> <span class=s>&#34; &#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>  <span class=o>}</span>
</span></span><span class=line><span class=cl>  <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>test</span><span class=o>(</span><span class=n>Arrays</span><span class=o>.</span><span class=na>asList</span><span class=o>(</span><span class=mi>1</span><span class=o>,</span> <span class=mi>2</span><span class=o>,</span> <span class=mi>3</span><span class=o>));</span>
</span></span><span class=line><span class=cl>    <span class=n>String</span><span class=o>[]</span> <span class=n>strings</span> <span class=o>=</span> <span class=o>{</span> <span class=s>&#34;A&#34;</span><span class=o>,</span> <span class=s>&#34;B&#34;</span><span class=o>,</span> <span class=s>&#34;C&#34;</span> <span class=o>};</span>
</span></span><span class=line><span class=cl>    <span class=c1>// An array works in for-in, but it&#39;s not Iterable:
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>//- test(strings);
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// You must explicitly convert it to an Iterable:
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>test</span><span class=o>(</span><span class=n>Arrays</span><span class=o>.</span><span class=na>asList</span><span class=o>(</span><span class=n>strings</span><span class=o>));</span>
</span></span><span class=line><span class=cl>  <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=cm>/* Output:
</span></span></span><span class=line><span class=cl><span class=cm>1 2 3 A B C
</span></span></span><span class=line><span class=cl><span class=cm>*/</span>
</span></span></code></pre></div><p>尝试将数组作为一个 <strong>Iterable</strong> 参数传递会导致失败。这说明不存在任何从数组到 <strong>Iterable</strong> 的自动转换; 必须手工执行这种转换。</p><h3 id=适配器方法惯用法>适配器方法惯用法</h3><p>如果现在有一个 <strong>Iterable</strong> 类，你想要添加一种或多种在 <em>for-in</em> 语句中使用这个类的方法，应该怎么做呢？例如，你希望可以选择正向还是反向遍历一个单词列表。如果直接继承这个类，并重写 <code>iterator()</code> 方法，则只能替换现有的方法，而不能实现遍历顺序的选择。</p><p>一种解决方案是所谓<em>适配器方法</em>（Adapter Method）的惯用法。“适配器”部分来自于设计模式，因为必须要提供特定的接口来满足 <em>for-in</em> 语句。如果已经有一个接口并且需要另一个接口时，则编写适配器就可以解决这个问题。
在这里，若希望在默认的正向迭代器的基础上，添加产生反向迭代器的能力，因此不能使用重写，相反，而是添加了一个能够生成 <strong>Iterable</strong> 对象的方法，该对象可以用于 <em>for-in</em> 语句。这使得我们可以提供多种使用 <em>for-in</em> 语句的方式：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// collections/AdapterMethodIdiom.java
</span></span></span><span class=line><span class=cl><span class=c1>// The &#34;Adapter Method&#34; idiom uses for-in
</span></span></span><span class=line><span class=cl><span class=c1>// with additional kinds of Iterables
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>import</span> <span class=nn>java.util.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>class</span> <span class=nc>ReversibleArrayList</span><span class=o>&lt;</span><span class=n>T</span><span class=o>&gt;</span> <span class=kd>extends</span> <span class=n>ArrayList</span><span class=o>&lt;</span><span class=n>T</span><span class=o>&gt;</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>  <span class=n>ReversibleArrayList</span><span class=o>(</span><span class=n>Collection</span><span class=o>&lt;</span><span class=n>T</span><span class=o>&gt;</span> <span class=n>c</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>super</span><span class=o>(</span><span class=n>c</span><span class=o>);</span>
</span></span><span class=line><span class=cl>  <span class=o>}</span>
</span></span><span class=line><span class=cl>  <span class=kd>public</span> <span class=n>Iterable</span><span class=o>&lt;</span><span class=n>T</span><span class=o>&gt;</span> <span class=nf>reversed</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=k>new</span> <span class=n>Iterable</span><span class=o>&lt;</span><span class=n>T</span><span class=o>&gt;()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>      <span class=kd>public</span> <span class=n>Iterator</span><span class=o>&lt;</span><span class=n>T</span><span class=o>&gt;</span> <span class=nf>iterator</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=k>new</span> <span class=n>Iterator</span><span class=o>&lt;</span><span class=n>T</span><span class=o>&gt;()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>          <span class=kt>int</span> <span class=n>current</span> <span class=o>=</span> <span class=n>size</span><span class=o>()</span> <span class=o>-</span> <span class=mi>1</span><span class=o>;</span>
</span></span><span class=line><span class=cl>          <span class=kd>public</span> <span class=kt>boolean</span> <span class=nf>hasNext</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>current</span> <span class=o>&gt;</span> <span class=o>-</span><span class=mi>1</span><span class=o>;</span>
</span></span><span class=line><span class=cl>          <span class=o>}</span>
</span></span><span class=line><span class=cl>          <span class=kd>public</span> <span class=n>T</span> <span class=nf>next</span><span class=o>()</span> <span class=o>{</span> <span class=k>return</span> <span class=n>get</span><span class=o>(</span><span class=n>current</span><span class=o>--);</span> <span class=o>}</span>
</span></span><span class=line><span class=cl>          <span class=kd>public</span> <span class=kt>void</span> <span class=nf>remove</span><span class=o>()</span> <span class=o>{</span> <span class=c1>// Not implemented
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=k>throw</span> <span class=k>new</span> <span class=n>UnsupportedOperationException</span><span class=o>();</span>
</span></span><span class=line><span class=cl>          <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=o>};</span>
</span></span><span class=line><span class=cl>      <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>};</span>
</span></span><span class=line><span class=cl>  <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>AdapterMethodIdiom</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>  <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>ReversibleArrayList</span><span class=o>&lt;</span><span class=n>String</span><span class=o>&gt;</span> <span class=n>ral</span> <span class=o>=</span>
</span></span><span class=line><span class=cl>      <span class=k>new</span> <span class=n>ReversibleArrayList</span><span class=o>&lt;</span><span class=n>String</span><span class=o>&gt;(</span>
</span></span><span class=line><span class=cl>        <span class=n>Arrays</span><span class=o>.</span><span class=na>asList</span><span class=o>(</span><span class=s>&#34;To be or not to be&#34;</span><span class=o>.</span><span class=na>split</span><span class=o>(</span><span class=s>&#34; &#34;</span><span class=o>)));</span>
</span></span><span class=line><span class=cl>    <span class=c1>// Grabs the ordinary iterator via iterator():
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>for</span><span class=o>(</span><span class=n>String</span> <span class=n>s</span> <span class=o>:</span> <span class=n>ral</span><span class=o>)</span>
</span></span><span class=line><span class=cl>      <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>print</span><span class=o>(</span><span class=n>s</span> <span class=o>+</span> <span class=s>&#34; &#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=c1>// Hand it the Iterable of your choice
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>for</span><span class=o>(</span><span class=n>String</span> <span class=n>s</span> <span class=o>:</span> <span class=n>ral</span><span class=o>.</span><span class=na>reversed</span><span class=o>())</span>
</span></span><span class=line><span class=cl>      <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>print</span><span class=o>(</span><span class=n>s</span> <span class=o>+</span> <span class=s>&#34; &#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>  <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=cm>/* Output:
</span></span></span><span class=line><span class=cl><span class=cm>To be or not to be
</span></span></span><span class=line><span class=cl><span class=cm>be to not or be To
</span></span></span><span class=line><span class=cl><span class=cm>*/</span>
</span></span></code></pre></div><p>在主方法中，如果直接将 <strong>ral</strong> 对象放在 <em>for-in</em> 语句中，则会得到（默认的）正向迭代器。但是如果在该对象上调用 <code>reversed()</code> 方法，它会产生不同的行为。</p><p>通过使用这种方式，可以在 <strong>IterableClass.java</strong> 示例中添加两种适配器方法：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// collections/MultiIterableClass.java
</span></span></span><span class=line><span class=cl><span class=c1>// Adding several Adapter Methods
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>import</span> <span class=nn>java.util.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>MultiIterableClass</span> <span class=kd>extends</span> <span class=n>IterableClass</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>  <span class=kd>public</span> <span class=n>Iterable</span><span class=o>&lt;</span><span class=n>String</span><span class=o>&gt;</span> <span class=nf>reversed</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=k>new</span> <span class=n>Iterable</span><span class=o>&lt;</span><span class=n>String</span><span class=o>&gt;()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>      <span class=kd>public</span> <span class=n>Iterator</span><span class=o>&lt;</span><span class=n>String</span><span class=o>&gt;</span> <span class=nf>iterator</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=k>new</span> <span class=n>Iterator</span><span class=o>&lt;</span><span class=n>String</span><span class=o>&gt;()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>          <span class=kt>int</span> <span class=n>current</span> <span class=o>=</span> <span class=n>words</span><span class=o>.</span><span class=na>length</span> <span class=o>-</span> <span class=mi>1</span><span class=o>;</span>
</span></span><span class=line><span class=cl>          <span class=kd>public</span> <span class=kt>boolean</span> <span class=nf>hasNext</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>current</span> <span class=o>&gt;</span> <span class=o>-</span><span class=mi>1</span><span class=o>;</span>
</span></span><span class=line><span class=cl>          <span class=o>}</span>
</span></span><span class=line><span class=cl>          <span class=kd>public</span> <span class=n>String</span> <span class=nf>next</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>words</span><span class=o>[</span><span class=n>current</span><span class=o>--];</span>
</span></span><span class=line><span class=cl>          <span class=o>}</span>
</span></span><span class=line><span class=cl>          <span class=kd>public</span> <span class=kt>void</span> <span class=nf>remove</span><span class=o>()</span> <span class=o>{</span> <span class=c1>// Not implemented
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=k>throw</span> <span class=k>new</span> <span class=n>UnsupportedOperationException</span><span class=o>();</span>
</span></span><span class=line><span class=cl>          <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=o>};</span>
</span></span><span class=line><span class=cl>      <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>};</span>
</span></span><span class=line><span class=cl>  <span class=o>}</span>
</span></span><span class=line><span class=cl>  <span class=kd>public</span> <span class=n>Iterable</span><span class=o>&lt;</span><span class=n>String</span><span class=o>&gt;</span> <span class=nf>randomized</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=k>new</span> <span class=n>Iterable</span><span class=o>&lt;</span><span class=n>String</span><span class=o>&gt;()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>      <span class=kd>public</span> <span class=n>Iterator</span><span class=o>&lt;</span><span class=n>String</span><span class=o>&gt;</span> <span class=nf>iterator</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>List</span><span class=o>&lt;</span><span class=n>String</span><span class=o>&gt;</span> <span class=n>shuffled</span> <span class=o>=</span>
</span></span><span class=line><span class=cl>          <span class=k>new</span> <span class=n>ArrayList</span><span class=o>&lt;</span><span class=n>String</span><span class=o>&gt;(</span><span class=n>Arrays</span><span class=o>.</span><span class=na>asList</span><span class=o>(</span><span class=n>words</span><span class=o>));</span>
</span></span><span class=line><span class=cl>        <span class=n>Collections</span><span class=o>.</span><span class=na>shuffle</span><span class=o>(</span><span class=n>shuffled</span><span class=o>,</span> <span class=k>new</span> <span class=n>Random</span><span class=o>(</span><span class=mi>47</span><span class=o>));</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>shuffled</span><span class=o>.</span><span class=na>iterator</span><span class=o>();</span>
</span></span><span class=line><span class=cl>      <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>};</span>
</span></span><span class=line><span class=cl>  <span class=o>}</span>
</span></span><span class=line><span class=cl>  <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>MultiIterableClass</span> <span class=n>mic</span> <span class=o>=</span> <span class=k>new</span> <span class=n>MultiIterableClass</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span><span class=o>(</span><span class=n>String</span> <span class=n>s</span> <span class=o>:</span> <span class=n>mic</span><span class=o>.</span><span class=na>reversed</span><span class=o>())</span>
</span></span><span class=line><span class=cl>      <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>print</span><span class=o>(</span><span class=n>s</span> <span class=o>+</span> <span class=s>&#34; &#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span><span class=o>(</span><span class=n>String</span> <span class=n>s</span> <span class=o>:</span> <span class=n>mic</span><span class=o>.</span><span class=na>randomized</span><span class=o>())</span>
</span></span><span class=line><span class=cl>      <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>print</span><span class=o>(</span><span class=n>s</span> <span class=o>+</span> <span class=s>&#34; &#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span><span class=o>(</span><span class=n>String</span> <span class=n>s</span> <span class=o>:</span> <span class=n>mic</span><span class=o>)</span>
</span></span><span class=line><span class=cl>      <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>print</span><span class=o>(</span><span class=n>s</span> <span class=o>+</span> <span class=s>&#34; &#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>  <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=cm>/* Output:
</span></span></span><span class=line><span class=cl><span class=cm>banana-shaped. be to Earth the know we how is that And
</span></span></span><span class=line><span class=cl><span class=cm>is banana-shaped. Earth that how the be And we know to
</span></span></span><span class=line><span class=cl><span class=cm>And that is how we know the Earth to be banana-shaped.
</span></span></span><span class=line><span class=cl><span class=cm>*/</span>
</span></span></code></pre></div><p>注意，第二个方法 <code>random()</code> 没有创建它自己的 <strong>Iterator</strong> ，而是直接返回被打乱的 <strong>List</strong> 中的 <strong>Iterator</strong> 。</p><p>从输出中可以看到， <code>Collections.shuffle()</code> 方法不会影响到原始数组，而只是打乱了 <strong>shuffled</strong> 中的引用。之所以这样，是因为 <code>randomized()</code> 方法用一个 <strong>ArrayList</strong> 将 <code>Arrays.asList()</code> 的结果包装了起来。如果这个由 <code>Arrays.asList()</code> 生成的 <strong>List</strong> 被直接打乱，那么它将修改底层数组，如下所示：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// collections/ModifyingArraysAsList.java
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>import</span> <span class=nn>java.util.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>ModifyingArraysAsList</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>  <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>Random</span> <span class=n>rand</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Random</span><span class=o>(</span><span class=mi>47</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>Integer</span><span class=o>[]</span> <span class=n>ia</span> <span class=o>=</span> <span class=o>{</span> <span class=mi>1</span><span class=o>,</span> <span class=mi>2</span><span class=o>,</span> <span class=mi>3</span><span class=o>,</span> <span class=mi>4</span><span class=o>,</span> <span class=mi>5</span><span class=o>,</span> <span class=mi>6</span><span class=o>,</span> <span class=mi>7</span><span class=o>,</span> <span class=mi>8</span><span class=o>,</span> <span class=mi>9</span><span class=o>,</span> <span class=mi>10</span> <span class=o>};</span>
</span></span><span class=line><span class=cl>    <span class=n>List</span><span class=o>&lt;</span><span class=n>Integer</span><span class=o>&gt;</span> <span class=n>list1</span> <span class=o>=</span>
</span></span><span class=line><span class=cl>      <span class=k>new</span> <span class=n>ArrayList</span><span class=o>&lt;&gt;(</span><span class=n>Arrays</span><span class=o>.</span><span class=na>asList</span><span class=o>(</span><span class=n>ia</span><span class=o>));</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;Before shuffling: &#34;</span> <span class=o>+</span> <span class=n>list1</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>Collections</span><span class=o>.</span><span class=na>shuffle</span><span class=o>(</span><span class=n>list1</span><span class=o>,</span> <span class=n>rand</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;After shuffling: &#34;</span> <span class=o>+</span> <span class=n>list1</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;array: &#34;</span> <span class=o>+</span> <span class=n>Arrays</span><span class=o>.</span><span class=na>toString</span><span class=o>(</span><span class=n>ia</span><span class=o>));</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>List</span><span class=o>&lt;</span><span class=n>Integer</span><span class=o>&gt;</span> <span class=n>list2</span> <span class=o>=</span> <span class=n>Arrays</span><span class=o>.</span><span class=na>asList</span><span class=o>(</span><span class=n>ia</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;Before shuffling: &#34;</span> <span class=o>+</span> <span class=n>list2</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>Collections</span><span class=o>.</span><span class=na>shuffle</span><span class=o>(</span><span class=n>list2</span><span class=o>,</span> <span class=n>rand</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;After shuffling: &#34;</span> <span class=o>+</span> <span class=n>list2</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;array: &#34;</span> <span class=o>+</span> <span class=n>Arrays</span><span class=o>.</span><span class=na>toString</span><span class=o>(</span><span class=n>ia</span><span class=o>));</span>
</span></span><span class=line><span class=cl>  <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=cm>/* Output:
</span></span></span><span class=line><span class=cl><span class=cm>Before shuffling: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
</span></span></span><span class=line><span class=cl><span class=cm>After shuffling: [4, 6, 3, 1, 8, 7, 2, 5, 10, 9]
</span></span></span><span class=line><span class=cl><span class=cm>array: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
</span></span></span><span class=line><span class=cl><span class=cm>Before shuffling: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
</span></span></span><span class=line><span class=cl><span class=cm>After shuffling: [9, 1, 6, 3, 7, 2, 5, 10, 4, 8]
</span></span></span><span class=line><span class=cl><span class=cm>array: [9, 1, 6, 3, 7, 2, 5, 10, 4, 8]
</span></span></span><span class=line><span class=cl><span class=cm>*/</span>
</span></span></code></pre></div><p>在第一种情况下， <code>Arrays.asList()</code> 的输出被传递给了 <strong>ArrayList</strong> 的构造器，这将创建一个引用 <strong>ia</strong> 的元素的 <strong>ArrayList</strong> ，因此打乱这些引用不会修改该数组。但是，如果直接使用 <code>Arrays.asList(ia)</code> 的结果，这种打乱就会修改 <strong>ia</strong> 的顺序。重要的是要注意 <code>Arrays.asList()</code> 生成一个 <strong>List</strong> 对象，该对象使用底层数组作为其物理实现。如果对 <strong>List</strong> 对象做了任何修改，又不想让原始数组被修改，那么就应该在另一个集合中创建一个副本。</p><h2 id=本章小结>本章小结</h2><p>Java 提供了许多保存对象的方法：</p><ol><li><p>数组将数字索引与对象相关联。它保存类型明确的对象，因此在查找对象时不必对结果做类型转换。它可以是多维的，可以保存基本类型的数据。虽然可以在运行时创建数组，但是一旦创建数组，就无法更改数组的大小。</p></li><li><p><strong>Collection</strong> 保存单一的元素，而 <strong>Map</strong> 包含相关联的键值对。使用 Java 泛型，可以指定集合中保存的对象的类型，因此不能将错误类型的对象放入集合中，并且在从集合中获取元素时，不必进行类型转换。各种 <strong>Collection</strong> 和各种 <strong>Map</strong> 都可以在你向其中添加更多的元素时，自动调整其尺寸大小。集合不能保存基本类型，但自动装箱机制会负责执行基本类型和集合中保存的包装类型之间的双向转换。</p></li><li><p>像数组一样， <strong>List</strong> 也将数字索引与对象相关联，因此，数组和 <strong>List</strong> 都是有序集合。</p></li><li><p>如果要执行大量的随机访问，则使用 <strong>ArrayList</strong> ，如果要经常从表中间插入或删除元素，则应该使用 <strong>LinkedList</strong> 。</p></li><li><p>队列和堆栈的行为是通过 <strong>LinkedList</strong> 提供的。</p></li><li><p><strong>Map</strong> 是一种将对象（而非数字）与对象相关联的设计。 <strong>HashMap</strong> 专为快速访问而设计，而 <strong>TreeMap</strong> 保持键始终处于排序状态，所以没有 <strong>HashMap</strong> 快。 <strong>LinkedHashMap</strong> 按插入顺序保存其元素，但使用散列提供快速访问的能力。</p></li><li><p><strong>Set</strong> 不接受重复元素。 <strong>HashSet</strong> 提供最快的查询速度，而 <strong>TreeSet</strong> 保持元素处于排序状态。 <strong>LinkedHashSet</strong> 按插入顺序保存其元素，但使用散列提供快速访问的能力。</p></li><li><p>不要在新代码中使用遗留类 <strong>Vector</strong> ，<strong>Hashtable</strong> 和 <strong>Stack</strong> 。</p></li></ol><p>浏览一下 Java 集合的简图（不包含抽象类或遗留组件）会很有帮助。这里仅包括在一般情况下会碰到的接口和类。（译者注：下图为原著 PDF 中的截图，可能由于未知原因存在问题。这里可参考译者绘制版<sup id=fnref:8><a href=#fn:8 class=footnote-ref role=doc-noteref>8</a></sup>）</p><p><figure><div class="d-flex justify-content-center"><div class=w-100><img src=https://assets.ng-tech.icu/book/on-java-8/simple-collection-taxonomy.png alt="simple collection taxonomy" loading=lazy data-zoomable></div></div></figure></p><h3 id=简单集合分类>简单集合分类</h3><p>可以看到，实际上只有四个基本的集合组件： <strong>Map</strong> ， <strong>List</strong> ， <strong>Set</strong> 和 <strong>Queue</strong> ，它们各有两到三个实现版本（<strong>Queue</strong> 的 <strong>java.util.concurrent</strong> 实现未包含在此图中）。最常使用的集合用黑色粗线线框表示。</p><p>虚线框表示接口，实线框表示普通的（具体的）类。带有空心箭头的虚线表示特定的类实现了一个接口。实心箭头表示某个类可以生成箭头指向的类的对象。例如，任何 <strong>Collection</strong> 都可以生成 <strong>Iterator</strong> ， <strong>List</strong> 可以生成 <strong>ListIterator</strong> （也能生成普通的 <strong>Iterator</strong> ，因为 <strong>List</strong> 继承自 <strong>Collection</strong> ）。</p><p>下面的示例展示了各种不同的类在方法上的差异。实际代码来自<a href>泛型</a>章节，在这里只是调用它来产生输出。程序的输出还展示了在每个类或接口中所实现的接口：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// collections/CollectionDifferences.java
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>import</span> <span class=nn>onjava.*</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>CollectionDifferences</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>  <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>CollectionMethodDifferences</span><span class=o>.</span><span class=na>main</span><span class=o>(</span><span class=n>args</span><span class=o>);</span>
</span></span><span class=line><span class=cl>  <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=cm>/* Output:
</span></span></span><span class=line><span class=cl><span class=cm>Collection: [add, addAll, clear, contains, containsAll, equals, forEach, hashCode, isEmpty, iterator, parallelStream, remove, removeAll, removeIf, retainAll, size, spliterator, stream, toArray]
</span></span></span><span class=line><span class=cl><span class=cm>Interfaces in Collection: [Iterable]
</span></span></span><span class=line><span class=cl><span class=cm>Set extends Collection, adds: []
</span></span></span><span class=line><span class=cl><span class=cm>Interfaces in Set: [Collection]
</span></span></span><span class=line><span class=cl><span class=cm>HashSet extends Set, adds: []
</span></span></span><span class=line><span class=cl><span class=cm>Interfaces in HashSet: [Set, Cloneable, Serializable]
</span></span></span><span class=line><span class=cl><span class=cm>LinkedHashSet extends HashSet, adds: []
</span></span></span><span class=line><span class=cl><span class=cm>Interfaces in LinkedHashSet: [Set, Cloneable, Serializable]
</span></span></span><span class=line><span class=cl><span class=cm>TreeSet extends Set, adds: [headSet, descendingIterator, descendingSet, pollLast, subSet, floor, tailSet, ceiling, last, lower, comparator, pollFirst, first, higher]
</span></span></span><span class=line><span class=cl><span class=cm>Interfaces in TreeSet: [NavigableSet, Cloneable, Serializable]
</span></span></span><span class=line><span class=cl><span class=cm>List extends Collection, adds: [replaceAll, get, indexOf, subList, set, sort, lastIndexOf, listIterator]
</span></span></span><span class=line><span class=cl><span class=cm>Interfaces in List: [Collection]
</span></span></span><span class=line><span class=cl><span class=cm>ArrayList extends List, adds: [trimToSize, ensureCapacity]
</span></span></span><span class=line><span class=cl><span class=cm>Interfaces in ArrayList: [List, RandomAccess, Cloneable, Serializable]
</span></span></span><span class=line><span class=cl><span class=cm>LinkedList extends List, adds: [offerFirst, poll, getLast, offer, getFirst, removeFirst, element, removeLastOccurrence, peekFirst, peekLast, push, pollFirst, removeFirstOccurrence, descendingIterator, pollLast, removeLast, pop, addLast, peek, offerLast, addFirst]
</span></span></span><span class=line><span class=cl><span class=cm>Interfaces in LinkedList: [List, Deque, Cloneable, Serializable]
</span></span></span><span class=line><span class=cl><span class=cm>Queue extends Collection, adds: [poll, peek, offer, element]
</span></span></span><span class=line><span class=cl><span class=cm>Interfaces in Queue: [Collection]
</span></span></span><span class=line><span class=cl><span class=cm>PriorityQueue extends Queue, adds: [comparator]
</span></span></span><span class=line><span class=cl><span class=cm>Interfaces in PriorityQueue: [Serializable]
</span></span></span><span class=line><span class=cl><span class=cm>Map: [clear, compute, computeIfAbsent, computeIfPresent, containsKey, containsValue, entrySet, equals, forEach, get, getOrDefault, hashCode, isEmpty, keySet, merge, put, putAll, putIfAbsent, remove, replace, replaceAll, size, values]
</span></span></span><span class=line><span class=cl><span class=cm>HashMap extends Map, adds: []
</span></span></span><span class=line><span class=cl><span class=cm>Interfaces in HashMap: [Map, Cloneable, Serializable]
</span></span></span><span class=line><span class=cl><span class=cm>LinkedHashMap extends HashMap, adds: []
</span></span></span><span class=line><span class=cl><span class=cm>Interfaces in LinkedHashMap: [Map]
</span></span></span><span class=line><span class=cl><span class=cm>SortedMap extends Map, adds: [lastKey, subMap, comparator, firstKey, headMap, tailMap]
</span></span></span><span class=line><span class=cl><span class=cm>Interfaces in SortedMap: [Map]
</span></span></span><span class=line><span class=cl><span class=cm>TreeMap extends Map, adds: [descendingKeySet, navigableKeySet, higherEntry, higherKey, floorKey, subMap, ceilingKey, pollLastEntry, firstKey, lowerKey, headMap, tailMap, lowerEntry, ceilingEntry, descendingMap, pollFirstEntry, lastKey, firstEntry, floorEntry, comparator, lastEntry]
</span></span></span><span class=line><span class=cl><span class=cm>Interfaces in TreeMap: [NavigableMap, Cloneable, Serializable]
</span></span></span><span class=line><span class=cl><span class=cm>*/</span>
</span></span></code></pre></div><p>除 <strong>TreeSet</strong> 之外的所有 <strong>Set</strong> 都具有与 <strong>Collection</strong> 完全相同的接口。<strong>List</strong> 和 <strong>Collection</strong> 存在着明显的不同，尽管 <strong>List</strong> 所要求的方法都在 <strong>Collection</strong> 中。另一方面，在 <strong>Queue</strong> 接口中的方法是独立的，在创建具有 <strong>Queue</strong> 功能的实现时，不需要使用 <strong>Collection</strong> 方法。最后， <strong>Map</strong> 和 <strong>Collection</strong> 之间唯一的交集是 <strong>Map</strong> 可以使用 <code>entrySet()</code> 和 <code>values()</code> 方法来产生 <strong>Collection</strong> 。</p><p>请注意，标记接口 <strong>java.util.RandomAccess</strong> 附加到了 <strong>ArrayList</strong> 上，但不附加到 <strong>LinkedList</strong> 上。这为根据特定 <strong>List</strong> 动态改变其行为的算法提供了信息。</p><p>从面向对象的继承层次结构来看，这种组织结构确实有些奇怪。但是，当了解了 <strong>java.util</strong> 中更多的有关集合的内容后（特别是在<a href>附录：集合主题</a>中的内容），就会发现除了继承结构有点奇怪外，还有更多的问题。集合类库一直以来都是设计难题——解决这些问题涉及到要去满足经常彼此之间互为牵制的各方面需求。所以要做好准备，在各处做出妥协。</p><p>尽管存在这些问题，但 Java 集合仍是在日常工作中使用的基本工具，它可以使程序更简洁、更强大、更有效。你可能需要一段时间才能熟悉集合类库的某些方面，但我想你很快就会找到自己的路子，来获得和使用这个类库中的类。</p><div style=page-break-after:always></div><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p>许多语言，例如 Perl ，Python 和 Ruby ，都有集合的本地支持。&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2><p>这里是操作符重载的用武之地，C++和 C#的集合类都使用操作符重载生成了更简洁的语法。&#160;<a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:3><p>在<a href>泛型</a>章节的末尾，有个关于这个问题是否很严重的讨论。但是，<a href>泛型</a>章节还将展示 Java 泛型远不止是类型安全的集合这么简单。&#160;<a href=#fnref:3 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:4><p><code>remove()</code> 是一个所谓的“可选”方法（还有其它这样的方法），这意味着并非所有的 <strong>Iterator</strong> 实现都必须实现该方法。这个问题将在<a href>附录：集合主题</a>中介绍。但是，标准 Java 库集合实现了 <code>remove()</code> ，因此在<a href>附录：集合主题</a>章节之前，都不必担心这个问题。&#160;<a href=#fnref:4 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:5><p>这实际上依赖于具体实现。优先级队列算法通常会按插入顺序排序（维护一个<em>堆</em>），但它们也可以在删除时选择最重要的元素。 如果一个对象在队列中等待时，它的优先级会发生变化，那么算法的选择就很重要。&#160;<a href=#fnref:5 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:6><p>有些人鼓吹不加思索地创建接口对应一个类甚至每个类中的所有可能的方法组合。 但我相信接口的意义不应该仅限于机械地重复方法组合，因此我倾向于看到增加接口的价值才创建它。&#160;<a href=#fnref:6 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:7><p>这在 Java 5 之前是不可用的，因为该方法被认为与操作系统的耦合度过紧，因此违反“一次编写，处处运行”的原则。现在却提供它，这一事实表明， Java 的设计者们更加务实了。&#160;<a href=#fnref:7 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:8><p>下面是译者绘制的 Java 集合框架简图，黄色为接口，绿色为抽象类，蓝色为具体类。虚线箭头表示实现关系，实线箭头表示继承关系。<figure><div class="d-flex justify-content-center"><div class=w-100><img src=https://assets.ng-tech.icu/book/on-java-8/collection.png alt=collection loading=lazy data-zoomable></div></div></figure><figure><div class="d-flex justify-content-center"><div class=w-100><img src=https://assets.ng-tech.icu/book/on-java-8/map.png alt=map loading=lazy data-zoomable></div></div></figure>&#160;<a href=#fnref:8 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div></div><div class=article-widget><div class="container-xl row post-nav"><div class="col-6 post-nav-item"><div class=meta-nav>上一页</div><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/11-inner-classes/ rel=next>11-Inner-Classes</a></div><div class="col-6 post-nav-item"><div class=meta-nav>下一页</div><a href=/books/java-notes/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/on-java-8/13-functional-programming/ rel=prev>13-Functional-Programming</a></div></div></div><div class=body-footer><p>最近更新于 0001-01-01</p><section id=comments class="mb-3 pt-0"><div id=disqus_thread></div><script>var disqus_config=function(){};(function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="https://ngte.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)})()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></section></div></article><footer class=site-footer><div class="copyright py-4 bg-footer"><div class="row justify-content-center"><div class="text-center footer-color"><p class=mb-0>© 2017-2022 NGTE all rights reserved</p></div></div></div><script type=text/javascript id=clstr_globe async src="//clustrmaps.com/globe.js?d=kgpJG5sWZQpKujBmD-uW1B54-WBPol-DuDtrB2KFjKs"></script></footer></main></div></div><script src=//unpkg.com/heti/umd/heti-addon.min.js></script>
<script>const heti=new Heti(".article");heti.autoSpacing()</script><script type=text/javascript>window.$crisp=[],window.CRISP_WEBSITE_ID="12adcc35-9621-4313-8262-62dc654b29d8",function(){setTimeout(function(){d=document,s=d.createElement("script"),s.src="https://client.crisp.chat/l.js",s.async=1,d.getElementsByTagName("head")[0].appendChild(s)},2500)}()</script></div><div class=page-footer></div><script src=/js/vendor-bundle.min.d26509351aa0ff874abbee824e982e9b.js></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.1/highlight.min.js integrity="sha512-Ypjm0o7jOxAd4hpdoppSEN0TQOC19UtPAqD+4s5AlXmUvbmmS/YMxYqAqarQYyxTnB6/rqip9qcxlNB/3U9Wdg==" crossorigin=anonymous></script>
<script id=search-hit-algolia-template type=text/html><div class=search-hit><div class=search-hit-content><div class=search-hit-name><a href={{relpermalink}}>{{#helpers.highlight}}{ "attribute": "title" }{{/helpers.highlight}}</a></div><div class="article-metadata search-hit-type">{{type}}</div><p class=search-hit-description>{{#helpers.highlight}}{ "attribute": "summary" }{{/helpers.highlight}}</p></div></div></script><script src=https://cdn.jsdelivr.net/npm/instantsearch.js@4/dist/instantsearch.production.min.js crossorigin=anonymous></script>
<script id=dsq-count-scr src=https://ngte.disqus.com/count.js async></script>
<script src=/zh/js/algolia-search-built.min.4387d694ca1258194aaf562b8cd1c400.js type=module></script>
<script id=page-data type=application/json>{"use_headroom":false}</script><script src=/zh/js/wowchemy.min.d1673c7a11d1238516cbe12a1e84257f.js></script>
<script>var mybutton=document.getElementById("backTopBtn");window.onscroll=function(){scrollFunction()};function scrollFunction(){document.body.scrollTop>20||document.documentElement.scrollTop>20?mybutton.style.display="block":mybutton.style.display="none"}function topFunction(){document.body.scrollTop=0,document.documentElement.scrollTop=0}</script><script src=https://cdn.jsdelivr.net/gh/bryanbraun/anchorjs@4.2.2/anchor.min.js integrity="sha512-I7w3ZdSFzw5j3jU3ZkNikBNeIrl3i+hEuEdwNmqUJvwNcaBUNcijnP2gd9DtGlgVYDplfjGoD8vTNsID+lCjqg==" crossorigin=anonymous></script>
<script>anchors.add()</script><script>(function(){"use strict";if(!document.queryCommandSupported("copy"))return;function e(e,t){e.className="highlight-copy-btn",e.textContent=t,setTimeout(function(){e.textContent="",e.className="highlight-copy-btn fa fa-copy"},1e3)}function t(e){var t=window.getSelection(),n=document.createRange();return n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n),t}function n(n){var o,s=document.createElement("button");s.className="highlight-copy-btn fa fa-copy",s.textContent="",o=n.firstElementChild,s.addEventListener("click",function(){try{var n=t(o);document.execCommand("copy"),n.removeAllRanges(),e(s,"已复制")}catch(t){console&&console.log(t),e(s,"Failed :'(")}}),n.appendChild(s)}var s=document.getElementsByClassName("highlight");Array.prototype.forEach.call(s,n)})()</script></body></html>