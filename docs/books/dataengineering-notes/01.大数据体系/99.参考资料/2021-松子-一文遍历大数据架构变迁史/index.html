<!DOCTYPE html><html lang="zh" >


<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  
  
  
    <meta name="generator" content="Wowchemy 5.5.0 for Hugo" />
  

  
  










  







  
  
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  

  
  
  
    
      
      <link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap">
      <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap" media="print" onload="this.media='all'">
    
  

  
    <meta name="google-site-verification" content="google69a5cccb61297807" />
    <meta name="baidu-site-verification" content="cqmZHEleVh" />
  
  
  
  
  

  

  
  
  
    
  
  <meta name="description" content="一文遍历大数据架构变迁史 从现在的企业发展来看，大家的诉求重点已经从经营与分析转为数据化的精细运营。在如何做好精细化运营过程中，企业也面临着来自创新、发展、内卷等的各方面压力。随着业务量、数据量增长，大" />

  
  <link rel="alternate" hreflang="zh" href="https://ng-tech.icu/books/dataengineering-notes/01.%E5%A4%A7%E6%95%B0%E6%8D%AE%E4%BD%93%E7%B3%BB/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2021-%E6%9D%BE%E5%AD%90-%E4%B8%80%E6%96%87%E9%81%8D%E5%8E%86%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%9E%B6%E6%9E%84%E5%8F%98%E8%BF%81%E5%8F%B2/" />

  
  
  
    <meta name="theme-color" content="#0a55a7" />
  

  
  

  

  <link rel="stylesheet" href="/css/vendor-bundle.min.c7b8d9abd591ba2253ea42747e3ac3f5.css" media="print" onload="this.media='all'">

  
  
  
    
    

    
    
    
    
      
      
    
    
    

    
    
    
      
    
    
      
      
        
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.1/styles/github.min.css" crossorigin="anonymous" title="hl-light" media="print" onload="this.media='all'">
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.1/styles/dracula.min.css" crossorigin="anonymous" title="hl-dark" media="print" onload="this.media='all'" disabled>
        
      
    

    
    
    

    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/instantsearch.css@7.4.5/themes/satellite-min.css" integrity="sha256-TehzF/2QvNKhGQrrNpoOb2Ck4iGZ1J/DI4pkd2oUsBc=" crossorigin="anonymous">
    

    
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      
        
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
  

  
  
  
  
  
  <link rel="stylesheet" href="/css/wowchemy.0d97305106da5efa530e28b021b4c580.css" />

  




<script async src="https://www.googletagmanager.com/gtag/js?id=G-40NYXJ8823"></script>

<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', "G-40NYXJ8823");
</script>


  


  


  


  <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?56df1177bce405601b0ecdd7208f75c6";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>



  
  
  

  

  
    <link rel="manifest" href="/manifest.webmanifest" />
  

  <link rel="icon" type="image/png" href="/media/icon_hu0f7d075e895d6f5f1f5fdbc1e33dc138_10087_32x32_fill_lanczos_center_3.png" />
  <link rel="apple-touch-icon" type="image/png" href="/media/icon_hu0f7d075e895d6f5f1f5fdbc1e33dc138_10087_180x180_fill_lanczos_center_3.png" />

  <link rel="canonical" href="https://ng-tech.icu/books/dataengineering-notes/01.%E5%A4%A7%E6%95%B0%E6%8D%AE%E4%BD%93%E7%B3%BB/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2021-%E6%9D%BE%E5%AD%90-%E4%B8%80%E6%96%87%E9%81%8D%E5%8E%86%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%9E%B6%E6%9E%84%E5%8F%98%E8%BF%81%E5%8F%B2/" />

  
  
  
  
  
  
  
  
    
  
  

  
  
    
    
  
  <meta property="twitter:card" content="summary_large_image" />
  
    <meta property="twitter:site" content="@wx-chevalier" />
    <meta property="twitter:creator" content="@wx-chevalier" />
  
  <meta property="og:site_name" content="Next-gen Tech Edu" />
  <meta property="og:url" content="https://ng-tech.icu/books/dataengineering-notes/01.%E5%A4%A7%E6%95%B0%E6%8D%AE%E4%BD%93%E7%B3%BB/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2021-%E6%9D%BE%E5%AD%90-%E4%B8%80%E6%96%87%E9%81%8D%E5%8E%86%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%9E%B6%E6%9E%84%E5%8F%98%E8%BF%81%E5%8F%B2/" />
  <meta property="og:title" content="2021-松子-一文遍历大数据架构变迁史 | Next-gen Tech Edu" />
  <meta property="og:description" content="一文遍历大数据架构变迁史 从现在的企业发展来看，大家的诉求重点已经从经营与分析转为数据化的精细运营。在如何做好精细化运营过程中，企业也面临着来自创新、发展、内卷等的各方面压力。随着业务量、数据量增长，大" /><meta property="og:image" content="https://ng-tech.icu/media/sharing.png" />
    <meta property="twitter:image" content="https://ng-tech.icu/media/sharing.png" /><meta property="og:locale" content="zh" />
  
    
    
  

  



  

  

  





  <title>2021-松子-一文遍历大数据架构变迁史 | Next-gen Tech Edu</title>
</head>


<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" class="page-wrapper   " data-wc-page-id="1bb0a530ee92274991c39b0e87e8aa68" >
  <button onclick="topFunction()" id="backTopBtn" title="Go to top"><i class="fa-solid fa-circle-up" aria-hidden="true"></i></button>
  
  
  
  
  
  
  
  
  
  <script src="/js/wowchemy-init.min.14a0ed61c6dbd594b9c75193b25be179.js"></script>

  


<aside class="search-modal" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6 search-title">
          <p>搜索</p>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#" aria-label="关闭"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        
        
      </div>

      
      

      
    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

      <div id="search-common-queries">
        
      </div>

    </section>
  </div>
</aside>



  <div class="page-header">
    












<header class="header--fixed">
  <nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
    <div class="container-xl">

      
      <div class="d-none d-lg-inline-flex">
        <a class="navbar-brand" href="/">Next-gen Tech Edu</a>
      </div>
      

      
      <button type="button" class="navbar-toggler" data-toggle="collapse"
              data-target="#navbar-content" aria-controls="navbar-content" aria-expanded="false" aria-label="切换导航">
      <span><i class="fas fa-bars"></i></span>
      </button>
      

      
      <div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none">
        <a class="navbar-brand" href="/">Next-gen Tech Edu</a>
      </div>
      

      
      
      <div class="navbar-collapse main-menu-item collapse justify-content-start" id="navbar-content">

        
        <ul class="navbar-nav d-md-inline-flex">
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
          

          <li class="nav-item">
            <a class="nav-link " href="/books-gallery"><span>笔记（万篇）</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="/#knowledge-map"><span>知识图谱</span></a>
          </li>

          
          

          
          <style>
            .dropdown-item{
              display: inline-flex;
            }
          </style>
          <li class="nav-item dropdown">
            <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" aria-haspopup="true"><span>实验室</span><span class="caret"></span>
            </a>
            <div class="dropdown-menu">
              
                <a class="dropdown-item" href="/galaxy-home/gh-craft"><span>Craft 方块世界</span></a>
              
                <a class="dropdown-item" href="/galaxy-home/glossary-cards"><span>3D 知识卡牌</span></a>
              
            </div>
          </li>

          
          

          
          <style>
            .dropdown-item{
              display: inline-flex;
            }
          </style>
          <li class="nav-item dropdown">
            <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" aria-haspopup="true"><span>其他阅读渠道</span><span class="caret"></span>
            </a>
            <div class="dropdown-menu">
              
                <a class="dropdown-item" href="https://zhuanlan.zhihu.com/wxyyxc1992"><img style="width:16px;height:16px;display:inline-block;margin-right:8px" src="https://ngte-superbed.oss-cn-beijing.aliyuncs.com/item/20230218234451.png"></img><span>知乎</span></a>
              
                <a class="dropdown-item" href="https://segmentfault.com/blog/wxyyxc1992"><img style="width:16px;height:16px;display:inline-block;margin-right:8px" src="https://ngte-superbed.oss-cn-beijing.aliyuncs.com/item/20230219113556.png"></img><span>SegmentFault</span></a>
              
                <a class="dropdown-item" href="https://zhuanlan.zhihu.com/wxyyxc1992"><img style="width:16px;height:16px;display:inline-block;margin-right:8px" src="https://ngte-superbed.oss-cn-beijing.aliyuncs.com/item/20230219113519.png"></img><span>掘金</span></a>
              
            </div>
          </li>

          
          

        

          
        </ul>
      </div>

      <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">

        
        
        
        <li class="nav-item">
          <a class="nav-link js-search" href="#" aria-label="搜索"><i class="fas fa-search" aria-hidden="true"></i></a>
        </li>
        

        
        
        <li class="nav-item">
            <a class="nav-link" href="https://github.com/wx-chevalier" aria-label="GitHub"><i class="fa-brands fa-github" aria-hidden="true"></i></a>
        </li>
        

        
        
        

        
        
        
        <div></div>
        
        <style>
        @media only screen and (max-width: 600px) {
          .jimmysong-template {
            display: none!important;
          }
        }
        </style>
        
        <li class="jimmysong-template" style="color: white;font-size: 12px;">
          <a href="https://jimmysong.io" style="color: white">By Jimmy Song's Template</a>
        </li>
      </ul>

    </div>
  </nav>
</header>


  </div>

  <div class="page-body">
    
    
    

    




<link rel="stylesheet" href="//unpkg.com/heti/umd/heti.min.css">
<div class="container-xl docs">
  <div class="row flex-xl-nowrap">
    <div class="docs-sidebar">
      <form class="docs-search d-flex align-items-center">
  <button class="btn docs-toggle d-md-none p-0 mr-md-3 w-100" type="button" data-toggle="collapse" data-target="#docs-nav" aria-controls="docs-nav" aria-expanded="false" aria-label="Toggle section navigation">
    <div class="d-flex">
      <span class="d-md-none pl-1 flex-grow-1 text-left overflow-hidden">
        
          99.参考资料
        
      </span>
      <span><i class="fas fa-chevron-down"></i></span>
    </div>
  </button>

  
  <button class="form-control sidebar-search js-search d-none d-md-flex">
    <i class="fas fa-search pr-2"></i>
    <span class="sidebar-search-text">搜索...</span>
    <span class="sidebar-search-shortcut">/</span>
  </button>
  
</form>

<nav class="collapse docs-links" id="docs-nav">
  
  
  
  
  
  

  
  
    

    
      

      <ul class="nav docs-sidenav">
        <li style="display: inline-flex">
          <a style="cursor: pointer;" onclick="window.history.back()">
            <i class="fas fa-arrow-left pr-1"></i>
            Back
          </a>
          <span>|</span>
          <a href="/books/">
            <i class="fa-solid fa-house" style="margin-right: 4px"></i>
            Books
          </a>
        </li>
      </ul>

      
      
        
          
        
      



  
    
    
    
    
      
    
    

    
    
    
    
    
    <div class="docs-toc-item has-child">
    <div class="parent-node d-flex justify-content-between" onClick="Collapse(&#34;caret-id688d67ae8dba241ba955326ff430e912&#34;)" href="#id688d67ae8dba241ba955326ff430e912" aria-expanded="false" aria-controls="id688d67ae8dba241ba955326ff430e912" aria-hidden="false" data-toggle="collapse">
    
    <a class="d-inline docs-toc-link " href="/books/dataengineering-notes/01.%E5%A4%A7%E6%95%B0%E6%8D%AE%E4%BD%93%E7%B3%BB/">01.大数据体系</a>
    <a class="nav-toogle d-inline level" aria-hidden="false" data-toggle="collapse" href="#id688d67ae8dba241ba955326ff430e912" aria-expanded="false" aria-controls="id688d67ae8dba241ba955326ff430e912">
    
    <i class="fa-solid fa-angle-down" id="caret-id688d67ae8dba241ba955326ff430e912"></i>
    
    </a>
    
    </div>
    
      
      <ul class="nav docs-sidenav collapse  show " id="id688d67ae8dba241ba955326ff430e912">
      



  
    
    
    
    
      
    
    

    
    
    
    <div class="docs-toc-item has-child">
    <div class="parent-node d-flex justify-content-between" onClick="Collapse(&#34;caret-id7c65f64b8eb76395a58e4ebea0ca847b&#34;)" href="#id7c65f64b8eb76395a58e4ebea0ca847b" aria-expanded="false" aria-controls="id7c65f64b8eb76395a58e4ebea0ca847b" aria-hidden="false" data-toggle="collapse">
    
    <a class="d-inline docs-toc-link " href="/books/dataengineering-notes/01.%E5%A4%A7%E6%95%B0%E6%8D%AE%E4%BD%93%E7%B3%BB/01.%E5%A4%A7%E6%95%B0%E6%8D%AE%E7%94%9F%E6%80%81/">01.大数据生态</a>
    <a class="nav-toogle d-inline level" aria-hidden="false" data-toggle="collapse" href="#id7c65f64b8eb76395a58e4ebea0ca847b" aria-expanded="false" aria-controls="id7c65f64b8eb76395a58e4ebea0ca847b">
    
        <i class="fa-solid fa-angle-right" id="caret-id7c65f64b8eb76395a58e4ebea0ca847b"></i>
    
    </a>
    
    </div>
    
      
      <ul class="nav docs-sidenav collapse  " id="id7c65f64b8eb76395a58e4ebea0ca847b">
      



  
    
    
    
    
      
    
    

    
    
    
    <div class="docs-toc-item has-child">
    <div class="parent-node d-flex justify-content-between" onClick="Collapse(&#34;caret-ida46abe4f82b1b58f529ed294bb7e4db0&#34;)" href="#ida46abe4f82b1b58f529ed294bb7e4db0" aria-expanded="false" aria-controls="ida46abe4f82b1b58f529ed294bb7e4db0" aria-hidden="false" data-toggle="collapse">
    
    <a class="d-inline docs-toc-link " href="/books/dataengineering-notes/01.%E5%A4%A7%E6%95%B0%E6%8D%AE%E4%BD%93%E7%B3%BB/01.%E5%A4%A7%E6%95%B0%E6%8D%AE%E7%94%9F%E6%80%81/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/">99.参考资料</a>
    <a class="nav-toogle d-inline level" aria-hidden="false" data-toggle="collapse" href="#ida46abe4f82b1b58f529ed294bb7e4db0" aria-expanded="false" aria-controls="ida46abe4f82b1b58f529ed294bb7e4db0">
    
        <i class="fa-solid fa-angle-right" id="caret-ida46abe4f82b1b58f529ed294bb7e4db0"></i>
    
    </a>
    
    </div>
    
      
      <ul class="nav docs-sidenav collapse  " id="ida46abe4f82b1b58f529ed294bb7e4db0">
      



  <li class="child level "><a href="/books/dataengineering-notes/01.%E5%A4%A7%E6%95%B0%E6%8D%AE%E4%BD%93%E7%B3%BB/01.%E5%A4%A7%E6%95%B0%E6%8D%AE%E7%94%9F%E6%80%81/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2021-%E6%95%B0%E6%8D%AE%E5%BA%93%E9%A2%86%E5%9F%9F%E6%8A%95%E8%B5%84%E6%80%BB%E7%BB%93/">2021-数据库领域投资总结</a></li>

      
        </ul>
      
    

    
      </div>
    




  <li class="child level "><a href="/books/dataengineering-notes/01.%E5%A4%A7%E6%95%B0%E6%8D%AE%E4%BD%93%E7%B3%BB/01.%E5%A4%A7%E6%95%B0%E6%8D%AE%E7%94%9F%E6%80%81/%E4%B8%8D%E4%BD%9C%E6%81%B6/">不作恶</a></li>




  <li class="child level "><a href="/books/dataengineering-notes/01.%E5%A4%A7%E6%95%B0%E6%8D%AE%E4%BD%93%E7%B3%BB/01.%E5%A4%A7%E6%95%B0%E6%8D%AE%E7%94%9F%E6%80%81/%E5%A4%A7%E6%95%B0%E6%8D%AE%E7%9A%84%E6%9C%AA%E6%9D%A5/">大数据的未来</a></li>




  <li class="child level "><a href="/books/dataengineering-notes/01.%E5%A4%A7%E6%95%B0%E6%8D%AE%E4%BD%93%E7%B3%BB/01.%E5%A4%A7%E6%95%B0%E6%8D%AE%E7%94%9F%E6%80%81/%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%B9%B3%E5%8F%B0/">大数据平台</a></li>




  <li class="child level "><a href="/books/dataengineering-notes/01.%E5%A4%A7%E6%95%B0%E6%8D%AE%E4%BD%93%E7%B3%BB/01.%E5%A4%A7%E6%95%B0%E6%8D%AE%E7%94%9F%E6%80%81/%E5%A4%A7%E6%95%B0%E6%8D%AE%E7%94%9F%E6%80%81%E5%9C%88/">大数据生态圈</a></li>




  <li class="child level "><a href="/books/dataengineering-notes/01.%E5%A4%A7%E6%95%B0%E6%8D%AE%E4%BD%93%E7%B3%BB/01.%E5%A4%A7%E6%95%B0%E6%8D%AE%E7%94%9F%E6%80%81/%E6%95%B0%E6%8D%AE%E7%9A%84%E7%89%B9%E6%80%A7/">数据的特性</a></li>

      
        </ul>
      
    

    
      </div>
    




  
    
    
    
    
      
    
    

    
    
    
    <div class="docs-toc-item has-child">
    <div class="parent-node d-flex justify-content-between" onClick="Collapse(&#34;caret-id8892b7bbfac2eb73254e0632530a6b3e&#34;)" href="#id8892b7bbfac2eb73254e0632530a6b3e" aria-expanded="false" aria-controls="id8892b7bbfac2eb73254e0632530a6b3e" aria-hidden="false" data-toggle="collapse">
    
    <a class="d-inline docs-toc-link " href="/books/dataengineering-notes/01.%E5%A4%A7%E6%95%B0%E6%8D%AE%E4%BD%93%E7%B3%BB/02.%E6%95%B0%E6%8D%AE%E6%B2%BB%E7%90%86%E5%8E%9F%E5%88%99/">02.数据治理原则</a>
    <a class="nav-toogle d-inline level" aria-hidden="false" data-toggle="collapse" href="#id8892b7bbfac2eb73254e0632530a6b3e" aria-expanded="false" aria-controls="id8892b7bbfac2eb73254e0632530a6b3e">
    
        <i class="fa-solid fa-angle-right" id="caret-id8892b7bbfac2eb73254e0632530a6b3e"></i>
    
    </a>
    
    </div>
    
      
      <ul class="nav docs-sidenav collapse  " id="id8892b7bbfac2eb73254e0632530a6b3e">
      



  <li class="child level "><a href="/books/dataengineering-notes/01.%E5%A4%A7%E6%95%B0%E6%8D%AE%E4%BD%93%E7%B3%BB/02.%E6%95%B0%E6%8D%AE%E6%B2%BB%E7%90%86%E5%8E%9F%E5%88%99/%E6%95%B0%E6%8D%AE%E9%9B%B6%E6%95%A3%E5%8C%96/">数据零散化</a></li>




  <li class="child level "><a href="/books/dataengineering-notes/01.%E5%A4%A7%E6%95%B0%E6%8D%AE%E4%BD%93%E7%B3%BB/02.%E6%95%B0%E6%8D%AE%E6%B2%BB%E7%90%86%E5%8E%9F%E5%88%99/%E5%8E%9F%E5%88%99%E4%B8%8E%E8%A6%81%E7%B4%A0/">原则与要素</a></li>

      
        </ul>
      
    

    
      </div>
    




  
    
    
    
    
      
    
    

    
    
    
    <div class="docs-toc-item has-child">
    <div class="parent-node d-flex justify-content-between" onClick="Collapse(&#34;caret-id5a4dec46e635b0af59eba7771dd55b48&#34;)" href="#id5a4dec46e635b0af59eba7771dd55b48" aria-expanded="false" aria-controls="id5a4dec46e635b0af59eba7771dd55b48" aria-hidden="false" data-toggle="collapse">
    
    <a class="d-inline docs-toc-link " href="/books/dataengineering-notes/01.%E5%A4%A7%E6%95%B0%E6%8D%AE%E4%BD%93%E7%B3%BB/03.%E6%95%B0%E6%8D%AE%E7%BB%84%E7%BB%87%E6%96%B9%E5%BC%8F/">03.数据组织方式</a>
    <a class="nav-toogle d-inline level" aria-hidden="false" data-toggle="collapse" href="#id5a4dec46e635b0af59eba7771dd55b48" aria-expanded="false" aria-controls="id5a4dec46e635b0af59eba7771dd55b48">
    
        <i class="fa-solid fa-angle-right" id="caret-id5a4dec46e635b0af59eba7771dd55b48"></i>
    
    </a>
    
    </div>
    
      
      <ul class="nav docs-sidenav collapse  " id="id5a4dec46e635b0af59eba7771dd55b48">
      



  
    
    
    
    
      
    
    

    
    
    
    <div class="docs-toc-item has-child">
    <div class="parent-node d-flex justify-content-between" onClick="Collapse(&#34;caret-id30e6d039ebdbae81f5435ed950ff10fd&#34;)" href="#id30e6d039ebdbae81f5435ed950ff10fd" aria-expanded="false" aria-controls="id30e6d039ebdbae81f5435ed950ff10fd" aria-hidden="false" data-toggle="collapse">
    
    </div>
    

    
      </div>
    




  
    
    
    
    
      
    
    

    
    
    
    <div class="docs-toc-item has-child">
    <div class="parent-node d-flex justify-content-between" onClick="Collapse(&#34;caret-id7f2a491ba54eeb5fb23a87f97a8c257a&#34;)" href="#id7f2a491ba54eeb5fb23a87f97a8c257a" aria-expanded="false" aria-controls="id7f2a491ba54eeb5fb23a87f97a8c257a" aria-hidden="false" data-toggle="collapse">
    
    </div>
    

    
      </div>
    




  
    
    
    
    
      
    
    

    
    
    
    <div class="docs-toc-item has-child">
    <div class="parent-node d-flex justify-content-between" onClick="Collapse(&#34;caret-id285af7cb71df072f2fb8b2a2c2b7f697&#34;)" href="#id285af7cb71df072f2fb8b2a2c2b7f697" aria-expanded="false" aria-controls="id285af7cb71df072f2fb8b2a2c2b7f697" aria-hidden="false" data-toggle="collapse">
    
    <a class="d-inline docs-toc-link " href="/books/dataengineering-notes/01.%E5%A4%A7%E6%95%B0%E6%8D%AE%E4%BD%93%E7%B3%BB/03.%E6%95%B0%E6%8D%AE%E7%BB%84%E7%BB%87%E6%96%B9%E5%BC%8F/4.%E6%95%B0%E6%8D%AE%E4%B8%AD%E5%8F%B0/">4.数据中台</a>
    <a class="nav-toogle d-inline level" aria-hidden="false" data-toggle="collapse" href="#id285af7cb71df072f2fb8b2a2c2b7f697" aria-expanded="false" aria-controls="id285af7cb71df072f2fb8b2a2c2b7f697">
    
        <i class="fa-solid fa-angle-right" id="caret-id285af7cb71df072f2fb8b2a2c2b7f697"></i>
    
    </a>
    
    </div>
    
      
      <ul class="nav docs-sidenav collapse  " id="id285af7cb71df072f2fb8b2a2c2b7f697">
      



  
    
    
    
    
      
    
    

    
    
    
    <div class="docs-toc-item has-child">
    <div class="parent-node d-flex justify-content-between" onClick="Collapse(&#34;caret-idb2dc77c394996d516231246ac431487c&#34;)" href="#idb2dc77c394996d516231246ac431487c" aria-expanded="false" aria-controls="idb2dc77c394996d516231246ac431487c" aria-hidden="false" data-toggle="collapse">
    
    </div>
    

    
      </div>
    




  <li class="child level "><a href="/books/dataengineering-notes/01.%E5%A4%A7%E6%95%B0%E6%8D%AE%E4%BD%93%E7%B3%BB/03.%E6%95%B0%E6%8D%AE%E7%BB%84%E7%BB%87%E6%96%B9%E5%BC%8F/4.%E6%95%B0%E6%8D%AE%E4%B8%AD%E5%8F%B0/%E8%AF%84%E4%BB%B7%E7%BB%B4%E5%BA%A6/">评价维度</a></li>




  <li class="child level "><a href="/books/dataengineering-notes/01.%E5%A4%A7%E6%95%B0%E6%8D%AE%E4%BD%93%E7%B3%BB/03.%E6%95%B0%E6%8D%AE%E7%BB%84%E7%BB%87%E6%96%B9%E5%BC%8F/4.%E6%95%B0%E6%8D%AE%E4%B8%AD%E5%8F%B0/%E6%95%B0%E6%8D%AE%E6%A0%88/">数据栈</a></li>

      
        </ul>
      
    

    
      </div>
    




  
    
    
    
    
      
    
    

    
    
    
    <div class="docs-toc-item has-child">
    <div class="parent-node d-flex justify-content-between" onClick="Collapse(&#34;caret-id09c8a19061d5032d9fe38c6cbd64983f&#34;)" href="#id09c8a19061d5032d9fe38c6cbd64983f" aria-expanded="false" aria-controls="id09c8a19061d5032d9fe38c6cbd64983f" aria-hidden="false" data-toggle="collapse">
    
    </div>
    

    
      </div>
    

      
        </ul>
      
    

    
      </div>
    




  
    
    
    
    
      
    
    

    
    
    
    <div class="docs-toc-item has-child">
    <div class="parent-node d-flex justify-content-between" onClick="Collapse(&#34;caret-id0f3463c0399abf66dadb4f3d69de7a09&#34;)" href="#id0f3463c0399abf66dadb4f3d69de7a09" aria-expanded="false" aria-controls="id0f3463c0399abf66dadb4f3d69de7a09" aria-hidden="false" data-toggle="collapse">
    
    <a class="d-inline docs-toc-link " href="/books/dataengineering-notes/01.%E5%A4%A7%E6%95%B0%E6%8D%AE%E4%BD%93%E7%B3%BB/04.%E6%95%B0%E6%8D%AE%E4%B8%AD%E5%BF%83/">04.数据中心</a>
    <a class="nav-toogle d-inline level" aria-hidden="false" data-toggle="collapse" href="#id0f3463c0399abf66dadb4f3d69de7a09" aria-expanded="false" aria-controls="id0f3463c0399abf66dadb4f3d69de7a09">
    
        <i class="fa-solid fa-angle-right" id="caret-id0f3463c0399abf66dadb4f3d69de7a09"></i>
    
    </a>
    
    </div>
    
      
      <ul class="nav docs-sidenav collapse  " id="id0f3463c0399abf66dadb4f3d69de7a09">
      



  <li class="child level "><a href="/books/dataengineering-notes/01.%E5%A4%A7%E6%95%B0%E6%8D%AE%E4%BD%93%E7%B3%BB/04.%E6%95%B0%E6%8D%AE%E4%B8%AD%E5%BF%83/%E4%BA%91%E6%95%B0%E6%8D%AE%E4%B8%AD%E5%BF%83/">云数据中心</a></li>

      
        </ul>
      
    

    
      </div>
    




  
    
    
    
    
      
    
    

    
    
    
    
    
    <div class="docs-toc-item has-child">
    <div class="parent-node d-flex justify-content-between" onClick="Collapse(&#34;caret-id6cdb4d94773e0d67be63c7792c55e115&#34;)" href="#id6cdb4d94773e0d67be63c7792c55e115" aria-expanded="false" aria-controls="id6cdb4d94773e0d67be63c7792c55e115" aria-hidden="false" data-toggle="collapse">
    
    <a class="d-inline docs-toc-link " href="/books/dataengineering-notes/01.%E5%A4%A7%E6%95%B0%E6%8D%AE%E4%BD%93%E7%B3%BB/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/">99.参考资料</a>
    <a class="nav-toogle d-inline level" aria-hidden="false" data-toggle="collapse" href="#id6cdb4d94773e0d67be63c7792c55e115" aria-expanded="false" aria-controls="id6cdb4d94773e0d67be63c7792c55e115">
    
    <i class="fa-solid fa-angle-down" id="caret-id6cdb4d94773e0d67be63c7792c55e115"></i>
    
    </a>
    
    </div>
    
      
      <ul class="nav docs-sidenav collapse  show " id="id6cdb4d94773e0d67be63c7792c55e115">
      



  <li class="child level active"><a href="/books/dataengineering-notes/01.%E5%A4%A7%E6%95%B0%E6%8D%AE%E4%BD%93%E7%B3%BB/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2021-%E6%9D%BE%E5%AD%90-%E4%B8%80%E6%96%87%E9%81%8D%E5%8E%86%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%9E%B6%E6%9E%84%E5%8F%98%E8%BF%81%E5%8F%B2/">2021-松子-一文遍历大数据架构变迁史</a></li>




  <li class="child level "><a href="/books/dataengineering-notes/01.%E5%A4%A7%E6%95%B0%E6%8D%AE%E4%BD%93%E7%B3%BB/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2022-%E4%B8%80%E6%96%87%E8%AF%BB%E6%87%82%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93%E6%95%B0%E6%8D%AE%E5%B9%B3%E5%8F%B0%E6%95%B0%E6%8D%AE%E4%B8%AD%E5%8F%B0%E6%95%B0%E6%8D%AE%E6%B9%96%E7%9A%84%E6%A6%82%E5%BF%B5%E5%92%8C%E5%8C%BA%E5%88%AB/">2022-一文读懂数据仓库、数据平台、数据中台、数据湖的概念和区别</a></li>

      
        </ul>
      
    

    
      </div>
    

      
        </ul>
      
    

    
      </div>
    

    
  
</nav>

    </div>

    
    
    <div class="d-none d-xl-block col-xl-2 docs-toc">
      
     
      <ul class="nav toc-top">
        <li><a href="#" id="back_to_top" class="docs-toc-title">目录</a></li>
      </ul>
     

      <nav id="TableOfContents">
  <ul>
    <li><a href="#经典的-bill-inmon-和-ralph-kilmball-争论">经典的 BIll Inmon 和 Ralph kilmball 争论</a></li>
    <li><a href="#非互联网四代架构">非互联网四代架构</a>
      <ul>
        <li><a href="#第一代-edw-架构">第一代 edw 架构</a></li>
        <li><a href="#第二代大集市架构">第二代大集市架构</a></li>
        <li><a href="#第三代汇总维度集市-cif20-数仓结构">第三代汇总维度集市 &amp;CIF2.0 数仓结构</a></li>
        <li><a href="#第四代-opdm-操作实时数仓">第四代 OPDM 操作实时数仓</a></li>
      </ul>
    </li>
    <li><a href="#互联网的五代大数据处理架构">互联网的五代大数据处理架构</a>
      <ul>
        <li><a href="#第一代离线大数据统计分析技术架构">第一代离线大数据统计分析技术架构</a></li>
        <li><a href="#第二代流式架构">第二代流式架构</a></li>
        <li><a href="#第三代-lambda-大数据架构">第三代 Lambda 大数据架构</a></li>
        <li><a href="#kappa-大数据架构">Kappa 大数据架构</a></li>
        <li><a href="#unified-大数据架构">Unified 大数据架构</a></li>
        <li><a href="#iota-架构">IOTA 架构</a></li>
      </ul>
    </li>
    <li><a href="#总结">总结</a></li>
  </ul>
</nav>

      
<div class="subscribe-module col-24 mt-1">
    <img src="https://ngte-superbed.oss-cn-beijing.aliyuncs.com/item/20230220172727.png" alt="image" title="王下邀月熊的微信公众号"/>
</div>



    </div>
    

    <main class="py-md-3 pl-md-3 docs-content col-xl-8" role="main">

      <article class="article">

          

          <h1>2021-松子-一文遍历大数据架构变迁史</h1>

          <div class="article-style">
            <h1 id="一文遍历大数据架构变迁史">一文遍历大数据架构变迁史</h1>
<p>从现在的企业发展来看，大家的诉求重点已经从经营与分析转为数据化的精细运营。在如何做好精细化运营过程中，企业也面临着来自创新、发展、内卷等的各方面压力。随着业务量、数据量增长，大家对数据粒度需求从之前的高汇总逐渐转为过程化的细粒度明细数据，以及从 T+1 的数据转为近乎实时的数据诉求。大量的数据需求、海量的临时需求，让分析师、数据开发疲惫不堪。这些职位也变成了企业资源的瓶颈，传统 BI 中的 Report、OLAP 等工具也都无法满足互联网行业个性化的数据需求。大家开始考虑如何把需求固定为一个面向最终用户自助式、半自助的产品，来快速获取数据并分析得到结果，数据通过各类数据产品对外更有针对性的数据价值传递。</p>
<p>在这十几年中，影响数据仓库、数据平台、数据中台、数据湖的演进变革的因素也很多，比如不断快速迭代的业务模式与膨胀的群体规模所带来的数据量的冲击，新的大数据处理技术的驱动。还有落地在数据中台上各种数据产品的建设，比如工具化数据产品体系、各种自助式的数据产品、平台化各种数据产品的建设。这些数据建设能力的泛化，也让更多的大众参与数据中台的建设中 ，比如一些懂 SQL 的用户以及分析师参与数据平台直接建设比重增加 。还有一些原本数据中台具备的能力也有一些逐步地被前置到业务系统进行处理。</p>
<p>数据仓库在国外发展多年，于大约在 1998-1999 年传入中国。进入中国以后，发展出了很多专有名词，比如数据仓库、数据中心、数据平台、数据中台、数据湖等，从大数据架构角度来看可用三个时代九种架构来做总结，其中前四代是传统数据仓库时代的架构，后面五代是大数据架构模式。其中有两个承前启后的地方：</p>
<ul>
<li>一个特殊地方是，传统行业第三代架构与大数据第一代架构在架构形式上基本相似。传统行业的第三代架构可以算是用大数据处理技术重新实现了一遍。</li>
<li>传统行业第四代的架构中实时部分在现代用大数据实时方式做了新的落地。</li>
</ul>
<p>
















  <figure  >
    <div class="d-flex justify-content-center">
      <div class="w-100" ><img src="https://assets.ng-tech.icu/item/20230323161242.png" alt="大数据架构" loading="lazy" data-zoomable /></div>
    </div></figure></p>
<p>三个时代：非互联网、互联网、移动互联网时代，每一种时代的业务特点、数据量、数据类型各不相同，自然数据架构也是有显著差异的。</p>
<table>
<thead>
<tr>
<th>行业域</th>
<th>非互联网</th>
<th>互联网</th>
<th>移动互联网</th>
</tr>
</thead>
<tbody>
<tr>
<td>数据来源(相对于数据平台来讲)</td>
<td>结构化各类数据库(DB 系统)、结构化文本、Excel 表格等，少量 word</td>
<td>Web、自定义、系统的日志，各类结构化 DB 数据、长文本、视频 主要是来自网页</td>
<td>除了互联网那些外还含有大量定位数据、自动化传感器、嵌入式设备、自动化设备等</td>
</tr>
<tr>
<td>数据包含信息</td>
<td>CRM 客户信息、事务性 ERP/MRPII 数据、资金账务数据 等。</td>
<td>除了传统企业数据信息外，还含有用户各类点击日志、社交数据、多媒体、搜索、电邮数据等等</td>
<td>除了传统互联网的数据外，还含有 Gps、穿戴设备、传感器各类采集数据、自动化传感器采集数据等等</td>
</tr>
<tr>
<td>数据结构特性</td>
<td>几乎都是结构化数据</td>
<td>非结构化数据居多</td>
<td>非结构化数据居多</td>
</tr>
<tr>
<td>数据存储/数据量</td>
<td>主要以 DB 结构化存储为主，从几百兆到 百 G 级别</td>
<td>文件形式、DB 形式，流方式、 从 TB 到 PB</td>
<td>文件形式、流方式、DB 范式，非结构化 从 TB 到 PB</td>
</tr>
<tr>
<td>产生周期</td>
<td>慢，几天甚至周为单位</td>
<td>秒或更小为单位</td>
<td>秒或更小为单位</td>
</tr>
<tr>
<td>对消费者行为采集与还原</td>
<td>粒度粗</td>
<td>粒度较细</td>
<td>粒度非常细</td>
</tr>
<tr>
<td>数据价值</td>
<td>长期有效</td>
<td>随着时间衰减</td>
<td>随着时间快速衰减</td>
</tr>
</tbody>
</table>
<h1 id="从数据到大数据的数据架构总结">从数据到大数据的数据架构总结</h1>
<p>我自己对传统数据仓库的发展，简单抽象为为五个时代、四种架构（或许也不是那么严谨）。五个时代大概，按照两位数据仓库大师 Ralph kilmball、Bill Innmon 在数据仓库建设理念上碰撞阶段来作为小的分界线：</p>
<ul>
<li>大概在 1991 年之前，数据仓库的实施基本采用全企业集成的模式。</li>
<li>大概在 1992 年企业在数据仓库实施基本采用 EDW 的方式，Bill Innmon 博士出版了《如何构建数据仓库》，里面清晰的阐述了 EDW 架构与实施方式。</li>
<li>1994-1996 年是数据集市时代，这个时代另外一种维度建模、数据集市的方式较为盛行起来，其主要代表之一 Ralph Kimball 博士出版了他的第一本书“The DataWarehouse Toolkit”（《数据仓库工具箱》），里面非常清晰的定义了数据集市、维度建模。</li>
<li>大概在 1996-1997 年左右的两个架构竞争时代。</li>
<li>1998-2001 年左右的合并年代。</li>
</ul>
<p>在主要历史事件中提到了两位经典代表人物：Bill Innmon、Ralph kilmball。这两位在数据界可以算是元祖级别的人物。现在数据中台/平台的很多设计理念依然受到他俩 90 年代所提出方法论为依据。</p>
<h2 id="经典的-bill-inmon-和-ralph-kilmball-争论">经典的 BIll Inmon 和 Ralph kilmball 争论</h2>
<p>Bill Inmon 提出的遵循的是自上而下的建设原则，Ralph kilmball 提出自下而上的建设原则，两种方法拥护者会在不同场合争论哪一种方法论更有优势。两位大师对于建设方法争论要点：</p>
<ol>
<li>其中 Bill Inmon 的方法论：认为仅仅有数据集市是不够的，提倡先必须得从企业级的数据模型角度入手来构建。企业级模型就有较为完善的业务主题域划分、逻辑模型划分，在解决某个业务单元问题时可以很容易的选择不同数据路径来组成数据集市。后来数据仓库在千禧年传到中国后，几个大实施厂商都是遵守该原则的实施方法，也逐渐的演进成了现在大家熟悉的数据架构中关于数据层次的划分：</li>
</ol>
<ul>
<li>Ods-&gt; DW-&gt; ST-&gt;应用</li>
<li>Ods-&gt;DWD-&gt;DW-&gt;DM -&gt;应用</li>
<li>Ods-&gt;DWD-&gt;DWB-&gt;DWS -&gt;应用</li>
<li>Ods-&gt;DWD-&gt;DW-&gt;ST（ADM）-&gt;应用</li>
</ul>
<p>上个 10 年的国内实施数据仓库以及数据平台企业，有几家专业的厂商：IBM、Teradata、埃森哲、菲奈特 (被东南收购)、亚信等。这些厂商针对自己领域服务的客户，从方案特点等一系列角度出发，在实施中对 ODS 层、EDW、DM 等不同数据层逐步地赋予了各种不同的功能与含义。现在大家熟知的数据模型层次划分，基本上也是传承原有的 Bill Inmon 的方法论。</p>
<ol start="2">
<li>数据集市年代的代表人物为 Ralph kilmball，他的代表作是 《The Data Warehouse Toolkit》。这本书就是大名鼎鼎的《数据仓库工具箱》。企业级数据的建设方法主张自下而上建立数据仓库，极力推崇创建数据集市，认为数据仓库是数据集市的集合，信息总是被存储在多维模型中。这种思想从业务或部门入手，设计面向业务或部门主题数据集市。随着更多的不同业务或部门数据集市实施落地，此时企业可以根据需要来合并不同的数据集市，并逐步形成企业级的数据仓库，这种方式被称为自下而上(Botton-up)方法。这个方法在当时刚好与 Bill Innmon 的自上而下建设方法相反。</li>
</ol>
<table>
<thead>
<tr>
<th>类比</th>
<th>BIll Inmon 提出的方法论</th>
<th>Ralph kilmball 提出的方法论</th>
</tr>
</thead>
<tbody>
<tr>
<td>建设周期</td>
<td>需要花费大量时间</td>
<td>建设周期短、花费较少时间</td>
</tr>
<tr>
<td>维护难易度</td>
<td>容易维护</td>
<td>维护成本高</td>
</tr>
<tr>
<td>建设成本</td>
<td>前期投入大，后期建设成本低</td>
<td>前期投入较少，后续迭代成本与之前投入差不多</td>
</tr>
<tr>
<td>建设周期</td>
<td>周期长，见效慢</td>
<td>短、平、快</td>
</tr>
<tr>
<td>需要的团队类型</td>
<td>专业团队搭建</td>
<td>比较专业团队搭建，少量人参与</td>
</tr>
<tr>
<td>数据集成需求</td>
<td>全企业生命周期数据集成</td>
<td>企业垂直业务领域数据集成</td>
</tr>
<tr>
<td>面向用户群体</td>
<td>潜在的全企业用户</td>
<td>业务需求部门</td>
</tr>
<tr>
<td>专业术语</td>
<td>面向主题、随时间而变化、保留历史、数据集成</td>
<td>面向具体业务部门的一份比较窄的数据快照，维度建模、雪花模型、星型模型</td>
</tr>
<tr>
<td>数据模型</td>
<td>准三范式设计原则</td>
<td>星型结构、雪花结构</td>
</tr>
</tbody>
</table>
<p>随着数据仓库的不断实践与迭代发展，从争吵期进入到了合并的时代，其实争吵的结果要么一方妥协，要么新的结论出现。Bill inmon 与 Ralph kilmball 的争吵没有结论，干脆提出一种新的架构包含对方，也就是后来 Bill Inmon 提出的 CIF（corporation information factory）信息工厂的架构模式，这个架构模式将 Ralph kilmball 的数据集市包含了进来，有关两种数据仓库实施方法论的争吵才逐步地平息下来。</p>
<h2 id="非互联网四代架构">非互联网四代架构</h2>
<h3 id="第一代-edw-架构">第一代 edw 架构</h3>
<p>
















  <figure  >
    <div class="d-flex justify-content-center">
      <div class="w-100" ><img src="https://assets.ng-tech.icu/item/20230324172051.png" alt="第一代 EDW" loading="lazy" data-zoomable /></div>
    </div></figure></p>
<p>现在数据建设中使用到的“商业智能” 、“信息仓库”等很多专业术语、方法论，基本上是在上世纪 60 年代至 90 年代出现的。比如“维度模型”这个词是上世纪 60 年代 GM 与 Darmouth College 大学第一次提出， “DatawareHouse”、“事实” 是在上个世纪 70 年代 BIll Inmon 明确定义出来的，后来 90 年代 BIll Inmon 出版《如何构建数据仓库》一书更加体系化的与明确定义了如何构建数据仓库，这套方法在落地上形成了第一代数据仓库架构。</p>
<p>在第一代的数据仓库中，清晰地定义了数据仓库(Data Warehouse) 是一个面向主题的(Subject Oriented) 、集成的( Integrate ) 、相对稳定的(Non -Volatile ) 、反映历史变化( Time Variant) 的数据集合，用于支持管理决策（Decision Marking Support）。首先，数据仓库(Data Warehouse)是用来支持决策的、面向主题的用来支撑分析型数据处理的，这里有别于企业使用的数据库。数据库、数据仓库小的区别：</p>
<ul>
<li>数据库系统的设计目标是事务处理。数据库系统是为记录更新和事务处理而设计，数据的访问的特点是基于主键，大量原子，隔离的小事务，并发和可恢复是关键属性，最大事务吞吐量是关键指标，因此数据库的设计都反映了这些需求。</li>
<li>数据仓库的设计目标是决策支持。历史的、摘要的、聚合的数据比原始的记录重要的多。查询负载主要集中在即席查询和包含连接，聚合等复杂查询操作上。</li>
<li>其次，数据仓库(Data Warehouse)是对多种异构数据源进行有效集成与处理，是按照主题的方式对数据进行重新整合，且包一般不怎么修改的历史数据，一句话总结面向主题、集成性、稳定性和时变性。</li>
</ul>
<p>数据仓库(Data Warehouse)从特点上来看：</p>
<ul>
<li>数据仓库是面向主题的。</li>
<li>数据仓库是集成的，数据仓库的数据有来自于分散的操作型数据，将所需数据从原来的数据中抽取出来，进行加工与集成，统一与综合之后才能进入数据仓库。</li>
<li>数据仓库是不可更新的，数据仓库主要是为决策分析提供数据，所涉及的操作主要是数据的查询。</li>
<li>数据仓库是随时间而变化的，传统的关系数据库系统比较适合处理格式化的数据，能够较好的满足商业商务处理的需求，它在商业领域取得了巨大的成功。</li>
</ul>
<p>数据仓库和数据库系统的区别，一言蔽之：OLAP 和 OLTP 的区别。数据库支持是 OLTP，数据仓库支持的是 OLAP。</p>
<h3 id="第二代大集市架构">第二代大集市架构</h3>
<p>
















  <figure  >
    <div class="d-flex justify-content-center">
      <div class="w-100" ><img src="https://assets.ng-tech.icu/item/20230324172644.png" alt="第二代大集市架构" loading="lazy" data-zoomable /></div>
    </div></figure></p>
<p>第二代就是 Ralph kilmball 的大集市的架构。第二代架构基本可以成为总线型架构，从业务或部门入手，设计面向业务或部门主题数据集市。Kilmball 的这种构建方式可以不用考虑其它正在进行的数据类项目实施，只要快速满足当前部门的需求即可，这种实施的好处是阻力较小且路径很短。但是考虑到在实施中可能会存在多个并行的项目，是需要在数据标准化、模型阶段是需要进行维度归一化处理，需要有一套标准来定义公共维度，让不同的数据集市项目都遵守相同的标准，在后面的多个数据集市做合并时可以平滑处理。比如业务中相似的名词、不同系统的枚举值、相似的业务规则都需要做统一命名，这里在现在的中台就是全域统一 ID 之类的东西。</p>
<p>主要核心：</p>
<ul>
<li>一致的维度，以进行集成和全面支持。一致的维度具有一致的描述性属性名称、值和含义。</li>
<li>一致的事实是一致定义的；如果不是一致的业务规则，那么将为其指定一个独特的名称。业务中相似的名词、不同系统的枚举值、相似的业务规则都需要做统一命名。</li>
<li>建模方式：星型模型、雪花模型。</li>
</ul>
<h3 id="第三代汇总维度集市-cif20-数仓结构">第三代汇总维度集市 &amp;CIF2.0 数仓结构</h3>
<p>
















  <figure  >
    <div class="d-flex justify-content-center">
      <div class="w-100" ><img src="https://assets.ng-tech.icu/item/20230324173843.png" alt="汇总维度集市的标准数据仓库" loading="lazy" data-zoomable /></div>
    </div></figure></p>
<p>
















  <figure  >
    <div class="d-flex justify-content-center">
      <div class="w-100" ><img src="https://assets.ng-tech.icu/item/20230324173921.png" alt="第三代 cif 2.0 架构" loading="lazy" data-zoomable /></div>
    </div></figure></p>
<p>CIF（corporation information factor）信息工厂（作者备注，关于 Cif 的英文版文章名字 Corporate Information Factory (CIF) Overview），Bill Inmon 认为企业的发展会随着信息资源重要性会逐步的提升，会出现一种信息处理架构，类似工厂一样能满足所有信息的需求与请求。这个信息工厂的功能包含了数据存储与处理（活跃数据、沉默数据），支持跨部门甚至跨企业的数据访问与整合，同时也要保证数据安全性等。刚好 CIF 架构模式也逐步的变成了数据仓库第三代架构。为什么把这个 CIF 架构定义成一个经典架构呢，因为 CIF 的这种架构总结了前面提到的两种架构的同时，又把架构的不同层次定义得非常明确。</p>
<p>例如 CIF 2.0 主要包括集成转换层（Integrated and Transformation Layer）、操作数据存储（Operational Data Store）、数据仓库（Enterprise Data Warehouse）、数据集市（Data Mart）、探索仓库（Exploration Warehouse）等部件。Data Mart 分为后台（Back Room）和前台（Front Room）两部分。后台主要负责数据准备工作，称为数据准备区（Staging Area），前台主要负责数据展示工作，称为数据集市（Data Mart）。</p>
<p>这个经典的架构在后来 2006 年~2012 年进入到这个领域的从业者，乃至现在有些互联网企业的数据平台架构也是相似的。</p>
<h3 id="第四代-opdm-操作实时数仓">第四代 OPDM 操作实时数仓</h3>
<p>
















  <figure  >
    <div class="d-flex justify-content-center">
      <div class="w-100" ><img src="https://assets.ng-tech.icu/item/20230324174555.png" alt="OPDM 操作实时数仓" loading="lazy" data-zoomable /></div>
    </div></figure></p>
<p>OPDM 大约是在 2011 年提出来的，严格上来说，Opdm 操作型数据集市（仓库）是实时数据仓库的一种，他更多的是面向操作型数据而非历史数据查询与分析。在这里很多人会问到什么是操作型数据？比如财务系统、CRM 系统、营销系统生产系统，通过某一种机制实时的把这些数据在各数据孤岛按照业务的某个层次有机的自动化整合在一起，提供业务监控与指导。</p>
<h2 id="互联网的五代大数据处理架构">互联网的五代大数据处理架构</h2>
<p>在文章的开头有提过，传统行业第三代架构与大数据第一代架构在架构形式上基本相似，只不过是通过大数据的处理技术尝试对传统第三架构进行落地的。比如说在 Hadoop&amp;Hive 刚兴起的阶段，有用 SyaseIQ、Greenplum 等技术来作为大数据处理技术，后来 Hadoop&amp;hive 以及 Facebook Scribe、Linkedin kafka 等逐步开源后又产生了新的适应互联网大数据的架构模式。</p>
<p>后续阿里巴巴淘系的 TimeTunnel 等更多的近百种大数据处理的开源技术，进一步促进了整个大数据处理架构与技术框架的发展，我在后面会给出一个比较完善截止到目前所有技术的数据处理框架。按照大数据的使用场景、数据量、数据的类型，在架构上也基本上分为流式处理技术框架、批处理技术框架等， 所以互联网这五代的大数据处理框架基本上是围绕着批处理、流式处理以及混合型架构这三种来做演进。</p>
<h3 id="第一代离线大数据统计分析技术架构">第一代离线大数据统计分析技术架构</h3>
<p>
















  <figure  >
    <div class="d-flex justify-content-center">
      <div class="w-100" ><img src="https://assets.ng-tech.icu/item/20230324174903.png" alt="离线统计分析技术架构" loading="lazy" data-zoomable /></div>
    </div></figure></p>
<p>这个结构与第三代的数据处理架构非常相似，具体如下图所示：</p>
<table>
<thead>
<tr>
<th>数据阶段</th>
<th>传统行业第三代架构</th>
<th>第一代离线大数据统计架构</th>
</tr>
</thead>
<tbody>
<tr>
<td>数据源</td>
<td>结构化数据为主(数据库数据、内部办公数据、财务数据等)、非结构化数据很少或者是没有</td>
<td>结构化数据为主(数据库数据、内部办公数据、财务数据等)、结构化数据开始多起来</td>
</tr>
<tr>
<td>数据处理</td>
<td>名词：ETL 为主，在数据如中央仓库之前已经开始很多的数据转换、归一化的处理技术：Datastage、informa、Dts、C、脚本等等</td>
<td>名词：ELT 为主，主要是数据采集传输与归集、很少做数据归一化以及转换处理 。主要是把数据先归集到中央库自作处理技术：kafka、Datax 等</td>
</tr>
<tr>
<td>数据中央处理</td>
<td>技术：Oracle、DB2、SybaseIQ、Teradata 数据模型：维度模型、准三范式</td>
<td>技术：hadoop、hive、spark 数据模型：维度模型、大宽表等</td>
</tr>
<tr>
<td>数据应用</td>
<td>成型的解决方案产品：Report、OLAP、在线分析等</td>
<td>成型的软件产品变少、开源技术、自助研发产品变多起来</td>
</tr>
</tbody>
</table>
<h3 id="第二代流式架构">第二代流式架构</h3>
<p>
















  <figure  >
    <div class="d-flex justify-content-center">
      <div class="w-100" ><img src="https://assets.ng-tech.icu/item/20230325140925.png" alt="流式技术架构" loading="lazy" data-zoomable /></div>
    </div></figure></p>
<p>流式的应用场景非常广泛， 比如搜索、推荐、信息流等都是在线化的，对数据实时性的要求变更高，自然计算与使用是同步进行的。随着业务的复杂化，数据的处理逻辑更加复杂，比如各种维度交叉、关联、聚类，以及需要更多算法或机器学习。这些应用场景可以完全地分为两类：事件流、持续计算。</p>
<ul>
<li>事件流，就是业务相对固定，只是数据在业务的规则下不断的变化。</li>
<li>持续计算，适合购物网站等场景。</li>
</ul>
<p>流失处理架构比上一代离线处理框架相比省掉了原有的 ETL/ELT 过程，数据流留过数据处理通道并进行实时处理与计算，处理结果通过消息的方式推送数据消费者。流式计算框架舍弃了大数据离线批量处理模式，只有很少的数据存储，所以数据保存周期非常短。如果有历史数据场景或很复杂历史数据参与计算的场景，实现起来难度就比较大。</p>
<p>现在一些场景，会把流式计算的结果数据周期性地存到批处理的数据存储区域。如果有场景需要使用历史数据，流式计算框架会把保存的历史结果用更新的方式进行加载，再做进一步处理。</p>
<h3 id="第三代-lambda-大数据架构">第三代 Lambda 大数据架构</h3>
<p>
















  <figure  >
    <div class="d-flex justify-content-center">
      <div class="w-100" ><img src="https://assets.ng-tech.icu/item/20230325141204.png" alt="Lambda 技术架构整体" loading="lazy" data-zoomable /></div>
    </div></figure></p>
<p>Lambda 架构是由 Twitter 工程师南森·马茨（Nathan Marz）提出的，是一种经典的、实施广泛的技术架构。后来出现的其他大数据处理架构也是 Lambda 架构的优化或升级版。Lambda 架构有两条数据链路，一条兼顾处理批量、离线数据结构，一条是实时流式处理技术 。</p>
<ul>
<li>批量离线处理流在构建时大部分还是采用一些经典的大数据统计分析方法论，在保证数据一致性、完整性的同时还会对数据按照不同应用场景进行分层。</li>
<li>实时流式处理主要是增量计算，也会跑一些机器学习模型等。为了保证数据的一致性， 实时流处理结果与批量处理结果会有一个合并动作。</li>
</ul>
<p>Lambda 架构主要的组成是批处理、流式处理、数据服务层这三部分。</p>
<ul>
<li>批处理层(Bathchlayer)：Lambda 架构核心层之一，批处理接收过来的数据，并保存到相应的数据模型中，这一层的数据主题、模型设计的方法论是继承面向统计分析离线大数据中的。而且一般都会按照比较经典的 ODS、DWD、DWB、ST/ADM 的层次结构来划分。</li>
<li>流式处理层(Speed Layer)：Lambda 另一个核心层，为了解决比如各场景下数据需要一边计算一边应用以及各种维度交叉、关联的事件流与持续计算的问题，计算结果在最后与批处理层的结果做合并。</li>
<li>服务层(Serving layer)：这是 Lambda 架构的最后一层，服务层的职责是获取批处理和流处理的结果，向用户提供统一查询视图服务。</li>
</ul>
<p>Lamabda 架构理念从出现到发展这么多年，优缺点非常明显。比如稳定与性能上的优势，ETL 处理计算利用晚上时间来做，能复用部分实时计算的资源。劣势，两套数据流因为结果要做合并，所有的算法要实现两次，一次是批处理、一次是实时计算，最终两个结果还得做合并显得会很复杂。</p>
<h3 id="kappa-大数据架构">Kappa 大数据架构</h3>
<p>
















  <figure  >
    <div class="d-flex justify-content-center">
      <div class="w-100" ><img src="https://assets.ng-tech.icu/item/20230325142150.png" alt="Kappa 大数据架构" loading="lazy" data-zoomable /></div>
    </div></figure></p>
<p>在 Lamadba 架构下需要维护两套的代码，为了解决这个问题，LinkedIn 公司的 Jay Kreps 结合实际经验与个人思考提出了 Kappa 架构。Kappa 架构核心是通过改进流式计算架构的计算、存储部分来解决全量的问题，使得实时计算、批处理可以共用一套代码。Kappa 架构认为对于历史数据的重复计算几率是很小的，即使需要，可以通过启用不同的实例的方式来做重复计算。其中 Kappa 的核心思想是：</p>
<ul>
<li>用 Kafka 或者类似 MQ 队列系统收集各种各样的数据，需要几天的数据量就保存几天。</li>
<li>当需要全量重新计算时，重新起一个流计算实例，从头开始读取数据进行处理，并输出到一个新的结果存储中。</li>
<li>当新的实例做完后，停止老的流计算实例，并把一些老的结果删除。</li>
</ul>
<p>Kappa 架构的优点在于将实时和离线代码统一起来，方便维护而且统一了数据口径。Kappa 架构与 Lamabda 架构相比，其优缺点是：</p>
<ul>
<li>Lambda 架构需要维护两套跑在批处理和实时流上的代码，两个结果还需要做 merge， Kappa 架构下只维护一套代码，在需要时候才跑全量数据。</li>
<li>Kappa 架构下可以同时启动很多实例来做重复计算，有利于算法模型调整优化与结果对比，Lamabda 架构下，代码调整比较复杂。所以 kappa 架构下，技术人员只需要维护一个框架就可以，成本很小。</li>
<li>kappa 每次接入新的数据类型格式是需要定制开发接入程序，接入周期会变长。</li>
<li>Kappa 这种架构过度依赖于 Redis、Hbase 服务，两种存储结构又不是满足全量数据存储的，用来做全量存储会显得浪费资源。</li>
</ul>
<h3 id="unified-大数据架构">Unified 大数据架构</h3>
<p>
















  <figure  >
    <div class="d-flex justify-content-center">
      <div class="w-100" ><img src="https://assets.ng-tech.icu/item/20230325142342.png" alt="Unified 大数据架构" loading="lazy" data-zoomable /></div>
    </div></figure></p>
<p>“Unifield 架构则更激进，将机器学习和数据处理整合为一体，Unifield 在 Lambda 基础上进行升级，在流处理层新增了机器学习层。数据经过数据通道进入数据湖，新增了模型训练部分，并且将其在流式层进行使用。同时流式层不单使用模型，也包含着对模型的持续训练。”</p>
<h3 id="iota-架构">IOTA 架构</h3>
<p>IOTA 大数据架构是一种基于 AI 生态下的、全新的数据架构模式，这个概念由易观于 2018 年首次提出。IOTA 的整体思路是设定标准数据模型，通过边缘计算技术把所有的计算过程分散在数据产生、计算和查询过程当中，以统一的数据模型贯穿始终，从而提高整体的计算效率，同时满足计算的需要，可以使用各种 Ad-hoc Query 来查询底层数据。</p>
<p>主要有几个特点：</p>
<ul>
<li>去 ETL 化：ETL 和相关开发一直是大数据处理的痛点，IOTA 架构通过 Common Data Model 的设计，专注在某一个具体领域的数据计算，从而可以从 SDK 端开始计算，中央端只做采集、建立索引和查询，提高整体数据分析的效率。</li>
<li>Ad-hoc 即时查询：鉴于整体的计算流程机制，在手机端、智能 IOT 事件发生之时，就可以直接传送到云端进入 real time data 区，可以被前端的 Query Engine 来查询。此时用户可以使用各种各样的查询，直接查到前几秒发生的事件，而不用在等待 ETL 或者 Streaming 的数据研发和处理。</li>
<li>边缘计算（Edge-Computing）：将过去统一到中央进行整体计算，分散到数据产生、存储和查询端，数据产生既符合 Common Data Model。同时，也给与 Realtime model feedback，让客户端传送数据的同时马上进行反馈，而不需要所有事件都要到中央端处理之后再进行下发。</li>
</ul>
<h2 id="总结">总结</h2>
<p>大数据架构的每一代的定义与出现是有必然性的， 当然没有一个严格上的时间区分点。直接给出一个每种架构比较：</p>
<table>
<thead>
<tr>
<th><strong>架构</strong></th>
<th><strong>优点</strong></th>
<th><strong>缺点</strong></th>
<th><strong>适用场景</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>离线大数据统计分析技术架构</td>
<td>简单，易懂，对于 BI 系统来说，基本思想没有发生变化，变化的仅仅是技术选型，用大数据架构替换掉 BI 的组件。</td>
<td>对于大数据来说，没有 BI 下如此完备的 Cube 架构，虽然目前有 kylin，但是 kylin 的局限性非常明显，远远没有 BI 下的 Cube 的灵活度和稳定度，因此对业务支撑的灵活度不够，所以对于存在大量报表，或者复杂的钻取的场景，需要太多的手工定制化，同时该架构依旧以批处理为主，缺乏实时的支撑。</td>
<td>数据分析需求依旧以 BI 场景为主，但是因为数据量、性能等问题无法满足日常使用。</td>
</tr>
<tr>
<td>流式架构</td>
<td>没有臃肿的 ETL 过程，数据的实效性非常高。</td>
<td>对于流式架构来说，不存在批处理，因此对于数据的重播和历史统计无法很好的支撑。对于离线分析仅仅支撑窗口之内的分析。</td>
<td>预警，监控，对数据有有实时性要求的场景。</td>
</tr>
<tr>
<td>Lambda 架构</td>
<td>既有实时又有离线，对于数据分析场景涵盖的非常到位。</td>
<td>离线层和实时流虽然面临的场景不相同，但是其内部处理的逻辑却是相同，因此有大量荣誉和重复的模块存在。</td>
<td>同时存在实时和离线需求的情况。</td>
</tr>
<tr>
<td>Kappa 架构</td>
<td>Kappa 架构解决了 Lambda 架构里面的冗余部分，以数据可重播的超凡脱俗的思想进行了设计，整个架构非常简洁。</td>
<td>虽然 Kappa 架构看起来简洁，但是实施难度相对较高，尤其是对于数据重播部分。</td>
<td>和 Lambda 类似，改架构是针对 Lambda 的优化。</td>
</tr>
<tr>
<td>Unifield 架构</td>
<td>Unifield 架构提供了一套数据分析和机器学习结合的架构方案，非常好的解决了机器学习如何与数据平台进行结合的问题。</td>
<td>Unifield 架构实施复杂度更高，对于机器学习架构来说，从软件包到硬件部署都和数据分析平台有着非常大的差别，因此在实施过程中的难度系数更高。</td>
<td>有着大量数据需要分析，同时对机器学习方便又有着非常大的需求或者有规划。</td>
</tr>
<tr>
<td>IOTA 架构</td>
<td>去 ETL 化、支持 Ad-hoc 即时查询和边缘计算。</td>
<td>代码漏洞较多，通过收费方式向社区提供漏洞修复代码。</td>
<td>IOTA 用于物联网设备，实现万物互联、系统自治。</td>
</tr>
</tbody>
</table>
<h1 id="大数据处理技术栈">大数据处理技术栈</h1>
<p>
















  <figure  >
    <div class="d-flex justify-content-center">
      <div class="w-100" ><img src="https://assets.ng-tech.icu/item/20230325143204.png" alt="大数据处理技术栈" loading="lazy" data-zoomable /></div>
    </div></figure></p>
<ul>
<li>按照数据采集-传输-落地到存储层，再通过调度调起计算数据处理任务把整合结果数据存到数据仓库以及相关存储区域中。</li>
<li>通过管理层/ide 进行数据管理或数据开发。</li>
<li>通过 OLAP 、分析、算法、可视化、微服务层对外提供数据服务与数据场景化应用。</li>
</ul>
<p>这个技术栈暂时没有按照没有按照批处理、流式技术的分类的角度来分类，稍微有点遗憾。</p>

          </div>

          



          
          
          <div class="article-widget">
            
<div class="container-xl row post-nav">
  
  
  
  <div class="col-6 post-nav-item">
    <div class="meta-nav">下一页</div>
    <a href="/books/dataengineering-notes/01.%E5%A4%A7%E6%95%B0%E6%8D%AE%E4%BD%93%E7%B3%BB/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2022-%E4%B8%80%E6%96%87%E8%AF%BB%E6%87%82%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93%E6%95%B0%E6%8D%AE%E5%B9%B3%E5%8F%B0%E6%95%B0%E6%8D%AE%E4%B8%AD%E5%8F%B0%E6%95%B0%E6%8D%AE%E6%B9%96%E7%9A%84%E6%A6%82%E5%BF%B5%E5%92%8C%E5%8C%BA%E5%88%AB/" rel="prev">2022-一文读懂数据仓库、数据平台、数据中台、数据湖的概念和区别</a>
  </div>
  
</div>

          </div>
          

        <div class="body-footer">
          <p>最近更新于 0001-01-01</p>

          



          


  
  
  

  

  
  <section id="comments" class="mb-3 pt-0">
    
<div id="disqus_thread"></div>
<script>
  var disqus_config = function () {
    
    
    
  };
  (function() {
    if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
      document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
      return;
    }
    var d = document, s = d.createElement('script'); 
    s.async = true;
    s.src = 'https://' + "ngte" + '.disqus.com/embed.js';
    
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
  })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>


  </section>
  



          


        </div>

      </article>

      <footer class="site-footer">

  



  

  
  <div class="copyright py-4 bg-footer">
      <div class="row justify-content-center">
        <div class="text-center footer-color">
          <p class="mb-0">© 2017-2022 NGTE all rights reserved</p>
        </div>
    </div>
  </div>

  <script type="text/javascript" id="clstr_globe" async src="//clustrmaps.com/globe.js?d=kgpJG5sWZQpKujBmD-uW1B54-WBPol-DuDtrB2KFjKs"></script>
  
</footer>


    </main>
  </div>
</div>
<script src="//unpkg.com/heti/umd/heti-addon.min.js"></script>
<script>
  const heti = new Heti('.article');
  heti.autoSpacing();
</script>
<script type="text/javascript">
  window.$crisp = [];
  window.CRISP_WEBSITE_ID = "12adcc35-9621-4313-8262-62dc654b29d8";
  (function () {
    setTimeout(function() {
      d = document;
      s = d.createElement("script");
      s.src = "https://client.crisp.chat/l.js";
      s.async = 1;
      d.getElementsByTagName("head")[0].appendChild(s);
    }, 2500);
  })();
</script>
  </div>

  <div class="page-footer">
    
    
  </div>

      

    
    <script src="/js/vendor-bundle.min.d26509351aa0ff874abbee824e982e9b.js"></script>

    
    
    
      

      
      

      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.1/highlight.min.js" integrity="sha512-Ypjm0o7jOxAd4hpdoppSEN0TQOC19UtPAqD+4s5AlXmUvbmmS/YMxYqAqarQYyxTnB6/rqip9qcxlNB/3U9Wdg==" crossorigin="anonymous"></script>
        
        
      

    

    
    
    

    
    
    
      
      <script id="search-hit-algolia-template" type="text/html">
        <div class="search-hit">
          <div class="search-hit-content">
            <div class="search-hit-name">
              <a href="{{relpermalink}}">{{#helpers.highlight}}{ "attribute": "title" }{{/helpers.highlight}}</a>
            </div>
            <div class="article-metadata search-hit-type">{{type}}</div>
            <p class="search-hit-description">{{#helpers.highlight}}{ "attribute": "summary" }{{/helpers.highlight}}</p>
          </div>
        </div>
      </script>
      
        <script src="https://cdn.jsdelivr.net/npm/instantsearch.js@4/dist/instantsearch.production.min.js" crossorigin="anonymous"></script>
      
      
    

    
    

    
    
    
    
      <script id="dsq-count-scr" src="https://ngte.disqus.com/count.js" async></script>
      
    

    
    
      
      
      
      
      
      
      
    

    
    <script src="/zh/js/algolia-search-built.min.4387d694ca1258194aaf562b8cd1c400.js" type="module"></script>
    

    
    
    
    <script id="page-data" type="application/json">{"use_headroom":false}</script>

    
    
    
    
    
    
    
    
    
    
    <script src="/zh/js/wowchemy.min.d1673c7a11d1238516cbe12a1e84257f.js"></script>

    
    
    
    
    
    
    <script>

var mybutton = document.getElementById("backTopBtn");


window.onscroll = function() {scrollFunction()};

function scrollFunction() {
  if (document.body.scrollTop > 20 || document.documentElement.scrollTop > 20) {
    mybutton.style.display = "block";
  } else {
    mybutton.style.display = "none";
  }
}


function topFunction() {
  document.body.scrollTop = 0;
  document.documentElement.scrollTop = 0;
}
</script>


    

    
    
    <script src="https://cdn.jsdelivr.net/gh/bryanbraun/anchorjs@4.2.2/anchor.min.js" integrity="sha512-I7w3ZdSFzw5j3jU3ZkNikBNeIrl3i+hEuEdwNmqUJvwNcaBUNcijnP2gd9DtGlgVYDplfjGoD8vTNsID+lCjqg==" crossorigin="anonymous"></script>
    <script>
      anchors.add();
    </script>
    

    
    <script>



(function() {
  'use strict';

  if(!document.queryCommandSupported('copy')) {
    return;
  }

  function flashCopyMessage(el, msg) {
    el.className = "highlight-copy-btn";
    el.textContent = msg;
    setTimeout(function() {
      el.textContent = "";
      el.className = "highlight-copy-btn fa fa-copy";
    }, 1000);
  }

  function selectText(node) {
    var selection = window.getSelection();
    var range = document.createRange();
    range.selectNodeContents(node);
    selection.removeAllRanges();
    selection.addRange(range);
    return selection;
  }

  function addCopyButton(containerEl) {
    var copyBtn = document.createElement("button");
    copyBtn.className = "highlight-copy-btn fa fa-copy";
    copyBtn.textContent = "";

    var codeEl = containerEl.firstElementChild;
    copyBtn.addEventListener('click', function() {
      try {
        var selection = selectText(codeEl);
        document.execCommand('copy');
        selection.removeAllRanges();
        
        flashCopyMessage(copyBtn, '已复制')
        
      } catch(e) {
        console && console.log(e);
        flashCopyMessage(copyBtn, 'Failed :\'(')
      }
    });

    containerEl.appendChild(copyBtn);
  }

  
  var highlightBlocks = document.getElementsByClassName('highlight');
  Array.prototype.forEach.call(highlightBlocks, addCopyButton);
})();
</script>

    


</body>
</html>
