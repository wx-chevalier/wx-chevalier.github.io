<!doctype html><html lang=zh><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=generator content="Wowchemy 5.5.0 for Hugo"><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=preload as=style href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap"><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap" media=print onload='this.media="all"'><meta name=google-site-verification content="google69a5cccb61297807"><meta name=baidu-site-verification content="cqmZHEleVh"><meta name=description content="用户追踪 White Ops 这里我们以 White Ops 为例，介绍实际场景下如何通过用户浏览器特性分析来进行用户追踪： Communicates with vprza.com and minkatu.com Does device/OS detection Attempts to detect if DevTools is open (looks at __IE_DEVTOOLBAR_CONSOLE_COMMAND_LINE) Something weird with the text-underline-offset CSS property Has the names of a bunch of ad servers, presumably as to not serve ads to bots Attempts to create an ActiveXObject (only exists in old IE versions), and checks if"><link rel=alternate hreflang=zh href=https://ng-tech.icu/books/web-tuning-series/%E6%80%A7%E8%83%BD%E7%9B%91%E6%8E%A7%E4%B8%8E%E7%B3%BB%E7%BB%9F%E5%8C%96/%E5%BC%82%E5%B8%B8%E7%9B%91%E6%8E%A7%E4%B8%8E%E5%88%86%E6%9E%90/%E7%94%A8%E6%88%B7%E8%A1%8C%E4%B8%BA%E5%88%86%E6%9E%90/%E7%94%A8%E6%88%B7%E8%BF%BD%E8%B8%AA/><meta name=theme-color content="#0a55a7"><link rel=stylesheet href=/css/vendor-bundle.min.c7b8d9abd591ba2253ea42747e3ac3f5.css media=print onload='this.media="all"'><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.1/styles/github.min.css crossorigin=anonymous title=hl-light media=print onload='this.media="all"'><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.1/styles/dracula.min.css crossorigin=anonymous title=hl-dark media=print onload='this.media="all"' disabled><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/instantsearch.css@7.4.5/themes/satellite-min.css integrity="sha256-TehzF/2QvNKhGQrrNpoOb2Ck4iGZ1J/DI4pkd2oUsBc=" crossorigin=anonymous><link rel=stylesheet href=/css/wowchemy.63df6ae9fc2b4cc71b83f1774d780209.css><script async src="https://www.googletagmanager.com/gtag/js?id=G-40NYXJ8823"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-40NYXJ8823")</script><script>var _hmt=_hmt||[];(function(){var e,t=document.createElement("script");t.src="https://hm.baidu.com/hm.js?56df1177bce405601b0ecdd7208f75c6",e=document.getElementsByTagName("script")[0],e.parentNode.insertBefore(t,e)})()</script><link rel=manifest href=/manifest.webmanifest><link rel=icon type=image/png href=/media/icon_hu0f7d075e895d6f5f1f5fdbc1e33dc138_10087_32x32_fill_lanczos_center_3.png><link rel=apple-touch-icon type=image/png href=/media/icon_hu0f7d075e895d6f5f1f5fdbc1e33dc138_10087_180x180_fill_lanczos_center_3.png><link rel=canonical href=https://ng-tech.icu/books/web-tuning-series/%E6%80%A7%E8%83%BD%E7%9B%91%E6%8E%A7%E4%B8%8E%E7%B3%BB%E7%BB%9F%E5%8C%96/%E5%BC%82%E5%B8%B8%E7%9B%91%E6%8E%A7%E4%B8%8E%E5%88%86%E6%9E%90/%E7%94%A8%E6%88%B7%E8%A1%8C%E4%B8%BA%E5%88%86%E6%9E%90/%E7%94%A8%E6%88%B7%E8%BF%BD%E8%B8%AA/><meta property="twitter:card" content="summary_large_image"><meta property="twitter:site" content="@wx-chevalier"><meta property="twitter:creator" content="@wx-chevalier"><meta property="og:site_name" content="Next-gen Tech Edu"><meta property="og:url" content="https://ng-tech.icu/books/web-tuning-series/%E6%80%A7%E8%83%BD%E7%9B%91%E6%8E%A7%E4%B8%8E%E7%B3%BB%E7%BB%9F%E5%8C%96/%E5%BC%82%E5%B8%B8%E7%9B%91%E6%8E%A7%E4%B8%8E%E5%88%86%E6%9E%90/%E7%94%A8%E6%88%B7%E8%A1%8C%E4%B8%BA%E5%88%86%E6%9E%90/%E7%94%A8%E6%88%B7%E8%BF%BD%E8%B8%AA/"><meta property="og:title" content="用户追踪 | Next-gen Tech Edu"><meta property="og:description" content="用户追踪 White Ops 这里我们以 White Ops 为例，介绍实际场景下如何通过用户浏览器特性分析来进行用户追踪： Communicates with vprza.com and minkatu.com Does device/OS detection Attempts to detect if DevTools is open (looks at __IE_DEVTOOLBAR_CONSOLE_COMMAND_LINE) Something weird with the text-underline-offset CSS property Has the names of a bunch of ad servers, presumably as to not serve ads to bots Attempts to create an ActiveXObject (only exists in old IE versions), and checks if"><meta property="og:image" content="https://ng-tech.icu/media/sharing.png"><meta property="twitter:image" content="https://ng-tech.icu/media/sharing.png"><meta property="og:locale" content="zh"><title>用户追踪 | Next-gen Tech Edu</title></head><body id=top data-spy=scroll data-offset=70 data-target=#TableOfContents class=page-wrapper data-wc-page-id=c0d56bbf40d1cc5dc9f581910901ff8c><button onclick=topFunction() id=backTopBtn title="Go to top"><i class="fa-solid fa-circle-up" aria-hidden=true></i></button>
<script src=/js/wowchemy-init.min.14a0ed61c6dbd594b9c75193b25be179.js></script><aside class=search-modal id=search><div class=container><section class=search-header><div class="row no-gutters justify-content-between mb-3"><div class="col-6 search-title"><p>搜索</p></div><div class="col-6 col-search-close"><a class=js-search href=# aria-label=关闭><i class="fas fa-times-circle text-muted" aria-hidden=true></i></a></div></div><div id=search-box></div></section><section class=section-search-results><div id=search-hits></div><div id=search-common-queries></div></section></div></aside><div class=page-header><header class=header--fixed><nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id=navbar-main><div class=container-xl><div class="d-none d-lg-inline-flex"><a class=navbar-brand href=/>Next-gen Tech Edu</a></div><button type=button class=navbar-toggler data-toggle=collapse data-target=#navbar-content aria-controls=navbar-content aria-expanded=false aria-label=切换导航>
<span><i class="fas fa-bars"></i></span></button><div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none"><a class=navbar-brand href=/>Next-gen Tech Edu</a></div><div class="navbar-collapse main-menu-item collapse justify-content-start" id=navbar-content><ul class="navbar-nav d-md-inline-flex"><li class=nav-item><a class=nav-link href=/books-gallery><span>笔记（万篇）</span></a></li><li class=nav-item><a class=nav-link href=/#knowledge-map><span>知识图谱</span></a></li><style>.dropdown-item{display:inline-flex}</style><li class="nav-item dropdown"><a href=# class="nav-link dropdown-toggle" data-toggle=dropdown aria-haspopup=true><span>实验室</span><span class=caret></span></a><div class=dropdown-menu><a class=dropdown-item href=/galaxy-home/gh-craft><span>Craft 方块世界</span></a>
<a class=dropdown-item href=/galaxy-home/glossary-cards><span>3D 知识卡牌</span></a></div></li><style>.dropdown-item{display:inline-flex}</style><li class="nav-item dropdown"><a href=# class="nav-link dropdown-toggle" data-toggle=dropdown aria-haspopup=true><span>其他阅读渠道</span><span class=caret></span></a><div class=dropdown-menu><a class=dropdown-item href=https://zhuanlan.zhihu.com/wxyyxc1992><img style=width:16px;height:16px;display:inline-block;margin-right:8px src=https://ngte-superbed.oss-cn-beijing.aliyuncs.com/item/20230218234451.png></img><span>知乎</span></a>
<a class=dropdown-item href=https://segmentfault.com/blog/wxyyxc1992><img style=width:16px;height:16px;display:inline-block;margin-right:8px src=https://ngte-superbed.oss-cn-beijing.aliyuncs.com/item/20230219113556.png></img><span>SegmentFault</span></a>
<a class=dropdown-item href=https://zhuanlan.zhihu.com/wxyyxc1992><img style=width:16px;height:16px;display:inline-block;margin-right:8px src=https://ngte-superbed.oss-cn-beijing.aliyuncs.com/item/20230219113519.png></img><span>掘金</span></a></div></li></ul></div><ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2"><li class=nav-item><a class="nav-link js-search" href=# aria-label=搜索><i class="fas fa-search" aria-hidden=true></i></a></li><li class=nav-item><a class=nav-link href=https://github.com/wx-chevalier aria-label=GitHub><i class="fa-brands fa-github" aria-hidden=true></i></a></li><div></div><style>@media only screen and (max-width:600px){.jimmysong-template{display:none!important}}</style><li class=jimmysong-template style=color:#fff;font-size:12px><a href=https://jimmysong.io style=color:#fff>By Jimmy Song's Template</a></li></ul></div></nav></header></div><div class=page-body><link rel=stylesheet href=//unpkg.com/heti/umd/heti.min.css><div class="container-xl docs"><div class="row flex-xl-nowrap"><div class=docs-sidebar><form class="docs-search d-flex align-items-center"><button class="btn docs-toggle d-md-none p-0 mr-md-3 w-100" type=button data-toggle=collapse data-target=#docs-nav aria-controls=docs-nav aria-expanded=false aria-label="Toggle section navigation"><div class=d-flex><span class="d-md-none pl-1 flex-grow-1 text-left overflow-hidden">用户行为分析</span>
<span><i class="fas fa-chevron-down"></i></span></div></button>
<button class="form-control sidebar-search js-search d-none d-md-flex">
<i class="fas fa-search pr-2"></i>
<span class=sidebar-search-text>搜索...</span>
<span class=sidebar-search-shortcut>/</span></button></form><nav class="collapse docs-links" id=docs-nav><ul class="nav docs-sidenav"><li style=display:inline-flex><a style=cursor:pointer onclick=window.history.back()><i class="fas fa-arrow-left pr-1"></i>
Back</a>
<span>|</span>
<a href=/books/><i class="fa-solid fa-house" style=margin-right:4px></i>
Books</a></li></ul><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-id18d289e7f91f6cfd60aa0b6390063407")' href=#id18d289e7f91f6cfd60aa0b6390063407 aria-expanded=false aria-controls=id18d289e7f91f6cfd60aa0b6390063407 aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/web-tuning-series/%E6%80%A7%E8%83%BD%E7%9B%91%E6%8E%A7%E4%B8%8E%E7%B3%BB%E7%BB%9F%E5%8C%96/%E5%BC%82%E5%B8%B8%E7%9B%91%E6%8E%A7%E4%B8%8E%E5%88%86%E6%9E%90/>异常监控与分析</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#id18d289e7f91f6cfd60aa0b6390063407 aria-expanded=false aria-controls=id18d289e7f91f6cfd60aa0b6390063407><i class="fa-solid fa-angle-down" id=caret-id18d289e7f91f6cfd60aa0b6390063407></i></a></div><ul class="nav docs-sidenav collapse show" id=id18d289e7f91f6cfd60aa0b6390063407><li class="child level"><a href=/books/web-tuning-series/%E6%80%A7%E8%83%BD%E7%9B%91%E6%8E%A7%E4%B8%8E%E7%B3%BB%E7%BB%9F%E5%8C%96/%E5%BC%82%E5%B8%B8%E7%9B%91%E6%8E%A7%E4%B8%8E%E5%88%86%E6%9E%90/%E5%B8%B8%E8%A7%81%E5%BC%82%E5%B8%B8/>常见异常</a></li><li class="child level"><a href=/books/web-tuning-series/%E6%80%A7%E8%83%BD%E7%9B%91%E6%8E%A7%E4%B8%8E%E7%B3%BB%E7%BB%9F%E5%8C%96/%E5%BC%82%E5%B8%B8%E7%9B%91%E6%8E%A7%E4%B8%8E%E5%88%86%E6%9E%90/%E9%94%99%E8%AF%AF%E6%8D%95%E8%8E%B7/>错误捕获</a></li><li class="child level"><a href=/books/web-tuning-series/%E6%80%A7%E8%83%BD%E7%9B%91%E6%8E%A7%E4%B8%8E%E7%B3%BB%E7%BB%9F%E5%8C%96/%E5%BC%82%E5%B8%B8%E7%9B%91%E6%8E%A7%E4%B8%8E%E5%88%86%E6%9E%90/%E7%9B%91%E6%8E%A7%E4%BD%93%E7%B3%BB/>监控体系</a></li><li class="child level"><a href=/books/web-tuning-series/%E6%80%A7%E8%83%BD%E7%9B%91%E6%8E%A7%E4%B8%8E%E7%B3%BB%E7%BB%9F%E5%8C%96/%E5%BC%82%E5%B8%B8%E7%9B%91%E6%8E%A7%E4%B8%8E%E5%88%86%E6%9E%90/%E5%BC%82%E5%B8%B8%E4%B8%8A%E6%8A%A5/>异常上报</a></li><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-idb3bd13bc9607c04b87c25925966f1637")' href=#idb3bd13bc9607c04b87c25925966f1637 aria-expanded=false aria-controls=idb3bd13bc9607c04b87c25925966f1637 aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/web-tuning-series/%E6%80%A7%E8%83%BD%E7%9B%91%E6%8E%A7%E4%B8%8E%E7%B3%BB%E7%BB%9F%E5%8C%96/%E5%BC%82%E5%B8%B8%E7%9B%91%E6%8E%A7%E4%B8%8E%E5%88%86%E6%9E%90/%E7%94%A8%E6%88%B7%E8%A1%8C%E4%B8%BA%E5%88%86%E6%9E%90/>用户行为分析</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#idb3bd13bc9607c04b87c25925966f1637 aria-expanded=false aria-controls=idb3bd13bc9607c04b87c25925966f1637><i class="fa-solid fa-angle-down" id=caret-idb3bd13bc9607c04b87c25925966f1637></i></a></div><ul class="nav docs-sidenav collapse show" id=idb3bd13bc9607c04b87c25925966f1637><li class="child level active"><a href=/books/web-tuning-series/%E6%80%A7%E8%83%BD%E7%9B%91%E6%8E%A7%E4%B8%8E%E7%B3%BB%E7%BB%9F%E5%8C%96/%E5%BC%82%E5%B8%B8%E7%9B%91%E6%8E%A7%E4%B8%8E%E5%88%86%E6%9E%90/%E7%94%A8%E6%88%B7%E8%A1%8C%E4%B8%BA%E5%88%86%E6%9E%90/%E7%94%A8%E6%88%B7%E8%BF%BD%E8%B8%AA/>用户追踪</a></li></ul></div></ul></div></nav></div><div class="d-none d-xl-block col-xl-2 docs-toc"><ul class="nav toc-top"><li><a href=# id=back_to_top class=docs-toc-title>目录</a></li></ul><nav id=TableOfContents></nav><div class="subscribe-module col-24 mt-1"><img src=https://ngte-superbed.oss-cn-beijing.aliyuncs.com/item/20230220172727.png alt=image title=王下邀月熊的微信公众号></div></div><main class="py-md-3 pl-md-3 docs-content col-xl-8" role=main><article class=article><h1>用户追踪</h1><div class=article-style><h1 id=用户追踪>用户追踪</h1><h1 id=white-ops>White Ops</h1><p>这里我们以 White Ops 为例，介绍实际场景下如何通过用户浏览器特性分析来进行用户追踪：</p><ul><li>Communicates with <code>vprza.com</code> and <code>minkatu.com</code></li><li>Does device/OS detection</li><li>Attempts to detect if DevTools is open (looks at <code>__IE_DEVTOOLBAR_CONSOLE_COMMAND_LINE</code>)</li><li>Something weird with the <code>text-underline-offset</code> CSS property</li><li>Has the names of a bunch of ad servers, presumably as to not serve ads to bots</li><li>Attempts to create an <code>ActiveXObject</code> (only exists in old IE versions), and checks if the created ActiveX object <code>isSandboxed</code></li><li>Checks for <code>maxConnectionsPerServer</code> and <code>onhelp</code> properties on <code>window</code> (for browser engine detection I think)</li><li>Attempts to exploit an IE11 vuln!<ul><li>it checks the value of <code>document.documentMode</code>, which in IE11 is <code>11</code>. If it is, then it runs the obfuscated code:</li></ul></li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=c1>// o == document.documentMode == 11
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=s2>&#34;}o|B65niitbmd,ahg)Z[i$_g&#34;</span><span class=p>.</span><span class=nx>replace</span><span class=p>(</span><span class=sr>/./g</span><span class=p>,</span> <span class=kd>function</span> <span class=p>(</span><span class=nx>e</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=nb>String</span><span class=p>.</span><span class=nx>fromCharCode</span><span class=p>(</span><span class=nx>e</span><span class=p>.</span><span class=nx>charCodeAt</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span> <span class=o>-</span> <span class=nx>o</span><span class=o>--</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span></code></pre></div><ul><li>this evaluates to <code>res://ieframe.dll/acr.js</code>, but only on IE. This string has only one purpose, exploiting the fact that you can put arbitrary HTML in the hash part of the URL and have it get evaluated, I beleive in a privledged context of some sort. This file actually resolves in IE to a internal Windows system file, which is only accessible in JS due to a bug.</li><li>tries to run VBScript:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=nx>execScript</span><span class=p>(</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;e71012934811a=false::On Error Resume Next::&#34;</span> <span class=o>+</span>
</span></span><span class=line><span class=cl>    <span class=nx>e</span> <span class=o>+</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;::if Err.Number=-2147024891 or Err.Number=5002 then e71012934811a=true::Err.Clear&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;VBScript&#34;</span>
</span></span><span class=line><span class=cl><span class=p>),</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nx>t</span> <span class=o>=</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;e71012934811a&#34;</span> <span class=k>in</span> <span class=nb>window</span>
</span></span><span class=line><span class=cl>      <span class=o>?</span> <span class=nb>window</span><span class=p>.</span><span class=nx>e71012934811a</span>
</span></span><span class=line><span class=cl>        <span class=o>?</span> <span class=nx>o</span><span class=p>.</span><span class=nx>EXISTS</span>
</span></span><span class=line><span class=cl>        <span class=o>:</span> <span class=nx>o</span><span class=p>.</span><span class=nx>MISSING</span>
</span></span><span class=line><span class=cl>      <span class=o>:</span> <span class=nx>o</span><span class=p>.</span><span class=nx>UNKNOWN</span><span class=p>);</span>
</span></span></code></pre></div><ul><li>checks for these strings on window (de-obfuscated, I also have the original obfuscated ones in case you are also looking through the source):<ul><li><code>boltsWebViewAppLinkResolverResult</code>, <code>GoogleJsInterface</code>, <code>googleAdsJsInterface</code>, <code>accessibilityTraversal</code>, <code>accessibility</code>, <code>FbPlayableAd</code>, <code>__REACT_WEB_VIEW_BRIDGE</code></li><li>obfuscated in code as <code>obygfJroIvrjNccYvaxErfbyireErfhyg</code>, <code>TbbtyrWfVagresnpr</code>, <code>tbbtyrNqfWfVagresnpr</code>, <code>npprffvovyvglGenirefny</code>, <code>npprffvovyvgl</code>, <code>SoCynlnoyrNq</code>, <code>__ERNPG_JRO_IVRJ_OEVQTR</code></li></ul></li><li>checks the screen’s <code>availHeight</code>, <code>availWidth</code>, <code>width</code>, and `height</li><li>checks the screen’s <code>colorDepth</code>, <code>pixelDepth</code>, and <code>devicePixelRatio</code></li><li>checks for these automation-related properties on <code>window</code>: <code>domAutomation</code>, <code>domAutomationController</code>, <code>_WEBDRIVER_ELEM_CACHE</code>, <code>_phantom</code>, <code>callPhantom</code>, <code>window.chrome._commandLineAPI</code>, <code>window.Debug.debuggerEnabled</code>, <code>__BROWSERTOOLS_CONSOLE</code>, <code>window._FirebugCommandLine</code>, and also if <code>document.documentElement.hasAttribute("webdriver")</code> is true</li><li>checks if <code>"function () { return Function.apply.call(x.log, x, arguments); }" == window.console.log.toString()</code> (also to check for browser automation I guess</li><li>tries to check if the browser is headless with <code>isExternalUrlSafeForNavigation</code>, <code>window.opera._browserjsran</code>, <code>window.opera.browserjsran</code></li><li>checks if <code>navigator.onLine</code> is true</li><li>check the <code>window.chrome</code> object if in Chrome</li><li>extracts data from <code>window.FirefoxInterfaces("wdICoordinate", "wdIMouse", "wdIStatus")</code></li><li>checks if <code>window.XPCOMUtils</code> exists</li><li>checks if <code>window.netscape.security.privilegemanager</code> exists</li><li>appears to check browser console timing</li><li>checks referer against <code>"https://www.google.com", "https://apps.skype.com", "http://apps.skype.com", "https://www.youtube.com", "http://en.wikipedia.org/", "https://en.wikipedia.org/", "https://www.netflix.com", "http://www.netflix.com", "http://www3.oovoo.com"</code></li><li>checks for these properties in <code>window.external</code>: <code>["AddChannel", "AddDesktopComponent", "AddFavorite", "AddSearchProvider", "AddService", "AddToFavoritesBar", "AutoCompleteSaveForm", "AutoScan", "bubbleEvent", "ContentDiscoveryReset", "ImportExportFavorites", "InPrivateFilteringEnabled", "IsSearchProviderInstalled", "IsServiceInstalled", "IsSubscribed", "msActiveXFilteringEnabled", "msAddSiteMode", "msAddTrackingProtectionList", "msClearTile", "msEnableTileNotificationQueue", "msEnableTileNotificationQueueForSquare150x150", "msEnableTileNotificationQueueForSquare310x310", "msEnableTileNotificationQueueForWide310x150", "msIsSiteMode", "msIsSiteModeFirstRun", "msPinnedSiteState", "msProvisionNetworks", "msRemoveScheduledTileNotification", "msReportSafeUrl", "msScheduledTileNotification", "msSiteModeActivate", "msSiteModeAddButtonStyle", "msSiteModeAddJumpListItem", "msSiteModeAddThumbBarButton", "msSiteModeClearBadge", "msSiteModeClearIconOverlay", "msSiteModeClearJumpList", "msSiteModeCreateJumpList", "msSiteModeRefreshBadge", "msSiteModeSetIconOverlay", "msSiteModeShowButtonStyle", "msSiteModeShowJumpList", "msSiteModeShowThumbBar", "msSiteModeUpdateThumbBarButton", "msStartPeriodicBadgeUpdate", "msStartPeriodicTileUpdate", "msStartPeriodicTileUpdateBatch", "msStopPeriodicBadgeUpdate", "msStopPeriodicTileUpdate", "msTrackingProtectionEnabled", "NavigateAndFind", "raiseEvent", "setContextMenu", "ShowBrowserUI", "menuArguments", "onvisibilitychange", "scrollbar", "selectableContent", "version", "visibility", "mssitepinned", "AddUrlAuthentication", "CloseRegPopup", "FeatureEnabled", "GetJsonWebData", "GetRegValue", "Log", "LogShellErrorsOnly", "OpenPopup", "ReadFile", "RunGutsScript", "SaveRegInfo", "SetAppMaximizeTimeToRestart", "SetAppMinimizeTimeToRestart", "SetAutoStart", "SetAutoStartMinimized", "SetMaxMemory", "ShareEventFromBrowser", "ShowPopup", "ShowRadar", "WriteFile", "WriteRegValue", "summonWalrus"</code> and also <code>"AddSearchProvider", "IsSearchProviderInstalled", "QueryInterface", "addPanel", "addPersistentPanel", "addSearchEngine"</code></li><li>checks <code>maxConnectionsPerServer</code> (on Window I think)</li><li>attempts to detect Brave Browser with <code>window.brave</code></li><li>checks for a bunch more properties on <code>window</code>:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=nx>m</span><span class=p>(</span><span class=s2>&#34;document_referrer&#34;</span><span class=p>,</span> <span class=nx>h</span><span class=p>),</span>
</span></span><span class=line><span class=cl>  <span class=nx>m</span><span class=p>(</span><span class=s2>&#34;performance_timing&#34;</span><span class=p>,</span> <span class=nx>h</span><span class=p>,</span> <span class=kd>function</span> <span class=p>(</span><span class=nx>e</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>x</span><span class=p>.</span><span class=nx>qKjvb</span><span class=p>(</span><span class=nx>e</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}),</span>
</span></span><span class=line><span class=cl>  <span class=nx>m</span><span class=p>(</span><span class=s2>&#34;maxConnectionsPerServer&#34;</span><span class=p>,</span> <span class=nx>h</span><span class=p>),</span>
</span></span><span class=line><span class=cl>  <span class=nx>m</span><span class=p>(</span><span class=s2>&#34;status&#34;</span><span class=p>,</span> <span class=nx>h</span><span class=p>),</span>
</span></span><span class=line><span class=cl>  <span class=nx>m</span><span class=p>(</span><span class=s2>&#34;defaultStatus&#34;</span><span class=p>,</span> <span class=nx>h</span><span class=p>),</span>
</span></span><span class=line><span class=cl>  <span class=nx>m</span><span class=p>(</span><span class=s2>&#34;performance_memory&#34;</span><span class=p>,</span> <span class=nx>h</span><span class=p>,</span> <span class=nx>_</span><span class=p>.</span><span class=nx>flatten</span><span class=p>),</span>
</span></span><span class=line><span class=cl>  <span class=nx>m</span><span class=p>(</span><span class=s2>&#34;screen&#34;</span><span class=p>,</span> <span class=nx>h</span><span class=p>,</span> <span class=kd>function</span> <span class=p>(</span><span class=nx>e</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>e</span> <span class=o>||</span> <span class=p>{};</span>
</span></span><span class=line><span class=cl>  <span class=p>}),</span>
</span></span><span class=line><span class=cl>  <span class=nx>m</span><span class=p>(</span><span class=s2>&#34;devicePixelRatio&#34;</span><span class=p>,</span> <span class=nx>h</span><span class=p>),</span>
</span></span><span class=line><span class=cl>  <span class=nx>m</span><span class=p>(</span><span class=s2>&#34;mozPaintCount&#34;</span><span class=p>,</span> <span class=nx>h</span><span class=p>),</span>
</span></span><span class=line><span class=cl>  <span class=nx>m</span><span class=p>(</span><span class=s2>&#34;styleMedia_type&#34;</span><span class=p>,</span> <span class=nx>h</span><span class=p>),</span>
</span></span><span class=line><span class=cl>  <span class=nx>m</span><span class=p>(</span><span class=s2>&#34;history_length&#34;</span><span class=p>,</span> <span class=nx>h</span><span class=p>),</span>
</span></span><span class=line><span class=cl>  <span class=nx>m</span><span class=p>(</span><span class=s2>&#34;opener&#34;</span><span class=p>,</span> <span class=nx>h</span><span class=p>,</span> <span class=s2>&#34;top_opener&#34;</span><span class=p>,</span> <span class=kd>function</span> <span class=p>(</span><span class=nx>e</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=kc>null</span> <span class=o>!==</span> <span class=nx>e</span> <span class=o>?</span> <span class=k>typeof</span> <span class=nx>e</span> <span class=o>:</span> <span class=s2>&#34;null&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}),</span>
</span></span><span class=line><span class=cl>  <span class=nx>m</span><span class=p>(</span><span class=s2>&#34;navigator_userAgent&#34;</span><span class=p>,</span> <span class=nx>h</span><span class=p>),</span>
</span></span><span class=line><span class=cl>  <span class=nx>m</span><span class=p>(</span><span class=s2>&#34;fileCreatedDate&#34;</span><span class=p>,</span> <span class=nx>h</span><span class=p>),</span>
</span></span><span class=line><span class=cl>  <span class=nx>m</span><span class=p>(</span><span class=s2>&#34;fileModifiedDate&#34;</span><span class=p>,</span> <span class=nx>h</span><span class=p>),</span>
</span></span><span class=line><span class=cl>  <span class=nx>m</span><span class=p>(</span><span class=s2>&#34;fileUpdatedDate&#34;</span><span class=p>,</span> <span class=nx>h</span><span class=p>),</span>
</span></span><span class=line><span class=cl>  <span class=nx>m</span><span class=p>(</span><span class=s2>&#34;lastModified&#34;</span><span class=p>,</span> <span class=nx>h</span><span class=p>),</span>
</span></span><span class=line><span class=cl>  <span class=nx>m</span><span class=p>(</span><span class=s2>&#34;location_href&#34;</span><span class=p>,</span> <span class=nx>h</span><span class=p>),</span>
</span></span><span class=line><span class=cl>  <span class=nx>m</span><span class=p>(</span><span class=s2>&#34;RemotePlayback&#34;</span><span class=p>,</span> <span class=nx>h</span><span class=p>),</span>
</span></span><span class=line><span class=cl>  <span class=nx>m</span><span class=p>(</span><span class=s2>&#34;Permissions&#34;</span><span class=p>,</span> <span class=nx>h</span><span class=p>),</span>
</span></span><span class=line><span class=cl>  <span class=nx>m</span><span class=p>(</span><span class=s2>&#34;Notification&#34;</span><span class=p>,</span> <span class=nx>h</span><span class=p>),</span>
</span></span><span class=line><span class=cl>  <span class=nx>m</span><span class=p>(</span><span class=s2>&#34;MediaSession&#34;</span><span class=p>,</span> <span class=nx>h</span><span class=p>),</span>
</span></span><span class=line><span class=cl>  <span class=nx>m</span><span class=p>(</span><span class=s2>&#34;name&#34;</span><span class=p>,</span> <span class=nx>h</span><span class=p>,</span> <span class=kd>function</span> <span class=p>(</span><span class=nx>e</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>e</span><span class=p>.</span><span class=nx>substr</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>128</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}),</span>
</span></span><span class=line><span class=cl>  <span class=nx>m</span><span class=p>(</span><span class=s2>&#34;defaultView&#34;</span><span class=p>,</span> <span class=nx>h</span><span class=p>,</span> <span class=s2>&#34;document_defaultView&#34;</span><span class=p>,</span> <span class=kd>function</span> <span class=p>(</span><span class=nx>e</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=k>void</span> <span class=mi>0</span> <span class=o>===</span> <span class=nx>e</span> <span class=o>?</span> <span class=s2>&#34;undefined&#34;</span> <span class=o>:</span> <span class=nx>e</span> <span class=o>===</span> <span class=nb>window</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}),</span>
</span></span><span class=line><span class=cl>  <span class=nx>m</span><span class=p>(</span><span class=s2>&#34;console&#34;</span><span class=p>,</span> <span class=nx>h</span><span class=p>,</span> <span class=nx>_</span><span class=p>.</span><span class=nx>flatten</span><span class=p>),</span>
</span></span><span class=line><span class=cl>  <span class=nx>m</span><span class=p>(</span><span class=s2>&#34;localStorage&#34;</span><span class=p>,</span> <span class=nx>h</span><span class=p>,</span> <span class=nx>v</span><span class=p>),</span>
</span></span><span class=line><span class=cl>  <span class=nx>m</span><span class=p>(</span><span class=s2>&#34;webkitNotifications&#34;</span><span class=p>,</span> <span class=nx>h</span><span class=p>,</span> <span class=nx>v</span><span class=p>),</span>
</span></span><span class=line><span class=cl>  <span class=nx>m</span><span class=p>(</span><span class=s2>&#34;webkitAudioContext&#34;</span><span class=p>,</span> <span class=nx>h</span><span class=p>,</span> <span class=nx>v</span><span class=p>),</span>
</span></span><span class=line><span class=cl>  <span class=nx>m</span><span class=p>(</span><span class=s2>&#34;chrome&#34;</span><span class=p>,</span> <span class=nx>h</span><span class=p>,</span> <span class=nx>k</span><span class=p>.</span><span class=nx>Keys</span><span class=p>),</span>
</span></span><span class=line><span class=cl>  <span class=nx>m</span><span class=p>(</span><span class=s2>&#34;opera&#34;</span><span class=p>,</span> <span class=nx>h</span><span class=p>,</span> <span class=nx>k</span><span class=p>.</span><span class=nx>Keys</span><span class=p>),</span>
</span></span><span class=line><span class=cl>  <span class=nx>m</span><span class=p>(</span><span class=s2>&#34;navigator_standalone&#34;</span><span class=p>,</span> <span class=nx>h</span><span class=p>),</span>
</span></span><span class=line><span class=cl>  <span class=nx>m</span><span class=p>(</span><span class=s2>&#34;navtype&#34;</span><span class=p>,</span> <span class=nx>h</span><span class=p>,</span> <span class=s2>&#34;performance_navigation_type&#34;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>  <span class=nx>m</span><span class=p>(</span><span class=s2>&#34;navredirs&#34;</span><span class=p>,</span> <span class=nx>h</span><span class=p>,</span> <span class=s2>&#34;performance_navigation_redirectCount&#34;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>  <span class=nx>m</span><span class=p>(</span><span class=s2>&#34;loadTimes&#34;</span><span class=p>,</span> <span class=nx>h</span><span class=p>,</span> <span class=s2>&#34;chrome_loadTimes&#34;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>  <span class=nx>m</span><span class=p>(</span><span class=s2>&#34;vendor&#34;</span><span class=p>,</span> <span class=nx>h</span><span class=p>,</span> <span class=s2>&#34;navigator_vendor&#34;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>  <span class=nx>m</span><span class=p>(</span><span class=s2>&#34;codename&#34;</span><span class=p>,</span> <span class=nx>h</span><span class=p>,</span> <span class=s2>&#34;navigator_appCodeName&#34;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>  <span class=nx>m</span><span class=p>(</span><span class=s2>&#34;navWebdriver&#34;</span><span class=p>,</span> <span class=nx>h</span><span class=p>,</span> <span class=s2>&#34;navigator_webdriver&#34;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>  <span class=nx>m</span><span class=p>(</span><span class=s2>&#34;navLanguages&#34;</span><span class=p>,</span> <span class=nx>h</span><span class=p>,</span> <span class=s2>&#34;navigator_languages&#34;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>  <span class=nx>m</span><span class=p>(</span><span class=s2>&#34;ServiceWorker&#34;</span><span class=p>,</span> <span class=nx>h</span><span class=p>),</span>
</span></span><span class=line><span class=cl>  <span class=nx>m</span><span class=p>(</span><span class=s2>&#34;ApplePaySetup&#34;</span><span class=p>,</span> <span class=nx>h</span><span class=p>),</span>
</span></span><span class=line><span class=cl>  <span class=nx>m</span><span class=p>(</span><span class=s2>&#34;ApplePaySession&#34;</span><span class=p>,</span> <span class=nx>h</span><span class=p>),</span>
</span></span><span class=line><span class=cl>  <span class=nx>m</span><span class=p>(</span><span class=s2>&#34;Cache&#34;</span><span class=p>,</span> <span class=nx>h</span><span class=p>),</span>
</span></span><span class=line><span class=cl>  <span class=nx>m</span><span class=p>(</span><span class=s2>&#34;PaymentAddress&#34;</span><span class=p>,</span> <span class=nx>h</span><span class=p>),</span>
</span></span><span class=line><span class=cl>  <span class=nx>m</span><span class=p>(</span><span class=s2>&#34;MerchantValidationEvent&#34;</span><span class=p>,</span> <span class=nx>h</span><span class=p>),</span>
</span></span><span class=line><span class=cl>  <span class=nx>m</span><span class=p>(</span><span class=s2>&#34;mediaDevices&#34;</span><span class=p>,</span> <span class=nx>h</span><span class=p>,</span> <span class=s2>&#34;navigator_mediaDevices&#34;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>  <span class=nx>m</span><span class=p>(</span><span class=s2>&#34;share&#34;</span><span class=p>,</span> <span class=nx>h</span><span class=p>,</span> <span class=s2>&#34;navigator_share&#34;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>  <span class=nx>m</span><span class=p>(</span><span class=s2>&#34;onorientationchange&#34;</span><span class=p>,</span> <span class=nx>h</span><span class=p>),</span>
</span></span><span class=line><span class=cl>  <span class=nx>m</span><span class=p>(</span><span class=s2>&#34;document_defaultView_safari&#34;</span><span class=p>,</span> <span class=nx>h</span><span class=p>),</span>
</span></span><span class=line><span class=cl>  <span class=nx>m</span><span class=p>(</span><span class=s2>&#34;navigator_brave&#34;</span><span class=p>,</span> <span class=nx>h</span><span class=p>),</span>
</span></span><span class=line><span class=cl>  <span class=nx>m</span><span class=p>(</span><span class=s2>&#34;navigator_brave_isBrave&#34;</span><span class=p>,</span> <span class=nx>h</span><span class=p>),</span>
</span></span><span class=line><span class=cl>  <span class=nx>le</span><span class=p>.</span><span class=nx>hco</span> <span class=o>&amp;&amp;</span> <span class=nx>m</span><span class=p>(</span><span class=s2>&#34;navHardwareConc&#34;</span><span class=p>,</span> <span class=nx>h</span><span class=p>,</span> <span class=s2>&#34;navigator_hardwareConcurrency&#34;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>  <span class=nx>le</span><span class=p>.</span><span class=nx>ndm</span> <span class=o>&amp;&amp;</span> <span class=nx>m</span><span class=p>(</span><span class=s2>&#34;navDevMem&#34;</span><span class=p>,</span> <span class=nx>h</span><span class=p>,</span> <span class=s2>&#34;navigator_deviceMemory&#34;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>  <span class=nx>le</span><span class=p>.</span><span class=nx>nvl</span> <span class=o>&amp;&amp;</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nx>m</span><span class=p>(</span><span class=s2>&#34;navLocks&#34;</span><span class=p>,</span> <span class=nx>h</span><span class=p>,</span> <span class=s2>&#34;navigator_locks&#34;</span><span class=p>,</span> <span class=kd>function</span> <span class=p>(</span><span class=nx>e</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=kd>var</span> <span class=nx>t</span> <span class=o>=</span> <span class=k>typeof</span> <span class=nx>e</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=k>return</span> <span class=s2>&#34;undefined&#34;</span> <span class=o>===</span> <span class=nx>t</span> <span class=o>?</span> <span class=s2>&#34;undefined&#34;</span> <span class=o>:</span> <span class=s2>&#34;object&#34;</span> <span class=o>===</span> <span class=nx>t</span> <span class=o>?</span> <span class=s2>&#34;obj&#34;</span> <span class=o>:</span> <span class=nx>e</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}),</span>
</span></span><span class=line><span class=cl>    <span class=nx>m</span><span class=p>(</span><span class=s2>&#34;navLocksR&#34;</span><span class=p>,</span> <span class=nx>h</span><span class=p>,</span> <span class=s2>&#34;navigator_locks_request&#34;</span><span class=p>,</span> <span class=kd>function</span> <span class=p>(</span><span class=nx>e</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>return</span> <span class=s2>&#34;undefined&#34;</span> <span class=o>===</span> <span class=k>typeof</span> <span class=nx>e</span> <span class=o>?</span> <span class=s2>&#34;undefined&#34;</span> <span class=o>:</span> <span class=nx>e</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>})),</span>
</span></span><span class=line><span class=cl>  <span class=nx>le</span><span class=p>.</span><span class=nx>wor</span> <span class=o>&amp;&amp;</span> <span class=nx>m</span><span class=p>(</span><span class=s2>&#34;origin&#34;</span><span class=p>,</span> <span class=nx>h</span><span class=p>,</span> <span class=s2>&#34;origin&#34;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;object&#34;</span> <span class=o>==</span> <span class=k>typeof</span> <span class=nx>location</span> <span class=o>&amp;&amp;</span> <span class=nx>m</span><span class=p>(</span><span class=s2>&#34;protocol&#34;</span><span class=p>,</span> <span class=nx>location</span><span class=p>),</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;object&#34;</span> <span class=o>==</span> <span class=k>typeof</span> <span class=nb>document</span> <span class=o>&amp;&amp;</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nx>m</span><span class=p>(</span><span class=s2>&#34;hidden&#34;</span><span class=p>,</span> <span class=nb>document</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=nx>m</span><span class=p>(</span><span class=s2>&#34;documentMode&#34;</span><span class=p>,</span> <span class=nb>document</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=nx>m</span><span class=p>(</span><span class=s2>&#34;compatMode&#34;</span><span class=p>,</span> <span class=nb>document</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=nx>m</span><span class=p>(</span><span class=s2>&#34;visibilityState&#34;</span><span class=p>,</span> <span class=nb>document</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=nx>m</span><span class=p>(</span><span class=s2>&#34;d_origin&#34;</span><span class=p>,</span> <span class=nb>document</span><span class=p>,</span> <span class=s2>&#34;origin&#34;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=nx>m</span><span class=p>(</span><span class=s2>&#34;ddl_origin&#34;</span><span class=p>,</span> <span class=nb>document</span><span class=p>,</span> <span class=s2>&#34;defaultView_location_origin&#34;</span><span class=p>));</span>
</span></span></code></pre></div><ul><li>checks <code>mozIsLocallyAvailable</code> (which is only available on FF &lt;= 35, and could be for checking if someone is trying to debug this script offline)</li><li>checks how rounding of large and small numbers works, with <code>Math.round(.49999999999999994)</code> and <code>Math.round(Math.pow(2, 52))</code></li><li>checks the installed plugins (with <code>navigator.plugins</code>)</li><li>checks the browser viewport</li><li>attempts to get the “frame depth” (not sure what exactly that is)</li><li>checks for various status bars on <code>window</code> (<code>"locationbar", "menubar", "personalbar", "scrollbars", "statusbar", "toolbar"</code>)</li><li>checks for <code>window.showModalDialog</code></li><li>checks the <code>-webkit-text-size-adjust</code> property</li><li>checks if using <code>xx-small</code> as a font size works</li><li>Checks if image loading is enabled, by trying to load a 1x1 GIF</li><li>Tries to load an image with a URL of <code>https:/</code>, and checking if it loaded or errored</li><li>Checks the stringification o</li><li>checks for these properties on <code>window</code>: <code>StorageItem AnimationTimeline MSFrameUILocalization HTMLDialogElement mozCancelRequestAnimationFrame SVGRenderingIntent SQLException WebKitMediaKeyError SVGGeometryElement SVGMpathElement Permissions devicePixelRatio GetSVGDocument HTMLHtmlElement CSSCharsetRule ondragexit MediaSource external DOMMatrix InternalError ArchiveRequest ByteLengthQueuingStrategy ScreenOrientation onwebkitwillrevealbottom onorientationchange WebKitGamepad GeckoActiveXObject mozInnerScreenX WeakSet PaymentRequest Generator BhxWebRequest oncancel fluid media onmousemove HTMLCollection OpenWindowEventDetail FileError SmartCardEvent guest CSSConditionRule showModelessDialog SecurityPolicyViolationEvent EventSource ServiceWorker EventTarget origin VRDisplay onpointermove HTMLBodyElement vc2hxtaq9c TouchEvent DeviceStorage DeviceLightEvent External webkitPostMessage HTMLAppletElement ErrorEvent URLSearchParams BluetoothRemoteGATTDescriptor RTCStatsReport EventException PERSISTENT MediaKeyStatusMap HTMLOptionsCollection dolphinInfo MSGesture SVGPathSegLinetoRel webkitConvertPointFromNodeToPage doNotTrack CryptoDialogs HTMLPictureElement MediaController</code></li><li>checks for these CSS properties: <code>scroll-snap-coordinate flex-basis webkitMatchNearestMailBlockquoteColor MozOpacity textOverflow position columns msTextSizeAdjust animationDuration msImeAlign webkitBackgroundComposite MozTextAlignLast MozOsxFontSmoothing borderRightStyle webkitGridRow cssText parentRule webkitShapeOutside justifySelf isolation -moz-column-fill offsetRotation overflowWrap OAnimationFillMode borderRight border-inline-start-color webkitLineSnap MozPerspective touchAction enableBackground borderImageSource MozColumnFill webkitAnimationFillMode MozOSXFontSmoothing XvPhonemes length webkitFilter webkitGridAutoColumns</code></li><li>checks the stringification of native functions, and verifies some functions are implemented in native code (including <code>performance.mark</code>, and <code>Function.prototype.toString</code> itself)</li><li>attempts to get the width of the string <code>mmmmmmmmmmlli</code> in all of these fonts: <code>"Ubuntu", "Utopia", "URW Gothic L", "Bitstream Charter", "FreeMono", "DejaVu Sans", "Droid Serif", "Liberation Sans", "Vrinda", "Kartika", "Sylfaen", "CordiaUPC", "Angsana New Bold Italic", "DFKai-SB", "Ebrima", "Lao UI", "Segoe UI Symbol", "Vijaya", "Roboto", "Apple Color Emoji", "Baskerville", "Marker Felt", "Apple Symbols", "Chalkboard", "Herculanum", "Skia", "Bahnschrift", "Andalus", "Yu Gothic", "Aldhabi", "Calibri Light"</code></li><li>checks various user agent properties in <code>navigator</code></li><li>Listens to the <code>voiceschanged</code> event, and keeps track of what text-to-speech voices are available</li><li>Attempts to load <code>chrome://browser/skin/feeds/feedIcon.png</code> (I think this used to be an RSS icon in old Firefox versions)</li><li>checks for scripts injected into the page</li><li>checks availble video codecs and formats: <code>'video/mp4;codecs="avc1.42E01E, mp4a.40.2"', 'video/mp4;codecs="avc1.58A01E, mp4a.40.2"', 'video/mp4;codecs="avc1.4D401E, mp4a.40.2"', 'video/mp4;codecs="avc1.64001E, mp4a.40.2"', 'video/mp4;codecs="mp4v.20.8, mp4a.40.2"', 'video/mp4;codecs="mp4v.20.240, mp4a.40.2"', 'video/3gpp;codecs="mp4v.20.8, samr"', 'video/ogg;codecs="theora, vorbis"', 'video/ogg;codecs="theora, speex"', "audio/ogg;codecs=vorbis", "audio/ogg;codecs=speex", "audio/ogg;codecs=flac", 'video/ogg;codecs="dirac, vorbis"', 'video/x-matroska;codecs="theora, vorbis"', 'video/mp4; codecs="avc1.42E01E"', 'audio/mp4; codecs="mp4a.40.2"', 'audio/mpeg;codecs="mp3"', 'video/webm; codecs="vorbis,vp8"'</code></li><li>checks for <code>window.$cdc_asdjflasutopfhvcZLmcfl_</code> (property used by Chrome Webdriver) (obfuscated as <code>"$" + x.qKjBI("pqp") + "_" + x.qKjBI("nfqwsynfhgbcsuipMYzpsy") + "_"</code>)</li><li>gets WEBGL_debug_renderer_info, which contains GPU-specific info</li><li>tries to detect if <code>IntersectionObserver</code> returns correct data</li><li>checks what DRM solutions are available (although doesn’t actaully use them, this is what causes the DRM popup in Firefox): looks for Widevine, PlayReady, Clearkey, and Primetime</li><li>Attempts to load files stored in Chrome extension’s data (presumably to detect if they are installed):</li></ul><pre tabindex=0><code>chrome-extension://ianldemdppnbbojbafdkpdofceajhica/img/info.svg
chrome-extension://elfchnpigjboibngodkiamfemllklmge/img/info.svg
chrome-extension://npfnhmfcalmmkbpgkhjpdaiajfdhpndm/img/info.svg
chrome-extension://pfobdhfgohkddopcdbifhccbbpjlakaa/img/info.svg
chrome-extension://gfpioeglfjecbkeeomdidlndcagpbmj/img/info.svg
chrome-extension://mnbkfnehljejnebgbgfhdkmjicgmangi/img/info.svg
chrome-extension://adcggpckpldlkcobapimobdijchkigmb/img/info.svg
chrome-extension://poifgggpiofkbhafbjljpbbajafcjafi/img/info.svg
chrome-extension://plkjhgplpjlokmchnngcaeneiigkipeb/img/info.svg
chrome-extension://hhhpajpnecmhngfgkclokcghcpfgbape/img/info.svg
chrome-extension://cnncicmafnkgbonafdjnikijbhjkeink/img/info.svg
chrome-extension://aoeceebmempjbabimmnfkeeioccbjkea/img/info.svg
chrome-extension://pbclflhfplnkbgfokopkmjpejkokcaec/img/info.svg
chrome-extension://pogfikdkppcfejpknaclddnpcjjbalbn/img/info.svg
chrome-extension://mdjpmjaonahjbjncdlkjgeggjfdnnmme/img/info.svg
chrome-extension://cefomhonapiagddecgpooacpnoomabne/img/info.svg
chrome-extension://iokdapkmdldpeomcloobkajedcdleoib/img/info.svg
chrome-extension://cndipecijohebobplligphncocjamhei/content/images/icons/16.png
chrome-extension://lmpknllkkhpbfahgbkgjgopandmdbopi/blocked-notification-bar.html
chrome-extension://blddopfbnibgpgfeheedhjaheikanamn/img/128x128g.png
chrome-extension://nfjcghppefdfgmnblhgelkjhmljpndhh/img/icon16.png
</code></pre><ul><li>checks if the source code of <code>window.close</code> (which is normally <code>[native code]</code>) contains <code>ELECTRON</code></li><li>there is the string “haha jit go brrrrr”, as part of what appears to be some sort of either test for a JS engine bug or exploit</li><li>collects performance data</li><li>checks if Safari is creating a “Web clip” screenshot of the page</li></ul><h1 id=links>Links</h1><ul><li><a href=http://www.ruanyifeng.com/blog/2019/04/user-tracking.html target=_blank rel=noopener>http://www.ruanyifeng.com/blog/2019/04/user-tracking.html</a></li></ul></div><div class=article-widget><div class="container-xl row post-nav"></div></div><div class=body-footer><p>最近更新于 0001-01-01</p><section id=comments class="mb-3 pt-0"><div id=disqus_thread></div><script>var disqus_config=function(){};(function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="https://ngte-website.oss-accelerate.aliyuncs.com/disqus/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)})()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></section></div></article><footer class=site-footer><div class="copyright py-4 bg-footer"><div class="row justify-content-center"><div class="text-center footer-color"><p class=mb-0>© 2017-2022 NGTE all rights reserved</p></div></div></div></footer></main></div></div><script src=//unpkg.com/heti/umd/heti-addon.min.js></script>
<script>const heti=new Heti(".article");heti.autoSpacing()</script><script type=text/javascript>window.$crisp=[],window.CRISP_WEBSITE_ID="12adcc35-9621-4313-8262-62dc654b29d8",function(){setTimeout(function(){d=document,s=d.createElement("script"),s.src="https://client.crisp.chat/l.js",s.async=1,d.getElementsByTagName("head")[0].appendChild(s)},2500)}()</script></div><div class=page-footer></div><script src=/js/vendor-bundle.min.d26509351aa0ff874abbee824e982e9b.js></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.1/highlight.min.js integrity="sha512-Ypjm0o7jOxAd4hpdoppSEN0TQOC19UtPAqD+4s5AlXmUvbmmS/YMxYqAqarQYyxTnB6/rqip9qcxlNB/3U9Wdg==" crossorigin=anonymous></script>
<script id=search-hit-algolia-template type=text/html><div class=search-hit><div class=search-hit-content><div class=search-hit-name><a href={{relpermalink}}>{{#helpers.highlight}}{ "attribute": "title" }{{/helpers.highlight}}</a></div><div class="article-metadata search-hit-type">{{type}}</div><p class=search-hit-description>{{#helpers.highlight}}{ "attribute": "summary" }{{/helpers.highlight}}</p></div></div></script><script src=https://cdn.jsdelivr.net/npm/instantsearch.js@4/dist/instantsearch.production.min.js crossorigin=anonymous></script>
<script id=dsq-count-scr src=https://ngte-website.oss-accelerate.aliyuncs.com/disqus/count.js async></script>
<script src=/zh/js/algolia-search-built.min.4387d694ca1258194aaf562b8cd1c400.js type=module></script>
<script id=page-data type=application/json>{"use_headroom":false}</script><script src=/zh/js/wowchemy.min.d1673c7a11d1238516cbe12a1e84257f.js></script>
<script>var mybutton=document.getElementById("backTopBtn");window.onscroll=function(){scrollFunction()};function scrollFunction(){document.body.scrollTop>20||document.documentElement.scrollTop>20?mybutton.style.display="block":mybutton.style.display="none"}function topFunction(){document.body.scrollTop=0,document.documentElement.scrollTop=0}</script><script src=https://cdn.jsdelivr.net/gh/bryanbraun/anchorjs@4.2.2/anchor.min.js integrity="sha512-I7w3ZdSFzw5j3jU3ZkNikBNeIrl3i+hEuEdwNmqUJvwNcaBUNcijnP2gd9DtGlgVYDplfjGoD8vTNsID+lCjqg==" crossorigin=anonymous></script>
<script>anchors.add()</script><script>(function(){"use strict";if(!document.queryCommandSupported("copy"))return;function e(e,t){e.className="highlight-copy-btn",e.textContent=t,setTimeout(function(){e.textContent="",e.className="highlight-copy-btn fa fa-copy"},1e3)}function t(e){var t=window.getSelection(),n=document.createRange();return n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n),t}function n(n){var o,s=document.createElement("button");s.className="highlight-copy-btn fa fa-copy",s.textContent="",o=n.firstElementChild,s.addEventListener("click",function(){try{var n=t(o);document.execCommand("copy"),n.removeAllRanges(),e(s,"已复制")}catch(t){console&&console.log(t),e(s,"Failed :'(")}}),n.appendChild(s)}var s=document.getElementsByClassName("highlight");Array.prototype.forEach.call(s,n)})()</script></body></html>