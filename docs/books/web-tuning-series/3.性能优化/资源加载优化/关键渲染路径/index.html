<!doctype html><html lang=zh><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=generator content="Wowchemy 5.5.0 for Hugo"><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=preload as=style href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap"><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap" media=print onload='this.media="all"'><meta name=google-site-verification content="google69a5cccb61297807"><meta name=baidu-site-verification content="cqmZHEleVh"><meta name=description content="关键路径渲染 避免阻塞型脚本 总的来说我们希望所有的资源能够尽可能快地加载完毕，不过往往为了保证首页加载的速度，我们会考虑将部分非首屏需要的 JS/CSS 文件进行延迟加载，或者对于重复的视图使用浏览器本地缓存。Jav"><link rel=alternate hreflang=zh href=https://ng-tech.icu/books/web-tuning-series/3.%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/%E8%B5%84%E6%BA%90%E5%8A%A0%E8%BD%BD%E4%BC%98%E5%8C%96/%E5%85%B3%E9%94%AE%E6%B8%B2%E6%9F%93%E8%B7%AF%E5%BE%84/><meta name=theme-color content="#0a55a7"><link rel=stylesheet href=/css/vendor-bundle.min.c7b8d9abd591ba2253ea42747e3ac3f5.css media=print onload='this.media="all"'><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.1/styles/github.min.css crossorigin=anonymous title=hl-light media=print onload='this.media="all"'><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.1/styles/dracula.min.css crossorigin=anonymous title=hl-dark media=print onload='this.media="all"' disabled><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/instantsearch.css@7.4.5/themes/satellite-min.css integrity="sha256-TehzF/2QvNKhGQrrNpoOb2Ck4iGZ1J/DI4pkd2oUsBc=" crossorigin=anonymous><link rel=stylesheet href=/css/wowchemy.63df6ae9fc2b4cc71b83f1774d780209.css><script async src="https://www.googletagmanager.com/gtag/js?id=G-40NYXJ8823"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-40NYXJ8823")</script><script>var _hmt=_hmt||[];(function(){var e,t=document.createElement("script");t.src="https://hm.baidu.com/hm.js?56df1177bce405601b0ecdd7208f75c6",e=document.getElementsByTagName("script")[0],e.parentNode.insertBefore(t,e)})()</script><link rel=manifest href=/manifest.webmanifest><link rel=icon type=image/png href=/media/icon_hu0f7d075e895d6f5f1f5fdbc1e33dc138_10087_32x32_fill_lanczos_center_3.png><link rel=apple-touch-icon type=image/png href=/media/icon_hu0f7d075e895d6f5f1f5fdbc1e33dc138_10087_180x180_fill_lanczos_center_3.png><link rel=canonical href=https://ng-tech.icu/books/web-tuning-series/3.%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/%E8%B5%84%E6%BA%90%E5%8A%A0%E8%BD%BD%E4%BC%98%E5%8C%96/%E5%85%B3%E9%94%AE%E6%B8%B2%E6%9F%93%E8%B7%AF%E5%BE%84/><meta property="twitter:card" content="summary_large_image"><meta property="twitter:site" content="@wx-chevalier"><meta property="twitter:creator" content="@wx-chevalier"><meta property="og:site_name" content="Next-gen Tech Edu"><meta property="og:url" content="https://ng-tech.icu/books/web-tuning-series/3.%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/%E8%B5%84%E6%BA%90%E5%8A%A0%E8%BD%BD%E4%BC%98%E5%8C%96/%E5%85%B3%E9%94%AE%E6%B8%B2%E6%9F%93%E8%B7%AF%E5%BE%84/"><meta property="og:title" content="关键渲染路径 | Next-gen Tech Edu"><meta property="og:description" content="关键路径渲染 避免阻塞型脚本 总的来说我们希望所有的资源能够尽可能快地加载完毕，不过往往为了保证首页加载的速度，我们会考虑将部分非首屏需要的 JS/CSS 文件进行延迟加载，或者对于重复的视图使用浏览器本地缓存。Jav"><meta property="og:image" content="https://ng-tech.icu/media/sharing.png"><meta property="twitter:image" content="https://ng-tech.icu/media/sharing.png"><meta property="og:locale" content="zh"><title>关键渲染路径 | Next-gen Tech Edu</title></head><body id=top data-spy=scroll data-offset=70 data-target=#TableOfContents class=page-wrapper data-wc-page-id=5136ebafd8675c6286ec8b3ba03bfdde><button onclick=topFunction() id=backTopBtn title="Go to top"><i class="fa-solid fa-circle-up" aria-hidden=true></i></button>
<script src=/js/wowchemy-init.min.14a0ed61c6dbd594b9c75193b25be179.js></script><aside class=search-modal id=search><div class=container><section class=search-header><div class="row no-gutters justify-content-between mb-3"><div class="col-6 search-title"><p>搜索</p></div><div class="col-6 col-search-close"><a class=js-search href=# aria-label=关闭><i class="fas fa-times-circle text-muted" aria-hidden=true></i></a></div></div><div id=search-box></div></section><section class=section-search-results><div id=search-hits></div><div id=search-common-queries></div></section></div></aside><div class=page-header><header class=header--fixed><nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id=navbar-main><div class=container-xl><div class="d-none d-lg-inline-flex"><a class=navbar-brand href=/>Next-gen Tech Edu</a></div><button type=button class=navbar-toggler data-toggle=collapse data-target=#navbar-content aria-controls=navbar-content aria-expanded=false aria-label=切换导航>
<span><i class="fas fa-bars"></i></span></button><div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none"><a class=navbar-brand href=/>Next-gen Tech Edu</a></div><div class="navbar-collapse main-menu-item collapse justify-content-start" id=navbar-content><ul class="navbar-nav d-md-inline-flex"><li class=nav-item><a class=nav-link href=/books-gallery><span>笔记（万篇）</span></a></li><li class=nav-item><a class=nav-link href=/#knowledge-map><span>知识图谱</span></a></li><style>.dropdown-item{display:inline-flex}</style><li class="nav-item dropdown"><a href=# class="nav-link dropdown-toggle" data-toggle=dropdown aria-haspopup=true><span>实验室</span><span class=caret></span></a><div class=dropdown-menu><a class=dropdown-item href=/galaxy-home/gh-craft><span>Craft 方块世界</span></a>
<a class=dropdown-item href=/galaxy-home/glossary-cards><span>3D 知识卡牌</span></a></div></li><style>.dropdown-item{display:inline-flex}</style><li class="nav-item dropdown"><a href=# class="nav-link dropdown-toggle" data-toggle=dropdown aria-haspopup=true><span>其他阅读渠道</span><span class=caret></span></a><div class=dropdown-menu><a class=dropdown-item href=https://zhuanlan.zhihu.com/wxyyxc1992><img style=width:16px;height:16px;display:inline-block;margin-right:8px src=https://ngte-superbed.oss-cn-beijing.aliyuncs.com/item/20230218234451.png></img><span>知乎</span></a>
<a class=dropdown-item href=https://segmentfault.com/blog/wxyyxc1992><img style=width:16px;height:16px;display:inline-block;margin-right:8px src=https://ngte-superbed.oss-cn-beijing.aliyuncs.com/item/20230219113556.png></img><span>SegmentFault</span></a>
<a class=dropdown-item href=https://zhuanlan.zhihu.com/wxyyxc1992><img style=width:16px;height:16px;display:inline-block;margin-right:8px src=https://ngte-superbed.oss-cn-beijing.aliyuncs.com/item/20230219113519.png></img><span>掘金</span></a></div></li></ul></div><ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2"><li class=nav-item><a class="nav-link js-search" href=# aria-label=搜索><i class="fas fa-search" aria-hidden=true></i></a></li><li class=nav-item><a class=nav-link href=https://github.com/wx-chevalier aria-label=GitHub><i class="fa-brands fa-github" aria-hidden=true></i></a></li><div></div><style>@media only screen and (max-width:600px){.jimmysong-template{display:none!important}}</style><li class=jimmysong-template style=color:#fff;font-size:12px><a href=https://jimmysong.io style=color:#fff>By Jimmy Song's Template</a></li></ul></div></nav></header></div><div class=page-body><link rel=stylesheet href=//unpkg.com/heti/umd/heti.min.css><div class="container-xl docs"><div class="row flex-xl-nowrap"><div class=docs-sidebar><form class="docs-search d-flex align-items-center"><button class="btn docs-toggle d-md-none p-0 mr-md-3 w-100" type=button data-toggle=collapse data-target=#docs-nav aria-controls=docs-nav aria-expanded=false aria-label="Toggle section navigation"><div class=d-flex><span class="d-md-none pl-1 flex-grow-1 text-left overflow-hidden">资源加载优化</span>
<span><i class="fas fa-chevron-down"></i></span></div></button>
<button class="form-control sidebar-search js-search d-none d-md-flex">
<i class="fas fa-search pr-2"></i>
<span class=sidebar-search-text>搜索...</span>
<span class=sidebar-search-shortcut>/</span></button></form><nav class="collapse docs-links" id=docs-nav><ul class="nav docs-sidenav"><li style=display:inline-flex><a style=cursor:pointer onclick=window.history.back()><i class="fas fa-arrow-left pr-1"></i>
Back</a>
<span>|</span>
<a href=/books/><i class="fa-solid fa-house" style=margin-right:4px></i>
Books</a></li></ul><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-id351fbf9240ee3ada78257b60e3d6f1c5")' href=#id351fbf9240ee3ada78257b60e3d6f1c5 aria-expanded=false aria-controls=id351fbf9240ee3ada78257b60e3d6f1c5 aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/web-tuning-series/3.%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/>3.性能优化</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#id351fbf9240ee3ada78257b60e3d6f1c5 aria-expanded=false aria-controls=id351fbf9240ee3ada78257b60e3d6f1c5><i class="fa-solid fa-angle-down" id=caret-id351fbf9240ee3ada78257b60e3d6f1c5></i></a></div><ul class="nav docs-sidenav collapse show" id=id351fbf9240ee3ada78257b60e3d6f1c5><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-ida8c274c8d077b69b7c6294c22c3ff947")' href=#ida8c274c8d077b69b7c6294c22c3ff947 aria-expanded=false aria-controls=ida8c274c8d077b69b7c6294c22c3ff947 aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/web-tuning-series/3.%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/%E5%86%85%E5%AD%98%E4%BC%98%E5%8C%96/>内存优化</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#ida8c274c8d077b69b7c6294c22c3ff947 aria-expanded=false aria-controls=ida8c274c8d077b69b7c6294c22c3ff947><i class="fa-solid fa-angle-right" id=caret-ida8c274c8d077b69b7c6294c22c3ff947></i></a></div><ul class="nav docs-sidenav collapse" id=ida8c274c8d077b69b7c6294c22c3ff947><li class="child level"><a href=/books/web-tuning-series/3.%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/%E5%86%85%E5%AD%98%E4%BC%98%E5%8C%96/%E5%86%85%E5%AD%98%E4%BD%BF%E7%94%A8%E5%88%86%E6%9E%90/>内存使用分析</a></li><li class="child level"><a href=/books/web-tuning-series/3.%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/%E5%86%85%E5%AD%98%E4%BC%98%E5%8C%96/%E5%86%85%E5%AD%98%E6%B3%84%E9%9C%B2%E4%BC%98%E5%8C%96/>内存泄露优化</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-idad8cd761f0e4612637f83dafaebe0239")' href=#idad8cd761f0e4612637f83dafaebe0239 aria-expanded=false aria-controls=idad8cd761f0e4612637f83dafaebe0239 aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/web-tuning-series/3.%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/%E5%9B%BE%E7%89%87%E4%BC%98%E5%8C%96/>图片优化</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#idad8cd761f0e4612637f83dafaebe0239 aria-expanded=false aria-controls=idad8cd761f0e4612637f83dafaebe0239><i class="fa-solid fa-angle-right" id=caret-idad8cd761f0e4612637f83dafaebe0239></i></a></div><ul class="nav docs-sidenav collapse" id=idad8cd761f0e4612637f83dafaebe0239><li class="child level"><a href=/books/web-tuning-series/3.%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/%E5%9B%BE%E7%89%87%E4%BC%98%E5%8C%96/webp/>Webp</a></li><li class="child level"><a href=/books/web-tuning-series/3.%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/%E5%9B%BE%E7%89%87%E4%BC%98%E5%8C%96/%E8%A7%86%E9%A2%91%E4%BC%98%E5%8C%96/>视频优化</a></li><li class="child level"><a href=/books/web-tuning-series/3.%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/%E5%9B%BE%E7%89%87%E4%BC%98%E5%8C%96/%E5%9B%BE%E7%89%87%E6%A0%BC%E5%BC%8F%E4%B8%8E%E8%BD%AC%E6%8D%A2/>图片格式与转换</a></li><li class="child level"><a href=/books/web-tuning-series/3.%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/%E5%9B%BE%E7%89%87%E4%BC%98%E5%8C%96/%E5%9B%BE%E7%89%87%E5%8E%8B%E7%BC%A9/>图片压缩</a></li><li class="child level"><a href=/books/web-tuning-series/3.%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/%E5%9B%BE%E7%89%87%E4%BC%98%E5%8C%96/%E5%9B%BE%E7%89%87%E4%BC%98%E5%8C%96/>图片优化</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-id8077861be05259c47fb7f64e57aff80b")' href=#id8077861be05259c47fb7f64e57aff80b aria-expanded=false aria-controls=id8077861be05259c47fb7f64e57aff80b aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/web-tuning-series/3.%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/%E6%B8%B2%E6%9F%93%E6%89%A7%E8%A1%8C%E4%BC%98%E5%8C%96/>渲染执行优化</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#id8077861be05259c47fb7f64e57aff80b aria-expanded=false aria-controls=id8077861be05259c47fb7f64e57aff80b><i class="fa-solid fa-angle-right" id=caret-id8077861be05259c47fb7f64e57aff80b></i></a></div><ul class="nav docs-sidenav collapse" id=id8077861be05259c47fb7f64e57aff80b><li class="child level"><a href=/books/web-tuning-series/3.%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/%E6%B8%B2%E6%9F%93%E6%89%A7%E8%A1%8C%E4%BC%98%E5%8C%96/%E5%B8%83%E5%B1%80%E4%B8%8E%E6%B8%B2%E6%9F%93%E7%AD%96%E7%95%A5/>布局与渲染策略</a></li><li class="child level"><a href=/books/web-tuning-series/3.%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/%E6%B8%B2%E6%9F%93%E6%89%A7%E8%A1%8C%E4%BC%98%E5%8C%96/%E4%BA%A4%E4%BA%92%E4%B8%8E%E5%8A%A8%E7%94%BB/>交互与动画</a></li><li class="child level"><a href=/books/web-tuning-series/3.%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/%E6%B8%B2%E6%9F%93%E6%89%A7%E8%A1%8C%E4%BC%98%E5%8C%96/%E8%84%9A%E6%9C%AC%E8%A7%A3%E6%9E%90%E4%B8%8E%E6%89%A7%E8%A1%8C/>脚本解析与执行</a></li><li class="child level"><a href=/books/web-tuning-series/3.%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/%E6%B8%B2%E6%9F%93%E6%89%A7%E8%A1%8C%E4%BC%98%E5%8C%96/%E6%B8%B2%E6%9F%93%E7%AD%96%E7%95%A5/>渲染策略</a></li><li class="child level"><a href=/books/web-tuning-series/3.%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/%E6%B8%B2%E6%9F%93%E6%89%A7%E8%A1%8C%E4%BC%98%E5%8C%96/%E8%B5%84%E6%BA%90%E8%AF%B7%E6%B1%82%E4%B8%8E%E7%BC%93%E5%AD%98/>资源请求与缓存</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-iddf4548667aadcd776e7319ffcbf1a7f4")' href=#iddf4548667aadcd776e7319ffcbf1a7f4 aria-expanded=false aria-controls=iddf4548667aadcd776e7319ffcbf1a7f4 aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/web-tuning-series/3.%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/%E8%B5%84%E6%BA%90%E5%8A%A0%E8%BD%BD%E4%BC%98%E5%8C%96/>资源加载优化</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#iddf4548667aadcd776e7319ffcbf1a7f4 aria-expanded=false aria-controls=iddf4548667aadcd776e7319ffcbf1a7f4><i class="fa-solid fa-angle-down" id=caret-iddf4548667aadcd776e7319ffcbf1a7f4></i></a></div><ul class="nav docs-sidenav collapse show" id=iddf4548667aadcd776e7319ffcbf1a7f4><li class="child level active"><a href=/books/web-tuning-series/3.%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/%E8%B5%84%E6%BA%90%E5%8A%A0%E8%BD%BD%E4%BC%98%E5%8C%96/%E5%85%B3%E9%94%AE%E6%B8%B2%E6%9F%93%E8%B7%AF%E5%BE%84/>关键渲染路径</a></li><li class="child level"><a href=/books/web-tuning-series/3.%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/%E8%B5%84%E6%BA%90%E5%8A%A0%E8%BD%BD%E4%BC%98%E5%8C%96/%E6%87%92%E5%8A%A0%E8%BD%BD/>懒加载</a></li><li class="child level"><a href=/books/web-tuning-series/3.%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/%E8%B5%84%E6%BA%90%E5%8A%A0%E8%BD%BD%E4%BC%98%E5%8C%96/%E8%AE%BE%E8%AE%A1%E4%BC%98%E5%8C%96/>设计优化</a></li><li class="child level"><a href=/books/web-tuning-series/3.%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/%E8%B5%84%E6%BA%90%E5%8A%A0%E8%BD%BD%E4%BC%98%E5%8C%96/%E9%A2%84%E5%8A%A0%E8%BD%BD/>预加载</a></li><li class="child level"><a href=/books/web-tuning-series/3.%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/%E8%B5%84%E6%BA%90%E5%8A%A0%E8%BD%BD%E4%BC%98%E5%8C%96/%E5%AD%97%E4%BD%93%E4%BC%98%E5%8C%96/>字体优化</a></li></ul></div></ul></div></nav></div><div class="d-none d-xl-block col-xl-2 docs-toc"><ul class="nav toc-top"><li><a href=# id=back_to_top class=docs-toc-title>目录</a></li></ul><nav id=TableOfContents><ul><li><a href=#异步加载脚本>异步加载脚本</a></li><li><a href=#lazy-load-js>Lazy Load JS</a></li><li><a href=#lazy-load-css>Lazy Load CSS</a></li></ul><ul><li><a href=#loading-monitor加载监控>Loading Monitor(加载监控)</a><ul><li><a href=#pacehttpsgithubcomhubspotpace自动为页面添加加载指示><a href=https://github.com/HubSpot/pace/>PACE</a>:自动为页面添加加载指示</a></li></ul></li><li><a href=#lazyloading懒加载>LazyLoading(懒加载)</a><ul><li><a href=#js-loader>JS-Loader</a></li><li><a href=#tinyloaderhttpsgithubcomyouzantiny-loaderjs><a href=https://github.com/youzan/tiny-loader.js>TinyLoader</a></a></li><li><a href=#loadcsshttpsgithubcomfilamentgrouploadcssa-function-for-loading-css-asynchronously><a href=https://github.com/filamentgroup/loadCSS>loadCSS</a>:A function for loading CSS asynchronously</a></li><li><a href=#react-loadscripthttpsgithubcomthreepointonereact-loadscript><a href=https://github.com/threepointone/react-loadscript>react-loadscript</a></a></li></ul></li><li><a href=#preloading预加载>PreLoading(预加载)</a><ul><li><a href=#link-prefetching预加载>Link Prefetching(预加载)</a></li></ul></li><li><a href=#turbolinkshttpsgithubcomturbolinksturbolinks><a href=https://github.com/turbolinks/turbolinks>turbolinks</a></a></li><li><a href=#pageaccelerator>[pageAccelerator](</a></li></ul><ul><li><a href=#external-link>External Link</a><ul><li><a href=#script>script</a></li></ul></li></ul></nav><div class="subscribe-module col-24 mt-1"><img src=https://ngte-superbed.oss-cn-beijing.aliyuncs.com/item/20230220172727.png alt=image title=王下邀月熊的微信公众号></div></div><main class="py-md-3 pl-md-3 docs-content col-xl-8" role=main><article class=article><h1>关键渲染路径</h1><div class=article-style><h1 id=关键路径渲染>关键路径渲染</h1><p><figure><div class="d-flex justify-content-center"><div class=w-100><img src=https://ww1.sinaimg.cn/large/007rAy9hgy1g25vrpwkhzj30v00gkabw.jpg alt loading=lazy data-zoomable></div></div></figure></p><h1 id=避免阻塞型脚本>避免阻塞型脚本</h1><p>总的来说我们希望所有的资源能够尽可能快地加载完毕，不过往往为了保证首页加载的速度，我们会考虑将部分非首屏需要的 JS/CSS 文件进行延迟加载，或者对于重复的视图使用浏览器本地缓存。JavaScript 是个单线程语言，渲染引擎和 JS 引擎不是同时进行的。所以提前引入 JS 文件可能会造成堵塞，从而影响页面加载，出现闪屏等情况。于是为了解决这种情况，就出现了 JS 在 body 最后引入、script 标签中 defer 和 async 异步加载 JS 的方式。</p><h2 id=异步加载脚本>异步加载脚本</h2><ul><li><p>defer：如果 script 标签设置了该属性，则浏览器会异步的下载该文件并且不会影响到后续 DOM 的渲染。如果有多个设置了 defer 的 script 标签存在，则会按照顺序执行所有的 script。defer 脚本会在文档渲染完毕后，DOMContentLoaded 事件调用前执行。</p></li><li><p>async：async 浏览器立即异步下载文件，不同于 defer 得是，下载完成会立即执行，此时会阻塞 dom 渲染，所以 async 的 script 最好不要操作 dom。因为是下载完立即执行，不能保证多个加载时的先后顺序。</p></li></ul><p><figure><div class="d-flex justify-content-center"><div class=w-100><img src=https://pic.imgdb.cn/item/60c84f24844ef46bb2561093.jpg alt="defer vs async" loading=lazy data-zoomable></div></div></figure></p><h2 id=lazy-load-js>Lazy Load JS</h2><p>目前来说，我们的网站都是偏向于静态，并不需要太多的 JavaScript 介入，不过考虑到日后的扩展空间，我们还是构建了一套完整的 JS 的工作流。众所周知，如果将 JS 直接放置到 head 标签中，其会阻塞整个页面的渲染。对于该点，最简单的方式就是将会阻塞渲染的 JS 脚本移动到页面的尾部，在整个首屏渲染完毕之后再进行加载。另一个常用的手段就是依然保持 JS 文件位于 head 标签中，不过为其添加一个<code>defer</code>的属性，这保证了浏览器只会先将该脚本下载下来，然后等到整个页面加载完毕再执行该脚本。另一个需要注意的是，因为我们并不使用类似于 jQuery 这样的第三方依赖库，而更多的依赖于浏览器原生的特性，因此我们希望在合适的浏览器内加载合适版本的 JS 代码，其效果大概如下:</p><pre tabindex=0><code>&lt;script&gt;
// Mustard Cutting
if (&#39;querySelector&#39; in document &amp;&amp; &#39;addEventListener&#39; in window) {
  document.write(&#39;&lt;script src=&#34;index.js&#34; defer&gt;&lt;\/script&gt;&#39;);
}
&lt;/script&gt;
</code></pre><h2 id=lazy-load-css>Lazy Load CSS</h2><p>正如上文所述，我们的网站偏向于静态展示，因此首屏的最大问题就是 CSS 文件的加载问题。浏览器会在 head 标签中声明的所有 CSS 文件下载完毕之前一直处于阻塞状态，这种机制很是明智的，不然的话浏览器在加载多个 CSS 文件的时候会进行重复的布局与渲染，这更是对于性能的浪费。为了避免非首屏的 CSS 文件阻塞页面渲染，我们使用<a href=https://github.com/filamentgroup/loadCSS target=_blank rel=noopener>loadCSS</a>这个小的工具库来进行异步的 CSS 文件加载，它会在 CSS 文件加载完毕后执行回调。不过，异步加载 CSS 也会带来一个新的问题，如果我们将所有的 CSS 全部设置为了异步加载，那么用户会首先看到单纯的 HTML 页面，这也会给用户不好的体验。那么我们就需要在异步加载与首屏渲染之间找到一个平衡点，即首先加载那些必要的 CSS 文件。我们一般将首屏渲染中必要的 CSS 文件成为 Critical CSS，即关键的 CSS 文件，代指在保证页面的可读性的前提下需要加载的最少的 CSS 文件数目。Critical CSS 的选定会是一个非常耗时的过程，特别是我们网站本身的 CSS 样式设置也在不停变更，我们不可能完全依赖于人工去提取出关键的 CSS 文件，这里推荐<a href=https://github.com/addyosmani/critical target=_blank rel=noopener>Critical</a>这个辅助工具能够帮你自动提取压缩 Critical CSS。下图的一个对比即是仅加载 Critical CSS 与加载全部 CSS 的区别:</p><p><figure><div class="d-flex justify-content-center"><div class=w-100><img src=https://cdn.css-tricks.com/wp-content/uploads/2016/08/voorhoede-fold.jpg alt loading=lazy data-zoomable></div></div></figure></p><p>上图中红色的线，即是所谓的折叠分割点。</p><h1 id=critical-css>Critical CSS</h1><h1 id=预加载>预加载</h1><p>preload 和 prefecth 是 link 标签上的属性</p><ul><li><p>preload：让浏览器提前加载指定资源(加载后并不执行)，需要执行时再执行</p></li><li><p>prefetch：它告诉浏览器，这段资源将会在未来某个导航或者功能要用到，但是本资源的下载顺序权重比较低。也就是说 prefetch 通常用于加速下一次导航，而不是本次的。被标记为 prefetch 的资源，将会被浏览器在空闲时间加载。# 懒加载</p></li></ul><h1 id=代码分割>代码分割</h1><p><figure><div class="d-flex justify-content-center"><div class=w-100><img src=https://developers.google.com/web/fundamentals/performance/webpack/code-splitting.png alt loading=lazy data-zoomable></div></div></figure></p><h2 id=loading-monitor加载监控>Loading Monitor(加载监控)</h2><h3 id=pacehttpsgithubcomhubspotpace自动为页面添加加载指示><a href=https://github.com/HubSpot/pace/ target=_blank rel=noopener>PACE</a>:自动为页面添加加载指示</h3><p><figure><div class="d-flex justify-content-center"><div class=w-100><img src=http://7xlgth.com1.z0.glb.clouddn.com/4415C519-F8CA-4A15-8126-F478193FE38C.png alt loading=lazy data-zoomable></div></div></figure></p><h4 id=installation>Installation</h4><pre tabindex=0><code>&lt;head&gt;
  &lt;script src=&#34;/pace/pace.js&#34;&gt;&lt;/script&gt;
  &lt;link href=&#34;/pace/themes/pace-theme-barber-shop.css&#34; rel=&#34;stylesheet&#34; /&gt;
&lt;/head&gt;
</code></pre><h2 id=lazyloading懒加载>LazyLoading(懒加载)</h2><h3 id=js-loader>JS-Loader</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kr>const</span> <span class=nx>promises</span> <span class=o>=</span> <span class=p>{};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>loadScript</span><span class=p>(</span><span class=nx>src</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span><span class=nx>promises</span><span class=p>[</span><span class=nx>src</span><span class=p>])</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>promises</span><span class=p>[</span><span class=nx>src</span><span class=p>];</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=kd>let</span> <span class=nx>promise</span> <span class=o>=</span> <span class=p>(</span><span class=nx>promises</span><span class=p>[</span><span class=nx>src</span><span class=p>]</span> <span class=o>=</span> <span class=k>new</span> <span class=nb>Promise</span><span class=p>((</span><span class=nx>resolve</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>el</span> <span class=o>=</span> <span class=nb>document</span><span class=p>.</span><span class=nx>createElement</span><span class=p>(</span><span class=s2>&#34;script&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>loaded</span> <span class=o>=</span> <span class=kc>false</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=nx>el</span><span class=p>.</span><span class=nx>onload</span> <span class=o>=</span> <span class=nx>el</span><span class=p>.</span><span class=nx>onreadystatechange</span> <span class=o>=</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>if</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nx>el</span><span class=p>.</span><span class=nx>readyState</span> <span class=o>&amp;&amp;</span>
</span></span><span class=line><span class=cl>          <span class=nx>el</span><span class=p>.</span><span class=nx>readyState</span> <span class=o>!==</span> <span class=s2>&#34;complete&#34;</span> <span class=o>&amp;&amp;</span>
</span></span><span class=line><span class=cl>          <span class=nx>el</span><span class=p>.</span><span class=nx>readyState</span> <span class=o>!==</span> <span class=s2>&#34;loaded&#34;</span><span class=p>)</span> <span class=o>||</span>
</span></span><span class=line><span class=cl>        <span class=nx>loaded</span>
</span></span><span class=line><span class=cl>      <span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=kc>false</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=nx>el</span><span class=p>.</span><span class=nx>onload</span> <span class=o>=</span> <span class=nx>el</span><span class=p>.</span><span class=nx>onreadystatechange</span> <span class=o>=</span> <span class=kc>null</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=nx>loaded</span> <span class=o>=</span> <span class=kc>true</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=nx>resolve</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>el</span><span class=p>.</span><span class=kr>async</span> <span class=o>=</span> <span class=kc>true</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=nx>el</span><span class=p>.</span><span class=nx>src</span> <span class=o>=</span> <span class=nx>src</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>let</span> <span class=nx>head</span> <span class=o>=</span> <span class=nb>document</span><span class=p>.</span><span class=nx>getElementsByTagName</span><span class=p>(</span><span class=s2>&#34;head&#34;</span><span class=p>)[</span><span class=mi>0</span><span class=p>];</span>
</span></span><span class=line><span class=cl>    <span class=nx>head</span><span class=p>.</span><span class=nx>insertBefore</span><span class=p>(</span><span class=nx>el</span><span class=p>,</span> <span class=nx>head</span><span class=p>.</span><span class=nx>firstChild</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}));</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=nx>promise</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h3 id=tinyloaderhttpsgithubcomyouzantiny-loaderjs><a href=https://github.com/youzan/tiny-loader.js target=_blank rel=noopener>TinyLoader</a></h3><h3 id=loadcsshttpsgithubcomfilamentgrouploadcssa-function-for-loading-css-asynchronously><a href=https://github.com/filamentgroup/loadCSS target=_blank rel=noopener>loadCSS</a>:A function for loading CSS asynchronously</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=cm>/*! loadCSS: load a CSS file asynchronously. [c]2016 @scottjehl, Filament Group, Inc. Licensed MIT */</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=kd>function</span> <span class=p>(</span><span class=nx>w</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;use strict&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=cm>/* exported loadCSS */</span>
</span></span><span class=line><span class=cl>  <span class=kd>var</span> <span class=nx>loadCSS</span> <span class=o>=</span> <span class=kd>function</span> <span class=p>(</span><span class=nx>href</span><span class=p>,</span> <span class=nx>before</span><span class=p>,</span> <span class=nx>media</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// Arguments explained:
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// `href` [REQUIRED] is the URL for your CSS file.
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// `before` [OPTIONAL] is the element the script should use as a reference for injecting our stylesheet &lt;link&gt; before
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// By default, loadCSS attempts to inject the link after the last stylesheet or script in the DOM. However, you might desire a more specific location in your document.
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// `media` [OPTIONAL] is the media type or query of the stylesheet. By default it will be &#39;all&#39;
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kd>var</span> <span class=nx>doc</span> <span class=o>=</span> <span class=nx>w</span><span class=p>.</span><span class=nb>document</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>ss</span> <span class=o>=</span> <span class=nx>doc</span><span class=p>.</span><span class=nx>createElement</span><span class=p>(</span><span class=s2>&#34;link&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>ref</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nx>before</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>ref</span> <span class=o>=</span> <span class=nx>before</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=kd>var</span> <span class=nx>refs</span> <span class=o>=</span> <span class=p>(</span><span class=nx>doc</span><span class=p>.</span><span class=nx>body</span> <span class=o>||</span> <span class=nx>doc</span><span class=p>.</span><span class=nx>getElementsByTagName</span><span class=p>(</span><span class=s2>&#34;head&#34;</span><span class=p>)[</span><span class=mi>0</span><span class=p>]).</span><span class=nx>childNodes</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=nx>ref</span> <span class=o>=</span> <span class=nx>refs</span><span class=p>[</span><span class=nx>refs</span><span class=p>.</span><span class=nx>length</span> <span class=o>-</span> <span class=mi>1</span><span class=p>];</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>sheets</span> <span class=o>=</span> <span class=nx>doc</span><span class=p>.</span><span class=nx>styleSheets</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=nx>ss</span><span class=p>.</span><span class=nx>rel</span> <span class=o>=</span> <span class=s2>&#34;stylesheet&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=nx>ss</span><span class=p>.</span><span class=nx>href</span> <span class=o>=</span> <span class=nx>href</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=c1>// temporarily set media to something inapplicable to ensure it&#39;ll fetch without blocking render
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>ss</span><span class=p>.</span><span class=nx>media</span> <span class=o>=</span> <span class=s2>&#34;only x&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// wait until body is defined before injecting link. This ensures a non-blocking load in IE11.
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kd>function</span> <span class=nx>ready</span><span class=p>(</span><span class=nx>cb</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>if</span> <span class=p>(</span><span class=nx>doc</span><span class=p>.</span><span class=nx>body</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nx>cb</span><span class=p>();</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=nx>setTimeout</span><span class=p>(</span><span class=kd>function</span> <span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>ready</span><span class=p>(</span><span class=nx>cb</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=p>});</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=c1>// Inject link
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// Note: the ternary preserves the existing behavior of &#34;before&#34; argument, but we could choose to change the argument to &#34;after&#34; in a later release and standardize on ref.nextSibling for all refs
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// Note: `insertBefore` is used instead of `appendChild`, for safety re: http://www.paulirish.com/2011/surefire-dom-element-insertion/
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>ready</span><span class=p>(</span><span class=kd>function</span> <span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>ref</span><span class=p>.</span><span class=nx>parentNode</span><span class=p>.</span><span class=nx>insertBefore</span><span class=p>(</span><span class=nx>ss</span><span class=p>,</span> <span class=nx>before</span> <span class=o>?</span> <span class=nx>ref</span> <span class=o>:</span> <span class=nx>ref</span><span class=p>.</span><span class=nx>nextSibling</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>});</span>
</span></span><span class=line><span class=cl>    <span class=c1>// A method (exposed on return object for external use) that mimics onload by polling until document.styleSheets until it includes the new sheet.
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kd>var</span> <span class=nx>onloadcssdefined</span> <span class=o>=</span> <span class=kd>function</span> <span class=p>(</span><span class=nx>cb</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=kd>var</span> <span class=nx>resolvedHref</span> <span class=o>=</span> <span class=nx>ss</span><span class=p>.</span><span class=nx>href</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=kd>var</span> <span class=nx>i</span> <span class=o>=</span> <span class=nx>sheets</span><span class=p>.</span><span class=nx>length</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=k>while</span> <span class=p>(</span><span class=nx>i</span><span class=o>--</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=nx>sheets</span><span class=p>[</span><span class=nx>i</span><span class=p>].</span><span class=nx>href</span> <span class=o>===</span> <span class=nx>resolvedHref</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=k>return</span> <span class=nx>cb</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=nx>setTimeout</span><span class=p>(</span><span class=kd>function</span> <span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>onloadcssdefined</span><span class=p>(</span><span class=nx>cb</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=p>});</span>
</span></span><span class=line><span class=cl>    <span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>function</span> <span class=nx>loadCB</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>if</span> <span class=p>(</span><span class=nx>ss</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>ss</span><span class=p>.</span><span class=nx>removeEventListener</span><span class=p>(</span><span class=s2>&#34;load&#34;</span><span class=p>,</span> <span class=nx>loadCB</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=nx>ss</span><span class=p>.</span><span class=nx>media</span> <span class=o>=</span> <span class=nx>media</span> <span class=o>||</span> <span class=s2>&#34;all&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// once loaded, set link&#39;s media back to `all` so that the stylesheet applies once it loads
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>if</span> <span class=p>(</span><span class=nx>ss</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>ss</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s2>&#34;load&#34;</span><span class=p>,</span> <span class=nx>loadCB</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=nx>ss</span><span class=p>.</span><span class=nx>onloadcssdefined</span> <span class=o>=</span> <span class=nx>onloadcssdefined</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=nx>onloadcssdefined</span><span class=p>(</span><span class=nx>loadCB</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>ss</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>};</span>
</span></span><span class=line><span class=cl>  <span class=c1>// commonjs
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=k>if</span> <span class=p>(</span><span class=k>typeof</span> <span class=nx>exports</span> <span class=o>!==</span> <span class=s2>&#34;undefined&#34;</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>exports</span><span class=p>.</span><span class=nx>loadCSS</span> <span class=o>=</span> <span class=nx>loadCSS</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>w</span><span class=p>.</span><span class=nx>loadCSS</span> <span class=o>=</span> <span class=nx>loadCSS</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>})(</span><span class=k>typeof</span> <span class=nx>global</span> <span class=o>!==</span> <span class=s2>&#34;undefined&#34;</span> <span class=o>?</span> <span class=nx>global</span> <span class=o>:</span> <span class=k>this</span><span class=p>);</span>
</span></span></code></pre></div><p>最基本的用法：</p><pre tabindex=0><code>loadCSS( &#34;path/to/mystylesheet.css&#34; );
</code></pre><h3 id=react-loadscripthttpsgithubcomthreepointonereact-loadscript><a href=https://github.com/threepointone/react-loadscript target=_blank rel=noopener>react-loadscript</a></h3><p><code>npm install react react-loadscript --save</code></p><p>script-loading as a component</p><p>(I&rsquo;m so sorry)</p><pre tabindex=0><code>import {Script} from &#39;react-loadscript&#39;;

class App {
  render(){
    return &lt;Script src=&#39;https://code.jquery.com/jquery-2.1.4.min.js&#39;&gt;{
      ({done}) =&gt; !done?
        &lt;div&gt;loading...&lt;/div&gt; :
        &lt;div&gt;{$.map([1, 2, 3], i =&gt; &lt;div&gt;{i*5}&lt;/div&gt;)}&lt;/div&gt;
    }&lt;/Script&gt;
  }
}
</code></pre><p>uses promises + a simple cache to prevent duplicate script loads. enjoy!</p><h2 id=preloading预加载>PreLoading(预加载)</h2><ul><li><a href=https://css-tricks.com/prefetching-preloading-prebrowsing/ target=_blank rel=noopener>prefetching-preloading-prebrowsing</a></li></ul><h3 id=link-prefetching预加载>Link Prefetching(预加载)</h3><p>预加载网页内容为浏览者提供一个平滑的浏览体验。这个 api 我们在业务偶尔也会使用到。</p><p>Link prefetching 是利用浏览器最佳的时间去下载或者预加载一些用户可能将会在不久将来浏览的文档的一种浏览器机制。</p><pre tabindex=0><code>&lt;!-- full page --&gt;
&lt;link rel=&#34;prefetch&#34; href=&#34;http://davidwalsh.name/css-enhancements-user-experience&#34; /&gt;
&lt;!-- just an image --&gt;
&lt;link rel=&#34;prefetch&#34; href=&#34;http://davidwalsh.name/wp-content/themes/walshbook3/images/sprite.png&#34; /&gt;
</code></pre><p>什么时候使用 link 预加载是否在自己的网站使用预加载，可以参考一下几点：</p><ul><li>当你做的是一种类似 slideshow 的网页，需要提前加载近 1-3 张页面(假设这些页面并不大)</li><li>预先加载在网站中许多网页都会用到的图片</li><li>预先加载网站搜索的结果的页面</li></ul><p>Browsers are beginning to support a standard markup pattern for loading CSS (and other file types) asynchronously: ``(<a href=https://www.w3.org/TR/2015/WD-preload-20150721/ target=_blank rel=noopener>W3C Spec</a>). We recommend using this markup pattern to reference any CSS files that should be loaded asynchronously, and using<code>loadCSS</code> to polyfill support browsers that don&rsquo;t yet support this new feature.</p><p>The markup for referencing your CSS file looks like this:</p><pre tabindex=0><code>&lt;link rel=&#34;preload&#34; href=&#34;path/to/mystylesheet.css&#34; as=&#34;style&#34; onload=&#34;this.rel=&#39;stylesheet&#39;&#34;&gt;
&lt;noscript&gt;&lt;link rel=&#34;stylesheet&#34; href=&#34;path/to/mystylesheet.css&#34;&gt;&lt;/noscript&gt;
</code></pre><p>Since <code>rel=preload</code> does not apply the CSS on its own (it merely fetches it), there is an <code>onload</code> handler on the <code>link</code> that will do that for us as soon as the CSS finishes loading. Since this step requires JavaScript, you may want to include an ordinary reference to your CSS file as well, using a <code>noscript</code> element to ensure it only applies in non-JavaScript settings.</p><p>With that markup in the <code>head</code> of your page, include the <a href=https://github.com/filamentgroup/loadCSS/blob/master/src/loadCSS.js target=_blank rel=noopener>loadCSS script</a>, as well as the <a href=https://github.com/filamentgroup/loadCSS/blob/master/src/cssrelpreload.js target=_blank rel=noopener>loadCSS rel=preload polyfill script</a> in your page (inline to run right away, or in an external file if the CSS is low-priority).</p><p>No further configuration is needed, as these scripts will automatically detect if the browsers supports <code>rel=preload</code>, and if it does not, they will find CSS files referenced in the DOM and preload them using loadCSS. In browsers that natively support <code>rel=preload</code>, these scripts will do nothing, allowing the browser to load and apply the asynchronous CSS (note the <code>onload</code> attribute above, which is there to set the <code>link</code>&rsquo;s <code>rel</code> attribute to stylesheet once it finishes loading in browsers that support <code>rel=preload</code>).</p><p>Note: regardless of whether the browser supports <code>rel=preload</code> or not, your CSS file will be referenced from the same spot in the source order as the original <code>link</code> element. Keep this in mind, as you may want to place the <code>link</code> in a particular location in your <code>head</code> element so that the CSS loads with an expected cascade order.</p><p>You can view a demo of this <code>rel=preload</code> pattern here: <a href=http://filamentgroup.github.io/loadCSS/test/preload.html target=_blank rel=noopener>http://filamentgroup.github.io/loadCSS/test/preload.html</a></p><h2 id=turbolinkshttpsgithubcomturbolinksturbolinks><a href=https://github.com/turbolinks/turbolinks target=_blank rel=noopener>turbolinks</a></h2><h2 id=pageaccelerator>[pageAccelerator](</h2><p><a href=https://github.com/Easyfood/pageAccelerator%29 target=_blank rel=noopener>https://github.com/Easyfood/pageAccelerator)</a>:预加载页面&pushState 替换 url</p><h1 id=tags>Tags</h1><h2 id=external-link>External Link</h2><h3 id=script>script</h3><pre tabindex=0><code>script标签可以用于指示JavaScript源代码，也可以用于引入远端的js脚本文件。
</code></pre><h4 id=野生动态加载脚本文件>野生动态加载脚本文件</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kd>function</span> <span class=nx>loadJs</span><span class=p>(</span><span class=nx>sid</span><span class=p>,</span> <span class=nx>jsurl</span><span class=p>,</span> <span class=nx>callback</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kd>var</span> <span class=nx>nodeHead</span> <span class=o>=</span> <span class=nb>document</span><span class=p>.</span><span class=nx>getElementsByTagName</span><span class=p>(</span><span class=s2>&#34;head&#34;</span><span class=p>)[</span><span class=mi>0</span><span class=p>];</span>
</span></span><span class=line><span class=cl>  <span class=kd>var</span> <span class=nx>nodeScript</span> <span class=o>=</span> <span class=kc>null</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span><span class=nb>document</span><span class=p>.</span><span class=nx>getElementById</span><span class=p>(</span><span class=nx>sid</span><span class=p>)</span> <span class=o>==</span> <span class=kc>null</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>nodeScript</span> <span class=o>=</span> <span class=nb>document</span><span class=p>.</span><span class=nx>createElement</span><span class=p>(</span><span class=s2>&#34;script&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nx>nodeScript</span><span class=p>.</span><span class=nx>setAttribute</span><span class=p>(</span><span class=s2>&#34;type&#34;</span><span class=p>,</span> <span class=s2>&#34;text/javascript&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nx>nodeScript</span><span class=p>.</span><span class=nx>setAttribute</span><span class=p>(</span><span class=s2>&#34;src&#34;</span><span class=p>,</span> <span class=nx>jsurl</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nx>nodeScript</span><span class=p>.</span><span class=nx>setAttribute</span><span class=p>(</span><span class=s2>&#34;id&#34;</span><span class=p>,</span> <span class=nx>sid</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nx>callback</span> <span class=o>!=</span> <span class=kc>null</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>nodeScript</span><span class=p>.</span><span class=nx>onload</span> <span class=o>=</span> <span class=nx>nodeScript</span><span class=p>.</span><span class=nx>onreadystatechange</span> <span class=o>=</span> <span class=kd>function</span> <span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=nx>nodeScript</span><span class=p>.</span><span class=nx>ready</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=k>return</span> <span class=kc>false</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>          <span class=o>!</span><span class=nx>nodeScript</span><span class=p>.</span><span class=nx>readyState</span> <span class=o>||</span>
</span></span><span class=line><span class=cl>          <span class=nx>nodeScript</span><span class=p>.</span><span class=nx>readyState</span> <span class=o>==</span> <span class=s2>&#34;loaded&#34;</span> <span class=o>||</span>
</span></span><span class=line><span class=cl>          <span class=nx>nodeScript</span><span class=p>.</span><span class=nx>readyState</span> <span class=o>==</span> <span class=s2>&#34;complete&#34;</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=nx>nodeScript</span><span class=p>.</span><span class=nx>ready</span> <span class=o>=</span> <span class=kc>true</span><span class=p>;</span>
</span></span><span class=line><span class=cl>          <span class=nx>callback</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=p>};</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=nx>nodeHead</span><span class=p>.</span><span class=nx>appendChild</span><span class=p>(</span><span class=nx>nodeScript</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nx>callback</span> <span class=o>!=</span> <span class=kc>null</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>callback</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h4 id=github-loadjshttpsgithubcommuicssloadjs><a href=https://github.com/muicss/loadjs target=_blank rel=noopener>Github-LoadJs</a></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=c1>// load a single file
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>loadjs</span><span class=p>(</span><span class=s2>&#34;foo.js&#34;</span><span class=p>,</span> <span class=kd>function</span> <span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=c1>// foo.js loaded
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// load multiple files (in parallel)
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>loadjs</span><span class=p>([</span><span class=s2>&#34;foo.js&#34;</span><span class=p>,</span> <span class=s2>&#34;bar.js&#34;</span><span class=p>],</span> <span class=kd>function</span> <span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=c1>// foo.js &amp; bar.js loaded
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// load multiple files (in series)
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>loadjs</span><span class=p>(</span><span class=s2>&#34;foo.js&#34;</span><span class=p>,</span> <span class=kd>function</span> <span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>loadjs</span><span class=p>(</span><span class=s2>&#34;bar.js&#34;</span><span class=p>,</span> <span class=kd>function</span> <span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// foo.js loaded then bar.js loaded
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=p>});</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// add a bundle id
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>loadjs</span><span class=p>([</span><span class=s2>&#34;foo.js&#34;</span><span class=p>,</span> <span class=s2>&#34;bar.js&#34;</span><span class=p>],</span> <span class=s2>&#34;foobar&#34;</span><span class=p>,</span> <span class=kd>function</span> <span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=c1>// foo.js &amp; bar.js loaded
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// add a failure callback
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>loadjs</span><span class=p>(</span>
</span></span><span class=line><span class=cl>  <span class=p>[</span><span class=s2>&#34;foo.js&#34;</span><span class=p>,</span> <span class=s2>&#34;bar.js&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;foobar&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=kd>function</span> <span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=cm>/* foo.js &amp; bar.js loaded */</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span>
</span></span><span class=line><span class=cl>  <span class=kd>function</span> <span class=p>(</span><span class=nx>pathsNotFound</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=cm>/* at least one path didn&#39;t load */</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// execute a callback after bundle finishes loading
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>loadjs</span><span class=p>([</span><span class=s2>&#34;foo.js&#34;</span><span class=p>,</span> <span class=s2>&#34;bar.js&#34;</span><span class=p>],</span> <span class=s2>&#34;foobar&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>loadjs</span><span class=p>.</span><span class=nx>ready</span><span class=p>(</span><span class=s2>&#34;foobar&#34;</span><span class=p>,</span> <span class=kd>function</span> <span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=c1>// foo.js &amp; bar.js loaded
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// .ready() can be chained together
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>loadjs</span><span class=p>(</span><span class=s2>&#34;foo.js&#34;</span><span class=p>,</span> <span class=s2>&#34;foo&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>loadjs</span><span class=p>(</span><span class=s2>&#34;bar.js&#34;</span><span class=p>,</span> <span class=s2>&#34;bar&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>loadjs</span>
</span></span><span class=line><span class=cl>  <span class=p>.</span><span class=nx>ready</span><span class=p>(</span><span class=s2>&#34;foo&#34;</span><span class=p>,</span> <span class=kd>function</span> <span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// foo.js loaded
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=p>})</span>
</span></span><span class=line><span class=cl>  <span class=p>.</span><span class=nx>ready</span><span class=p>(</span><span class=s2>&#34;bar&#34;</span><span class=p>,</span> <span class=kd>function</span> <span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// bar.js loaded
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// compose more complex dependency lists
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>loadjs</span><span class=p>(</span><span class=s2>&#34;foo.js&#34;</span><span class=p>,</span> <span class=s2>&#34;foo&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>loadjs</span><span class=p>(</span><span class=s2>&#34;bar.js&#34;</span><span class=p>,</span> <span class=s2>&#34;bar&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>loadjs</span><span class=p>([</span><span class=s2>&#34;thunkor.js&#34;</span><span class=p>,</span> <span class=s2>&#34;thunky.js&#34;</span><span class=p>],</span> <span class=s2>&#34;thunk&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// wait for multiple depdendencies
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>loadjs</span><span class=p>.</span><span class=nx>ready</span><span class=p>(</span>
</span></span><span class=line><span class=cl>  <span class=p>[</span><span class=s2>&#34;foo&#34;</span><span class=p>,</span> <span class=s2>&#34;bar&#34;</span><span class=p>,</span> <span class=s2>&#34;thunk&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=kd>function</span> <span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// foo.js &amp; bar.js &amp; thunkor.js &amp; thunky.js loaded
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=p>},</span>
</span></span><span class=line><span class=cl>  <span class=kd>function</span> <span class=p>(</span><span class=nx>depsNotFound</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nx>depsNotFound</span><span class=p>.</span><span class=nx>indexOf</span><span class=p>(</span><span class=s2>&#34;foo&#34;</span><span class=p>)</span> <span class=o>&gt;</span> <span class=o>-</span><span class=mi>1</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span> <span class=c1>// foo failed
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>if</span> <span class=p>(</span><span class=nx>depsNotFound</span><span class=p>.</span><span class=nx>indexOf</span><span class=p>(</span><span class=s2>&#34;bar&#34;</span><span class=p>)</span> <span class=o>&gt;</span> <span class=o>-</span><span class=mi>1</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span> <span class=c1>// bar failed
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>if</span> <span class=p>(</span><span class=nx>depsNotFound</span><span class=p>.</span><span class=nx>indexOf</span><span class=p>(</span><span class=s2>&#34;thunk&#34;</span><span class=p>)</span> <span class=o>&gt;</span> <span class=o>-</span><span class=mi>1</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span> <span class=c1>// thunk failed
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// use .done() for more control
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>loadjs</span><span class=p>.</span><span class=nx>ready</span><span class=p>(</span><span class=s2>&#34;my-awesome-plugin&#34;</span><span class=p>,</span> <span class=kd>function</span> <span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>myAwesomePlugin</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>loadjs</span><span class=p>.</span><span class=nx>ready</span><span class=p>(</span><span class=s2>&#34;jquery&#34;</span><span class=p>,</span> <span class=kd>function</span> <span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=c1>// plugin requires jquery
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nb>window</span><span class=p>.</span><span class=nx>myAwesomePlugin</span> <span class=o>=</span> <span class=kd>function</span> <span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nb>window</span><span class=p>.</span><span class=nx>jQuery</span><span class=p>)</span> <span class=k>throw</span> <span class=s2>&#34;jQuery is missing!&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>// plugin is done loading
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>loadjs</span><span class=p>.</span><span class=nx>done</span><span class=p>(</span><span class=s2>&#34;my-awesome-plugin&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span></code></pre></div></div><div class=article-widget><div class="container-xl row post-nav"><div class="col-6 post-nav-item"><div class=meta-nav>下一页</div><a href=/books/web-tuning-series/3.%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/%E8%B5%84%E6%BA%90%E5%8A%A0%E8%BD%BD%E4%BC%98%E5%8C%96/%E6%87%92%E5%8A%A0%E8%BD%BD/ rel=prev>懒加载</a></div></div></div><div class=body-footer><p>最近更新于 0001-01-01</p><section id=comments class="mb-3 pt-0"><div id=disqus_thread></div><script>var disqus_config=function(){};(function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="https://ngte.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)})()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></section></div></article><footer class=site-footer><div class="copyright py-4 bg-footer"><div class="row justify-content-center"><div class="text-center footer-color"><p class=mb-0>© 2017-2022 NGTE all rights reserved</p></div></div></div></footer></main></div></div><script src=//unpkg.com/heti/umd/heti-addon.min.js></script>
<script>const heti=new Heti(".article");heti.autoSpacing()</script><script type=text/javascript>window.$crisp=[],window.CRISP_WEBSITE_ID="12adcc35-9621-4313-8262-62dc654b29d8",function(){setTimeout(function(){d=document,s=d.createElement("script"),s.src="https://client.crisp.chat/l.js",s.async=1,d.getElementsByTagName("head")[0].appendChild(s)},2500)}()</script></div><div class=page-footer></div><script src=/js/vendor-bundle.min.d26509351aa0ff874abbee824e982e9b.js></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.1/highlight.min.js integrity="sha512-Ypjm0o7jOxAd4hpdoppSEN0TQOC19UtPAqD+4s5AlXmUvbmmS/YMxYqAqarQYyxTnB6/rqip9qcxlNB/3U9Wdg==" crossorigin=anonymous></script>
<script id=search-hit-algolia-template type=text/html><div class=search-hit><div class=search-hit-content><div class=search-hit-name><a href={{relpermalink}}>{{#helpers.highlight}}{ "attribute": "title" }{{/helpers.highlight}}</a></div><div class="article-metadata search-hit-type">{{type}}</div><p class=search-hit-description>{{#helpers.highlight}}{ "attribute": "summary" }{{/helpers.highlight}}</p></div></div></script><script src=https://cdn.jsdelivr.net/npm/instantsearch.js@4/dist/instantsearch.production.min.js crossorigin=anonymous></script>
<script id=dsq-count-scr src=https://ngte.disqus.com/count.js async></script>
<script src=/zh/js/algolia-search-built.min.4387d694ca1258194aaf562b8cd1c400.js type=module></script>
<script id=page-data type=application/json>{"use_headroom":false}</script><script src=/zh/js/wowchemy.min.d1673c7a11d1238516cbe12a1e84257f.js></script>
<script>var mybutton=document.getElementById("backTopBtn");window.onscroll=function(){scrollFunction()};function scrollFunction(){document.body.scrollTop>20||document.documentElement.scrollTop>20?mybutton.style.display="block":mybutton.style.display="none"}function topFunction(){document.body.scrollTop=0,document.documentElement.scrollTop=0}</script><script src=https://cdn.jsdelivr.net/gh/bryanbraun/anchorjs@4.2.2/anchor.min.js integrity="sha512-I7w3ZdSFzw5j3jU3ZkNikBNeIrl3i+hEuEdwNmqUJvwNcaBUNcijnP2gd9DtGlgVYDplfjGoD8vTNsID+lCjqg==" crossorigin=anonymous></script>
<script>anchors.add()</script><script>(function(){"use strict";if(!document.queryCommandSupported("copy"))return;function e(e,t){e.className="highlight-copy-btn",e.textContent=t,setTimeout(function(){e.textContent="",e.className="highlight-copy-btn fa fa-copy"},1e3)}function t(e){var t=window.getSelection(),n=document.createRange();return n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n),t}function n(n){var o,s=document.createElement("button");s.className="highlight-copy-btn fa fa-copy",s.textContent="",o=n.firstElementChild,s.addEventListener("click",function(){try{var n=t(o);document.execCommand("copy"),n.removeAllRanges(),e(s,"已复制")}catch(t){console&&console.log(t),e(s,"Failed :'(")}}),n.appendChild(s)}var s=document.getElementsByClassName("highlight");Array.prototype.forEach.call(s,n)})()</script></body></html>