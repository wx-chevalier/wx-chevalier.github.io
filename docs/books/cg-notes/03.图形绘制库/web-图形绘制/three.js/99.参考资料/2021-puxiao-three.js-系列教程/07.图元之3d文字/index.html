<!doctype html><html lang=zh><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=generator content="Wowchemy 5.5.0 for Hugo"><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=preload as=style href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap"><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap" media=print onload='this.media="all"'><meta name=google-site-verification content="google69a5cccb61297807"><meta name=baidu-site-verification content="cqmZHEleVh"><meta name=description content="07 图元之 3D 文字 在 Three.js 所有内置的图元中，TextBufferGeometry 是最为特殊的一个。 **特殊之处在于：在使用 TextBufferGeometry 创建 文字几何对象之前，需要先加载 3D 字体数据。 ** 字体数据文件通常为 .json 文件，Three."><link rel=alternate hreflang=zh href=https://ng-tech.icu/books/cg-notes/03.%E5%9B%BE%E5%BD%A2%E7%BB%98%E5%88%B6%E5%BA%93/web-%E5%9B%BE%E5%BD%A2%E7%BB%98%E5%88%B6/three.js/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2021-puxiao-three.js-%E7%B3%BB%E5%88%97%E6%95%99%E7%A8%8B/07.%E5%9B%BE%E5%85%83%E4%B9%8B3d%E6%96%87%E5%AD%97/><meta name=theme-color content="#0a55a7"><link rel=stylesheet href=/css/vendor-bundle.min.c7b8d9abd591ba2253ea42747e3ac3f5.css media=print onload='this.media="all"'><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.1/styles/github.min.css crossorigin=anonymous title=hl-light media=print onload='this.media="all"'><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.1/styles/dracula.min.css crossorigin=anonymous title=hl-dark media=print onload='this.media="all"' disabled><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/instantsearch.css@7.4.5/themes/satellite-min.css integrity="sha256-TehzF/2QvNKhGQrrNpoOb2Ck4iGZ1J/DI4pkd2oUsBc=" crossorigin=anonymous><link rel=stylesheet href=/css/wowchemy.fab3cd1900ae35687457073b2d518207.css><script async src="https://www.googletagmanager.com/gtag/js?id=G-40NYXJ8823"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-40NYXJ8823")</script><script>var _hmt=_hmt||[];(function(){var e,t=document.createElement("script");t.src="https://hm.baidu.com/hm.js?56df1177bce405601b0ecdd7208f75c6",e=document.getElementsByTagName("script")[0],e.parentNode.insertBefore(t,e)})()</script><link rel=manifest href=/manifest.webmanifest><link rel=icon type=image/png href=/media/icon_hu0f7d075e895d6f5f1f5fdbc1e33dc138_10087_32x32_fill_lanczos_center_3.png><link rel=apple-touch-icon type=image/png href=/media/icon_hu0f7d075e895d6f5f1f5fdbc1e33dc138_10087_180x180_fill_lanczos_center_3.png><link rel=canonical href=https://ng-tech.icu/books/cg-notes/03.%E5%9B%BE%E5%BD%A2%E7%BB%98%E5%88%B6%E5%BA%93/web-%E5%9B%BE%E5%BD%A2%E7%BB%98%E5%88%B6/three.js/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2021-puxiao-three.js-%E7%B3%BB%E5%88%97%E6%95%99%E7%A8%8B/07.%E5%9B%BE%E5%85%83%E4%B9%8B3d%E6%96%87%E5%AD%97/><meta property="twitter:card" content="summary_large_image"><meta property="twitter:site" content="@wx-chevalier"><meta property="twitter:creator" content="@wx-chevalier"><meta property="og:site_name" content="Next-gen Tech Edu"><meta property="og:url" content="https://ng-tech.icu/books/cg-notes/03.%E5%9B%BE%E5%BD%A2%E7%BB%98%E5%88%B6%E5%BA%93/web-%E5%9B%BE%E5%BD%A2%E7%BB%98%E5%88%B6/three.js/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2021-puxiao-three.js-%E7%B3%BB%E5%88%97%E6%95%99%E7%A8%8B/07.%E5%9B%BE%E5%85%83%E4%B9%8B3d%E6%96%87%E5%AD%97/"><meta property="og:title" content="07.图元之3D文字 | Next-gen Tech Edu"><meta property="og:description" content="07 图元之 3D 文字 在 Three.js 所有内置的图元中，TextBufferGeometry 是最为特殊的一个。 **特殊之处在于：在使用 TextBufferGeometry 创建 文字几何对象之前，需要先加载 3D 字体数据。 ** 字体数据文件通常为 .json 文件，Three."><meta property="og:image" content="https://ng-tech.icu/media/sharing.png"><meta property="twitter:image" content="https://ng-tech.icu/media/sharing.png"><meta property="og:locale" content="zh"><title>07.图元之3D文字 | Next-gen Tech Edu</title></head><body id=top data-spy=scroll data-offset=70 data-target=#TableOfContents class=page-wrapper data-wc-page-id=7a1b89b6c5ac7f61baa9457d76efdd60><button onclick=topFunction() id=backTopBtn title="Go to top"><i class="fa-solid fa-circle-up" aria-hidden=true></i></button>
<script src=/js/wowchemy-init.min.14a0ed61c6dbd594b9c75193b25be179.js></script><aside class=search-modal id=search><div class=container><section class=search-header><div class="row no-gutters justify-content-between mb-3"><div class="col-6 search-title"><p>搜索</p></div><div class="col-6 col-search-close"><a class=js-search href=# aria-label=关闭><i class="fas fa-times-circle text-muted" aria-hidden=true></i></a></div></div><div id=search-box></div></section><section class=section-search-results><div id=search-hits></div><div id=search-common-queries></div></section></div></aside><div class=page-header><header class=header--fixed><nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id=navbar-main><div class=container-xl><div class="d-none d-lg-inline-flex"><a class=navbar-brand href=/>Next-gen Tech Edu</a></div><button type=button class=navbar-toggler data-toggle=collapse data-target=#navbar-content aria-controls=navbar-content aria-expanded=false aria-label=切换导航>
<span><i class="fas fa-bars"></i></span></button><div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none"><a class=navbar-brand href=/>Next-gen Tech Edu</a></div><div class="navbar-collapse main-menu-item collapse justify-content-start" id=navbar-content><ul class="navbar-nav d-md-inline-flex"><li class=nav-item><a class=nav-link href=/books-gallery><span>笔记（万篇）</span></a></li><li class=nav-item><a class=nav-link href=/#knowledge-map><span>知识图谱</span></a></li><style>.dropdown-item{display:inline-flex}</style><li class="nav-item dropdown"><a href=# class="nav-link dropdown-toggle" data-toggle=dropdown aria-haspopup=true><span>实验室</span><span class=caret></span></a><div class=dropdown-menu><a class=dropdown-item href=/galaxy-home/gh-craft><span>Craft 方块世界</span></a>
<a class=dropdown-item href=/galaxy-home/glossary-cards><span>3D 知识卡牌</span></a></div></li><style>.dropdown-item{display:inline-flex}</style><li class="nav-item dropdown"><a href=# class="nav-link dropdown-toggle" data-toggle=dropdown aria-haspopup=true><span>其他阅读渠道</span><span class=caret></span></a><div class=dropdown-menu><a class=dropdown-item href=https://zhuanlan.zhihu.com/wxyyxc1992><img style=width:16px;height:16px;display:inline-block;margin-right:8px src=https://ngte-superbed.oss-cn-beijing.aliyuncs.com/item/20230218234451.png></img><span>知乎</span></a>
<a class=dropdown-item href=https://segmentfault.com/blog/wxyyxc1992><img style=width:16px;height:16px;display:inline-block;margin-right:8px src=https://ngte-superbed.oss-cn-beijing.aliyuncs.com/item/20230219113556.png></img><span>SegmentFault</span></a>
<a class=dropdown-item href=https://zhuanlan.zhihu.com/wxyyxc1992><img style=width:16px;height:16px;display:inline-block;margin-right:8px src=https://ngte-superbed.oss-cn-beijing.aliyuncs.com/item/20230219113519.png></img><span>掘金</span></a></div></li></ul></div><ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2"><li class=nav-item><a class="nav-link js-search" href=# aria-label=搜索><i class="fas fa-search" aria-hidden=true></i></a></li><li class=nav-item><a class=nav-link href=https://github.com/wx-chevalier aria-label=GitHub><i class="fa-brands fa-github" aria-hidden=true></i></a></li><div></div><style>@media only screen and (max-width:600px){.jimmysong-template{display:none!important}}</style><li class=jimmysong-template style=color:#fff;font-size:12px><a href=https://jimmysong.io style=color:#fff>By Jimmy Song's Template</a></li></ul></div></nav></header></div><div class=page-body><link rel=stylesheet href=//unpkg.com/heti/umd/heti.min.css><div class="container-xl docs"><div class="row flex-xl-nowrap"><div class=docs-sidebar><form class="docs-search d-flex align-items-center"><button class="btn docs-toggle d-md-none p-0 mr-md-3 w-100" type=button data-toggle=collapse data-target=#docs-nav aria-controls=docs-nav aria-expanded=false aria-label="Toggle section navigation"><div class=d-flex><span class="d-md-none pl-1 flex-grow-1 text-left overflow-hidden">2021-puxiao-《Three.js 系列教程》</span>
<span><i class="fas fa-chevron-down"></i></span></div></button>
<button class="form-control sidebar-search js-search d-none d-md-flex">
<i class="fas fa-search pr-2"></i>
<span class=sidebar-search-text>搜索...</span>
<span class=sidebar-search-shortcut>/</span></button></form><nav class="collapse docs-links" id=docs-nav><ul class="nav docs-sidenav"><li style=display:inline-flex><a style=cursor:pointer onclick=window.history.back()><i class="fas fa-arrow-left pr-1"></i>
Back</a>
<span>|</span>
<a href=/books/><i class="fa-solid fa-house" style=margin-right:4px></i>
Books</a></li></ul><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-idbb95a2d75baa1d08a35c84b8efe5ad00")' href=#idbb95a2d75baa1d08a35c84b8efe5ad00 aria-expanded=false aria-controls=idbb95a2d75baa1d08a35c84b8efe5ad00 aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/cg-notes/03.%E5%9B%BE%E5%BD%A2%E7%BB%98%E5%88%B6%E5%BA%93/web-%E5%9B%BE%E5%BD%A2%E7%BB%98%E5%88%B6/three.js/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/>99.参考资料</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#idbb95a2d75baa1d08a35c84b8efe5ad00 aria-expanded=false aria-controls=idbb95a2d75baa1d08a35c84b8efe5ad00><i class="fa-solid fa-angle-down" id=caret-idbb95a2d75baa1d08a35c84b8efe5ad00></i></a></div><ul class="nav docs-sidenav collapse show" id=idbb95a2d75baa1d08a35c84b8efe5ad00><li class="child level"><a href=/books/cg-notes/03.%E5%9B%BE%E5%BD%A2%E7%BB%98%E5%88%B6%E5%BA%93/web-%E5%9B%BE%E5%BD%A2%E7%BB%98%E5%88%B6/three.js/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2017-%E5%9B%BE%E8%A7%A3-webgl-%E5%8F%8A-three.js-%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86/>2017-图解 WebGL 及 Three.js 工作原理</a></li><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-ide04f28caa67ef746c1e042a66bd26df7")' href=#ide04f28caa67ef746c1e042a66bd26df7 aria-expanded=false aria-controls=ide04f28caa67ef746c1e042a66bd26df7 aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/cg-notes/03.%E5%9B%BE%E5%BD%A2%E7%BB%98%E5%88%B6%E5%BA%93/web-%E5%9B%BE%E5%BD%A2%E7%BB%98%E5%88%B6/three.js/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2021-puxiao-three.js-%E7%B3%BB%E5%88%97%E6%95%99%E7%A8%8B/>2021-puxiao-《Three.js 系列教程》</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#ide04f28caa67ef746c1e042a66bd26df7 aria-expanded=false aria-controls=ide04f28caa67ef746c1e042a66bd26df7><i class="fa-solid fa-angle-down" id=caret-ide04f28caa67ef746c1e042a66bd26df7></i></a></div><ul class="nav docs-sidenav collapse show" id=ide04f28caa67ef746c1e042a66bd26df7><li class="child level"><a href=/books/cg-notes/03.%E5%9B%BE%E5%BD%A2%E7%BB%98%E5%88%B6%E5%BA%93/web-%E5%9B%BE%E5%BD%A2%E7%BB%98%E5%88%B6/three.js/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2021-puxiao-three.js-%E7%B3%BB%E5%88%97%E6%95%99%E7%A8%8B/01.three.js-%E7%AE%80%E4%BB%8B/>01.Three.js 简介</a></li><li class="child level"><a href=/books/cg-notes/03.%E5%9B%BE%E5%BD%A2%E7%BB%98%E5%88%B6%E5%BA%93/web-%E5%9B%BE%E5%BD%A2%E7%BB%98%E5%88%B6/three.js/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2021-puxiao-three.js-%E7%B3%BB%E5%88%97%E6%95%99%E7%A8%8B/02.%E5%88%9D%E5%A7%8B%E5%8C%96three.js-%E9%A1%B9%E7%9B%AE/>02.初始化Three.js 项目</a></li><li class="child level"><a href=/books/cg-notes/03.%E5%9B%BE%E5%BD%A2%E7%BB%98%E5%88%B6%E5%BA%93/web-%E5%9B%BE%E5%BD%A2%E7%BB%98%E5%88%B6/three.js/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2021-puxiao-three.js-%E7%B3%BB%E5%88%97%E6%95%99%E7%A8%8B/03.%E7%BC%96%E5%86%99hellothreejs/>03.编写HelloThreejs</a></li><li class="child level"><a href=/books/cg-notes/03.%E5%9B%BE%E5%BD%A2%E7%BB%98%E5%88%B6%E5%BA%93/web-%E5%9B%BE%E5%BD%A2%E7%BB%98%E5%88%B6/three.js/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2021-puxiao-three.js-%E7%B3%BB%E5%88%97%E6%95%99%E7%A8%8B/04.%E6%B7%BB%E5%8A%A0%E4%B8%80%E4%BA%9B%E8%87%AA%E9%80%82%E5%BA%94/>04.添加一些自适应</a></li><li class="child level"><a href=/books/cg-notes/03.%E5%9B%BE%E5%BD%A2%E7%BB%98%E5%88%B6%E5%BA%93/web-%E5%9B%BE%E5%BD%A2%E7%BB%98%E5%88%B6/three.js/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2021-puxiao-three.js-%E7%B3%BB%E5%88%97%E6%95%99%E7%A8%8B/05.three.js-%E5%9F%BA%E7%A1%80%E4%B9%8B%E5%9B%BE%E5%85%83/>05.Three.js 基础之图元</a></li><li class="child level"><a href=/books/cg-notes/03.%E5%9B%BE%E5%BD%A2%E7%BB%98%E5%88%B6%E5%BA%93/web-%E5%9B%BE%E5%BD%A2%E7%BB%98%E5%88%B6/three.js/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2021-puxiao-three.js-%E7%B3%BB%E5%88%97%E6%95%99%E7%A8%8B/06.%E5%9B%BE%E5%85%83%E7%BB%83%E4%B9%A0%E7%A4%BA%E4%BE%8B/>06.图元练习示例</a></li><li class="child level active"><a href=/books/cg-notes/03.%E5%9B%BE%E5%BD%A2%E7%BB%98%E5%88%B6%E5%BA%93/web-%E5%9B%BE%E5%BD%A2%E7%BB%98%E5%88%B6/three.js/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2021-puxiao-three.js-%E7%B3%BB%E5%88%97%E6%95%99%E7%A8%8B/07.%E5%9B%BE%E5%85%83%E4%B9%8B3d%E6%96%87%E5%AD%97/>07.图元之3D文字</a></li><li class="child level"><a href=/books/cg-notes/03.%E5%9B%BE%E5%BD%A2%E7%BB%98%E5%88%B6%E5%BA%93/web-%E5%9B%BE%E5%BD%A2%E7%BB%98%E5%88%B6/three.js/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2021-puxiao-three.js-%E7%B3%BB%E5%88%97%E6%95%99%E7%A8%8B/08.three.js-%E5%9F%BA%E7%A1%80%E4%B9%8B%E5%9C%BA%E6%99%AF/>08.Three.js 基础之场景</a></li><li class="child level"><a href=/books/cg-notes/03.%E5%9B%BE%E5%BD%A2%E7%BB%98%E5%88%B6%E5%BA%93/web-%E5%9B%BE%E5%BD%A2%E7%BB%98%E5%88%B6/three.js/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2021-puxiao-three.js-%E7%B3%BB%E5%88%97%E6%95%99%E7%A8%8B/09.three.js-%E5%9F%BA%E7%A1%80%E4%B9%8B%E6%9D%90%E8%B4%A8/>09.Three.js 基础之材质</a></li><li class="child level"><a href=/books/cg-notes/03.%E5%9B%BE%E5%BD%A2%E7%BB%98%E5%88%B6%E5%BA%93/web-%E5%9B%BE%E5%BD%A2%E7%BB%98%E5%88%B6/three.js/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2021-puxiao-three.js-%E7%B3%BB%E5%88%97%E6%95%99%E7%A8%8B/10.three.js-%E5%9F%BA%E7%A1%80%E4%B9%8B%E7%BA%B9%E7%90%86/>10.Three.js 基础之纹理</a></li><li class="child level"><a href=/books/cg-notes/03.%E5%9B%BE%E5%BD%A2%E7%BB%98%E5%88%B6%E5%BA%93/web-%E5%9B%BE%E5%BD%A2%E7%BB%98%E5%88%B6/three.js/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2021-puxiao-three.js-%E7%B3%BB%E5%88%97%E6%95%99%E7%A8%8B/11.three.js-%E5%9F%BA%E7%A1%80%E4%B9%8B%E7%81%AF%E5%85%89/>11.Three.js 基础之灯光</a></li><li class="child level"><a href=/books/cg-notes/03.%E5%9B%BE%E5%BD%A2%E7%BB%98%E5%88%B6%E5%BA%93/web-%E5%9B%BE%E5%BD%A2%E7%BB%98%E5%88%B6/three.js/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2021-puxiao-three.js-%E7%B3%BB%E5%88%97%E6%95%99%E7%A8%8B/12.three.js-%E5%9F%BA%E7%A1%80%E4%B9%8B%E9%95%9C%E5%A4%B4/>12.Three.js 基础之镜头</a></li><li class="child level"><a href=/books/cg-notes/03.%E5%9B%BE%E5%BD%A2%E7%BB%98%E5%88%B6%E5%BA%93/web-%E5%9B%BE%E5%BD%A2%E7%BB%98%E5%88%B6/three.js/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2021-puxiao-three.js-%E7%B3%BB%E5%88%97%E6%95%99%E7%A8%8B/13.three.js-%E5%9F%BA%E7%A1%80%E4%B9%8B%E9%98%B4%E5%BD%B1/>13.Three.js 基础之阴影</a></li><li class="child level"><a href=/books/cg-notes/03.%E5%9B%BE%E5%BD%A2%E7%BB%98%E5%88%B6%E5%BA%93/web-%E5%9B%BE%E5%BD%A2%E7%BB%98%E5%88%B6/three.js/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2021-puxiao-three.js-%E7%B3%BB%E5%88%97%E6%95%99%E7%A8%8B/14.three.js-%E5%9F%BA%E7%A1%80%E4%B9%8B%E9%9B%BE/>14.Three.js 基础之雾</a></li><li class="child level"><a href=/books/cg-notes/03.%E5%9B%BE%E5%BD%A2%E7%BB%98%E5%88%B6%E5%BA%93/web-%E5%9B%BE%E5%BD%A2%E7%BB%98%E5%88%B6/three.js/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2021-puxiao-three.js-%E7%B3%BB%E5%88%97%E6%95%99%E7%A8%8B/15.three.js-%E5%9F%BA%E7%A1%80%E4%B9%8B%E7%A6%BB%E5%B1%8F%E6%B8%B2%E6%9F%93/>15.Three.js 基础之离屏渲染</a></li><li class="child level"><a href=/books/cg-notes/03.%E5%9B%BE%E5%BD%A2%E7%BB%98%E5%88%B6%E5%BA%93/web-%E5%9B%BE%E5%BD%A2%E7%BB%98%E5%88%B6/three.js/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2021-puxiao-three.js-%E7%B3%BB%E5%88%97%E6%95%99%E7%A8%8B/16.three.js-%E5%9F%BA%E7%A1%80%E4%B9%8B%E8%87%AA%E5%AE%9A%E4%B9%89%E5%87%A0%E4%BD%95%E4%BD%93/>16.Three.js 基础之自定义几何体</a></li><li class="child level"><a href=/books/cg-notes/03.%E5%9B%BE%E5%BD%A2%E7%BB%98%E5%88%B6%E5%BA%93/web-%E5%9B%BE%E5%BD%A2%E7%BB%98%E5%88%B6/three.js/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2021-puxiao-three.js-%E7%B3%BB%E5%88%97%E6%95%99%E7%A8%8B/17.three.js-%E6%8A%80%E5%B7%A7%E4%B9%8B%E6%8C%89%E9%9C%80%E6%B8%B2%E6%9F%93/>17.Three.js 技巧之按需渲染</a></li><li class="child level"><a href=/books/cg-notes/03.%E5%9B%BE%E5%BD%A2%E7%BB%98%E5%88%B6%E5%BA%93/web-%E5%9B%BE%E5%BD%A2%E7%BB%98%E5%88%B6/three.js/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2021-puxiao-three.js-%E7%B3%BB%E5%88%97%E6%95%99%E7%A8%8B/18.three.js-%E6%8A%80%E5%B7%A7%E4%B9%8B%E8%B0%83%E8%AF%95/>18.Three.js 技巧之调试</a></li><li class="child level"><a href=/books/cg-notes/03.%E5%9B%BE%E5%BD%A2%E7%BB%98%E5%88%B6%E5%BA%93/web-%E5%9B%BE%E5%BD%A2%E7%BB%98%E5%88%B6/three.js/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2021-puxiao-three.js-%E7%B3%BB%E5%88%97%E6%95%99%E7%A8%8B/19.three.js-%E6%8A%80%E5%B7%A7%E4%B9%8B%E7%94%BB%E5%B8%83/>19.Three.js 技巧之画布</a></li><li class="child level"><a href=/books/cg-notes/03.%E5%9B%BE%E5%BD%A2%E7%BB%98%E5%88%B6%E5%BA%93/web-%E5%9B%BE%E5%BD%A2%E7%BB%98%E5%88%B6/three.js/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2021-puxiao-three.js-%E7%B3%BB%E5%88%97%E6%95%99%E7%A8%8B/20.three.js-%E4%BC%98%E5%8C%96%E4%B9%8B%E5%90%88%E5%B9%B6%E5%AF%B9%E8%B1%A1/>20.Three.js 优化之合并对象</a></li><li class="child level"><a href=/books/cg-notes/03.%E5%9B%BE%E5%BD%A2%E7%BB%98%E5%88%B6%E5%BA%93/web-%E5%9B%BE%E5%BD%A2%E7%BB%98%E5%88%B6/three.js/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2021-puxiao-three.js-%E7%B3%BB%E5%88%97%E6%95%99%E7%A8%8B/21.three.js-%E4%BC%98%E5%8C%96%E4%B9%8B%E5%90%88%E5%B9%B6%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%8A%A8%E7%94%BB/>21.Three.js 优化之合并对象的动画</a></li><li class="child level"><a href=/books/cg-notes/03.%E5%9B%BE%E5%BD%A2%E7%BB%98%E5%88%B6%E5%BA%93/web-%E5%9B%BE%E5%BD%A2%E7%BB%98%E5%88%B6/three.js/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2021-puxiao-three.js-%E7%B3%BB%E5%88%97%E6%95%99%E7%A8%8B/22.three.js-%E4%BC%98%E5%8C%96%E4%B9%8Boffscreencanvas%E4%B8%8Ewebworker/>22.Three.js 优化之OffscreenCanvas与WebWorker</a></li><li class="child level"><a href=/books/cg-notes/03.%E5%9B%BE%E5%BD%A2%E7%BB%98%E5%88%B6%E5%BA%93/web-%E5%9B%BE%E5%BD%A2%E7%BB%98%E5%88%B6/three.js/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2021-puxiao-three.js-%E7%B3%BB%E5%88%97%E6%95%99%E7%A8%8B/23.three.js-%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88%E4%B9%8B%E5%8A%A0%E8%BD%BD.obj%E6%A8%A1%E5%9E%8B/>23.Three.js 解决方案之加载.obj模型</a></li><li class="child level"><a href=/books/cg-notes/03.%E5%9B%BE%E5%BD%A2%E7%BB%98%E5%88%B6%E5%BA%93/web-%E5%9B%BE%E5%BD%A2%E7%BB%98%E5%88%B6/three.js/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2021-puxiao-three.js-%E7%B3%BB%E5%88%97%E6%95%99%E7%A8%8B/24.three.js-%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88%E4%B9%8B%E5%8A%A0%E8%BD%BD.gltf%E6%A8%A1%E5%9E%8B/>24.Three.js 解决方案之加载.gLTF模型</a></li><li class="child level"><a href=/books/cg-notes/03.%E5%9B%BE%E5%BD%A2%E7%BB%98%E5%88%B6%E5%BA%93/web-%E5%9B%BE%E5%BD%A2%E7%BB%98%E5%88%B6/three.js/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2021-puxiao-three.js-%E7%B3%BB%E5%88%97%E6%95%99%E7%A8%8B/25.three.js-%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88%E4%B9%8B%E6%B7%BB%E5%8A%A0%E8%83%8C%E6%99%AF%E5%92%8C%E5%A4%A9%E7%A9%BA%E7%9B%92/>25.Three.js 解决方案之添加背景和天空盒</a></li><li class="child level"><a href=/books/cg-notes/03.%E5%9B%BE%E5%BD%A2%E7%BB%98%E5%88%B6%E5%BA%93/web-%E5%9B%BE%E5%BD%A2%E7%BB%98%E5%88%B6/three.js/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2021-puxiao-three.js-%E7%B3%BB%E5%88%97%E6%95%99%E7%A8%8B/26.three.js-%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88%E4%B9%8B%E9%80%8F%E6%98%8E%E5%BA%A6bug/>26.Three.js 解决方案之透明度bug</a></li><li class="child level"><a href=/books/cg-notes/03.%E5%9B%BE%E5%BD%A2%E7%BB%98%E5%88%B6%E5%BA%93/web-%E5%9B%BE%E5%BD%A2%E7%BB%98%E5%88%B6/three.js/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2021-puxiao-three.js-%E7%B3%BB%E5%88%97%E6%95%99%E7%A8%8B/27.three.js-%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88%E4%B9%8B%E5%A4%9A%E7%94%BB%E5%B8%83%E5%A4%9A%E5%9C%BA%E6%99%AF/>27.Three.js 解决方案之多画布、多场景</a></li><li class="child level"><a href=/books/cg-notes/03.%E5%9B%BE%E5%BD%A2%E7%BB%98%E5%88%B6%E5%BA%93/web-%E5%9B%BE%E5%BD%A2%E7%BB%98%E5%88%B6/three.js/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2021-puxiao-three.js-%E7%B3%BB%E5%88%97%E6%95%99%E7%A8%8B/28.three.js-%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88%E4%B9%8B%E9%80%89%E4%B8%AD%E6%8B%BE%E5%8F%96%E6%9F%90%E7%89%A9%E4%BD%93/>28.Three.js 解决方案之选中、拾取某物体</a></li><li class="child level"><a href=/books/cg-notes/03.%E5%9B%BE%E5%BD%A2%E7%BB%98%E5%88%B6%E5%BA%93/web-%E5%9B%BE%E5%BD%A2%E7%BB%98%E5%88%B6/three.js/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2021-puxiao-three.js-%E7%B3%BB%E5%88%97%E6%95%99%E7%A8%8B/three.js-%E5%AE%9E%E7%94%A8%E7%9F%A5%E8%AF%86%E7%82%B9%E7%AC%94%E8%AE%B0/>Three.js 实用知识点笔记</a></li></ul></div></ul></div></nav></div><div class="d-none d-xl-block col-xl-2 docs-toc"><ul class="nav toc-top"><li><a href=# id=back_to_top class=docs-toc-title>目录</a></li></ul><nav id=TableOfContents><ul><li><a href=#fontloader-用法分析>FontLoader 用法分析</a><ul><li><a href=#fontloader>FontLoader：</a></li><li><a href=#font>Font：</a></li></ul></li><li><a href=#使用-fontloader-加载字体数据>使用 FontLoader 加载字体数据</a><ul><li><a href=#示例-1使用基础的方式进行加载>示例 1：使用基础的方式进行加载</a></li><li><a href=#示例-2使用-asyncawait-封装加载过程>示例 2：使用 async/await 封装加载过程</a></li></ul></li><li><a href=#改造我们之前写的-helloprimitives>改造我们之前写的 HelloPrimitives</a><ul><li><a href=#改造原因>改造原因：</a></li><li><a href=#my-textts>my-text.ts</a></li><li><a href=#indextsx>index.tsx</a></li></ul></li></ul></nav><div class="subscribe-module col-24 mt-1"><img src=https://ngte-superbed.oss-cn-beijing.aliyuncs.com/item/20230220172727.png alt=image title=王下邀月熊的微信公众号></div></div><main class="py-md-3 pl-md-3 docs-content col-xl-8" role=main><article class=article><h1>07.图元之3D文字</h1><div class=article-style><h1 id=07-图元之-3d-文字>07 图元之 3D 文字</h1><p>在 Three.js 所有内置的图元中，TextBufferGeometry 是最为特殊的一个。</p><p>**特殊之处在于：在使用 TextBufferGeometry 创建 文字几何对象之前，需要先加载 3D 字体数据。 **</p><p><strong>字体数据文件通常为 .json 文件，Three.js 提供了一个专门负责加载字体数据的类：FontLoader</strong></p><p><strong>由于需要加载外部字体数据文件，所以创建 3D 文字这个过程是异步的。</strong></p><p><strong>字体数据的补充说明：</strong></p><ol><li>字体数据 准确来说是描述字体轮廓的</li><li>字体数据 究竟包含哪些字符由 制作 3D 软件决定的，例如有些字体数据只针对字母，并不支持汉字。</li><li>若某个字符并不包含在 字体数据中，那么 Three.js 会将该字符替换为 问号(?)</li></ol><p>我们暂且先不考虑 字体数据文件 是如何在第 3 方 3D 软件中创建、导出的，先看一下如何加载字体数据文件。</p><h2 id=fontloader-用法分析>FontLoader 用法分析</h2><h3 id=fontloader>FontLoader：</h3><p>我先看一下 FontLoader.d.ts 的内容：</p><blockquote><p>这是本系列文章 第一次 从 .d.ts 文件角度来分析、推理 某个类的用法。</p><p>这也体现了使用 TypeScript 的好处，你可以随时去查看对应的 .d.ts 文件，去查看各种类的具体的使用方法</p></blockquote><div class=highlight><pre tabindex=0 class=chroma><code class=language-ts data-lang=ts><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>Loader</span> <span class=p>}</span> <span class=kr>from</span> <span class=s2>&#34;./Loader&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>LoadingManager</span> <span class=p>}</span> <span class=kr>from</span> <span class=s2>&#34;./LoadingManager&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>Font</span> <span class=p>}</span> <span class=kr>from</span> <span class=s2>&#34;./../extras/core/Font&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=kr>class</span> <span class=nx>FontLoader</span> <span class=kr>extends</span> <span class=nx>Loader</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>constructor</span><span class=p>(</span><span class=nx>manager?</span>: <span class=kt>LoadingManager</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=nx>load</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=nx>url</span>: <span class=kt>string</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>onLoad</span><span class=o>?:</span> <span class=p>(</span><span class=nx>responseFont</span>: <span class=kt>Font</span><span class=p>)</span> <span class=o>=&gt;</span> <span class=k>void</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>onProgress</span><span class=o>?:</span> <span class=p>(</span><span class=nx>event</span>: <span class=kt>ProgressEvent</span><span class=p>)</span> <span class=o>=&gt;</span> <span class=k>void</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>onError</span><span class=o>?:</span> <span class=p>(</span><span class=nx>event</span>: <span class=kt>ErrorEvent</span><span class=p>)</span> <span class=o>=&gt;</span> <span class=k>void</span>
</span></span><span class=line><span class=cl>  <span class=p>)</span><span class=o>:</span> <span class=k>void</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=nx>parse</span><span class=p>(</span><span class=nx>json</span>: <span class=kt>any</span><span class=p>)</span><span class=o>:</span> <span class=nx>Font</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p><strong>从上面可以看出：</strong></p><ol><li><p>FontLoader 继承于 Loader</p><blockquote><p>不难想象，在 Three.js 中一定还有负责加载其他资源类型的 Loader</p></blockquote></li><li><p>构造函数接收一个 LoadingManager 实例</p></li><li><p>方法 load( url, onLoad, onProgress, onError )，从字面上就能推测出：</p><ol><li>url：资源加载地址</li><li>onLoad：加载完成后，触发的事件回调函数</li><li>onProgress：加载过程中，触发的事件回调函数</li><li>onError：加载失败，触发的事件回调函数</li></ol></li><li><p>方法 parse( json ) ，用来解析 JSON 数据，并返回 Font 实例</p></li></ol><p><strong>延展说明：</strong></p><p>FontLoader 中牵扯到了另外 3 个类：Loader、LoadingManager、Font。</p><p>Loader 和 LoadingManager 内部封装了加载和解析数据的过程，我们暂时不用深究他们的源码和用法，接下来重点看一下 Font。</p><h3 id=font>Font：</h3><pre tabindex=0><code>import { Shape } from &#39;./Shape&#39;;

export class Font {

	constructor( jsondata: any );

	/**
	 * @default &#39;Font&#39;
	 */
	type: string;

	data: string;

	generateShapes( text: string, size: number ): Shape[];

}
</code></pre><p><strong>从上面可以看出：</strong></p><ol><li><p>Font 类是将 原始的字体数据 从 JSON 转化为 Three.js 内部可识别的 字体数据。</p></li><li><p>Font 构造函数接收的参数就是 JSON 数据</p></li><li><p>属性 type 默认值为 &lsquo;Font&rsquo;</p></li><li><p>属性 data 数据类型为字符串，我猜出 data 就是用来保存构造函数中 jsondata 数据的</p></li><li><p>方法 generateShapes( text, size ): Shape[]，根据参数来生成所有的 形状(shape)</p><blockquote><p>Shape 这个类在前面示例中使用过多次，shape 单词的本意就是 形状</p><p>Shape[] 表示这是一个 元祖数组，数组的每一个元素都必须是 Shape 实例</p></blockquote></li></ol><p>至此，对于 FontLoader、Font 已有大致了解，接下来该去尝试如何使用他们了。</p><h2 id=使用-fontloader-加载字体数据>使用 FontLoader 加载字体数据</h2><p><strong>我们使用 FontLoader 加载线上的一个字体数据：https://threejsfundamentals.org/threejs/resources/threejs/fonts/helvetiker_regular.typeface.json</strong></p><h3 id=示例-1使用基础的方式进行加载>示例 1：使用基础的方式进行加载</h3><pre tabindex=0><code>const loader = new FontLoader()
const url = &#39;https://threejsfundamentals.org/threejs/resources/threejs/fonts/helvetiker_regular.typeface.json&#39;

const onLoadHandle = (responseFont: Font) =&gt; {
    console.log(responseFont)
}
const onProgressHandle = (event: ProgressEvent&lt;EventTarget&gt;) =&gt; {
    console.log(event)
}
const onErrorHandle = (error: ErrorEvent) =&gt; {
    console.log(error)
}

loader.load(url, onLoadHandle, onProgressHandle, onErrorHandle)
</code></pre><p>以上代码中，采用最原始，基础的方式来加载 字体数据。</p><p>字体数据加载完成对应的 onLoadHandle 处理函数中，可以放置后续的操作。</p><h3 id=示例-2使用-asyncawait-封装加载过程>示例 2：使用 async/await 封装加载过程</h3><p><strong>我们封装的目标：将异步加载过程封装好，然后就可以像写同步代码一样去获取异步结果。</strong></p><p><strong>首先分析一下 示例 1 中几个关键点：</strong></p><ol><li>new FontLoader() 实例化一个 加载器</li><li>url：加载地址</li><li>onLoadHandle、onProgressHandle、onErrorHandle 3 个加载事件处理函数</li></ol><p><strong>封装思路分析：</strong></p><ol><li><p>实现方式肯定使用 promise + async/awiat</p></li><li><p>promise 中的 resolve 刚好对应 onLoadHandle</p></li><li><p>promise 中的 reject 刚好对应 onErrorHandle</p></li><li><p>至于加载过程 onProgressHandle，我们基本用不到他，所以直接选择忽略该回到函数</p><blockquote><p>届时我们会传递一个 undefined 来替代 onProgressHandle</p></blockquote></li></ol><p><strong>封装加载过程：</strong></p><pre tabindex=0><code>const loadFont: (url: string) =&gt; Promise&lt;Font&gt; = (url) =&gt; {
    const loader = new FontLoader()
    return new Promise((resolve, reject: (error: ErrorEvent) =&gt; void) =&gt; {
        loader.load(url, resolve, undefined, reject)
    })
}
</code></pre><p>只有在 async 函数中才可以使用到 Promise，所以我们还需要定义以下函数：</p><pre tabindex=0><code>const createText = async () =&gt; {

    const url = &#39;https://threejsfundamentals.org/threejs/resources/threejs/fonts/helvetiker_regular.typeface.json&#39;

    const font = await loadFont(url) //请注意这行代码，我们可以想使用同步编写的方式，获取到 字体数据

    //开始创建 3D 字体 几何对象
    ...
}

createText()
</code></pre><h2 id=改造我们之前写的-helloprimitives>改造我们之前写的 HelloPrimitives</h2><h3 id=改造原因>改造原因：</h3><ol><li>由于 TextBufferGeometry 创建过程为异步，async/await 具有函数异步传染性，因此我们需要将 index.tsx 中的代码也修改成异步</li><li>之前 index.tsx 中 useEffect( &mldr; ) 内容稍显复杂，我们特意将其中 随机生成材质、获得摆放位置 的响应代码从 useEffect 中提取出来，放到外部。</li></ol><h3 id=my-textts>my-text.ts</h3><pre tabindex=0><code>import { Font, FontLoader, Mesh, Object3D, TextBufferGeometry } from &#34;three&#34;;
import { createMaterial } from &#39;./index&#39;

const loadFont: (url: string) =&gt; Promise&lt;Font&gt; = (url) =&gt; {
    const loader = new FontLoader()
    return new Promise((resolve, reject: (error: ErrorEvent) =&gt; void) =&gt; {
        loader.load(url, resolve, undefined, reject)
    })
}

const createText = async () =&gt; {

    const url = &#39;https://threejsfundamentals.org/threejs/resources/threejs/fonts/helvetiker_regular.typeface.json&#39;

    const font = await loadFont(url) //异步加载 字体数据

    //第一个参数 &#39;puxiao&#39; 可以替换成任何其他的英文字母
    //特别注意：由于目前我们加载的 字体数据 只是针对英文字母的字体轮廓描述，并没有包含中文字体轮廓
    //所以如果设置成 汉字，则场景无法正常渲染出文字
    //对于无法渲染的字符，会被渲染成 问号(?) 作为替代
    //第二个参数对应的是文字外观配置
    const geometry = new TextBufferGeometry(&#39;puxiao&#39;, {
        font: font,
        size: 3.0,
        height: .2,
        curveSegments: 12,
        bevelEnabled: true,
        bevelThickness: 0.15,
        bevelSize: .3,
        bevelSegments: 5,
    })

    const mesh = new Mesh(geometry, createMaterial())

    //Three.js默认是以文字左侧为中心旋转点，下面的代码是将文字旋转点位置改为文字中心
    //实现的思路是：用文字的网格去套进另外一个网格，通过 2 个网格之间的落差来实现将旋转中心点转移到文字中心位置
    //具体代码细节，会在以后 场景 中详细学习，此刻你只需要照着以下代码敲就可以
    geometry.computeBoundingBox()
    geometry.boundingBox?.getCenter(mesh.position).multiplyScalar(-1)

    const text = new Object3D()
    text.add(mesh)

    return text
}

export default createText
</code></pre><h3 id=indextsx>index.tsx</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-ts data-lang=ts><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>useRef</span><span class=p>,</span> <span class=nx>useEffect</span><span class=p>,</span> <span class=nx>useCallback</span> <span class=p>}</span> <span class=kr>from</span> <span class=s2>&#34;react&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=o>*</span> <span class=kr>as</span> <span class=nx>Three</span> <span class=kr>from</span> <span class=s2>&#34;three&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=s2>&#34;./index.scss&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=nx>myBox</span> <span class=kr>from</span> <span class=s2>&#34;./my-box&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=nx>myCircle</span> <span class=kr>from</span> <span class=s2>&#34;./my-circle&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=nx>myCone</span> <span class=kr>from</span> <span class=s2>&#34;./my-cone&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=nx>myCylinder</span> <span class=kr>from</span> <span class=s2>&#34;./my-cylinder&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=nx>myDodecahedron</span> <span class=kr>from</span> <span class=s2>&#34;./my-dodecahedron&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=nx>myEdges</span> <span class=kr>from</span> <span class=s2>&#34;./my-edges&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=nx>myExtrude</span> <span class=kr>from</span> <span class=s2>&#34;./my-extrude&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=nx>myIcosahedron</span> <span class=kr>from</span> <span class=s2>&#34;./my-icosahedron&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=nx>myLathe</span> <span class=kr>from</span> <span class=s2>&#34;./my-lathe&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=nx>myOctahedron</span> <span class=kr>from</span> <span class=s2>&#34;./my-octahedron&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=nx>myParametric</span> <span class=kr>from</span> <span class=s2>&#34;./my-parametric&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=nx>myPlane</span> <span class=kr>from</span> <span class=s2>&#34;./my-plane&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=nx>myPolyhedron</span> <span class=kr>from</span> <span class=s2>&#34;./my-polyhedron&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=nx>myRing</span> <span class=kr>from</span> <span class=s2>&#34;./my-ring&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=nx>myShape</span> <span class=kr>from</span> <span class=s2>&#34;./my-shape&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=nx>mySphere</span> <span class=kr>from</span> <span class=s2>&#34;./my-sphere&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=nx>myTetrahedron</span> <span class=kr>from</span> <span class=s2>&#34;./my-tetrahedron&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=nx>myTorus</span> <span class=kr>from</span> <span class=s2>&#34;./my-torus&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=nx>myTorusKnot</span> <span class=kr>from</span> <span class=s2>&#34;./my-torus-knot&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=nx>myTube</span> <span class=kr>from</span> <span class=s2>&#34;./my-tube&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=nx>myWireframe</span> <span class=kr>from</span> <span class=s2>&#34;./my-wireframe&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=nx>createText</span> <span class=kr>from</span> <span class=s2>&#34;./my-text&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>meshArr</span><span class=o>:</span> <span class=p>(</span><span class=nx>Three</span><span class=p>.</span><span class=nx>Mesh</span> <span class=o>|</span> <span class=nx>Three</span><span class=p>.</span><span class=nx>LineSegments</span> <span class=o>|</span> <span class=nx>Three</span><span class=p>.</span><span class=nx>Object3D</span><span class=p>)[]</span> <span class=o>=</span> <span class=p>[];</span> <span class=c1>//保存所有图形的元数组
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=kr>const</span> <span class=nx>createMaterial</span> <span class=o>=</span> <span class=p>()</span> <span class=o>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>material</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Three</span><span class=p>.</span><span class=nx>MeshPhongMaterial</span><span class=p>({</span> <span class=nx>side</span>: <span class=kt>Three.DoubleSide</span> <span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>hue</span> <span class=o>=</span> <span class=nb>Math</span><span class=p>.</span><span class=nx>floor</span><span class=p>(</span><span class=nb>Math</span><span class=p>.</span><span class=nx>random</span><span class=p>()</span> <span class=o>*</span> <span class=mi>100</span><span class=p>)</span> <span class=o>/</span> <span class=mi>100</span><span class=p>;</span> <span class=c1>//随机获得一个色相
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kr>const</span> <span class=nx>saturation</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span> <span class=c1>//饱和度
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kr>const</span> <span class=nx>luminance</span> <span class=o>=</span> <span class=mf>0.5</span><span class=p>;</span> <span class=c1>//亮度
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>  <span class=nx>material</span><span class=p>.</span><span class=nx>color</span><span class=p>.</span><span class=nx>setHSL</span><span class=p>(</span><span class=nx>hue</span><span class=p>,</span> <span class=nx>saturation</span><span class=p>,</span> <span class=nx>luminance</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=nx>material</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>//定义物体在画面中显示的网格布局
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>eachRow</span> <span class=o>=</span> <span class=mi>5</span><span class=p>;</span> <span class=c1>//每一行显示 5 个
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>spread</span> <span class=o>=</span> <span class=mi>15</span><span class=p>;</span> <span class=c1>//行高 和 列宽
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>getPositionByIndex</span> <span class=o>=</span> <span class=p>(</span><span class=nx>index</span>: <span class=kt>number</span><span class=p>)</span> <span class=o>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=c1>//我们设定的排列是每行显示 eachRow，即 5 个物体、行高 和 列宽 均为 spread 即 15
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=c1>//因此每个物体根据顺序，计算出自己所在的位置
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kr>const</span> <span class=nx>row</span> <span class=o>=</span> <span class=nb>Math</span><span class=p>.</span><span class=nx>floor</span><span class=p>(</span><span class=nx>index</span> <span class=o>/</span> <span class=nx>eachRow</span><span class=p>);</span> <span class=c1>//计算出所在行
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kr>const</span> <span class=nx>column</span> <span class=o>=</span> <span class=nx>index</span> <span class=o>%</span> <span class=nx>eachRow</span><span class=p>;</span> <span class=c1>//计算出所在列
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>x</span> <span class=o>=</span> <span class=p>(</span><span class=nx>column</span> <span class=o>-</span> <span class=mi>2</span><span class=p>)</span> <span class=o>*</span> <span class=nx>spread</span><span class=p>;</span> <span class=c1>//为什么要 -2 ？
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=c1>//因为我们希望将每一行物体摆放的单元格，依次是：-2、-1、0、1、2，这样可以使每一整行物体处于居中显示
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kr>const</span> <span class=nx>y</span> <span class=o>=</span> <span class=p>(</span><span class=mi>2</span> <span class=o>-</span> <span class=nx>row</span><span class=p>)</span> <span class=o>*</span> <span class=nx>spread</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=p>{</span> <span class=nx>x</span><span class=p>,</span> <span class=nx>y</span> <span class=p>};</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>HelloPrimitives</span> <span class=o>=</span> <span class=p>()</span> <span class=o>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>canvasRef</span> <span class=o>=</span> <span class=nx>useRef</span><span class=p>&lt;</span><span class=nt>HTMLCanvasElement</span><span class=p>&gt;(</span><span class=kc>null</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>rendererRef</span> <span class=o>=</span> <span class=nx>useRef</span><span class=p>&lt;</span><span class=nt>Three.WebGLRenderer</span> <span class=err>|</span> <span class=na>null</span><span class=p>&gt;(</span><span class=kc>null</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>cameraRef</span> <span class=o>=</span> <span class=nx>useRef</span><span class=p>&lt;</span><span class=nt>Three.PerspectiveCamera</span> <span class=err>|</span> <span class=na>null</span><span class=p>&gt;(</span><span class=kc>null</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>createInit</span> <span class=o>=</span> <span class=nx>useCallback</span><span class=p>(</span><span class=kr>async</span> <span class=p>()</span> <span class=o>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nx>canvasRef</span><span class=p>.</span><span class=nx>current</span> <span class=o>===</span> <span class=kc>null</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>return</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>meshArr</span><span class=p>.</span><span class=nx>length</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=c1>//以防万一，先清空原有数组
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=c1>//初始化场景
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kr>const</span> <span class=nx>scene</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Three</span><span class=p>.</span><span class=nx>Scene</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=nx>scene</span><span class=p>.</span><span class=nx>background</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Three</span><span class=p>.</span><span class=nx>Color</span><span class=p>(</span><span class=mh>0xaaaaaa</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>//初始化镜头
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kr>const</span> <span class=nx>camera</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Three</span><span class=p>.</span><span class=nx>PerspectiveCamera</span><span class=p>(</span><span class=mi>40</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mf>0.1</span><span class=p>,</span> <span class=mi>1000</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nx>camera</span><span class=p>.</span><span class=nx>position</span><span class=p>.</span><span class=nx>z</span> <span class=o>=</span> <span class=mi>120</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=nx>cameraRef</span><span class=p>.</span><span class=nx>current</span> <span class=o>=</span> <span class=nx>camera</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>//初始化渲染器
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kr>const</span> <span class=nx>renderer</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Three</span><span class=p>.</span><span class=nx>WebGLRenderer</span><span class=p>({</span>
</span></span><span class=line><span class=cl>      <span class=nx>canvas</span>: <span class=kt>canvasRef.current</span> <span class=kr>as</span> <span class=nx>HTMLCanvasElement</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=p>});</span>
</span></span><span class=line><span class=cl>    <span class=nx>rendererRef</span><span class=p>.</span><span class=nx>current</span> <span class=o>=</span> <span class=nx>renderer</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>//添加 2 盏灯光
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kr>const</span> <span class=nx>light0</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Three</span><span class=p>.</span><span class=nx>DirectionalLight</span><span class=p>(</span><span class=mh>0xffffff</span><span class=p>,</span> <span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nx>light0</span><span class=p>.</span><span class=nx>position</span><span class=p>.</span><span class=kr>set</span><span class=p>(</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>4</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nx>scene</span><span class=p>.</span><span class=nx>add</span><span class=p>(</span><span class=nx>light0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>light1</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Three</span><span class=p>.</span><span class=nx>DirectionalLight</span><span class=p>(</span><span class=mh>0xffffff</span><span class=p>,</span> <span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nx>light0</span><span class=p>.</span><span class=nx>position</span><span class=p>.</span><span class=kr>set</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=o>-</span><span class=mi>2</span><span class=p>,</span> <span class=o>-</span><span class=mi>4</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nx>scene</span><span class=p>.</span><span class=nx>add</span><span class=p>(</span><span class=nx>light1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>//获得各个 solid 类型的图元实例，并添加到 solidPrimitivesArr 中
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kr>const</span> <span class=nx>solidPrimitivesArr</span>: <span class=kt>Three.BufferGeometry</span><span class=p>[]</span> <span class=o>=</span> <span class=p>[];</span>
</span></span><span class=line><span class=cl>    <span class=nx>solidPrimitivesArr</span><span class=p>.</span><span class=nx>push</span><span class=p>(</span>
</span></span><span class=line><span class=cl>      <span class=nx>myBox</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nx>myCircle</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nx>myCone</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nx>myCylinder</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nx>myDodecahedron</span>
</span></span><span class=line><span class=cl>    <span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nx>solidPrimitivesArr</span><span class=p>.</span><span class=nx>push</span><span class=p>(</span>
</span></span><span class=line><span class=cl>      <span class=nx>myExtrude</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nx>myIcosahedron</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nx>myLathe</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nx>myOctahedron</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nx>myParametric</span>
</span></span><span class=line><span class=cl>    <span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nx>solidPrimitivesArr</span><span class=p>.</span><span class=nx>push</span><span class=p>(</span><span class=nx>myPlane</span><span class=p>,</span> <span class=nx>myPolyhedron</span><span class=p>,</span> <span class=nx>myRing</span><span class=p>,</span> <span class=nx>myShape</span><span class=p>,</span> <span class=nx>mySphere</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nx>solidPrimitivesArr</span><span class=p>.</span><span class=nx>push</span><span class=p>(</span><span class=nx>myTetrahedron</span><span class=p>,</span> <span class=nx>myTorus</span><span class=p>,</span> <span class=nx>myTorusKnot</span><span class=p>,</span> <span class=nx>myTube</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>//将各个 solid 类型的图元实例转化为网格，并添加到 primitivesArr 中
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>solidPrimitivesArr</span><span class=p>.</span><span class=nx>forEach</span><span class=p>((</span><span class=nx>item</span><span class=p>)</span> <span class=o>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=kr>const</span> <span class=nx>material</span> <span class=o>=</span> <span class=nx>createMaterial</span><span class=p>();</span> <span class=c1>//随机获得一种颜色材质
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=kr>const</span> <span class=nx>mesh</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Three</span><span class=p>.</span><span class=nx>Mesh</span><span class=p>(</span><span class=nx>item</span><span class=p>,</span> <span class=nx>material</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=nx>meshArr</span><span class=p>.</span><span class=nx>push</span><span class=p>(</span><span class=nx>mesh</span><span class=p>);</span> <span class=c1>//将网格添加到网格数组中
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>//创建 3D 文字，并添加到 mesArr 中，请注意此函数为异步函数
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>meshArr</span><span class=p>.</span><span class=nx>push</span><span class=p>(</span><span class=k>await</span> <span class=nx>createText</span><span class=p>());</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>//获得各个 line 类型的图元实例，并添加到 meshArr 中
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kr>const</span> <span class=nx>linePrimitivesArr</span>: <span class=kt>Three.BufferGeometry</span><span class=p>[]</span> <span class=o>=</span> <span class=p>[];</span>
</span></span><span class=line><span class=cl>    <span class=nx>linePrimitivesArr</span><span class=p>.</span><span class=nx>push</span><span class=p>(</span><span class=nx>myEdges</span><span class=p>,</span> <span class=nx>myWireframe</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>//将各个 line 类型的图元实例转化为网格，并添加到 meshArr 中
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>linePrimitivesArr</span><span class=p>.</span><span class=nx>forEach</span><span class=p>((</span><span class=nx>item</span><span class=p>)</span> <span class=o>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=kr>const</span> <span class=nx>material</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Three</span><span class=p>.</span><span class=nx>LineBasicMaterial</span><span class=p>({</span> <span class=nx>color</span>: <span class=kt>0x000000</span> <span class=p>});</span>
</span></span><span class=line><span class=cl>      <span class=kr>const</span> <span class=nx>mesh</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Three</span><span class=p>.</span><span class=nx>LineSegments</span><span class=p>(</span><span class=nx>item</span><span class=p>,</span> <span class=nx>material</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=nx>meshArr</span><span class=p>.</span><span class=nx>push</span><span class=p>(</span><span class=nx>mesh</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>//配置每一个图元实例，转化为网格，并位置和材质后，将其添加到场景中
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>meshArr</span><span class=p>.</span><span class=nx>forEach</span><span class=p>((</span><span class=nx>mesh</span><span class=p>,</span> <span class=nx>index</span><span class=p>)</span> <span class=o>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=kr>const</span> <span class=p>{</span> <span class=nx>x</span><span class=p>,</span> <span class=nx>y</span> <span class=p>}</span> <span class=o>=</span> <span class=nx>getPositionByIndex</span><span class=p>(</span><span class=nx>index</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      <span class=nx>mesh</span><span class=p>.</span><span class=nx>position</span><span class=p>.</span><span class=nx>x</span> <span class=o>=</span> <span class=nx>x</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=nx>mesh</span><span class=p>.</span><span class=nx>position</span><span class=p>.</span><span class=nx>y</span> <span class=o>=</span> <span class=nx>y</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      <span class=nx>scene</span><span class=p>.</span><span class=nx>add</span><span class=p>(</span><span class=nx>mesh</span><span class=p>);</span> <span class=c1>//将网格添加到场景中
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>//添加自动旋转渲染动画
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kr>const</span> <span class=nx>render</span> <span class=o>=</span> <span class=p>(</span><span class=nx>time</span>: <span class=kt>number</span><span class=p>)</span> <span class=o>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>time</span> <span class=o>=</span> <span class=nx>time</span> <span class=o>*</span> <span class=mf>0.001</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=nx>meshArr</span><span class=p>.</span><span class=nx>forEach</span><span class=p>((</span><span class=nx>item</span><span class=p>)</span> <span class=o>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>item</span><span class=p>.</span><span class=nx>rotation</span><span class=p>.</span><span class=nx>x</span> <span class=o>=</span> <span class=nx>time</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=nx>item</span><span class=p>.</span><span class=nx>rotation</span><span class=p>.</span><span class=nx>y</span> <span class=o>=</span> <span class=nx>time</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      <span class=nx>renderer</span><span class=p>.</span><span class=nx>render</span><span class=p>(</span><span class=nx>scene</span><span class=p>,</span> <span class=nx>camera</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=nb>window</span><span class=p>.</span><span class=nx>requestAnimationFrame</span><span class=p>(</span><span class=nx>render</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>};</span>
</span></span><span class=line><span class=cl>    <span class=nb>window</span><span class=p>.</span><span class=nx>requestAnimationFrame</span><span class=p>(</span><span class=nx>render</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span> <span class=p>[</span><span class=nx>canvasRef</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>resizeHandle</span> <span class=o>=</span> <span class=p>()</span> <span class=o>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>//根据窗口大小变化，重新修改渲染器的视椎
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>if</span> <span class=p>(</span><span class=nx>rendererRef</span><span class=p>.</span><span class=nx>current</span> <span class=o>===</span> <span class=kc>null</span> <span class=o>||</span> <span class=nx>cameraRef</span><span class=p>.</span><span class=nx>current</span> <span class=o>===</span> <span class=kc>null</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>return</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>canvas</span> <span class=o>=</span> <span class=nx>rendererRef</span><span class=p>.</span><span class=nx>current</span><span class=p>.</span><span class=nx>domElement</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=nx>cameraRef</span><span class=p>.</span><span class=nx>current</span><span class=p>.</span><span class=nx>aspect</span> <span class=o>=</span> <span class=nx>canvas</span><span class=p>.</span><span class=nx>clientWidth</span> <span class=o>/</span> <span class=nx>canvas</span><span class=p>.</span><span class=nx>clientHeight</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=nx>cameraRef</span><span class=p>.</span><span class=nx>current</span><span class=p>.</span><span class=nx>updateProjectionMatrix</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=nx>rendererRef</span><span class=p>.</span><span class=nx>current</span><span class=p>.</span><span class=nx>setSize</span><span class=p>(</span><span class=nx>canvas</span><span class=p>.</span><span class=nx>clientWidth</span><span class=p>,</span> <span class=nx>canvas</span><span class=p>.</span><span class=nx>clientHeight</span><span class=p>,</span> <span class=kc>false</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>//组件首次装载到网页后触发，开始创建并初始化 3D 场景
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>useEffect</span><span class=p>(()</span> <span class=o>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>createInit</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=nx>resizeHandle</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=nb>window</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s2>&#34;resize&#34;</span><span class=p>,</span> <span class=nx>resizeHandle</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>()</span> <span class=o>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nb>window</span><span class=p>.</span><span class=nx>removeEventListener</span><span class=p>(</span><span class=s2>&#34;resize&#34;</span><span class=p>,</span> <span class=nx>resizeHandle</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>};</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span> <span class=p>[</span><span class=nx>canvasRef</span><span class=p>,</span> <span class=nx>createInit</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=p>&lt;</span><span class=nt>canvas</span> <span class=na>ref</span><span class=o>=</span><span class=p>{</span><span class=nx>canvasRef</span><span class=p>}</span> <span class=na>className</span><span class=o>=</span><span class=s>&#34;full-screen&#34;</span> <span class=p>/&gt;;</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=nx>HelloPrimitives</span><span class=p>;</span>
</span></span></code></pre></div><p>特别提醒：虽然针对 index.tsx 进行了修改，但是并不影响之前创建的其他图元，其他图元并不需要修改任何代码。</p><blockquote><p>你是否想也赶紧自己去创建一份可以显示中文的 3D 字体数据？<br>这需要你会一些 3D 软件，例如 C4D(收费软件)、blender(免费开源软件)<br>在后续的学习中，一定会涉及到自定义字体样式、自定义几何图形，自己建模的，目前主要任务还是先系统学习 Three.js。</p></blockquote><p>至此，Three.js 中内置的 22 种图元，均逐一尝试完毕。</p><p>同时也意味着，我们 Three.js 的 hello world 之旅完成，通过 HelloThreejs、HelloPrimitives，我们该体验的代码也都体验过了。</p><p><strong>接下来就要逐个开始深入、详细学习 具体的各个模块的用法。</strong></p><p><strong>加油！</strong></p></div><div class=article-widget><div class="container-xl row post-nav"><div class="col-6 post-nav-item"><div class=meta-nav>上一页</div><a href=/books/cg-notes/03.%E5%9B%BE%E5%BD%A2%E7%BB%98%E5%88%B6%E5%BA%93/web-%E5%9B%BE%E5%BD%A2%E7%BB%98%E5%88%B6/three.js/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2021-puxiao-three.js-%E7%B3%BB%E5%88%97%E6%95%99%E7%A8%8B/06.%E5%9B%BE%E5%85%83%E7%BB%83%E4%B9%A0%E7%A4%BA%E4%BE%8B/ rel=next>06.图元练习示例</a></div><div class="col-6 post-nav-item"><div class=meta-nav>下一页</div><a href=/books/cg-notes/03.%E5%9B%BE%E5%BD%A2%E7%BB%98%E5%88%B6%E5%BA%93/web-%E5%9B%BE%E5%BD%A2%E7%BB%98%E5%88%B6/three.js/99.%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/2021-puxiao-three.js-%E7%B3%BB%E5%88%97%E6%95%99%E7%A8%8B/08.three.js-%E5%9F%BA%E7%A1%80%E4%B9%8B%E5%9C%BA%E6%99%AF/ rel=prev>08.Three.js 基础之场景</a></div></div></div><div class=body-footer><p>最近更新于 0001-01-01</p><section id=comments class="mb-3 pt-0"><div id=disqus_thread></div><script>var disqus_config=function(){};(function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="https://ngte.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)})()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></section></div></article><footer class=site-footer><div class="copyright py-4 bg-footer"><div class="row justify-content-center"><div class="text-center footer-color"><p class=mb-0>© 2017-2022 NGTE all rights reserved</p></div></div></div><script type=text/javascript id=clstr_globe async src="//clustrmaps.com/globe.js?d=kgpJG5sWZQpKujBmD-uW1B54-WBPol-DuDtrB2KFjKs"></script></footer></main></div></div><script src=//unpkg.com/heti/umd/heti-addon.min.js></script>
<script>const heti=new Heti(".article");heti.autoSpacing()</script><script type=text/javascript>window.$crisp=[],window.CRISP_WEBSITE_ID="12adcc35-9621-4313-8262-62dc654b29d8",function(){setTimeout(function(){d=document,s=d.createElement("script"),s.src="https://client.crisp.chat/l.js",s.async=1,d.getElementsByTagName("head")[0].appendChild(s)},2500)}()</script></div><div class=page-footer></div><script src=/js/vendor-bundle.min.d26509351aa0ff874abbee824e982e9b.js></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.1/highlight.min.js integrity="sha512-Ypjm0o7jOxAd4hpdoppSEN0TQOC19UtPAqD+4s5AlXmUvbmmS/YMxYqAqarQYyxTnB6/rqip9qcxlNB/3U9Wdg==" crossorigin=anonymous></script>
<script id=search-hit-algolia-template type=text/html><div class=search-hit><div class=search-hit-content><div class=search-hit-name><a href={{relpermalink}}>{{#helpers.highlight}}{ "attribute": "title" }{{/helpers.highlight}}</a></div><div class="article-metadata search-hit-type">{{type}}</div><p class=search-hit-description>{{#helpers.highlight}}{ "attribute": "summary" }{{/helpers.highlight}}</p></div></div></script><script src=https://cdn.jsdelivr.net/npm/instantsearch.js@4/dist/instantsearch.production.min.js crossorigin=anonymous></script>
<script id=dsq-count-scr src=https://ngte.disqus.com/count.js async></script>
<script src=/zh/js/algolia-search-built.min.4387d694ca1258194aaf562b8cd1c400.js type=module></script>
<script id=page-data type=application/json>{"use_headroom":false}</script><script src=/zh/js/wowchemy.min.d1673c7a11d1238516cbe12a1e84257f.js></script>
<script>var mybutton=document.getElementById("backTopBtn");window.onscroll=function(){scrollFunction()};function scrollFunction(){document.body.scrollTop>20||document.documentElement.scrollTop>20?mybutton.style.display="block":mybutton.style.display="none"}function topFunction(){document.body.scrollTop=0,document.documentElement.scrollTop=0}</script><script src=https://cdn.jsdelivr.net/gh/bryanbraun/anchorjs@4.2.2/anchor.min.js integrity="sha512-I7w3ZdSFzw5j3jU3ZkNikBNeIrl3i+hEuEdwNmqUJvwNcaBUNcijnP2gd9DtGlgVYDplfjGoD8vTNsID+lCjqg==" crossorigin=anonymous></script>
<script>anchors.add()</script><script>(function(){"use strict";if(!document.queryCommandSupported("copy"))return;function e(e,t){e.className="highlight-copy-btn",e.textContent=t,setTimeout(function(){e.textContent="",e.className="highlight-copy-btn fa fa-copy"},1e3)}function t(e){var t=window.getSelection(),n=document.createRange();return n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n),t}function n(n){var o,s=document.createElement("button");s.className="highlight-copy-btn fa fa-copy",s.textContent="",o=n.firstElementChild,s.addEventListener("click",function(){try{var n=t(o);document.execCommand("copy"),n.removeAllRanges(),e(s,"已复制")}catch(t){console&&console.log(t),e(s,"Failed :'(")}}),n.appendChild(s)}var s=document.getElementsByClassName("highlight");Array.prototype.forEach.call(s,n)})()</script></body></html>