<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>K8s | Next-gen Tech Edu</title><link>https://ng-tech.icu/books/awesome-cheatsheets/4.infrastructure/cloud/k8s/</link><atom:link href="https://ng-tech.icu/books/awesome-cheatsheets/4.infrastructure/cloud/k8s/index.xml" rel="self" type="application/rss+xml"/><description>K8s</description><generator>Wowchemy (https://wowchemy.com)</generator><language>zh</language><image><url>https://ng-tech.icu/media/sharing.png</url><title>K8s</title><link>https://ng-tech.icu/books/awesome-cheatsheets/4.infrastructure/cloud/k8s/</link></image><item><title>Kubectl-CheatSheet</title><link>https://ng-tech.icu/books/awesome-cheatsheets/4.infrastructure/cloud/k8s/kubectl-cheatsheet/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://ng-tech.icu/books/awesome-cheatsheets/4.infrastructure/cloud/k8s/kubectl-cheatsheet/</guid><description>&lt;h1 id="kubectl-cheatsheet">kubectl CheatSheet&lt;/h1>
&lt;h2 id="11-common-commands">1.1 Common Commands&lt;/h2>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>Name&lt;/th>
&lt;th>Command&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>Run curl test temporarily&lt;/td>
&lt;td>&lt;code>kubectl run --generator=run-pod/v1 --rm mytest --image=yauritux/busybox-curl -it&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Run wget test temporarily&lt;/td>
&lt;td>&lt;code>kubectl run --generator=run-pod/v1 --rm mytest --image=busybox -it wget&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Run nginx deployment with 2 replicas&lt;/td>
&lt;td>&lt;code>kubectl run my-nginx --image=nginx --replicas=2 --port=80&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Run nginx pod and expose it&lt;/td>
&lt;td>&lt;code>kubectl run my-nginx --restart=Never --image=nginx --port=80 --expose&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Run nginx deployment and expose it&lt;/td>
&lt;td>&lt;code>kubectl run my-nginx --image=nginx --port=80 --expose&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>List authenticated contexts&lt;/td>
&lt;td>&lt;code>kubectl config get-contexts&lt;/code>, &lt;code>~/.kube/config&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Set namespace preference&lt;/td>
&lt;td>&lt;code>kubectl config set-context &amp;lt;context_name&amp;gt; --namespace=&amp;lt;ns_name&amp;gt;&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>List pods with nodes info&lt;/td>
&lt;td>&lt;code>kubectl get pod -o wide&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>List everything&lt;/td>
&lt;td>&lt;code>kubectl get all --all-namespaces&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Get all services&lt;/td>
&lt;td>&lt;code>kubectl get service --all-namespaces&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Get all deployments&lt;/td>
&lt;td>&lt;code>kubectl get deployments --all-namespaces&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Show nodes with labels&lt;/td>
&lt;td>&lt;code>kubectl get nodes --show-labels&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Get resources with json output&lt;/td>
&lt;td>&lt;code>kubectl get pods --all-namespaces -o json&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Validate yaml file with dry run&lt;/td>
&lt;td>&lt;code>kubectl create --dry-run --validate -f pod-dummy.yaml&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Start a temporary pod for testing&lt;/td>
&lt;td>&lt;code>kubectl run --rm -i -t --image=alpine test-$RANDOM -- sh&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>kubectl run shell command&lt;/td>
&lt;td>&lt;code>kubectl exec -it mytest -- ls -l /etc/hosts&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Get system conf via configmap&lt;/td>
&lt;td>&lt;code>kubectl -n kube-system get cm kubeadm-config -o yaml&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Get deployment yaml&lt;/td>
&lt;td>&lt;code>kubectl -n denny-websites get deployment mysql -o yaml&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Explain resource&lt;/td>
&lt;td>&lt;code>kubectl explain pods&lt;/code>, &lt;code>kubectl explain svc&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Watch pods&lt;/td>
&lt;td>&lt;code>kubectl get pods -n wordpress --watch&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Query healthcheck endpoint&lt;/td>
&lt;td>&lt;code>curl -L http://127.0.0.1:10250/healthz&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Open a bash terminal in a pod&lt;/td>
&lt;td>&lt;code>kubectl exec -it storage sh&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Check pod environment variables&lt;/td>
&lt;td>&lt;code>kubectl exec redis-master-ft9ex env&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Enable kubectl shell autocompletion&lt;/td>
&lt;td>&lt;code>echo &amp;quot;source &amp;lt;(kubectl completion bash)&amp;quot; &amp;gt;&amp;gt;~/.bashrc&lt;/code>, and reload&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Use minikube dockerd in your laptop&lt;/td>
&lt;td>&lt;code>eval $(minikube docker-env)&lt;/code>, No need to push docker hub any more&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Kubectl apply a folder of yaml files&lt;/td>
&lt;td>&lt;code>kubectl apply -R -f .&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Get services sorted by name&lt;/td>
&lt;td>kubectl get services –sort-by=.metadata.name&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Get pods sorted by restart count&lt;/td>
&lt;td>kubectl get pods –sort-by=’.status.containerStatuses[0].restartCount’&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>List pods and images&lt;/td>
&lt;td>kubectl get pods -o=’custom-columns=PODS:.metadata.name,Images:.spec.containers[*].image’&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>List all container images&lt;/td>
&lt;td>&lt;a href="https://github.com/dennyzhang/cheatsheet-kubernetes-A4/blob/master/list-all-images.sh#L14-L17" target="_blank" rel="noopener">list-all-images.sh&lt;/a>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>kubeconfig skip tls verification&lt;/td>
&lt;td>&lt;a href="https://github.com/dennyzhang/cheatsheet-kubernetes-A4/blob/master/skip-tls-verify.md" target="_blank" rel="noopener">skip-tls-verify.md&lt;/a>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;a href="https://kubernetes.io/docs/tasks/tools/install-kubectl/" target="_blank" rel="noopener">Ubuntu install kubectl&lt;/a>&lt;/td>
&lt;td>=”deb &lt;a href="https://apt.kubernetes.io/" target="_blank" rel="noopener">https://apt.kubernetes.io/&lt;/a> kubernetes-xenial main”=&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Reference&lt;/td>
&lt;td>&lt;a href="https://github.com/kubernetes/kubernetes/tags" target="_blank" rel="noopener">GitHub: kubernetes releases&lt;/a>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Reference&lt;/td>
&lt;td>&lt;a href="https://cheatsheet.dennyzhang.com/cheatsheet-minikube-A4" target="_blank" rel="noopener">minikube cheatsheet&lt;/a>, &lt;a href="https://cheatsheet.dennyzhang.com/cheatsheet-docker-A4" target="_blank" rel="noopener">docker cheatsheet&lt;/a>, &lt;a href="https://cheatsheet.dennyzhang.com/cheatsheet-openshift-A4" target="_blank" rel="noopener">OpenShift CheatSheet&lt;/a>&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h2 id="12-check-performance">1.2 Check Performance&lt;/h2>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>Name&lt;/th>
&lt;th>Command&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>Get node resource usage&lt;/td>
&lt;td>&lt;code>kubectl top node&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Get pod resource usage&lt;/td>
&lt;td>&lt;code>kubectl top pod&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Get resource usage for a given pod&lt;/td>
&lt;td>&lt;code>kubectl top &amp;lt;podname&amp;gt; --containers&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>List resource utilization for all containers&lt;/td>
&lt;td>&lt;code>kubectl top pod --all-namespaces --containers=true&lt;/code>&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h2 id="13-resources-deletion">1.3 Resources Deletion&lt;/h2>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>Name&lt;/th>
&lt;th>Command&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>Delete pod&lt;/td>
&lt;td>&lt;code>kubectl delete pod/&amp;lt;pod-name&amp;gt; -n &amp;lt;my-namespace&amp;gt;&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Delete pod by force&lt;/td>
&lt;td>&lt;code>kubectl delete pod/&amp;lt;pod-name&amp;gt; --grace-period=0 --force&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Delete pods by labels&lt;/td>
&lt;td>&lt;code>kubectl delete pod -l env=test&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Delete deployments by labels&lt;/td>
&lt;td>&lt;code>kubectl delete deployment -l app=wordpress&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Delete all resources filtered by labels&lt;/td>
&lt;td>&lt;code>kubectl delete pods,services -l name=myLabel&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Delete resources under a namespace&lt;/td>
&lt;td>&lt;code>kubectl -n my-ns delete po,svc --all&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Delete persist volumes by labels&lt;/td>
&lt;td>&lt;code>kubectl delete pvc -l app=wordpress&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Delete state fulset only (not pods)&lt;/td>
&lt;td>&lt;code>kubectl delete sts/&amp;lt;stateful_set_name&amp;gt; --cascade=false&lt;/code>&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;p>&lt;a href="https://cheatsheet.dennyzhang.com/" target="_blank" rel="noopener">
&lt;figure >
&lt;div class="d-flex justify-content-center">
&lt;div class="w-100" >&lt;img src="https://raw.githubusercontent.com/dennyzhang/cheatsheet.dennyzhang.com/master/images/cheatsheet_dns.png" alt="img" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>&lt;/a>&lt;/p>
&lt;h2 id="14-log--conf-files">1.4 Log &amp;amp; Conf Files&lt;/h2>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>Name&lt;/th>
&lt;th>Comment&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>Config folder&lt;/td>
&lt;td>&lt;code>/etc/kubernetes/&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Certificate files&lt;/td>
&lt;td>&lt;code>/etc/kubernetes/pki/&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Credentials to API server&lt;/td>
&lt;td>&lt;code>/etc/kubernetes/kubelet.conf&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Superuser credentials&lt;/td>
&lt;td>&lt;code>/etc/kubernetes/admin.conf&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>kubectl config file&lt;/td>
&lt;td>&lt;code>~/.kube/config&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Kubernetes working dir&lt;/td>
&lt;td>&lt;code>/var/lib/kubelet/&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Docker working dir&lt;/td>
&lt;td>&lt;code>/var/lib/docker/&lt;/code>, &lt;code>/var/log/containers/&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Etcd working dir&lt;/td>
&lt;td>&lt;code>/var/lib/etcd/&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Network cni&lt;/td>
&lt;td>&lt;code>/etc/cni/net.d/&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Log files&lt;/td>
&lt;td>&lt;code>/var/log/pods/&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>log in worker node&lt;/td>
&lt;td>&lt;code>/var/log/kubelet.log&lt;/code>, &lt;code>/var/log/kube-proxy.log&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>log in master node&lt;/td>
&lt;td>&lt;code>kube-apiserver.log&lt;/code>, &lt;code>kube-scheduler.log&lt;/code>, &lt;code>kube-controller-manager.log&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Env&lt;/td>
&lt;td>&lt;code>/etc/systemd/system/kubelet.service.d/10-kubeadm.conf&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Env&lt;/td>
&lt;td>export KUBECONFIG=/etc/kubernetes/admin.conf&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">$ kubectl logs my-pod &lt;span class="c1"># dump pod logs (stdout)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ kubectl logs -l &lt;span class="nv">name&lt;/span>&lt;span class="o">=&lt;/span>myLabel &lt;span class="c1"># dump pod logs, with label name=myLabel (stdout)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ kubectl logs my-pod --previous &lt;span class="c1"># dump pod logs (stdout) for a previous instantiation of a container&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ kubectl logs my-pod -c my-container &lt;span class="c1"># dump pod container logs (stdout, multi-container case)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ kubectl logs -l &lt;span class="nv">name&lt;/span>&lt;span class="o">=&lt;/span>myLabel -c my-container &lt;span class="c1"># dump pod logs, with label name=myLabel (stdout)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ kubectl logs my-pod -c my-container --previous &lt;span class="c1"># dump pod container logs (stdout, multi-container case) for a previous instantiation of a container&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ kubectl logs -f my-pod &lt;span class="c1"># stream pod logs (stdout)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ kubectl logs -f my-pod -c my-container &lt;span class="c1"># stream pod container logs (stdout, multi-container case)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ kubectl logs -f -l &lt;span class="nv">name&lt;/span>&lt;span class="o">=&lt;/span>myLabel --all-containers &lt;span class="c1"># stream all pods logs with label name=myLabel (stdout)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ kubectl logs --tail&lt;span class="o">=&lt;/span>&lt;span class="m">20&lt;/span> nginx &lt;span class="c1"># Display only the most recent 20 lines of output in pod nginx&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ kubectl logs --since&lt;span class="o">=&lt;/span>1h nginx &lt;span class="c1"># Show all logs from pod nginx written in the last hour&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="15-pod">1.5 Pod&lt;/h2>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>Name&lt;/th>
&lt;th>Command&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>List all pods&lt;/td>
&lt;td>&lt;code>kubectl get pods&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>List pods for all namespace&lt;/td>
&lt;td>&lt;code>kubectl get pods -all-namespaces&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>List all critical pods&lt;/td>
&lt;td>&lt;code>kubectl get -n kube-system pods -a&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>List pods with more info&lt;/td>
&lt;td>&lt;code>kubectl get pod -o wide&lt;/code>, &lt;code>kubectl get pod/&amp;lt;pod-name&amp;gt; -o yaml&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Get pod info&lt;/td>
&lt;td>&lt;code>kubectl describe pod/srv-mysql-server&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>List all pods with labels&lt;/td>
&lt;td>&lt;code>kubectl get pods --show-labels&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;a href="https://github.com/kubernetes/kubernetes/issues/49387" target="_blank" rel="noopener">List all unhealthy pods&lt;/a>&lt;/td>
&lt;td>kubectl get pods –field-selector=status.phase!=Running –all-namespaces&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>List running pods&lt;/td>
&lt;td>kubectl get pods –field-selector=status.phase=Running&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Get Pod initContainer status&lt;/td>
&lt;td>&lt;code>kubectl get pod --template '{{.status.initContainerStatuses}}' &amp;lt;pod-name&amp;gt;&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>kubectl run command&lt;/td>
&lt;td>kubectl exec -it -n “$ns” “$podname” – sh -c “echo $msg &amp;raquo;/dev/err.log”&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Watch pods&lt;/td>
&lt;td>&lt;code>kubectl get pods -n wordpress --watch&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Get pod by selector&lt;/td>
&lt;td>kubectl get pods –selector=”app=syslog” -o jsonpath=’{.items[*].metadata.name}’&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>List pods and images&lt;/td>
&lt;td>kubectl get pods -o=’custom-columns=PODS:.metadata.name,Images:.spec.containers[*].image’&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>List pods and containers&lt;/td>
&lt;td>-o=’custom-columns=PODS:.metadata.name,CONTAINERS:.spec.containers[*].name’&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Reference&lt;/td>
&lt;td>&lt;a href="https://cheatsheet.dennyzhang.com/kubernetes-yaml-templates" target="_blank" rel="noopener">Link: kubernetes yaml templates&lt;/a>&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h2 id="16-label--annotation">1.6 Label &amp;amp; Annotation&lt;/h2>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>Name&lt;/th>
&lt;th>Command&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>Filter pods by label&lt;/td>
&lt;td>&lt;code>kubectl get pods -l owner=denny&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Manually add label to a pod&lt;/td>
&lt;td>&lt;code>kubectl label pods dummy-input owner=denny&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Remove label&lt;/td>
&lt;td>&lt;code>kubectl label pods dummy-input owner-&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Manually add annotation to a pod&lt;/td>
&lt;td>&lt;code>kubectl annotate pods dummy-input my-url=https://dennyzhang.com&lt;/code>&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h2 id="17-deployment--scale">1.7 Deployment &amp;amp; Scale&lt;/h2>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>Name&lt;/th>
&lt;th>Command&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>Scale out&lt;/td>
&lt;td>&lt;code>kubectl scale --replicas=3 deployment/nginx-app&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>online rolling upgrade&lt;/td>
&lt;td>&lt;code>kubectl rollout app-v1 app-v2 --image=img:v2&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Roll backup&lt;/td>
&lt;td>&lt;code>kubectl rollout app-v1 app-v2 --rollback&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>List rollout&lt;/td>
&lt;td>&lt;code>kubectl get rs&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Check update status&lt;/td>
&lt;td>&lt;code>kubectl rollout status deployment/nginx-app&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Check update history&lt;/td>
&lt;td>&lt;code>kubectl rollout history deployment/nginx-app&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Pause/Resume&lt;/td>
&lt;td>&lt;code>kubectl rollout pause deployment/nginx-deployment&lt;/code>, &lt;code>resume&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Rollback to previous version&lt;/td>
&lt;td>&lt;code>kubectl rollout undo deployment/nginx-deployment&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Reference&lt;/td>
&lt;td>&lt;a href="https://cheatsheet.dennyzhang.com/kubernetes-yaml-templates" target="_blank" rel="noopener">Link: kubernetes yaml templates&lt;/a>, &lt;a href="https://kubernetes.io/docs/concepts/workloads/controllers/deployment/#pausing-and-resuming-a-deployment" target="_blank" rel="noopener">Link: Pausing and Resuming a Deployment&lt;/a>&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h2 id="18-quota--limits--resource">1.8 Quota &amp;amp; Limits &amp;amp; Resource&lt;/h2>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>Name&lt;/th>
&lt;th>Command&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>List Resource Quota&lt;/td>
&lt;td>&lt;code>kubectl get resourcequota&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>List Limit Range&lt;/td>
&lt;td>&lt;code>kubectl get limitrange&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Customize resource definition&lt;/td>
&lt;td>&lt;code>kubectl set resources deployment nginx -c=nginx --limits=cpu=200m&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Customize resource definition&lt;/td>
&lt;td>&lt;code>kubectl set resources deployment nginx -c=nginx --limits=memory=512Mi&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Reference&lt;/td>
&lt;td>&lt;a href="https://cheatsheet.dennyzhang.com/kubernetes-yaml-templates" target="_blank" rel="noopener">Link: kubernetes yaml templates&lt;/a>&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h2 id="19-service">1.9 Service&lt;/h2>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>Name&lt;/th>
&lt;th>Command&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>List all services&lt;/td>
&lt;td>&lt;code>kubectl get services&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>List service endpoints&lt;/td>
&lt;td>&lt;code>kubectl get endpoints&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Get service detail&lt;/td>
&lt;td>&lt;code>kubectl get service nginx-service -o yaml&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Get service cluster ip&lt;/td>
&lt;td>kubectl get service nginx-service -o go-template=’{{.spec.clusterIP}}’&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Get service cluster port&lt;/td>
&lt;td>kubectl get service nginx-service -o go-template=’{{(index .spec.ports 0).port}}’&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Expose deployment as lb service&lt;/td>
&lt;td>&lt;code>kubectl expose deployment/my-app --type=LoadBalancer --name=my-service&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Expose service as lb service&lt;/td>
&lt;td>&lt;code>kubectl expose service/wordpress-1-svc --type=LoadBalancer --name=ns1&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Reference&lt;/td>
&lt;td>&lt;a href="https://cheatsheet.dennyzhang.com/kubernetes-yaml-templates" target="_blank" rel="noopener">Link: kubernetes yaml templates&lt;/a>&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h2 id="110-secrets">1.10 Secrets&lt;/h2>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>Name&lt;/th>
&lt;th>Command&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>List secrets&lt;/td>
&lt;td>&lt;code>kubectl get secrets --all-namespaces&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Generate secret&lt;/td>
&lt;td>&lt;code>echo -n 'mypasswd', then redirect to base64 --decode&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Get secret&lt;/td>
&lt;td>&lt;code>kubectl get secret denny-cluster-kubeconfig&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Get a specific field of a secret&lt;/td>
&lt;td>kubectl get secret denny-cluster-kubeconfig -o jsonpath=”{.data.value}”&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Create secret from cfg file&lt;/td>
&lt;td>kubectl create secret generic db-user-pass –from-file=./username.txt&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Reference&lt;/td>
&lt;td>&lt;a href="https://cheatsheet.dennyzhang.com/kubernetes-yaml-templates" target="_blank" rel="noopener">Link: kubernetes yaml templates&lt;/a>, &lt;a href="https://kubernetes.io/docs/concepts/configuration/secret/" target="_blank" rel="noopener">Link: Secrets&lt;/a>&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h2 id="111-statefulset">1.11 StatefulSet&lt;/h2>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>Name&lt;/th>
&lt;th>Command&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>List statefulset&lt;/td>
&lt;td>&lt;code>kubectl get sts&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Delete statefulset only (not pods)&lt;/td>
&lt;td>&lt;code>kubectl delete sts/&amp;lt;stateful_set_name&amp;gt; --cascade=false&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Scale statefulset&lt;/td>
&lt;td>&lt;code>kubectl scale sts/&amp;lt;stateful_set_name&amp;gt; --replicas=5&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Reference&lt;/td>
&lt;td>&lt;a href="https://cheatsheet.dennyzhang.com/kubernetes-yaml-templates" target="_blank" rel="noopener">Link: kubernetes yaml templates&lt;/a>&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h2 id="112-volumes--volume-claims">1.12 Volumes &amp;amp; Volume Claims&lt;/h2>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>Name&lt;/th>
&lt;th>Command&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>List storage class&lt;/td>
&lt;td>&lt;code>kubectl get storageclass&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Check the mounted volumes&lt;/td>
&lt;td>&lt;code>kubectl exec storage ls /data&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Check persist volume&lt;/td>
&lt;td>&lt;code>kubectl describe pv/pv0001&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Copy local file to pod&lt;/td>
&lt;td>&lt;code>kubectl cp /tmp/my &amp;lt;some-namespace&amp;gt;/&amp;lt;some-pod&amp;gt;:/tmp/server&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Copy pod file to local&lt;/td>
&lt;td>&lt;code>kubectl cp &amp;lt;some-namespace&amp;gt;/&amp;lt;some-pod&amp;gt;:/tmp/server /tmp/my&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Reference&lt;/td>
&lt;td>&lt;a href="https://cheatsheet.dennyzhang.com/kubernetes-yaml-templates" target="_blank" rel="noopener">Link: kubernetes yaml templates&lt;/a>&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h2 id="113-events--metrics">1.13 Events &amp;amp; Metrics&lt;/h2>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>Name&lt;/th>
&lt;th>Command&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>View all events&lt;/td>
&lt;td>&lt;code>kubectl get events --all-namespaces&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>List Events sorted by timestamp&lt;/td>
&lt;td>kubectl get events –sort-by=.metadata.creationTimestamp&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h2 id="114-node-maintenance">1.14 Node Maintenance&lt;/h2>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>Name&lt;/th>
&lt;th>Command&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>Mark node as unschedulable&lt;/td>
&lt;td>&lt;code>kubectl cordon $NODE_NAME&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Mark node as schedulable&lt;/td>
&lt;td>&lt;code>kubectl uncordon $NODE_NAME&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Drain node in preparation for maintenance&lt;/td>
&lt;td>&lt;code>kubectl drain $NODE_NAME&lt;/code>&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h2 id="115-namespace--security">1.15 Namespace &amp;amp; Security&lt;/h2>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>Name&lt;/th>
&lt;th>Command&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>List authenticated contexts&lt;/td>
&lt;td>&lt;code>kubectl config get-contexts&lt;/code>, &lt;code>~/.kube/config&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Set namespace preference&lt;/td>
&lt;td>&lt;code>kubectl config set-context &amp;lt;context_name&amp;gt; --namespace=&amp;lt;ns_name&amp;gt;&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Switch context&lt;/td>
&lt;td>&lt;code>kubectl config use-context &amp;lt;context_name&amp;gt;&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Load context from config file&lt;/td>
&lt;td>&lt;code>kubectl get cs --kubeconfig kube_config.yml&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Delete the specified context&lt;/td>
&lt;td>&lt;code>kubectl config delete-context &amp;lt;context_name&amp;gt;&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>List all namespaces defined&lt;/td>
&lt;td>&lt;code>kubectl get namespaces&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>List certificates&lt;/td>
&lt;td>&lt;code>kubectl get csr&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;a href="https://kubernetes.io/docs/concepts/policy/pod-security-policy/" target="_blank" rel="noopener">Check user privilege&lt;/a>&lt;/td>
&lt;td>kubectl –as=system:serviceaccount:ns-denny:test-privileged-sa -n ns-denny auth can-i use pods/list&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;a href="https://kubernetes.io/docs/concepts/policy/pod-security-policy/" target="_blank" rel="noopener">Check user privilege&lt;/a>&lt;/td>
&lt;td>&lt;code>kubectl auth can-i use pods/list&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Reference&lt;/td>
&lt;td>&lt;a href="https://cheatsheet.dennyzhang.com/kubernetes-yaml-templates" target="_blank" rel="noopener">Link: kubernetes yaml templates&lt;/a>&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h2 id="116-network">1.16 Network&lt;/h2>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>Name&lt;/th>
&lt;th>Command&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>Temporarily add a port-forwarding&lt;/td>
&lt;td>&lt;code>kubectl port-forward redis-134 6379:6379&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Add port-forwarding for deployment&lt;/td>
&lt;td>&lt;code>kubectl port-forward deployment/redis-master 6379:6379&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Add port-forwarding for replicaset&lt;/td>
&lt;td>&lt;code>kubectl port-forward rs/redis-master 6379:6379&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Add port-forwarding for service&lt;/td>
&lt;td>&lt;code>kubectl port-forward svc/redis-master 6379:6379&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Get network policy&lt;/td>
&lt;td>&lt;code>kubectl get NetworkPolicy&lt;/code>&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h2 id="117-patch">1.17 Patch&lt;/h2>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>Name&lt;/th>
&lt;th>Summary&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>Patch service to loadbalancer&lt;/td>
&lt;td>kubectl patch svc $svc_name -p ‘{“spec”: {“type”: “LoadBalancer”}}’&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h2 id="118-extenstions">1.18 Extenstions&lt;/h2>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>Name&lt;/th>
&lt;th>Summary&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>Enumerates the resource types available&lt;/td>
&lt;td>&lt;code>kubectl api-resources&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>List api group&lt;/td>
&lt;td>&lt;code>kubectl api-versions&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>List all CRD&lt;/td>
&lt;td>&lt;code>kubectl get crd&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>List storageclass&lt;/td>
&lt;td>&lt;code>kubectl get storageclass&lt;/code>&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;p>&lt;a href="https://cheatsheet.dennyzhang.com/" target="_blank" rel="noopener">
&lt;figure >
&lt;div class="d-flex justify-content-center">
&lt;div class="w-100" >&lt;img src="https://raw.githubusercontent.com/dennyzhang/cheatsheet.dennyzhang.com/master/images/cheatsheet_dns.png" alt="img" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>&lt;/a>&lt;/p>
&lt;h2 id="119-components--services">1.19 Components &amp;amp; Services&lt;/h2>
&lt;h3 id="1191-services-on-master-nodes">1.19.1 Services on Master Nodes&lt;/h3>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>Name&lt;/th>
&lt;th>Summary&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>&lt;a href="https://github.com/kubernetes/kubernetes/tree/master/cmd/kube-apiserver" target="_blank" rel="noopener">kube-apiserver&lt;/a>&lt;/td>
&lt;td>API gateway. Exposes the Kubernetes API from master nodes&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;a href="https://coreos.com/etcd/" target="_blank" rel="noopener">etcd&lt;/a>&lt;/td>
&lt;td>reliable data store for all k8s cluster data&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;a href="https://github.com/kubernetes/kubernetes/tree/master/cmd/kube-scheduler" target="_blank" rel="noopener">kube-scheduler&lt;/a>&lt;/td>
&lt;td>schedule pods to run on selected nodes&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;a href="https://github.com/kubernetes/kubernetes/tree/master/cmd/kube-controller-manager" target="_blank" rel="noopener">kube-controller-manager&lt;/a>&lt;/td>
&lt;td>Reconcile the states. node/replication/endpoints/token controller and service account, etc&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>cloud-controller-manager&lt;/td>
&lt;td>&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h3 id="1192-services-on-worker-nodes">1.19.2 Services on Worker Nodes&lt;/h3>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>Name&lt;/th>
&lt;th>Summary&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>&lt;a href="https://github.com/kubernetes/kubernetes/tree/master/cmd/kubelet" target="_blank" rel="noopener">kubelet&lt;/a>&lt;/td>
&lt;td>A node agent makes sure that containers are running in a pod&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;a href="https://github.com/kubernetes/kubernetes/tree/master/cmd/kube-proxy" target="_blank" rel="noopener">kube-proxy&lt;/a>&lt;/td>
&lt;td>Manage network connectivity to the containers. e.g, iptable, ipvs&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;a href="https://github.com/docker/engine" target="_blank" rel="noopener">Container Runtime&lt;/a>&lt;/td>
&lt;td>Kubernetes supported runtimes: dockerd, cri-o, runc and any &lt;a href="https://github.com/opencontainers/runtime-spec" target="_blank" rel="noopener">OCI runtime-spec&lt;/a> implementation.&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h3 id="1193-addons-pods-and-services-that-implement-cluster-features">1.19.3 Addons: pods and services that implement cluster features&lt;/h3>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>Name&lt;/th>
&lt;th>Summary&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>DNS&lt;/td>
&lt;td>serves DNS records for Kubernetes services&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Web UI&lt;/td>
&lt;td>a general purpose, web-based UI for Kubernetes clusters&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Container Resource Monitoring&lt;/td>
&lt;td>collect, store and serve container metrics&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Cluster-level Logging&lt;/td>
&lt;td>save container logs to a central log store with search/browsing interface&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h3 id="1194-tools">1.19.4 Tools&lt;/h3>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>Name&lt;/th>
&lt;th>Summary&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>&lt;a href="https://github.com/kubernetes/kubernetes/tree/master/cmd/kubectl" target="_blank" rel="noopener">kubectl&lt;/a>&lt;/td>
&lt;td>the command line util to talk to k8s cluster&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;a href="https://github.com/kubernetes/kubernetes/tree/master/cmd/kubeadm" target="_blank" rel="noopener">kubeadm&lt;/a>&lt;/td>
&lt;td>the command to bootstrap the cluster&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;a href="https://kubernetes.io/docs/reference/setup-tools/kubefed/kubefed/" target="_blank" rel="noopener">kubefed&lt;/a>&lt;/td>
&lt;td>the command line to control a Kubernetes Cluster Federation&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Kubernetes Components&lt;/td>
&lt;td>[Link: Kubernetes Components&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table></description></item></channel></rss>