<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>4.Infrastructure | Next-gen Tech Edu</title><link>https://ng-tech.icu/books/awesome-cheatsheets/4.infrastructure/</link><atom:link href="https://ng-tech.icu/books/awesome-cheatsheets/4.infrastructure/index.xml" rel="self" type="application/rss+xml"/><description>4.Infrastructure</description><generator>Wowchemy (https://wowchemy.com)</generator><language>zh</language><image><url>https://ng-tech.icu/media/sharing.png</url><title>4.Infrastructure</title><link>https://ng-tech.icu/books/awesome-cheatsheets/4.infrastructure/</link></image><item><title>Blockchain-CheatSheet</title><link>https://ng-tech.icu/books/awesome-cheatsheets/4.infrastructure/blockchain-cheatsheet/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://ng-tech.icu/books/awesome-cheatsheets/4.infrastructure/blockchain-cheatsheet/</guid><description>&lt;h1 id="åŒºå—é“¾">åŒºå—é“¾&lt;/h1>
&lt;p>In essence, the blockchain is a shared, programmable, cryptographically secure and therefore trusted ledger which no single user controls and which can be inspected by anyone.- Klaus Schwab&lt;/p>
&lt;p>åŒºå—é“¾æŠ€æœ¯æ˜¯æœ€è¿‘åœ¨äº’è”ç½‘æŠ€æœ¯å‰æ²¿æ¯”è¾ƒç«çš„ä¸€ä¸ªè¯¾é¢˜ï¼Œå®ƒçš„å‡ºçŽ°è§£å†³äº†åœ¨ç‚¹å¯¹ç‚¹é€šä¿¡ä¸­ä¸€ç›´å­˜åœ¨çš„ä¸€ä¸ªåŸºæœ¬é—®é¢˜ï¼Œå³è‘—åçš„æ‹œå åº­å°†å†›é—®é¢˜ã€‚é€šä¿—åœ°è®²å°±æ˜¯åœ¨ä¸€ä¸ªåŽ»ä¸­å¿ƒåŒ–çš„ç½‘ç»œä¸­å¦‚ä½•å¯¹ä¸€ä¸ªä¿¡æ¯ä¼ é€’(æ¯”å¦‚ä¸€ç¬”æ”¯ä»˜)è¾¾æˆå…¨ç½‘å…±è¯†ã€‚&lt;/p>
&lt;p>åŒºå—é“¾ç”±æ—¶é—´åºåˆ—çš„é“¾å¼æ•°æ®å—æž„æˆï¼Œæä¾›äº†æ‹œå åº­å®¹é”™ã€å¹¶åŸºäºŽå…±è¯†åè®®ä¿è¯äº†æœ€ç»ˆä¸€è‡´æ€§çš„åˆ†å¸ƒå¼æ•°æ®åº“ã€‚&lt;/p>
&lt;p>åŒºå—é“¾æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªåŽ»ä¸­å¿ƒåŒ–çš„åˆ†å¸ƒå¼è´¦æœ¬æ•°æ®åº“ï¼Œæ˜¯æ¯”ç‰¹å¸çš„åº•å±‚æŠ€æœ¯ï¼Œå’Œæ¯”ç‰¹å¸æ˜¯ç›¸ä¼´ç›¸ç”Ÿçš„å…³ç³»ã€‚åŒºå—é“¾æœ¬èº«å…¶å®žæ˜¯ä¸€ä¸²ä½¿ç”¨å¯†ç å­¦ç›¸å…³è”æ‰€äº§ç”Ÿçš„æ•°æ®å—ï¼Œæ¯ä¸€ä¸ªæ•°æ®å—ä¸­åŒ…å«äº†å¤šæ¬¡æ¯”ç‰¹å¸ç½‘ç»œäº¤æ˜“æœ‰æ•ˆç¡®è®¤çš„ä¿¡æ¯ã€‚
æ¯å½“æœ‰åŠ å¯†äº¤æ˜“äº§ç”Ÿæ—¶ï¼Œç½‘ç»œä¸­æœ‰å¼ºå¤§è¿ç®—èƒ½åŠ›çš„çŸ¿å·¥(Miner)å°±å¼€å§‹åˆ©ç”¨ç®—æ³•è§£å¯†éªŒè¯äº¤æ˜“ï¼Œåˆ›é€ å‡ºæ–°çš„åŒºå—æ¥è®°å½•æœ€æ–°çš„äº¤æ˜“ã€‚æ–°çš„åŒºå—æŒ‰ç…§æ—¶é—´é¡ºåºçº¿æ€§åœ°è¢«è¡¥å……åˆ°åŽŸæœ‰çš„åŒºå—é“¾æœ«ç«¯ï¼Œè¿™ä¸ªè´¦æœ¬å°±ä¼šä¸åœåœ°å¢žé•¿å’Œå»¶é•¿ã€‚&lt;/p>
&lt;p>é€šè¿‡å¤æ‚çš„å…¬å…±é’¥åŒ™å’Œç§äººé’¥åŒ™çš„è®¾ç½®ï¼ŒåŒºå—é“¾ç½‘ç»œå°†æ•´ä¸ªé‡‘èžç½‘ç»œçš„æ‰€æœ‰äº¤æ˜“çš„è´¦æœ¬å®žæ—¶å¹¿æ’­ï¼Œå®žæ—¶å°†äº¤æ˜“è®°å½•åˆ†å‘åˆ°æ¯ä¸€ä¸ªå®¢æˆ·ç«¯ï¼ŒåŒæ—¶è¿˜èƒ½ä¿è¯æ¯ä¸ªäººåªèƒ½å¯¹è‡ªå·±çš„è´¢äº§è¿›è¡Œä¿®æ”¹ã€‚å½“ç„¶ï¼Œè´¦æœ¬é‡Œä¹Ÿæœ‰åˆ«äººçš„äº¤æ˜“è®°å½•ï¼Œè™½ç„¶å¯ä»¥çœ‹åˆ°æ•°å€¼å’Œå¯¹åº”çš„äº¤æ˜“åœ°å€(åŸºæœ¬ä¸Šè¿™æ˜¯ç”±ä¸€æ®µå†—é•¿çš„ä¹±åºå­—æ¯å’Œæ•°å­—ç»„æˆ)ï¼Œä½†æ˜¯å¦‚æžœä¸å€Ÿç”¨å…¶ä»–&lt;/p>
&lt;p>æŠ€æœ¯æ‰‹æ®µä¹Ÿæ ¹æœ¬æ— æ³•çŸ¥é“äº¤æ˜“è€…çš„çœŸå®žèº«ä»½ã€‚
å¦‚æžœä»Žä¸åŒçš„æŠ€æœ¯è§’åº¦æ¥å‰–æžï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·çœ‹å¾…åŒºå—é“¾ï¼šå®ƒæ˜¯ä¸€ç§æ•°æ®åº“ã€ä¸€ç§åˆ†å¸ƒå¼ç³»ç»Ÿï¼Œä¹Ÿæ˜¯ä¸€ç§ç½‘ç»œåº•å±‚åè®®ã€‚
(1)æ•°æ®åº“ã€‚åŒºå—é“¾æ˜¯ä¸€ç§å…¬å…±æ•°æ®åº“ï¼Œå®ƒè®°å½•äº†ç½‘é™…é—´æ‰€æœ‰çš„äº¤æ˜“ä¿¡æ¯ï¼Œéšæ—¶æ›´æ–°ï¼Œè®©æ¯ä¸ªç”¨æˆ·å¯ä»¥é€šè¿‡åˆæ³•çš„æ‰‹æ®µä»Žä¸­è¯»å–ä¿¡æ¯ï¼Œå†™å…¥ä¿¡æ¯ã€‚ä½†åˆæœ‰ä¸€å¥—ç‰¹æ®Šçš„æœºåˆ¶ï¼Œé˜²æ­¢ä»¥å¾€çš„æ•°æ®è¢«ç¯¡æ”¹ã€‚
(2)åˆ†å¸ƒå¼ç³»ç»Ÿã€‚åŒºå—é“¾æ˜¯ä¸€ç§åˆ†å¸ƒå¼ç³»ç»Ÿï¼Œå®ƒä¸å­˜å‚¨æ”¾ç½®åœ¨æŸä¸€ä¸¤ä¸ªç‰¹å®šçš„æœåŠ¡å™¨æˆ–å®‰å…¨èŠ‚ç‚¹ä¸Šï¼Œè€Œæ˜¯åˆ†å¸ƒå¼åœ°å­˜åœ¨äºŽç½‘ç»œä¸Šæ‰€æœ‰çš„å®Œæ•´èŠ‚ç‚¹ä¸Šï¼Œåœ¨æ¯ä¸€ä¸ªèŠ‚ç‚¹ä¿ç•™ä¿¡æ¯å¤‡ä»½ã€‚
(3)ç½‘ç»œåº•å±‚åè®®ã€‚åŒºå—é“¾æ˜¯ä¸€ç§å…±è¯†åè®®ï¼ŒåŸºäºŽè¿™ç§åè®®ï¼Œå¯ä»¥åœ¨å…¶ä¸Šå¼€å‘å‡ºæ•°ç›®ç¹å¤šçš„åº”ç”¨ã€‚è¿™äº›åº”ç”¨åœ¨æ¯ä¸€æ—¶åˆ»éƒ½ä¿å­˜ä¸€æ¡æœ€é•¿çš„ã€æœ€å…·æƒå¨çš„ã€å…±åŒè®¤å¯çš„æ•°æ®è®°å½•ï¼Œå¹¶éµå¾ªå…±åŒè®¤å¯çš„æœºåˆ¶è¿›è¡Œæ— é¡»ä¸­é—´æƒå¨ä»²è£çš„ã€ç›´æŽ¥çš„ã€ç‚¹å¯¹ç‚¹çš„äº¤äº’ä¿¡æ¯ã€‚&lt;/p>
&lt;h1 id="æ•°å­—è´§å¸">æ•°å­—è´§å¸&lt;/h1>
&lt;p>æ•°å­—è´§å¸åº”ç”¨æ–¹å‘&lt;/p>
&lt;p>æ•°å­—è´§å¸æ˜¯åŒºå—é“¾çš„ç¬¬ä¸€å¤§åº”ç”¨ç±»åž‹ï¼Œå…¶å®žä½ å¯ä»¥ç®€å•ç†è§£ä¸ºä¸€ç§æ— ä¸»æƒã€ç¤¾åŒºè‡ªæ²»çš„è´§å¸å½¢å¼ã€‚æ•°å­—è´§å¸é€šå¸¸æ˜¯åŸºäºŽåŒºå—é“¾æŠ€æœ¯ã€åœ¨å…¨çƒèŒƒå›´å†…å…¬å¼€å‘è¡Œçš„ã€å¹¶ä¸”æ²¡æœ‰ä»»ä½•å›½å®¶æ”¿åºœèƒŒä¹¦çš„è™šæ‹Ÿè´§å¸ï¼Œè¿™ç§è™šæ‹Ÿè´§å¸å…·æœ‰â€œåŽ»ä¿¡ä»»â€ã€â€œç‚¹å¯¹ç‚¹â€ã€â€œå…¬å¼€è®°è´¦â€ã€â€œä¸å¯ç¯¡æ”¹â€ç­‰ç‰¹å¾ã€‚&lt;/p>
&lt;p>æ€»é‡é€æ˜Žå…¬å¼€ã€‚æ•°å­—è´§å¸çš„å‘è¡Œæ˜¯åœ¨é¡¹ç›®åˆ›å»ºä¹‹åˆï¼Œæ˜¯ç™½çš®ä¹¦äº‹å…ˆå°±è§„å®šå¥½äº†çš„ï¼Œç™½çš®ä¹¦é€šå¸¸æ˜¯ä¸€ä¸ªåŒºå—é“¾é¡¹ç›®å…¬å¼€å‘å¸ƒçš„ä¸€ç§é˜è¿°æ€§æ–‡æ¡£ï¼Œå…¶ä¸­ç®€è¿°äº†é¡¹ç›®çš„å®—æ—¨å’Œæ„¿æ™¯ä»¥åŠè®¾è®¡è“å›¾ã€‚&lt;/p>
&lt;p>æ•°å­—è´§å¸ç¼“æ…¢é‡Šæ”¾ã€‚æ•°å­—è´§å¸ç¼“æ…¢é‡Šæ”¾ã€‚æŒ–çŸ¿ä¸ºæ•°å­—è´§å¸çš„ç¼“æ…¢é‡Šæ”¾æä¾›äº†ä¸€ç§æ–¹æ³•ã€‚&lt;/p>
&lt;p>ä»£ç æ‰§è¡Œè§„åˆ™ã€‚ç”±äºŽæˆ‘ä»¬åœ¨ç™½çš®ä¹¦ä¸­è§„å®šå¥½äº†æ€»é‡å’Œæ•°å­—è´§å¸é‡Šæ”¾çš„æœºåˆ¶ï¼Œç™½çš®ä¹¦çš„å†…å®¹ä¼šæˆä¸ºæ•´ä¸ªç¤¾åŒºçš„åŸºç¡€å…±è¯†ï¼Œæ‰€ä»¥åœ¨é¡¹ç›®çš„ä¸»ç½‘ä¸Šçº¿ä¹‹åŽï¼Œæ•°å­—è´§å¸çš„é‡Šæ”¾ä¸å†æ˜¯äººä¸ºæŽ§åˆ¶ï¼Œè€Œæ˜¯åœ¨ä»£ç å±‚é¢ä½“çŽ°ï¼Œä»£ç å°†è´Ÿè´£æŽ§åˆ¶æ•°å­—è´§å¸çš„é‡Šæ”¾ï¼Œè¿™é‡ŒåŽ»é™¤äº†äººä¸ºæ“ä½œçš„å› ç´ ã€‚&lt;/p>
&lt;p>æ•°å­—èµ„äº§&lt;/p>
&lt;p>è™šæ‹Ÿèµ„äº§ä¸€èˆ¬åŒ…æ‹¬æœ‰é‡‘èžèµ„äº§ã€æ¸¸æˆä»£å¸ã€æ•°å­—ç‰ˆæƒã€åŸŸåã€ç”¨æˆ·æµé‡ç­‰ã€‚ç”±äºŽè™šæ‹Ÿèµ„äº§ä¸éœ€è¦ä¸Žå®žä½“èµ„äº§è¿›è¡ŒæŒ‚é’©ï¼Œæ‰€ä»¥åœ¨å¯¹åº”åˆ°åŒºå—é“¾ä¸Šæ›´ä¸ºæ–¹ä¾¿ã€‚å®ƒå…·ä½“çš„åº”ç”¨å½¢å¼åœ¨ä¾›åº”é“¾é‡‘èžã€ç¥¨æ®å¸‚åœºéƒ½æœ‰æ‰€ä½“çŽ°ã€‚&lt;/p>
&lt;p>æˆ‘ä»¬åœ¨è¿™é‡Œï¼Œç®€å•ä»ŽæŠ€æœ¯çš„è§’åº¦ä»‹ç»ä¸€ä¸‹ ICOï¼ŒICO çš„ä¸­æ–‡åæ˜¯é¦–æ¬¡ä»£å¸å‘è¡Œï¼Œåˆç§°ä¸ºåŒºå—é“¾ä¼—ç­¹ï¼Œè¿™æ˜¯ä¸€ç§æ–°åž‹çš„èžèµ„æ¨¡å¼ï¼ŒæŠ•èµ„è€…å¯ä»¥ç”¨æ‰‹ä¸­çš„æ¯”ç‰¹å¸ æˆ–å…¶ä»–ä»£å¸æŠ• åˆ°ä¸€äº›åŒºå—é“¾åˆ›å§‹é¡¹ç›®ã€‚&lt;/p>
&lt;h1 id="åŒºå—é“¾çš„è¡åŒ–">åŒºå—é“¾çš„è¡åŒ–&lt;/h1>
&lt;h2 id="ç¬¬ä¸€ä»£">ç¬¬ä¸€ä»£&lt;/h2>
&lt;p>ç¬¬ä¸€ä»£åŒºå—é“¾æŠ€æœ¯å‘å±•å‡ºçš„åŽ»ä¸­å¿ƒåŒ–ã€ä¸ä¾èµ–ç¬¬ä¸‰æ–¹è®¤è¯çš„é˜²æ­¢å¤šé‡æ”¯ä»˜çš„æŠ€æœ¯è§£å†³æ–¹æ¡ˆï¼Œå¤§å¹…åº¦é™ä½Žäº†ä¸­é—´äº¤æ˜“å’Œæ”¯ä»˜è´¹ç”¨ã€‚å¦å¤–å°±æ˜¯ä¾èµ–äºŽå¯†ç æŠ€æœ¯ï¼Œè§£å†³äº†å‚ä¸Žæ–¹çš„ä¿¡ä»»é—®é¢˜ã€‚
ä½†æ˜¯è¿™ä¸€ä»£æŠ€æœ¯ï¼Œåœ¨äºŽå“²å­¦æ€ç»´ä¸Šå¯¹å…¨æ°‘é€‰ä¸¾å½¢æˆå…±è¯†æœºåˆ¶çš„è¿‡äºŽç†æƒ³åŒ–çš„åšæŒï¼Œå¯¼è‡´äº†æ•ˆçŽ‡çš„ä½Žä¸‹ã€‚æ¯”å¦‚æ¯”ç‰¹å¸çš„ä»»ä½•äº¤æ˜“å’Œæ”¯ä»˜éœ€è¦è‡³å°‘ 10 åˆ†é’Ÿæ‰èƒ½åˆæ­¥å®Œæˆ(é€šè¿‡æ”¹è¿›çš„å…¶ä»–ç³»ç»Ÿï¼Œå¯ä»¥&lt;/p>
&lt;p>æ¯”ç‰¹å¸çš„åŒºå—é“¾åº”ç”¨äºŽä»·å€¼ä¼ é€’ï¼Œå°±æ˜¯è½¬è´¦ï¼Œæ‰€ä»¥æœ€ç®€å•çš„åº”ç”¨å°±æ˜¯åœ¨é‡‘èžé¢†åŸŸï¼Œæ¯”å¦‚è·¨å¢ƒè½¬è´¦ï¼Œæ”¯ä»˜æ±‡å…‘ã€‚ä¸¥æ ¼è¯´èµ·æ¥ï¼Œæ•°å­—è´§å¸å…¶å®žæ˜¯åŒºå—é“¾æœ€ç®€å•ã€æœ€ç›´æŽ¥çš„åº”ç”¨åœºæ™¯ã€‚ç»å¤§å¤šæ•°çš„åŒºå—é“¾é¡¹ç›®ï¼Œéƒ½ä¼šæœ‰è‡ªå·±çš„å†…ç”Ÿä»£å¸ã€‚&lt;/p>
&lt;p>å…±è¯†æœºåˆ¶ï¼Œå°±æ˜¯æ‰€æœ‰è®°è´¦èŠ‚ç‚¹ä¹‹é—´å¦‚ä½•åŒºåŸŸè¾¾æˆå…±è¯†ï¼Œæ¥é€‰æ‹©å’Œè®¤å®šè®°å½•çš„çœŸå®žæ€§å’Œæœ‰æ•ˆæ€§ã€‚å…¨ç½‘è®¤å¯çš„æ˜¯æœ€é•¿çš„ä¸€æ¡åŒºå—é“¾ï¼Œå› ä¸ºåœ¨æ­¤ä¹‹ä¸Šçš„å·¥ä½œé‡æœ€å¤§ã€‚å¦‚æžœæƒ³è¦ä¿®æ”¹æŸä¸ªåŒºå—å†…çš„äº¤æ˜“ä¿¡æ¯ï¼Œå°±å¿…é¡»å°†è¯¥åŒºå—å’ŒåŽé¢æ‰€æœ‰åŒºå—çš„ä¿¡æ¯è¿›è¡Œä¿®æ”¹ã€‚è¿™ç§å…±è¯†æœºåˆ¶æ—¢å¯ä»¥ä½œä¸ºè®¤å®šçš„æ‰‹æ®µï¼Œåˆå¯ä»¥é¿å…è™šå‡äº¤æ˜“å’Œä¿¡æ¯ç¯¡æ”¹ã€‚&lt;/p>
&lt;h2 id="åŒºå—ä¸Žè´¦æœ¬">åŒºå—ä¸Žè´¦æœ¬&lt;/h2>
&lt;p>åŒºå—é“¾ç½‘ç»œä¸­ï¼Œæ•°æ®ä»¥æ–‡ä»¶çš„å½¢å¼è¢«æ°¸ä¹…è®°å½•ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºåŒºå—ã€‚ä¸€ä¸ªåŒºå—æ˜¯ä¸€äº›æˆ–æ‰€æœ‰æœ€æ–°æ¯”ç‰¹å¸äº¤æ˜“çš„è®°å½•é›†ï¼Œä¸”æœªè¢«å…¶ä»–å…ˆå‰çš„åŒºå—è®°å½•ã€‚åŒºå—å¯ä»¥æƒ³åƒä¸ºä¸€ä¸ªåŸŽå¸‚è®°å½•è€…çš„è®°å½•æœ¬ä¸Šçš„å•ç‹¬ä¸€é¡µçº¸(å¯¹æˆ¿åœ°äº§äº§æƒçš„å˜æ›´è®°å½•)æˆ–è€…æ˜¯è‚¡ç¥¨äº¤æ˜“æ‰€çš„æ€»å¸æœ¬ã€‚åœ¨ç»å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæ–°åŒºå—è¢«åŠ å…¥åˆ°è®°å½•æœ€åŽ(åœ¨æ¯”ç‰¹å¸ä¸­çš„åç§°ä¸ºï¼šå—é“¾)ï¼Œä¸€æ—¦å†™ä¸Šï¼Œå°±å†ä¹Ÿä¸èƒ½æ”¹å˜æˆ–åˆ é™¤ã€‚æ¯ä¸ªåŒºå—è®°å½•äº†å®ƒè¢«åˆ›å»ºä¹‹å‰å‘ç”Ÿçš„æ‰€æœ‰äº‹ä»¶ã€‚&lt;/p>
&lt;p>æ¯ä¸ªåŒºå—åŒ…æ‹¬ä¸€äº›æˆ–æ‰€æœ‰è¿‘æœŸäº¤æ˜“ã€å‰ä¸€ä¸ªåŒºå—çš„å¼•ç”¨ï¼Œä»¥åŠå…¶ä»–æ•°æ®ã€‚å®ƒè¿˜åŒ…æ‹¬ä¸€ä¸ªæŒ–çŸ¿éš¾åº¦çš„ç­”æ¡ˆâ€”â€”è¯¥ç­”æ¡ˆå¯¹æ¯ä¸ªåŒºå—æ˜¯å”¯ä¸€çš„ã€‚æ–°åŒºå—å¦‚æžœæ²¡æœ‰æ­£ç¡®ç­”æ¡ˆï¼Œä¸èƒ½è¢«å‘é€åˆ°ç½‘ç»œä¸­â€”â€”â€œæŒ–çŸ¿â€çš„è¿‡ç¨‹æœ¬è´¨ä¸Šæ˜¯åœ¨ç«žäº‰ä¸­ â€œè§£å†³â€å½“å‰åŒºå—ã€‚æ¯ä¸ªåŒºå—ä¸­çš„æ•°å­¦é—®é¢˜éš¾ä»¥è§£å†³ï¼Œä½†æ˜¯ä¸€æ—¦å‘çŽ°äº†ä¸€ä¸ªæœ‰æ•ˆè§£ï¼Œå…¶ä»–ç½‘ç»œèŠ‚ç‚¹å¾ˆå®¹æ˜“éªŒè¯è¿™ä¸ªè§£çš„æ­£ç¡®æ€§ï¼Œå¯¹äºŽç»™å®šçš„åŒºå—å¯èƒ½æœ‰å¤šä¸ªæœ‰æ•ˆè§£ï¼Œä½†å¯¹äºŽè¦è§£å†³çš„åŒºå—æ¥è¯´åªéœ€ä¸€ä¸ªè§£ã€‚
å› ä¸ºæ¯è§£å†³ä¸€ä¸ªåŒºå—ï¼Œéƒ½ä¼šå¾—åˆ°æ–°äº§ç”Ÿçš„æ¯”ç‰¹å¸å¥–åŠ±ï¼Œæ¯ä¸ªåŒºå—åŒ…å«ä¸€ä¸ªè®°å½•ï¼Œè®°å½•ä¸­çš„æ¯”ç‰¹å¸åœ°å€æ˜¯æœ‰æƒèŽ·å¾—æ¯”ç‰¹å¸å¥–åŠ±çš„åœ°å€ã€‚è¿™ä¸ªçºªå½•è¢«ç§°ä¸ºç”Ÿäº§äº¤æ˜“æˆ–è€… Coinbase äº¤æ˜“ï¼Œå®ƒç»å¸¸æ˜¯æ¯ä¸ªåŒºå—çš„ç¬¬ä¸€ä¸ªäº¤æ˜“ã€‚æ¯ä¸ªåŒºå—ç”Ÿäº§çš„æ¯”ç‰¹å¸æ•°é‡æ˜¯ 50 ä¸ªï¼Œæ¯äº§ç”Ÿ 21 ä¸‡ä¸ªåŒºå—åŽå‡å°‘ä¸€åŠ(æ—¶é—´å¤§çº¦æ˜¯ 4 å¹´)ã€‚&lt;/p>
&lt;p>å‘é€è€…åœ¨ç½‘ç»œä¸­å¹¿æ’­æ¯”ç‰¹å¸äº¤æ˜“ï¼Œæ‰€æœ‰è¯•å›¾è§£å†³åŒºå—çš„çŸ¿å·¥èŠ‚ç‚¹ï¼Œæ”¶é›†äº†è¿™äº›äº¤æ˜“è®°å½•ï¼ŒæŠŠå®ƒä»¬åŠ åˆ°çŸ¿å·¥èŠ‚ç‚¹æ­£åœ¨è§£å†³çš„åŒºå—ä¸­ã€‚
æŒ–çŸ¿éš¾åº¦ç”±æ¯”ç‰¹å¸ç½‘ç»œè‡ªåŠ¨è°ƒæ•´ï¼Œä½¿ä¹‹å®žçŽ°å¹³å‡æ¯å°æ—¶è§£å†³ 6 ä¸ªåŒºå—çš„ç›®æ ‡ã€‚æ¯ 2016 ä¸ªåŒºå—(å¤§çº¦ä¸¤å‘¨)åŽï¼Œæ‰€æœ‰å®¢æˆ·ç«¯æŠŠæ–°åŒºå—çš„å®žé™…æ•°ç›®ä¸Žç›®æ ‡æ•°é‡ç›¸æ¯”è¾ƒï¼Œå¹¶ä¸”æŒ‰ç…§å·®å¼‚çš„ç™¾åˆ†æ¯”è°ƒæ•´ç›®æ ‡ Hash å€¼ï¼Œæ¥å¢žåŠ (æˆ–é™ä½Ž)äº§ç”ŸåŒºå—çš„éš¾åº¦ã€‚&lt;/p>
&lt;h2 id="å…±è¯†æœºåˆ¶ä¸Žå·¥ä½œé‡è¯æ˜Ž">å…±è¯†æœºåˆ¶ä¸Žå·¥ä½œé‡è¯æ˜Ž&lt;/h2>
&lt;p>POWï¼šProof of Workï¼Œå·¥ä½œè¯æ˜Žã€‚
æ¯”ç‰¹å¸åœ¨ Block çš„ç”Ÿæˆè¿‡ç¨‹ä¸­ä½¿ç”¨äº† POW æœºåˆ¶ï¼Œä¸€ä¸ªç¬¦åˆè¦æ±‚çš„ Block Hash ç”± N ä¸ªå‰å¯¼é›¶æž„æˆï¼Œé›¶çš„ä¸ªæ•°å–å†³äºŽç½‘ç»œçš„éš¾åº¦å€¼ã€‚è¦å¾—åˆ°åˆç†çš„ Block Hash éœ€è¦ç»è¿‡å¤§é‡å°è¯•è®¡ç®—ï¼Œè®¡ç®—æ—¶é—´å–å†³äºŽæœºå™¨çš„å“ˆå¸Œè¿ç®—é€Ÿåº¦ã€‚å½“æŸä¸ªèŠ‚ç‚¹æä¾›å‡ºä¸€ä¸ªåˆç†çš„ Block Hash å€¼ï¼Œè¯´æ˜Žè¯¥èŠ‚ç‚¹ç¡®å®žç»è¿‡äº†å¤§é‡çš„å°è¯•è®¡ç®—ï¼Œå½“ç„¶ï¼Œå¹¶ä¸èƒ½å¾—å‡ºè®¡ç®—æ¬¡æ•°çš„ç»å¯¹å€¼ï¼Œå› ä¸ºå¯»æ‰¾åˆç† Hash æ˜¯ä¸€ä¸ªæ¦‚çŽ‡äº‹ä»¶ã€‚å½“èŠ‚ç‚¹æ‹¥æœ‰å å…¨ç½‘ n% çš„ç®—åŠ›æ—¶ï¼Œè¯¥èŠ‚ç‚¹å³æœ‰ n/100 çš„æ¦‚çŽ‡æ‰¾åˆ° Block Hashã€‚
POSï¼šProof of Stakeï¼Œè‚¡æƒè¯æ˜Žã€‚
POSï¼Œä¹Ÿç§°è‚¡æƒè¯æ˜Žï¼Œç±»ä¼¼äºŽè´¢äº§å‚¨å­˜åœ¨é“¶è¡Œï¼Œè¿™ç§æ¨¡å¼ä¼šæ ¹æ®ä½ æŒæœ‰æ•°å­—è´§å¸çš„é‡å’Œæ—¶é—´ï¼Œåˆ†é…ç»™ä½ ç›¸åº”çš„åˆ©æ¯ã€‚
ç®€å•æ¥è¯´ï¼Œå°±æ˜¯ä¸€ä¸ªæ ¹æ®ä½ æŒæœ‰è´§å¸çš„é‡å’Œæ—¶é—´ï¼Œç»™ä½ å‘åˆ©æ¯çš„ä¸€ä¸ªåˆ¶åº¦ï¼Œåœ¨è‚¡æƒè¯æ˜Ž POS æ¨¡å¼ä¸‹ï¼Œæœ‰ä¸€ä¸ªåè¯å«å¸é¾„ï¼Œæ¯ä¸ªå¸æ¯å¤©äº§ç”Ÿ 1 å¸é¾„ï¼Œæ¯”å¦‚ä½ æŒæœ‰ 100 ä¸ªå¸ï¼Œæ€»å…±æŒæœ‰äº† 30 å¤©ï¼Œé‚£ä¹ˆï¼Œæ­¤æ—¶ä½ çš„å¸é¾„å°±ä¸º 3000ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œå¦‚æžœä½ å‘çŽ°äº†ä¸€ä¸ª POS åŒºå—ï¼Œä½ çš„å¸é¾„å°±ä¼šè¢«æ¸…ç©ºä¸º 0ã€‚ä½ æ¯è¢«æ¸…ç©º 365 å¸é¾„ï¼Œä½ å°†ä¼šä»ŽåŒºå—ä¸­èŽ·å¾— 0.05 ä¸ªå¸çš„åˆ©æ¯(å‡å®šåˆ©æ¯å¯ç†è§£ä¸ºå¹´åˆ©çŽ‡ 5%)ï¼Œé‚£ä¹ˆåœ¨è¿™ä¸ªæ¡ˆä¾‹ä¸­ï¼Œåˆ©æ¯ = 3000 * 5% / 365 = 0.41 ä¸ªå¸ï¼Œè¿™ä¸‹å°±å¾ˆæœ‰æ„æ€äº†ï¼ŒæŒå¸æœ‰åˆ©æ¯ã€‚&lt;/p>
&lt;ol start="2">
&lt;li>ç‘žæ³¢å¸(Ripple)
ç‘žæ³¢å¸æ˜¯ Ripple ç½‘ç»œè¿è¡Œçš„åŸºç¡€è´§å¸ï¼Œå°±åƒæ¯”ç‰¹å¸ä¸€æ ·å¯ä»¥åœ¨æ•´ä¸ªç½‘ç»œä¸­æµé€šï¼Œè€Œä¸å¿…å±€é™äºŽç†Ÿäººåœˆå­ã€‚ç‘žæ³¢å¸å¼•å…¥ç½‘å…³ç³»ç»Ÿï¼Œå®ƒç±»ä¼¼äºŽè´§å¸å…‘æ¢æœºæž„ï¼Œå…è®¸äººä»¬æŠŠæ³•å®šè´§å¸æ³¨å…¥ã€æŠ½ç¦» Ripple ç½‘ç»œï¼Œå¹¶å¯å……å½“å€Ÿè´·åŒæ–¹çš„æ¡¥æ¢ã€‚&lt;/li>
&lt;li>èŽ±ç‰¹å¸(Litecoin)
èŽ±ç‰¹å¸ä¸Žæ¯”ç‰¹å¸ç›¸æ¯”å…·æœ‰ä¸‰ç§æ˜¾è‘—å·®å¼‚ï¼šç¬¬ä¸€ï¼ŒèŽ±ç‰¹å¸ç½‘ç»œå¤§çº¦æ¯ 2.5 åˆ†é’Ÿ(è€Œä¸æ˜¯ 10 åˆ†é’Ÿ)å°±å¯ä»¥å¤„ç†ä¸€ä¸ªå—ï¼Œå› æ­¤å¯ä»¥æä¾›æ›´å¿«çš„äº¤æ˜“ç¡®è®¤ï¼›ç¬¬äºŒï¼ŒèŽ±ç‰¹å¸ç½‘ç»œé¢„æœŸäº§å‡º 8400 ä¸‡ä¸ªèŽ±ç‰¹å¸ï¼Œæ˜¯æ¯”ç‰¹å¸ç½‘ç»œå‘è¡Œè´§å¸é‡çš„å››å€ä¹‹å¤šï¼›ç¬¬ä¸‰ï¼ŒèŽ±ç‰¹å¸åœ¨å…¶å·¥ä½œé‡è¯æ˜Žç®—æ³•ä¸­ä½¿ç”¨äº†ç”± Colin Percival(ç§‘æž— Â· ç€è¥¿ç“¦å°”)é¦–æ¬¡æå‡ºçš„ Scrypt åŠ å¯†ç®—æ³•ï¼Œè¿™ä½¿å¾—ç›¸æ¯”äºŽæ¯”ç‰¹å¸ï¼Œåœ¨æ™®é€šè®¡ç®—æœºä¸Šè¿›è¡ŒèŽ±ç‰¹å¸æŒ–æŽ˜æ›´ä¸ºå®¹æ˜“(åœ¨ ASIC çŸ¿æœºè¯žç”Ÿä¹‹å‰)ã€‚æ¯ä¸€ä¸ªèŽ±ç‰¹å¸è¢«åˆ†æˆ 100000000 ä¸ªæ›´å°çš„å•ä½ï¼Œé€šè¿‡ 8 ä½å°æ•°æ¥ç•Œå®šã€‚ä¸åŒäºŽæ¯”ç‰¹å¸ï¼ŒScrypt æ‰€å…·æœ‰çš„å†…å­˜å¯†é›†ç‰¹æ€§è®©èŽ±ç‰¹å¸æ›´é€‚åˆç”¨å›¾å½¢å¤„ç†å™¨(GPU)è¿›è¡Œâ€œæŒ–çŸ¿â€ã€‚ä¸º Scrypt å®žæ–½çš„ FPGA(çŽ°åœºå¯ç¼–è¾‘é€»è¾‘é—¨é˜µåˆ—)å’Œ ASIC(ä¸“ç”¨é›†æˆç”µè·¯)ï¼Œç›¸æ¯”äºŽæ¯”ç‰¹å¸ä½¿ç”¨çš„ sha256ï¼Œæ›´ä¸ºæ˜‚è´µã€‚&lt;/li>
&lt;/ol>
&lt;h2 id="ç¬¬äºŒä»£">ç¬¬äºŒä»£&lt;/h2>
&lt;h3 id="æ™ºèƒ½åˆçº¦">æ™ºèƒ½åˆçº¦&lt;/h3>
&lt;p>1.ä»¥å¤ªåŠ(Ethereum)
ä»¥å¤ªåŠæ˜¯ä¸‹ä¸€ä»£å¯†ç å­¦è´¦æœ¬ï¼Œæ”¯æŒä¼—å¤šçš„é«˜çº§åŠŸèƒ½ï¼ŒåŒ…æ‹¬ç”¨æˆ·å‘è¡Œè´§å¸ã€æ™ºèƒ½åè®®ã€åŽ»ä¸­å¿ƒåŒ–çš„äº¤æ˜“ã€æ™®éè®¤ä¸ºçš„ç¬¬ä¸€ä¸ªå®Œå…¨çš„åŽ»ä¸­å¿ƒåŒ–è‡ªæ²»ç»„ç»‡(DAOs)æˆ–åŽ»ä¸­å¿ƒåŒ–è‡ªæ²»å…¬å¸(DACs)åº”ç”¨ã€‚ä½¿ä»¥å¤ªåŠä¸Žä¼—ä¸åŒçš„æ˜¯å®žçŽ°è¿™äº›åŠŸèƒ½çš„æ–¹å¼ã€‚ä»¥å¤ªåŠå¹¶ä¸æ˜¯æŠŠæ¯ä¸€å•ä¸ªç±»åž‹çš„åŠŸèƒ½ä½œä¸ºç‰¹æ€§æ¥ç‰¹åˆ«æ”¯æŒï¼Œç›¸åï¼Œä»¥å¤ªåŠåŒ…æ‹¬ä¸€ä¸ªå†…ç½®çš„å›¾çµå®Œå¤‡çš„è„šæœ¬è¯­è¨€ï¼Œå…è®¸é€šè¿‡è¢«ç§°ä¸ºâ€œåˆåŒâ€çš„æœºåˆ¶æ¥ä¸ºè‡ªå·±æƒ³å®žçŽ°çš„ç‰¹æ€§å†™ä»£ç ã€‚ä¸€ä¸ªåˆåŒå°±åƒä¸€ä¸ªè‡ªåŠ¨çš„ä»£ç†ï¼Œæ¯å½“æŽ¥æ”¶åˆ°ä¸€ç¬”äº¤æ˜“ï¼ŒåˆåŒå°±ä¼šè¿è¡Œç‰¹å®šçš„ä¸€æ®µä»£ç ï¼Œè¿™æ®µä»£ç èƒ½ä¿®æ”¹åˆåŒå†…éƒ¨çš„æ•°æ®å­˜å‚¨æˆ–è€…å‘é€äº¤æ˜“ã€‚é«˜çº§çš„åˆåŒç”šè‡³èƒ½ä¿®æ”¹è‡ªèº«çš„ä»£ç ã€‚&lt;/p>
&lt;p>æ™ºèƒ½åˆçº¦ï¼Œå®Œå…¨ç”±ä»£ç ç»„æˆã€è‡ªåŠ¨æ‰§è¡Œçš„åˆçº¦ã€‚å¯ä»¥è‡ªåŠ¨æ ¸æŸ¥æŸäº‹æ˜¯å¦å‘ç”Ÿã€æŸç‰©æ˜¯å¦å­˜åœ¨ã€æŸäº‹æ˜¯å¦å®Œæˆç­‰â€œæ¡ä»¶åˆ¤æ–­â€ç±»æ¡æ¬¾ï¼Œå¹¶æ®æ­¤å¯¹èµ„é‡‘è¿›è¡Œç›¸åº”çš„è½¬ç§»ã€‚&lt;/p>
&lt;h3 id="ä»£è®®åˆ¶">ä»£è®®åˆ¶&lt;/h3>
&lt;p>ç¬¬äºŒä»£åŒºå—é“¾æŠ€æœ¯çš„ä¸€ä¸ªæ–¹å‘å°±æ˜¯åƒç¾Žå›½çš„ Ripple å…¬å¸(è¯¦è§æœ¬ä¹¦ç¬¬å››ç« ç¬¬ä¸‰èŠ‚)é‚£æ ·ï¼Œå¼€å§‹è€ƒè™‘ç”¨äººæ°‘ä»£è¡¨å¤§ä¼šçš„ä»£è®®åˆ¶åº¦æ¥è¾¾æˆç³»ç»Ÿå…±è¯†â€”â€”å°±æ˜¯å¯¹å„ç§äº¤æ˜“å’Œæ”¯ä»˜çš„è®¤å®šï¼Œä¸æ˜¯ä¼ ç»Ÿä¸­å¿ƒåŒ–çš„å•ä¸€ä¸­å¿ƒè®¤å®šï¼Œä¹Ÿä¸æ˜¯ç¬¬ä¸€ä»£åŒºå—é“¾æŠ€æœ¯çš„å…¨æ°‘å‚ä¸Žè®¤å®šï¼Œè€Œæ˜¯ä¾é å¤§å®¶ä¿¡ä»»çš„äººæ°‘ä»£è¡¨å¤§ä¼šåˆ¶åº¦æ¥ä»£è®®ã€‚&lt;/p>
&lt;h2 id="ç¬¬ä¸‰ä»£">ç¬¬ä¸‰ä»£&lt;/h2>
&lt;p>ç¬¬ä¸‰ä»£åŒºå—é“¾æŠ€æœ¯ç‰ˆæœ¬çš„æ ¸å¿ƒç”¨ä¸€å¥è¯æ¦‚æ‹¬ï¼Œå°±æ˜¯å˜â€œç»å¯¹åŽ»ä¸­å¿ƒåŒ–â€ä¸ºâ€œæœ‰æ•ˆåŽ»ä¸­å¿ƒåŒ–â€ã€‚&lt;/p>
&lt;h1 id="åº”ç”¨ä¸Žä¸è¶³">åº”ç”¨ä¸Žä¸è¶³&lt;/h1>
&lt;ol>
&lt;li>å…¬å¼€è®°è´¦&lt;/li>
&lt;/ol>
&lt;p>æ¯å®¶æ¯æˆ·éƒ½è®°è´¦ï¼Œè´¦ç°¿ä¸Šä¸å†è®°è½½æ¯æˆ·æ‘æ°‘çš„ä½™é¢ï¼Œè€Œåªè®°è½½æ¯ä¸€ç¬” Transactionï¼Œå³è®°è½½æ¯ä¸€ç¬”äº¤æ˜“çš„ä»˜æ¬¾äººã€æ”¶æ¬¾äººå’Œä»˜æ¬¾é‡‘é¢ã€‚â€œå…¬å¼€è®°è´¦â€å°±æ˜¯å…¨ç½‘æ‰€æœ‰äººéƒ½å¯ä»¥éšæ—¶æŸ¥çœ‹ä¸€å¥—è´¦æœ¬ï¼Œç„¶åŽæŒ‰ç…§è§„åˆ™é€æ˜Žå…¬å¼€åœ°è¿›è¡Œè®°è´¦ã€‚&lt;/p>
&lt;ol start="2">
&lt;li>åˆ›å»ºåˆ›ä¸–åŒºå—&lt;/li>
&lt;/ol>
&lt;p>åˆ›ä¸–åŒºå—æ˜¯æˆ‘ä»¬ç”Ÿæˆå…¨æ‘å…¬å¼€è´¦æœ¬çš„ç¬¬ä¸€ç¬”äº¤æ˜“çš„ç¬¬ä¸€ä¸ªä¿¡å°ï¼Œå¥½æ¯”ä¸€ç¯‡æ–‡ç« æ€»å¾—æœ‰ä¸ªå¼€å¤´ä¸€æ ·ã€‚&lt;/p>
&lt;ol start="3">
&lt;li>äº¤æ˜“&lt;/li>
&lt;/ol>
&lt;p>æ‘é•¿å†™å¥½ Transaction ä»¥åŽï¼Œè¿˜éœ€è¦æ‹¿å‡ºè‡ªå·±çš„å°ç« ï¼Œåœ¨ Transaction ä¸Šç›–ç« ï¼Œè¿™ä¸ªç›–ç« çš„è¿‡ç¨‹ä¹Ÿå°±ç›¸å½“äºŽåŒºå—é“¾ä¸­çš„ç­¾åã€‚è¿™ä¸ªç« ï¼Œå…¨æ‘äººéƒ½å¯ä»¥æ‹¿æ‰«æå™¨æ‰«ä¸€ä¸‹éªŒè¯æ˜¯å¦æœ‰æ•ˆï¼Œå³éªŒè¯ä»˜æ¬¾äººçš„ç« æ˜¯å¦æœ‰æ•ˆã€‚&lt;/p>
&lt;p>ç”¨è‡ªå·±çš„ç§é’¥ç­¾åï¼Œè¯æ˜Žäº¤æ˜“æ˜¯è‡ªå·±å‘èµ·çš„ã€‚ç”¨å¯¹æ–¹çš„å…¬é’¥åŠ å¯†ï¼Œä»¥ä¿è¯åªæœ‰æ­£ç¡®çš„æŽ¥æ”¶æ–¹æ‰èƒ½èŽ·å¾—ä¿¡æ¯ã€‚&lt;/p>
&lt;ol start="4">
&lt;li>æ‰“åŒ… Transactionï¼ˆæŒ–çŸ¿ï¼‰&lt;/li>
&lt;/ol>
&lt;p>æ˜¯ä¸ºäº†è®©æ‰“åŒ…äº¤æ˜“çš„äººèƒ½å¤Ÿåœ¨ä¿¡å°ä¸Šç½²åï¼Œè¡¨ç¤ºè¿™æ¬¡æ‰“åŒ…æ˜¯ç”±æŸæŸæŸæ‰“åŒ…çš„ï¼Œå…¶æ¬¡å…¨æ‘çš„äº¤æ˜“å¯èƒ½éžå¸¸å¤šï¼Œéœ€è¦è£…é…æ ‡å·ï¼Œæ–¹ä¾¿å¤§å®¶æŸ¥è¯¢ã€‚æˆ‘ä»¬ç”¨ä¸€ä¸ªç‰¹æ®Šçš„ä¿¡å°æŠŠ Transaction è£…èµ·æ¥ï¼Œè¿™ä¸ªä¿¡å°å°±æ˜¯åŒºå—é“¾ä¸­çš„â€œåŒºå—â€ï¼Œè¿™ä¸ªå°è£…è¿‡ç¨‹å°±æ˜¯â€œæ‰“åŒ…äº¤æ˜“â€ã€‚&lt;/p>
&lt;p>æˆ‘ç»™å¤§å®¶å‡ºä¸€ä¸ªéš¾é¢˜ï¼Œè°å…ˆè§£å‡ºè¿™ä¸ªéš¾é¢˜çš„ç­”æ¡ˆï¼Œè°å°±æœ‰æƒåˆ©æŠŠ Transaction è£…åˆ°ä¸€ä¸ªä¿¡å°ä¸­ï¼Œå¹¶ä¸”è¦åœ¨æ­¤ä¿¡å°ä¸Šç›–ä¸Šè‡ªå·±çš„ç« ã€‚ç­”æ¡ˆéžå¸¸å¥½éªŒè¯ï¼Œä½†æ˜¯è®¡ç®—è¿‡ç¨‹æ˜¯ä¸€ä¸ªå°è¯•çš„è¿‡ç¨‹ï¼Œéœ€è¦è€—è´¹å¤§é‡çš„ç²¾åŠ›ã€‚è€Œåœ¨çœŸå®žçš„æ¯”ç‰¹å¸ä¸­ï¼Œé‡‡ç”¨çš„æ˜¯å¯»æ‰¾ç¬¦åˆæ¡ä»¶çš„ç›®æ ‡å“ˆå¸Œï¼Œè¿™ä¹Ÿå°±æ˜¯æ¯”ç‰¹å¸çŸ¿å·¥æ‰€åšçš„äº‹æƒ…ã€‚&lt;/p>
&lt;p>çŸ¿å·¥åœ¨æ‰“åŒ…ä¹‹åŽèƒ½å¤ŸèŽ·å¾—å¯¹åº”çš„å¥–åŠ±&lt;/p>
&lt;ol start="5">
&lt;li>å¹¿æ’­äº¤æ˜“&lt;/li>
&lt;/ol>
&lt;p>å¹¿æ’­çš„å†…å®¹åˆ†ä¸¤ç§ï¼Œä¸€ç§æ˜¯å¹¿æ’­ Transactionï¼Œä¸€ç§æ˜¯å¹¿æ’­ä¿¡å°ã€‚ç¬¬ä¸€ç§å¹¿æ’­æ˜¯æ„å‘³ç€è¿˜æœ‰æœªè¢«æ‰“åŒ…çš„ Transactionï¼Œè€Œç¬¬äºŒç§å¹¿æ’­ä¿¡å°åˆ™æ„å‘³ç€è¿™ä¸ª Transaction å·²ç»è¢«æŸä¸ªçŸ¿å·¥ç¡®è®¤ã€‚&lt;/p>
&lt;p>æ”¶åˆ°äº†å¹¿æ’­çš„é€šçŸ¥åŽï¼Œå¤§å®¶å…ˆéªŒè¯ä¿¡å°ä¸Šéš¾é¢˜çš„ç­”æ¡ˆæ˜¯å¦æ­£ç¡®ï¼Œè¿™æ ·ä¾¿å¯ä»¥éªŒè¯å‡ºä¿¡å°æ˜¯å¦è¢«ä¼ªé€ ï¼ŒæŽ¥ç€éªŒé‡Œé¢çš„æ¯ç¬”äº¤æ˜“ï¼Œæœ€åŽè¿˜è¦éªŒè¯ä¿¡å°èƒŒé¢çš„å†…å®¹ï¼Œå³ä¸Šä¸€ä¸ªä¿¡å°çš„æ‘˜è¦æ˜¯å¦æ­£ç¡®ã€‚å› ä¸ºä¸Šä¸€ä¸ªä¿¡å°å¤§å®¶éƒ½å·²ç»ç¡®è®¤ï¼Œæ‰€ä»¥è¿™æ ·å¯ä»¥æžå¤§åœ°è§„é¿ä½œå¼Šçš„å¯èƒ½ã€‚å¦‚æžœè§‰å¾—æ²¡é—®é¢˜ï¼Œå°±å¯ä»¥å­˜å…¥æœ¬åœ°æ•°æ®åº“ä¸­äº†ã€‚&lt;/p>
&lt;p>æ¯”ç‰¹å¸çš„å‘å¸ƒæ—¶é—´ä¸º 2009 å¹´ 1 æœˆ 9 å·ï¼Œé¢„è®¡å®ƒçš„æŒ–çŸ¿å¯ä»¥ä¸€ç›´æŒç»­åˆ° 2140 å¹´ï¼Œå‘è¡Œæ€»é‡æ”¶æ•›åˆ° 2100 ä¸‡ã€‚æ¯”ç‰¹å¸çš„å‡ºå—æ—¶é—´æ˜¯ 10 åˆ†é’Ÿï¼Œå‡ºå—æ—¶é—´æ˜¯æŒ‡å…¨ç½‘å¹³å‡äº§ç”Ÿä¸€ä¸ªåŒºå—çš„æ—¶é—´é—´éš”ã€‚&lt;/p>
&lt;p>ä»¥å¤ªåŠæ˜¯ä¸€ä¸ªåŒºå—é“¾åº”ç”¨å¹³å°ï¼Œå®ƒçš„æžå¤§åˆ›æ–°åœ¨äºŽå®ƒæä¾›äº†æ™ºèƒ½åˆçº¦è¿™ç§å¯ä»¥è‡ªå®šä¹‰ä¸šåŠ¡é€»è¾‘çš„å·¥å…·ï¼Œæ™ºèƒ½åˆçº¦æ˜¯ä¸€ç§å¯ç¼–ç¨‹çš„åˆçº¦ï¼Œåˆçº¦æ˜¯ç”±ç”¨æˆ·ç¼–å†™å¹¶ä¸”éƒ¨ç½²åˆ°åŒºå—é“¾ä¸Šçš„ã€‚
ä»¥å¤ªåŠçš„ä¼˜åŠ¿æ˜¯ä¸ºå…¨ä¸–ç•Œçš„å¼€å‘è€…ä»¬æä¾›äº†ä¸€ç§å¼€å‘å·¥å…·ï¼Œè¿™ç§å·¥å…·è®©æ‰€æœ‰äººéƒ½èƒ½é‡Šæ”¾å‡ºå·¨å¤§çš„åˆ›é€ åŠ›ï¼Œæ‰€ä»¥åŸºæœ¬ä¸Šå¯ä»¥çœ‹æˆï¼šåªè¦æ˜¯æœ‰ä¸€å®šæŠ€æœ¯åŸºç¡€çš„å¼€å‘è€…ï¼Œé€šè¿‡æ™ºèƒ½åˆçº¦å¯ä»¥éšæ—¶ä¸ºä»¥å¤ªåŠè´¡çŒ®å†…å®¹ã€‚&lt;/p>
&lt;p>ç‘žæ³¢å¸ï¼ˆRippleï¼‰æ˜¯ä¸€ä¸ªæ¯”è¾ƒå¦ç±»çš„åŒºå—é“¾é¡¹ç›®ï¼Œå› ä¸ºä»Žæœ¬è´¨ä¸Šæ¥è¯´ï¼Œå®ƒæ›´åƒæ˜¯ä¸€ç§æ”¯ä»˜ç»“ç®—åè®®ï¼Œç‘žæ³¢å¸ä¸éœ€è¦æŒ–çŸ¿ï¼Œå®ƒæ˜¯é€šè¿‡ä¸€ç§å«â€œOpen Coinâ€çš„ç®—æ³•ï¼Œæä¾›ç‘žæ³¢åè®®å…±è¯†æ¥è¾¾åˆ°è®°è´¦çš„ç›®çš„ã€‚
ç‘žæ³¢å¸æ—¨åœ¨ä¸ºå…¨çƒè·¨å¢ƒæœºæž„æä¾›äº†é«˜æ•ˆçŽ‡çš„æ”¯ä»˜è¿‡ç¨‹ï¼Œæä¾›è¾ƒå¥½çš„å…¨çƒæ”¯ä»˜ä½“éªŒã€‚å› ä¸ºæ¶‰åŠäº†æœºæž„ä¹‹é—´çš„èµ„äº§è½¬ç§»ï¼Œç‘žæ³¢å¸è¢«è®¾è®¡æˆéœ€è¦å‡†å…¥è®¸å¯æ‰èƒ½è¿›å…¥ç‘žæ³¢çš„æ”¯ä»˜ç½‘ç»œï¼Œè¿™ä¸€ç‚¹æœ‰äº›åƒæˆ‘ä»¬æ‰€è¯´çš„è”ç›Ÿé“¾ã€‚&lt;/p>
&lt;p>åŒ¿åæ€§åŒºå—é“¾é¡¹ç›®æ˜¯æŒ‡ï¼šä½¿ç”¨äº¤æ˜“åŒ¿åæŠ€æœ¯ï¼Œè®©å…¬å¼€å¯æŸ¥è¯¢çš„äº¤æ˜“å†…å®¹å˜æˆç§å¯†çš„åŒ¿åæ€§åŒºå—é“¾é¡¹ç›®ã€‚å¸‚å€¼æ¯”è¾ƒä¸é”™çš„æœ‰é—¨ç½—å¸ã€è¾¾ä¸–å¸ã€Zcash ä¸‰ç§ï¼Œå®ƒä»¬åˆ†åˆ«ä½¿ç”¨äº†ä¸åŒç±»åž‹çš„åŒ¿åæŠ€æœ¯ï¼Œä¸ºåŒºå—é“¾æŠ€æœ¯çš„åŒ¿åç‰¹æ€§å‘å±•åšå‡ºäº†è´¡çŒ®ã€‚&lt;/p>
&lt;h1 id="å…±è¯†æœºåˆ¶">å…±è¯†æœºåˆ¶&lt;/h1>
&lt;p>å…±è¯†æœºåˆ¶æ˜¯åŒºå—é“¾æ˜¯æ ¸å¿ƒçš„ç»„æˆè¦ç´ ä¹‹ä¸€ï¼Œå®ƒå†³å®šäº†åŒºå—é“¾çš„ä¸šåŠ¡åžåé‡ã€äº¤æ˜“é€Ÿåº¦ã€ä¸å¯ç¯¡æ”¹æ€§ã€å‡†å…¥é—¨æ§›ç­‰ç­‰ï¼Œæ˜¯æœ€ä¸ºå…³é”®çš„æŠ€æœ¯è¦ç´ ä¹‹ä¸€ã€‚&lt;/p>
&lt;p>å…±è¯†æœºåˆ¶ä¸»è¦è§£å†³äº†ä¸¤ä¸ªé—®é¢˜ï¼š&lt;/p>
&lt;p>è°æœ‰æƒåˆ©ï¼›
ä½œå¼Šé—®é¢˜ã€‚&lt;/p>
&lt;p>PoWï¼ˆProof of Workï¼‰å·¥ä½œé‡è¯æ˜Žå¯ä»¥è§£å†³ä¸Šè¿°çš„ä¸¤ä¸ªé—®é¢˜ï¼ŒPoWï¼ˆProof of Workï¼‰å·¥ä½œé‡è¯æ˜Žå¯ä»¥è§£å†³ä¸Šè¿°çš„ä¸¤ä¸ªé—®é¢˜ï¼Œè¿™ä¸ªé—®é¢˜å¯ä»¥ç®€åŒ–æˆè°æ‹¥æœ‰çš„è®¡ç®—èµ„æºæ›´å¤šï¼Œè°å°±æ‹¥æœ‰æ•´ä¸ªç³»ç»Ÿçš„æœ€å¤§æ¦‚çŽ‡çš„è®°è´¦æƒã€‚ä¸€æ—¦è¿™ä¸ªæ¦‚çŽ‡è¶…è¿‡ä¸€åŠä»¥ä¸Šï¼Œé‚£ä¹ˆè¿™ä¸ªç³»ç»Ÿå°±æœ‰ä¸€å®šçš„ä¸­å¿ƒåŒ–é£Žé™©ã€‚&lt;/p>
&lt;p>è€Œå½±å“è®°è´¦æƒçš„å”¯ä¸€å› ç´ åªæœ‰è®¡ç®—èµ„æºï¼ˆç®—åŠ›ï¼‰çš„å¤§å°ï¼Œå¦‚æžœæƒ³ç¯¡æ”¹äº¤æ˜“ï¼Œåªèƒ½æŠ•å…¥å¤§é‡çš„è®¡ç®—èµ„æºä¸Žæ•´ä¸ªç³»ç»Ÿä¸­å…¶ä»–æ‰€æœ‰äººè¿›è¡Œå¯¹æŠ—ï¼Œè¿™æ˜¯ååˆ†å›°éš¾çš„ï¼Œå°¤å…¶åœ¨æ•´ä¸ªç³»ç»Ÿæœ‰ä¸€å®šåŸºç¡€è®¡ç®—èµ„æºï¼ˆç®—åŠ›ï¼‰çš„æƒ…å†µä¸‹ã€‚&lt;/p>
&lt;p>PoW ä¸­ä¸€ä¸ªæœ‰è¶£çš„è®¾è®¡æ˜¯æ¿€åŠ±æœºåˆ¶ï¼Œåœ¨ PoW å…±è¯†æœºåˆ¶ä¸‹ï¼Œæˆ‘ä»¬å‡è®¾æ‰€æœ‰å‚ä¸Žè€…éƒ½æ˜¯ç†æ€§çš„ï¼Œç†æ€§çš„äººå¦‚æžœä½œå¼Šã€ç¯¡æ”¹è´¦æœ¬è‚¯å®šéœ€è¦æŠ•å…¥æˆæœ¬ï¼Œä¹Ÿå°±æ˜¯è®¡ç®—èµ„æºï¼Œæ”¶ç›Šæ˜¯ç¯¡æ”¹è´¦æœ¬èŽ·å¾—çš„æ”¶ç›Šå‡åŽ»æŠ•å…¥æˆæœ¬ï¼Œè¿™ä¸ªæ”¶ç›Šå¾€å¾€å°äºŽè¯šå®žè®¡ç®—æ‰€èŽ·å¾—çš„æ”¶ç›Šã€‚æ‰€ä»¥ï¼Œä½œå¼Šè€…åœ¨ä½œå¼Šè¿‡ç¨‹ä¸­æŠ•å…¥çš„è®¡ç®—èµ„æºè¿‡å¤§ï¼Œåè€Œå¾—ä¸å¿å¤±ã€‚&lt;/p>
&lt;p>åŒèŠ±æ”»å‡»æ˜¯æŒ‡ä¸€ä¸ªä»£å¸è¢«èŠ±è´¹äº†ä¸¤æ¬¡ï¼Œè¿™åœ¨ä»»æ„çš„åŒºå—é“¾ç³»ç»Ÿä¸­æ˜¯ä¸è¢«å…è®¸çš„ã€‚å¦‚æžœé¿å…äº†åŒèŠ±é—®é¢˜ï¼ŒåŸºæœ¬å°±èƒ½é¿å…ä¸Šè¿°ä½œå¼Šä¸­æ”¶ç›Šè¿‡å¤§çš„é—®é¢˜ï¼Œå› ä¸ºæ”»å‡»è€…é¦–å…ˆè¦çªƒå–åˆ°ä½ çš„ç§é’¥ï¼ŒåŒæ—¶åˆèƒ½æŽ§åˆ¶äº†ä½ çš„è®¡ç®—èµ„æºï¼ˆç®—åŠ›ï¼‰ã€‚&lt;/p>
&lt;p>è§„åˆ™ä¸€ï¼šä¸€ä¸ªä»£å¸å¦‚æžœå·²ç»è¢«èŠ±è´¹ï¼Œé‚£ä¹ˆä¼šè¢«æ ‡è®°æˆå·²èŠ±è´¹ï¼Œå¦‚æžœå†æ¬¡æŽ¥æ”¶åˆ°è¿™ä¸ªä»£å¸è¢«èŠ±è´¹çš„è¯·æ±‚ï¼Œé‚£ä¹ˆè®°è´¦èŠ‚ç‚¹ä¼šæ‹’ç»æ‰“åŒ…è¿™ç¬”äº¤æ˜“ï¼›&lt;/p>
&lt;p>è§„åˆ™äºŒï¼šå¦‚æžœåŒæ—¶æŽ¥æ”¶åˆ°ä¸¤ä¸ªä¿¡å°ï¼Œè¿™ä¸¤ä¸ªä¿¡å°ä¸­è£…çš„ä¸¤ç¬”äº¤æ˜“å‡ºçŽ°äº†ä¸€ä¸ªä»£å¸è¢«èŠ±è´¹äº†ä¸¤æ¬¡çš„æƒ…å†µï¼Œè¿™ç§æƒ…å†µä¹Ÿå°±æ˜¯æˆ‘ä»¬æ‰€è¯´çš„åˆ†å‰ï¼ˆForkï¼‰ï¼Œé‚£ä¹ˆé€‰æ‹©æŒ–çŸ¿éš¾åº¦æ¯”è¾ƒå¤§çš„é‚£ä¸ªä¿¡å°ã€‚&lt;/p>
&lt;p>ç®€å•æ¥è¯´ï¼ŒåŒºå—é“¾æ˜¯ä¸€ä¸ªæä¾›äº†æ‹œå åº­å®¹é”™ã€å¹¶ä¿è¯äº†æœ€ç»ˆä¸€è‡´æ€§çš„åˆ†å¸ƒå¼æ•°æ®åº“ï¼›ä»Žæ•°æ®ç»“æž„ä¸Šçœ‹ï¼Œå®ƒæ˜¯åŸºäºŽæ—¶é—´åºåˆ—çš„é“¾å¼æ•°æ®å—ç»“æž„ï¼ŒåŒºå—é“¾æŒ‰æ—¶é—´åºåˆ—åŒ–åŒºå—æ•°æ®ï¼Œæ•´ä¸ªç½‘ç»œæœ‰ä¸€ä¸ªæœ€ç»ˆç¡®å®šçŠ¶æ€ï¼›ä»ŽèŠ‚ç‚¹æ‹“æ‰‘ä¸Šçœ‹ï¼Œå®ƒæ‰€æœ‰çš„èŠ‚ç‚¹äº’ä¸ºå†—ä½™å¤‡ä»½ï¼›ä»Žæ“ä½œä¸Šçœ‹ï¼Œå®ƒæä¾›äº†åŸºäºŽå¯†ç å­¦çš„å…¬ç§é’¥ç®¡ç†ä½“ç³»æ¥ç®¡ç†è´¦æˆ·ã€‚&lt;/p>
&lt;p>é€šè¿‡ä»¥ä¸Šæˆ‘ä»¬å¯ä»¥å‘çŽ°æ¯”ç‰¹å¸ã€ä»¥å¤ªåŠç­‰å…¬é“¾æ˜¯åé‡é«˜å¯ç”¨æ€§ã€åˆ†åŒºå®¹å¿æ€§ï¼ˆAPï¼‰ï¼Œæ»¡è¶³æœ€ç»ˆä¸€è‡´æ€§ï¼ˆCï¼‰ä¸” TPS è¾ƒä½Žçš„åˆ†å¸ƒå¼ç³»ç»Ÿã€‚
æˆ‘ä»¬åœ¨è®¨è®ºåŒºå—é“¾æ—¶ï¼Œé€šå¸¸æŒ‡çš„æ˜¯å…¬æœ‰åŒºå—é“¾ã€‚&lt;/p>
&lt;p>ï¼Œæˆ‘ä»¬é‡‡ç”¨ä»€ä¹ˆæ ·çš„ç®—æ³•ï¼ˆå…±è¯†æœºåˆ¶ï¼‰æ‰èƒ½å¤Ÿä¸ºå®ƒæä¾›ä¸€ä¸ªå¯ä¿¡ä»»çš„çŽ¯å¢ƒï¼Œå¹¶ä¸”ä½¿å¾—ï¼š&lt;/p>
&lt;p>èŠ‚ç‚¹ä¹‹é—´çš„æ•°æ®äº¤æ¢è¿‡ç¨‹ä¸å¯ç¯¡æ”¹ï¼Œå¹¶ä¸”å·²ç”Ÿæˆçš„åŽ†å²è®°å½•ä¸å¯è¢«ç¯¡æ”¹ï¼›
æ¯ä¸ªèŠ‚ç‚¹çš„æ•°æ®ä¼šåŒæ­¥åˆ°æœ€æ–°æ•°æ®ï¼Œå¹¶ä¸”ä¼šéªŒè¯æœ€æ–°æ•°æ®çš„æœ‰æ•ˆæ€§ï¼›
åŸºäºŽå°‘æ•°æœä»Žå¤šæ•°çš„åŽŸåˆ™ï¼Œæ•´ä½“èŠ‚ç‚¹ç»´æŠ¤çš„æ•°æ®æœ¬èº«å¯ä»¥å®¢è§‚åæ˜ äº¤æ¢åŽ†å²ã€‚&lt;/p>
&lt;p>æ‰€è°“è”ç›Ÿé“¾ï¼Œå°±æ˜¯è¿™ä¸ªåŒºå—é“¾å…·æœ‰å‡†å…¥è®¸å¯ï¼Œä¸åƒå…¬é“¾ï¼Œä»»ä½•äººéƒ½å¯ä»¥éšæ—¶è¿›å…¥ã€‚å‡†å…¥è®¸å¯ä¹Ÿå°±æ„å‘³ç€å€™é€‰èŠ‚ç‚¹è¿›å…¥åŒºå—é“¾æ—¶éœ€è¦å¾—åˆ°å·²ç»åœ¨ç½‘ç»œä¸­çš„èŠ‚ç‚¹è®¸å¯ï¼Œæ‰€ä»¥è”ç›Ÿé“¾ä¹Ÿå«åšè®¸å¯é“¾ã€‚&lt;/p>
&lt;p>é™¤äº†å…¬é“¾å’Œè”ç›Ÿé“¾çš„æ¦‚å¿µï¼Œè¿˜æœ‰ä¸€ç§åŒºå—é“¾æ¦‚å¿µï¼Œå«ä½œä¾§é“¾ã€‚&lt;/p>
&lt;p>ä¾§é“¾æ˜¯ä¸€ç§åŒå‘æŒ‚é’©æŠ€æœ¯ï¼Œå°†ä¸»é“¾ä¸­çš„ä»£å¸é”å®šåˆ°ä¾§é“¾ä¸­ä½¿ç”¨ã€‚æ‰€ä»¥å¯ä»¥å°†ä¸»é“¾çœ‹ä½œä¸»å¹²é“ï¼Œä¾§é“¾çœ‹ä½œä¸Žä¸»é“¾ç›¸å¯¹ç‹¬ç«‹çš„ä¸€æ¡åˆ†æ”¯é“ï¼Œä½œä¸ºä¸»é“¾åŠŸèƒ½çš„ä½Žè€¦åˆæ‹“å±•ã€‚&lt;/p>
&lt;p>æ¯”ç‰¹å¸çš„ P2P ç½‘ç»œåŸºäºŽ TCP æž„å»ºï¼Œä¸»ç½‘é»˜è®¤é€šä¿¡ç«¯å£ä¸º 8333ã€‚&lt;/p>
&lt;p>ä»¥å¤ªåŠçš„ P2P ç½‘ç»œåˆ™ä¸Žæ¯”ç‰¹å¸ä¸å¤ªç›¸åŒï¼Œä»¥å¤ªåŠ P2P ç½‘ç»œæ˜¯ä¸€ä¸ªå®Œå…¨åŠ å¯†çš„ç½‘ç»œï¼Œæä¾› UDP å’Œ TCP ä¸¤ç§è¿žæŽ¥æ–¹å¼ï¼Œä¸»ç½‘é»˜è®¤ TCP é€šä¿¡ç«¯å£æ˜¯ 30303ï¼ŒæŽ¨èçš„ UDP å‘çŽ°ç«¯å£ä¸º 30301ã€‚&lt;/p>
&lt;ol>
&lt;li>P2P ç½‘ç»œåè®®
P2P ç½‘ç»œåè®®æ˜¯æ‰€æœ‰åŒºå—é“¾çš„æœ€åº•å±‚æ¨¡å—ï¼Œè´Ÿè´£äº¤æ˜“æ•°æ®çš„ç½‘ç»œä¼ è¾“å’Œå¹¿æ’­ã€èŠ‚ç‚¹å‘çŽ°å’Œç»´æŠ¤ã€‚&lt;/li>
&lt;/ol>
&lt;p>é€šå¸¸æˆ‘ä»¬æ‰€ç”¨çš„éƒ½æ˜¯æ¯”ç‰¹å¸ P2P ç½‘ç»œåè®®æ¨¡å—ï¼Œå®ƒéµå¾ªä¸€å®šçš„äº¤äº’åŽŸåˆ™ã€‚æ¯”å¦‚ï¼šåˆæ¬¡è¿žæŽ¥åˆ°å…¶ä»–èŠ‚ç‚¹ä¼šè¢«è¦æ±‚æŒ‰ç…§æ¡æ‰‹åè®®æ¥ç¡®è®¤çŠ¶æ€ï¼Œåœ¨æ¡æ‰‹ä¹‹åŽå¼€å§‹è¯·æ±‚ Peer èŠ‚ç‚¹çš„åœ°å€æ•°æ®ä»¥åŠåŒºå—æ•°æ®ã€‚&lt;/p>
&lt;p>è¿™å¥— P2P äº¤äº’åè®®ä¹Ÿå…·æœ‰è‡ªå·±çš„æŒ‡ä»¤é›†åˆï¼ŒæŒ‡ä»¤ä½“çŽ°åœ¨åœ¨æ¶ˆæ¯å¤´ï¼ˆMessage Header) çš„å‘½ä»¤ï¼ˆcommandï¼‰åŸŸä¸­ï¼Œè¿™äº›å‘½ä»¤ä¸ºä¸Šå±‚æä¾›äº†èŠ‚ç‚¹å‘çŽ°ã€èŠ‚ç‚¹èŽ·å–ã€åŒºå—å¤´èŽ·å–ã€åŒºå—èŽ·å–ç­‰åŠŸèƒ½ã€‚&lt;/p>
&lt;ol start="2">
&lt;li>åˆ†å¸ƒå¼ä¸€è‡´æ€§ç®—æ³•
åœ¨ç»å…¸åˆ†å¸ƒå¼è®¡ç®—é¢†åŸŸï¼Œæˆ‘ä»¬æœ‰ Raft å’Œ Paxos ç®—æ³•å®¶æ—ä»£è¡¨çš„éžæ‹œå åº­å®¹é”™ç®—æ³•ï¼Œä»¥åŠå…·æœ‰æ‹œå åº­å®¹é”™ç‰¹æ€§çš„ PBFT å…±è¯†ç®—æ³•ã€‚&lt;/li>
&lt;/ol>
&lt;p>å¦‚æžœä»ŽæŠ€æœ¯æ¼”åŒ–çš„è§’åº¦æ¥çœ‹ï¼Œæˆ‘ä»¬å¯ä»¥å¾—å‡ºä¸€ä¸ªå›¾ï¼Œå…¶ä¸­ï¼ŒåŒºå—é“¾æŠ€æœ¯æŠŠåŽŸæ¥çš„åˆ†å¸ƒå¼ç®—æ³•è¿›è¡Œäº†ç»æµŽå­¦ä¸Šçš„æ‹“å±•ã€‚&lt;/p>
&lt;p>è€Œåœ¨åŒºå—é“¾é¢†åŸŸï¼Œå¤šé‡‡ç”¨ PoW å·¥ä½œé‡è¯æ˜Žç®—æ³•ã€PoS æƒç›Šè¯æ˜Žç®—æ³•ï¼Œä»¥åŠ DPoS ä»£ç†æƒç›Šè¯æ˜Žç®—æ³•ï¼Œä»¥ä¸Šä¸‰ç§æ˜¯ä¸šç•Œä¸»æµçš„å…±è¯†ç®—æ³•ï¼Œè¿™äº›ç®—æ³•ä¸Žç»å…¸åˆ†å¸ƒå¼ä¸€è‡´æ€§ç®—æ³•ä¸åŒçš„æ˜¯èžå…¥äº†ç»æµŽå­¦åšå¼ˆçš„æ¦‚å¿µï¼Œä¸‹é¢æˆ‘åˆ†åˆ«ç®€å•ä»‹ç»è¿™ä¸‰ç§å…±è¯†ç®—æ³•ã€‚&lt;/p>
&lt;p>PoWï¼šé€šå¸¸æ˜¯æŒ‡åœ¨ç»™å®šçš„çº¦æŸä¸‹ï¼Œæ±‚è§£ä¸€ä¸ªç‰¹å®šéš¾åº¦çš„æ•°å­¦é—®é¢˜ï¼Œè°è§£çš„é€Ÿåº¦å¿«ï¼Œè°å°±èƒ½èŽ·å¾—è®°è´¦æƒï¼ˆå‡ºå—ï¼‰æƒåˆ©ã€‚è¿™ä¸ªæ±‚è§£è¿‡ç¨‹å¾€å¾€ä¼šè½¬æ¢æˆè®¡ç®—é—®é¢˜ï¼Œæ‰€ä»¥åœ¨æ¯”æ‹¼é€Ÿåº¦çš„æƒ…å†µä¸‹ï¼Œä¹Ÿå°±å˜æˆäº†è°çš„è®¡ç®—æ–¹æ³•æ›´ä¼˜ï¼Œä»¥åŠè°çš„è®¾å¤‡æ€§èƒ½æ›´å¥½ã€‚æ¯”ç‰¹å¸æœ¬èº«çš„æ¼”åŒ–å¾ˆå¥½åœ°è¯ é‡Šäº†è¿™ä¸ªé—®é¢˜ï¼Œä¸­æœ¬èªè®¾è®¡çš„æ€è·¯æœ¬æ¥æ˜¯ç”± CPU è®¡ç®—ã€‚éšç€å¸‚åœºå‘å±•ï¼Œäººä»¬å‘çŽ° GPU ä¹Ÿå¯ä»¥å‚ä¸Žå…¶ä¸­ï¼Œè€Œä¸”æ•ˆçŽ‡å¯ä»¥è¾¾åˆ°åå€ç™¾å€ï¼ŒçŽ°åœ¨ï¼Œè¿™é¡¹å·¥ä½œåŸºæœ¬ä»¥ ASIC ä¸“ä¸šæŒ–çŸ¿èŠ¯ç‰‡ä¸ºä¸»ã€‚&lt;/p>
&lt;p>PoSï¼šè¿™æ˜¯ä¸€ç§è‚¡æƒè¯æ˜Žæœºåˆ¶ï¼Œå®ƒçš„åŸºæœ¬æ¦‚å¿µæ˜¯äº§ç”ŸåŒºå—çš„éš¾åº¦åº”è¯¥ä¸Žä½ åœ¨ç½‘ç»œé‡Œæ‰€å çš„è‚¡æƒï¼ˆæ‰€æœ‰æƒå æ¯”ï¼‰æˆæ¯”ä¾‹ï¼Œç›®å‰æœ‰ä¸‰ä¸ªç‰ˆæœ¬ PoS1.0ã€PoS2.0ã€PoS3.0ã€‚å®ƒå®žçŽ°çš„æ ¸å¿ƒæ€è·¯æ˜¯ï¼šä½¿ç”¨ä½ æ‰€é”å®šä»£å¸çš„å¸é¾„ï¼ˆCoinAgeï¼‰ä»¥åŠä¸€ä¸ªå°çš„å·¥ä½œé‡è¯æ˜Žï¼ŒåŽ»è®¡ç®—ä¸€ä¸ªç›®æ ‡å€¼ï¼Œå½“æ»¡è¶³ç›®æ ‡å€¼æ—¶ï¼Œä½ å°†å¯èƒ½èŽ·å–è®°è´¦æƒã€‚&lt;/p>
&lt;p>DPoSï¼šç®€å•æ¥ç†è§£å°±æ˜¯å°† PoS å…±è¯†ç®—æ³•ä¸­çš„è®°è´¦è€…è½¬æ¢ä¸ºæŒ‡å®šèŠ‚ç‚¹æ•°ç»„æˆçš„å°åœˆå­ï¼Œè€Œä¸æ˜¯æ‰€æœ‰äººéƒ½å¯ä»¥å‚ä¸Žè®°è´¦ï¼Œè¿™ä¸ªåœˆå­å¯èƒ½æ˜¯ 21 ä¸ªèŠ‚ç‚¹ï¼Œä¹Ÿæœ‰å¯èƒ½æ˜¯ 101 ä¸ªèŠ‚ç‚¹ã€‚è¿™ä¸€ç‚¹å–å†³äºŽè®¾è®¡ï¼Œåªæœ‰è¿™ä¸ªåœˆå­ä¸­çš„èŠ‚ç‚¹æ‰èƒ½èŽ·å¾—è®°è´¦æƒã€‚è¿™å°†æžå¤§åœ°æé«˜ç³»ç»Ÿçš„åžåé‡ï¼Œå› ä¸ºæ›´å°‘çš„èŠ‚ç‚¹ä¹Ÿå°±æ„å‘³ç€ç½‘ç»œå’ŒèŠ‚ç‚¹çš„å¯æŽ§ã€‚&lt;/p>
&lt;ol start="3">
&lt;li>åŠ å¯†ç­¾åç®—æ³•&lt;/li>
&lt;/ol>
&lt;p>åœ¨åŒºå—é“¾é¢†åŸŸï¼Œå“ˆå¸Œç®—æ³•æ˜¯åº”ç”¨å¾—æœ€å¤šçš„ç®—æ³•ã€‚å“ˆå¸Œç®—æ³•å…·æœ‰æŠ—ç¢°æ’žæ€§ã€åŽŸåƒä¸å¯é€†ã€éš¾é¢˜å‹å¥½æ€§ç­‰ç‰¹å¾ã€‚&lt;/p>
&lt;p>å½“ç„¶ï¼Œé™¤äº†æŒ–çŸ¿ç®—æ³•ï¼Œæˆ‘ä»¬è¿˜ä¼šä½¿ç”¨åˆ° RIPEMD160 ç®—æ³•ï¼Œä¸»è¦ç”¨äºŽç”Ÿæˆåœ°å€ï¼Œä¼—å¤šçš„æ¯”ç‰¹å¸è¡ç”Ÿä»£ç ä¸­ï¼Œç»å¤§éƒ¨åˆ†éƒ½é‡‡ç”¨äº†æ¯”ç‰¹å¸çš„åœ°å€è®¾è®¡ã€‚&lt;/p>
&lt;p>é™¤äº†åœ°å€ï¼Œæˆ‘ä»¬è¿˜ä¼šä½¿ç”¨åˆ°æœ€æ ¸å¿ƒçš„ï¼Œä¹Ÿæ˜¯åŒºå—é“¾ Token ç³»ç»Ÿçš„åŸºçŸ³ï¼šå…¬ç§é’¥å¯†ç ç®—æ³•ã€‚&lt;/p>
&lt;p>åœ¨æ¯”ç‰¹å¸å¤§ç±»çš„ä»£ç ä¸­ï¼ŒåŸºæœ¬ä¸Šä½¿ç”¨çš„éƒ½æ˜¯ ECDSAã€‚ECDSA æ˜¯ ECC ä¸Ž DSA çš„ç»“åˆï¼Œæ•´ä¸ªç­¾åè¿‡ç¨‹ä¸Ž DSA ç±»ä¼¼ï¼Œæ‰€ä¸ä¸€æ ·çš„æ˜¯ç­¾åä¸­é‡‡å–çš„ç®—æ³•ä¸º ECCï¼ˆæ¤­åœ†æ›²çº¿å‡½æ•°ï¼‰ã€‚&lt;/p>
&lt;ol start="4">
&lt;li>è´¦æˆ·ä¸Žäº¤æ˜“æ¨¡åž‹&lt;/li>
&lt;/ol>
&lt;p>åŒºå—é“¾çš„è´¦æœ¬ç‰¹æ€§ï¼Œé€šå¸¸åˆ†ä¸º UTXO ç»“æž„ä»¥åŠåŸºäºŽ Account-Balance ç»“æž„çš„è´¦æœ¬ç»“æž„ï¼Œæˆ‘ä»¬ä¹Ÿç§°ä¸ºè´¦æœ¬æ¨¡åž‹ã€‚UTXO æ˜¯â€œunspent transaction input/outputâ€çš„ç¼©å†™ï¼Œç¿»è¯‘è¿‡æ¥å°±æ˜¯æŒ‡â€œæœªèŠ±è´¹çš„äº¤æ˜“è¾“å…¥è¾“å‡ºâ€ã€‚&lt;/p>
&lt;p>åŒºå—é“¾çš„å…±è¯†ç®—æ³•ï¼Œæˆ‘åœ¨æŸäº›åœºåˆç›´æŽ¥ç§°ä½œåŸºäºŽç»æµŽå­¦çš„åšå¼ˆç®—æ³•ï¼Œä»¥åŒºåˆ«äºŽç»å…¸åˆ†å¸ƒå¼ä¸€è‡´æ€§ç®—æ³•æ€è·¯ï¼Œå®ƒçš„æ•´ä½“æ€è·¯å°±æ˜¯è®©æ”»å‡»è€…çš„æ”»å‡»æˆæœ¬è¿œè¿œå¤§äºŽæ”¶ç›Šã€‚&lt;/p>
&lt;p>åŒºå—é“¾ä¸­çš„å…±è¯†ç®—æ³•ç›®å‰å…·æœ‰å·¥ä¸šæˆç†Ÿåº¦çš„æ˜¯ PoWï¼Œå¦å¤–ä¸¤ç§æ¯”è¾ƒæˆç†Ÿçš„æ˜¯ PoS å’Œ DPoSï¼Œå…¶æ¬¡è¿˜æœ‰ä¸€äº›å˜ç§å’Œå•ä¸€å¸ç§ä½¿ç”¨çš„å…±è¯†ç®—æ³•ï¼Œä¾‹å¦‚ Ripple å…±è¯†ã€PoC å…±è¯†ï¼ˆæ¦‚å¿µæ€§è¯æ˜Žï¼‰ã€PoE å…±è¯†ï¼ˆå­˜åœ¨æ€§è¯æ˜Žï¼‰ã€‚&lt;/p>
&lt;p>åœ¨ä½¿ç”¨ PoW å…±è¯†ç®—æ³•çš„æƒ…å†µä¸‹ï¼Œå®¹é”™é˜ˆå€¼æ˜¯ 50%ï¼Œè€Œ PBFT åŠå…¶å˜ç§çš„å®¹é”™é˜ˆå€¼æ˜¯ 33% å·¦å³ï¼Œè¿™é‡Œçš„ç™¾åˆ†æ¯”æ˜¯æŒ‡ä½œå¼ŠèŠ‚ç‚¹å å…¨ç½‘èŠ‚ç‚¹çš„ æ¯”ä¾‹ã€‚&lt;/p>
&lt;p>PoX ç±»çš„ç®—æ³•å…¶å®žéƒ½å»¶ç»­äº† PoW çš„è®¾è®¡ç†å¿µï¼Œç›¸æ¯”è¾ƒç»å…¸åˆ†å¸ƒå¼ä¸€è‡´æ€§ç®—æ³•ï¼ŒPoX ç±»ç®—æ³•é€šè¿‡ æ¦‚çŽ‡é€‰æ‹©è®°è´¦è€…é™ä½Žäº†æ½œåœ¨çš„ææ¡ˆè€…ï¼Œå¦å¤–æ˜¯å»¶é•¿äº†è¾¾æˆæœ€ç»ˆä¸€è‡´æ€§çš„æ—¶é—´ã€‚&lt;/p>
&lt;p>ç¬¬ä¸€æ¡é™ä½Žäº†ç³»ç»Ÿé€šä¿¡å¤æ‚åº¦ï¼Œæ¯æ¬¡è®°è´¦ç³»ç»Ÿçš„ç¡®å®šæ€§å…¶å®žæ˜¯æ¦‚çŽ‡ç¡®å®šçš„ï¼Œåˆç”±äºŽè¢«é€‰ä¸­éœ€è¦ä»˜å‡ºæˆæœ¬ï¼Œæ­¤å¤„æ‰æé«˜äº†è®°è´¦æˆæœ¬é˜ˆå€¼ï¼Œç»“åˆåŒºå—é“¾çš„åŸºç¡€ä»£å¸è®¾è®¡ï¼Œæ˜¯ä¸€ä¸ªéžå¸¸å¤©æ‰çš„æƒ³æ³•ã€‚&lt;/p></description></item><item><title>DataVis-CheatSheet</title><link>https://ng-tech.icu/books/awesome-cheatsheets/4.infrastructure/datavis-cheatsheet/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://ng-tech.icu/books/awesome-cheatsheets/4.infrastructure/datavis-cheatsheet/</guid><description>&lt;h1 id="data-visualization-cheatsheet">Data Visualization CheatSheet&lt;/h1>
&lt;p>æ•°æ®å¯è§†åŒ–ç ”ç©¶çš„æ˜¯ï¼Œå¦‚ä½•å°†æ•°æ®è½¬åŒ–æˆä¸ºäº¤äº’çš„å›¾å½¢æˆ–å›¾åƒç­‰ï¼Œä»¥è§†è§‰å¯ä»¥æ„Ÿå—çš„æ–¹å¼è¡¨è¾¾ï¼Œå¢žå¼ºäººçš„è®¤çŸ¥èƒ½åŠ›ï¼Œè¾¾åˆ°å‘çŽ°ã€è§£é‡Šã€åˆ†æžã€æŽ¢ç´¢ã€å†³ç­–å’Œå­¦ä¹ çš„ç›®çš„ã€‚&lt;/p>
&lt;p>æ•°æ®åº“å¯è§†åŒ–å¹¶éžä»…æŒ‡å›¾è¡¨ï¼Œè€Œæ˜¯å¯¹äºŽäº¤äº’ã€è§†è§‰ã€ä½“éªŒç­‰å®Œæ•´ç”¨æˆ·é“¾è·¯çš„å»¶ä¼¸ï¼Œ&lt;a href="https://parg.co/6AH" target="_blank" rel="noopener">UI CheatSheet&lt;/a> æ˜¯å¯è§†åŒ–çš„åŸºç¡€çŸ¥è¯†ã€‚&lt;/p>
&lt;h1 id="canvas">Canvas&lt;/h1>
&lt;h1 id="links">Links&lt;/h1>
&lt;ul>
&lt;li>&lt;a href="https://blog.csdn.net/cdnight/article/details/48468653" target="_blank" rel="noopener">https://blog.csdn.net/cdnight/article/details/48468653&lt;/a>&lt;/li>
&lt;/ul></description></item><item><title>Docker-Cheatsheet</title><link>https://ng-tech.icu/books/awesome-cheatsheets/4.infrastructure/docker-cheatsheet/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://ng-tech.icu/books/awesome-cheatsheets/4.infrastructure/docker-cheatsheet/</guid><description>&lt;p>
&lt;figure >
&lt;div class="d-flex justify-content-center">
&lt;div class="w-100" >&lt;img src="https://user-images.githubusercontent.com/5803001/45699770-5d0a0f00-bb9d-11e8-8ce7-82650bfcbb39.png" alt="image" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>&lt;/p>
&lt;blockquote>
&lt;p>ðŸ“– èŠ‚é€‰è‡ª &lt;a href="https://parg.co/o9d" target="_blank" rel="noopener">Awesome CheatSheet/Docker CheatSheet&lt;/a>ï¼Œå¯¹æ¥è‡ª&lt;a href="https://docs.docker.com/" target="_blank" rel="noopener">å®˜æ–¹æ–‡æ¡£&lt;/a>åŠ &lt;a href="https://parg.co/o90" target="_blank" rel="noopener">Docker Links&lt;/a> ä¸­é“¾æŽ¥å†…å®¹çš„å½’æ¡£æ•´ç†ï¼ŒåŒ…å«äº†æ—¥å¸¸å·¥ä½œä¸­å¸¸ç”¨çš„ Docker æ¦‚å¿µä¸Žå‘½ä»¤ï¼Œå¦‚æžœå¯¹äºŽ Linux å¸¸ç”¨æ“ä½œå°šä¸ç†Ÿæ‚‰çš„å¯ä»¥å‚è€ƒ &lt;a href="https://parg.co/oiT" target="_blank" rel="noopener">Linux Commands CheatSheet&lt;/a>ã€‚&lt;/p>
&lt;/blockquote>
&lt;h1 id="docker-cheatsheet--docker-é…ç½®ä¸Žå®žè·µæ¸…å•">Docker CheatSheet | Docker é…ç½®ä¸Žå®žè·µæ¸…å•&lt;/h1>
&lt;p>å®¹å™¨æ˜¯åœ¨æ“ä½œç³»ç»Ÿä¸­å»ºç«‹éš”ç¦»ä¸Šä¸‹æ–‡çš„ä¸€ç§æ–¹æ³•ã€‚å®žé™…ä¸Šï¼Œè¿™æ„å‘³ç€å®ƒä»¬ä¸­çš„æ¯ä¸€ä¸ªéƒ½æœ‰ä¸€ä¸ªå•ç‹¬çš„åŒ…å«äº†ä¸€ç»„å·²å®‰è£…çš„è½¯ä»¶å’Œç›¸å…³é…ç½®çš„è™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿã€‚ç”±äºŽå®ƒä»¬æ˜¯ç›¸äº’éš”ç¦»çš„ï¼Œå› æ­¤ä»»ä½•å®¹å™¨éƒ½ä¸èƒ½ç›´æŽ¥è®¿é—®æˆ–å½±å“å…¶ä»–å®¹å™¨æˆ–åº•å±‚å®¿ä¸»æ“ä½œç³»ç»Ÿã€‚Docker æ˜¯ä¸€ä¸ªå¼€æºçš„åº”ç”¨å®¹å™¨å¼•æ“Žï¼ŒåŸºäºŽ Go è¯­è¨€ å¹¶éµä»Ž Apache2.0 åè®®å¼€æºã€‚Docker å¯ä»¥è®©å¼€å‘è€…æ‰“åŒ…ä»–ä»¬çš„åº”ç”¨ä»¥åŠä¾èµ–åŒ…åˆ°ä¸€ä¸ªè½»é‡çº§ã€å¯ç§»æ¤çš„å®¹å™¨ä¸­ï¼Œç„¶åŽå‘å¸ƒåˆ°ä»»ä½•æµè¡Œçš„ Linux æœºå™¨ä¸Šã€‚&lt;/p>
&lt;p>
&lt;figure >
&lt;div class="d-flex justify-content-center">
&lt;div class="w-100" >&lt;img src="https://user-images.githubusercontent.com/5803001/43813144-f630ba5c-9af6-11e8-8443-175666d4615a.png" alt="image" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>&lt;/p>
&lt;p>è™šæ‹Ÿæœºæœ€å¤§çš„ç“¶é¢ˆåœ¨äºŽå…¶éœ€è¦ç‰¹æ®Šç¡¬ä»¶è™šæ‹ŸåŒ–æŠ€æœ¯æ”¯æŒï¼Œå¹¶ä¸”æºå¸¦å®Œæ•´çš„æ“ä½œç³»ç»Ÿï¼›è€Œ Docker æ²¡æœ‰ç¡¬ä»¶è™šæ‹ŸåŒ–ï¼Œå¯ä»¥è¿è¡Œåœ¨ç‰©ç†æœºã€è™šæ‹Ÿæœº, ç”šè‡³åµŒå¥—è¿è¡Œåœ¨ Docker å®¹å™¨å†…ï¼Œå¹¶ä¸”å…¶ä¸æºå¸¦æ“ä½œç³»ç»Ÿçš„ï¼Œä¼šè½»å·§å¾ˆå¤šã€‚åœ¨è°ƒç”¨å®¿ä¸»æœºçš„å†…å­˜ã€CPUã€ç£ç›˜ç­‰ç­‰èµ„æºæ—¶ï¼Œè™šæ‹Ÿæœºæ˜¯åˆ©ç”¨ Hypervisor åŽ»è™šæ‹ŸåŒ–å†…å­˜ï¼Œæ•´ä¸ªè°ƒç”¨è¿‡ç¨‹æ˜¯è™šæ‹Ÿå†…å­˜-&amp;gt;è™šæ‹Ÿç‰©ç†å†…å­˜-&amp;gt;çœŸæ­£ç‰©ç†å†…å­˜ï¼Œä½†æ˜¯ Docker æ˜¯åˆ©ç”¨ Docker Engine åŽ»è°ƒç”¨å®¿ä¸»çš„çš„èµ„æºï¼Œè¿™æ—¶å€™è¿‡ç¨‹æ˜¯è™šæ‹Ÿå†…å­˜-&amp;gt;çœŸæ­£ç‰©ç†å†…å­˜ã€‚&lt;/p>
&lt;p>Docker ç»¼åˆè¿ç”¨äº† Cgroup, Linux Namespaceï¼ŒSecomp capability, Selinux ç­‰æœºåˆ¶ï¼Œåœ¨ &lt;a href="./Docker-Internals-CheatSheet">Docker Internals CheatSheet&lt;/a> ä¸­æˆ‘ä»¬ä¼šæœ‰è¯¦ç»†çš„è®¨è®ºï¼Œæˆ–è€…å‰å¾€ &lt;a href="https://github.com/wx-chevalier/Backend-Boilerplate/tree/master/docker" target="_blank" rel="noopener">Backend Boilerplate/docker&lt;/a> æµè§ˆå¸¸è§æœåŠ¡/åº”ç”¨çš„ Docker é…ç½®æ¡ˆä¾‹ã€‚&lt;/p>
&lt;p>
&lt;figure >
&lt;div class="d-flex justify-content-center">
&lt;div class="w-100" >&lt;img src="https://user-images.githubusercontent.com/5803001/44158672-dec2d480-a0e7-11e8-9f50-ce83c9638853.png" alt="image" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>&lt;/p>
&lt;h1 id="å®‰è£…ä¸Žé…ç½®">å®‰è£…ä¸Žé…ç½®&lt;/h1>
&lt;h2 id="docker-ce">Docker CE&lt;/h2>
&lt;p>è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨&lt;a href="https://mirrors.ustc.edu.cn/help/docker-ce.html" target="_blank" rel="noopener">ç§‘å¤§çš„ Docker CE æº&lt;/a>è¿›è¡Œå®‰è£…ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># æ›´æ”¹ Ubuntu é»˜è®¤æºåœ°å€&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ sudo sed -i &lt;span class="s1">&amp;#39;s/archive.ubuntu.com/mirrors.ustc.edu.cn/g&amp;#39;&lt;/span> /etc/apt/sources.list
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># å®‰è£…å¿…å¤‡çš„ç³»ç»Ÿå‘½ä»¤&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ sudo apt-get install -y python-software-properties
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ curl -fsSL https://mirrors.ustc.edu.cn/docker-ce/linux/ubuntu/gpg &lt;span class="p">|&lt;/span> sudo apt-key add -
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ sudo add-apt-repository &lt;span class="s2">&amp;#34;deb [arch=amd64] https://mirrors.ustc.edu.cn/docker-ce/linux/ubuntu &lt;/span>&lt;span class="k">$(&lt;/span>lsb_release -cs&lt;span class="k">)&lt;/span>&lt;span class="s2"> stable&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ sudo apt-get update
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ apt-cache policy docker-ce &lt;span class="c1"># åˆ—ä¸¾ docker-ce ç‰ˆæœ¬&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ apt-get install docker-ce&lt;span class="o">=&lt;/span>17.03.2-ce....
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="daemon-configuration">Daemon Configuration&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># é…ç½®å¼€æœºè‡ªå¯åŠ¨&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ sudo systemctl &lt;span class="nb">enable&lt;/span> docker
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># å–æ¶ˆå¼€æœºè‡ªå¯åŠ¨&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ sudo systemctl disable docker
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>æˆ‘ä»¬è¿˜éœ€è¦ä¿®æ”¹å­˜å‚¨è·¯å¾„ï¼ŒæŒ‡å®šé•œåƒå­˜å‚¨åœ°å€ï¼Œå…è®¸è¿œç¨‹è®¿é—®ï¼›æ­¤æ—¶æˆ‘ä»¬å¯ä»¥ä¿®æ”¹ systemd ä¸­çš„é…ç½®æ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥ä¿®æ”¹ &lt;code>/etc/docker/daemon.json&lt;/code>ï¼Œæ­¤å¤„ä»¥ä¿®æ”¹æœåŠ¡ä¸ºä¾‹ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># ä½¿ç”¨ systemctl å‘½ä»¤è¡Œä¿®æ”¹&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ sudo systemctl edit docker.service
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># æˆ–è€…æŸ¥æ‰¾é…ç½®åœ°å€å¹¶ä½¿ç”¨ Vim ä¿®æ”¹&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ systemctl status docker
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># ä¿®æ”¹æ–‡ä»¶å†…å®¹&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>Service&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">ExecStart&lt;/span>&lt;span class="o">=&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">ExecStart&lt;/span>&lt;span class="o">=&lt;/span>/usr/bin/dockerd -H fd:// -H tcp://127.0.0.1:2375 -H unix:///var/run/docker.sock --insecure-registry 10.196.108.176:5000 --dns 114.114.114.114 --dns 8.8.8.8 --dns 8.8.4.4 -g /mnt
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ç„¶åŽé‡å¯æœåŠ¡ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># é‡æ–°è½½å…¥æœåŠ¡é…ç½®&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ sudo systemctl daemon-reload
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># é‡å¯ Docker&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ sudo systemctl restart docker.service
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># åˆ¤æ–­æ˜¯å¦é…ç½®æˆåŠŸ&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ sudo netstat -lntp &lt;span class="p">|&lt;/span> grep dockerd
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="docker-swarm">Docker Swarm&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># åœ¨ä¸»èŠ‚ç‚¹å¯åŠ¨ Swarm&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ docker swarm init
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># æŸ¥çœ‹ Swarm å¯†é’¥&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ docker swarm join-token -q worker
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># åœ¨ä¸»èŠ‚ç‚¹å¯åŠ¨ Procontainer&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ docker run -it -p 9000:9000 -v /var/run/docker.sock:/var/run/docker.sock portainer/portainer
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># åœ¨ä¸»èŠ‚ç‚¹å¯åŠ¨ Registry&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ docker run -d -p 5000:5000 --restart&lt;span class="o">=&lt;/span>always --name registry registry:2
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># å°†å­èŠ‚ç‚¹åŠ å…¥åˆ° Swarm&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ docker swarm join &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span>--token &lt;span class="si">${&lt;/span>&lt;span class="nv">TOKEN&lt;/span>&lt;span class="si">}&lt;/span> &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span>10.196.108.176:2377
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="å¸¸ç”¨é…ç½®">å¸¸ç”¨é…ç½®&lt;/h2>
&lt;h3 id="ä»£ç†">ä»£ç†&lt;/h3>
&lt;p>é‰´äºŽ gcr åŸŸåçš„ä¸å¯ç”¨ï¼Œæˆ‘ä»¬éœ€è¦åˆ©ç”¨ &lt;a href="https://hub.docker.com/r/bluebu/shadowsocks-privoxy/" target="_blank" rel="noopener">ss-privoxy&lt;/a> ç­‰å·¥å…·æ­å»º Docker æºä»£ç†ï¼Œä¹Ÿå¯ä»¥å‚è€ƒ&lt;a href="https://www.jianshu.com/p/13f4b23824d8" target="_blank" rel="noopener">è¿™é‡Œ&lt;/a>æ‰‹åŠ¨é…ç½®å®¢æˆ·ç«¯ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">$ docker run -i -t -e &lt;span class="nv">SERVER_ADDR&lt;/span>&lt;span class="o">=&lt;/span>ss.server.ip -e &lt;span class="nv">SERVER_PORT&lt;/span>&lt;span class="o">=&lt;/span>port -e &lt;span class="nv">PASSWORD&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">123456&lt;/span> bluebu/shadowsocks-privoxy
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>å¦‚æžœéœ€è¦æ‰‹åŠ¨å®‰è£…ï¼Œéœ€è¦å…ˆå®‰è£… sslocal å‘½ä»¤ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">$ apt install python3-pip
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ pip3 install https://github.com/shadowsocks/shadowsocks/archive/master.zip -U
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>å†™å…¥ä½ çš„é…ç½®æ–‡ä»¶åˆ°ä¾‹å¦‚ &lt;code>config.json&lt;/code>ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-json" data-lang="json">&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;server&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;...&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;server_port&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="err">...&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;local_port&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">1080&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;password&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;...&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;method&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;chacha20-ietf-poly1305&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;timeout&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">600&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>å¯åŠ¨ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">$ sslocal -c config.json
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>è¿™æ—¶ä¸€ä¸ª socks5 ä»£ç†åœ¨ä½ æœ¬æœºå°±å¯åŠ¨äº†ã€‚ä¸‹é¢å®‰è£…é…ç½® privoxy æŠŠä»–è½¬æˆ http/https ä»£ç†ã€‚å®‰è£…ç•¥ã€‚ä¿®æ”¹/æ·»åŠ ä¸¤ä¸ª privoxy çš„é…ç½®(å¯¹äºŽ ubuntu, åœ¨ /etc/privoxy/config)ï¼š&lt;/p>
&lt;pre tabindex="0">&lt;code>listen-address 0.0.0.0:8118 # æ‰€æœ‰ interface ä¸Šç›‘å¬æµé‡
forward-socks5 / 127.0.0.1:1080 . # æµé‡å¯¼å‘æœ¬æœºä¸Šçš„ ss ä»£ç†
&lt;/code>&lt;/pre>&lt;p>è¿™æ—¶å¯ä»¥è®¿é—®ä¸€ä¸‹ä¸å­˜åœ¨çš„ç½‘ç«™æµ‹è¯•ä¸€ä¸‹ï¼š&lt;/p>
&lt;pre tabindex="0">&lt;code>HTTP_PROXY=127.0.0.1:8118 HTTPS_PROXY=127.0.0.1:8118 curl https://www.google.com
&lt;/code>&lt;/pre>&lt;p>ä¸‹é¢ä¿®æ”¹å„å°æœºå™¨çš„ docker é…ç½®(å‡å®šæˆ‘ä»¬çš„ master å†…ç½‘åœ°å€ &lt;code>1.1.1.2&lt;/code>, å…¶ä»–ä¸¤å°æœºå™¨åœ°å€ä¸º &lt;code>1.1.1.3&lt;/code> å’Œ &lt;code>1.1.1.4&lt;/code>)ï¼š&lt;/p>
&lt;pre tabindex="0">&lt;code>[Environment]
Environment=&amp;#34;HTTP_PROXY=127.0.0.1:8118&amp;#34; &amp;#34;HTTPS_PROXY=127.0.0.1:8118&amp;#34; &amp;#34;NO_PROXY=localhost,127.0.0.1,1.1.1.2,1.1.1.3,1.1.1.4&amp;#34;
...
&lt;/code>&lt;/pre>&lt;p>çŽ¯å¢ƒå˜é‡ &lt;code>NO_PROXY&lt;/code> é¡¾åæ€ä¹‰ï¼Œå®ƒä¸æ”¯æŒ CIDR åº”è¯¥ï¼Œæ‰€ä»¥éœ€è¦ä½ æžšä¸¾ä¸€ä¸‹é›†ç¾¤ä¸»æœºåœ°å€ã€‚&lt;/p>
&lt;h3 id="å­˜å‚¨ä¸Žæ—¥å¿—">å­˜å‚¨ä¸Žæ—¥å¿—&lt;/h3>
&lt;p>çº¿ä¸Šç³»ç»Ÿä¸­æˆ‘ä»¬å¾€å¾€ä¹Ÿéœ€è¦å¯¹äºŽ Docker äº§ç”Ÿçš„&lt;/p>
&lt;h1 id="é•œåƒ">é•œåƒ&lt;/h1>
&lt;p>é•œåƒæè¿°äº† Docker å®¹å™¨è¿è¡Œçš„åˆå§‹æ–‡ä»¶ç³»ç»Ÿ, åŒ…å«è¿è¡Œåº”ç”¨æ‰€éœ€çš„æ‰€æœ‰ä¾èµ–ã€‚å³å¯ä»¥æ˜¯ä¸€ä¸ªå®Œæ•´çš„æ“ä½œç³»ç»Ÿ, ä¹Ÿå¯ä»¥ä»…åŒ…å«åº”ç”¨æ‰€éœ€çš„æœ€å° bin/lib æ–‡ä»¶é›†åˆã€‚Docker é•œåƒå’Œå®¹å™¨é‡‡ç”¨åˆ†å±‚æ–‡ä»¶ç³»ç»Ÿç»“æž„, æ¯ä¸ªå®¹å™¨åŒ…å«ä¸€å±‚è–„è–„çš„å¯å†™å±‚, åªè¯»éƒ¨åˆ†æ˜¯å…±äº«çš„ï¼Œè¿™ç§æœºåˆ¶ä¿è¯äº†èµ„æºçš„å¯å¤ç”¨æ€§ï¼Œå‡å°‘äº†é•œåƒä¸Žå®¹å™¨çš„ç©ºé—´å ç”¨ã€‚Docker é•œåƒå­˜å‚¨å¼•æ“Žæœ‰ aufs, devicemapper, overlay ç­‰å¤šç§å®žçŽ°ã€‚&lt;/p>
&lt;h2 id="æž„å»ºä¸Žæ‹‰å–">æž„å»ºä¸Žæ‹‰å–&lt;/h2>
&lt;p>ç¼–å†™å®Œæˆ Dockerfile ä¹‹åŽï¼Œå¯ä»¥é€šè¿‡ &lt;code>docker build&lt;/code> å‘½ä»¤æ¥åˆ›å»ºé•œåƒï¼›å…³äºŽ Dockfile çš„å…·ä½“è¯­æ³•ï¼Œå¯ä»¥æŸ¥çœ‹ä¸‹æ–‡ã€‚Dockfile åŸºæœ¬çš„æ ¼å¼ä¸º &lt;code>docker build [ é€‰é¡¹ ] è·¯å¾„&lt;/code>ï¼Œè¯¥å‘½ä»¤å°†è¯»å–æŒ‡å®šè·¯å¾„ä¸‹(åŒ…æ‹¬å­ç›®å½•)çš„ Dockerfileï¼Œå¹¶å°†è¯¥è·¯å¾„ä¸‹æ‰€æœ‰å†…å®¹å‘é€ç»™ Docker æœåŠ¡ç«¯ï¼Œç”±æœåŠ¡ç«¯æ¥åˆ›å»ºé•œåƒã€‚å› æ­¤ä¸€èˆ¬å»ºè®®æ”¾ç½® Dockerfile çš„ç›®å½•ä¸ºç©ºç›®å½•ã€‚ä¹Ÿå¯ä»¥é€šè¿‡ &lt;code>.dockerignore&lt;/code> æ–‡ä»¶(æ¯ä¸€è¡Œæ·»åŠ ä¸€æ¡åŒ¹é…æ¨¡å¼)æ¥è®© Docker å¿½ç•¥è·¯å¾„ä¸‹çš„ç›®å½•å’Œæ–‡ä»¶ã€‚&lt;/p>
&lt;p>é•œåƒçš„å®Œæ•´ tag ä¸ä»…åŒ…å«é•œåƒåå­—, è¿˜æŒ‡æ˜Žäº†é•œåƒä»Žå“ªé‡Œæ¥, è¦åˆ°å“ªé‡ŒåŽ», å°±åƒä¸€ä¸ª URLã€‚å¯ä»¥é€šè¿‡ &lt;code>-t&lt;/code> é€‰é¡¹æŒ‡å®šé•œåƒçš„æ ‡ç­¾ä¿¡æ¯ï¼Œè­¬å¦‚ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">$ sudo docker build -t myrepo/myapp /tmp/test1/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ docker build -t username/image_name:tag_name .
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ docker tag SOURCE_IMAGE&lt;span class="o">[&lt;/span>:TAG&lt;span class="o">]&lt;/span> TARGET_IMAGE&lt;span class="o">[&lt;/span>:TAG&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Docker æ”¯æŒä»Ž Registry æ‹‰å–é•œåƒï¼Œæˆ–è€…å°†æŸä¸ªå®¹å™¨ä¿å­˜ä¸ºé•œåƒï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># æ‹‰å–é•œåƒ&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ docker pull image_name
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># å°†æŸä¸ªå®¹å™¨ä¿å­˜ä¸ºé•œåƒ&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ docker commit -m â€œcommit messageâ€ -a â€œauthorâ€ container_name username/image_name:tag
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Docker æ”¯æŒå°†é•œåƒä¿å­˜ä¸ºæ–‡ä»¶ï¼Œä»¥æ–¹ä¾¿é•œåƒçš„å¯¼å‡ºä¸ŽåŠ è½½ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># ä¿å­˜é•œåƒ&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ docker save --output saved-image.tar my-image:1.0.0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ docker save my-image:1.0.0 &amp;gt; saved-image.tar
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ docker save my_image:my_tag &lt;span class="p">|&lt;/span> gzip &amp;gt; my_image.tar.gz
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># å¯¼å…¥é•œåƒ&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ docker load --input saved-image.tar
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ docker load &amp;lt; saved-image.tar
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="é•œåƒç®¡ç†">é•œåƒç®¡ç†&lt;/h2>
&lt;p>&lt;code>docker images&lt;/code> å‘½ä»¤ä¼šåˆ—ä¸¾å‡ºå…¨éƒ¨çš„é•œåƒ:&lt;/p>
&lt;pre tabindex="0">&lt;code>$ docker images
REPOSITORY TAG IMAGE ID CREATED VIRTUAL SIZE
mynewimage latest 4d2eab1c0b9a 5 minutes ago 278.1 MB
ubuntu 14.04 ad892dd21d60 11 days ago 275.5 MB
&amp;lt;none&amp;gt; &amp;lt;none&amp;gt; 6b0a59aa7c48 11 days ago 169.4 MB
&amp;lt;none&amp;gt; &amp;lt;none&amp;gt; 6cfa4d1f33fb 7 weeks ago 0 B
&lt;/code>&lt;/pre>&lt;p>Docker ä¸­é•œåƒä¸»è¦åˆ†ä¸ºä¸‰ç§çŠ¶æ€:&lt;/p>
&lt;ul>
&lt;li>å·²ä½¿ç”¨é•œåƒ(used image): æŒ‡æ‰€æœ‰å·²è¢«å®¹å™¨ï¼ˆåŒ…æ‹¬å·²åœæ­¢çš„ï¼‰å…³è”çš„é•œåƒã€‚å³ docker ps -a çœ‹åˆ°çš„æ‰€æœ‰å®¹å™¨ä½¿ç”¨çš„é•œåƒã€‚&lt;/li>
&lt;li>æœªå¼•ç”¨é•œåƒ(unreferenced image): æ²¡æœ‰è¢«åˆ†é…æˆ–ä½¿ç”¨åœ¨å®¹å™¨ä¸­çš„é•œåƒï¼Œä½†å®ƒæœ‰ Tag ä¿¡æ¯ã€‚&lt;/li>
&lt;li>æ‚¬ç©ºé•œåƒ(dangling image): æœªé…ç½®ä»»ä½• Tagï¼ˆä¹Ÿå°±æ— æ³•è¢«å¼•ç”¨ï¼‰çš„é•œåƒï¼Œæ‰€ä»¥æ‚¬ç©ºã€‚è¿™é€šå¸¸æ˜¯ç”±äºŽé•œåƒ build çš„æ—¶å€™æ²¡æœ‰æŒ‡å®š -t å‚æ•°é…ç½® Tag å¯¼è‡´çš„ã€‚&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># åˆ—ä¸¾æœªä½¿ç”¨çš„&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ docker images --filter &lt;span class="s2">&amp;#34;dangling=true&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># åˆ é™¤æ‰€æœ‰æ— ç”¨çš„é•œåƒ&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ docker rmi &lt;span class="k">$(&lt;/span>docker images -q -f &lt;span class="nv">dangling&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="nb">true&lt;/span>&lt;span class="k">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="dockfile">Dockfile&lt;/h2>
&lt;p>Dockerfile ç”±ä¸€è¡Œè¡Œå‘½ä»¤è¯­å¥ç»„æˆï¼Œå¹¶ä¸”æ”¯æŒä»¥ &lt;code>#&lt;/code> å¼€å¤´çš„æ³¨é‡Šè¡Œã€‚ä¸€èˆ¬çš„ï¼ŒDockerfile åˆ†ä¸ºå››éƒ¨åˆ†ï¼šåŸºç¡€é•œåƒä¿¡æ¯ã€ç»´æŠ¤è€…ä¿¡æ¯ã€é•œåƒæ“ä½œæŒ‡ä»¤å’Œå®¹å™¨å¯åŠ¨æ—¶æ‰§è¡ŒæŒ‡ä»¤ï¼›æŒ‡ä»¤çš„ä¸€èˆ¬æ ¼å¼ä¸º &lt;code>INSTRUCTION arguments&lt;/code>ï¼ŒæŒ‡ä»¤åŒ…æ‹¬ &lt;code>FROM&lt;/code>ã€&lt;code>MAINTAINER&lt;/code>ã€&lt;code>RUN&lt;/code> ç­‰ã€‚ä¾‹å¦‚ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># MongoDB Dockerfile&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># https://github.com/dockerfile/mongodb&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># Pull base image.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">FROM dockerfile/ubuntu
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ENV SOURCE http://downloads-distro.mongodb.org/repo/ubuntu-upstart
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># Install MongoDB.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">RUN &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> apt-key adv --keyserver hkp://keyserver.ubuntu.com:80 --recv 7F0CEB10 &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> &lt;span class="nb">echo&lt;/span> &lt;span class="s1">&amp;#39;deb $SOURCE dist 10gen&amp;#39;&lt;/span> &amp;gt; /etc/apt/sources.list.d/mongodb.list &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> apt-get update &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> apt-get install -y mongodb-org &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> rm -rf /var/lib/apt/lists/*
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ENV PATH /usr/local/mongo/bin:&lt;span class="nv">$PATH&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># Define mountable directories.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">VOLUME &lt;span class="o">[&lt;/span>&lt;span class="s2">&amp;#34;/data/db&amp;#34;&lt;/span>&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># Define working directory.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">WORKDIR /data
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># Define default command.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">CMD &lt;span class="o">[&lt;/span>&lt;span class="s2">&amp;#34;mongod&amp;#34;&lt;/span>&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># Expose ports.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># - 27017: process&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># - 28017: http&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">EXPOSE &lt;span class="m">27017&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">EXPOSE &lt;span class="m">28017&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>å…¶ä¸­ï¼Œä¸€å¼€å§‹å¿…é¡»æŒ‡æ˜Žæ‰€åŸºäºŽçš„é•œåƒåç§°ï¼ŒæŽ¥ä¸‹æ¥æŽ¨èè¯´æ˜Žç»´æŠ¤è€…ä¿¡æ¯ã€‚åŽé¢åˆ™æ˜¯é•œåƒæ“ä½œæŒ‡ä»¤ï¼Œä¾‹å¦‚ &lt;code>RUN&lt;/code> æŒ‡ä»¤ï¼Œ&lt;code>RUN&lt;/code> æŒ‡ä»¤å°†å¯¹é•œåƒæ‰§è¡Œè·Ÿéšçš„å‘½ä»¤ã€‚æ¯è¿è¡Œä¸€æ¡ &lt;code>RUN&lt;/code> æŒ‡ä»¤ï¼Œé•œåƒæ·»åŠ æ–°çš„ä¸€å±‚ï¼Œå¹¶æäº¤ã€‚æœ€åŽæ˜¯ &lt;code>CMD&lt;/code> æŒ‡ä»¤ï¼Œæ¥æŒ‡å®šè¿è¡Œå®¹å™¨æ—¶çš„æ“ä½œå‘½ä»¤ã€‚&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>æŒ‡ä»¤å&lt;/th>
&lt;th>æ ¼å¼&lt;/th>
&lt;th>æè¿°&lt;/th>
&lt;th>å¤‡æ³¨&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>FROM&lt;/td>
&lt;td>æ ¼å¼ä¸º &lt;code>FROM &amp;lt;image&amp;gt;&lt;/code>æˆ–&lt;code>FROM &amp;lt;image&amp;gt;:&amp;lt;tag&amp;gt;&lt;/code>&lt;/td>
&lt;td>ç¬¬ä¸€æ¡æŒ‡ä»¤å¿…é¡»ä¸º &lt;code>FROM&lt;/code> æŒ‡ä»¤&lt;/td>
&lt;td>å¦‚æžœåœ¨åŒä¸€ä¸ª Dockerfile ä¸­åˆ›å»ºå¤šä¸ªé•œåƒæ—¶ï¼Œå¯ä»¥ä½¿ç”¨å¤šä¸ª &lt;code>FROM&lt;/code> æŒ‡ä»¤(æ¯ä¸ªé•œåƒä¸€æ¬¡)&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>MAINTAINER&lt;/td>
&lt;td>æ ¼å¼ä¸º &lt;code>MAINTAINER &amp;lt;name&amp;gt;&lt;/code>&lt;/td>
&lt;td>æŒ‡å®šç»´æŠ¤è€…ä¿¡æ¯ï¼Œ&lt;/td>
&lt;td>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>RUN&lt;/td>
&lt;td>&lt;code>RUN &amp;lt;command&amp;gt;&lt;/code>æˆ–&lt;code>RUN [&amp;quot;executable&amp;quot;, &amp;quot;param1&amp;quot;, &amp;quot;param2&amp;quot;]&lt;/code>&lt;/td>
&lt;td>å‰è€…å°†åœ¨ shell ç»ˆç«¯ä¸­è¿è¡Œå‘½ä»¤ï¼Œå³ &lt;code>/bin/sh -c&lt;/code>ï¼›åŽè€…åˆ™ä½¿ç”¨ &lt;code>exec&lt;/code> æ‰§è¡Œã€‚æŒ‡å®šä½¿ç”¨å…¶å®ƒç»ˆç«¯å¯ä»¥é€šè¿‡ç¬¬äºŒç§æ–¹å¼å®žçŽ°ï¼Œä¾‹å¦‚ &lt;code>RUN [&amp;quot;/bin/bash&amp;quot;, &amp;quot;-c&amp;quot;, &amp;quot;echo hello&amp;quot;]&lt;/code>&lt;/td>
&lt;td>æ¯æ¡ &lt;code>RUN&lt;/code> æŒ‡ä»¤å°†åœ¨å½“å‰é•œåƒåŸºç¡€ä¸Šæ‰§è¡ŒæŒ‡å®šå‘½ä»¤ï¼Œå¹¶æäº¤ä¸ºæ–°çš„é•œåƒã€‚å½“å‘½ä»¤è¾ƒé•¿æ—¶å¯ä»¥ä½¿ç”¨ &lt;code>\&lt;/code> æ¥æ¢è¡Œï¼Œ&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>CMD&lt;/td>
&lt;td>æ”¯æŒä¸‰ç§æ ¼å¼,&lt;code>CMD [&amp;quot;executable&amp;quot;,&amp;quot;param1&amp;quot;,&amp;quot;param2&amp;quot;]&lt;/code> ä½¿ç”¨ &lt;code>exec&lt;/code> æ‰§è¡Œï¼ŒæŽ¨èæ–¹å¼ï¼›&lt;code>CMD command param1 param2&lt;/code> åœ¨ &lt;code>/bin/sh&lt;/code> ä¸­æ‰§è¡Œï¼Œæä¾›ç»™éœ€è¦äº¤äº’çš„åº”ç”¨ï¼›&lt;code>CMD [&amp;quot;param1&amp;quot;,&amp;quot;param2&amp;quot;]&lt;/code> æä¾›ç»™ &lt;code>ENTRYPOINT&lt;/code> çš„é»˜è®¤å‚æ•°ï¼›&lt;/td>
&lt;td>æŒ‡å®šå¯åŠ¨å®¹å™¨æ—¶æ‰§è¡Œçš„å‘½ä»¤ï¼Œæ¯ä¸ª Dockerfile åªèƒ½æœ‰ä¸€æ¡ &lt;code>CMD&lt;/code> å‘½ä»¤ã€‚å¦‚æžœæŒ‡å®šäº†å¤šæ¡å‘½ä»¤ï¼Œåªæœ‰æœ€åŽä¸€æ¡ä¼šè¢«æ‰§è¡Œã€‚å¦‚æžœç”¨æˆ·å¯åŠ¨å®¹å™¨æ—¶å€™æŒ‡å®šäº†è¿è¡Œçš„å‘½ä»¤ï¼Œåˆ™ä¼šè¦†ç›–æŽ‰ &lt;code>CMD&lt;/code> æŒ‡å®šçš„å‘½ä»¤&lt;/td>
&lt;td>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>EXPOSE&lt;/td>
&lt;td>&lt;code>EXPOSE &amp;lt;port&amp;gt; [&amp;lt;port&amp;gt;...]&lt;/code>&lt;/td>
&lt;td>å‘Šè¯‰ Docker æœåŠ¡ç«¯å®¹å™¨æš´éœ²çš„ç«¯å£å·ï¼Œä¾›äº’è”ç³»ç»Ÿä½¿ç”¨&lt;/td>
&lt;td>åœ¨å¯åŠ¨å®¹å™¨æ—¶éœ€è¦é€šè¿‡ -p æ¥æŒ‡å®šç«¯å£æ˜ å°„ï¼ŒDocker ä¸»æœºä¼šè‡ªåŠ¨åˆ†é…ä¸€ä¸ªç«¯å£è½¬å‘åˆ°æŒ‡å®šçš„ç«¯å£&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>ENV&lt;/td>
&lt;td>&lt;code>ENV&amp;lt;key&amp;gt;&amp;lt;value&amp;gt;&lt;/code>ã€‚æŒ‡å®šä¸€ä¸ªçŽ¯å¢ƒå˜é‡ï¼Œä¼šè¢«åŽç»­ &lt;code>RUN&lt;/code> æŒ‡ä»¤ä½¿ç”¨ï¼Œå¹¶åœ¨å®¹å™¨è¿è¡Œæ—¶ä¿æŒ&lt;/td>
&lt;td>&lt;/td>
&lt;td>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>ADD&lt;/td>
&lt;td>&lt;code>ADD&amp;lt;src&amp;gt;&amp;lt;dest&amp;gt;&lt;/code>&lt;/td>
&lt;td>è¯¥å‘½ä»¤å°†å¤åˆ¶æŒ‡å®šçš„ &lt;code>&amp;lt;src&amp;gt;&lt;/code> åˆ°å®¹å™¨ä¸­çš„ &lt;code>&amp;lt;dest&amp;gt;&lt;/code>ï¼Œ&lt;/td>
&lt;td>&lt;code>&amp;lt;src&amp;gt;&lt;/code> å¯ä»¥æ˜¯ Dockerfile æ‰€åœ¨ç›®å½•çš„ä¸€ä¸ªç›¸å¯¹è·¯å¾„ï¼›ä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ª URLï¼›è¿˜å¯ä»¥æ˜¯ä¸€ä¸ª tar æ–‡ä»¶(è‡ªåŠ¨è§£åŽ‹ä¸ºç›®å½•)&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>COPY&lt;/td>
&lt;td>&lt;code>COPY &amp;lt;src&amp;gt;&amp;lt;dest&amp;gt;&lt;/code>&lt;/td>
&lt;td>å¤åˆ¶æœ¬åœ°ä¸»æœºçš„ &lt;code>&amp;lt;src&amp;gt;&lt;/code>(ä¸º Dockerfile æ‰€åœ¨ç›®å½•çš„ç›¸å¯¹è·¯å¾„)åˆ°å®¹å™¨ä¸­çš„ &lt;code>dest&lt;/code>&lt;/td>
&lt;td>å½“ä½¿ç”¨æœ¬åœ°ç›®å½•ä¸ºæºç›®å½•æ—¶ï¼ŒæŽ¨èä½¿ç”¨ &lt;code>COPY&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>ENTRYPOINT&lt;/td>
&lt;td>&lt;code>ENTRYPOINT [&amp;quot;executable&amp;quot;, &amp;quot;param1&amp;quot;, &amp;quot;param2&amp;quot;]&lt;/code>ï¼Œä½¿ç”¨æŒ‡å®šå¯æ‰§è¡Œæ–‡ä»¶æ‰§è¡Œï¼›&lt;code>ENTRYPOINT command param1 param2&lt;/code>ï¼Œä¼šåœ¨ Shell ä¸­æ‰§è¡Œ&lt;/td>
&lt;td>é…ç½®å®¹å™¨å¯åŠ¨åŽæ‰§è¡Œçš„å‘½ä»¤ï¼Œå¹¶ä¸”ä¸å¯è¢« &lt;code>docker run&lt;/code> æä¾›çš„å‚æ•°è¦†ç›–ã€‚æ¯ä¸ª Dockerfile ä¸­åªèƒ½æœ‰ä¸€ä¸ª &lt;code>ENTRYPOINT&lt;/code>ï¼Œå½“æŒ‡å®šå¤šä¸ªæ—¶ï¼Œåªæœ‰æœ€åŽä¸€ä¸ªèµ·æ•ˆï¼Œ&lt;/td>
&lt;td>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>VOLUME&lt;/td>
&lt;td>&lt;code>VOLUME [&amp;quot;/data&amp;quot;]&lt;/code>&lt;/td>
&lt;td>åˆ›å»ºä¸€ä¸ªå¯ä»¥ä»Žæœ¬åœ°ä¸»æœºæˆ–å…¶ä»–å®¹å™¨æŒ‚è½½çš„æŒ‚è½½ç‚¹ï¼Œä¸€èˆ¬ç”¨æ¥å­˜æ”¾æ•°æ®åº“å’Œéœ€è¦ä¿æŒçš„æ•°æ®ç­‰&lt;/td>
&lt;td>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>USER&lt;/td>
&lt;td>&lt;code>USER daemon&lt;/code>&lt;/td>
&lt;td>æŒ‡å®šè¿è¡Œå®¹å™¨æ—¶çš„ç”¨æˆ·åæˆ– UIDï¼ŒåŽç»­çš„ &lt;code>RUN&lt;/code> ä¹Ÿä¼šä½¿ç”¨æŒ‡å®šç”¨æˆ·&lt;/td>
&lt;td>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>WORKDIR&lt;/td>
&lt;td>&lt;code>WORKDIR /path/to/workdir&lt;/code>&lt;/td>
&lt;td>ä¸ºåŽç»­çš„ &lt;code>RUN&lt;/code>ã€&lt;code>CMD&lt;/code>ã€&lt;code>ENTRYPOINT&lt;/code> æŒ‡ä»¤é…ç½®å·¥ä½œç›®å½•&lt;/td>
&lt;td>å¯ä»¥ä½¿ç”¨å¤šä¸ª &lt;code>WORKDIR&lt;/code> æŒ‡ä»¤ï¼ŒåŽç»­å‘½ä»¤å¦‚æžœå‚æ•°æ˜¯ç›¸å¯¹è·¯å¾„ï¼Œåˆ™ä¼šåŸºäºŽä¹‹å‰å‘½ä»¤æŒ‡å®šçš„è·¯å¾„&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;p>å½“æœåŠ¡ä¸éœ€è¦ç®¡ç†å‘˜æƒé™æ—¶ï¼Œå¯ä»¥é€šè¿‡è¯¥å‘½ä»¤æŒ‡å®šè¿è¡Œç”¨æˆ·ã€‚å¹¶ä¸”å¯ä»¥åœ¨ä¹‹å‰åˆ›å»ºæ‰€éœ€è¦çš„ç”¨æˆ·ï¼Œä¾‹å¦‚ï¼š&lt;code>RUN groupadd -r postgres &amp;amp;&amp;amp; useradd -r -g postgres postgres&lt;/code>ï¼›è¦ä¸´æ—¶èŽ·å–ç®¡ç†å‘˜æƒé™å¯ä»¥ä½¿ç”¨ &lt;code>gosu&lt;/code>ï¼Œè€Œä¸æŽ¨è &lt;code>sudo&lt;/code>ã€‚&lt;/p>
&lt;p>RUNã€CMD å’Œ ENTRYPOINT è¿™ä¸‰ä¸ª Dockerfile æŒ‡ä»¤çœ‹ä¸ŠåŽ»å¾ˆç±»ä¼¼ï¼Œå¾ˆå®¹æ˜“æ··æ·†ã€‚RUN æ‰§è¡Œå‘½ä»¤å¹¶åˆ›å»ºæ–°çš„é•œåƒå±‚ï¼ŒRUN ç»å¸¸ç”¨äºŽå®‰è£…è½¯ä»¶åŒ…ã€‚CMD è®¾ç½®å®¹å™¨å¯åŠ¨åŽé»˜è®¤æ‰§è¡Œçš„å‘½ä»¤åŠå…¶å‚æ•°ï¼Œä½† CMD èƒ½å¤Ÿè¢« docker run åŽé¢è·Ÿçš„å‘½ä»¤è¡Œå‚æ•°æ›¿æ¢ã€‚ENTRYPOINT é…ç½®å®¹å™¨å¯åŠ¨æ—¶è¿è¡Œçš„å‘½ä»¤ã€‚æˆ‘ä»¬ç»å¸¸å¯ä»¥ä½¿ç”¨ ENTRYPOINT æŒ‡å®šå›ºå®šå‘½ä»¤ï¼Œä½¿ç”¨ CMD åŠ¨æ€ä¼ å…¥å‚æ•°ã€‚&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-Dockerfile" data-lang="Dockerfile">&lt;span class="line">&lt;span class="cl">&lt;span class="k">ENTRYPOINT&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="s2">&amp;#34;/bin/echo&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;Hello&amp;#34;&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="k">CMD&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="s2">&amp;#34;world&amp;#34;&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="c"># docker run -it &amp;lt;image&amp;gt;&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="c"># Hello world&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="c"># docker run -it &amp;lt;image&amp;gt; John&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="c"># Hello John&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Docker æŽ¨èçš„æ˜¯å•ä¸ªå®¹å™¨æ‰§è¡Œå•ä¸ªä»»åŠ¡çš„å…³æ³¨ç‚¹åˆ†ç¦»ç­–ç•¥ï¼Œå®¹å™¨çš„ä¸»è¿›ç¨‹ä¼šè´Ÿè´£ç®¡ç†æ‰€æœ‰çš„å­è¿›ç¨‹ã€‚å¦‚æžœæˆ‘ä»¬æœªåœ¨è‡ªå®šä¹‰åˆå§‹åŒ–è„šæœ¬ä¸­è€ƒè™‘å¤ªå¤šå­è¿›ç¨‹ç”Ÿå‘½å‘¨æœŸç®¡ç†çš„æ“ä½œï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨ &lt;code>--init&lt;/code> å‚æ•°æ¥å…è®¸ Docker è‡ªåŠ¨æ³¨å…¥ init è¿›ç¨‹ä½œä¸ºä¸»è¿›ç¨‹ï¼Œå…¶ä¼šåœ¨å®¹å™¨å…³é—­æ—¶å€™è‡ªåŠ¨å¤„ç†æ‰€æœ‰çš„æ´¾ç”Ÿçš„å­è¿›ç¨‹ï¼Œå¹¶ä¸”ç›¸å¯¹äºŽå®Œæ•´çš„ sysvinit æˆ–è€… systemd æ›´ä¸ºè½»é‡çº§ã€‚å¦‚æžœæˆ‘ä»¬å¸Œæœ›åœ¨å•ä¸ªå®¹å™¨ä¸­è¿è¡Œå¤šä¸ªè¿›ç¨‹ï¼Œåˆ™å¯ä»¥ä½¿ç”¨ supervisord æˆ–è€…&lt;a href="https://docs.docker.com/config/containers/multi-service_container/" target="_blank" rel="noopener">è‡ªå®šä¹‰è„šæœ¬&lt;/a>:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-Dockerfile" data-lang="Dockerfile">&lt;span class="line">&lt;span class="cl">&lt;span class="k">FROM&lt;/span>&lt;span class="s"> ubuntu:latest&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="k">RUN&lt;/span> apt-get update &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> apt-get install -y supervisor&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="k">RUN&lt;/span> mkdir -p /var/log/supervisor&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="k">COPY&lt;/span> supervisord.conf /etc/supervisor/conf.d/supervisord.conf&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="k">COPY&lt;/span> my_first_process my_first_process&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="k">COPY&lt;/span> my_second_process my_second_process&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="k">CMD&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="s2">&amp;#34;/usr/bin/supervisord&amp;#34;&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="registry">Registry&lt;/h2>
&lt;p>Docker å…è®¸æˆ‘ä»¬å»ºç«‹ç§æœ‰çš„ Registry æ¥å­˜æ”¾äºŽç®¡ç†é•œåƒï¼Œç›´æŽ¥è¿è¡Œå¦‚ä¸‹å‘½ä»¤å³å¯åˆ›å»ºç§æœ‰ Registryï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">$ docker run -d -p 5000:5000 --restart&lt;span class="o">=&lt;/span>always --name registry registry:2
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>å‚è€ƒä¸Šæ–‡æè¿°æˆ‘ä»¬å¯çŸ¥ï¼Œé•œåƒåçš„å‰ç¼€å³è¡¨ç¤ºè¯¥é•œåƒæ‰€å±žçš„ Registry åœ°å€ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥é€šè¿‡ tag æ–¹å¼å°†æŸä¸ªé•œåƒæŽ¨é€åˆ°ç§æœ‰ä»“åº“ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># æ‹‰å–å…¬å…±é•œåƒ&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ docker pull ubuntu:16.04
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># ä¸ºé•œåƒæ·»åŠ  Registry ä¿¡æ¯&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ docker tag ubuntu:16.04 custom-domain:5000/my-ubuntu
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># å°†å…¶æŽ¨é€åˆ°ç§æœ‰é•œåƒåº“&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ docker push custom-domain:5000/my-ubuntu
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># ä»Žç§æœ‰é•œåƒåº“ä¸­æ‹‰å–é•œåƒ&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ docker pull custom-domain:5000/my-ubuntu
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>æˆ‘ä»¬ä¹Ÿå¯ä»¥æŒ‡å®šé•œåƒåº“çš„å­˜æ”¾åœ°å€ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">-v /mnt/registry:/var/lib/registry
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>å¾ˆå¤šæƒ…å†µä¸‹æˆ‘ä»¬çš„å†…éƒ¨ä»“åº“å¹¶ä¸ä¼šé…ç½® HTTPSï¼Œå¦‚æžœå¸Œæœ›ä»¥ HTTP æ–¹å¼è®¿é—®ï¼Œé‚£ä¹ˆéœ€è¦åœ¨ä»»ä½•éœ€è¦æŽ¨é€/æ‹‰å–é•œåƒçš„æœºå™¨ä¸Šé…ç½®éžå®‰å…¨åŸŸåï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-json" data-lang="json">&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span> &lt;span class="nt">&amp;#34;insecure-registries&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="s2">&amp;#34;myregistry.example.com:5000&amp;#34;&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>æœ‰æ—¶å€™æˆ‘ä»¬ä¹Ÿéœ€è¦ä¸ºç§æœ‰ä»“åº“é…ç½®æƒé™è®¤è¯ï¼Œé‚£ä¹ˆé¦–å…ˆéœ€è¦æ·»åŠ  TLS æ”¯æŒï¼Œå¹¶ä¸”é…ç½®è®¤è¯æ–‡ä»¶ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">$ mkdir auth
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ docker run &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> --entrypoint htpasswd &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> registry:2 -Bbn cscan cscancscan &amp;gt; ~/auth/htpasswd
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ openssl req -new -newkey rsa:4096 -days &lt;span class="m">365&lt;/span> &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> -subj &lt;span class="s2">&amp;#34;/CN=localhost&amp;#34;&lt;/span> &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> -nodes -x509 &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> -keyout ~/certs/domain.key &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> -out ~/certs/domain.crt
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ç„¶åŽå¯ä»¥ä½¿ç”¨ Compose æ–‡ä»¶æ¥æè¿°æ‰€éœ€è¦çš„ TLS ä»¥åŠ AUTH å‚æ•°ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-yml" data-lang="yml">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">registry-srv&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">restart&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">always&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">image&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">registry:2&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">ports&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="m">5000&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="m">5000&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">environment&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">REGISTRY_HTTP_TLS_CERTIFICATE&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">/certs/domain.crt&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">REGISTRY_HTTP_TLS_KEY&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">/certs/domain.key&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">REGISTRY_AUTH&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">htpasswd&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">REGISTRY_AUTH_HTPASSWD_PATH&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">/auth/htpasswd&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">REGISTRY_AUTH_HTPASSWD_REALM&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">Registry Realm&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">volumes&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="l">/opt/registry:/var/lib/registry&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="l">~/certs:/certs&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="l">~/auth:/auth&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>æŽ¥ä¸‹æ¥ä½¿ç”¨ Docker Compose å‘½ä»¤å¯åŠ¨æœåŠ¡ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">$ docker-compose up -d
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># ç™»å½•åˆ°é•œåƒæœåŠ¡å™¨&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ docker login myregistrydomain.com:5000
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="å¤šé˜¶æ®µæž„å»º">å¤šé˜¶æ®µæž„å»º&lt;/h2>
&lt;p>éšç€ 17.05 ç‰ˆæœ¬çš„å‘å¸ƒï¼ŒDocker å¯¹äºŽé•œåƒæž„å»ºè¿™å—ä¹Ÿä½œäº†ä¸€é¡¹é‡è¦æ›´æ–°ï¼Œé‚£å°±æ˜¯ multi-stage buildï¼ˆå¤šé˜¶æ®µæž„å»ºï¼‰ï¼Œè¿™æœ‰åŠ©äºŽæ–¹ä¾¿æºä»£ç æŽ§åˆ¶ï¼Œå‡å°é•œåƒä½“ç§¯ã€‚&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-Dockerfile" data-lang="Dockerfile">&lt;span class="line">&lt;span class="cl">&lt;span class="c"># First stage: complete build environment&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="k">FROM&lt;/span>&lt;span class="s"> maven:3.5.0-jdk-8-alpine AS builder&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="c"># add pom.xml and source code&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="k">ADD&lt;/span> ./pom.xml pom.xml&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="k">ADD&lt;/span> ./src src/&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="c"># package jar&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="k">RUN&lt;/span> mvn clean package&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="c"># Second stage: minimal runtime environment&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="k">From&lt;/span>&lt;span class="s"> openjdk:8-jre-alpine&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="c"># copy jar from the first stage&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="k">COPY&lt;/span> --from&lt;span class="o">=&lt;/span>builder target/msb-1.0.jar msb.jar&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="c"># run jar&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="k">CMD&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="s2">&amp;#34;java&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;-jar&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;msb.jar&amp;#34;&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>å¯¹äºŽ multi-stage buildï¼Œå…¶å…³é”®ç‚¹ä¸»è¦æœ‰ä¸¤ç‚¹ï¼š&lt;/p>
&lt;p>åœ¨å‰é¢é˜¶æ®µçš„ FROM æŒ‡ä»¤åŽé¢å¢žåŠ äº†ä¸€ä¸ª AS å‚æ•°ï¼Œå¯ä¸ºè¯¥æž„å»ºé˜¶æ®µå‘½åï¼Œä¾¿äºŽåŽç»­æž„å»ºé˜¶æ®µå¼•ç”¨ï¼Œæ ¼å¼å¦‚ä¸‹ï¼š&lt;/p>
&lt;pre tabindex="0">&lt;code>FROM image[:tag | @digest] AS stage
&lt;/code>&lt;/pre>&lt;p>åœ¨åŽç»­é˜¶æ®µçš„ COPY æŒ‡ä»¤åŽé¢å¢žåŠ äº†&amp;ndash;from å‚æ•°ï¼ŒæŒ‡æ˜Žå¼•ç”¨å‰é¢å“ªä¸€ä¸ªæž„å»ºé˜¶æ®µçš„æˆæžœï¼Œæ ¼å¼å¦‚ä¸‹ï¼š&lt;/p>
&lt;pre tabindex="0">&lt;code>COPY --from=stage ...
&lt;/code>&lt;/pre>&lt;p>åŒç†ï¼Œå¤šé˜¶æ®µæž„å»ºåŒæ ·å¯ä»¥å¾ˆæ–¹ä¾¿åœ°å°†å¤šä¸ªå½¼æ­¤ä¾èµ–çš„é¡¹ç›®é€šè¿‡ä¸€ä¸ª Dockerfile å°±å¯è½»æ¾æž„å»ºå‡ºæœŸæœ›çš„å®¹å™¨é•œåƒï¼Œè€Œä¸ç”¨æ‹…å¿ƒé•œåƒå¤ªå¤§ã€æºç æ³„éœ²ç­‰é£Žé™©ã€‚&lt;/p>
&lt;h1 id="å®¹å™¨">å®¹å™¨&lt;/h1>
&lt;p>Docker ä¸­é•œåƒæ˜¯åªè¯»çš„, åˆ›å»ºå®¹å™¨æ—¶åªæ˜¯åœ¨é•œåƒä¸Šé¢æ–°å»ºä¸€ä¸ªå¯å†™å±‚, ä¸éœ€è¦å¤åˆ¶æ•´ä¸ªæ–‡ä»¶ç³»ç»Ÿ, å› è€Œå¯ä»¥å®žçŽ°æ¯«ç§’çº§åˆ›å»ºã€‚&lt;/p>
&lt;p>
&lt;figure >
&lt;div class="d-flex justify-content-center">
&lt;div class="w-100" >&lt;img src="https://user-images.githubusercontent.com/5803001/45262735-4f42e400-b44f-11e8-96a0-79c305006be8.png" alt="image" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>&lt;/p>
&lt;h2 id="å¯åœæŽ§åˆ¶">å¯åœæŽ§åˆ¶&lt;/h2>
&lt;ul>
&lt;li>&lt;code>docker create&lt;/code>: åˆ›å»ºä¸€ä¸ªå®¹å™¨ä½†æ˜¯ä¸å¯åŠ¨ã€‚&lt;/li>
&lt;li>&lt;code>docker rename&lt;/code>: å…è®¸é‡å‘½åå®¹å™¨ã€‚&lt;/li>
&lt;li>&lt;code>docker run&lt;/code>: åœ¨åŒä¸€ä¸ªæ“ä½œä¸­åˆ›å»ºå¹¶å¯åŠ¨ä¸€ä¸ªå®¹å™¨ã€‚&lt;/li>
&lt;li>&lt;code>docker rm&lt;/code>: åˆ é™¤å®¹å™¨ã€‚&lt;/li>
&lt;li>&lt;code>docker update&lt;/code>: æ›´æ–°å®¹å™¨çš„èµ„æºé™åˆ¶ã€‚&lt;/li>
&lt;/ul>
&lt;p>å®¹å™¨ä¼šåœ¨ç»“æŸå‘½ä»¤ä¹‹åŽè‡ªåŠ¨é€€å‡ºï¼Œä½¿ç”¨ä»¥ä¸‹çš„å‘½ä»¤é€‰é¡¹å¯ä»¥å°†å®¹å™¨ä¿æŒåœ¨æ¿€æ´»çŠ¶æ€ï¼š&lt;/p>
&lt;ul>
&lt;li>
&lt;p>&lt;code>-i&lt;/code> å³ä½¿åœ¨æ²¡æœ‰é™„ç€çš„æƒ…å†µä¸‹ä¾ç„¶ä¿æŒ STDIN å¤„äºŽå¼€å¯ã€‚å•çº¯ä½¿ç”¨ -i å‘½ä»¤æ˜¯ä¸ä¼šå‡ºçŽ° &lt;code>root@689d580b6416:/&lt;/code> è¿™ç§å‰ç¼€&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;code>-t&lt;/code> åˆ†é…ä¸€ä¸ªä¼ª TTY æŽ§åˆ¶å°&lt;/p>
&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># åˆ›å»ºï¼Œå¹¶ä¸”å¯åŠ¨æŸä¸ªå®¹å™¨ä»¥æ‰§è¡ŒæŸä¸ªå‘½ä»¤&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ docker run -ti --name container_name image_name &lt;span class="nb">command&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># åˆ›å»ºï¼Œå¯åŠ¨å®¹å™¨æ‰§è¡ŒæŸä¸ªå‘½ä»¤ç„¶åŽåˆ é™¤è¯¥å®¹å™¨&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ docker run --rm -ti image_name &lt;span class="nb">command&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># åˆ›å»ºï¼Œå¯åŠ¨å®¹å™¨ï¼Œå¹¶ä¸”æ˜ å°„å·ä¸Žç«¯å£ï¼ŒåŒæ—¶è®¾ç½®çŽ¯å¢ƒå˜é‡&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ docker run -it --rm -p 8080:8080 -v /path/to/agent.jar:/agent.jar -e &lt;span class="nv">JAVA_OPTS&lt;/span>&lt;span class="o">=&lt;/span>â€-javaagent:/agent.jarâ€ tomcat:8.0.29-jre8
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># åˆ›å»ºå®¹å™¨ï¼ŒæŒ‡å®šç½‘ç»œ&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ docker run --network&lt;span class="o">=&lt;/span>&amp;lt;NETWORK&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># ç›´æŽ¥ä½¿ç”¨å®¿ä¸»æœºçš„ç½‘ç»œ&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ docker run --rm -d --network host --name my_nginx nginx
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># æŒ‡å®šæ ‡ç­¾&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ docker run -l my-label --label com.example.foo&lt;span class="o">=&lt;/span>bar ubuntu bash
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>é»˜è®¤æƒ…å†µä¸‹ï¼Œåˆ›å»ºå®¹å™¨æ—¶ï¼Œå®ƒä¸ä¼šå°†å…¶ä»»ä½•ç«¯å£å‘å¸ƒåˆ°å¤–éƒ¨ä¸–ç•Œã€‚è¦ä½¿ç«¯å£å¯ç”¨äºŽ Docker ä¹‹å¤–çš„æœåŠ¡æˆ–æœªè¿žæŽ¥åˆ°å®¹å™¨ç½‘ç»œçš„ Docker å®¹å™¨ï¼Œè¯·ä½¿ç”¨ &amp;ndash;publish æˆ–-p æ ‡å¿—ã€‚è¿™ä¼šåˆ›å»ºä¸€ä¸ªé˜²ç«å¢™è§„åˆ™ï¼Œå°†å®¹å™¨ç«¯å£æ˜ å°„åˆ° Docker ä¸»æœºä¸Šçš„ç«¯å£ã€‚&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>æ ‡å¿—å€¼&lt;/th>
&lt;th>æè¿°&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>&lt;code>-p 8080:80&lt;/code>&lt;/td>
&lt;td>å°†å®¹å™¨çš„ 80 ç«¯å£æ˜ å°„åˆ° Docker ä¸»æœºçš„ 8080 ç«¯å£(TCP)&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>-p 8080:80/udp&lt;/code>&lt;/td>
&lt;td>å°†å®¹å™¨çš„ 80 ç«¯å£æ˜ å°„åˆ° Docker ä¸»æœºçš„ 8080 ç«¯å£(UDP)&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>-p 8080:80/tcp -p 8080:80/udp&lt;/code>&lt;/td>
&lt;td>å°†å®¹å™¨çš„ 80 ç«¯å£æ˜ å°„åˆ° Docker ä¸»æœºçš„ 8080 ç«¯å£(TCP å’Œ UDP)&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># å¯åŠ¨/åœæ­¢æŸä¸ªå®¹å™¨&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ docker &lt;span class="o">[&lt;/span>start&lt;span class="p">|&lt;/span>stop&lt;span class="o">]&lt;/span> container_name
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># åœ¨æŸä¸ªå®¹å™¨å†…æ‰§è¡ŒæŸæ¡å‘½ä»¤&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ docker &lt;span class="nb">exec&lt;/span> -ti container_name command.sh
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># æŸ¥çœ‹æŸä¸ªå®¹å™¨çš„è¾“å‡ºæ—¥å¿—&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ docker logs -ft container_name
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="çŠ¶æ€æŸ¥è¯¢">çŠ¶æ€æŸ¥è¯¢&lt;/h2>
&lt;ul>
&lt;li>docker ps æŸ¥çœ‹è¿è¡Œä¸­çš„æ‰€æœ‰å®¹å™¨ã€‚&lt;/li>
&lt;li>docker logs ä»Žå®¹å™¨ä¸­èŽ·å–æ—¥å¿—ã€‚(ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨è‡ªå®šä¹‰æ—¥å¿—é©±åŠ¨ï¼Œä¸è¿‡åœ¨ 1.10 ä¸­ï¼Œå®ƒåªæ”¯æŒ json-file å’Œ journald)&lt;/li>
&lt;li>docker inspect æŸ¥çœ‹æŸä¸ªå®¹å™¨çš„æ‰€æœ‰ä¿¡æ¯(åŒ…æ‹¬ IP åœ°å€)ã€‚&lt;/li>
&lt;li>docker events ä»Žå®¹å™¨ä¸­èŽ·å–äº‹ä»¶(events)ã€‚&lt;/li>
&lt;li>docker port æŸ¥çœ‹å®¹å™¨çš„å…¬å¼€ç«¯å£ã€‚&lt;/li>
&lt;li>docker top æŸ¥çœ‹å®¹å™¨ä¸­æ´»åŠ¨è¿›ç¨‹ã€‚&lt;/li>
&lt;li>docker stats æŸ¥çœ‹å®¹å™¨çš„èµ„æºä½¿ç”¨æƒ…å†µç»Ÿè®¡ä¿¡æ¯ã€‚&lt;/li>
&lt;li>docker diff æŸ¥çœ‹å®¹å™¨çš„ FS ä¸­æœ‰å˜åŒ–æ–‡ä»¶ä¿¡æ¯ã€‚&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># æ ¹æ®æ¡ä»¶è¿‡æ»¤æŸ¥è¯¢&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ docker ps --filter &lt;span class="s2">&amp;#34;name=nostalgic&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># æ˜¾ç¤ºæ­£åœ¨è¿è¡Œçš„å®¹å™¨åˆ—è¡¨&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ docker stats --all
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># æ‰¹é‡æŸ¥çœ‹æ—¥å¿—&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">for&lt;/span> i in &lt;span class="k">$(&lt;/span>docker ps -qf &lt;span class="nv">name&lt;/span>&lt;span class="o">=&lt;/span>wsat_slave*&lt;span class="k">)&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="k">do&lt;/span> &lt;span class="nb">echo&lt;/span> &lt;span class="s2">&amp;#34;==================&lt;/span>&lt;span class="nv">$i&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> docker logs &lt;span class="nv">$i&lt;/span> &lt;span class="p">|&lt;/span> grep aisec&lt;span class="p">;&lt;/span> &lt;span class="k">done&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="ç®¡ç†é…ç½®">ç®¡ç†é…ç½®&lt;/h2>
&lt;p>åˆ›å»ºå®¹å™¨æ—¶ä¹Ÿå¯ä»¥å®¹å™¨çš„é‡å¯ç­–ç•¥ï¼Œå³æ˜¯å½“å®¹å™¨å‡ºé”™é€€å‡ºæˆ–è€…å®¿ä¸»æœºé‡å¯æ—¶å€™ï¼Œå®¹å™¨çš„åº”å¯¹ç­–ç•¥ï¼›é‡å¯ç­–ç•¥åŒæ ·ä¼šä¿è¯ç›¸å…³è”çš„å®¹å™¨ä»¥æ­£ç¡®çš„é¡ºåºé‡å¯ï¼Œé¿å…æ„å¤–çš„é”™è¯¯ã€‚&lt;/p>
&lt;ul>
&lt;li>no: ä¸è¿›è¡Œé‡å¯&lt;/li>
&lt;li>on-failure: å½“å®¹å™¨ä»¥éžé›¶çŠ¶æ€ç é€€å‡ºæ—¶é‡å¯å®¹å™¨&lt;/li>
&lt;li>unless-stopped: å½“æŸä¸ªå®¹å™¨è¢«æ˜¾æ€§å…³é—­æˆ–è€… Docker æœ¬èº«å…³é—­æˆ–é‡å¯æ—¶é‡å¯&lt;/li>
&lt;li>always: æ— è®ºå‡ºçŽ°ä»»ä½•æƒ…å†µéƒ½é‡å¯å®¹å™¨&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># è®¾ç½®é‡å¯ç­–ç•¥&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#â€ŠOff, On-failure, Unless-stopped, Always&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ docker run -dit â€” restart unless-stopped &lt;span class="o">[&lt;/span>CONTAINER&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>å¯ä»¥é€šè¿‡å¤šç§è¿‡æ»¤æ¡ä»¶æ¥è¿›è¡Œå®¹å™¨çš„ç§»é™¤ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># å…³é—­æ‰€æœ‰æ­£åœ¨è¿è¡Œçš„å®¹å™¨&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ docker &lt;span class="nb">kill&lt;/span> &lt;span class="k">$(&lt;/span>docker ps -q&lt;span class="k">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># æ‰¹é‡é‡å¯å®¹å™¨&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ docker restart &lt;span class="k">$(&lt;/span>docker ps -a -q&lt;span class="k">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># æ ¹æ® IDæˆ–Name ç§»é™¤&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ docker rm idOrName
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># ç§»é™¤æ‰€æœ‰åœæ­¢çš„å®¹å™¨&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ docker rm &lt;span class="k">$(&lt;/span>docker ps -a -q&lt;span class="k">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># æ ¹æ®çŠ¶æ€ç§»é™¤&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ docker rm &lt;span class="k">$(&lt;/span>docker ps -q -f &lt;span class="s1">&amp;#39;status=exited&amp;#39;&lt;/span>&lt;span class="k">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># æ ¹æ®æ ‡ç­¾ç§»é™¤&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ docker rm &lt;span class="k">$(&lt;/span>docker ps -a &lt;span class="p">|&lt;/span> grep rabbitmq &lt;span class="p">|&lt;/span> awk &lt;span class="s1">&amp;#39;{print $1}&amp;#39;&lt;/span>&lt;span class="k">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ docker rm &lt;span class="k">$(&lt;/span>docker ps -a &lt;span class="p">|&lt;/span> grep &lt;span class="s2">&amp;#34;46 hours ago&amp;#34;&lt;/span>&lt;span class="k">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>æˆ‘ä»¬ä¹Ÿå¯ä»¥å¯¹å®¹å™¨ä¸­çš„æ–‡ä»¶è¿›è¡Œå¯¼å…¥å¯¼å‡ºæ“ä½œ:&lt;/p>
&lt;ul>
&lt;li>docker cp åœ¨å®¹å™¨å’Œæœ¬åœ°æ–‡ä»¶ç³»ç»Ÿä¹‹é—´å¤åˆ¶æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹ã€‚&lt;/li>
&lt;li>docker export å°†å®¹å™¨çš„æ–‡ä»¶ç³»ç»Ÿåˆ‡æ¢ä¸ºåŽ‹ç¼©åŒ…(tarball archive stream)è¾“å‡ºåˆ° STDOUTã€‚&lt;/li>
&lt;/ul>
&lt;h2 id="èµ„æºé…é¢">èµ„æºé…é¢&lt;/h2>
&lt;p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ &lt;code>docker stats&lt;/code> å‘½ä»¤æ¥æŸ¥çœ‹ Docker å®¹å™¨çš„æ€§èƒ½çŠ¶æ€ä¸Žèµ„æºå ç”¨:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">$ docker stats redis1 redis2
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">CONTAINER CPU % MEM USAGE / LIMIT MEM % NET IO BLOCK IO
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">redis1 0.07% &lt;span class="m">796&lt;/span> KB / &lt;span class="m">64&lt;/span> MB 1.21% &lt;span class="m">788&lt;/span> B / &lt;span class="m">648&lt;/span> B 3.568 MB / &lt;span class="m">512&lt;/span> KB
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="memory">Memory&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">$ docker run -it -m 300M ubuntu:14.04 /bin/bash
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="cpu">CPU&lt;/h3>
&lt;p>åœ¨çº¿ä¸ŠçŽ¯å¢ƒä¸­ï¼Œæˆ‘ä»¬å³å¸Œæœ›èƒ½å¤Ÿå°½é‡é¿å… CPU ç©ºé—´æ—¶é—´ç‰‡ï¼Œæœ€å¤§åŒ–èµ„æºåˆ©ç”¨çŽ‡ï¼Œä¹Ÿè¦ä¿éšœé‡ç‚¹ä¸šåŠ¡çš„èµ„æºå ç”¨ï¼Œé¿å…å› æŸä¸ªå¼‚å¸¸å®¹å™¨å ç”¨æˆ–ä¸åˆç†ä½¿ç”¨æ•´æœº CPU èµ„æºï¼Œé€ æˆå®¿ä¸»æœºä¸Šå¤§é‡å®¹å™¨å¼‚å¸¸ï¼›æ­¤æ—¶å•å®¹å™¨çš„ CPU èµ„æºçº¦æŸåŠä¸Šé™å°†å˜å¾—éžå¸¸é‡è¦ï¼Œæ—¢ä¸èƒ½é™å¾—å¤ªæ­»ï¼Œåˆä¸èƒ½é™ä¸ä½ï¼Œå°†é€šè¿‡å†…æ ¸å’Œè°ƒåº¦ç³»ç»Ÿçš„é™åˆ¶æœºåˆ¶æ¥ä¿éšœèµ„æºç¨³å®šæ€§ã€‚Docker å…è®¸ä½¿ç”¨ cpus, cpuset-cpus, cpu-shares ç­‰æ¥é™åˆ¶å®¹å™¨çš„è®¡ç®—èµ„æºå ç”¨ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># æŒ‡å®šå®¹å™¨å¯å ç”¨çš„ CPU æ ¸ç¼–å·ï¼Œ0-3 è¡¨ç¤ºå ç”¨å››ä¸ªæ ¸ï¼Œ1,3 è¡¨ç¤ºå ç”¨ä¸¤ä¸ªæ ¸&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ docker run -it --cpuset-cpus&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;1,3&amp;#34;&lt;/span> ubuntu /bin/bash
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># æœ€å¤šå…è®¸å ç”¨å• CPU 50% çš„è®¡ç®—èµ„æºï¼Œå¦‚æžœåŒæ ¸ CPUï¼Œåˆ™å¯ä»¥è®¾ç½®ä¸º 1.5 ç­‰&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ docker run -it --cpus&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;.5&amp;#34;&lt;/span> ubuntu /bin/bash
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># ä¸åŒçš„å€¼èƒ½å¤ŸæŒ‡å®šä¸åŒçš„å®¹å™¨æƒé‡ï¼Œç”¨äºŽåŠ¨æ€åˆ†é… CPU èµ„æº&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ docker run -it --cpu-shares&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;512&amp;#34;&lt;/span> ubuntu /bin/bash
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ul>
&lt;li>
&lt;p>CPU Set ä¿éšœäº†å®¹å™¨çš„ CPU æ ¸æ•°ï¼Œå®‰å…¨æ€§è¾ƒå¼ºï¼Œä½†æ˜¯æ•´ä½“èµ„æºåˆ©ç”¨çŽ‡ä½Žã€‚å¦‚æžœå®¹å™¨å®žé™…å¹¶ä¸éœ€è¦å¦‚æ­¤å¤šæ ¸çš„ CPU èµ„æºæ¥å¤„ç†ä»»åŠ¡åˆ™ä¼šé€ æˆèµ„æºæµªè´¹ï¼Œå¹¶ä¸”å¯¼è‡´å…¶ä»–å®¹å™¨ä¸Šçš„ä»»åŠ¡æ— æ³•åˆ©ç”¨è¯¥å®¹å™¨ä¸Šçš„ CPU ç©ºé—²æ—¶é—´ç‰‡ï¼Œäººä¸ºé˜»æ–­äº† CPU é—²æ—¶å¤ç”¨çš„èƒ½åŠ›ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>CPU Share å…è®¸é€šè¿‡å…±äº«çš„æ–¹å¼èŽ·å¾— CPU èµ„æºï¼Œä¸åŒçš„å®¹å™¨å…±äº«ä¸€å®šæ€»é‡çš„ CPU è®¡ç®—èƒ½åŠ›ï¼Œæ¯ä¸ªå®¹å™¨éƒ½ç»‘å®šå…¨é‡æ ¸ï¼Œè€Œæ¯ä¸ªå®¹å™¨èŽ·å–ä¸€å®šä»½é¢çš„ CPU è®¡ç®—åŠ›ã€‚è¯¥æ¨¡å¼ä¸‹ï¼Œæ¯ä¸ªå®¹å™¨çš„ CPU èµ„æºåˆ†é…ä¸å†ä»¥æ•´æ ¸åˆ†é…ï¼Œè€Œæ˜¯å¯ç²¾ç»†åˆ° CPU æ—¶é—´ç‰‡ä»½é¢çš„ç²’åº¦ï¼Œå¹¶ä¸”æ˜¯è¿žç»­çš„ CPU æ ¸èƒ½åŠ›å€¼ã€‚å½“æ•´æœºé—²æ—¶ï¼Œå¯ä»¥è®©è¾ƒä¸ºç¹å¿™çš„ä¸šåŠ¡èŽ·å¾—æ•´æœºç©ºé—²ã€‚é‡‡ç”¨ CPU èµ„æºå…±äº«çš„æœºåˆ¶ï¼Œå…¶èµ„æºéš”ç¦»æ€§æ²¡æœ‰ set æ¨¡å¼å¼ºï¼Œå¯¹äºŽæžä¸ªåˆ« CPU èµ„æºæ•æ„Ÿåž‹ä¸šåŠ¡ï¼Œæœ‰å¯èƒ½å‡ºçŽ°å¶å°”ç­‰å¾… CPU æ—¶é—´ç‰‡çš„æƒ…å†µï¼Œè€Œå½±å“ä¸šåŠ¡ç¨³å®šæ€§ã€‚å¯¹äºŽæžå°‘æ•°çš„è¿™ç±»ä¸šåŠ¡ï¼Œæˆ‘ä»¬å®¹è®¸ç»§ç»­ä½¿ç”¨ CPU set æ¨¡å¼ã€‚&lt;/p>
&lt;/li>
&lt;/ul>
&lt;h3 id="storage">Storage&lt;/h3>
&lt;p>å¦‚æžœä½¿ç”¨ Device Mapper ä½œä¸ºåº•å±‚å­˜å‚¨é©±åŠ¨ï¼Œåˆ™å¯ä»¥é€šè¿‡ Docker daemon çš„å¦‚ä¸‹å‚æ•°æ¥å…¨å±€é™åˆ¶å•ä¸ªå®¹å™¨å ç”¨ç©ºé—´çš„å¤§å°:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># é™åˆ¶å•ä¸ªå®¹å™¨æœ€å¤šå ç”¨ 20G ç©ºé—´ï¼Œå°†åº”ç”¨äºŽä»»ä½•æ–°å»ºå®¹å™¨ã€‚&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ --storage-opt dm.basesize&lt;span class="o">=&lt;/span>20G
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>å¦‚æžœæ˜¯ btrfs å­˜å‚¨é©±åŠ¨ï¼Œå¯ä½¿ç”¨å…¶æä¾›çš„ subvolume åŠŸèƒ½æ¥å®žçŽ°ã€‚ä¸€ä¸ªå®¹å™¨ä¼šå¯¹åº”ä¸€ä¸ª subvolumeã€‚é’ˆå¯¹å®¹å™¨å¯¹åº”çš„ subvolume å¯ç”¨å¹¶é…ç½® quota å³å¯é™åˆ¶å…¶ç£ç›˜ç©ºé—´:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">$ btrfs qgroup limit -e 50G /var/lib/docker/btrfs/subvolumes/&amp;lt;CONTAINER_ID&amp;gt;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>æŽˆäºˆå¯¹å•ä¸ªè®¾å¤‡è®¿é—®æƒé™:&lt;/p>
&lt;pre tabindex="0">&lt;code>docker run -it --device=/dev/ttyUSB0 debian bash
&lt;/code>&lt;/pre>&lt;p>æŽˆäºˆæ‰€æœ‰è®¾å¤‡è®¿é—®æƒé™:&lt;/p>
&lt;pre tabindex="0">&lt;code>docker run -it --privileged -v /dev/bus/usb:/dev/bus/usb debian bash
&lt;/code>&lt;/pre>&lt;h1 id="èµ„æºé…ç½®">èµ„æºé…ç½®&lt;/h1>
&lt;h2 id="volume--æ•°æ®å·">Volume | æ•°æ®å·&lt;/h2>
&lt;p>å®¹å™¨è¿è¡Œæ—¶åº”è¯¥å°½é‡ä¿æŒå®¹å™¨å­˜å‚¨å±‚ä¸å‘ç”Ÿå†™æ“ä½œï¼Œå¯¹äºŽæ•°æ®åº“ç±»éœ€è¦ä¿å­˜åŠ¨æ€æ•°æ®çš„åº”ç”¨ï¼Œå…¶æ•°æ®åº“æ–‡ä»¶åº”è¯¥ä¿å­˜äºŽå·(Volume)ä¸­ã€‚ä¸ºäº†é˜²æ­¢è¿è¡Œæ—¶ç”¨æˆ·å¿˜è®°å°†åŠ¨æ€æ–‡ä»¶æ‰€ä¿å­˜ç›®å½•æŒ‚è½½ä¸ºå·ï¼Œåœ¨ Dockerfile ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥äº‹å…ˆæŒ‡å®šæŸäº›ç›®å½•æŒ‚è½½ä¸ºåŒ¿åå·ï¼Œè¿™æ ·åœ¨è¿è¡Œæ—¶å¦‚æžœç”¨æˆ·ä¸æŒ‡å®šæŒ‚è½½ï¼Œå…¶åº”ç”¨ä¹Ÿå¯ä»¥æ­£å¸¸è¿è¡Œï¼Œä¸ä¼šå‘å®¹å™¨å­˜å‚¨å±‚å†™å…¥å¤§é‡æ•°æ®ã€‚&lt;/p>
&lt;p>æ•°æ®å·æ˜¯ä¸€ä¸ªå¯ä¾›ä¸€ä¸ªæˆ–å¤šä¸ªå®¹å™¨ä½¿ç”¨çš„ç‰¹æ®Šç›®å½•ï¼Œå®ƒç»•è¿‡ UFSï¼Œå¯ä»¥æä¾›å¾ˆå¤šæœ‰ç”¨çš„ç‰¹æ€§ï¼š&lt;/p>
&lt;ul>
&lt;li>
&lt;p>æ•°æ®å·å¯ä»¥åœ¨å®¹å™¨ä¹‹é—´å…±äº«å’Œé‡ç”¨&lt;/p>
&lt;/li>
&lt;li>
&lt;p>å¯¹æ•°æ®å·çš„ä¿®æ”¹ä¼šç«‹é©¬ç”Ÿæ•ˆ&lt;/p>
&lt;/li>
&lt;li>
&lt;p>å¯¹æ•°æ®å·çš„æ›´æ–°ï¼Œä¸ä¼šå½±å“é•œåƒ&lt;/p>
&lt;/li>
&lt;li>
&lt;p>å·ä¼šä¸€ç›´å­˜åœ¨ï¼Œç›´åˆ°æ²¡æœ‰å®¹å™¨ä½¿ç”¨&lt;/p>
&lt;/li>
&lt;li>
&lt;p>æ•°æ®å·çš„ä½¿ç”¨ï¼Œç±»ä¼¼äºŽ Linux ä¸‹å¯¹ç›®å½•æˆ–æ–‡ä»¶è¿›è¡Œ mountã€‚&lt;/p>
&lt;/li>
&lt;/ul>
&lt;p>For example,&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># the following creates a tmpfs volume called foo with a size of 100 megabyte and uid of 1000.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ docker volume create --driver &lt;span class="nb">local&lt;/span> &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> --opt &lt;span class="nv">type&lt;/span>&lt;span class="o">=&lt;/span>tmpfs &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> --opt &lt;span class="nv">device&lt;/span>&lt;span class="o">=&lt;/span>tmpfs &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> --opt &lt;span class="nv">o&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="nv">size&lt;/span>&lt;span class="o">=&lt;/span>100m,uid&lt;span class="o">=&lt;/span>&lt;span class="m">1000&lt;/span> &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> foo
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>nother example that uses nfs to mount the /path/to/dir in rw mode from 192.168.1.1:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">$ docker volume create --driver &lt;span class="nb">local&lt;/span> &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> --opt &lt;span class="nv">type&lt;/span>&lt;span class="o">=&lt;/span>nfs &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> --opt &lt;span class="nv">o&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="nv">addr&lt;/span>&lt;span class="o">=&lt;/span>192.168.1.1,rw &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> --opt &lt;span class="nv">device&lt;/span>&lt;span class="o">=&lt;/span>:/path/to/dir &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> foo
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">$ docker run -d &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> -it &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> --name devtest &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> -v myvol2:/app &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> nginx:latest
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-json" data-lang="json">&lt;span class="line">&lt;span class="cl">&lt;span class="s2">&amp;#34;Mounts&amp;#34;&lt;/span>&lt;span class="err">:&lt;/span> &lt;span class="p">[&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;Type&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;volume&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;Name&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;myvol2&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;Source&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;/var/lib/docker/volumes/myvol2/_data&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;Destination&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;/app&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;Driver&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;local&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;Mode&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;RW&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="kc">true&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;Propagation&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">]&lt;/span>&lt;span class="err">,&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Docker &lt;code>-v&lt;/code> æ ‡è®°ä¹Ÿå¯ä»¥æŒ‡å®šæŒ‚è½½ä¸€ä¸ªæœ¬åœ°ä¸»æœºçš„ç›®å½• / æ–‡ä»¶åˆ°å®¹å™¨ä¸­åŽ»ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># æŒ‚è½½ç›®å½•&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ sudo docker run -d -P --name web -v /src/webapp:/opt/webapp training/webapp python app.py
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># æŒ‚è½½æ–‡ä»¶&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ sudo docker run --rm -it -v ~/.bash_history:/.bash_history ubuntu /bin/bash
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># Docker æŒ‚è½½æ•°æ®å·çš„é»˜è®¤æƒé™æ˜¯è¯»å†™ï¼Œç”¨æˆ·ä¹Ÿå¯ä»¥é€šè¿‡ `:ro` æŒ‡å®šä¸ºåªè¯»ã€‚&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ sudo docker run -d -P --name web -v /src/webapp:/opt/webapp:ro
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">training/webapp python app.py
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>æ³¨æ„ï¼šDockerfile ä¸­ä¸æ”¯æŒè¿™ç§ç”¨æ³•ï¼Œè¿™æ˜¯å› ä¸º Dockerfile æ˜¯ä¸ºäº†ç§»æ¤å’Œåˆ†äº«ç”¨çš„ã€‚ç„¶è€Œï¼Œä¸åŒæ“ä½œç³»ç»Ÿçš„è·¯å¾„æ ¼å¼ä¸ä¸€æ ·ï¼Œæ‰€ä»¥ç›®å‰è¿˜ä¸èƒ½æ”¯æŒã€‚&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="l">VOLUME /data&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="network--ç½‘ç»œ">Network | ç½‘ç»œ&lt;/h2>
&lt;p>Linux åœ¨ç½‘ç»œæ ˆä¸­å¼•å…¥ç½‘ç»œå‘½åç©ºé—´ï¼Œå°†ç‹¬ç«‹çš„ç½‘ç»œåè®®æ ˆéš”ç¦»åˆ°ä¸åŒçš„å‘½ä»¤ç©ºé—´ä¸­ï¼Œå½¼æ­¤é—´æ— æ³•é€šä¿¡ï¼›Docker åˆ©ç”¨è¿™ä¸€ç‰¹æ€§ï¼Œå®žçŽ°ä¸å®¹å™¨é—´çš„ç½‘ç»œéš”ç¦»ï¼Œå¹¶ä¸”å¼•å…¥ Veth è®¾å¤‡å¯¹æ¥å®žçŽ°åœ¨ä¸åŒç½‘ç»œå‘½åç©ºé—´çš„é€šä¿¡ã€‚Linux ç³»ç»ŸåŒ…å«ä¸€ä¸ªå®Œæ•´çš„è·¯ç”±åŠŸèƒ½ï¼Œå½“ IP å±‚åœ¨å¤„ç†æ•°æ®å‘é€æˆ–è½¬å‘çš„æ—¶å€™ï¼Œä¼šä½¿ç”¨è·¯ç”±è¡¨æ¥å†³å®šå‘å¾€å“ªé‡Œã€‚Netfilter è´Ÿè´£åœ¨å†…æ ¸ä¸­æ‰§è¡Œå„ç§æŒ‚æŽ¥çš„è§„åˆ™(è¿‡æ»¤ã€ä¿®æ”¹ã€ä¸¢å¼ƒç­‰)ï¼Œè¿è¡Œåœ¨å†…æ ¸æ¨¡å¼ä¸­ï¼›Iptables æ¨¡å¼æ˜¯åœ¨ç”¨æˆ·æ¨¡å¼ä¸‹è¿è¡Œçš„è¿›ç¨‹ï¼Œè´Ÿè´£ååŠ©ç»´æŠ¤å†…æ ¸ä¸­ Netfilter çš„å„ç§è§„åˆ™è¡¨ï¼›é€šè¿‡äºŒè€…çš„é…åˆæ¥å®žçŽ°æ•´ä¸ª Linux ç½‘ç»œåè®®æ ˆä¸­çµæ´»çš„æ•°æ®åŒ…å¤„ç†æœºåˆ¶ã€‚Docker çš„ç½‘ç»œå­ç³»ç»Ÿé‡‡ç”¨äº†åŸºäºŽé©±åŠ¨çš„å¯æ’æ‹”æœºåˆ¶ï¼Œå…¶é»˜è®¤åŒ…å«äº†å¦‚ä¸‹é©±åŠ¨æ¨¡å¼ï¼š&lt;/p>
&lt;ul>
&lt;li>&lt;code>bridge&lt;/code>: é»˜è®¤çš„ç½‘ç»œé©±åŠ¨ï¼Œå¸¸ç”¨äºŽå¤šä¸ªåº”ç”¨è¿è¡Œä¸Žç‹¬ç«‹å®¹å™¨ä¸­å¹¶ä¸”éœ€è¦ç›¸äº’é€šè®¯çš„æ—¶å€™ã€‚&lt;/li>
&lt;li>&lt;code>host&lt;/code>: ç§»é™¤å®¹å™¨ä¸Ž Docker ä¸»æœºä¹‹é—´çš„ç½‘ç»œéš”ç¦»ï¼Œç›´æŽ¥ä½¿ç”¨å®¿ä¸»æœºæ‰€åœ¨çš„ç½‘ç»œã€‚åº•å±‚ä¸Žå®¿ä¸»æœºå…±ç”¨ä¸€ä¸ª Network Namespaceï¼Œå®¹å™¨å°†ä¸ä¼šè™šæ‹Ÿå‡ºè‡ªå·±çš„ç½‘å¡ï¼Œé…ç½®è‡ªå·±çš„ IP ç­‰ï¼Œè€Œæ˜¯ä½¿ç”¨å®¿ä¸»æœºçš„ IP å’Œç«¯å£ã€‚&lt;/li>
&lt;li>&lt;code>overlay&lt;/code>: Overlay ç½‘ç»œç”¨è¯­è¿žæŽ¥å¤šä¸ª Docker Daemonï¼Œä¿è¯ Docker Swarm æœåŠ¡çš„æ­£å¸¸è¿è¡Œï¼›ç‹¬ç«‹çš„å®¹å™¨ä¸Ž Swarm æœåŠ¡ï¼Œæˆ–è€…ä¸åŒå®¿ä¸»æœºä¸Šçš„å®¹å™¨åŒæ ·èƒ½å¤Ÿé€šè¿‡ Overlay è¿›è¡Œé€šä¿¡ã€‚&lt;/li>
&lt;li>&lt;code>none&lt;/code>: å¯¹äºŽæŒ‡å®šå®¹å™¨ç¦æ­¢æ‰€æœ‰çš„ç½‘ç»œé€šä¿¡ã€‚&lt;/li>
&lt;li>&lt;code>macvlan&lt;/code>: Macvlan ç½‘ç»œä¼šå…è®¸ç›´æŽ¥ä¸ºå®¹å™¨åˆ†é… MAC åœ°å€ï¼Œä½¿å…¶ä½œä¸ºçœŸæ­£çš„ç‰©ç†è®¾å¤‡æŽ¥å…¥åˆ°å®¿ä¸»æœºæ‰€åœ¨çš„ç½‘ç»œä¸­ã€‚&lt;/li>
&lt;/ul>
&lt;p>æˆ‘ä»¬ä½¿ç”¨ network å‘½ä»¤å¯ä»¥æŸ¥çœ‹åˆ°é»˜è®¤çš„ç½‘ç»œï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">$ docker network ls
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">NETWORK ID NAME DRIVER SCOPE
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">f707aa0ef50d bridge bridge &lt;span class="nb">local&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">97dd7a032d96 host host &lt;span class="nb">local&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">d5a1bed0b12d none null &lt;span class="nb">local&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>æ¡¥æŽ¥æ¨¡å¼ä¸‹ï¼Œå½“ Docker å¯åŠ¨æ—¶ï¼Œä¼šè‡ªåŠ¨åœ¨ä¸»æœºä¸Šåˆ›å»ºä¸€ä¸ª docker0 è™šæ‹Ÿç½‘æ¡¥ï¼Œå³è½¯ä»¶äº¤æ¢æœºï¼Œåœ¨æŒ‚è½½åˆ°å®ƒçš„ç½‘å£ä¹‹é—´è¿›è¡Œè½¬å‘ã€‚åŒæ—¶ï¼ŒDocker éšæœºåˆ†é…ä¸€ä¸ªæœ¬åœ°æœªå ç”¨çš„ç§æœ‰ç½‘æ®µ(åœ¨ RFC1918 ä¸­å®šä¹‰)ä¸­çš„ä¸€ä¸ªåœ°å€ç»™ docker0 æŽ¥å£ã€‚æ¯”å¦‚å…¸åž‹çš„ 172.17.42.1ï¼ŒæŽ©ç ä¸º 255.255.0.0ã€‚æ­¤åŽå¯åŠ¨çš„å®¹å™¨å†…çš„ç½‘å£ä¹Ÿä¼šè‡ªåŠ¨åˆ†é…ä¸€ä¸ªåŒä¸€ç½‘æ®µ(172.17.0.0/16)çš„åœ°å€ã€‚&lt;/p>
&lt;p>æ¡¥æŽ¥æ¨¡å¼ä¸‹ï¼Œåˆ›å»ºä¸€ä¸ª Docker å®¹å™¨çš„æ—¶å€™ï¼ŒåŒæ—¶ä¼šåˆ›å»ºäº†ä¸€å¯¹ veth pair æŽ¥å£(å½“æ•°æ®åŒ…å‘é€åˆ°ä¸€ä¸ªæŽ¥å£æ—¶ï¼Œå¦å¤–ä¸€ä¸ªæŽ¥å£ä¹Ÿå¯ä»¥æ”¶åˆ°ç›¸åŒçš„æ•°æ®åŒ…)ã€‚è¿™å¯¹æŽ¥å£ä¸€ç«¯åœ¨å®¹å™¨å†…ï¼Œå³ eth0ï¼›å¦ä¸€ç«¯åœ¨æœ¬åœ°å¹¶è¢«æŒ‚è½½åˆ° docker0 ç½‘æ¡¥ï¼Œåç§°ä»¥ veth å¼€å¤´(ä¾‹å¦‚ vethAQI2QT)ã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œä¸»æœºå¯ä»¥è·Ÿå®¹å™¨é€šä¿¡ï¼Œå®¹å™¨ä¹‹é—´ä¹Ÿå¯ä»¥ç›¸äº’é€šä¿¡ã€‚Docker å°±åˆ›å»ºäº†åœ¨ä¸»æœºå’Œæ‰€æœ‰å®¹å™¨ä¹‹é—´ä¸€ä¸ªè™šæ‹Ÿå…±äº«ç½‘ç»œã€‚&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># åˆ›å»ºæ–°çš„ç½‘ç»œ&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ docker network create --driver bridge isolated
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># æŒ‡å®šç½‘æ®µï¼Œå®¿ä¸»æœºä¼šä½œä¸ºé»˜è®¤ç½‘å…³&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ docker network create --driver&lt;span class="o">=&lt;/span>bridge --subnet&lt;span class="o">=&lt;/span>192.168.2.0/24 --gateway&lt;span class="o">=&lt;/span>192.168.2.10 new_subnet
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># åˆ›å»ºæ—¶å°†æŸä¸ªå®¹å™¨è¿žæŽ¥åˆ°ç½‘ç»œ&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ docker run --network&lt;span class="o">=&lt;/span>isolated -itd --name&lt;span class="o">=&lt;/span>docker-nginx nginx
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># å°†æŸä¸ªè¿è¡Œä¸­å®¹å™¨è¿žæŽ¥åˆ°æŸä¸ªç½‘ç»œï¼Œåœ¨è¯¥ç½‘ç»œå†…å¯ä»¥é€šè¿‡å®¹å™¨åè‡ªç”±è®¿é—®&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ docker network connect multi-host-network container1
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="dns">DNS&lt;/h3>
&lt;p>é»˜è®¤æƒ…å†µä¸‹ï¼Œå®¹å™¨ä»Ž Docker å®ˆæŠ¤è¿›ç¨‹ç»§æ‰¿ DNS è®¾ç½®ï¼ŒåŒ…æ‹¬ /etc/hosts å’Œ /etc/resolv.confã€‚å¯ä»¥åŸºäºŽæ¯ä¸ªå®¹å™¨è¦†ç›–è¿™äº›è®¾ç½®ã€‚&lt;/p>
&lt;ul>
&lt;li>-h HOSTNAME or &amp;ndash;hostname=HOSTNAME è®¾å®šå®¹å™¨çš„ä¸»æœºåï¼Œå®ƒä¼šè¢«å†™åˆ°å®¹å™¨å†…çš„ /etc/hostname å’Œ /etc/hostsã€‚ä½†å®ƒåœ¨å®¹å™¨å¤–éƒ¨çœ‹ä¸åˆ°ï¼Œæ—¢ä¸ä¼šåœ¨ docker ps ä¸­æ˜¾ç¤ºï¼Œä¹Ÿä¸ä¼šåœ¨å…¶ä»–çš„å®¹å™¨çš„ /etc/hosts çœ‹åˆ°ã€‚&lt;/li>
&lt;li>&amp;ndash;link=CONTAINER_NAME:ALIAS é€‰é¡¹ä¼šåœ¨åˆ›å»ºå®¹å™¨çš„æ—¶å€™ï¼Œæ·»åŠ ä¸€ä¸ªå…¶ä»–å®¹å™¨çš„ä¸»æœºååˆ° /etc/hosts æ–‡ä»¶ä¸­ï¼Œè®©æ–°å®¹å™¨çš„è¿›ç¨‹å¯ä»¥ä½¿ç”¨ä¸»æœºå ALIAS å°±å¯ä»¥è¿žæŽ¥å®ƒã€‚&lt;/li>
&lt;li>&amp;ndash;dns=IP_ADDRESS æ·»åŠ  DNS æœåŠ¡å™¨åˆ°å®¹å™¨çš„ /etc/resolv.conf ä¸­ï¼Œè®©å®¹å™¨ç”¨è¿™ä¸ªæœåŠ¡å™¨æ¥è§£æžæ‰€æœ‰ä¸åœ¨ /etc/hosts ä¸­çš„ä¸»æœºåã€‚&lt;/li>
&lt;li>&amp;ndash;dns-search=DOMAIN è®¾å®šå®¹å™¨çš„æœç´¢åŸŸï¼Œå½“è®¾å®šæœç´¢åŸŸä¸º .example.com æ—¶ï¼Œåœ¨æœç´¢ä¸€ä¸ªåä¸º host çš„ ä¸»æœºæ—¶ï¼ŒDNS ä¸ä»…æœç´¢ hostï¼Œè¿˜ä¼šæœç´¢ host.example.comã€‚æ³¨æ„ï¼šå¦‚æžœæ²¡æœ‰ä¸Šè¿°æœ€åŽ 2 ä¸ªé€‰é¡¹ï¼ŒDocker ä¼šé»˜è®¤ç”¨ä¸»æœºä¸Šçš„ /etc/resolv.conf æ¥é…ç½®å®¹å™¨ã€‚&lt;/li>
&lt;/ul>
&lt;h2 id="ç©ºé—´æ¸…ç†">ç©ºé—´æ¸…ç†&lt;/h2>
&lt;p>Docker ä½¿ç”¨è¿‡ç¨‹ä¸­ï¼Œå¯èƒ½ä¼šå‘çŽ°å®¿ä¸»èŠ‚ç‚¹çš„ç£ç›˜å®¹é‡æŒç»­å¢žé•¿ï¼Œè­¬å¦‚ volume æˆ–è€… overlay2 ç›®å½•å ç”¨äº†å¤§é‡çš„ç©ºé—´ï¼›å¦‚æžœä»»å…¶å‘å±•ï¼Œå¯èƒ½å°†ç£ç›˜ç©ºé—´è€—å°½è¿›è€Œå¼•å‘å®¿ä¸»æœºå¼‚å¸¸ï¼Œè¿›è€Œå¯¹ä¸šåŠ¡é€ æˆå½±å“ã€‚Docker çš„å†…ç½® df æŒ‡ä»¤å¯ç”¨äºŽæŸ¥è¯¢é•œåƒ(Images)ã€å®¹å™¨(Containers)å’Œæœ¬åœ°å·(Local Volumes)ç­‰ç©ºé—´ä½¿ç”¨å¤§æˆ·çš„ç©ºé—´å ç”¨æƒ…å†µã€‚è€Œå®¹å™¨çš„å ç”¨çš„æ€»ç©ºé—´ï¼ŒåŒ…å«å…¶æœ€é¡¶å±‚çš„è¯»å†™å±‚(writable layer)å’Œåº•éƒ¨çš„åªè¯»é•œåƒå±‚(base image layerï¼Œread-only)ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ &lt;code>ps -s&lt;/code> å‚æ•°æ¥æ˜¾ç¤ºäºŒè€…çš„ç©ºé—´å ç”¨æƒ…å†µ:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># æŸ¥çœ‹å½“å‰ç›®å½•ä¸‹çš„æ–‡ä»¶ç©ºé—´å ç”¨&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ du -h --max-depth&lt;span class="o">=&lt;/span>&lt;span class="m">1&lt;/span> &lt;span class="p">|&lt;/span> sort
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># ç©ºé—´å ç”¨æ€»ä½“åˆ†æž&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ docker system df
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># è¾“å‡ºç©ºé—´å ç”¨ç»†èŠ‚&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ docker system df -v
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># è¾“å‡ºå®¹å™¨çš„ç©ºé—´å ç”¨&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ docker ps -s
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;code>docker system prune&lt;/code> æŒ‡ä»¤èƒ½å¤Ÿè¿›è¡Œè‡ªåŠ¨åœ°ç©ºé—´æ¸…ç†ï¼Œå…¶é»˜è®¤ä¼šæ¸…é™¤å·²åœæ­¢çš„å®¹å™¨ã€æœªè¢«ä»»ä½•å®¹å™¨æ‰€ä½¿ç”¨çš„å·ã€æœªè¢«ä»»ä½•å®¹å™¨æ‰€å…³è”çš„ç½‘ç»œã€æ‰€æœ‰æ‚¬ç©ºé•œåƒ:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># ä¸€å¹¶æ¸…é™¤æ‰€æœ‰æœªä½¿ç”¨çš„é•œåƒå’Œæ‚¬ç©ºé•œåƒ&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ docker system prune --all
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># åˆ—ä¸¾æ‚¬ç©ºé•œåƒ&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ docker images -f &lt;span class="nv">dangling&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="nb">true&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># åˆ é™¤å…¨éƒ¨æ‚¬ç©ºé•œåƒ&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ docker image prune
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># åˆ é™¤æ‰€æœ‰æœªè¢«ä½¿ç”¨çš„é•œåƒ&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ docker image prune -a
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># åˆ é™¤æŒ‡å®šæ¨¡å¼çš„é•œåƒ&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ docker images -a &lt;span class="p">|&lt;/span> grep &lt;span class="s2">&amp;#34;pattern&amp;#34;&lt;/span> &lt;span class="p">|&lt;/span> awk &lt;span class="s1">&amp;#39;{print $3}&amp;#39;&lt;/span> &lt;span class="p">|&lt;/span> xargs docker rmi
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># åˆ é™¤å…¨éƒ¨é•œåƒ&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ docker rmi &lt;span class="k">$(&lt;/span>docker images -a -q&lt;span class="k">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># åˆ é™¤å…¨éƒ¨åœæ­¢çš„å®¹å™¨&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ docker rm &lt;span class="k">$(&lt;/span>docker ps -a -f &lt;span class="nv">status&lt;/span>&lt;span class="o">=&lt;/span>exited -q&lt;span class="k">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># æ ¹æ®æŒ‡å®šæ¨¡å¼åˆ é™¤å®¹å™¨&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ docker rm &lt;span class="k">$(&lt;/span>docker ps -a -f &lt;span class="nv">status&lt;/span>&lt;span class="o">=&lt;/span>exited -f &lt;span class="nv">status&lt;/span>&lt;span class="o">=&lt;/span>created -q&lt;span class="k">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ docker rm &lt;span class="k">$(&lt;/span>docker ps -a &lt;span class="p">|&lt;/span> grep rabbitmq &lt;span class="p">|&lt;/span> awk &lt;span class="s1">&amp;#39;{print $1}&amp;#39;&lt;/span>&lt;span class="k">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># åˆ é™¤å…¨éƒ¨å®¹å™¨&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ docker stop &lt;span class="k">$(&lt;/span>docker ps -a -q&lt;span class="k">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ docker rm &lt;span class="k">$(&lt;/span>docker ps -a -q&lt;span class="k">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># åˆ—ä¸¾å¹¶åˆ é™¤æœªè¢«ä½¿ç”¨çš„å·&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ docker volume ls -f &lt;span class="nv">dangling&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="nb">true&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ docker volume prune
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># æ ¹æ®æŒ‡å®šçš„æ¨¡å¼åˆ é™¤å·&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ docker volume prune --filter &lt;span class="s2">&amp;#34;label!=keep&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># åˆ é™¤æœªè¢«å…³è”çš„ç½‘ç»œ&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ docker network prune
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ docker network prune --filter &lt;span class="s2">&amp;#34;until=24h&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>æˆ‘ä»¬ä¹Ÿå¯ä»¥æ‰‹åŠ¨æŒ‡å®šæ—¥å¿—æ–‡ä»¶çš„å°ºå¯¸æˆ–è€…æ¸…ç©ºæ—¥å¿—æ–‡ä»¶:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># è®¾ç½®æ—¥å¿—æ–‡ä»¶æœ€å¤§å°ºå¯¸&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ dockerd ... --log-opt max-size&lt;span class="o">=&lt;/span>10m --log-opt max-file&lt;span class="o">=&lt;/span>&lt;span class="m">3&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># æ¸…ç©ºå½“å‰æ—¥å¿—æ–‡ä»¶&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">truncate -s &lt;span class="m">0&lt;/span> /var/lib/docker/containers/*/*-json.log
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h1 id="æœåŠ¡æ²»ç†">æœåŠ¡æ²»ç†&lt;/h1>
&lt;h2 id="docker-compose">Docker Compose&lt;/h2>
&lt;p>Docker Compose æ˜¯ç”¨äºŽå®šä¹‰å’Œè¿è¡Œå¤æ‚ Docker åº”ç”¨çš„å·¥å…·ã€‚ä½ å¯ä»¥åœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­å®šä¹‰ä¸€ä¸ªå¤šå®¹å™¨çš„åº”ç”¨ï¼Œç„¶åŽä½¿ç”¨ä¸€æ¡å‘½ä»¤æ¥å¯åŠ¨ä½ çš„åº”ç”¨ï¼Œç„¶åŽæ‰€æœ‰ç›¸å…³çš„æ“ä½œéƒ½ä¼šè¢«è‡ªåŠ¨å®Œæˆï¼›ç®€å•çš„ Compose æ–‡ä»¶å®šä¹‰å¦‚ä¸‹ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="c"># æŒ‡å®š Docker Compose æ–‡ä»¶ç‰ˆæœ¬&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">version&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s2">&amp;#34;3&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">services&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">web&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="c"># æŒ‡å®šä»Žæœ¬åœ°ç›®å½•è¿›è¡Œç¼–è¯‘&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">build&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">.&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="c"># æŒ‡å®šå¯¼å‡ºç«¯å£&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">ports&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="s2">&amp;#34;5000:5000&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="c"># æ›¿æ¢é»˜è®¤çš„ CMD å‘½ä»¤&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">command&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">python app.py&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="c"># å°†æœ¬åœ°ç›®å½•ç»‘å®šåˆ°å®¹å™¨å†…ç›®å½•&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">volumes&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="l">.:/code&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">redis&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="c"># é•œåƒçš„ ID&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">image&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s2">&amp;#34;redis:alpine&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>è¿™é‡Œç”¨åˆ°çš„ Python Web åº”ç”¨çš„ Dockerfile å¦‚ä¸‹ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-Dockerfile" data-lang="Dockerfile">&lt;span class="line">&lt;span class="cl">&lt;span class="k">FROM&lt;/span>&lt;span class="s"> python:3.4-alpine&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="k">ADD&lt;/span> . /code&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="k">WORKDIR&lt;/span>&lt;span class="s"> /code&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="k">RUN&lt;/span> pip install -r requirements.txt&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="k">CMD&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="s2">&amp;#34;python&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;app.py&amp;#34;&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œæˆ‘ä»¬åœ¨ä»£ç ä¸­ç›´æŽ¥ä½¿ç”¨æœåŠ¡åä½œä¸ºè¿žæŽ¥åœ°å€ï¼Œå³å¯è®¿é—®åˆ° Redis æ•°æ®åº“ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-py" data-lang="py">&lt;span class="line">&lt;span class="cl">&lt;span class="n">cache&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">redis&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">Redis&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">host&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;redis&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">port&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">6379&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ç„¶åŽä½¿ç”¨ docker-compose å‘½ä»¤å¯åŠ¨ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># äº¤äº’å¼å¯åŠ¨&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ docker-compose up
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># å®ˆæŠ¤è¿›ç¨‹å¼å¯åŠ¨&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ docker-compose up -d
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># æŸ¥çœ‹è¿è¡Œæƒ…å†µ&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ docker-compose ps
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># å…³é—­&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ docker-compose stop
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># ç§»é™¤å†…éƒ¨å·&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ docker-compose down --volumes
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>åœ¨æ¶‰åŠåˆ°æ•°æ®å­˜å‚¨çš„åœºæ™¯ä¸‹ï¼Œæˆ‘ä»¬åŒæ ·å¯ä»¥æŒ‡å®š docker-compose åˆ›å»ºå‘½åæ•°æ®å·ï¼Œå¹¶å°†å…¶æŒ‚è½½åˆ°å®¹å™¨ä¸­ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">version&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s2">&amp;#34;3.2&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">services&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">web&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">image&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">nginx:alpine&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">volumes&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">type&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">volume&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">source&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">mydata&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">target&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">/data&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">volume&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">nocopy&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="kc">true&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">type&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">bind&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">source&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">./static&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">target&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">/opt/app/static&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">db&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">image&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">postgres:latest&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">volumes&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="s2">&amp;#34;/var/run/postgres/postgres.sock:/var/run/postgres/postgres.sock&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="s2">&amp;#34;dbdata:/var/lib/postgresql/data&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">volumes&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">mydata&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">dbdata&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>å¦‚æžœæŸä¸ªæ•°æ®å·å¤©ç„¶éœ€è¦æ˜ å°„åˆ°æœ¬åœ°æ–‡ä»¶ï¼Œåˆ™å¯ä»¥æŒ‡å®š driver çš„ç±»åž‹ä¸º local:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">volumes&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">wsat_etc&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">driver&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">local&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">driver_opts&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">o&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">bind&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">type&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">none&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">device&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">/etc/wsat/&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="docker-swarm-1">Docker Swarm&lt;/h2>
&lt;p>Swarm æ˜¯ Docker å…¬å¸åœ¨ 2014 å¹´ 12 æœˆåˆå‘å¸ƒçš„ä¸€å¥—è¾ƒä¸ºç®€å•çš„å·¥å…·ï¼Œç”¨æ¥ç®¡ç† Docker é›†ç¾¤ï¼Œå®ƒå°†ä¸€ç¾¤ Docker å®¿ä¸»æœºå˜æˆä¸€ä¸ªå•ä¸€çš„ï¼Œè™šæ‹Ÿçš„ä¸»æœºã€‚Swarm ä½¿ç”¨æ ‡å‡†çš„ Docker API æŽ¥å£ä½œä¸ºå…¶å‰ç«¯è®¿é—®å…¥å£ï¼Œæ¢è¨€ä¹‹ï¼Œå„ç§å½¢å¼çš„ Docker Client(dockerclient in go, docker_py, docker ç­‰)å‡å¯ä»¥ç›´æŽ¥ä¸Ž Swarm é€šä¿¡ã€‚&lt;/p>
&lt;p>Swarm Deamon åªæ˜¯ä¸€ä¸ªè°ƒåº¦å™¨(Scheduler)å’Œè·¯ç”±å™¨(Router)ï¼ŒSwarm è‡ªå·±ä¸è¿è¡Œå®¹å™¨ï¼Œå®ƒåªæ˜¯æŽ¥å— Docker å®¢æˆ·ç«¯å‘é€è¿‡æ¥çš„è¯·æ±‚ï¼Œè°ƒåº¦é€‚åˆçš„èŠ‚ç‚¹æ¥è¿è¡Œå®¹å™¨ï¼Œè¿™æ„å‘³ç€ï¼Œå³ä½¿ Swarm ç”±äºŽæŸäº›åŽŸå› æŒ‚æŽ‰äº†ï¼Œé›†ç¾¤ä¸­çš„èŠ‚ç‚¹ä¹Ÿä¼šç…§å¸¸è¿è¡Œï¼Œå½“ Swarm é‡æ–°æ¢å¤è¿è¡Œä¹‹åŽï¼Œå®ƒä¼šæ”¶é›†é‡å»ºé›†ç¾¤ä¿¡æ¯ã€‚å¹¶ä¸” Swarm æä¾›çš„è·¯ç”±åŒ¹é…(æœåŠ¡å‘çŽ°ã€è´Ÿè½½å‡è¡¡ã€è·¨å®¹å™¨é€šè®¯)éžå¸¸å¯é ã€‚åœ¨å•ä¸ªç«¯å£ä¸Šè¿è¡Œä¸€ä¸ªæœåŠ¡ï¼ŒSwarm èŠ‚ç‚¹çš„ä»»æ„ä¸»æœºéƒ½å¯ä»¥è®¿é—®ï¼Œè´Ÿè½½å‡è¡¡å®Œå…¨åœ¨åŽå°å®žçŽ°ã€‚&lt;/p>
&lt;p>
&lt;figure >
&lt;div class="d-flex justify-content-center">
&lt;div class="w-100" >&lt;img src="https://user-images.githubusercontent.com/5803001/44953944-dfbc7a00-aecd-11e8-93dc-1fe6258aafd0.png" alt="image" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>&lt;/p>
&lt;p>Swarm åœ¨ Scheduler èŠ‚ç‚¹è¿è¡Œå®¹å™¨çš„æ—¶å€™ï¼Œä¼šæ ¹æ®æŒ‡å®šçš„ç­–ç•¥æ¥è®¡ç®—æœ€é€‚åˆè¿è¡Œå®¹å™¨çš„èŠ‚ç‚¹ï¼Œç›®å‰æ”¯æŒçš„ç­–ç•¥æœ‰ï¼šRandom, Binpack, Spreadã€‚&lt;/p>
&lt;p>Random é¡¾åæ€ä¹‰ï¼Œå°±æ˜¯éšæœºé€‰æ‹©ä¸€ä¸ª Node æ¥è¿è¡Œå®¹å™¨ï¼Œä¸€èˆ¬ç”¨ä½œè°ƒè¯•ç”¨ã€‚Spread å’Œ Binpack ç­–ç•¥ä¼šæ ¹æ®å„ä¸ªèŠ‚ç‚¹çš„å¯ç”¨çš„ CPU, RAM ä»¥åŠæ­£åœ¨è¿è¡Œçš„å®¹å™¨çš„æ•°é‡æ¥è®¡ç®—åº”è¯¥è¿è¡Œå®¹å™¨çš„èŠ‚ç‚¹ã€‚åœ¨åŒç­‰æ¡ä»¶ä¸‹ï¼ŒSpread ç­–ç•¥ä¼šé€‰æ‹©è¿è¡Œå®¹å™¨æœ€å°‘çš„é‚£å°èŠ‚ç‚¹æ¥è¿è¡Œæ–°çš„å®¹å™¨ï¼ŒBinpack ç­–ç•¥ä¼šé€‰æ‹©è¿è¡Œå®¹å™¨æœ€é›†ä¸­çš„é‚£å°æœºå™¨æ¥è¿è¡Œæ–°çš„èŠ‚ç‚¹ã€‚&lt;/p>
&lt;p>ä½¿ç”¨ Spread ç­–ç•¥ä¼šä½¿å¾—å®¹å™¨ä¼šå‡è¡¡çš„åˆ†å¸ƒåœ¨é›†ç¾¤ä¸­çš„å„ä¸ªèŠ‚ç‚¹ä¸Šè¿è¡Œï¼Œä¸€æ—¦ä¸€ä¸ªèŠ‚ç‚¹æŒ‚æŽ‰äº†åªä¼šæŸå¤±å°‘éƒ¨åˆ†çš„å®¹å™¨ã€‚Binpack ç­–ç•¥æœ€å¤§åŒ–çš„é¿å…å®¹å™¨ç¢Žç‰‡åŒ–ï¼Œå°±æ˜¯è¯´ Binpack ç­–ç•¥å°½å¯èƒ½çš„æŠŠè¿˜æœªä½¿ç”¨çš„èŠ‚ç‚¹ç•™ç»™éœ€è¦æ›´å¤§ç©ºé—´çš„å®¹å™¨è¿è¡Œï¼Œå°½å¯èƒ½çš„æŠŠå®¹å™¨è¿è¡Œåœ¨ä¸€ä¸ªèŠ‚ç‚¹ä¸Šé¢ã€‚&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># åˆ›å»ºä¸€ä¸ªæ–°çš„æœåŠ¡&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ docker service create &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span>--image nginx &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span>--replicas &lt;span class="m">2&lt;/span> &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span>nginx
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># æ›´æ–°æœåŠ¡&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ docker service update &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span>--image nginx:alpine &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span>nginx
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># åˆ é™¤æœåŠ¡&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ docker service rm nginx
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># ç¼©å®¹ï¼Œè€Œä¸æ˜¯ç›´æŽ¥åˆ é™¤æœåŠ¡&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ docker service scale &lt;span class="nv">nginx&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># æ‰©å®¹&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ docker service scale &lt;span class="nv">nginx&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">5&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># åˆ—å‡ºæ‰€æœ‰çš„æœåŠ¡&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ docker service ls
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># åˆ—å‡ºä¸€ä¸ªæœåŠ¡çš„æ‰€æœ‰å®žä¾‹(åŒ…æ‹¬æœåŠ¡çš„å¥åº·çŠ¶å†µ)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ docker service ps nginx
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># æœåŠ¡çš„è¯¦ç»†ä¿¡æ¯&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ docker service inspect nginx
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># å¢žåŠ å’Œåˆ é™¤DNS&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ docker service update --dns-add 222.222.222.222 tender_hofstadter
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ docker service update --dns-rm 222.222.222.222 tender_hofstadter
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># å¢žåŠ å’Œåˆ é™¤ç«¯å£æ˜ å°„&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ docker service update --publish-add 80:80 xenodochial_ritchie
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ docker service update --publish-rm 80:80 xenodochial_ritchie
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>æˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨ Docker Compose çš„è„šæœ¬æ¥è¿›è¡Œæ‰¹æ¬¡éƒ¨ç½²ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">$ docker stack deploy application
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">version&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s2">&amp;#34;3&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">services&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">web&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">image&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">registry.gitlab.com/example/example&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c"># you need to use external image&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">command&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">npm run prod&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">ports&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="m">80&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="m">80&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">deploy&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">replicas&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="m">6&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">update_config&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">parallelism&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="m">2&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">delay&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">10s&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">restart_policy&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">condition&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="kc">on&lt;/span>-&lt;span class="l">failure&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>Linux-CheatSheet</title><link>https://ng-tech.icu/books/awesome-cheatsheets/4.infrastructure/linux-cheatsheet/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://ng-tech.icu/books/awesome-cheatsheets/4.infrastructure/linux-cheatsheet/</guid><description>&lt;h1 id="linux-cheatsheet">Linux CheatSheet&lt;/h1>
&lt;p>BIOSï¼š&lt;/p>
&lt;p>Basic Input Output System çš„ç¼©ç•¥è¯ï¼Œç›´è¯‘&amp;quot;åŸºæœ¬è¾“å…¥è¾“å‡ºç³»ç»Ÿ&amp;quot;ã€‚&lt;/p>
&lt;p>å®ƒæ˜¯ä¸€ç»„å›ºåŒ–åˆ°è®¡ç®—æœºå†…ä¸»æ¿ä¸Šä¸€ä¸ª ROM èŠ¯ç‰‡ä¸Šçš„ç¨‹åºï¼Œå®ƒä¿å­˜ç€è®¡ç®—æœºæœ€é‡è¦çš„åŸºæœ¬è¾“å…¥è¾“å‡ºçš„ç¨‹åºã€å¼€æœºåŽè‡ªæ£€ç¨‹åºå’Œç³»ç»Ÿè‡ªå¯åŠ¨ç¨‹åºï¼Œå®ƒå¯ä»Ž CMOS ä¸­è¯»å†™ç³»ç»Ÿè®¾ç½®çš„å…·ä½“ä¿¡æ¯ã€‚å…¶ä¸»è¦åŠŸèƒ½æ˜¯ä¸ºè®¡ç®—æœºæä¾›æœ€åº•å±‚çš„ã€æœ€ç›´æŽ¥çš„ç¡¬ä»¶è®¾ç½®å’ŒæŽ§åˆ¶ã€‚&lt;/p>
&lt;p>GRUBï¼š&lt;/p>
&lt;p>GRand Unified Bootloader ç®€ç§°â€œGRUBâ€ï¼Œæ˜¯ä¸€ä¸ªæ¥è‡ª GNU é¡¹ç›®çš„å¤šæ“ä½œç³»ç»Ÿå¯åŠ¨ç¨‹åºã€‚&lt;/p>
&lt;p>UEFI&lt;/p>
&lt;p>Unified Extensible Firmware Interfaceï¼Œå…¨ç§°â€œç»Ÿä¸€çš„å¯æ‰©å±•å›ºä»¶æŽ¥å£â€&lt;/p>
&lt;p>æ˜¯ä¸€ç§è¯¦ç»†æè¿°ç±»åž‹æŽ¥å£çš„æ ‡å‡†ã€‚è¿™ç§æŽ¥å£ç”¨äºŽæ“ä½œç³»ç»Ÿè‡ªåŠ¨ä»Žé¢„å¯åŠ¨çš„æ“ä½œçŽ¯å¢ƒï¼ŒåŠ è½½åˆ°ä¸€ç§æ“ä½œç³»ç»Ÿä¸Šã€‚&lt;/p>
&lt;p>å¯æ‰©å±•å›ºä»¶æŽ¥å£ï¼ˆExtensible Firmware Interfaceï¼ŒEFIï¼‰æ˜¯ Intel ä¸º PC å›ºä»¶çš„ä½“ç³»ç»“æž„ã€æŽ¥å£å’ŒæœåŠ¡æå‡ºçš„å»ºè®®æ ‡å‡†ã€‚å…¶ä¸»è¦ç›®çš„æ˜¯ä¸ºäº†æä¾›ä¸€ç»„åœ¨ OS åŠ è½½ä¹‹å‰ï¼ˆå¯åŠ¨å‰ï¼‰åœ¨æ‰€æœ‰å¹³å°ä¸Šä¸€è‡´çš„ã€æ­£ç¡®æŒ‡å®šçš„å¯åŠ¨æœåŠ¡ï¼Œè¢«çœ‹åšæ˜¯æœ‰è¿‘ 20 å¤šå¹´åŽ†å²çš„ BIOS çš„ç»§ä»»è€…ã€‚UEFI æ˜¯ç”± EFI1.10 ä¸ºåŸºç¡€å‘å±•èµ·æ¥çš„ï¼Œå®ƒçš„æ‰€æœ‰è€…å·²ä¸å†æ˜¯ Intelï¼Œè€Œæ˜¯ä¸€ä¸ªç§°ä½œ Unified EFI Form çš„å›½é™…ç»„ç»‡ã€‚&lt;/p>
&lt;h1 id="systemd">Systemd&lt;/h1>
&lt;p>&lt;a href="./Linux-CheatSheet.md">init è¿›ç¨‹&lt;/a>æ˜¯ Linux ç³»ç»Ÿ Booting ä¹‹åŽçš„é¦–ä¸ªè¿›ç¨‹ï¼Œå…¶ä½œä¸ºå®ˆæŠ¤è¿›ç¨‹è¿è¡Œç›´è‡³ç³»ç»Ÿå…³é—­ï¼›ä¼ ç»Ÿçš„ Linux ä¸­çš„æœåŠ¡æŽ§åˆ¶æ–¹å¼ä¹Ÿä¸»è¦ä¾èµ–äºŽ sysvinit æœºåˆ¶:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">$ sudo /etc/init.d/apache2 start
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># æˆ–è€…&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ service apache2 start
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>å½“ sysvinit ç³»ç»Ÿåˆå§‹åŒ–çš„æ—¶å€™ï¼Œå®ƒæ˜¯ä¸²è¡Œå¯åŠ¨ï¼Œå¹¶ä¸”ä¼šå°†æ‰€æœ‰å¯èƒ½ç”¨åˆ°çš„åŽå°æœåŠ¡è¿›ç¨‹å…¨éƒ¨å¯åŠ¨è¿è¡Œï¼›ç³»ç»Ÿå¿…é¡»ç­‰å¾…æ‰€æœ‰çš„æœåŠ¡éƒ½å¯åŠ¨å°±ç»ªä¹‹åŽï¼Œæ‰å…è®¸ç”¨æˆ·ç™»å½•ï¼Œå¯¼è‡´å¯åŠ¨æ—¶é—´è¿‡é•¿ä¸Žç³»ç»Ÿèµ„æºæµªè´¹ã€‚å¹¶ä¸” init è¿›ç¨‹åªæ˜¯æ‰§è¡Œå¯åŠ¨è„šæœ¬ï¼Œä¸ç®¡å…¶ä»–äº‹æƒ…ï¼Œè„šæœ¬éœ€è¦è‡ªå·±å¤„ç†å„ç§æƒ…å†µï¼Œä½¿å¾—è„šæœ¬å¤æ‚åº¦å¢žåŠ å¾ˆå¤šã€‚Systemd å°±æ˜¯ä¸ºäº†è§£å†³è¿™äº›é—®é¢˜è€Œè¯žç”Ÿçš„ã€‚å®ƒçš„è®¾è®¡ç›®æ ‡æ˜¯ï¼Œä¸ºç³»ç»Ÿçš„å¯åŠ¨å’Œç®¡ç†æä¾›ä¸€å¥—å®Œæ•´çš„è§£å†³æ–¹æ¡ˆã€‚&lt;/p>
&lt;p>
&lt;figure >
&lt;div class="d-flex justify-content-center">
&lt;div class="w-100" >&lt;img src="https://user-images.githubusercontent.com/5803001/45408944-64fb1800-b6a0-11e8-97a3-83bb4c681aff.png" alt="image" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>&lt;/p>
&lt;h1 id="ç”¨æˆ·è¿›ç¨‹">ç”¨æˆ·è¿›ç¨‹&lt;/h1>
&lt;p>Linux åœ¨æ“ä½œè¿™äº›ç‰©ç†å†…å­˜æ—¶ï¼Œä¸ä¼šç›´æŽ¥æ“ä½œç‰©ç†å†…å­˜ï¼Œè€Œæ˜¯å»ºç«‹ä¸€ä¸ªè™šæ‹Ÿåœ°å€ï¼ˆå¯ä»¥ç†è§£æˆè·Ÿç‰©ç†å†…å­˜ç›¸å¯¹åº”çš„æ˜ å°„ï¼‰ï¼Œå³åœ¨ç‰©ç†å†…å­˜è·Ÿè¿›ç¨‹ä¹‹é—´å¢žåŠ ä¸€ä¸ªä¸­é—´å±‚ã€‚&lt;/p>
&lt;p>ç³»ç»Ÿå°†è™šæ‹Ÿåœ°å€åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼šä¸€éƒ¨åˆ†ä¸“é—¨ç»™ç³»ç»Ÿå†…æ ¸ä½¿ç”¨ï¼Œå¦ä¸€éƒ¨åˆ†ç»™ç”¨æˆ·è¿›ç¨‹ä½¿ç”¨ã€‚å¯¹äºŽ 32 ä½çš„ç³»ç»Ÿï¼Œè™šæ‹Ÿåœ°å€èŒƒå›´æ˜¯ 0x00000000 ~ 0xFFFFFFFFï¼Œå³æœ€å¤§è™šæ‹Ÿå†…å­˜ä¸º 2^32 Bytes = 4GBï¼Œç³»ç»Ÿå°†æœ€é«˜çš„ 1G å­—èŠ‚ï¼ˆä»Žè™šæ‹Ÿåœ°å€ 0xC0000000 åˆ° 0xFFFFFFFFï¼‰åˆ†é…å†…æ ¸ä½¿ç”¨ï¼Œæ­¤åŒºåŸŸç§°ä½œå†…æ ¸ç©ºé—´ï¼›å¦å¤–å°†è¾ƒä½Žçš„ 3G å­—èŠ‚ï¼ˆä»Žè™šæ‹Ÿåœ°å€ 0x00000000 åˆ° 0xBFFFFFFFï¼‰ï¼Œä¾›å„ä¸ªè¿›ç¨‹ä½¿ç”¨ï¼Œç§°ä¸ºç”¨æˆ·ç©ºé—´ã€‚ç”±äºŽè™šæ‹Ÿåœ°å€æ˜¯ç‰©ç†å†…å­˜çš„æ˜ å°„ï¼Œç›¸å½“äºŽç³»ç»Ÿå°†ç‰©ç†å†…å­˜åˆ†æˆä¸¤éƒ¨åˆ†å•ç‹¬ä½¿ç”¨ã€‚æ‰€ä»¥ï¼ŒçŽ°åœ¨æœ‰ä¸¤ä¸ªæ¦‚å¿µï¼š&lt;/p>
&lt;p>å†…æ ¸ç©ºé—´ï¼šç³»ç»Ÿå†…æ ¸ä½¿ç”¨çš„å†…å­˜ç©ºé—´ï¼›å½“ä¸€ä¸ªè¿›ç¨‹æ‰§è¡Œè°ƒç”¨ç³»ç»Ÿå‘½ä»¤(ä¾‹å¦‚ read, write)æ—¶ï¼Œä¼šè¿›å…¥å†…æ ¸ä»£ç çš„æ‰§è¡Œï¼Œè¿›ç¨‹æ­¤æ—¶çš„çŠ¶æ€æˆ‘ä»¬ç§°ä¹‹ä¸ºå†…æ ¸æ€ã€‚
ç”¨æˆ·ç©ºé—´ï¼šç”¨æˆ·è¿›ç¨‹ä½¿ç”¨çš„å†…å­˜ç©ºé—´ï¼›å½“ä¸€ä¸ªè¿›ç¨‹æ‰§è¡Œç”¨æˆ·è‡ªå·±çš„ä»£ç æ—¶ï¼Œè¯¥è¿›ç¨‹æ­¤æ—¶çš„çŠ¶æ€ä¸ºç”¨æˆ·æ€ã€‚&lt;/p>
&lt;h1 id="links">Links&lt;/h1>
&lt;ul>
&lt;li>&lt;a href="https://www.ibm.com/developerworks/cn/linux/1407_liuming_init3/index.html" target="_blank" rel="noopener">https://www.ibm.com/developerworks/cn/linux/1407_liuming_init3/index.html&lt;/a>&lt;/li>
&lt;/ul></description></item><item><title>Network-CheatSheet</title><link>https://ng-tech.icu/books/awesome-cheatsheets/4.infrastructure/network-cheatsheet/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://ng-tech.icu/books/awesome-cheatsheets/4.infrastructure/network-cheatsheet/</guid><description>&lt;h1 id="http-cheatsheet--http-ç›¸å…³å¿…çŸ¥å¿…ä¼štcphttp2httpsdnsè¯·æ±‚å“åº”ç¼“å­˜">HTTP CheatSheet | HTTP ç›¸å…³å¿…çŸ¥å¿…ä¼šï¼šTCP/HTTP2/HTTPS/DNSï¼Œè¯·æ±‚ï¼Œå“åº”ï¼Œç¼“å­˜&lt;/h1>
&lt;p>HTTP, ç­‰ç½‘ç»œåè®®æ˜¯æˆ‘ä»¬æ—¥å¸¸å¼€å‘ã€é¢è¯•ä¸­å¸¸è§çš„çŸ¥è¯†è¦ç‚¹ã€‚&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">http://rob:abcd1234@www.example.co.uk/path/index.html?query1&lt;span class="o">=&lt;/span>test&lt;span class="p">&amp;amp;&lt;/span>&lt;span class="nv">silly&lt;/span>&lt;span class="o">=&lt;/span>willy&lt;span class="p">&amp;amp;&lt;/span>field&lt;span class="o">[&lt;/span>0&lt;span class="o">]=&lt;/span>zero&lt;span class="p">&amp;amp;&lt;/span>field&lt;span class="o">[&lt;/span>2&lt;span class="o">]=&lt;/span>two#test&lt;span class="o">=&lt;/span>hash&lt;span class="p">&amp;amp;&lt;/span>&lt;span class="nv">chucky&lt;/span>&lt;span class="o">=&lt;/span>cheese
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h1 id="åŸºç¡€">åŸºç¡€&lt;/h1>
&lt;h2 id="uri--url">URI &amp;amp; URL&lt;/h2>
&lt;p>The difference between them is straightforward after knowing their definitions:&lt;/p>
&lt;ul>
&lt;li>&lt;strong>Uniform Resource Identifier (URI)&lt;/strong> âˆ’ a sequence of characters that allows the complete identification of any abstract or physical resource&lt;/li>
&lt;li>&lt;strong>Uniform Resource Locator (URL)&lt;/strong> âˆ’ a subset of URI that, in addition to identifying where a resource is available, describes the primary mechanism to access it&lt;/li>
&lt;/ul>
&lt;p>Every URI, regardless if itâ€™s a URL or not, follows a particular form:&lt;/p>
&lt;pre tabindex="0">&lt;code>scheme:[//authority][/path][?query][#fragment]
&lt;/code>&lt;/pre>&lt;p>Where each part is described as follows:&lt;/p>
&lt;ul>
&lt;li>&lt;strong>*scheme*&lt;/strong> âˆ’ for URLs, is the name of the protocol used to access the resource, for other URIs, is a name that refers to a specification for assigning identifiers within that scheme&lt;/li>
&lt;li>&lt;strong>authority&lt;/strong> âˆ’ an optional part comprised of user authentication information, a host and an optional port&lt;/li>
&lt;li>&lt;strong>*path*&lt;/strong> âˆ’ it serves to identify a resource within the scope of its &lt;em>scheme&lt;/em> and &lt;em>authority&lt;/em>&lt;/li>
&lt;li>&lt;strong>*query*&lt;/strong> âˆ’ additional data that, along with the &lt;em>path,&lt;/em> serves to identify a resource. For URLs, this is the query string&lt;/li>
&lt;li>&lt;strong>*fragment*&lt;/strong> âˆ’ an optional identifier to a specific part of the resource&lt;/li>
&lt;/ul>
&lt;p>&lt;strong>To easily identify if a particular URI is also a URL, we can check its scheme&lt;/strong>. Every URL has to start with any of these schemes: &lt;em>ftp&lt;/em>, &lt;em>http&lt;/em>, &lt;em>https,&lt;/em> &lt;em>gopher&lt;/em>, &lt;em>mailto&lt;/em>, &lt;em>news&lt;/em>, &lt;em>nntp&lt;/em>, &lt;em>telnet&lt;/em>, &lt;em>wais&lt;/em>, &lt;em>file&lt;/em>, or &lt;em>prospero&lt;/em>. If it doesnâ€™t start with it, then itâ€™s not a URL.&lt;/p>
&lt;h1 id="è¯·æ±‚">è¯·æ±‚&lt;/h1>
&lt;h1 id="å“åº”">å“åº”&lt;/h1>
&lt;h2 id="å¸¸ç”¨å“åº”å¤´">å¸¸ç”¨å“åº”å¤´&lt;/h2>
&lt;ul>
&lt;li>Content-Disposition&lt;/li>
&lt;/ul>
&lt;p>Content-Disposition å±žæ€§æ˜¯ä½œä¸ºå¯¹ä¸‹è½½æ–‡ä»¶çš„ä¸€ä¸ªæ ‡è¯†å­—æ®µï¼Œå±žæ€§æœ‰ä¸¤ç§ç±»åž‹: inline å°†æ–‡ä»¶å†…å®¹ç›´æŽ¥æ˜¾ç¤ºåœ¨é¡µé¢, attachment å¼¹å‡ºå¯¹è¯æ¡†è®©ç”¨æˆ·ä¸‹è½½:&lt;/p>
&lt;pre tabindex="0">&lt;code>Content-Type: image/jpeg
Content-Disposition: inline;filename=hello.jpg
Content-Description: just a small picture of me
&lt;/code>&lt;/pre>&lt;h1 id="ç¼“å­˜">ç¼“å­˜&lt;/h1>
&lt;h1 id="tcp">TCP&lt;/h1>
&lt;p>
&lt;figure >
&lt;div class="d-flex justify-content-center">
&lt;div class="w-100" >&lt;img src="https://user-images.githubusercontent.com/5803001/48391511-ea06ba00-e741-11e8-832f-ac9d994f0b21.png" alt="image" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>&lt;/p>
&lt;p>è¿™æ˜¯å› ä¸º Linux ä¸åƒå…¶ä»–æ“ä½œç³»ç»Ÿåœ¨æ”¶åˆ° SYN ä¸ºè¯¥è¿žæŽ¥ç«‹é©¬åˆ†é…ä¸€å—å†…å­˜ç©ºé—´ç”¨äºŽå­˜å‚¨ç›¸å…³çš„æ•°æ®å’Œç»“æž„ï¼Œè€Œæ˜¯å»¶è¿Ÿåˆ°æŽ¥æ”¶åˆ° client çš„ ACKï¼Œå³ä¸‰æ¬¡æ¡æ‰‹ çœŸæ­£å®ŒæˆåŽæ‰åˆ†é…ç©ºé—´ï¼Œè¿™æ˜¯ä¸ºäº†é˜²èŒƒ SYN flooding æ”»å‡»ã€‚å¦‚æžœæ˜¯è¿™ç§æƒ…å†µï¼Œé‚£ä¹ˆå°±ä¼šå‡ºçŽ° client ç«¯æœª ESTABLISHED çŠ¶æ€ï¼Œserver ä¸º SYN_RECV çŠ¶æ€ã€‚&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>CLOSED&lt;/th>
&lt;th>æ²¡æœ‰ä½¿ç”¨è¿™ä¸ªå¥—æŽ¥å­—[netstat æ— æ³•æ˜¾ç¤º closed çŠ¶æ€]&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>LISTEN&lt;/td>
&lt;td>å¥—æŽ¥å­—æ­£åœ¨ç›‘å¬è¿žæŽ¥[è°ƒç”¨ listen åŽ]&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>SYN_SENT&lt;/td>
&lt;td>å¥—æŽ¥å­—æ­£åœ¨è¯•å›¾ä¸»åŠ¨å»ºç«‹è¿žæŽ¥[å‘é€ SYN åŽè¿˜æ²¡æœ‰æ”¶åˆ° ACK]&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>SYN_RECEIVED&lt;/td>
&lt;td>æ­£åœ¨å¤„äºŽè¿žæŽ¥çš„åˆå§‹åŒæ­¥çŠ¶æ€[æ”¶åˆ°å¯¹æ–¹çš„ SYNï¼Œä½†è¿˜æ²¡æ”¶åˆ°è‡ªå·±å‘è¿‡åŽ»çš„ SYN çš„ ACK]&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>ESTABLISHED&lt;/td>
&lt;td>è¿žæŽ¥å·²å»ºç«‹&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>CLOSE_WAIT&lt;/td>
&lt;td>è¿œç¨‹å¥—æŽ¥å­—å·²ç»å…³é—­ï¼šæ­£åœ¨ç­‰å¾…å…³é—­è¿™ä¸ªå¥—æŽ¥å­—[è¢«åŠ¨å…³é—­çš„ä¸€æ–¹æ”¶åˆ° FIN]&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>FIN_WAIT_1&lt;/td>
&lt;td>å¥—æŽ¥å­—å·²å…³é—­ï¼Œæ­£åœ¨å…³é—­è¿žæŽ¥[å‘é€ FINï¼Œæ²¡æœ‰æ”¶åˆ° ACK ä¹Ÿæ²¡æœ‰æ”¶åˆ° FIN]&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>CLOSING&lt;/td>
&lt;td>å¥—æŽ¥å­—å·²å…³é—­ï¼Œè¿œç¨‹å¥—æŽ¥å­—æ­£åœ¨å…³é—­ï¼Œæš‚æ—¶æŒ‚èµ·å…³é—­ç¡®è®¤[åœ¨ FIN_WAIT_1 çŠ¶æ€ä¸‹æ”¶åˆ°è¢«åŠ¨æ–¹çš„ FIN]&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>LAST_ACK&lt;/td>
&lt;td>è¿œç¨‹å¥—æŽ¥å­—å·²å…³é—­ï¼Œæ­£åœ¨ç­‰å¾…æœ¬åœ°å¥—æŽ¥å­—çš„å…³é—­ç¡®è®¤[è¢«åŠ¨æ–¹åœ¨ CLOSE_WAIT çŠ¶æ€ä¸‹å‘é€ FIN]&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>FIN_WAIT_2&lt;/td>
&lt;td>å¥—æŽ¥å­—å·²å…³é—­ï¼Œæ­£åœ¨ç­‰å¾…è¿œç¨‹å¥—æŽ¥å­—å…³é—­[åœ¨ FIN_WAIT_1 çŠ¶æ€ä¸‹æ”¶åˆ°å‘è¿‡åŽ» FIN å¯¹åº”çš„ ACK]&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>TIME_WAIT&lt;/td>
&lt;td>è¿™ä¸ªå¥—æŽ¥å­—å·²ç»å…³é—­ï¼Œæ­£åœ¨ç­‰å¾…è¿œç¨‹å¥—æŽ¥å­—çš„å…³é—­ä¼ é€[FINã€ACKã€FINã€ACK éƒ½å®Œæ¯•ï¼Œè¿™æ˜¯ä¸»åŠ¨æ–¹çš„æœ€åŽä¸€ä¸ªçŠ¶æ€ï¼Œåœ¨è¿‡äº† 2MSL æ—¶é—´åŽå˜ä¸º CLOSED çŠ¶æ€]&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;p>TCP åè®®è§„å®šï¼Œå¯¹äºŽå·²ç»å»ºç«‹çš„è¿žæŽ¥ï¼Œç½‘ç»œåŒæ–¹è¦è¿›è¡Œå››æ¬¡æ¡æ‰‹æ‰èƒ½æˆåŠŸæ–­å¼€è¿žæŽ¥ï¼Œå¦‚æžœç¼ºå°‘äº†å…¶ä¸­æŸä¸ªæ­¥éª¤ï¼Œå°†ä¼šä½¿è¿žæŽ¥å¤„äºŽå‡æ­»çŠ¶æ€ï¼Œè¿žæŽ¥æœ¬èº«å ç”¨çš„èµ„æºä¸ä¼šè¢«é‡Šæ”¾ã€‚ç½‘ç»œæœåŠ¡å™¨ç¨‹åºè¦åŒæ—¶ç®¡ç†å¤§é‡è¿žæŽ¥ï¼Œæ‰€ä»¥å¾ˆæœ‰å¿…è¦ä¿è¯æ— ç”¨è¿žæŽ¥å®Œå…¨æ–­å¼€ï¼Œå¦åˆ™å¤§é‡åƒµæ­»çš„è¿žæŽ¥ä¼šæµªè´¹è®¸å¤šæœåŠ¡å™¨èµ„æºã€‚åœ¨ä¼—å¤š TCP çŠ¶æ€ä¸­ï¼Œæœ€å€¼å¾—æ³¨æ„çš„çŠ¶æ€æœ‰ä¸¤ä¸ªï¼šCLOSE_WAIT å’Œ TIME_WAITã€‚&lt;/p>
&lt;p>CLOSE_WAIT å¯¹æ–¹ä¸»åŠ¨å…³é—­è¿žæŽ¥æˆ–è€…ç½‘ç»œå¼‚å¸¸å¯¼è‡´è¿žæŽ¥ä¸­æ–­ï¼Œè¿™æ—¶æˆ‘æ–¹çš„çŠ¶æ€ä¼šå˜æˆ CLOSE_WAIT æ­¤æ—¶æˆ‘æ–¹è¦è°ƒç”¨ close()æ¥ä½¿å¾—è¿žæŽ¥æ­£ç¡®å…³é—­ï¼›TIME_WAIT æ˜¯æˆ‘æ–¹ä¸»åŠ¨è°ƒç”¨ close()æ–­å¼€è¿žæŽ¥ï¼Œæ”¶åˆ°å¯¹æ–¹ç¡®è®¤åŽçŠ¶æ€å˜ä¸º TIME_WAITã€‚TCP åè®®è§„å®š TIME_WAIT çŠ¶æ€ä¼šä¸€ç›´æŒç»­ 2MSL(å³ä¸¤å€çš„åˆ†æ®µæœ€å¤§ç”Ÿå­˜æœŸ)ï¼Œä»¥æ­¤æ¥ç¡®ä¿æ—§çš„è¿žæŽ¥çŠ¶æ€ä¸ä¼šå¯¹æ–°è¿žæŽ¥äº§ç”Ÿå½±å“ã€‚å¤„äºŽ TIME_WAIT çŠ¶æ€çš„è¿žæŽ¥å ç”¨çš„èµ„æºä¸ä¼šè¢«å†…æ ¸é‡Šæ”¾ï¼Œæ‰€ä»¥ä½œä¸ºæœåŠ¡å™¨ï¼Œåœ¨å¯èƒ½çš„æƒ…å†µä¸‹ï¼Œå°½é‡ä¸è¦ä¸»åŠ¨æ–­å¼€è¿žæŽ¥ï¼Œä»¥å‡å°‘ TIME_WAIT çŠ¶æ€é€ æˆçš„èµ„æºæµªè´¹ã€‚&lt;/p>
&lt;h1 id="https">HTTPS&lt;/h1>
&lt;p>HTTPS è¦ä½¿å®¢æˆ·ç«¯ä¸ŽæœåŠ¡å™¨ç«¯çš„é€šä¿¡è¿‡ç¨‹å¾—åˆ°å®‰å…¨ä¿è¯ï¼Œå¿…é¡»ä½¿ç”¨çš„å¯¹ç§°åŠ å¯†ç®—æ³•ï¼Œä½†æ˜¯åå•†å¯¹ç§°åŠ å¯†ç®—æ³•çš„è¿‡ç¨‹ï¼Œéœ€è¦ä½¿ç”¨éžå¯¹ç§°åŠ å¯†ç®—æ³•æ¥ä¿è¯å®‰å…¨ï¼Œç„¶è€Œç›´æŽ¥ä½¿ç”¨éžå¯¹ç§°åŠ å¯†çš„è¿‡ç¨‹æœ¬èº«ä¹Ÿä¸å®‰å…¨ï¼Œä¼šæœ‰ä¸­é—´äººç¯¡æ”¹å…¬é’¥çš„å¯èƒ½æ€§ï¼Œæ‰€ä»¥å®¢æˆ·ç«¯ä¸ŽæœåŠ¡å™¨ä¸ç›´æŽ¥ä½¿ç”¨å…¬é’¥ï¼Œè€Œæ˜¯ä½¿ç”¨æ•°å­—è¯ä¹¦ç­¾å‘æœºæž„é¢å‘çš„è¯ä¹¦æ¥ä¿è¯éžå¯¹ç§°åŠ å¯†è¿‡ç¨‹æœ¬èº«çš„å®‰å…¨ã€‚è¿™æ ·é€šè¿‡è¿™äº›æœºåˆ¶åå•†å‡ºä¸€ä¸ªå¯¹ç§°åŠ å¯†ç®—æ³•ï¼Œå°±æ­¤åŒæ–¹ä½¿ç”¨è¯¥ç®—æ³•è¿›è¡ŒåŠ å¯†è§£å¯†ã€‚ä»Žè€Œè§£å†³äº†å®¢æˆ·ç«¯ä¸ŽæœåŠ¡å™¨ç«¯ä¹‹é—´çš„é€šä¿¡å®‰å…¨é—®é¢˜ã€‚&lt;/p>
&lt;p>
&lt;figure >
&lt;div class="d-flex justify-content-center">
&lt;div class="w-100" >&lt;img src="https://pic.imgdb.cn/item/611143f05132923bf8cd4086.png" alt="image" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>&lt;/p>
&lt;p>
&lt;figure >
&lt;div class="d-flex justify-content-center">
&lt;div class="w-100" >&lt;img src="https://pic.imgdb.cn/item/6111440f5132923bf8cda2a9.png" alt="image" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>&lt;/p>
&lt;h1 id="http2">HTTP/2&lt;/h1>
&lt;h1 id="websocket">WebSocket&lt;/h1>
&lt;h1 id="dns">DNS&lt;/h1>
&lt;p>Dns ç³»ç»Ÿä¸»è¦æ˜¯ä¾é æƒå¨ dnsï¼Œå’Œé€’å½’ dns æ¥å·¥ä½œçš„ã€‚æƒå¨ dns åšçš„äº‹æƒ…ä¸»è¦æ˜¯ç®¡ç†æŸä¸ªæˆ–å¤šä¸ªç‰¹å®šåŸŸçš„ dns æœåŠ¡ã€‚ä¸€èˆ¬å¤§ä¸€ç‚¹çš„å…¬å¸ï¼Œéƒ½æœ‰è‡ªå·±çš„æƒå¨ dns&lt;/p>
&lt;p>æ¯”å¦‚æ‰€æœ‰â€.alipay.comâ€ç»“å°¾çš„åŸŸåéƒ½ç”± alipay æ¥ç®¡ç†&lt;/p>
&lt;p>æ‰€æœ‰â€.alibaba.comâ€ç»“å°¾çš„åŸŸåéƒ½ç”± alibaba æ¥ç®¡ç†(alipay å’Œ alibaba å®žé™…åˆæ˜¯åŒä¸€å®¶å…¬å¸æ¥ç®¡ç†)&lt;/p>
&lt;p>æ‰€æœ‰â€œ.baidu.comâ€ç»“å°¾çš„åŸŸåéƒ½ç”± baidu æ¥ç®¡ç†&lt;/p>
&lt;p>Alibaba å’Œ baidu å„ç®¡å„çš„ï¼Œæ²¡æœ‰äº¤äº’ã€‚ä¸€çº§åŸŸè¦åŽ»æ ¹ä¸Šæ³¨å†Œï¼Œåƒ com åŸŸï¼Œnet åŸŸå°±å±žäºŽä¸€çº§åŸŸ&lt;/p>
&lt;p>Com åŸŸï¼ˆä¹Ÿå°±æ˜¯æ‰€æœ‰ä»¥â€œ.comâ€ç»“å°¾çš„è€ç¥– com åŸŸï¼‰è¦åŽ»æ ¹ä¸Šæ³¨å†Œ com åŸŸçš„åŸŸåæœåŠ¡å™¨ï¼ˆnameserverï¼‰åˆ—è¡¨ã€‚&lt;/p>
&lt;p>Net åŸŸï¼ˆä¹Ÿå°±æ˜¯æ‰€æœ‰ä»¥â€.netâ€ç»“å°¾çš„è€ç¥– net åŸŸï¼‰è¦åŽ»æ ¹ä¸Šæ³¨å†Œ net åŸŸçš„åŸŸåæœåŠ¡å™¨ï¼ˆnameserverï¼‰åˆ—è¡¨ã€‚äºŒçº§åŸŸä¸€èˆ¬è¦åˆ°ä¸€çº§åŸŸä¸ŠåŽ»æ³¨å†Œ&lt;/p>
&lt;p>alibaba.com è¦åˆ° com åŸŸåŽ»æ³¨å†Œè‡ªå·±çš„åŸŸåæœåŠ¡å™¨ nameserver åˆ—è¡¨&lt;/p>
&lt;p>Baidu.com ä¹Ÿè¦åˆ° com åŸŸåŽ»æ³¨å†Œè‡ªå·±çš„åŸŸåæœåŠ¡å™¨ nameserver åˆ—è¡¨&lt;/p>
&lt;p>
&lt;figure >
&lt;div class="d-flex justify-content-center">
&lt;div class="w-100" >&lt;img src="https://user-images.githubusercontent.com/5803001/40573917-a5b3da1c-60fb-11e8-8be9-7ad479c05daa.jpg" alt="i20180520_181112_186" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>&lt;/p>
&lt;p>é€’å½’ DNSï¼ˆRecursion DNSï¼‰&lt;/p>
&lt;p>é‚£ç”¨æˆ·è®¿é—® &lt;a href="https://www.alibaba.com" target="_blank" rel="noopener">www.alibaba.com&lt;/a>ï¼Œè¯·æ±‚åˆæ˜¯å¦‚ä½•åˆ° alibaba çš„æƒå¨ dns æœåŠ¡å™¨ä¸Šé¢æ‰¾åˆ° &lt;a href="https://www.alibaba.com" target="_blank" rel="noopener">www.alibaba.com&lt;/a> çš„ ip å‘¢ï¼Ÿ&lt;/p>
&lt;p>è¿™ä¸ªæ—¶å€™é€’å½’ dnsï¼ˆæˆ‘ä»¬ä¸€èˆ¬å«åš local dnsï¼‰å°±ä»‹å…¥äº†ã€‚é€’å½’ dns ä¹Ÿå°±æ˜¯æˆ‘ä»¬å¸¸è¯´çš„ç¼“å­˜ dnsï¼Œlocal dnsï¼Œå…¬å…± dnsï¼ˆæä¾›ä¸“é—¨é€’å½’æœåŠ¡çš„ dnsï¼‰ï¼Œè¿™æ ·ä¸€æ­¥æ­¥çš„ä»Žæ ¹â€œ.â€åˆ°&amp;quot;com&amp;quot;,å†åˆ°â€œalibaba.comâ€,æœ€åŽåˆ°â€œwww.alibaba.comâ€çš„è¿‡ç¨‹å«åšé€’å½’è¿‡ç¨‹
Dns è¯·æ±‚ä¸€èˆ¬æ˜¯ udp æŠ¥æ–‡ï¼ˆä¹Ÿå¯ä»¥æ˜¯ tcp çš„æŠ¥æ–‡ï¼‰ï¼Œæ‰€ä»¥åŒæ ·ä¹Ÿæ˜¯è¦æœ‰æº ipï¼Œç›®æ ‡ ipï¼Œç­‰ç­‰è¿™äº›ç½‘ç»œæ•°æ®åŒ…çš„åº•å±‚ä¿¡æ¯ï¼Œé€’å½’è¿‡ç¨‹çš„æ¯ä¸€æ­¥ï¼Œç›®æ ‡ ip éƒ½å¿…é¡»æ˜¯å¾ˆæ˜Žç¡®çš„
å„ä¸ªåŸŸçš„ namserver å®žé™…ä¸Šæ˜¯æœ‰å¤šå°çš„ï¼Œæ¯”å¦‚æ ¹çš„ namserver çš„ ip æœ‰ 13 ä¸ªï¼Œcom çš„ namserver çš„ ip ä¹Ÿæœ‰ 13 ä¸ªï¼Œé€’å½’ dns åœ¨è¿›è¡Œé€’å½’æ—¶éœ€è¦é€‰æ‹©å…¶ä¸­ä¸€ä¸ª ip ä½œä¸ºç›®æ ‡ ip è¿›è¡Œä¸‹ä¸€æ­¥è¯·æ±‚å³å¯ï¼ˆç›®å‰ä¸»æµ dns å®žçŽ°è½¯ä»¶ï¼Œå¦‚ bind ä¼šé€‰æ‹©å»¶æ—¶æœ€å°çš„é‚£ä¸ª ip ä½œä¸ºä¸‹ä¸€æ­¥è¯·æ±‚çš„ç›®æ ‡ ipï¼‰dns ä¸­ç”¨çš„å¤šçš„æ˜¯ anycast æŠ€æœ¯ï¼Œä¸€ä¸ª ip å®žé™…ä¸Šå¯¹äº†å¾ˆå¤šä¸ªç‰©ç†æœåŠ¡å™¨ï¼Œåˆ°å„ä¸ªæƒå¨ nameserver ä¸Šï¼Œä¹Ÿæœ‰ lvsï¼Œospf ç­‰ç­‰ä¸€äº›è´Ÿè½½å‡è¡¡æŠ€æœ¯æŠŠåŒä¸€ä¸ª ip å¯¹åº”åˆ°å¤šä¸ªç‰©ç†æœåŠ¡å™¨ä¸Šé¢ã€‚
é€’å½’ dns è¿˜ä¼šæŠŠå›¾ä¸­é€’å½’ç¬¬ä¸€æ­¥ï¼Œç¬¬äºŒæ­¥ï¼Œç¬¬ä¸‰æ­¥å‘å„çº§æƒå¨ dns å‘èµ·çš„è¯·æ±‚ç»“æžœç»™ç¼“å­˜åˆ°è‡ªå·±çš„å†…å­˜ä¸­ï¼Œç›´åˆ°è¿™æ¡ç»“æžœçš„ ttl è¶…æœŸå¤±æ•ˆï¼ˆè¶…æœŸæ—¶é—´ä¸€èˆ¬ä¸ºå‡ åˆ†é’Ÿåˆ°å‡ å°æ—¶å‡ å¤©ç­‰ç­‰ï¼‰ï¼Œåœ¨è¿™ä¸ª ttl è¶…æœŸä¹‹å‰ï¼Œä»»ä½•å…¶ä»–ç”¨æˆ·å‘èµ·çš„ &lt;a href="https://www.alibaba.com" target="_blank" rel="noopener">www.alibaba.com&lt;/a> çš„ dns è¯·æ±‚ï¼Œé€’å½’ dns éƒ½ä¼šç›´æŽ¥ä»Žè‡ªå·±çš„å†…å­˜ä¸­æŠŠç¼“å­˜ç»“æžœç›´æŽ¥è¿”å›žç»™å®¢æˆ·ç«¯ï¼ˆä¸ä¼šåŽ»é€’å½’äº†ï¼‰ã€‚å¦‚æžœ ttl è¶…æœŸäº†ï¼Œæ‰ä¼šåŽ»é‡æ–°é€’å½’ã€‚&lt;/p>
&lt;p>æœ‰çš„ dns æ—¢æ˜¯æƒå¨ dnsï¼Œåˆæ˜¯é€’å½’ dnsï¼Œè¿™å¹¶ä¸å†²çªï¼Œè¿™ç§ dns åœ¨é‡åˆ°åŸŸåæ˜¯è‡ªå·±ç®¡ç†çš„åŸŸçš„åŽç¼€ç»“å°¾æ—¶ï¼Œä¼šç›´æŽ¥è¿›è¡Œåº”ç­”ï¼ˆæ— è®ºæ˜¯å¦å­˜åœ¨ç»“æžœï¼‰ï¼Œå¦‚æžœä¸æ˜¯è‡ªå·±ç®¡ç†çš„åŸŸçš„åŽç¼€åŸŸåï¼Œåˆ™è¿›è¡Œé€’å½’ï¼ŒåŒæ ·å§é€’å½’ç»“æžœè¿›è¡Œç¼“å­˜ã€‚&lt;/p></description></item><item><title>Raspberry-CheatSheet</title><link>https://ng-tech.icu/books/awesome-cheatsheets/4.infrastructure/raspberry-cheatsheet/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://ng-tech.icu/books/awesome-cheatsheets/4.infrastructure/raspberry-cheatsheet/</guid><description>&lt;h1 id="raspberry-cheatsheet--æ ‘èŽ“æ´¾èµ„æ–™ç´¢å¼•">Raspberry CheatSheet | æ ‘èŽ“æ´¾èµ„æ–™ç´¢å¼•&lt;/h1>
&lt;ul>
&lt;li>åšé€š BCM2837B0 SoCï¼Œé›†æˆå››æ ¸ ARM Cortex-A53ï¼ˆARMv8ï¼‰64 ä½@ 1.4GHz CPUï¼Œé›†æˆåšé€š Videocore-IV GPU&lt;/li>
&lt;li>å†…å­˜ï¼š1GB LPDDR2 SDRAM&lt;/li>
&lt;li>æœ‰çº¿ç½‘ç»œï¼šåƒå…†ä»¥å¤ªç½‘ï¼ˆé€šè¿‡ USB2.0 é€šé“ï¼Œæœ€å¤§åžåé‡ 300Mbpsï¼‰&lt;/li>
&lt;li>æ— çº¿ç½‘ç»œ:2.4GHz å’Œ 5GHz åŒé¢‘ Wi-Fiï¼Œæ”¯æŒ 802.11b/g/n/ac&lt;/li>
&lt;li>è“ç‰™ï¼šè“ç‰™ 4.2&amp;amp;ä½ŽåŠŸè€—è“ç‰™ï¼ˆBLEï¼‰&lt;/li>
&lt;li>å­˜å‚¨ï¼šMicro-SD&lt;/li>
&lt;li>å…¶ä»–æŽ¥å£ï¼šHDMIï¼Œ3.5mm æ¨¡æ‹ŸéŸ³é¢‘è§†é¢‘æ’å­”ï¼Œ4x USB 2.0ï¼Œä»¥å¤ªç½‘ï¼Œæ‘„åƒæœºä¸²è¡ŒæŽ¥å£ï¼ˆCSIï¼‰ï¼Œæ˜¾ç¤ºå™¨ä¸²è¡ŒæŽ¥å£ï¼ˆDSIï¼‰ï¼ŒMicroSD å¡åº§ï¼Œ40pin æ‰©å±•åŒæŽ’æ’é’ˆ&lt;/li>
&lt;li>å°ºå¯¸ï¼š82mmx 56mmx 19.5mmï¼Œ50 å…‹&lt;/li>
&lt;/ul>
&lt;h1 id="å®‰è£…ä¸Žé…ç½®">å®‰è£…ä¸Žé…ç½®&lt;/h1>
&lt;h2 id="ç³»ç»Ÿå®‰è£…">ç³»ç»Ÿå®‰è£…&lt;/h2>
&lt;p>æˆ‘ä»¬é¦–å…ˆéœ€è¦å‡†å¤‡ SD å¡å¹¶ä¸”å°†ç³»ç»Ÿçƒ§å½•åˆ°å…¶ä¸­ï¼Œåœ¨ MAC ç³»ç»Ÿä¸­ï¼Œå¯ä»¥é€šè¿‡ df å‘½ä»¤æŸ¥çœ‹åˆ†åŒºæƒ…å†µï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">$ df -lh
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Filesystem Size Used Avail Capacity iused ifree %iused Mounted on
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/dev/disk1s1 234Gi 170Gi 60Gi 75% &lt;span class="m">5903759&lt;/span> &lt;span class="m">9223372036848872048&lt;/span> 0% /
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/dev/disk1s4 234Gi 3.0Gi 60Gi 5% &lt;span class="m">3&lt;/span> &lt;span class="m">9223372036854775804&lt;/span> 0% /private/var/vm
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/dev/disk4s1 15Gi 2.4Mi 15Gi 1% &lt;span class="m">0&lt;/span> &lt;span class="m">0&lt;/span> 100% /Volumes/NO NAME
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># å¯é€‰ï¼Œæ ¼å¼åŒ–ç£ç›˜&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ sudo diskutil eraseDisk FAT32 CAM_STORE MBRFormat /dev/disk4s1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># å¦‚æžœæç¤º Resource Busyï¼Œåˆ™å¯è¿›è¡Œå¸è½½&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ diskutil unmount /dev/disk4s1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># çƒ§å†™ç³»ç»Ÿ&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ sudo dd &lt;span class="nv">bs&lt;/span>&lt;span class="o">=&lt;/span>4m &lt;span class="k">if&lt;/span>&lt;span class="o">=&lt;/span>rpi_35_v6_1_2_3_jessie_kernel_4_4_50.img &lt;span class="nv">of&lt;/span>&lt;span class="o">=&lt;/span>/dev/disk4s1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># å¸è½½ç³»ç»Ÿ&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ diskutil unmountDisk /dev/disk4s1
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="ç³»ç»Ÿé…ç½®">ç³»ç»Ÿé…ç½®&lt;/h2>
&lt;p>å¦‚æžœé€šè¿‡ ssh è¿žæŽ¥æ ‘èŽ“æ´¾å‡ºçŽ° Access denied è¿™ä¸ªæç¤ºåˆ™è¯´æ˜Ž ssh æœåŠ¡æ²¡æœ‰å¼€å¯ã€‚è¦æ‰‹åŠ¨å¼€å¯çš„è¯ï¼Œå’Œ WiFi é…ç½®ç›¸ä¼¼ï¼ŒåŒæ ·åœ¨ boot åˆ†åŒºæ–°å»ºä¸€ä¸ªæ–‡ä»¶ï¼Œç©ºç™½çš„å³å¯ï¼Œæ–‡ä»¶å‘½åä¸º sshã€‚æ³¨æ„è¦å°å†™ä¸”ä¸è¦æœ‰ä»»ä½•æ‰©å±•åã€‚&lt;/p>
&lt;p>æ ‘èŽ“æ´¾åœ¨å¯åŠ¨ä¹‹åŽä¼šåœ¨æ£€æµ‹åˆ°è¿™ä¸ªæ–‡ä»¶ä¹‹åŽè‡ªåŠ¨å¯ç”¨ ssh æœåŠ¡ã€‚éšåŽå³å¯é€šè¿‡ç™»å½•è·¯ç”±å™¨æ‰¾åˆ°æ ‘èŽ“æ´¾çš„ IP åœ°å€ï¼Œé€šè¿‡ ssh è¿žæŽ¥åˆ°æ ‘èŽ“æ´¾äº†ã€‚&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># è®¾ç½® root è´¦æˆ·å¯†ç &lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ sudo passwd root
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># è§£é” root&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ sudo passwd --unlock root
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ su
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ sudo apt-get remove python3-pip&lt;span class="p">;&lt;/span> sudo apt-get install python3-pip
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="ç½‘ç»œé…ç½®">ç½‘ç»œé…ç½®&lt;/h2>
&lt;p>ç”¨æˆ·å¯ä»¥åœ¨æœªå¯åŠ¨æ ‘èŽ“æ´¾çš„çŠ¶æ€ä¸‹å•ç‹¬ä¿®æ”¹ /boot/wpa_supplicant.conf æ–‡ä»¶é…ç½® WiFi çš„ SSID å’Œå¯†ç ï¼Œè¿™æ ·æ ‘èŽ“æ´¾å¯åŠ¨åŽä¼šè‡ªè¡Œè¯»å– wpa_supplicant.conf é…ç½®æ–‡ä»¶è¿žæŽ¥ WiFi è®¾å¤‡ã€‚&lt;/p>
&lt;pre tabindex="0">&lt;code class="language-conf" data-lang="conf">country=CN
ctrl_interface=DIR=/var/run/wpa_supplicant GROUP=netdev
update_config=1
# WiFi ä½¿ç”¨WPA/WPA2åŠ å¯†
network={
ssid=&amp;#34;WiFi-A&amp;#34;
psk=&amp;#34;12345678&amp;#34;
key_mgmt=WPA-PSK
# è¿žæŽ¥ä¼˜å…ˆçº§ï¼Œæ•°å­—è¶Šå¤§ä¼˜å…ˆçº§è¶Šé«˜ï¼ˆä¸å¯ä»¥æ˜¯è´Ÿæ•°ï¼‰
priority=1
}
network={
ssid=&amp;#34;WiFi-B&amp;#34;
psk=&amp;#34;12345678&amp;#34;
key_mgmt=WPA-PSK
priority=2
# è¿žæŽ¥éšè— WiFi æ—¶éœ€è¦æŒ‡å®šè¯¥å€¼ä¸º 1
scan_ssid=1
}
# WiFi æ²¡æœ‰å¯†ç 
network={
ssid=&amp;#34;ä½ çš„æ— çº¿ç½‘ç»œåç§°ï¼ˆssidï¼‰&amp;#34;
key_mgmt=NONE
}
# WiFi ä½¿ç”¨WEPåŠ å¯†
network={
ssid=&amp;#34;ä½ çš„æ— çº¿ç½‘ç»œåç§°ï¼ˆssidï¼‰&amp;#34;
key_mgmt=NONE
wep_key0=&amp;#34;ä½ çš„wifiå¯†ç &amp;#34;
}
&lt;/code>&lt;/pre>&lt;h1 id="gpio">GPIO&lt;/h1>
&lt;p>
&lt;figure >
&lt;div class="d-flex justify-content-center">
&lt;div class="w-100" >&lt;img src="https://imgsa.baidu.com/exp/pic/item/9304c888d43f8794e438169fd51b0ef41ad53a78.jpg" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>&lt;/p>
&lt;h2 id="è¾“å‡º">è¾“å‡º&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-py" data-lang="py">&lt;span class="line">&lt;span class="cl">&lt;span class="kn">import&lt;/span> &lt;span class="nn">RPi.GPIO&lt;/span> &lt;span class="k">as&lt;/span> &lt;span class="nn">GPIO&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">import&lt;/span> &lt;span class="nn">time&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">def&lt;/span> &lt;span class="nf">setup&lt;/span>&lt;span class="p">():&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">GPIO&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">setmode&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">GPIO&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">BOARD&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">GPIO&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">setup&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">11&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">GPIO&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">OUT&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">GPIO&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">setup&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">13&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">GPIO&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">OUT&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">GPIO&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">output&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">11&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">GPIO&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">LOW&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">GPIO&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">output&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">13&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">GPIO&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">LOW&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">def&lt;/span> &lt;span class="nf">destroy&lt;/span>&lt;span class="p">():&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">GPIO&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">output&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">11&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">GPIO&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">LOW&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">GPIO&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">output&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">13&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">GPIO&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">LOW&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">GPIO&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">setup&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">11&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">GPIO&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">IN&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">GPIO&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">setup&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">13&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">GPIO&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">IN&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">def&lt;/span> &lt;span class="nf">openLed&lt;/span>&lt;span class="p">():&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">setup&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">GPIO&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">output&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">13&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">GPIO&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">HIGH&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">for&lt;/span> &lt;span class="n">i&lt;/span> &lt;span class="ow">in&lt;/span> &lt;span class="nb">range&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">GPIO&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">output&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">11&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">GPIO&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">HIGH&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">time&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">sleep&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">GPIO&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">output&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">11&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">GPIO&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">LOW&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">time&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">sleep&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># destroy()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">GPIO&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">cleanup&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">if&lt;/span> &lt;span class="vm">__name__&lt;/span>&lt;span class="o">==&lt;/span>&lt;span class="s2">&amp;#34;__main__&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">openLed&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="è¾“å…¥">è¾“å…¥&lt;/h2>
&lt;p>
&lt;figure >
&lt;div class="d-flex justify-content-center">
&lt;div class="w-100" >&lt;img src="https://user-images.githubusercontent.com/5803001/44529356-7d6db780-a71e-11e8-8e9f-ee98249adeee.png" alt="image" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-py" data-lang="py">&lt;span class="line">&lt;span class="cl">&lt;span class="ch">#!/usr/bin/env python&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># encoding: utf-8&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">import&lt;/span> &lt;span class="nn">RPi.GPIO&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">import&lt;/span> &lt;span class="nn">time&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">R&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">G&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">B&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">15&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mi">18&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mi">14&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># æŒ‰é’®è¾“å‡ºé’ˆè„šè¿žæŽ¥çš„GPIOå£&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">btnR&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">btnG&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">btnB&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">21&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mi">20&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mi">16&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">RPi&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">GPIO&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">setmode&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">RPi&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">GPIO&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">BCM&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">RPi&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">GPIO&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">setup&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">R&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">RPi&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">GPIO&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">OUT&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">RPi&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">GPIO&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">setup&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">G&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">RPi&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">GPIO&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">OUT&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">RPi&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">GPIO&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">setup&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">B&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">RPi&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">GPIO&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">OUT&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># æŒ‰é’®è¿žæŽ¥çš„GPIOé’ˆè„šçš„æ¨¡å¼è®¾ç½®ä¸ºä¿¡å·è¾“å…¥æ¨¡å¼ï¼ŒåŒæ—¶é»˜è®¤æ‹‰é«˜GPIOå£ç”µå¹³ï¼Œ&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># å½“GNDæ²¡æœ‰è¢«æŽ¥é€šæ—¶ï¼ŒGPIOå£å¤„äºŽé«˜ç”µå¹³çŠ¶æ€ï¼Œå–çš„çš„å€¼ä¸º1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># æ³¨æ„åˆ°è¿™æ˜¯ä¸€ä¸ªå¯é€‰é¡¹ï¼Œå¦‚æžœä¸åœ¨ç¨‹åºé‡Œé¢è®¾ç½®ï¼Œé€šå¸¸çš„åšæ³•æ˜¯é€šè¿‡ä¸€ä¸ªä¸Šæ‹‰ç”µé˜»è¿žæŽ¥åˆ°VCCä¸Šä½¿ä¹‹é»˜è®¤ä¿æŒé«˜ç”µå¹³&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">RPi&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">GPIO&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">setup&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">btnR&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">RPi&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">GPIO&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">IN&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">pull_up_down&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">RPi&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">GPIO&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">PUD_UP&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">RPi&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">GPIO&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">setup&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">btnG&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">RPi&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">GPIO&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">IN&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">pull_up_down&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">RPi&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">GPIO&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">PUD_UP&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">RPi&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">GPIO&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">setup&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">btnB&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">RPi&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">GPIO&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">IN&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">pull_up_down&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">RPi&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">GPIO&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">PUD_UP&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">try&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">RPi&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">GPIO&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">output&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">R&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kc">True&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">RPi&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">GPIO&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">output&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">G&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kc">True&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">RPi&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">GPIO&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">output&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">B&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kc">True&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">while&lt;/span> &lt;span class="kc">True&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">time&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">sleep&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mf">0.01&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># æ£€æµ‹æŒ‰é’®1æ˜¯å¦è¢«æŒ‰ä¸‹ï¼Œå¦‚æžœè¢«æŒ‰ä¸‹(ä½Žç”µå¹³)ï¼Œåˆ™äº®çº¢ç¯(è¾“å‡ºä½Žç”µå¹³)ï¼Œå¦åˆ™å…³çº¢ç¯&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">RPi&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">GPIO&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">input&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">btnR&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">RPi&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">GPIO&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">output&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">R&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kc">False&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">print&lt;/span> &lt;span class="mi">1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">else&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">RPi&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">GPIO&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">output&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">R&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kc">True&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># æ£€æµ‹æŒ‰é’®2æ˜¯å¦è¢«æŒ‰ä¸‹ï¼Œå¦‚æžœè¢«æŒ‰ä¸‹(ä½Žç”µå¹³)ï¼Œåˆ™äº®ç»¿ç¯(è¾“å‡ºä½Žç”µå¹³)ï¼Œå¦åˆ™å…³ç»¿ç¯&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">RPi&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">GPIO&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">input&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">btnG&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">RPi&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">GPIO&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">output&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">G&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kc">False&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">print&lt;/span> &lt;span class="mi">2&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">else&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">RPi&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">GPIO&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">output&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">G&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kc">True&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># æ£€æµ‹æŒ‰é’®3æ˜¯å¦è¢«æŒ‰ä¸‹ï¼Œå¦‚æžœè¢«æŒ‰ä¸‹(ä½Žç”µå¹³)ï¼Œåˆ™äº®è“ç¯(è¾“å‡ºä½Žç”µå¹³)ï¼Œå¦åˆ™å…³è“ç¯&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">RPi&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">GPIO&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">input&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">btnB&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">RPi&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">GPIO&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">output&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">B&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kc">False&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">print&lt;/span> &lt;span class="mi">3&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">else&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">RPi&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">GPIO&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">output&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">B&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kc">True&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">except&lt;/span> &lt;span class="ne">KeyboardInterrupt&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">pass&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">RPi&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">GPIO&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">cleanup&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h1 id="è“ç‰™">è“ç‰™&lt;/h1>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># Mini Bluetooth Speaker&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ sudo apt-get update
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ sudo apt-get upgrade
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo apt-get install pi-bluetooth &lt;span class="o">(&lt;/span> &lt;span class="s2">&amp;#34;already the newest version&amp;#34;&lt;/span> &lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo apt-get install blueman pulseaudio pavucontrol pulseaudio-module-bluetooth
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo reboot
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">hcitool dev &lt;span class="o">(&lt;/span>look &lt;span class="k">for&lt;/span> bluetooth address of the built-in adapter&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">(&lt;/span>&lt;span class="k">if&lt;/span> don&lt;span class="err">&amp;#39;&lt;/span>t see it: sudo hciconfig
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">bluetoothctl
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># devices&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># power on&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># pairable on&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># discoverable on&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># scan on&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># devices&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Device 30:22:12:01:0C:52 Y88
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># paired-devices&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># agent on&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># default-agent&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># trust 30:22:12:01:0C:52&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># pair 30:22:12:01:0C:52&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Attempting to pair with 30:22:12:01:0C:52
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>CHG&lt;span class="o">]&lt;/span> Device 30:22:12:01:0C:52 Connected: yes
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>CHG&lt;span class="o">]&lt;/span> Device 30:22:12:01:0C:52 Modalias: usb:v05ACp022Cd0100
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>CHG&lt;span class="o">]&lt;/span> Device 30:22:12:01:0C:52 UUIDs:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 00001108-0000-1000-8000-00805f9b34fb
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 0000110b-0000-1000-8000-00805f9b34fb
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 0000110c-0000-1000-8000-00805f9b34fb
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 0000110e-0000-1000-8000-00805f9b34fb
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 0000111e-0000-1000-8000-00805f9b34fb
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 00001124-0000-1000-8000-00805f9b34fb
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 00001200-0000-1000-8000-00805f9b34fb
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>CHG&lt;span class="o">]&lt;/span> Device 30:22:12:01:0C:52 Paired: yes
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Pairing successful
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># paired-devices&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Device 30:22:12:01:0C:52 Y88
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># connect 30:22:12:01:0C:52&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Attempting to connect to 30:22:12:01:0C:52
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>CHG&lt;span class="o">]&lt;/span> Device 30:22:12:01:0C:52 Connected: yes
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># exit&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ alsamixer &lt;span class="o">(&lt;/span>&lt;span class="nb">set&lt;/span> volume to 85% - normal&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ sudo apt-get install omxplayer
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ omxplayer YouBetterRun.mp3
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-py" data-lang="py">&lt;span class="line">&lt;span class="cl">&lt;span class="kn">import&lt;/span> &lt;span class="nn">os&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">import&lt;/span> &lt;span class="nn">sys&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">import&lt;/span> &lt;span class="nn">subprocess&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">import&lt;/span> &lt;span class="nn">time&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">def&lt;/span> &lt;span class="nf">blue_it&lt;/span>&lt;span class="p">():&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">status&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">subprocess&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">call&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;ls /dev/input/event0 2&amp;gt;/dev/null&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">shell&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="kc">True&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">while&lt;/span> &lt;span class="n">status&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;Bluetooth UP&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">status&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">time&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">sleep&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">5&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">subprocess&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">call&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;mplayer http://addressToSomeStream.com&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">shell&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="kc">True&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">status&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">subprocess&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">call&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;ls /dev/input/event0 2&amp;gt;/dev/null&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">shell&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="kc">True&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">else&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">waiting&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">def&lt;/span> &lt;span class="nf">waiting&lt;/span>&lt;span class="p">():&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">subprocess&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">call&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;killall -9 pulseaudio&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">shell&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="kc">True&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">time&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">sleep&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">subprocess&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">call&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;pulseaudio --start&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">shell&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="kc">True&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">time&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">sleep&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">status&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">subprocess&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">call&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;ls /dev/input/event0 2&amp;gt;/dev/null&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">shell&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="kc">True&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">while&lt;/span> &lt;span class="n">status&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;Bluetooth DOWN&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">status&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">subprocess&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">call&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;~/scripts/autopair&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">shell&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="kc">True&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">time&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">sleep&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">15&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">status&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">subprocess&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">call&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;ls /dev/input/event0 2&amp;gt;/dev/null&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">shell&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="kc">True&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">else&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">blue_it&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">blue_it&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item></channel></rss>