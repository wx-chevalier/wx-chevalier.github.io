<!doctype html><html lang=zh><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=generator content="Wowchemy 5.5.0 for Hugo"><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=preload as=style href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap"><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap" media=print onload='this.media="all"'><meta name=google-site-verification content="google69a5cccb61297807"><meta name=baidu-site-verification content="cqmZHEleVh"><meta name=description content="Python 语法速览与实战清单 Python CheatSheet 是对于 Python 学习/实践过程中的语法与技巧进行盘点，其属于 Awesome CheatSheet 系列，致力于提升学习速度与研发效能，即可以将其当做速查手册，也可以作为轻量级的入门学习资料。本文参考了许多优秀的文章与代"><link rel=alternate hreflang=zh href=https://ng-tech.icu/books/awesome-cheatsheets/1.cs/zoo/python/python-cheatsheet/><meta name=theme-color content="#0a55a7"><link rel=stylesheet href=/css/vendor-bundle.min.c7b8d9abd591ba2253ea42747e3ac3f5.css media=print onload='this.media="all"'><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.1/styles/github.min.css crossorigin=anonymous title=hl-light media=print onload='this.media="all"'><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.1/styles/dracula.min.css crossorigin=anonymous title=hl-dark media=print onload='this.media="all"' disabled><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/instantsearch.css@7.4.5/themes/satellite-min.css integrity="sha256-TehzF/2QvNKhGQrrNpoOb2Ck4iGZ1J/DI4pkd2oUsBc=" crossorigin=anonymous><link rel=stylesheet href=/css/wowchemy.63df6ae9fc2b4cc71b83f1774d780209.css><script async src="https://www.googletagmanager.com/gtag/js?id=G-40NYXJ8823"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-40NYXJ8823")</script><script>var _hmt=_hmt||[];(function(){var e,t=document.createElement("script");t.src="https://hm.baidu.com/hm.js?56df1177bce405601b0ecdd7208f75c6",e=document.getElementsByTagName("script")[0],e.parentNode.insertBefore(t,e)})()</script><link rel=manifest href=/manifest.webmanifest><link rel=icon type=image/png href=/media/icon_hu0f7d075e895d6f5f1f5fdbc1e33dc138_10087_32x32_fill_lanczos_center_3.png><link rel=apple-touch-icon type=image/png href=/media/icon_hu0f7d075e895d6f5f1f5fdbc1e33dc138_10087_180x180_fill_lanczos_center_3.png><link rel=canonical href=https://ng-tech.icu/books/awesome-cheatsheets/1.cs/zoo/python/python-cheatsheet/><meta property="twitter:card" content="summary_large_image"><meta property="twitter:site" content="@wx-chevalier"><meta property="twitter:creator" content="@wx-chevalier"><meta property="og:site_name" content="Next-gen Tech Edu"><meta property="og:url" content="https://ng-tech.icu/books/awesome-cheatsheets/1.cs/zoo/python/python-cheatsheet/"><meta property="og:title" content="Python-CheatSheet | Next-gen Tech Edu"><meta property="og:description" content="Python 语法速览与实战清单 Python CheatSheet 是对于 Python 学习/实践过程中的语法与技巧进行盘点，其属于 Awesome CheatSheet 系列，致力于提升学习速度与研发效能，即可以将其当做速查手册，也可以作为轻量级的入门学习资料。本文参考了许多优秀的文章与代"><meta property="og:image" content="https://ng-tech.icu/media/sharing.png"><meta property="twitter:image" content="https://ng-tech.icu/media/sharing.png"><meta property="og:locale" content="zh"><meta property="article:modified_time" content="2023-03-05T15:38:23+08:00"><title>Python-CheatSheet | Next-gen Tech Edu</title></head><body id=top data-spy=scroll data-offset=70 data-target=#TableOfContents class=page-wrapper data-wc-page-id=f4634d3141bc2a6e26b7dc3bc66fb754><button onclick=topFunction() id=backTopBtn title="Go to top"><i class="fa-solid fa-circle-up" aria-hidden=true></i></button>
<script src=/js/wowchemy-init.min.14a0ed61c6dbd594b9c75193b25be179.js></script><aside class=search-modal id=search><div class=container><section class=search-header><div class="row no-gutters justify-content-between mb-3"><div class="col-6 search-title"><p>搜索</p></div><div class="col-6 col-search-close"><a class=js-search href=# aria-label=关闭><i class="fas fa-times-circle text-muted" aria-hidden=true></i></a></div></div><div id=search-box></div></section><section class=section-search-results><div id=search-hits></div><div id=search-common-queries></div></section></div></aside><div class=page-header><header class=header--fixed><nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id=navbar-main><div class=container-xl><div class="d-none d-lg-inline-flex"><a class=navbar-brand href=/>Next-gen Tech Edu</a></div><button type=button class=navbar-toggler data-toggle=collapse data-target=#navbar-content aria-controls=navbar-content aria-expanded=false aria-label=切换导航>
<span><i class="fas fa-bars"></i></span></button><div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none"><a class=navbar-brand href=/>Next-gen Tech Edu</a></div><div class="navbar-collapse main-menu-item collapse justify-content-start" id=navbar-content><ul class="navbar-nav d-md-inline-flex"><li class=nav-item><a class=nav-link href=/books-gallery><span>笔记（万篇）</span></a></li><li class=nav-item><a class=nav-link href=/#knowledge-map><span>知识图谱</span></a></li><style>.dropdown-item{display:inline-flex}</style><li class="nav-item dropdown"><a href=# class="nav-link dropdown-toggle" data-toggle=dropdown aria-haspopup=true><span>实验室</span><span class=caret></span></a><div class=dropdown-menu><a class=dropdown-item href=/galaxy-home/gh-craft><span>Craft 方块世界</span></a>
<a class=dropdown-item href=/galaxy-home/glossary-cards><span>3D 知识卡牌</span></a></div></li><style>.dropdown-item{display:inline-flex}</style><li class="nav-item dropdown"><a href=# class="nav-link dropdown-toggle" data-toggle=dropdown aria-haspopup=true><span>其他阅读渠道</span><span class=caret></span></a><div class=dropdown-menu><a class=dropdown-item href=https://zhuanlan.zhihu.com/wxyyxc1992><img style=width:16px;height:16px;display:inline-block;margin-right:8px src=https://ngte-superbed.oss-cn-beijing.aliyuncs.com/item/20230218234451.png></img><span>知乎</span></a>
<a class=dropdown-item href=https://segmentfault.com/blog/wxyyxc1992><img style=width:16px;height:16px;display:inline-block;margin-right:8px src=https://ngte-superbed.oss-cn-beijing.aliyuncs.com/item/20230219113556.png></img><span>SegmentFault</span></a>
<a class=dropdown-item href=https://zhuanlan.zhihu.com/wxyyxc1992><img style=width:16px;height:16px;display:inline-block;margin-right:8px src=https://ngte-superbed.oss-cn-beijing.aliyuncs.com/item/20230219113519.png></img><span>掘金</span></a></div></li></ul></div><ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2"><li class=nav-item><a class="nav-link js-search" href=# aria-label=搜索><i class="fas fa-search" aria-hidden=true></i></a></li><li class=nav-item><a class=nav-link href=https://github.com/wx-chevalier aria-label=GitHub><i class="fa-brands fa-github" aria-hidden=true></i></a></li><div></div><style>@media only screen and (max-width:600px){.jimmysong-template{display:none!important}}</style><li class=jimmysong-template style=color:#fff;font-size:12px><a href=https://jimmysong.io style=color:#fff>By Jimmy Song's Template</a></li></ul></div></nav></header></div><div class=page-body><link rel=stylesheet href=//unpkg.com/heti/umd/heti.min.css><div class="container-xl docs"><div class="row flex-xl-nowrap"><div class=docs-sidebar><form class="docs-search d-flex align-items-center"><button class="btn docs-toggle d-md-none p-0 mr-md-3 w-100" type=button data-toggle=collapse data-target=#docs-nav aria-controls=docs-nav aria-expanded=false aria-label="Toggle section navigation"><div class=d-flex><span class="d-md-none pl-1 flex-grow-1 text-left overflow-hidden">Python</span>
<span><i class="fas fa-chevron-down"></i></span></div></button>
<button class="form-control sidebar-search js-search d-none d-md-flex">
<i class="fas fa-search pr-2"></i>
<span class=sidebar-search-text>搜索...</span>
<span class=sidebar-search-shortcut>/</span></button></form><nav class="collapse docs-links" id=docs-nav><ul class="nav docs-sidenav"><li style=display:inline-flex><a style=cursor:pointer onclick=window.history.back()><i class="fas fa-arrow-left pr-1"></i>
Back</a>
<span>|</span>
<a href=/books/><i class="fa-solid fa-house" style=margin-right:4px></i>
Books</a></li></ul><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-id960cc797d2c07fa738ce5ae692b9c884")' href=#id960cc797d2c07fa738ce5ae692b9c884 aria-expanded=false aria-controls=id960cc797d2c07fa738ce5ae692b9c884 aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/awesome-cheatsheets/1.cs/zoo/>Zoo</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#id960cc797d2c07fa738ce5ae692b9c884 aria-expanded=false aria-controls=id960cc797d2c07fa738ce5ae692b9c884><i class="fa-solid fa-angle-down" id=caret-id960cc797d2c07fa738ce5ae692b9c884></i></a></div><ul class="nav docs-sidenav collapse show" id=id960cc797d2c07fa738ce5ae692b9c884><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-ide0fcb107315f95a304118261bafb0270")' href=#ide0fcb107315f95a304118261bafb0270 aria-expanded=false aria-controls=ide0fcb107315f95a304118261bafb0270 aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/awesome-cheatsheets/1.cs/zoo/c/>C</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#ide0fcb107315f95a304118261bafb0270 aria-expanded=false aria-controls=ide0fcb107315f95a304118261bafb0270><i class="fa-solid fa-angle-right" id=caret-ide0fcb107315f95a304118261bafb0270></i></a></div><ul class="nav docs-sidenav collapse" id=ide0fcb107315f95a304118261bafb0270><li class="child level"><a href=/books/awesome-cheatsheets/1.cs/zoo/c/cpp-cheatsheet/>CPP-CheatSheet</a></li><li class="child level"><a href=/books/awesome-cheatsheets/1.cs/zoo/c/morten-cpp-cheatsheet/>Morten-CPP-CheatSheet</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-idb2edec274d6773aa2b745ae28d9c8e89")' href=#idb2edec274d6773aa2b745ae28d9c8e89 aria-expanded=false aria-controls=idb2edec274d6773aa2b745ae28d9c8e89 aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/awesome-cheatsheets/1.cs/zoo/go/>Go</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#idb2edec274d6773aa2b745ae28d9c8e89 aria-expanded=false aria-controls=idb2edec274d6773aa2b745ae28d9c8e89><i class="fa-solid fa-angle-right" id=caret-idb2edec274d6773aa2b745ae28d9c8e89></i></a></div><ul class="nav docs-sidenav collapse" id=idb2edec274d6773aa2b745ae28d9c8e89><li class="child level"><a href=/books/awesome-cheatsheets/1.cs/zoo/go/go-cheatsheet/>Go-CheatSheet</a></li><li class="child level"><a href=/books/awesome-cheatsheets/1.cs/zoo/go/go-concurrentprogramming-cheatsheet/>Go-ConcurrentProgramming-CheatSheet</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-id097626e7138298cbf1117a47038e25b1")' href=#id097626e7138298cbf1117a47038e25b1 aria-expanded=false aria-controls=id097626e7138298cbf1117a47038e25b1 aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/awesome-cheatsheets/1.cs/zoo/java/>Java</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#id097626e7138298cbf1117a47038e25b1 aria-expanded=false aria-controls=id097626e7138298cbf1117a47038e25b1><i class="fa-solid fa-angle-right" id=caret-id097626e7138298cbf1117a47038e25b1></i></a></div><ul class="nav docs-sidenav collapse" id=id097626e7138298cbf1117a47038e25b1><li class="child level"><a href=/books/awesome-cheatsheets/1.cs/zoo/java/gradle-cheatsheet/>Gradle-CheatSheet</a></li><li class="child level"><a href=/books/awesome-cheatsheets/1.cs/zoo/java/java-cheatsheet/>Java-CheatSheet</a></li><li class="child level"><a href=/books/awesome-cheatsheets/1.cs/zoo/java/java-concurrentprogramming-cheatsheet/>Java-ConcurrentProgramming-CheatSheet</a></li><li class="child level"><a href=/books/awesome-cheatsheets/1.cs/zoo/java/java-styleguide-cheatsheet/>Java-StyleGuide-CheatSheet</a></li><li class="child level"><a href=/books/awesome-cheatsheets/1.cs/zoo/java/jvm-tuning-cheatsheet/>JVM-Tuning-CheatSheet</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-id93c46847b7800ad06ded8d50d401f062")' href=#id93c46847b7800ad06ded8d50d401f062 aria-expanded=false aria-controls=id93c46847b7800ad06ded8d50d401f062 aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/awesome-cheatsheets/1.cs/zoo/javascript/>JavaScript</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#id93c46847b7800ad06ded8d50d401f062 aria-expanded=false aria-controls=id93c46847b7800ad06ded8d50d401f062><i class="fa-solid fa-angle-right" id=caret-id93c46847b7800ad06ded8d50d401f062></i></a></div><ul class="nav docs-sidenav collapse" id=id93c46847b7800ad06ded8d50d401f062><li class="child level"><a href=/books/awesome-cheatsheets/1.cs/zoo/javascript/dart-cheatsheet/>Dart-CheatSheet</a></li><li class="child level"><a href=/books/awesome-cheatsheets/1.cs/zoo/javascript/javascript-cheatsheet/>JavaScript-CheatSheet</a></li><li class="child level"><a href=/books/awesome-cheatsheets/1.cs/zoo/javascript/javascript-cheatsheet-en/>JavaScript-CheatSheet-en</a></li><li class="child level"><a href=/books/awesome-cheatsheets/1.cs/zoo/javascript/typescript-cheatsheet/>TypeScript-CheatSheet</a></li><li class="child level"><a href=/books/awesome-cheatsheets/1.cs/zoo/javascript/v8-cheatsheet/>V8-CheatSheet</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-id4fdb6a9c1c59dd283b33aaac86f9823e")' href=#id4fdb6a9c1c59dd283b33aaac86f9823e aria-expanded=false aria-controls=id4fdb6a9c1c59dd283b33aaac86f9823e aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/awesome-cheatsheets/1.cs/zoo/python/>Python</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#id4fdb6a9c1c59dd283b33aaac86f9823e aria-expanded=false aria-controls=id4fdb6a9c1c59dd283b33aaac86f9823e><i class="fa-solid fa-angle-down" id=caret-id4fdb6a9c1c59dd283b33aaac86f9823e></i></a></div><ul class="nav docs-sidenav collapse show" id=id4fdb6a9c1c59dd283b33aaac86f9823e><li class="child level active"><a href=/books/awesome-cheatsheets/1.cs/zoo/python/python-cheatsheet/>Python-CheatSheet</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-idca4491f13e9c41dd2694c1aaab8eb462")' href=#idca4491f13e9c41dd2694c1aaab8eb462 aria-expanded=false aria-controls=idca4491f13e9c41dd2694c1aaab8eb462 aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/awesome-cheatsheets/1.cs/zoo/ruby/>Ruby</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#idca4491f13e9c41dd2694c1aaab8eb462 aria-expanded=false aria-controls=idca4491f13e9c41dd2694c1aaab8eb462><i class="fa-solid fa-angle-right" id=caret-idca4491f13e9c41dd2694c1aaab8eb462></i></a></div><ul class="nav docs-sidenav collapse" id=idca4491f13e9c41dd2694c1aaab8eb462><li class="child level"><a href=/books/awesome-cheatsheets/1.cs/zoo/ruby/ruby-cheatsheet/>Ruby-CheatSheet</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-id678b4e35fbe5b1cd15f6595bf4a17b45")' href=#id678b4e35fbe5b1cd15f6595bf4a17b45 aria-expanded=false aria-controls=id678b4e35fbe5b1cd15f6595bf4a17b45 aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/awesome-cheatsheets/1.cs/zoo/rust/>Rust</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#id678b4e35fbe5b1cd15f6595bf4a17b45 aria-expanded=false aria-controls=id678b4e35fbe5b1cd15f6595bf4a17b45><i class="fa-solid fa-angle-right" id=caret-id678b4e35fbe5b1cd15f6595bf4a17b45></i></a></div><ul class="nav docs-sidenav collapse" id=id678b4e35fbe5b1cd15f6595bf4a17b45><li class="child level"><a href=/books/awesome-cheatsheets/1.cs/zoo/rust/rust-cheatsheet/>Rust-CheatSheet</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-id8df4b58de5c2496d1e3638c0ae21af1c")' href=#id8df4b58de5c2496d1e3638c0ae21af1c aria-expanded=false aria-controls=id8df4b58de5c2496d1e3638c0ae21af1c aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/awesome-cheatsheets/1.cs/zoo/swift/>Swift</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#id8df4b58de5c2496d1e3638c0ae21af1c aria-expanded=false aria-controls=id8df4b58de5c2496d1e3638c0ae21af1c><i class="fa-solid fa-angle-right" id=caret-id8df4b58de5c2496d1e3638c0ae21af1c></i></a></div><ul class="nav docs-sidenav collapse" id=id8df4b58de5c2496d1e3638c0ae21af1c><li class="child level"><a href=/books/awesome-cheatsheets/1.cs/zoo/swift/swift-cheatsheet/>Swift-CheatSheet</a></li></ul></div></ul></div></nav></div><div class="d-none d-xl-block col-xl-2 docs-toc"><ul class="nav toc-top"><li><a href=# id=back_to_top class=docs-toc-title>目录</a></li></ul><nav id=TableOfContents><ul><li><a href=#控制台交互>控制台交互</a></li><li><a href=#模块>模块</a><ul><li><a href=#动态加载>动态加载</a></li><li><a href=#自定义模块>自定义模块</a></li></ul></li></ul><ul><li><a href=#条件选择>条件选择</a></li><li><a href=#循环遍历>循环遍历</a></li></ul><ul><li><a href=#number--数值类型>Number | 数值类型</a></li><li><a href=#布尔类型>布尔类型</a></li><li><a href=#string--字符串>String | 字符串</a><ul><li><a href=#模板字符串>模板字符串</a></li></ul></li><li><a href=#regex--正则表达式>Regex | 正则表达式</a></li></ul><ul><li><a href=#list--列表>List | 列表</a><ul><li><a href=#operation--创建增删>Operation | 创建增删</a></li><li><a href=#iteration--索引遍历>Iteration | 索引遍历</a></li><li><a href=#comprehensions--变换>Comprehensions | 变换</a></li></ul></li><li><a href=#字典类型>字典类型</a><ul><li><a href=#创建增删>创建增删</a></li><li><a href=#索引遍历>索引遍历</a></li></ul></li><li><a href=#其他序列类型>其他序列类型</a><ul><li><a href=#set>Set</a></li><li><a href=#tuple>Tuple</a></li><li><a href=#enum--枚举类型>Enum | 枚举类型</a></li></ul></li></ul><ul><li><a href=#函数定义>函数定义</a></li><li><a href=#参数>参数</a><ul><li><a href=#默认参数>默认参数</a></li><li><a href=#option-arguments--不定参数>Option Arguments | 不定参数</a></li></ul></li><li><a href=#生成器>生成器</a></li><li><a href=#装饰器>装饰器</a></li></ul><ul><li><a href=#类定义>类定义</a><ul><li><a href=#managed-attributes--受控属性>Managed Attributes | 受控属性</a></li><li><a href=#类方法与静态方法>类方法与静态方法</a></li><li><a href=#抽象类>抽象类</a></li><li><a href=#metaclass--元类>MetaClass | 元类</a></li></ul></li><li><a href=#类继承>类继承</a></li><li><a href=#对象>对象</a><ul><li><a href=#实例化>实例化</a></li><li><a href=#属性操作>属性操作</a></li><li><a href=#单例模式>单例模式</a></li></ul></li></ul><ul><li><a href=#异常处理>异常处理</a><ul><li><a href=#try>try</a></li><li><a href=#context-manager---with>Context Manager - with</a></li></ul></li><li><a href=#单元测试>单元测试</a></li></ul><ul><li><a href=#文件读写>文件读写</a><ul><li><a href=#路径处理>路径处理</a></li><li><a href=#简单文件读写>简单文件读写</a></li></ul></li><li><a href=#复杂格式文件>复杂格式文件</a><ul><li><a href=#json>JSON</a></li><li><a href=#xml>XML</a></li><li><a href=#excel>Excel</a></li></ul></li><li><a href=#文件系统>文件系统</a></li></ul><ul><li><a href=#requests>Requests</a></li></ul><ul><li><a href=#mysql>MySQL</a></li></ul></nav><div class="subscribe-module col-24 mt-1"><img src=https://ngte-superbed.oss-cn-beijing.aliyuncs.com/item/20230220172727.png alt=image title=王下邀月熊的微信公众号></div></div><main class="py-md-3 pl-md-3 docs-content col-xl-8" role=main><article class=article><h1>Python-CheatSheet</h1><div class=article-style><h1 id=python-语法速览与实战清单>Python 语法速览与实战清单</h1><p>Python CheatSheet 是对于 Python 学习/实践过程中的语法与技巧进行盘点，其属于 <a href=https://github.com/wx-chevalier/Awesome-CheatSheets/ target=_blank rel=noopener>Awesome CheatSheet</a> 系列，致力于提升学习速度与研发效能，即可以将其当做速查手册，也可以作为轻量级的入门学习资料。本文参考了许多优秀的文章与代码示范，统一声明在了 <a href=https://github.com/wx-chevalier/Awesome-Lists/blob/master/ProgrammingLanguage/Python/Python-List.md target=_blank rel=noopener>Python Links</a>；如果希望深入了解某方面的内容，可以继续阅读<a href></a>，或者前往 <a href>coding-snippets/python</a> 查看使用 Python 解决常见的数据结构与算法、设计模式、业务功能方面的代码实现。</p><p>According to its creator, Guido van Rossum, Python is a:“high-level programming language, and its core design philosophy is all about code readability and a syntax which allows programmers to express concepts in a few lines of code.”</p><p>建议使用 <a href=https://github.com/pypa/pipenv target=_blank rel=noopener>pipenv</a> 作为项目环境管理：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl><span class=c1># 创建 Python 2/3 版本的项目</span>
</span></span><span class=line><span class=cl>$ pipenv --two/--three
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 安装项目依赖，会在当前目录下生成 .venv 目录，包含 python 解释器</span>
</span></span><span class=line><span class=cl>$ pipenv install
</span></span><span class=line><span class=cl>$ pipenv install --dev
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 弹出 Virtual Env 对应的脚本环境</span>
</span></span><span class=line><span class=cl>$ pipenv shell
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 执行文件</span>
</span></span><span class=line><span class=cl>$ pipenv run python
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 定位项目路径</span>
</span></span><span class=line><span class=cl>$ pipenv --where
</span></span><span class=line><span class=cl>/Users/kennethreitz/Library/Mobile Documents/com~apple~CloudDocs/repos/kr/pipenv/test
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 定位虚拟环境路径</span>
</span></span><span class=line><span class=cl>$ pipenv --venv
</span></span><span class=line><span class=cl>/Users/kennethreitz/.local/share/virtualenvs/test-Skyy4vre
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 定位 Python 解释器路径</span>
</span></span><span class=line><span class=cl>$ pipenv --py
</span></span><span class=line><span class=cl>/Users/kennethreitz/.local/share/virtualenvs/test-Skyy4vre/bin/python
</span></span></code></pre></div><p>如果遇到编码问题，可以设置如下环境变量：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl><span class=nb>export</span> <span class=nv>LC_ALL</span><span class=o>=</span>zh_CN.UTF-8
</span></span><span class=line><span class=cl><span class=nb>export</span> <span class=nv>LANG</span><span class=o>=</span>zh_CN.UTF-8
</span></span></code></pre></div><p>如果遇到网络问题，可以尝试使用国内的镜像源：</p><pre tabindex=0><code class=language-Pipfile data-lang=Pipfile>[[source]]
url = &#34;https://mirrors.ustc.edu.cn/pypi/web/simple&#34;
verify_ssl = true
name = &#34;pypi&#34;
</code></pre><p>在这里，我们首先对于 Python 的常用语法有所了解，可以参考 <a href=./python-snippets.py>python-snippets</a>。</p><h1 id=基础语法>基础语法</h1><p>Python 是一门高阶、动态类型的多范式编程语言；定义 Python 文件的时候我们往往会先声明文件编码方式</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=c1># 指定脚本调用方式</span>
</span></span><span class=line><span class=cl><span class=c1>#!/usr/bin/env python</span>
</span></span><span class=line><span class=cl><span class=c1># 配置 utf-8 编码</span>
</span></span><span class=line><span class=cl><span class=c1># -*- coding: utf-8 -*-</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 配置其他编码</span>
</span></span><span class=line><span class=cl><span class=c1># -*- coding: &lt;encoding-name&gt; -*-</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Vim 中还可以使用如下方式</span>
</span></span><span class=line><span class=cl><span class=c1># vim:fileencoding=&lt;encoding-name&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Python 中的注释方式</span>
</span></span><span class=line><span class=cl><span class=c1># 这是一个注释</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=s1>&#39;&#39;&#39;
</span></span></span><span class=line><span class=cl><span class=s1>这是多行注释，用三个单引号
</span></span></span><span class=line><span class=cl><span class=s1>&#39;&#39;&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>这是多行注释，用三个双引号
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span></code></pre></div><p>人生苦短，请用 Python，大量功能强大的语法糖的同时让很多时候 Python 代码看上去有点像伪代码。譬如我们用 Python 实现的简易的快排相较于 Java 会显得很短小精悍</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=k>def</span> <span class=nf>quicksort</span><span class=p>(</span><span class=n>arr</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>arr</span><span class=p>)</span> <span class=o>&lt;=</span> <span class=mi>1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>arr</span>
</span></span><span class=line><span class=cl>    <span class=n>pivot</span> <span class=o>=</span> <span class=n>arr</span><span class=p>[</span><span class=nb>len</span><span class=p>(</span><span class=n>arr</span><span class=p>)</span> <span class=o>/</span> <span class=mi>2</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>left</span> <span class=o>=</span> <span class=p>[</span><span class=n>x</span> <span class=k>for</span> <span class=n>x</span> <span class=ow>in</span> <span class=n>arr</span> <span class=k>if</span> <span class=n>x</span> <span class=o>&lt;</span> <span class=n>pivot</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>middle</span> <span class=o>=</span> <span class=p>[</span><span class=n>x</span> <span class=k>for</span> <span class=n>x</span> <span class=ow>in</span> <span class=n>arr</span> <span class=k>if</span> <span class=n>x</span> <span class=o>==</span> <span class=n>pivot</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>right</span> <span class=o>=</span> <span class=p>[</span><span class=n>x</span> <span class=k>for</span> <span class=n>x</span> <span class=ow>in</span> <span class=n>arr</span> <span class=k>if</span> <span class=n>x</span> <span class=o>&gt;</span> <span class=n>pivot</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>quicksort</span><span class=p>(</span><span class=n>left</span><span class=p>)</span> <span class=o>+</span> <span class=n>middle</span> <span class=o>+</span> <span class=n>quicksort</span><span class=p>(</span><span class=n>right</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span> <span class=n>quicksort</span><span class=p>([</span><span class=mi>3</span><span class=p>,</span><span class=mi>6</span><span class=p>,</span><span class=mi>8</span><span class=p>,</span><span class=mi>10</span><span class=p>,</span><span class=mi>1</span><span class=p>,</span><span class=mi>2</span><span class=p>,</span><span class=mi>1</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=c1># Prints &#34;[1, 1, 2, 3, 6, 8, 10]&#34;</span>
</span></span></code></pre></div><h2 id=控制台交互>控制台交互</h2><p>可以根据 <code>__name__</code> 关键字来判断是否是直接使用 python 命令执行某个脚本，还是外部引用；Google 开源的 fire 也是不错的快速将某个类封装为命令行工具的框架：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=kn>import</span> <span class=nn>fire</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Calculator</span><span class=p>(</span><span class=nb>object</span><span class=p>):</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;&#34;&#34;A simple calculator class.&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>def</span> <span class=nf>double</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>number</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=mi>2</span> <span class=o>*</span> <span class=n>number</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s1>&#39;__main__&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>  <span class=n>fire</span><span class=o>.</span><span class=n>Fire</span><span class=p>(</span><span class=n>Calculator</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># python calculator.py double 10  # 20</span>
</span></span><span class=line><span class=cl><span class=c1># python calculator.py double --number=15  # 30</span>
</span></span></code></pre></div><p>Python 2 中 print 是表达式，而 Python 3 中 print 是函数；如果希望在 Python 2 中将 print 以函数方式使用，则需要自定义引入</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=kn>from</span> <span class=nn>__future__</span> <span class=kn>import</span> <span class=n>print_function</span>
</span></span></code></pre></div><p>我们也可以使用 pprint 来美化控制台输出内容：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=kn>import</span> <span class=nn>pprint</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>stuff</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;spam&#39;</span><span class=p>,</span> <span class=s1>&#39;eggs&#39;</span><span class=p>,</span> <span class=s1>&#39;lumberjack&#39;</span><span class=p>,</span> <span class=s1>&#39;knights&#39;</span><span class=p>,</span> <span class=s1>&#39;ni&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>pprint</span><span class=o>.</span><span class=n>pprint</span><span class=p>(</span><span class=n>stuff</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 自定义参数</span>
</span></span><span class=line><span class=cl><span class=n>pp</span> <span class=o>=</span> <span class=n>pprint</span><span class=o>.</span><span class=n>PrettyPrinter</span><span class=p>(</span><span class=n>depth</span><span class=o>=</span><span class=mi>6</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>tup</span> <span class=o>=</span> <span class=p>(</span><span class=s1>&#39;spam&#39;</span><span class=p>,</span> <span class=p>(</span><span class=s1>&#39;eggs&#39;</span><span class=p>,</span> <span class=p>(</span><span class=s1>&#39;lumberjack&#39;</span><span class=p>,</span> <span class=p>(</span><span class=s1>&#39;knights&#39;</span><span class=p>,</span> <span class=p>(</span><span class=s1>&#39;ni&#39;</span><span class=p>,</span> <span class=p>(</span><span class=s1>&#39;dead&#39;</span><span class=p>,(</span><span class=s1>&#39;parrot&#39;</span><span class=p>,</span> <span class=p>(</span><span class=s1>&#39;fresh fruit&#39;</span><span class=p>,))))))))</span>
</span></span><span class=line><span class=cl><span class=n>pp</span><span class=o>.</span><span class=n>pprint</span><span class=p>(</span><span class=n>tup</span><span class=p>)</span>
</span></span></code></pre></div><h2 id=模块>模块</h2><p>Python 中的模块(Module)即是 Python 源码文件，其可以导出类、函数与全局变量；当我们从某个模块导入变量时，函数名往往就是命名空间(Namespace)。</p><p>而 Python 中的包（Package）则是模块的文件夹，往往由 <code>__init__.py</code> 指明某个文件夹为包，Package 可以为某个目录下所有的文件设置统一入口</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=c1># 目录格式</span>
</span></span><span class=line><span class=cl><span class=n>someDir</span><span class=o>/</span>
</span></span><span class=line><span class=cl>	<span class=n>main</span><span class=o>.</span><span class=n>py</span>
</span></span><span class=line><span class=cl>	<span class=n>subModules</span><span class=o>/</span>
</span></span><span class=line><span class=cl>		<span class=fm>__init__</span><span class=o>.</span><span class=n>py</span>
</span></span><span class=line><span class=cl>		<span class=n>subA</span><span class=o>.</span><span class=n>pys</span>
</span></span><span class=line><span class=cl>		<span class=n>subSubModules</span><span class=o>/</span>
</span></span><span class=line><span class=cl>			<span class=fm>__init__</span><span class=o>.</span><span class=n>py</span>
</span></span><span class=line><span class=cl>			<span class=n>subSubA</span><span class=o>.</span><span class=n>py</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># subA.py</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>subAFun</span><span class=p>():</span>
</span></span><span class=line><span class=cl>	<span class=nb>print</span><span class=p>(</span><span class=s1>&#39;Hello from subAFun&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>subAFunTwo</span><span class=p>():</span>
</span></span><span class=line><span class=cl>	<span class=nb>print</span><span class=p>(</span><span class=s1>&#39;Hello from subAFunTwo&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># subSubA.py</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>subSubAFun</span><span class=p>():</span>
</span></span><span class=line><span class=cl>	<span class=nb>print</span><span class=p>(</span><span class=s1>&#39;Hello from subSubAFun&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>subSubAFunTwo</span><span class=p>():</span>
</span></span><span class=line><span class=cl>	<span class=nb>print</span><span class=p>(</span><span class=s1>&#39;Hello from subSubAFunTwo&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># __init__.py from subDir</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 将 &#39;subAFun()&#39; 与 &#39;subAFunTwo()&#39; 添加到 &#39;subModules&#39; 命名空间</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>subA</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 假设 &#39;subSubModules&#39; 中的 &#39;__init__.py&#39; 为空</span>
</span></span><span class=line><span class=cl><span class=c1># 将 &#39;subSubAFun()&#39; 与 &#39;subSubAFunTwo()&#39; 添加到 &#39;subModules&#39; 命名空间</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>subSubModules.subSubA</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 假设 &#39;subSubModules&#39; 中的 &#39;__init__.py&#39; 不为空，包含了 &#39;from .subSubA import *&#39;</span>
</span></span><span class=line><span class=cl><span class=c1># __init__.py，将 &#39;subSubAFun()&#39; 与 &#39;subSubAFunTwo()&#39; 添加到 &#39;subSubModules&#39; 命名空间</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>subSubA</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 将 &#39;subSubAFun()&#39; 与 &#39;subSubAFunTwo()&#39; 添加到 &#39;subModules&#39; 命名空间</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>subSubDir</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># main.py</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>subDir</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>subDir</span><span class=o>.</span><span class=n>subAFun</span><span class=p>()</span> <span class=c1># Hello from subAFun</span>
</span></span><span class=line><span class=cl><span class=n>subDir</span><span class=o>.</span><span class=n>subAFunTwo</span><span class=p>()</span> <span class=c1># Hello from subAFunTwo</span>
</span></span><span class=line><span class=cl><span class=n>subDir</span><span class=o>.</span><span class=n>subSubAFun</span><span class=p>()</span> <span class=c1># Hello from subSubAFun</span>
</span></span><span class=line><span class=cl><span class=n>subDir</span><span class=o>.</span><span class=n>subSubAFunTwo</span><span class=p>()</span> <span class=c1># Hello from subSubAFunTwo</span>
</span></span></code></pre></div><p><code>__init__.py</code> 中也支持使用 <code>__all__</code> 变量来声明所有需要导出的子模块:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=kn>import</span> <span class=nn>submodule1</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>submodule2</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>__all__</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;submodule1&#39;</span><span class=p>,</span> <span class=s1>&#39;submodule2&#39;</span><span class=p>]</span>
</span></span></code></pre></div><p>Python 中只能在 Package 中使用相对导入，不能在用户的应用程序中使用相对导入，因为不论是相对导入还是绝对导入，都是相当于当前模块来说的，对于用户的主应用程序，也就是入口文件，模块名总是 <code>__main__</code>, 所以用户的应用程序必须使用绝对导入，而 Package 中的导入可以使用相对导入。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=c1># python -m 运行该文件</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>.some_module</span> <span class=kn>import</span> <span class=n>some_class</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>..some_package</span> <span class=kn>import</span> <span class=n>some_function</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>.</span> <span class=kn>import</span> <span class=n>some_class</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>foo.baz</span> <span class=c1># absolute import, always OK</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>.</span> <span class=kn>import</span> <span class=o>.</span><span class=n>baz</span> <span class=c1># explicit relative import, Python &gt;= 2.5, Py3</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>baz</span> <span class=c1># implicit relative import, OK in Python &lt; 2.5, deprecated in Python &gt;= 2.5, error in Python 3</span>
</span></span></code></pre></div><h3 id=动态加载>动态加载</h3><p>Python 支持动态地加载模块文件，即从某个文件中手动初始化对象：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=k>def</span> <span class=nf>get_factory_from_template</span><span class=p>(</span><span class=n>maintype</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>path</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>BASE_DIR</span><span class=p>,</span> <span class=s1>&#39;templates&#39;</span><span class=p>,</span> <span class=n>maintype</span><span class=p>,</span> <span class=n>FACTORY_FILENAME</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>python_version_gte</span><span class=p>(</span><span class=mi>3</span><span class=p>,</span> <span class=mi>5</span><span class=p>)):</span>
</span></span><span class=line><span class=cl>        <span class=c1># Python 3.5 code in this block</span>
</span></span><span class=line><span class=cl>        <span class=kn>import</span> <span class=nn>importlib.util</span>
</span></span><span class=line><span class=cl>        <span class=n>spec</span> <span class=o>=</span> <span class=n>importlib</span><span class=o>.</span><span class=n>util</span><span class=o>.</span><span class=n>spec_from_file_location</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;</span><span class=si>{}</span><span class=s2>.factory&#34;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>maintype</span><span class=p>),</span> <span class=n>path</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>foo</span> <span class=o>=</span> <span class=n>importlib</span><span class=o>.</span><span class=n>util</span><span class=o>.</span><span class=n>module_from_spec</span><span class=p>(</span><span class=n>spec</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>spec</span><span class=o>.</span><span class=n>loader</span><span class=o>.</span><span class=n>exec_module</span><span class=p>(</span><span class=n>foo</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>foo</span>
</span></span><span class=line><span class=cl>    <span class=k>elif</span> <span class=p>(</span><span class=n>python_version_gte</span><span class=p>(</span><span class=mi>3</span><span class=p>,</span> <span class=mi>0</span><span class=p>)):</span>
</span></span><span class=line><span class=cl>        <span class=kn>from</span> <span class=nn>importlib.machinery</span> <span class=kn>import</span> <span class=n>SourceFileLoader</span>
</span></span><span class=line><span class=cl>        <span class=n>foo</span> <span class=o>=</span> <span class=n>SourceFileLoader</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;</span><span class=si>{}</span><span class=s2>.factory&#34;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>maintype</span><span class=p>),</span> <span class=n>path</span><span class=p>)</span><span class=o>.</span><span class=n>load_module</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>foo</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=c1># Python 2 code in this block</span>
</span></span><span class=line><span class=cl>        <span class=kn>import</span> <span class=nn>imp</span>
</span></span><span class=line><span class=cl>        <span class=n>foo</span> <span class=o>=</span> <span class=n>imp</span><span class=o>.</span><span class=n>load_source</span><span class=p>(</span><span class=s2>&#34;</span><span class=si>{}</span><span class=s2>.factory&#34;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>maintype</span><span class=p>),</span> <span class=n>path</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>foo</span>
</span></span></code></pre></div><h3 id=自定义模块>自定义模块</h3><p>我们可以通过定义 setup.py 来创建自定义模块:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=c1># pipenv install -e . 来安装本地目录的依赖</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>setuptools</span> <span class=kn>import</span> <span class=n>setup</span><span class=p>,</span> <span class=n>find_packages</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>setup</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>name</span> <span class=o>=</span> <span class=s2>&#34;test&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>version</span> <span class=o>=</span> <span class=s2>&#34;1.0&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>keywords</span> <span class=o>=</span> <span class=p>(</span><span class=s2>&#34;test&#34;</span><span class=p>,</span> <span class=s2>&#34;xxx&#34;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=n>description</span> <span class=o>=</span> <span class=s2>&#34;eds sdk&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>long_description</span> <span class=o>=</span> <span class=s2>&#34;eds sdk for python&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>license</span> <span class=o>=</span> <span class=s2>&#34;MIT Licence&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>url</span> <span class=o>=</span> <span class=s2>&#34;http://test.com&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>author</span> <span class=o>=</span> <span class=s2>&#34;test&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>author_email</span> <span class=o>=</span> <span class=s2>&#34;test@gmail.com&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>packages</span> <span class=o>=</span> <span class=n>find_packages</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>    <span class=n>include_package_data</span> <span class=o>=</span> <span class=kc>True</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>platforms</span> <span class=o>=</span> <span class=s2>&#34;any&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>install_requires</span> <span class=o>=</span> <span class=p>[],</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>scripts</span> <span class=o>=</span> <span class=p>[],</span>
</span></span><span class=line><span class=cl>    <span class=n>entry_points</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;console_scripts&#39;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;test = test.help:main&#39;</span>
</span></span><span class=line><span class=cl>        <span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span></code></pre></div><h1 id=表达式与控制流>表达式与控制流</h1><h2 id=条件选择>条件选择</h2><p>Python 中使用 if、elif、els#e 来进行基础的条件选择操作：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=k>if</span> <span class=n>x</span> <span class=o>&lt;</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>     <span class=n>x</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>     <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;Negative changed to zero&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl> <span class=k>elif</span> <span class=n>x</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>     <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;Zero&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl> <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>     <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;More&#39;</span><span class=p>)</span>
</span></span></code></pre></div><p>Python 同样支持 ternary conditional operator，并且提供了</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=n>a</span> <span class=k>if</span> <span class=n>condition</span> <span class=k>else</span> <span class=n>b</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>x</span> <span class=o>=</span> <span class=p>[</span><span class=kc>True</span><span class=p>,</span> <span class=kc>True</span><span class=p>,</span> <span class=kc>False</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=nb>any</span><span class=p>(</span><span class=n>x</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;At least one True&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=nb>all</span><span class=p>(</span><span class=n>x</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Not one False&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=nb>any</span><span class=p>(</span><span class=n>x</span><span class=p>)</span> <span class=ow>and</span> <span class=ow>not</span> <span class=nb>all</span><span class=p>(</span><span class=n>x</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;At least one True and one False&#34;</span><span class=p>)</span>
</span></span></code></pre></div><p>也可以使用 Tuple 来实现类似的效果：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=c1># test 需要返回 True 或者 False</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=n>falseValue</span><span class=p>,</span> <span class=n>trueValue</span><span class=p>)[</span><span class=n>test</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 更安全的做法是进行强制判断</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=n>falseValue</span><span class=p>,</span> <span class=n>trueValue</span><span class=p>)[</span><span class=n>test</span> <span class=o>==</span> <span class=kc>True</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 或者使用 bool 类型转换函数</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=n>falseValue</span><span class=p>,</span> <span class=n>trueValue</span><span class=p>)[</span><span class=nb>bool</span><span class=p>(</span><span class=o>&lt;</span><span class=n>expression</span><span class=o>&gt;</span><span class=p>)]</span>
</span></span></code></pre></div><h2 id=循环遍历>循环遍历</h2><p>for-in 可以用来遍历数组与字典：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=n>words</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;cat&#39;</span><span class=p>,</span> <span class=s1>&#39;window&#39;</span><span class=p>,</span> <span class=s1>&#39;defenestrate&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>w</span> <span class=ow>in</span> <span class=n>words</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>w</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=n>w</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 使用数组访问操作符，能够迅速地生成数组的副本</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>w</span> <span class=ow>in</span> <span class=n>words</span><span class=p>[:]:</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>w</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mi>6</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>words</span><span class=o>.</span><span class=n>insert</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=n>w</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># words -&gt; [&#39;defenestrate&#39;, &#39;cat&#39;, &#39;window&#39;, &#39;defenestrate&#39;]</span>
</span></span></code></pre></div><p>如果我们希望使用数字序列进行遍历，可以使用 Python 内置的 <code>range</code> 函数：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=n>a</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;Mary&#39;</span><span class=p>,</span> <span class=s1>&#39;had&#39;</span><span class=p>,</span> <span class=s1>&#39;a&#39;</span><span class=p>,</span> <span class=s1>&#39;little&#39;</span><span class=p>,</span> <span class=s1>&#39;lamb&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>a</span><span class=p>)):</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>i</span><span class=p>,</span> <span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>])</span>
</span></span></code></pre></div><p><a href=https://github.com/tqdm/tqdm target=_blank rel=noopener>tqdm</a> 是不错的命令行中的进度指示器：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=kn>from</span> <span class=nn>tqdm</span> <span class=kn>import</span> <span class=n>tqdm</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=n>tqdm</span><span class=p>(</span><span class=nb>range</span><span class=p>(</span><span class=mi>10000</span><span class=p>)):</span>
</span></span><span class=line><span class=cl>    <span class=o>...</span>
</span></span></code></pre></div><h1 id=基本数据类型>基本数据类型</h1><p>可以使用内建函数进行强制类型转换(Casting )</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=nb>int</span><span class=p>(</span><span class=nb>str</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>float</span><span class=p>(</span><span class=nb>str</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>str</span><span class=p>(</span><span class=nb>int</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>str</span><span class=p>(</span><span class=nb>float</span><span class=p>)</span>
</span></span></code></pre></div><p>isinstance 方法用于判断某个对象是否源自某个类</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=n>ex</span> <span class=o>=</span> <span class=mi>10</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 判断是否为 int 类型</span>
</span></span><span class=line><span class=cl><span class=nb>isinstance</span><span class=p>(</span><span class=n>ex</span><span class=p>,</span><span class=nb>int</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># isinstance 也支持同时判断多个类型</span>
</span></span><span class=line><span class=cl><span class=c1># 如下代码判断是否为数组</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>is_array</span><span class=p>(</span><span class=n>var</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>var</span><span class=p>,</span> <span class=p>(</span><span class=nb>list</span><span class=p>,</span> <span class=nb>tuple</span><span class=p>))</span>
</span></span></code></pre></div><h2 id=number--数值类型>Number | 数值类型</h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=n>x</span> <span class=o>=</span> <span class=mi>3</span>
</span></span><span class=line><span class=cl><span class=nb>print</span> <span class=nb>type</span><span class=p>(</span><span class=n>x</span><span class=p>)</span> <span class=c1># Prints &#34;&lt;type &#39;int&#39;&gt;&#34;</span>
</span></span><span class=line><span class=cl><span class=nb>print</span> <span class=n>x</span>       <span class=c1># Prints &#34;3&#34;</span>
</span></span><span class=line><span class=cl><span class=nb>print</span> <span class=n>x</span> <span class=o>+</span> <span class=mi>1</span>   <span class=c1># Addition; prints &#34;4&#34;</span>
</span></span><span class=line><span class=cl><span class=nb>print</span> <span class=n>x</span> <span class=o>-</span> <span class=mi>1</span>   <span class=c1># Subtraction; prints &#34;2&#34;</span>
</span></span><span class=line><span class=cl><span class=nb>print</span> <span class=n>x</span> <span class=o>*</span> <span class=mi>2</span>   <span class=c1># Multiplication; prints &#34;6&#34;</span>
</span></span><span class=line><span class=cl><span class=nb>print</span> <span class=n>x</span> <span class=o>**</span> <span class=mi>2</span>  <span class=c1># Exponentiation; prints &#34;9&#34;</span>
</span></span><span class=line><span class=cl><span class=n>x</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=nb>print</span> <span class=n>x</span>  <span class=c1># Prints &#34;4&#34;</span>
</span></span><span class=line><span class=cl><span class=n>x</span> <span class=o>*=</span> <span class=mi>2</span>
</span></span><span class=line><span class=cl><span class=nb>print</span> <span class=n>x</span>  <span class=c1># Prints &#34;8&#34;</span>
</span></span><span class=line><span class=cl><span class=n>y</span> <span class=o>=</span> <span class=mf>2.5</span>
</span></span><span class=line><span class=cl><span class=nb>print</span> <span class=nb>type</span><span class=p>(</span><span class=n>y</span><span class=p>)</span> <span class=c1># Prints &#34;&lt;type &#39;float&#39;&gt;&#34;</span>
</span></span><span class=line><span class=cl><span class=nb>print</span> <span class=n>y</span><span class=p>,</span> <span class=n>y</span> <span class=o>+</span> <span class=mi>1</span><span class=p>,</span> <span class=n>y</span> <span class=o>*</span> <span class=mi>2</span><span class=p>,</span> <span class=n>y</span> <span class=o>**</span> <span class=mi>2</span> <span class=c1># Prints &#34;2.5 3.5 5.0 6.25&#34;</span>
</span></span></code></pre></div><p>Python2 中默认使用传统除法，即自动四舍五入；而 Python 3 中默认使用精确除法：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=c1># 传统除法 如果是整数除法则执行地板除，如果是浮点数除法则执行精确除法。</span>
</span></span><span class=line><span class=cl><span class=o>&gt;</span> <span class=mi>1</span><span class=o>/</span><span class=mi>2</span>
</span></span><span class=line><span class=cl><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=o>&gt;</span> <span class=mf>1.0</span><span class=o>/</span><span class=mf>2.0</span>
</span></span><span class=line><span class=cl><span class=mf>0.5</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 精确除法 除法总是会返回真实的商，不管操作数是整形还是浮点型。</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ‘//’无论是否整除返回的都是 int，而且是去尾整除</span>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;&gt;</span> <span class=mi>5</span><span class=o>//</span><span class=mi>2</span>
</span></span><span class=line><span class=cl><span class=mi>2</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 向上取整，返回值为 int</span>
</span></span><span class=line><span class=cl><span class=o>&gt;</span> <span class=n>math</span><span class=o>.</span><span class=n>ceil</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 向下取整，返回值为 int</span>
</span></span><span class=line><span class=cl><span class=o>&gt;</span> <span class=n>math</span><span class=o>.</span><span class=n>floor</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 返回值为 int</span>
</span></span><span class=line><span class=cl><span class=o>&gt;</span> <span class=nb>round</span><span class=p>()</span>
</span></span></code></pre></div><h2 id=布尔类型>布尔类型</h2><p>Python 提供了常见的逻辑操作符，不过需要注意的是 Python 中并没有使用 &&、|| 等，而是直接使用了英文单词。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=n>t</span> <span class=o>=</span> <span class=kc>True</span>
</span></span><span class=line><span class=cl><span class=n>f</span> <span class=o>=</span> <span class=kc>False</span>
</span></span><span class=line><span class=cl><span class=nb>print</span> <span class=nb>type</span><span class=p>(</span><span class=n>t</span><span class=p>)</span> <span class=c1># Prints &#34;&lt;type &#39;bool&#39;&gt;&#34;</span>
</span></span><span class=line><span class=cl><span class=nb>print</span> <span class=n>t</span> <span class=ow>and</span> <span class=n>f</span> <span class=c1># Logical AND; prints &#34;False&#34;</span>
</span></span><span class=line><span class=cl><span class=nb>print</span> <span class=n>t</span> <span class=ow>or</span> <span class=n>f</span>  <span class=c1># Logical OR; prints &#34;True&#34;</span>
</span></span><span class=line><span class=cl><span class=nb>print</span> <span class=ow>not</span> <span class=n>t</span>   <span class=c1># Logical NOT; prints &#34;False&#34;</span>
</span></span><span class=line><span class=cl><span class=nb>print</span> <span class=n>t</span> <span class=o>!=</span> <span class=n>f</span>  <span class=c1># Logical XOR; prints &#34;True&#34;</span>
</span></span></code></pre></div><h2 id=string--字符串>String | 字符串</h2><p>Python 2 中支持 Ascii 码的 str() 类型，独立的 unicode() 类型，没有 byte 类型；而 Python 3 中默认的字符串为 utf-8 类型，并且包含了 byte 与 bytearray 两个字节类型：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=nb>type</span><span class=p>(</span><span class=s2>&#34;Guido&#34;</span><span class=p>)</span> <span class=c1># string type is str in python2</span>
</span></span><span class=line><span class=cl><span class=c1># &lt;type &#39;str&#39;&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 使用 __future__ 中提供的模块来降级使用 Unicode</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>__future__</span> <span class=kn>import</span> <span class=n>unicode_literals</span>
</span></span><span class=line><span class=cl><span class=nb>type</span><span class=p>(</span><span class=s2>&#34;Guido&#34;</span><span class=p>)</span> <span class=c1># string type become unicode</span>
</span></span><span class=line><span class=cl><span class=c1># &lt;type &#39;unicode&#39;&gt;</span>
</span></span></code></pre></div><p>Python 字符串支持分片、模板字符串等常见操作</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=n>var1</span> <span class=o>=</span> <span class=s1>&#39;Hello World!&#39;</span>
</span></span><span class=line><span class=cl><span class=n>var2</span> <span class=o>=</span> <span class=s2>&#34;Python Programming&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span> <span class=s2>&#34;var1[0]: &#34;</span><span class=p>,</span> <span class=n>var1</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nb>print</span> <span class=s2>&#34;var2[1:5]: &#34;</span><span class=p>,</span> <span class=n>var2</span><span class=p>[</span><span class=mi>1</span><span class=p>:</span><span class=mi>5</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=c1># var1[0]:  H</span>
</span></span><span class=line><span class=cl><span class=c1># var2[1:5]:  ytho</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span> <span class=s2>&#34;My name is </span><span class=si>%s</span><span class=s2> and weight is </span><span class=si>%d</span><span class=s2> kg!&#34;</span> <span class=o>%</span> <span class=p>(</span><span class=s1>&#39;Zara&#39;</span><span class=p>,</span> <span class=mi>21</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># My name is Zara and weight is 21 kg!</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=nb>str</span><span class=p>[</span><span class=mi>0</span><span class=p>:</span><span class=mi>4</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nb>len</span><span class=p>(</span><span class=nb>str</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>string</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=s2>&#34;-&#34;</span><span class=p>,</span> <span class=s2>&#34; &#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;,&#34;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=nb>list</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>str</span><span class=o>.</span><span class=n>find</span><span class=p>(</span><span class=s2>&#34;,&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>str</span><span class=o>.</span><span class=n>index</span><span class=p>(</span><span class=s2>&#34;,&#34;</span><span class=p>)</span>   <span class=c1># same, but raises IndexError</span>
</span></span><span class=line><span class=cl><span class=nb>str</span><span class=o>.</span><span class=n>count</span><span class=p>(</span><span class=s2>&#34;,&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>str</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s2>&#34;,&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>str</span><span class=o>.</span><span class=n>lower</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=nb>str</span><span class=o>.</span><span class=n>upper</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=nb>str</span><span class=o>.</span><span class=n>title</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>str</span><span class=o>.</span><span class=n>lstrip</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=nb>str</span><span class=o>.</span><span class=n>rstrip</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=nb>str</span><span class=o>.</span><span class=n>strip</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>str</span><span class=o>.</span><span class=n>islower</span><span class=p>()</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=c1># 移除所有的特殊字符</span>
</span></span><span class=line><span class=cl><span class=n>re</span><span class=o>.</span><span class=n>sub</span><span class=p>(</span><span class=s1>&#39;[^A-Za-z0-9]+&#39;</span><span class=p>,</span> <span class=s1>&#39;&#39;</span><span class=p>,</span> <span class=n>mystring</span><span class=p>)</span>
</span></span></code></pre></div><p>如果需要判断是否包含某个子字符串，或者搜索某个字符串的下标</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=c1># in 操作符可以判断字符串</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=s2>&#34;blah&#34;</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>somestring</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>continue</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># find 可以搜索下标</span>
</span></span><span class=line><span class=cl><span class=n>s</span> <span class=o>=</span> <span class=s2>&#34;This be a string&#34;</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=n>s</span><span class=o>.</span><span class=n>find</span><span class=p>(</span><span class=s2>&#34;is&#34;</span><span class=p>)</span> <span class=o>==</span> <span class=o>-</span><span class=mi>1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span> <span class=s2>&#34;No &#39;is&#39; here!&#34;</span>
</span></span><span class=line><span class=cl><span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span> <span class=s2>&#34;Found &#39;is&#39; in the string.&#34;</span>
</span></span></code></pre></div><h3 id=模板字符串>模板字符串</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=kn>import</span> <span class=nn>datetime</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>name</span> <span class=o>=</span> <span class=s1>&#39;Fred&#39;</span>
</span></span><span class=line><span class=cl><span class=n>age</span> <span class=o>=</span> <span class=mi>50</span>
</span></span><span class=line><span class=cl><span class=n>anniversary</span> <span class=o>=</span> <span class=n>datetime</span><span class=o>.</span><span class=n>date</span><span class=p>(</span><span class=mi>1991</span><span class=p>,</span> <span class=mi>10</span><span class=p>,</span> <span class=mi>12</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>x</span> <span class=o>=</span> <span class=n>a</span> <span class=o>+</span> <span class=n>b</span>
</span></span><span class=line><span class=cl><span class=n>x</span> <span class=o>=</span> <span class=s1>&#39;</span><span class=si>%s</span><span class=s1>, </span><span class=si>%s</span><span class=s1>!&#39;</span> <span class=o>%</span> <span class=p>(</span><span class=n>name</span><span class=p>,</span> <span class=n>age</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>x</span> <span class=o>=</span> <span class=s1>&#39;name: </span><span class=si>%s</span><span class=s1>; age: </span><span class=si>%d</span><span class=s1>&#39;</span> <span class=o>%</span> <span class=p>(</span><span class=n>name</span><span class=p>,</span> <span class=n>age</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>x</span> <span class=o>=</span> <span class=s1>&#39;</span><span class=si>{}</span><span class=s1>, </span><span class=si>{}</span><span class=s1>!&#39;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>name</span><span class=p>,</span> <span class=n>age</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>x</span> <span class=o>=</span> <span class=s1>&#39;name: </span><span class=si>{}</span><span class=s1>; age: </span><span class=si>{}</span><span class=s1>&#39;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>name</span><span class=p>,</span> <span class=n>age</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=sa>f</span><span class=s1>&#39;My name is </span><span class=si>{</span><span class=n>name</span><span class=si>}</span><span class=s1>, my age next year is </span><span class=si>{</span><span class=n>age</span><span class=o>+</span><span class=mi>1</span><span class=si>}</span><span class=s1>, my anniversary is </span><span class=si>{</span><span class=n>anniversary</span><span class=si>:</span><span class=s1>%A, %B %d, %Y</span><span class=si>}</span><span class=s1>.&#39;</span>
</span></span><span class=line><span class=cl><span class=c1># &#39;My name is Fred, my age next year is 51, my anniversary is Saturday, October 12, 1991.&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=sa>f</span><span class=s1>&#39;He said his name is </span><span class=si>{</span><span class=n>name</span><span class=si>!r}</span><span class=s1>.&#39;</span>
</span></span><span class=line><span class=cl><span class=c1># &#34;He said his name is &#39;Fred&#39;.&#34;</span>
</span></span></code></pre></div><h2 id=regex--正则表达式>Regex | 正则表达式</h2><ul><li>Symbols</li></ul><table><thead><tr><th>Term</th><th>Description</th></tr></thead><tbody><tr><td>.</td><td>(period) Matches any single character, except for line breaks.</td></tr><tr><td>*</td><td>Matches the preceding expression 0 or more times.</td></tr><tr><td>+</td><td>Matches the preceding expression 1 or more times.</td></tr><tr><td>?</td><td>Preceding expression is optional (Matches 0 or 1 times).</td></tr><tr><td>^</td><td>Matches the beginning of the string.</td></tr><tr><td>$</td><td>Matches the end of the string.</td></tr></tbody></table><ul><li>Character groups</li></ul><table><thead><tr><th>Term</th><th>Description</th></tr></thead><tbody><tr><td>\d</td><td>Matches any single digit character.</td></tr><tr><td>\w</td><td>Matches any word character (alphanumeric & underscore).</td></tr><tr><td>[XYZ]</td><td>Character Set: Matches any single character from the character within the brackets. You can also do a range such as [A-Z]</td></tr><tr><td>[XYZ]+</td><td>Matches one or more of any of the characters in the set.</td></tr><tr><td>[^a-z]</td><td>Inside a character set, the ^ is used for negation. In this example, match anything that is NOT an uppercase letter.</td></tr></tbody></table><ul><li>Flags:
There are five optional flags. They can be used separately or together and are placed after the closing slash. Example: /[A-Z]/g I’ll only be introducing 2 here.</li></ul><table><thead><tr><th>Term</th><th>Description</th></tr></thead><tbody><tr><td>g</td><td>Global search</td></tr><tr><td>i</td><td>case insensitive search</td></tr></tbody></table><ul><li>Advanced</li></ul><table><thead><tr><th>Term</th><th>Description</th></tr></thead><tbody><tr><td>(x)</td><td>Capturing Parenthesis: Matches x and remembers it so we can use it later.</td></tr><tr><td>(?:x)</td><td>Non-capturing Parenthesis: Matches x and does not remembers it.</td></tr><tr><td>x(?=y)</td><td>Lookahead: Matches x only if it is followed by y.</td></tr></tbody></table><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=kn>import</span> <span class=nn>re</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 判断是否匹配</span>
</span></span><span class=line><span class=cl><span class=n>re</span><span class=o>.</span><span class=n>match</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;^[aeiou]&#39;</span><span class=p>,</span> <span class=nb>str</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 以第二个参数指定的字符替换原字符串中内容</span>
</span></span><span class=line><span class=cl><span class=n>re</span><span class=o>.</span><span class=n>sub</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;^[aeiou]&#39;</span><span class=p>,</span> <span class=s1>&#39;?&#39;</span><span class=p>,</span> <span class=nb>str</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>re</span><span class=o>.</span><span class=n>sub</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;(xyz)&#39;</span><span class=p>,</span> <span class=sa>r</span><span class=s1>&#39;\1&#39;</span><span class=p>,</span> <span class=nb>str</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 编译生成独立的正则表达式对象</span>
</span></span><span class=line><span class=cl><span class=n>expr</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=n>compile</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;^...$&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>expr</span><span class=o>.</span><span class=n>match</span><span class=p>(</span><span class=o>...</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>expr</span><span class=o>.</span><span class=n>sub</span><span class=p>(</span><span class=o>...</span><span class=p>)</span>
</span></span></code></pre></div><p>如果我们需要提取出正则表达式中的匹配组，则需要理由正则表达式的中括号与 group 方法:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=n>title_search</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=n>search</span><span class=p>(</span><span class=s1>&#39;&lt;title&gt;(.*)&lt;/title&gt;&#39;</span><span class=p>,</span> <span class=n>html</span><span class=p>,</span> <span class=n>re</span><span class=o>.</span><span class=n>IGNORECASE</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=n>title_search</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>title</span> <span class=o>=</span> <span class=n>title_search</span><span class=o>.</span><span class=n>group</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span></span></code></pre></div><p>下面列举了常见的表达式使用场景</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=c1># 检测是否为 HTML 标签</span>
</span></span><span class=line><span class=cl><span class=n>re</span><span class=o>.</span><span class=n>search</span><span class=p>(</span><span class=s1>&#39;&lt;[^/&gt;][^&gt;]*&gt;&#39;</span><span class=p>,</span> <span class=s1>&#39;&lt;a href=&#34;#label&#34;&gt;&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 常见的用户名密码</span>
</span></span><span class=line><span class=cl><span class=n>re</span><span class=o>.</span><span class=n>match</span><span class=p>(</span><span class=s1>&#39;^[a-zA-Z0-9-_]{3,16}$&#39;</span><span class=p>,</span> <span class=s1>&#39;Foo&#39;</span><span class=p>)</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl><span class=n>re</span><span class=o>.</span><span class=n>match</span><span class=p>(</span><span class=s1>&#39;^\w|[-_]{3,16}$&#39;</span><span class=p>,</span> <span class=s1>&#39;Foo&#39;</span><span class=p>)</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Email</span>
</span></span><span class=line><span class=cl><span class=n>re</span><span class=o>.</span><span class=n>match</span><span class=p>(</span><span class=s1>&#39;^([a-z0-9_\.-]+)@([\da-z\.-]+)\.([a-z\.]{2,6})$&#39;</span><span class=p>,</span> <span class=s1>&#39;hello.world@example.com&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Url</span>
</span></span><span class=line><span class=cl><span class=n>exp</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=n>compile</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;&#39;&#39;^(https?:\/\/)? # match http or https
</span></span></span><span class=line><span class=cl><span class=s1>                ([\da-z\.-]+)            # match domain
</span></span></span><span class=line><span class=cl><span class=s1>                \.([a-z\.]{2,6})         # match domain
</span></span></span><span class=line><span class=cl><span class=s1>                ([\/\w \.-]*)\/?$        # match api or file
</span></span></span><span class=line><span class=cl><span class=s1>                &#39;&#39;&#39;</span><span class=p>,</span> <span class=n>re</span><span class=o>.</span><span class=n>X</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>exp</span><span class=o>.</span><span class=n>match</span><span class=p>(</span><span class=s1>&#39;www.google.com&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># IP 地址</span>
</span></span><span class=line><span class=cl><span class=n>exp</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=n>compile</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;&#39;&#39;^(?:(?:25[0-5]
</span></span></span><span class=line><span class=cl><span class=s1>                     |2[0-4][0-9]
</span></span></span><span class=line><span class=cl><span class=s1>                     |[1]?[0-9][0-9]?)\.)</span><span class=si>{3}</span><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1>                     (?:25[0-5]
</span></span></span><span class=line><span class=cl><span class=s1>                     |2[0-4][0-9]
</span></span></span><span class=line><span class=cl><span class=s1>                     |[1]?[0-9][0-9]?)$&#39;&#39;&#39;</span><span class=p>,</span> <span class=n>re</span><span class=o>.</span><span class=n>X</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>exp</span><span class=o>.</span><span class=n>match</span><span class=p>(</span><span class=s1>&#39;192.168.1.1&#39;</span><span class=p>)</span>
</span></span></code></pre></div><h1 id=集合类型>集合类型</h1><h2 id=list--列表>List | 列表</h2><h3 id=operation--创建增删>Operation | 创建增删</h3><p>list 是基础的序列类型：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=n>l</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl><span class=n>l</span> <span class=o>=</span> <span class=nb>list</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 使用字符串的 split 方法，可以将字符串转化为列表</span>
</span></span><span class=line><span class=cl><span class=nb>str</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s2>&#34;.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 如果需要将数组拼装为字符串，则可以使用 join</span>
</span></span><span class=line><span class=cl><span class=n>list1</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;1&#39;</span><span class=p>,</span> <span class=s1>&#39;2&#39;</span><span class=p>,</span> <span class=s1>&#39;3&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>str1</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>list1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 如果是数值数组，则需要先进行转换</span>
</span></span><span class=line><span class=cl><span class=n>list1</span> <span class=o>=</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>str1</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span> <span class=k>for</span> <span class=n>e</span> <span class=ow>in</span> <span class=n>list1</span><span class=p>)</span>
</span></span></code></pre></div><p>可以使用 append 与 extend 向数组中插入元素或者进行数组连接</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=n>x</span> <span class=o>=</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>x</span><span class=o>.</span><span class=n>append</span><span class=p>([</span><span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>])</span> <span class=c1># [1, 2, 3, [4, 5]]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>x</span><span class=o>.</span><span class=n>extend</span><span class=p>([</span><span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>])</span> <span class=c1># [1, 2, 3, 4, 5]，注意 extend 返回值为 None</span>
</span></span></code></pre></div><p>可以使用 pop、slices、del、remove 等移除列表中元素：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=n>myList</span> <span class=o>=</span> <span class=p>[</span><span class=mi>10</span><span class=p>,</span><span class=mi>20</span><span class=p>,</span><span class=mi>30</span><span class=p>,</span><span class=mi>40</span><span class=p>,</span><span class=mi>50</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 弹出第二个元素</span>
</span></span><span class=line><span class=cl><span class=n>myList</span><span class=o>.</span><span class=n>pop</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span> <span class=c1># 20</span>
</span></span><span class=line><span class=cl><span class=c1># myList: myList.pop(1)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 如果不加任何参数，则默认弹出最后一个元素</span>
</span></span><span class=line><span class=cl><span class=n>myList</span><span class=o>.</span><span class=n>pop</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 使用 slices 来删除某个元素</span>
</span></span><span class=line><span class=cl><span class=n>a</span> <span class=o>=</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>6</span> <span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>index</span> <span class=o>=</span> <span class=mi>3</span> <span class=c1># Only Positive index</span>
</span></span><span class=line><span class=cl><span class=n>a</span> <span class=o>=</span> <span class=n>a</span><span class=p>[:</span><span class=n>index</span><span class=p>]</span> <span class=o>+</span> <span class=n>a</span><span class=p>[</span><span class=n>index</span><span class=o>+</span><span class=mi>1</span> <span class=p>:]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 根据下标删除元素</span>
</span></span><span class=line><span class=cl><span class=n>myList</span> <span class=o>=</span> <span class=p>[</span><span class=mi>10</span><span class=p>,</span><span class=mi>20</span><span class=p>,</span><span class=mi>30</span><span class=p>,</span><span class=mi>40</span><span class=p>,</span><span class=mi>50</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>rmovIndxNo</span> <span class=o>=</span> <span class=mi>3</span>
</span></span><span class=line><span class=cl><span class=k>del</span> <span class=n>myList</span><span class=p>[</span><span class=n>rmovIndxNo</span><span class=p>]</span> <span class=c1># myList: [10, 20, 30, 50]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 使用 remove 方法，直接根据元素删除</span>
</span></span><span class=line><span class=cl><span class=n>letters</span> <span class=o>=</span> <span class=p>[</span><span class=s2>&#34;a&#34;</span><span class=p>,</span> <span class=s2>&#34;b&#34;</span><span class=p>,</span> <span class=s2>&#34;c&#34;</span><span class=p>,</span> <span class=s2>&#34;d&#34;</span><span class=p>,</span> <span class=s2>&#34;e&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>numbers</span><span class=o>.</span><span class=n>remove</span><span class=p>(</span><span class=n>numbers</span><span class=p>[</span><span class=mi>1</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=o>*</span><span class=n>letters</span><span class=p>)</span> <span class=c1># used a * to make it unpack you don&#39;t have to</span>
</span></span></code></pre></div><h3 id=iteration--索引遍历>Iteration | 索引遍历</h3><p>你可以使用基本的 for 循环来遍历数组中的元素，就像下面介个样纸</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=n>animals</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;cat&#39;</span><span class=p>,</span> <span class=s1>&#39;dog&#39;</span><span class=p>,</span> <span class=s1>&#39;monkey&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>animal</span> <span class=ow>in</span> <span class=n>animals</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span> <span class=n>animal</span>
</span></span><span class=line><span class=cl><span class=c1># Prints &#34;cat&#34;, &#34;dog&#34;, &#34;monkey&#34;, each on its own line.</span>
</span></span></code></pre></div><p>如果你在循环的同时也希望能够获取到当前元素下标，可以使用 enumerate 函数</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=n>animals</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;cat&#39;</span><span class=p>,</span> <span class=s1>&#39;dog&#39;</span><span class=p>,</span> <span class=s1>&#39;monkey&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>idx</span><span class=p>,</span> <span class=n>animal</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>animals</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span> <span class=s1>&#39;#</span><span class=si>%d</span><span class=s1>: </span><span class=si>%s</span><span class=s1>&#39;</span> <span class=o>%</span> <span class=p>(</span><span class=n>idx</span> <span class=o>+</span> <span class=mi>1</span><span class=p>,</span> <span class=n>animal</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># Prints &#34;#1: cat&#34;, &#34;#2: dog&#34;, &#34;#3: monkey&#34;, each on its own line</span>
</span></span></code></pre></div><p>Python 也支持切片(Slices):</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=n>nums</span> <span class=o>=</span> <span class=nb>range</span><span class=p>(</span><span class=mi>5</span><span class=p>)</span>    <span class=c1># range is a built-in function that creates a list of integers</span>
</span></span><span class=line><span class=cl><span class=nb>print</span> <span class=n>nums</span>         <span class=c1># Prints &#34;[0, 1, 2, 3, 4]&#34;</span>
</span></span><span class=line><span class=cl><span class=nb>print</span> <span class=n>nums</span><span class=p>[</span><span class=mi>2</span><span class=p>:</span><span class=mi>4</span><span class=p>]</span>    <span class=c1># Get a slice from index 2 to 4 (exclusive); prints &#34;[2, 3]&#34;</span>
</span></span><span class=line><span class=cl><span class=nb>print</span> <span class=n>nums</span><span class=p>[</span><span class=mi>2</span><span class=p>:]</span>     <span class=c1># Get a slice from index 2 to the end; prints &#34;[2, 3, 4]&#34;</span>
</span></span><span class=line><span class=cl><span class=nb>print</span> <span class=n>nums</span><span class=p>[:</span><span class=mi>2</span><span class=p>]</span>     <span class=c1># Get a slice from the start to index 2 (exclusive); prints &#34;[0, 1]&#34;</span>
</span></span><span class=line><span class=cl><span class=nb>print</span> <span class=n>nums</span><span class=p>[:]</span>      <span class=c1># Get a slice of the whole list; prints [&#34;0, 1, 2, 3, 4]&#34;</span>
</span></span><span class=line><span class=cl><span class=nb>print</span> <span class=n>nums</span><span class=p>[:</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span>    <span class=c1># Slice indices can be negative; prints [&#34;0, 1, 2, 3]&#34;</span>
</span></span><span class=line><span class=cl><span class=n>nums</span><span class=p>[</span><span class=mi>2</span><span class=p>:</span><span class=mi>4</span><span class=p>]</span> <span class=o>=</span> <span class=p>[</span><span class=mi>8</span><span class=p>,</span> <span class=mi>9</span><span class=p>]</span> <span class=c1># Assign a new sublist to a slice</span>
</span></span><span class=line><span class=cl><span class=nb>print</span> <span class=n>nums</span>         <span class=c1># Prints &#34;[0, 1, 8, 9, 4]&#34;</span>
</span></span></code></pre></div><h3 id=comprehensions--变换>Comprehensions | 变换</h3><p>Python 中同样可以使用 map, reduce, filter，其中 map 用于变换数组</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=c1># 使用 map 对数组中的每个元素计算平方</span>
</span></span><span class=line><span class=cl><span class=n>items</span> <span class=o>=</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>squared</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=nb>map</span><span class=p>(</span><span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>x</span><span class=o>**</span><span class=mi>2</span><span class=p>,</span> <span class=n>items</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># map 支持函数以数组方式连接使用</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>multiply</span><span class=p>(</span><span class=n>x</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>(</span><span class=n>x</span><span class=o>*</span><span class=n>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>add</span><span class=p>(</span><span class=n>x</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>(</span><span class=n>x</span><span class=o>+</span><span class=n>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>funcs</span> <span class=o>=</span> <span class=p>[</span><span class=n>multiply</span><span class=p>,</span> <span class=n>add</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>5</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>value</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=nb>map</span><span class=p>(</span><span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>x</span><span class=p>(</span><span class=n>i</span><span class=p>),</span> <span class=n>funcs</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>value</span><span class=p>)</span>
</span></span></code></pre></div><p>reduce 用于进行归纳计算</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=c1># reduce 将数组中的值进行归纳</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>functools</span> <span class=kn>import</span> <span class=n>reduce</span>
</span></span><span class=line><span class=cl><span class=n>product</span> <span class=o>=</span> <span class=n>reduce</span><span class=p>((</span><span class=k>lambda</span> <span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>:</span> <span class=n>x</span> <span class=o>*</span> <span class=n>y</span><span class=p>),</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Output: 24</span>
</span></span></code></pre></div><p>filter 则可以对数组进行过滤</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=n>number_list</span> <span class=o>=</span> <span class=nb>range</span><span class=p>(</span><span class=o>-</span><span class=mi>5</span><span class=p>,</span> <span class=mi>5</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>less_than_zero</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=nb>filter</span><span class=p>(</span><span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>x</span> <span class=o>&lt;</span> <span class=mi>0</span><span class=p>,</span> <span class=n>number_list</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>less_than_zero</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Output: [-5, -4, -3, -2, -1]</span>
</span></span></code></pre></div><h2 id=字典类型>字典类型</h2><h3 id=创建增删>创建增删</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=n>d</span> <span class=o>=</span> <span class=p>{</span><span class=s1>&#39;cat&#39;</span><span class=p>:</span> <span class=s1>&#39;cute&#39;</span><span class=p>,</span> <span class=s1>&#39;dog&#39;</span><span class=p>:</span> <span class=s1>&#39;furry&#39;</span><span class=p>}</span>  <span class=c1># 创建新的字典</span>
</span></span><span class=line><span class=cl><span class=nb>print</span> <span class=n>d</span><span class=p>[</span><span class=s1>&#39;cat&#39;</span><span class=p>]</span>       <span class=c1># 字典不支持点(Dot)运算符取值</span>
</span></span></code></pre></div><p>如果需要合并两个或者多个字典类型：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=c1># python 3.5</span>
</span></span><span class=line><span class=cl><span class=n>z</span> <span class=o>=</span> <span class=p>{</span><span class=o>**</span><span class=n>x</span><span class=p>,</span> <span class=o>**</span><span class=n>y</span><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># python 2.7</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>merge_dicts</span><span class=p>(</span><span class=o>*</span><span class=n>dict_args</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>    Given any number of dicts, shallow copy and merge into a new dict,
</span></span></span><span class=line><span class=cl><span class=s2>    precedence goes to key value pairs in latter dicts.
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>result</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>dictionary</span> <span class=ow>in</span> <span class=n>dict_args</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>result</span><span class=o>.</span><span class=n>update</span><span class=p>(</span><span class=n>dictionary</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>result</span>
</span></span></code></pre></div><h3 id=索引遍历>索引遍历</h3><p>可以根据键来直接进行元素访问</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=c1># Python 中对于访问不存在的键会抛出 KeyError 异常，需要先行判断或者使用 get</span>
</span></span><span class=line><span class=cl><span class=nb>print</span> <span class=s1>&#39;cat&#39;</span> <span class=ow>in</span> <span class=n>d</span>     <span class=c1># Check if a dictionary has a given key; prints &#34;True&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 如果直接使用 [] 来取值，需要先确定键的存在，否则会抛出异常</span>
</span></span><span class=line><span class=cl><span class=nb>print</span> <span class=n>d</span><span class=p>[</span><span class=s1>&#39;monkey&#39;</span><span class=p>]</span>  <span class=c1># KeyError: &#39;monkey&#39; not a key of d</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 使用 get 函数则可以设置默认值</span>
</span></span><span class=line><span class=cl><span class=nb>print</span> <span class=n>d</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;monkey&#39;</span><span class=p>,</span> <span class=s1>&#39;N/A&#39;</span><span class=p>)</span>  <span class=c1># Get an element with a default; prints &#34;N/A&#34;</span>
</span></span><span class=line><span class=cl><span class=nb>print</span> <span class=n>d</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;fish&#39;</span><span class=p>,</span> <span class=s1>&#39;N/A&#39;</span><span class=p>)</span>    <span class=c1># Get an element with a default; prints &#34;wet&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>d</span><span class=o>.</span><span class=n>keys</span><span class=p>()</span> <span class=c1># 使用 keys 方法可以获取所有的键</span>
</span></span></code></pre></div><p>Python 还提供了部分特殊的字典类型：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=kn>from</span> <span class=nn>collections</span> <span class=kn>import</span> <span class=n>OrderedDict</span><span class=p>,</span> <span class=n>Counter</span>
</span></span><span class=line><span class=cl><span class=c1># Remembers the order the keys are added!</span>
</span></span><span class=line><span class=cl><span class=n>x</span> <span class=o>=</span> <span class=n>OrderedDict</span><span class=p>(</span><span class=n>a</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>b</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span> <span class=n>c</span><span class=o>=</span><span class=mi>3</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># Counts the frequency of each character</span>
</span></span><span class=line><span class=cl><span class=n>y</span> <span class=o>=</span> <span class=n>Counter</span><span class=p>(</span><span class=s2>&#34;Hello World!&#34;</span><span class=p>)</span>
</span></span></code></pre></div><p>可以使用 for-in 来遍历数组</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=c1># 遍历键</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>key</span> <span class=ow>in</span> <span class=n>d</span><span class=p>:</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 比前一种方式慢</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>k</span> <span class=ow>in</span> <span class=nb>dict</span><span class=o>.</span><span class=n>keys</span><span class=p>():</span> <span class=o>...</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 直接遍历值</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>value</span> <span class=ow>in</span> <span class=nb>dict</span><span class=o>.</span><span class=n>itervalues</span><span class=p>():</span> <span class=o>...</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Python 2.x 中遍历键值</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>key</span><span class=p>,</span> <span class=n>value</span> <span class=ow>in</span> <span class=n>d</span><span class=o>.</span><span class=n>iteritems</span><span class=p>():</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Python 3.x 中遍历键值</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>key</span><span class=p>,</span> <span class=n>value</span> <span class=ow>in</span> <span class=n>d</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
</span></span></code></pre></div><h2 id=其他序列类型>其他序列类型</h2><h3 id=set>Set</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=c1># Same as {&#34;a&#34;, &#34;b&#34;,&#34;c&#34;}</span>
</span></span><span class=line><span class=cl><span class=n>normal_set</span> <span class=o>=</span> <span class=nb>set</span><span class=p>([</span><span class=s2>&#34;a&#34;</span><span class=p>,</span> <span class=s2>&#34;b&#34;</span><span class=p>,</span><span class=s2>&#34;c&#34;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Adding an element to normal set is fine</span>
</span></span><span class=line><span class=cl><span class=n>normal_set</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=s2>&#34;d&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 判断 Set 大小</span>
</span></span><span class=line><span class=cl><span class=nb>len</span><span class=p>(</span><span class=n>s</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 判断元素是否存在于 Set 中</span>
</span></span><span class=line><span class=cl><span class=n>x</span> <span class=ow>in</span> <span class=n>s</span>
</span></span><span class=line><span class=cl><span class=n>x</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>s</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 集合间运算符</span>
</span></span><span class=line><span class=cl><span class=n>s</span><span class=o>.</span><span class=n>issubset</span><span class=p>(</span><span class=n>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>s</span><span class=o>.</span><span class=n>issuperset</span><span class=p>(</span><span class=n>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>s</span><span class=o>.</span><span class=n>union</span><span class=p>(</span><span class=n>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>s</span><span class=o>.</span><span class=n>intersection</span><span class=p>(</span><span class=n>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>s</span><span class=o>.</span><span class=n>difference</span><span class=p>(</span><span class=n>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>s</span><span class=o>.</span><span class=n>symmetric_difference</span><span class=p>(</span><span class=n>t</span><span class=p>)</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=c1># A frozen set</span>
</span></span><span class=line><span class=cl><span class=n>frozen_set</span> <span class=o>=</span> <span class=nb>frozenset</span><span class=p>([</span><span class=s2>&#34;e&#34;</span><span class=p>,</span> <span class=s2>&#34;f&#34;</span><span class=p>,</span> <span class=s2>&#34;g&#34;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Frozen Set&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>frozen_set</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Uncommenting below line would cause error as</span>
</span></span><span class=line><span class=cl><span class=c1># we are trying to add element to a frozen set</span>
</span></span><span class=line><span class=cl><span class=c1># frozen_set.add(&#34;h&#34;)</span>
</span></span></code></pre></div><h3 id=tuple>Tuple</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=c1># 修改 Tuple 中的值</span>
</span></span><span class=line><span class=cl><span class=n>t</span> <span class=o>=</span> <span class=p>(</span><span class=s1>&#39;275&#39;</span><span class=p>,</span> <span class=s1>&#39;54000&#39;</span><span class=p>,</span> <span class=s1>&#39;0.0&#39;</span><span class=p>,</span> <span class=s1>&#39;5000.0&#39;</span><span class=p>,</span> <span class=s1>&#39;0.0&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>lst</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=n>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>lst</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=s1>&#39;300&#39;</span>
</span></span><span class=line><span class=cl><span class=n>t</span> <span class=o>=</span> <span class=nb>tuple</span><span class=p>(</span><span class=n>lst</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=enum--枚举类型>Enum | 枚举类型</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=k>class</span> <span class=nc>Enum</span><span class=p>(</span><span class=nb>set</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__getattr__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>name</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>name</span> <span class=ow>in</span> <span class=bp>self</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>name</span>
</span></span><span class=line><span class=cl>        <span class=k>raise</span> <span class=ne>AttributeError</span>
</span></span></code></pre></div><h1 id=函数>函数</h1><h2 id=函数定义>函数定义</h2><p>Python 中的函数使用 def 关键字进行定义，譬如</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=k>def</span> <span class=nf>sign</span><span class=p>(</span><span class=n>x</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>x</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=s1>&#39;positive&#39;</span>
</span></span><span class=line><span class=cl>    <span class=k>elif</span> <span class=n>x</span> <span class=o>&lt;</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=s1>&#39;negative&#39;</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=s1>&#39;zero&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>x</span> <span class=ow>in</span> <span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span> <span class=n>sign</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># Prints &#34;negative&#34;, &#34;zero&#34;, &#34;positive&#34;</span>
</span></span></code></pre></div><p>Python 支持运行时创建动态函数，也即是所谓的 lambda 函数：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=k>def</span> <span class=nf>f</span><span class=p>(</span><span class=n>x</span><span class=p>):</span> <span class=k>return</span> <span class=n>x</span><span class=o>**</span><span class=mi>2</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 等价于</span>
</span></span><span class=line><span class=cl><span class=n>g</span> <span class=o>=</span> <span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>x</span><span class=o>**</span><span class=mi>2</span>
</span></span></code></pre></div><p>lambda 表达式是 Python 函数式开发的重要基石，其方便实现 Partial Function 等模式；典型的 lambda 函数声明如下：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>x</span><span class=o>**</span><span class=mi>2</span> <span class=o>+</span> <span class=mi>2</span><span class=o>*</span><span class=n>x</span> <span class=o>-</span> <span class=mi>5</span>
</span></span></code></pre></div><p>典型的用法譬如自定义的 filter 函数中：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>mult3</span> <span class=o>=</span> <span class=nb>filter</span><span class=p>(</span><span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>x</span> <span class=o>%</span> <span class=mi>3</span> <span class=o>==</span> <span class=mi>0</span><span class=p>,</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>6</span><span class=p>,</span> <span class=mi>7</span><span class=p>,</span> <span class=mi>8</span><span class=p>,</span> <span class=mi>9</span><span class=p>])</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>filterfunc</span><span class=p>(</span><span class=n>x</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>x</span> <span class=o>%</span> <span class=mi>3</span> <span class=o>==</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>mult3</span> <span class=o>=</span> <span class=nb>filter</span><span class=p>(</span><span class=n>filterfunc</span><span class=p>,</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>6</span><span class=p>,</span> <span class=mi>7</span><span class=p>,</span> <span class=mi>8</span><span class=p>,</span> <span class=mi>9</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>mult3</span> <span class=o>=</span> <span class=p>[</span><span class=n>x</span> <span class=k>for</span> <span class=n>x</span> <span class=ow>in</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>6</span><span class=p>,</span> <span class=mi>7</span><span class=p>,</span> <span class=mi>8</span><span class=p>,</span> <span class=mi>9</span><span class=p>]</span> <span class=k>if</span> <span class=n>x</span> <span class=o>%</span> <span class=mi>3</span> <span class=o>==</span> <span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>range</span><span class=p>(</span><span class=mi>3</span><span class=p>,</span><span class=mi>10</span><span class=p>,</span><span class=mi>3</span><span class=p>)</span>
</span></span></code></pre></div><h2 id=参数>参数</h2><h3 id=默认参数>默认参数</h3><h3 id=option-arguments--不定参数>Option Arguments | 不定参数</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=k>def</span> <span class=nf>example</span><span class=p>(</span><span class=n>a</span><span class=p>,</span> <span class=n>b</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>):</span>
</span></span><span class=line><span class=cl>  <span class=nb>print</span> <span class=n>a</span><span class=p>,</span> <span class=n>b</span>
</span></span><span class=line><span class=cl>  <span class=nb>print</span> <span class=n>args</span>
</span></span><span class=line><span class=cl>  <span class=nb>print</span> <span class=n>kwargs</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>example</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=s2>&#34;var&#34;</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=n>word</span><span class=o>=</span><span class=s2>&#34;hello&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># 1 var</span>
</span></span><span class=line><span class=cl><span class=c1># (2, 3)</span>
</span></span><span class=line><span class=cl><span class=c1># {&#39;word&#39;: &#39;hello&#39;}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>a_tuple</span> <span class=o>=</span> <span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>a_dict</span> <span class=o>=</span> <span class=p>{</span><span class=s2>&#34;1&#34;</span><span class=p>:</span><span class=mi>1</span><span class=p>,</span> <span class=s2>&#34;2&#34;</span><span class=p>:</span><span class=mi>2</span><span class=p>,</span> <span class=s2>&#34;3&#34;</span><span class=p>:</span><span class=mi>3</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=n>example</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=s2>&#34;var&#34;</span><span class=p>,</span> <span class=o>*</span><span class=n>a_tuple</span><span class=p>,</span> <span class=o>**</span><span class=n>a_dict</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># 1 var</span>
</span></span><span class=line><span class=cl><span class=c1># (1, 2, 3, 4, 5)</span>
</span></span><span class=line><span class=cl><span class=c1># {&#39;1&#39;: 1, &#39;2&#39;: 2, &#39;3&#39;: 3}</span>
</span></span></code></pre></div><p>对于不定参数的调用，同样可以使用 <code>**</code> 运算符：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=n>func</span><span class=p>(</span><span class=o>**</span><span class=p>{</span><span class=s1>&#39;type&#39;</span><span class=p>:</span><span class=s1>&#39;Event&#39;</span><span class=p>})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 等价于</span>
</span></span><span class=line><span class=cl><span class=n>func</span><span class=p>(</span><span class=nb>type</span><span class=o>=</span><span class=s1>&#39;Event&#39;</span><span class=p>)</span>
</span></span></code></pre></div><h2 id=生成器>生成器</h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=k>def</span> <span class=nf>simple_generator_function</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=k>yield</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>    <span class=k>yield</span> <span class=mi>2</span>
</span></span><span class=line><span class=cl>    <span class=k>yield</span> <span class=mi>3</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>value</span> <span class=ow>in</span> <span class=n>simple_generator_function</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>value</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 输出结果</span>
</span></span><span class=line><span class=cl><span class=c1># 1</span>
</span></span><span class=line><span class=cl><span class=c1># 2</span>
</span></span><span class=line><span class=cl><span class=c1># 3</span>
</span></span><span class=line><span class=cl><span class=n>our_generator</span> <span class=o>=</span> <span class=n>simple_generator_function</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=nb>next</span><span class=p>(</span><span class=n>our_generator</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># 1</span>
</span></span><span class=line><span class=cl><span class=nb>next</span><span class=p>(</span><span class=n>our_generator</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># 2</span>
</span></span><span class=line><span class=cl><span class=nb>next</span><span class=p>(</span><span class=n>our_generator</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1>#3</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 生成器典型的使用场景譬如无限数组的迭代</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>get_primes</span><span class=p>(</span><span class=n>number</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span> <span class=kc>True</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>is_prime</span><span class=p>(</span><span class=n>number</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=k>yield</span> <span class=n>number</span>
</span></span><span class=line><span class=cl>        <span class=n>number</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span></code></pre></div><h2 id=装饰器>装饰器</h2><p>装饰器是非常有用的设计模式</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=c1># 简单装饰器</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>functools</span> <span class=kn>import</span> <span class=n>wraps</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>decorator</span><span class=p>(</span><span class=n>func</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=nd>@wraps</span><span class=p>(</span><span class=n>func</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>wrapper</span><span class=p>(</span><span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;wrap function&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>func</span><span class=p>(</span><span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>wrapper</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@decorator</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>example</span><span class=p>(</span><span class=o>*</span><span class=n>a</span><span class=p>,</span> <span class=o>**</span><span class=n>kw</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>pass</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>example</span><span class=o>.</span><span class=vm>__name__</span>  <span class=c1># attr of function preserve</span>
</span></span><span class=line><span class=cl><span class=c1># &#39;example&#39;</span>
</span></span><span class=line><span class=cl><span class=c1># Decorator</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 带输入值的装饰器</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>functools</span> <span class=kn>import</span> <span class=n>wraps</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>decorator_with_argument</span><span class=p>(</span><span class=n>val</span><span class=p>):</span>
</span></span><span class=line><span class=cl>  <span class=k>def</span> <span class=nf>decorator</span><span class=p>(</span><span class=n>func</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=nd>@wraps</span><span class=p>(</span><span class=n>func</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>wrapper</span><span class=p>(</span><span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>):</span>
</span></span><span class=line><span class=cl>      <span class=nb>print</span> <span class=s2>&#34;Val is </span><span class=si>{0}</span><span class=s2>&#34;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>val</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=k>return</span> <span class=n>func</span><span class=p>(</span><span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>wrapper</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=n>decorator</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@decorator_with_argument</span><span class=p>(</span><span class=mi>10</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>example</span><span class=p>():</span>
</span></span><span class=line><span class=cl>  <span class=nb>print</span> <span class=s2>&#34;This is example function.&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>example</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=c1># Val is 10</span>
</span></span><span class=line><span class=cl><span class=c1># This is example function.</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 等价于</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>example</span><span class=p>():</span>
</span></span><span class=line><span class=cl>  <span class=nb>print</span> <span class=s2>&#34;This is example function.&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>example</span> <span class=o>=</span> <span class=n>decorator_with_argument</span><span class=p>(</span><span class=mi>10</span><span class=p>)(</span><span class=n>example</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>example</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=c1># Val is 10</span>
</span></span><span class=line><span class=cl><span class=c1># This is example function.</span>
</span></span></code></pre></div><h1 id=类与对象>类与对象</h1><h2 id=类定义>类定义</h2><p>Python 中对于类的定义也很直接</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=k>class</span> <span class=nc>Greeter</span><span class=p>(</span><span class=nb>object</span><span class=p>):</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Constructor</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>name</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>name</span> <span class=o>=</span> <span class=n>name</span>  <span class=c1># Create an instance variable</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Instance method</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>greet</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>loud</span><span class=o>=</span><span class=kc>False</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>loud</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span> <span class=s1>&#39;HELLO, </span><span class=si>%s</span><span class=s1>!&#39;</span> <span class=o>%</span> <span class=bp>self</span><span class=o>.</span><span class=n>name</span><span class=o>.</span><span class=n>upper</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span> <span class=s1>&#39;Hello, </span><span class=si>%s</span><span class=s1>&#39;</span> <span class=o>%</span> <span class=bp>self</span><span class=o>.</span><span class=n>name</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>g</span> <span class=o>=</span> <span class=n>Greeter</span><span class=p>(</span><span class=s1>&#39;Fred&#39;</span><span class=p>)</span>  <span class=c1># Construct an instance of the Greeter class</span>
</span></span><span class=line><span class=cl><span class=n>g</span><span class=o>.</span><span class=n>greet</span><span class=p>()</span>            <span class=c1># Call an instance method; prints &#34;Hello, Fred&#34;</span>
</span></span><span class=line><span class=cl><span class=n>g</span><span class=o>.</span><span class=n>greet</span><span class=p>(</span><span class=n>loud</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>   <span class=c1># Call an instance method; prints &#34;HELLO, FRED!&#34;</span>
</span></span></code></pre></div><h3 id=managed-attributes--受控属性>Managed Attributes | 受控属性</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=c1># property、setter、deleter 可以用于复写点方法</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Example</span><span class=p>(</span><span class=nb>object</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>value</span><span class=p>):</span>
</span></span><span class=line><span class=cl>       <span class=bp>self</span><span class=o>.</span><span class=n>_val</span> <span class=o>=</span> <span class=n>value</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@property</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>val</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_val</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@val.setter</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>val</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>value</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=ow>not</span> <span class=n>isintance</span><span class=p>(</span><span class=n>value</span><span class=p>,</span> <span class=nb>int</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=k>raise</span> <span class=ne>TypeError</span><span class=p>(</span><span class=s2>&#34;Expected int&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>_val</span> <span class=o>=</span> <span class=n>value</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@val.deleter</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>val</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>del</span> <span class=bp>self</span><span class=o>.</span><span class=n>_val</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@property</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>square3</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=mi>2</span><span class=o>**</span><span class=mi>3</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>ex</span> <span class=o>=</span> <span class=n>Example</span><span class=p>(</span><span class=mi>123</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ex</span><span class=o>.</span><span class=n>val</span> <span class=o>=</span> <span class=s2>&#34;str&#34;</span>
</span></span><span class=line><span class=cl><span class=c1># Traceback (most recent call last):</span>
</span></span><span class=line><span class=cl><span class=c1>#   File &#34;&#34;, line 1, in</span>
</span></span><span class=line><span class=cl><span class=c1>#   File &#34;test.py&#34;, line 12, in val</span>
</span></span><span class=line><span class=cl><span class=c1>#     raise TypeError(&#34;Expected int&#34;)</span>
</span></span><span class=line><span class=cl><span class=c1># TypeError: Expected int</span>
</span></span></code></pre></div><h3 id=类方法与静态方法>类方法与静态方法</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=k>class</span> <span class=nc>example</span><span class=p>(</span><span class=nb>object</span><span class=p>):</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=nd>@classmethod</span>
</span></span><span class=line><span class=cl>  <span class=k>def</span> <span class=nf>clsmethod</span><span class=p>(</span><span class=bp>cls</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span> <span class=s2>&#34;I am classmethod&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=nd>@staticmethod</span>
</span></span><span class=line><span class=cl>  <span class=k>def</span> <span class=nf>stmethod</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span> <span class=s2>&#34;I am staticmethod&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>def</span> <span class=nf>instmethod</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span> <span class=s2>&#34;I am instancemethod&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>ex</span> <span class=o>=</span> <span class=n>example</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>ex</span><span class=o>.</span><span class=n>clsmethod</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=c1># I am classmethod</span>
</span></span><span class=line><span class=cl><span class=n>ex</span><span class=o>.</span><span class=n>stmethod</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=c1># I am staticmethod</span>
</span></span><span class=line><span class=cl><span class=n>ex</span><span class=o>.</span><span class=n>instmethod</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=c1># I am instancemethod</span>
</span></span><span class=line><span class=cl><span class=n>example</span><span class=o>.</span><span class=n>clsmethod</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=c1># I am classmethod</span>
</span></span><span class=line><span class=cl><span class=n>example</span><span class=o>.</span><span class=n>stmethod</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=c1># I am staticmethod</span>
</span></span><span class=line><span class=cl><span class=n>example</span><span class=o>.</span><span class=n>instmethod</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=c1># Traceback (most recent call last):</span>
</span></span><span class=line><span class=cl><span class=c1>#   File &#34;&#34;, line 1, in</span>
</span></span><span class=line><span class=cl><span class=c1># TypeError: unbound method instmethod() ...</span>
</span></span></code></pre></div><p>如果我们希望直接比较两个对象的，则需要覆写该类的比较相关方法：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Thing</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>value</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>__value</span> <span class=o>=</span> <span class=n>value</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__gt__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>other</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>__value</span> <span class=o>&gt;</span> <span class=n>other</span><span class=o>.</span><span class=n>__value</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__lt__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>other</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>__value</span> <span class=o>&lt;</span> <span class=n>other</span><span class=o>.</span><span class=n>__value</span>
</span></span><span class=line><span class=cl><span class=n>something</span> <span class=o>=</span> <span class=n>Thing</span><span class=p>(</span><span class=mi>100</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>nothing</span> <span class=o>=</span> <span class=n>Thing</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># True</span>
</span></span><span class=line><span class=cl><span class=n>something</span> <span class=o>&gt;</span> <span class=n>nothing</span>
</span></span><span class=line><span class=cl><span class=c1># False</span>
</span></span><span class=line><span class=cl><span class=n>something</span> <span class=o>&lt;</span> <span class=n>nothing</span>
</span></span><span class=line><span class=cl><span class=c1># Error</span>
</span></span><span class=line><span class=cl><span class=n>something</span> <span class=o>+</span> <span class=n>nothing</span>
</span></span></code></pre></div><h3 id=抽象类>抽象类</h3><p>Python 中支持定义抽象类，抽象类不可被直接实例化；抽象类必须包含一或多个抽象方法：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=kn>from</span> <span class=nn>abc</span> <span class=kn>import</span> <span class=n>ABC</span><span class=p>,</span> <span class=n>abstractmethod</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>AbstractClassExample</span><span class=p>(</span><span class=n>ABC</span><span class=p>):</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>value</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>value</span> <span class=o>=</span> <span class=n>value</span>
</span></span><span class=line><span class=cl>        <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=fm>__init__</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@abstractmethod</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>do_something</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>pass</span>
</span></span></code></pre></div><p>在 Python 3 中，也可以通过继承元类的方式来实现:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=kn>from</span> <span class=nn>abc</span> <span class=kn>import</span> <span class=n>ABCMeta</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>MyABC</span><span class=p>(</span><span class=n>metaclass</span><span class=o>=</span><span class=n>ABCMeta</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>pass</span>
</span></span></code></pre></div><h3 id=metaclass--元类>MetaClass | 元类</h3><p>Python 中所谓的</p><h2 id=类继承>类继承</h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=c1># 父类必须继承 object 或者其他父类</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>BaseClass</span><span class=p>(</span><span class=nb>object</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>pass</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>ChildClass</span><span class=p>(</span><span class=n>BaseClass</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=c1># 调用父类构造函数</span>
</span></span><span class=line><span class=cl>        <span class=nb>super</span><span class=p>(</span><span class=n>ChildClass</span><span class=p>,</span> <span class=bp>self</span><span class=p>)</span><span class=o>.</span><span class=fm>__init__</span><span class=p>(</span><span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=k>class</span> <span class=nc>Car</span><span class=p>(</span><span class=nb>object</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>condition</span> <span class=o>=</span> <span class=s2>&#34;new&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>model</span><span class=p>,</span> <span class=n>color</span><span class=p>,</span> <span class=n>mpg</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>model</span> <span class=o>=</span> <span class=n>model</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>color</span> <span class=o>=</span> <span class=n>color</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>mpg</span>   <span class=o>=</span> <span class=n>mpg</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>ElectricCar</span><span class=p>(</span><span class=n>Car</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>battery_type</span><span class=p>,</span> <span class=n>model</span><span class=p>,</span> <span class=n>color</span><span class=p>,</span> <span class=n>mpg</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>battery_type</span><span class=o>=</span><span class=n>battery_type</span>
</span></span><span class=line><span class=cl>        <span class=nb>super</span><span class=p>(</span><span class=n>ElectricCar</span><span class=p>,</span> <span class=bp>self</span><span class=p>)</span><span class=o>.</span><span class=fm>__init__</span><span class=p>(</span><span class=n>model</span><span class=p>,</span> <span class=n>color</span><span class=p>,</span> <span class=n>mpg</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>car</span> <span class=o>=</span> <span class=n>ElectricCar</span><span class=p>(</span><span class=s1>&#39;battery&#39;</span><span class=p>,</span> <span class=s1>&#39;ford&#39;</span><span class=p>,</span> <span class=s1>&#39;golden&#39;</span><span class=p>,</span> <span class=mi>10</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span> <span class=n>car</span><span class=o>.</span><span class=vm>__dict__</span>
</span></span></code></pre></div><h2 id=对象>对象</h2><h3 id=实例化>实例化</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=k>class</span> <span class=nc>Foo</span><span class=p>(</span><span class=nb>object</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>a</span><span class=p>,</span> <span class=n>b</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>a</span> <span class=o>=</span> <span class=n>a</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>b</span> <span class=o>=</span> <span class=n>b</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>bar</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>pass</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>i</span> <span class=o>=</span> <span class=n>Foo</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>)</span>
</span></span></code></pre></div><p>Python 中与类实例化相关的方法有 <code>__new__</code> 与 <code>__init__</code>，<code>__new__</code> 会在对象创建时候调用，覆写该方法能够自定义实例的创建过程；而 <code>__init__</code> 方法则是在实例创建完毕后初始化实例:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=k>class</span> <span class=nc>Foo</span><span class=p>(</span><span class=nb>object</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__new__</span><span class=p>(</span><span class=bp>cls</span><span class=p>,</span> <span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span> <span class=s2>&#34;Creating Instance&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>instance</span> <span class=o>=</span> <span class=nb>super</span><span class=p>(</span><span class=n>Foo</span><span class=p>,</span> <span class=bp>cls</span><span class=p>)</span><span class=o>.</span><span class=fm>__new__</span><span class=p>(</span><span class=bp>cls</span><span class=p>,</span> <span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=c1># 或者</span>
</span></span><span class=line><span class=cl>        <span class=c1># object.__new__(cls, *args, **kwargs)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>instance</span>
</span></span><span class=line><span class=cl>    <span class=o>...</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;&gt;</span> <span class=n>i</span> <span class=o>=</span> <span class=n>Foo</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>Creating</span> <span class=n>Instance</span>
</span></span></code></pre></div><h3 id=属性操作>属性操作</h3><p>Python 中对象的属性不同于字典键，可以使用点运算符取值，直接使用 in 判断会存在问题</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=k>class</span> <span class=nc>A</span><span class=p>(</span><span class=nb>object</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=nd>@property</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>prop</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=mi>3</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>a</span> <span class=o>=</span> <span class=n>A</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=nb>print</span> <span class=s2>&#34;&#39;prop&#39; in a.__dict__ =&#34;</span><span class=p>,</span> <span class=s1>&#39;prop&#39;</span> <span class=ow>in</span> <span class=n>a</span><span class=o>.</span><span class=vm>__dict__</span>
</span></span><span class=line><span class=cl><span class=nb>print</span> <span class=s2>&#34;hasattr(a, &#39;prop&#39;) =&#34;</span><span class=p>,</span> <span class=nb>hasattr</span><span class=p>(</span><span class=n>a</span><span class=p>,</span> <span class=s1>&#39;prop&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span> <span class=s2>&#34;a.prop =&#34;</span><span class=p>,</span> <span class=n>a</span><span class=o>.</span><span class=n>prop</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># &#39;prop&#39; in a.__dict__ = False</span>
</span></span><span class=line><span class=cl><span class=c1># hasattr(a, &#39;prop&#39;) = True</span>
</span></span><span class=line><span class=cl><span class=c1># a.prop = 3</span>
</span></span></code></pre></div><p>建议使用 hasattr, getattr, setattr 这种方式对于对象属性进行操作</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=k>class</span> <span class=nc>Example</span><span class=p>(</span><span class=nb>object</span><span class=p>):</span>
</span></span><span class=line><span class=cl>  <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=bp>self</span><span class=o>.</span><span class=n>name</span> <span class=o>=</span> <span class=s2>&#34;ex&#34;</span>
</span></span><span class=line><span class=cl>  <span class=k>def</span> <span class=nf>printex</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span> <span class=s2>&#34;This is an example&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Check object has attributes</span>
</span></span><span class=line><span class=cl><span class=c1># hasattr(obj, &#39;attr&#39;)</span>
</span></span><span class=line><span class=cl><span class=n>ex</span> <span class=o>=</span> <span class=n>Example</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=nb>hasattr</span><span class=p>(</span><span class=n>ex</span><span class=p>,</span><span class=s2>&#34;name&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># True</span>
</span></span><span class=line><span class=cl><span class=nb>hasattr</span><span class=p>(</span><span class=n>ex</span><span class=p>,</span><span class=s2>&#34;printex&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># True</span>
</span></span><span class=line><span class=cl><span class=nb>hasattr</span><span class=p>(</span><span class=n>ex</span><span class=p>,</span><span class=s2>&#34;print&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># False</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Get object attribute</span>
</span></span><span class=line><span class=cl><span class=c1># getattr(obj, &#39;attr&#39;)</span>
</span></span><span class=line><span class=cl><span class=nb>getattr</span><span class=p>(</span><span class=n>ex</span><span class=p>,</span><span class=s1>&#39;name&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># &#39;ex&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Set object attribute</span>
</span></span><span class=line><span class=cl><span class=c1># setattr(obj, &#39;attr&#39;, value)</span>
</span></span><span class=line><span class=cl><span class=nb>setattr</span><span class=p>(</span><span class=n>ex</span><span class=p>,</span><span class=s1>&#39;name&#39;</span><span class=p>,</span><span class=s1>&#39;example&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ex</span><span class=o>.</span><span class=n>name</span>
</span></span><span class=line><span class=cl><span class=c1># &#39;example&#39;</span>
</span></span></code></pre></div><h3 id=单例模式>单例模式</h3><p>我们可以通过覆写 <code>__new__</code> 方法或者创建特殊的 MetaClass 来实现单例模式:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=k>class</span> <span class=nc>Singleton</span><span class=p>(</span><span class=nb>object</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>_instance</span> <span class=o>=</span> <span class=kc>None</span>  <span class=c1># Keep instance reference</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__new__</span><span class=p>(</span><span class=bp>cls</span><span class=p>,</span> <span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=ow>not</span> <span class=bp>cls</span><span class=o>.</span><span class=n>_instance</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=bp>cls</span><span class=o>.</span><span class=n>_instance</span> <span class=o>=</span> <span class=nb>object</span><span class=o>.</span><span class=fm>__new__</span><span class=p>(</span><span class=bp>cls</span><span class=p>,</span> <span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=bp>cls</span><span class=o>.</span><span class=n>_instance</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 指定数目的单例</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>LimitedInstances</span><span class=p>(</span><span class=nb>object</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>_instances</span> <span class=o>=</span> <span class=p>[]</span>  <span class=c1># Keep track of instance reference</span>
</span></span><span class=line><span class=cl>    <span class=n>limit</span> <span class=o>=</span> <span class=mi>5</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__new__</span><span class=p>(</span><span class=bp>cls</span><span class=p>,</span> <span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=ow>not</span> <span class=nb>len</span><span class=p>(</span><span class=bp>cls</span><span class=o>.</span><span class=n>_instances</span><span class=p>)</span> <span class=o>&lt;=</span> <span class=bp>cls</span><span class=o>.</span><span class=n>limit</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>raise</span> <span class=ne>RuntimeError</span><span class=p>,</span> <span class=s2>&#34;Count not create instance. Limit </span><span class=si>%s</span><span class=s2> reached&#34;</span> <span class=o>%</span> <span class=bp>cls</span><span class=o>.</span><span class=n>limit</span>
</span></span><span class=line><span class=cl>        <span class=n>instance</span> <span class=o>=</span> <span class=nb>object</span><span class=o>.</span><span class=fm>__new__</span><span class=p>(</span><span class=bp>cls</span><span class=p>,</span> <span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=bp>cls</span><span class=o>.</span><span class=n>_instances</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>instance</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>instance</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__del__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=c1># Remove instance from _instances</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>_instance</span><span class=o>.</span><span class=n>remove</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span>
</span></span></code></pre></div><p>也可以通过继承元类的方式来实现:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=k>class</span> <span class=nc>Singleton</span><span class=p>(</span><span class=nb>type</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>_instances</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__call__</span><span class=p>(</span><span class=bp>cls</span><span class=p>,</span> <span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=bp>cls</span> <span class=ow>not</span> <span class=ow>in</span> <span class=bp>cls</span><span class=o>.</span><span class=n>_instances</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=bp>cls</span><span class=o>.</span><span class=n>_instances</span><span class=p>[</span><span class=bp>cls</span><span class=p>]</span> <span class=o>=</span> <span class=nb>super</span><span class=p>(</span><span class=n>Singleton</span><span class=p>,</span>                                      <span class=bp>cls</span><span class=p>)</span><span class=o>.</span><span class=fm>__call__</span><span class=p>(</span><span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=bp>cls</span><span class=o>.</span><span class=n>_instances</span><span class=p>[</span><span class=bp>cls</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>SingletonClass</span><span class=p>(</span><span class=n>metaclass</span><span class=o>=</span><span class=n>Singleton</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>pass</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>RegularClass</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=k>pass</span>
</span></span><span class=line><span class=cl><span class=n>x</span> <span class=o>=</span> <span class=n>SingletonClass</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>y</span> <span class=o>=</span> <span class=n>SingletonClass</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>x</span> <span class=o>==</span> <span class=n>y</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>x</span> <span class=o>=</span> <span class=n>RegularClass</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>y</span> <span class=o>=</span> <span class=n>RegularClass</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>x</span> <span class=o>==</span> <span class=n>y</span><span class=p>)</span>
</span></span></code></pre></div><h1 id=异常与测试>异常与测试</h1><h2 id=异常处理>异常处理</h2><h3 id=try>try</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=kn>import</span> <span class=nn>sys</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>f</span> <span class=o>=</span> <span class=nb>open</span><span class=p>(</span><span class=s1>&#39;myfile.txt&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>s</span> <span class=o>=</span> <span class=n>f</span><span class=o>.</span><span class=n>readline</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>i</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>s</span><span class=o>.</span><span class=n>strip</span><span class=p>())</span>
</span></span><span class=line><span class=cl><span class=k>except</span> <span class=ne>OSError</span> <span class=k>as</span> <span class=n>err</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;OS error: </span><span class=si>{0}</span><span class=s2>&#34;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>err</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=k>except</span> <span class=ne>ValueError</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Could not convert data to an integer.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>except</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Unexpected error:&#34;</span><span class=p>,</span> <span class=n>sys</span><span class=o>.</span><span class=n>exc_info</span><span class=p>()[</span><span class=mi>0</span><span class=p>])</span>
</span></span><span class=line><span class=cl>    <span class=k>raise</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=k>class</span> <span class=nc>B</span><span class=p>(</span><span class=ne>Exception</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>pass</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>C</span><span class=p>(</span><span class=n>B</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>pass</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>D</span><span class=p>(</span><span class=n>C</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>pass</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=bp>cls</span> <span class=ow>in</span> <span class=p>[</span><span class=n>B</span><span class=p>,</span> <span class=n>C</span><span class=p>,</span> <span class=n>D</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>raise</span> <span class=bp>cls</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=n>D</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;D&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=n>C</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;C&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=n>B</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;B&#34;</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=context-manager---with>Context Manager - with</h3><p>with 常用于打开或者关闭某些资源</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=n>host</span> <span class=o>=</span> <span class=s1>&#39;localhost&#39;</span>
</span></span><span class=line><span class=cl><span class=n>port</span> <span class=o>=</span> <span class=mi>5566</span>
</span></span><span class=line><span class=cl><span class=k>with</span> <span class=n>Socket</span><span class=p>(</span><span class=n>host</span><span class=p>,</span> <span class=n>port</span><span class=p>)</span> <span class=k>as</span> <span class=n>s</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span> <span class=kc>True</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>conn</span><span class=p>,</span> <span class=n>addr</span> <span class=o>=</span> <span class=n>s</span><span class=o>.</span><span class=n>accept</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>msg</span> <span class=o>=</span> <span class=n>conn</span><span class=o>.</span><span class=n>recv</span><span class=p>(</span><span class=mi>1024</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span> <span class=n>msg</span>
</span></span><span class=line><span class=cl>        <span class=n>conn</span><span class=o>.</span><span class=n>send</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>conn</span><span class=o>.</span><span class=n>close</span><span class=p>()</span>
</span></span></code></pre></div><h2 id=单元测试>单元测试</h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=kn>from</span> <span class=nn>__future__</span> <span class=kn>import</span> <span class=n>print_function</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>unittest</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>fib</span><span class=p>(</span><span class=n>n</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=mi>1</span> <span class=k>if</span> <span class=n>n</span><span class=o>&lt;=</span><span class=mi>2</span> <span class=k>else</span> <span class=n>fib</span><span class=p>(</span><span class=n>n</span><span class=o>-</span><span class=mi>1</span><span class=p>)</span><span class=o>+</span><span class=n>fib</span><span class=p>(</span><span class=n>n</span><span class=o>-</span><span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>setUpModule</span><span class=p>():</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;setup module&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>tearDownModule</span><span class=p>():</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;teardown module&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>TestFib</span><span class=p>(</span><span class=n>unittest</span><span class=o>.</span><span class=n>TestCase</span><span class=p>):</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>setUp</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;setUp&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>n</span> <span class=o>=</span> <span class=mi>10</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>tearDown</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;tearDown&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>del</span> <span class=bp>self</span><span class=o>.</span><span class=n>n</span>
</span></span><span class=line><span class=cl>    <span class=nd>@classmethod</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>setUpClass</span><span class=p>(</span><span class=bp>cls</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;setUpClass&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nd>@classmethod</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>tearDownClass</span><span class=p>(</span><span class=bp>cls</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;tearDownClass&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>test_fib_assert_equal</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>assertEqual</span><span class=p>(</span><span class=n>fib</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>n</span><span class=p>),</span> <span class=mi>55</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>test_fib_assert_true</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>assertTrue</span><span class=p>(</span><span class=n>fib</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>n</span><span class=p>)</span> <span class=o>==</span> <span class=mi>55</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>unittest</span><span class=o>.</span><span class=n>main</span><span class=p>()</span>
</span></span></code></pre></div><h1 id=存储>存储</h1><h2 id=文件读写>文件读写</h2><h3 id=路径处理>路径处理</h3><p>Python 内置的 <code>__file__</code> 关键字会指向当前文件的相对路径，可以根据它来构造绝对路径，或者索引其他文件</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=c1># 获取当前文件的相对目录</span>
</span></span><span class=line><span class=cl><span class=nb>dir</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>dirname</span><span class=p>(</span><span class=vm>__file__</span><span class=p>)</span> <span class=c1># src\app</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>## once you&#39;re at the directory level you want, with the desired directory as the final path node:</span>
</span></span><span class=line><span class=cl><span class=n>dirname1</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>basename</span><span class=p>(</span><span class=nb>dir</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>dirname2</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=nb>dir</span><span class=p>)[</span><span class=mi>1</span><span class=p>]</span> <span class=c1>## if you look at the documentation, this is exactly what os.path.basename does.</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 获取当前代码文件的绝对路径，abspath 会自动根据相对路径与当前工作空间进行路径补全</span>
</span></span><span class=line><span class=cl><span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>abspath</span><span class=p>(</span><span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>dirname</span><span class=p>(</span><span class=vm>__file__</span><span class=p>))</span> <span class=c1># D:\WorkSpace\OWS\tool\ui-tool-svn\python\src\app</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 获取当前文件的真实路径</span>
</span></span><span class=line><span class=cl><span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>dirname</span><span class=p>(</span><span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>realpath</span><span class=p>(</span><span class=vm>__file__</span><span class=p>))</span> <span class=c1># D:\WorkSpace\OWS\tool\ui-tool-svn\python\src\app</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 获取当前执行路径</span>
</span></span><span class=line><span class=cl><span class=n>os</span><span class=o>.</span><span class=n>getcwd</span><span class=p>()</span>
</span></span></code></pre></div><p>可以使用 listdir、walk、glob 模块来进行文件枚举与检索：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=c1># 仅列举所有的文件</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>os</span> <span class=kn>import</span> <span class=n>listdir</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>os.path</span> <span class=kn>import</span> <span class=n>isfile</span><span class=p>,</span> <span class=n>join</span>
</span></span><span class=line><span class=cl><span class=n>onlyfiles</span> <span class=o>=</span> <span class=p>[</span><span class=n>f</span> <span class=k>for</span> <span class=n>f</span> <span class=ow>in</span> <span class=n>listdir</span><span class=p>(</span><span class=n>mypath</span><span class=p>)</span> <span class=k>if</span> <span class=n>isfile</span><span class=p>(</span><span class=n>join</span><span class=p>(</span><span class=n>mypath</span><span class=p>,</span> <span class=n>f</span><span class=p>))]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 使用 walk 递归搜索</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>os</span> <span class=kn>import</span> <span class=n>walk</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>f</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=p>(</span><span class=n>dirpath</span><span class=p>,</span> <span class=n>dirnames</span><span class=p>,</span> <span class=n>filenames</span><span class=p>)</span> <span class=ow>in</span> <span class=n>walk</span><span class=p>(</span><span class=n>mypath</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>f</span><span class=o>.</span><span class=n>extend</span><span class=p>(</span><span class=n>filenames</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>break</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 使用 glob 进行复杂模式匹配</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>glob</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>glob</span><span class=o>.</span><span class=n>glob</span><span class=p>(</span><span class=s2>&#34;/home/adam/*.txt&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=c1># [&#39;/home/adam/file1.txt&#39;, &#39;/home/adam/file2.txt&#39;, .... ]</span>
</span></span></code></pre></div><h3 id=简单文件读写>简单文件读写</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=c1># 可以根据文件是否存在选择写入模式</span>
</span></span><span class=line><span class=cl><span class=n>mode</span> <span class=o>=</span> <span class=s1>&#39;a&#39;</span> <span class=k>if</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>exists</span><span class=p>(</span><span class=n>writepath</span><span class=p>)</span> <span class=k>else</span> <span class=s1>&#39;w&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 使用 with 方法能够自动处理异常</span>
</span></span><span class=line><span class=cl><span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=s2>&#34;file.dat&#34;</span><span class=p>,</span><span class=n>mode</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>f</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=o>...</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=o>...</span>
</span></span><span class=line><span class=cl>    <span class=c1># 操作完毕之后记得关闭文件</span>
</span></span><span class=line><span class=cl>    <span class=n>f</span><span class=o>.</span><span class=n>close</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 读取文件内容</span>
</span></span><span class=line><span class=cl><span class=n>message</span> <span class=o>=</span> <span class=n>f</span><span class=o>.</span><span class=n>read</span><span class=p>()</span>
</span></span></code></pre></div><h2 id=复杂格式文件>复杂格式文件</h2><h3 id=json>JSON</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=kn>import</span> <span class=nn>json</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Writing JSON data</span>
</span></span><span class=line><span class=cl><span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=s1>&#39;data.json&#39;</span><span class=p>,</span> <span class=s1>&#39;w&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span></span><span class=line><span class=cl>     <span class=n>json</span><span class=o>.</span><span class=n>dump</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=n>f</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Reading data back</span>
</span></span><span class=line><span class=cl><span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=s1>&#39;data.json&#39;</span><span class=p>,</span> <span class=s1>&#39;r&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span></span><span class=line><span class=cl>     <span class=n>data</span> <span class=o>=</span> <span class=n>json</span><span class=o>.</span><span class=n>load</span><span class=p>(</span><span class=n>f</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=xml>XML</h3><p>我们可以使用 <a href=http://lxml.de/parsing.html target=_blank rel=noopener>lxml</a> 来解析与处理 XML 文件，本部分即对其常用操作进行介绍。lxml 支持从字符串或者文件中创建 Element 对象：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=kn>from</span> <span class=nn>lxml</span> <span class=kn>import</span> <span class=n>etree</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 可以从字符串开始构造</span>
</span></span><span class=line><span class=cl><span class=n>xml</span> <span class=o>=</span> <span class=s1>&#39;&lt;a xmlns=&#34;test&#34;&gt;&lt;b xmlns=&#34;test&#34;/&gt;&lt;/a&gt;&#39;</span>
</span></span><span class=line><span class=cl><span class=n>root</span> <span class=o>=</span> <span class=n>etree</span><span class=o>.</span><span class=n>fromstring</span><span class=p>(</span><span class=n>xml</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>etree</span><span class=o>.</span><span class=n>tostring</span><span class=p>(</span><span class=n>root</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># b&#39;&lt;a xmlns=&#34;test&#34;&gt;&lt;b xmlns=&#34;test&#34;/&gt;&lt;/a&gt;&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 也可以从某个文件开始构造</span>
</span></span><span class=line><span class=cl><span class=n>tree</span> <span class=o>=</span> <span class=n>etree</span><span class=o>.</span><span class=n>parse</span><span class=p>(</span><span class=s2>&#34;doc/test.xml&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 或者指定某个 baseURL</span>
</span></span><span class=line><span class=cl><span class=n>root</span> <span class=o>=</span> <span class=n>etree</span><span class=o>.</span><span class=n>fromstring</span><span class=p>(</span><span class=n>xml</span><span class=p>,</span> <span class=n>base_url</span><span class=o>=</span><span class=s2>&#34;http://where.it/is/from.xml&#34;</span><span class=p>)</span>
</span></span></code></pre></div><p>其提供了迭代器以对所有元素进行遍历：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=c1># 遍历所有的节点</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>tag</span> <span class=ow>in</span> <span class=n>tree</span><span class=o>.</span><span class=n>iter</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=ow>not</span> <span class=nb>len</span><span class=p>(</span><span class=n>tag</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span> <span class=n>tag</span><span class=o>.</span><span class=n>keys</span><span class=p>()</span> <span class=c1># 获取所有自定义属性</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span> <span class=p>(</span><span class=n>tag</span><span class=o>.</span><span class=n>tag</span><span class=p>,</span> <span class=n>tag</span><span class=o>.</span><span class=n>text</span><span class=p>)</span> <span class=c1># text 即文本子元素值</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 获取 XPath</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>e</span> <span class=ow>in</span> <span class=n>root</span><span class=o>.</span><span class=n>iter</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span> <span class=n>tree</span><span class=o>.</span><span class=n>getpath</span><span class=p>(</span><span class=n>e</span><span class=p>)</span>
</span></span></code></pre></div><p>lxml 支持以 XPath 查找元素，不过需要注意的是，XPath 查找的结果是数组，并且在包含命名空间的情况下，需要指定命名空间：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=n>root</span><span class=o>.</span><span class=n>xpath</span><span class=p>(</span><span class=s1>&#39;//page/text/text()&#39;</span><span class=p>,</span><span class=n>ns</span><span class=o>=</span><span class=p>{</span><span class=n>prefix</span><span class=p>:</span><span class=n>url</span><span class=p>})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 可以使用 getparent 递归查找父元素</span>
</span></span><span class=line><span class=cl><span class=n>el</span><span class=o>.</span><span class=n>getparent</span><span class=p>()</span>
</span></span></code></pre></div><p>lxml 提供了 insert、append 等方法进行元素操作：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=c1># append 方法默认追加到尾部</span>
</span></span><span class=line><span class=cl><span class=n>st</span> <span class=o>=</span> <span class=n>etree</span><span class=o>.</span><span class=n>Element</span><span class=p>(</span><span class=s2>&#34;state&#34;</span><span class=p>,</span> <span class=n>name</span><span class=o>=</span><span class=s2>&#34;New Mexico&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>co</span> <span class=o>=</span> <span class=n>etree</span><span class=o>.</span><span class=n>Element</span><span class=p>(</span><span class=s2>&#34;county&#34;</span><span class=p>,</span> <span class=n>name</span><span class=o>=</span><span class=s2>&#34;Socorro&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>st</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>co</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># insert 方法可以指定位置</span>
</span></span><span class=line><span class=cl><span class=n>node</span><span class=o>.</span><span class=n>insert</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=n>newKid</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=excel>Excel</h3><p>可以使用 <a href>xlrd</a> 来读取 Excel 文件，使用 <a href=http://xlsxwriter.readthedocs.io/ target=_blank rel=noopener>xlsxwriter</a> 来写入与操作 Excel 文件。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=c1># 读取某个 Cell 的原始值</span>
</span></span><span class=line><span class=cl><span class=n>sh</span><span class=o>.</span><span class=n>cell</span><span class=p>(</span><span class=n>rx</span><span class=p>,</span> <span class=n>col</span><span class=p>)</span><span class=o>.</span><span class=n>value</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=c1># 创建新的文件</span>
</span></span><span class=line><span class=cl><span class=n>workbook</span> <span class=o>=</span> <span class=n>xlsxwriter</span><span class=o>.</span><span class=n>Workbook</span><span class=p>(</span><span class=n>outputFile</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>worksheet</span> <span class=o>=</span> <span class=n>workbook</span><span class=o>.</span><span class=n>add_worksheet</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 设置从第 0 行开始写入</span>
</span></span><span class=line><span class=cl><span class=n>row</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 遍历二维数组，并且将其写入到 Excel 中</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>rowData</span> <span class=ow>in</span> <span class=n>array</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>col</span><span class=p>,</span> <span class=n>data</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>rowData</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>worksheet</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=n>row</span><span class=p>,</span> <span class=n>col</span><span class=p>,</span> <span class=n>data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>row</span> <span class=o>=</span> <span class=n>row</span> <span class=o>+</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>workbook</span><span class=o>.</span><span class=n>close</span><span class=p>()</span>
</span></span></code></pre></div><h2 id=文件系统>文件系统</h2><p>对于高级的文件操作，我们可以使用 Python 内置的 shutil</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=c1># 递归删除 appName 下面的所有的文件夹</span>
</span></span><span class=line><span class=cl><span class=n>shutil</span><span class=o>.</span><span class=n>rmtree</span><span class=p>(</span><span class=n>appName</span><span class=p>)</span>
</span></span></code></pre></div><h1 id=网络交互>网络交互</h1><h2 id=requests>Requests</h2><p><a href=https://parg.co/UrO target=_blank rel=noopener>Requests</a> 是优雅而易用的 Python 网络请求库</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=kn>import</span> <span class=nn>requests</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>r</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;https://api.github.com/events&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>r</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;https://api.github.com/user&#39;</span><span class=p>,</span> <span class=n>auth</span><span class=o>=</span><span class=p>(</span><span class=s1>&#39;user&#39;</span><span class=p>,</span> <span class=s1>&#39;pass&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>r</span><span class=o>.</span><span class=n>status_code</span>
</span></span><span class=line><span class=cl><span class=c1># 200</span>
</span></span><span class=line><span class=cl><span class=n>r</span><span class=o>.</span><span class=n>headers</span><span class=p>[</span><span class=s1>&#39;content-type&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=c1># &#39;application/json; charset=utf8&#39;</span>
</span></span><span class=line><span class=cl><span class=n>r</span><span class=o>.</span><span class=n>encoding</span>
</span></span><span class=line><span class=cl><span class=c1># &#39;utf-8&#39;</span>
</span></span><span class=line><span class=cl><span class=n>r</span><span class=o>.</span><span class=n>text</span>
</span></span><span class=line><span class=cl><span class=c1># u&#39;{&#34;type&#34;:&#34;User&#34;...&#39;</span>
</span></span><span class=line><span class=cl><span class=n>r</span><span class=o>.</span><span class=n>json</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=c1># {u&#39;private_gists&#39;: 419, u&#39;total_private_repos&#39;: 77, ...}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>r</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>put</span><span class=p>(</span><span class=s1>&#39;http://httpbin.org/put&#39;</span><span class=p>,</span> <span class=n>data</span> <span class=o>=</span> <span class=p>{</span><span class=s1>&#39;key&#39;</span><span class=p>:</span><span class=s1>&#39;value&#39;</span><span class=p>})</span>
</span></span><span class=line><span class=cl><span class=n>r</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>delete</span><span class=p>(</span><span class=s1>&#39;http://httpbin.org/delete&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>r</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>head</span><span class=p>(</span><span class=s1>&#39;http://httpbin.org/get&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>r</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>options</span><span class=p>(</span><span class=s1>&#39;http://httpbin.org/get&#39;</span><span class=p>)</span>
</span></span></code></pre></div><h1 id=数据存储>数据存储</h1><h2 id=mysql>MySQL</h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=kn>import</span> <span class=nn>pymysql.cursors</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Connect to the database</span>
</span></span><span class=line><span class=cl><span class=n>connection</span> <span class=o>=</span> <span class=n>pymysql</span><span class=o>.</span><span class=n>connect</span><span class=p>(</span><span class=n>host</span><span class=o>=</span><span class=s1>&#39;localhost&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                             <span class=n>user</span><span class=o>=</span><span class=s1>&#39;user&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                             <span class=n>password</span><span class=o>=</span><span class=s1>&#39;passwd&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                             <span class=n>db</span><span class=o>=</span><span class=s1>&#39;db&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                             <span class=n>charset</span><span class=o>=</span><span class=s1>&#39;utf8mb4&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                             <span class=n>cursorclass</span><span class=o>=</span><span class=n>pymysql</span><span class=o>.</span><span class=n>cursors</span><span class=o>.</span><span class=n>DictCursor</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>with</span> <span class=n>connection</span><span class=o>.</span><span class=n>cursor</span><span class=p>()</span> <span class=k>as</span> <span class=n>cursor</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=c1># Create a new record</span>
</span></span><span class=line><span class=cl>        <span class=n>sql</span> <span class=o>=</span> <span class=s2>&#34;INSERT INTO `users` (`email`, `password`) VALUES (</span><span class=si>%s</span><span class=s2>, </span><span class=si>%s</span><span class=s2>)&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>cursor</span><span class=o>.</span><span class=n>execute</span><span class=p>(</span><span class=n>sql</span><span class=p>,</span> <span class=p>(</span><span class=s1>&#39;webmaster@python.org&#39;</span><span class=p>,</span> <span class=s1>&#39;very-secret&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># connection is not autocommit by default. So you must commit to save</span>
</span></span><span class=line><span class=cl>    <span class=c1># your changes.</span>
</span></span><span class=line><span class=cl>    <span class=n>connection</span><span class=o>.</span><span class=n>commit</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>with</span> <span class=n>connection</span><span class=o>.</span><span class=n>cursor</span><span class=p>()</span> <span class=k>as</span> <span class=n>cursor</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=c1># Read a single record</span>
</span></span><span class=line><span class=cl>        <span class=n>sql</span> <span class=o>=</span> <span class=s2>&#34;SELECT `id`, `password` FROM `users` WHERE `email`=</span><span class=si>%s</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>cursor</span><span class=o>.</span><span class=n>execute</span><span class=p>(</span><span class=n>sql</span><span class=p>,</span> <span class=p>(</span><span class=s1>&#39;webmaster@python.org&#39;</span><span class=p>,))</span>
</span></span><span class=line><span class=cl>        <span class=n>result</span> <span class=o>=</span> <span class=n>cursor</span><span class=o>.</span><span class=n>fetchone</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=n>result</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>finally</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>connection</span><span class=o>.</span><span class=n>close</span><span class=p>()</span>
</span></span></code></pre></div><h1 id=并发编程>并发编程</h1><p>concurrent.futures 是标准库的一部分，自 3.2 版本之后引入；对于老版本则需要手动引入 futures 依赖库。我们可以使用 ProcessPoolExecutor 来处理 CPU 密集型任务，使用 ThreadPoolExecutor 来处理网络操作或者 IO 操作。ProcessPoolExecutor 内部使用了 multiprocessing 模块，其不会受到 GIL(Global Intercept Lock)的干扰。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=kn>from</span> <span class=nn>concurrent.futures</span> <span class=kn>import</span> <span class=n>ThreadPoolExecutor</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>time</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>requests</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>fetch</span><span class=p>(</span><span class=n>a</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>url</span> <span class=o>=</span> <span class=s1>&#39;http://httpbin.org/get?a=</span><span class=si>{0}</span><span class=s1>&#39;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>a</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>r</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>url</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>result</span> <span class=o>=</span> <span class=n>r</span><span class=o>.</span><span class=n>json</span><span class=p>()[</span><span class=s1>&#39;args&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>result</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>start</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># if max_workers is None or not given, it will default to the number of processors, multiplied by 5</span>
</span></span><span class=line><span class=cl><span class=k>with</span> <span class=n>ThreadPoolExecutor</span><span class=p>(</span><span class=n>max_workers</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span> <span class=k>as</span> <span class=n>executor</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>result</span> <span class=ow>in</span> <span class=n>executor</span><span class=o>.</span><span class=n>map</span><span class=p>(</span><span class=n>fetch</span><span class=p>,</span> <span class=nb>range</span><span class=p>(</span><span class=mi>30</span><span class=p>)):</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;response: </span><span class=si>{0}</span><span class=s1>&#39;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>result</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s1>&#39;time: </span><span class=si>{0}</span><span class=s1>&#39;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span> <span class=o>-</span> <span class=n>start</span><span class=p>))</span>
</span></span></code></pre></div><p>executor.submit() 则可以返回 Future 对象，所谓的 Future 即是包含了某个异步执行函数，并且会在未来执行完毕或者抛出异常的对象。而 as_completed 函数与上文使用的 map 函数的区别在于，map 会按照传入迭代器的顺序返回结果，而 as_completed 则会返回首页执行完毕的 Future 对象：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=kn>from</span> <span class=nn>concurrent.futures</span> <span class=kn>import</span> <span class=n>ThreadPoolExecutor</span><span class=p>,</span> <span class=n>as_completed</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>requests</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>fetch</span><span class=p>(</span><span class=n>url</span><span class=p>,</span> <span class=n>timeout</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>r</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>url</span><span class=p>,</span> <span class=n>timeout</span><span class=o>=</span><span class=n>timeout</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>data</span> <span class=o>=</span> <span class=n>r</span><span class=o>.</span><span class=n>json</span><span class=p>()[</span><span class=s1>&#39;args&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>data</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>with</span> <span class=n>ThreadPoolExecutor</span><span class=p>(</span><span class=n>max_workers</span><span class=o>=</span><span class=mi>10</span><span class=p>)</span> <span class=k>as</span> <span class=n>executor</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>futures</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>42</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>url</span> <span class=o>=</span> <span class=s1>&#39;https://httpbin.org/get?i=</span><span class=si>{0}</span><span class=s1>&#39;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>i</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>future</span> <span class=o>=</span> <span class=n>executor</span><span class=o>.</span><span class=n>submit</span><span class=p>(</span><span class=n>fetch</span><span class=p>,</span> <span class=n>url</span><span class=p>,</span> <span class=mi>60</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>futures</span><span class=p>[</span><span class=n>future</span><span class=p>]</span> <span class=o>=</span> <span class=n>url</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>future</span> <span class=ow>in</span> <span class=n>as_completed</span><span class=p>(</span><span class=n>futures</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>url</span> <span class=o>=</span> <span class=n>futures</span><span class=p>[</span><span class=n>future</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>data</span> <span class=o>=</span> <span class=n>future</span><span class=o>.</span><span class=n>result</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>exc</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=n>exc</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;fetch </span><span class=si>{0}</span><span class=s1>, get </span><span class=si>{1}</span><span class=s1>&#39;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>url</span><span class=p>,</span> <span class=n>data</span><span class=p>))</span>
</span></span></code></pre></div><h1 id=编程规范>编程规范</h1><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=k>def</span> <span class=nf>fetch_bigtable_rows</span><span class=p>(</span><span class=n>big_table</span><span class=p>,</span> <span class=n>keys</span><span class=p>,</span> <span class=n>other_silly_variable</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;Fetches rows from a Bigtable.
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>    Retrieves rows pertaining to the given keys from the Table instance
</span></span></span><span class=line><span class=cl><span class=s2>    represented by big_table.  Silly things may happen if
</span></span></span><span class=line><span class=cl><span class=s2>    other_silly_variable is not None.
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>    Args:
</span></span></span><span class=line><span class=cl><span class=s2>        big_table: An open Bigtable Table instance.
</span></span></span><span class=line><span class=cl><span class=s2>        keys: A sequence of strings representing the key of each table row
</span></span></span><span class=line><span class=cl><span class=s2>            to fetch.
</span></span></span><span class=line><span class=cl><span class=s2>        other_silly_variable: Another optional variable, that has a much
</span></span></span><span class=line><span class=cl><span class=s2>            longer name than the other args, and which does nothing.
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>    Returns:
</span></span></span><span class=line><span class=cl><span class=s2>        A dict mapping keys to the corresponding table row data
</span></span></span><span class=line><span class=cl><span class=s2>        fetched. Each row is represented as a tuple of strings. For
</span></span></span><span class=line><span class=cl><span class=s2>        example:
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>        {&#39;Serak&#39;: (&#39;Rigel VII&#39;, &#39;Preparer&#39;),
</span></span></span><span class=line><span class=cl><span class=s2>         &#39;Zim&#39;: (&#39;Irk&#39;, &#39;Invader&#39;),
</span></span></span><span class=line><span class=cl><span class=s2>         &#39;Lrrr&#39;: (&#39;Omicron Persei 8&#39;, &#39;Emperor&#39;)}
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>        If a key from the keys argument is missing from the dictionary,
</span></span></span><span class=line><span class=cl><span class=s2>        then that row was not found in the table.
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>    Raises:
</span></span></span><span class=line><span class=cl><span class=s2>        IOError: An error occurred accessing the bigtable.Table object.
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>pass</span>
</span></span></code></pre></div><p>所谓"内部(Internal)&ldquo;表示仅模块内可用, 或者, 在类内是保护或私有的。用单下划线(<code>_</code>)开头表示模块变量或函数是 protected 的(使用 <code>import * from</code> 时不会包含)。用双下划线(<code>__</code>)开头的实例变量或方法表示类内私有。将相关的类和顶级函数放在同一个模块里. 不像 Java, 没必要限制一个类一个模块。对类名使用大写字母开头的单词(如 CapWords, 即 Pascal 风格), 但是模块名应该用小写加下划线的方式(如 lower_with_under.py). 尽管已经有很多现存的模块使用类似于 CapWords.py 这样的命名, 但现在已经不鼓励这样做, 因为如果模块名碰巧和类名一致, 这会让人困扰.</p><table><thead><tr><th>Type</th><th>Public</th><th>Internal</th></tr></thead><tbody><tr><td>Modules</td><td>lower_with_under</td><td><code>_lower_with_under</code></td></tr><tr><td>Packages</td><td>lower_with_under</td><td></td></tr><tr><td>Classes</td><td>CapWords</td><td><code>_CapWords</code></td></tr><tr><td>Exceptions</td><td>CapWords</td><td></td></tr><tr><td>Functions</td><td>lower_with_under()</td><td>_lower_with_under()</td></tr><tr><td>Global/Class Constants</td><td>CAPS_WITH_UNDER</td><td><code>_CAPS_WITH_UNDER</code></td></tr><tr><td>Global/Class Variables</td><td>lower_with_under</td><td><code>_lower_with_under</code></td></tr><tr><td>Instance Variables</td><td>lower_with_under</td><td>_lower_with_under (protected) or __lower_with_under (private)</td></tr><tr><td>Method Names</td><td>lower_with_under()</td><td>_lower_with_under() (protected) or __lower_with_under() (private)</td></tr><tr><td>Function/Method Parameters</td><td>lower_with_under</td><td></td></tr><tr><td>Local Variables</td><td>lower_with_under</td><td></td></tr></tbody></table><h1 id=links>Links</h1><ul><li><a href=https://mojotv.cn/2018/12/26/python-cheat-sheet target=_blank rel=noopener>https://mojotv.cn/2018/12/26/python-cheat-sheet</a> Python快速入门和查询</li></ul></div><div class=article-widget><div class="container-xl row post-nav"></div></div><div class=body-footer><p>最近更新于 2023-03-05</p><section id=comments class="mb-3 pt-0"><div id=disqus_thread></div><script>var disqus_config=function(){};(function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="https://ngte-website.oss-accelerate.aliyuncs.com/disqus/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)})()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></section></div></article><footer class=site-footer><div class="copyright py-4 bg-footer"><div class="row justify-content-center"><div class="text-center footer-color"><p class=mb-0>© 2017-2022 NGTE all rights reserved</p></div></div></div></footer></main></div></div><script src=//unpkg.com/heti/umd/heti-addon.min.js></script>
<script>const heti=new Heti(".article");heti.autoSpacing()</script><script type=text/javascript>window.$crisp=[],window.CRISP_WEBSITE_ID="12adcc35-9621-4313-8262-62dc654b29d8",function(){setTimeout(function(){d=document,s=d.createElement("script"),s.src="https://client.crisp.chat/l.js",s.async=1,d.getElementsByTagName("head")[0].appendChild(s)},2500)}()</script></div><div class=page-footer></div><script src=/js/vendor-bundle.min.d26509351aa0ff874abbee824e982e9b.js></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.1/highlight.min.js integrity="sha512-Ypjm0o7jOxAd4hpdoppSEN0TQOC19UtPAqD+4s5AlXmUvbmmS/YMxYqAqarQYyxTnB6/rqip9qcxlNB/3U9Wdg==" crossorigin=anonymous></script>
<script id=search-hit-algolia-template type=text/html><div class=search-hit><div class=search-hit-content><div class=search-hit-name><a href={{relpermalink}}>{{#helpers.highlight}}{ "attribute": "title" }{{/helpers.highlight}}</a></div><div class="article-metadata search-hit-type">{{type}}</div><p class=search-hit-description>{{#helpers.highlight}}{ "attribute": "summary" }{{/helpers.highlight}}</p></div></div></script><script src=https://cdn.jsdelivr.net/npm/instantsearch.js@4/dist/instantsearch.production.min.js crossorigin=anonymous></script>
<script id=dsq-count-scr src=https://ngte-website.oss-accelerate.aliyuncs.com/disqus/count.js async></script>
<script src=/zh/js/algolia-search-built.min.4387d694ca1258194aaf562b8cd1c400.js type=module></script>
<script id=page-data type=application/json>{"use_headroom":false}</script><script src=/zh/js/wowchemy.min.d1673c7a11d1238516cbe12a1e84257f.js></script>
<script>var mybutton=document.getElementById("backTopBtn");window.onscroll=function(){scrollFunction()};function scrollFunction(){document.body.scrollTop>20||document.documentElement.scrollTop>20?mybutton.style.display="block":mybutton.style.display="none"}function topFunction(){document.body.scrollTop=0,document.documentElement.scrollTop=0}</script><script src=https://cdn.jsdelivr.net/gh/bryanbraun/anchorjs@4.2.2/anchor.min.js integrity="sha512-I7w3ZdSFzw5j3jU3ZkNikBNeIrl3i+hEuEdwNmqUJvwNcaBUNcijnP2gd9DtGlgVYDplfjGoD8vTNsID+lCjqg==" crossorigin=anonymous></script>
<script>anchors.add()</script><script>(function(){"use strict";if(!document.queryCommandSupported("copy"))return;function e(e,t){e.className="highlight-copy-btn",e.textContent=t,setTimeout(function(){e.textContent="",e.className="highlight-copy-btn fa fa-copy"},1e3)}function t(e){var t=window.getSelection(),n=document.createRange();return n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n),t}function n(n){var o,s=document.createElement("button");s.className="highlight-copy-btn fa fa-copy",s.textContent="",o=n.firstElementChild,s.addEventListener("click",function(){try{var n=t(o);document.execCommand("copy"),n.removeAllRanges(),e(s,"已复制")}catch(t){console&&console.log(t),e(s,"Failed :'(")}}),n.appendChild(s)}var s=document.getElementsByClassName("highlight");Array.prototype.forEach.call(s,n)})()</script></body></html>