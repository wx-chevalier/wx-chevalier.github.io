<!doctype html><html lang=zh><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=generator content="Wowchemy 5.5.0 for Hugo"><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=preload as=style href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap"><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap" media=print onload='this.media="all"'><meta name=google-site-verification content="google69a5cccb61297807"><meta name=baidu-site-verification content="cqmZHEleVh"><meta name=description content="📖 Go CheatSheet 是对于 Go 学习/实践过程中的语法与技巧进行盘点，其属于 Awesome CheatSheet 系列，致力于提升学习速度与研发效能，即可以将其当做速查手册，也可以作为轻量级的入门学习资料。本文参考了许多优秀的文章与代码示范，统一声明在"><link rel=alternate hreflang=zh href=https://ng-tech.icu/books/awesome-cheatsheets/1.cs/zoo/go/go-cheatsheet/><meta name=theme-color content="#0a55a7"><link rel=stylesheet href=/css/vendor-bundle.min.c7b8d9abd591ba2253ea42747e3ac3f5.css media=print onload='this.media="all"'><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.1/styles/github.min.css crossorigin=anonymous title=hl-light media=print onload='this.media="all"'><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.1/styles/dracula.min.css crossorigin=anonymous title=hl-dark media=print onload='this.media="all"' disabled><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/instantsearch.css@7.4.5/themes/satellite-min.css integrity="sha256-TehzF/2QvNKhGQrrNpoOb2Ck4iGZ1J/DI4pkd2oUsBc=" crossorigin=anonymous><link rel=stylesheet href=/css/wowchemy.63df6ae9fc2b4cc71b83f1774d780209.css><script async src="https://www.googletagmanager.com/gtag/js?id=G-40NYXJ8823"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-40NYXJ8823")</script><script>var _hmt=_hmt||[];(function(){var e,t=document.createElement("script");t.src="https://hm.baidu.com/hm.js?56df1177bce405601b0ecdd7208f75c6",e=document.getElementsByTagName("script")[0],e.parentNode.insertBefore(t,e)})()</script><link rel=manifest href=/manifest.webmanifest><link rel=icon type=image/png href=/media/icon_hu0f7d075e895d6f5f1f5fdbc1e33dc138_10087_32x32_fill_lanczos_center_3.png><link rel=apple-touch-icon type=image/png href=/media/icon_hu0f7d075e895d6f5f1f5fdbc1e33dc138_10087_180x180_fill_lanczos_center_3.png><link rel=canonical href=https://ng-tech.icu/books/awesome-cheatsheets/1.cs/zoo/go/go-cheatsheet/><meta property="twitter:card" content="summary_large_image"><meta property="twitter:site" content="@wx-chevalier"><meta property="twitter:creator" content="@wx-chevalier"><meta property="og:site_name" content="Next-gen Tech Edu"><meta property="og:url" content="https://ng-tech.icu/books/awesome-cheatsheets/1.cs/zoo/go/go-cheatsheet/"><meta property="og:title" content="Go-CheatSheet | Next-gen Tech Edu"><meta property="og:description" content="📖 Go CheatSheet 是对于 Go 学习/实践过程中的语法与技巧进行盘点，其属于 Awesome CheatSheet 系列，致力于提升学习速度与研发效能，即可以将其当做速查手册，也可以作为轻量级的入门学习资料。本文参考了许多优秀的文章与代码示范，统一声明在"><meta property="og:image" content="https://ng-tech.icu/media/sharing.png"><meta property="twitter:image" content="https://ng-tech.icu/media/sharing.png"><meta property="og:locale" content="zh"><meta property="article:modified_time" content="2023-03-05T15:38:23+08:00"><title>Go-CheatSheet | Next-gen Tech Edu</title></head><body id=top data-spy=scroll data-offset=70 data-target=#TableOfContents class=page-wrapper data-wc-page-id=b083b0e1634c942f0e3673bbda3e0dfa><button onclick=topFunction() id=backTopBtn title="Go to top"><i class="fa-solid fa-circle-up" aria-hidden=true></i></button>
<script src=/js/wowchemy-init.min.14a0ed61c6dbd594b9c75193b25be179.js></script><aside class=search-modal id=search><div class=container><section class=search-header><div class="row no-gutters justify-content-between mb-3"><div class="col-6 search-title"><p>搜索</p></div><div class="col-6 col-search-close"><a class=js-search href=# aria-label=关闭><i class="fas fa-times-circle text-muted" aria-hidden=true></i></a></div></div><div id=search-box></div></section><section class=section-search-results><div id=search-hits></div><div id=search-common-queries></div></section></div></aside><div class=page-header><header class=header--fixed><nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id=navbar-main><div class=container-xl><div class="d-none d-lg-inline-flex"><a class=navbar-brand href=/>Next-gen Tech Edu</a></div><button type=button class=navbar-toggler data-toggle=collapse data-target=#navbar-content aria-controls=navbar-content aria-expanded=false aria-label=切换导航>
<span><i class="fas fa-bars"></i></span></button><div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none"><a class=navbar-brand href=/>Next-gen Tech Edu</a></div><div class="navbar-collapse main-menu-item collapse justify-content-start" id=navbar-content><ul class="navbar-nav d-md-inline-flex"><li class=nav-item><a class=nav-link href=/books-gallery><span>笔记（万篇）</span></a></li><li class=nav-item><a class=nav-link href=/#knowledge-map><span>知识图谱</span></a></li><style>.dropdown-item{display:inline-flex}</style><li class="nav-item dropdown"><a href=# class="nav-link dropdown-toggle" data-toggle=dropdown aria-haspopup=true><span>实验室</span><span class=caret></span></a><div class=dropdown-menu><a class=dropdown-item href=/galaxy-home/gh-craft><span>Craft 方块世界</span></a>
<a class=dropdown-item href=/galaxy-home/glossary-cards><span>3D 知识卡牌</span></a></div></li><style>.dropdown-item{display:inline-flex}</style><li class="nav-item dropdown"><a href=# class="nav-link dropdown-toggle" data-toggle=dropdown aria-haspopup=true><span>其他阅读渠道</span><span class=caret></span></a><div class=dropdown-menu><a class=dropdown-item href=https://zhuanlan.zhihu.com/wxyyxc1992><img style=width:16px;height:16px;display:inline-block;margin-right:8px src=https://ngte-superbed.oss-cn-beijing.aliyuncs.com/item/20230218234451.png></img><span>知乎</span></a>
<a class=dropdown-item href=https://segmentfault.com/blog/wxyyxc1992><img style=width:16px;height:16px;display:inline-block;margin-right:8px src=https://ngte-superbed.oss-cn-beijing.aliyuncs.com/item/20230219113556.png></img><span>SegmentFault</span></a>
<a class=dropdown-item href=https://zhuanlan.zhihu.com/wxyyxc1992><img style=width:16px;height:16px;display:inline-block;margin-right:8px src=https://ngte-superbed.oss-cn-beijing.aliyuncs.com/item/20230219113519.png></img><span>掘金</span></a></div></li></ul></div><ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2"><li class=nav-item><a class="nav-link js-search" href=# aria-label=搜索><i class="fas fa-search" aria-hidden=true></i></a></li><li class=nav-item><a class=nav-link href=https://github.com/wx-chevalier aria-label=GitHub><i class="fa-brands fa-github" aria-hidden=true></i></a></li><div></div><style>@media only screen and (max-width:600px){.jimmysong-template{display:none!important}}</style><li class=jimmysong-template style=color:#fff;font-size:12px><a href=https://jimmysong.io style=color:#fff>By Jimmy Song's Template</a></li></ul></div></nav></header></div><div class=page-body><link rel=stylesheet href=//unpkg.com/heti/umd/heti.min.css><div class="container-xl docs"><div class="row flex-xl-nowrap"><div class=docs-sidebar><form class="docs-search d-flex align-items-center"><button class="btn docs-toggle d-md-none p-0 mr-md-3 w-100" type=button data-toggle=collapse data-target=#docs-nav aria-controls=docs-nav aria-expanded=false aria-label="Toggle section navigation"><div class=d-flex><span class="d-md-none pl-1 flex-grow-1 text-left overflow-hidden">Go</span>
<span><i class="fas fa-chevron-down"></i></span></div></button>
<button class="form-control sidebar-search js-search d-none d-md-flex">
<i class="fas fa-search pr-2"></i>
<span class=sidebar-search-text>搜索...</span>
<span class=sidebar-search-shortcut>/</span></button></form><nav class="collapse docs-links" id=docs-nav><ul class="nav docs-sidenav"><li style=display:inline-flex><a style=cursor:pointer onclick=window.history.back()><i class="fas fa-arrow-left pr-1"></i>
Back</a>
<span>|</span>
<a href=/books/><i class="fa-solid fa-house" style=margin-right:4px></i>
Books</a></li></ul><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-id960cc797d2c07fa738ce5ae692b9c884")' href=#id960cc797d2c07fa738ce5ae692b9c884 aria-expanded=false aria-controls=id960cc797d2c07fa738ce5ae692b9c884 aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/awesome-cheatsheets/1.cs/zoo/>Zoo</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#id960cc797d2c07fa738ce5ae692b9c884 aria-expanded=false aria-controls=id960cc797d2c07fa738ce5ae692b9c884><i class="fa-solid fa-angle-down" id=caret-id960cc797d2c07fa738ce5ae692b9c884></i></a></div><ul class="nav docs-sidenav collapse show" id=id960cc797d2c07fa738ce5ae692b9c884><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-ide0fcb107315f95a304118261bafb0270")' href=#ide0fcb107315f95a304118261bafb0270 aria-expanded=false aria-controls=ide0fcb107315f95a304118261bafb0270 aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/awesome-cheatsheets/1.cs/zoo/c/>C</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#ide0fcb107315f95a304118261bafb0270 aria-expanded=false aria-controls=ide0fcb107315f95a304118261bafb0270><i class="fa-solid fa-angle-right" id=caret-ide0fcb107315f95a304118261bafb0270></i></a></div><ul class="nav docs-sidenav collapse" id=ide0fcb107315f95a304118261bafb0270><li class="child level"><a href=/books/awesome-cheatsheets/1.cs/zoo/c/cpp-cheatsheet/>CPP-CheatSheet</a></li><li class="child level"><a href=/books/awesome-cheatsheets/1.cs/zoo/c/morten-cpp-cheatsheet/>Morten-CPP-CheatSheet</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-idb2edec274d6773aa2b745ae28d9c8e89")' href=#idb2edec274d6773aa2b745ae28d9c8e89 aria-expanded=false aria-controls=idb2edec274d6773aa2b745ae28d9c8e89 aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/awesome-cheatsheets/1.cs/zoo/go/>Go</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#idb2edec274d6773aa2b745ae28d9c8e89 aria-expanded=false aria-controls=idb2edec274d6773aa2b745ae28d9c8e89><i class="fa-solid fa-angle-down" id=caret-idb2edec274d6773aa2b745ae28d9c8e89></i></a></div><ul class="nav docs-sidenav collapse show" id=idb2edec274d6773aa2b745ae28d9c8e89><li class="child level active"><a href=/books/awesome-cheatsheets/1.cs/zoo/go/go-cheatsheet/>Go-CheatSheet</a></li><li class="child level"><a href=/books/awesome-cheatsheets/1.cs/zoo/go/go-concurrentprogramming-cheatsheet/>Go-ConcurrentProgramming-CheatSheet</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-id097626e7138298cbf1117a47038e25b1")' href=#id097626e7138298cbf1117a47038e25b1 aria-expanded=false aria-controls=id097626e7138298cbf1117a47038e25b1 aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/awesome-cheatsheets/1.cs/zoo/java/>Java</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#id097626e7138298cbf1117a47038e25b1 aria-expanded=false aria-controls=id097626e7138298cbf1117a47038e25b1><i class="fa-solid fa-angle-right" id=caret-id097626e7138298cbf1117a47038e25b1></i></a></div><ul class="nav docs-sidenav collapse" id=id097626e7138298cbf1117a47038e25b1><li class="child level"><a href=/books/awesome-cheatsheets/1.cs/zoo/java/gradle-cheatsheet/>Gradle-CheatSheet</a></li><li class="child level"><a href=/books/awesome-cheatsheets/1.cs/zoo/java/java-cheatsheet/>Java-CheatSheet</a></li><li class="child level"><a href=/books/awesome-cheatsheets/1.cs/zoo/java/java-concurrentprogramming-cheatsheet/>Java-ConcurrentProgramming-CheatSheet</a></li><li class="child level"><a href=/books/awesome-cheatsheets/1.cs/zoo/java/java-styleguide-cheatsheet/>Java-StyleGuide-CheatSheet</a></li><li class="child level"><a href=/books/awesome-cheatsheets/1.cs/zoo/java/jvm-tuning-cheatsheet/>JVM-Tuning-CheatSheet</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-id93c46847b7800ad06ded8d50d401f062")' href=#id93c46847b7800ad06ded8d50d401f062 aria-expanded=false aria-controls=id93c46847b7800ad06ded8d50d401f062 aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/awesome-cheatsheets/1.cs/zoo/javascript/>JavaScript</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#id93c46847b7800ad06ded8d50d401f062 aria-expanded=false aria-controls=id93c46847b7800ad06ded8d50d401f062><i class="fa-solid fa-angle-right" id=caret-id93c46847b7800ad06ded8d50d401f062></i></a></div><ul class="nav docs-sidenav collapse" id=id93c46847b7800ad06ded8d50d401f062><li class="child level"><a href=/books/awesome-cheatsheets/1.cs/zoo/javascript/dart-cheatsheet/>Dart-CheatSheet</a></li><li class="child level"><a href=/books/awesome-cheatsheets/1.cs/zoo/javascript/javascript-cheatsheet/>JavaScript-CheatSheet</a></li><li class="child level"><a href=/books/awesome-cheatsheets/1.cs/zoo/javascript/javascript-cheatsheet-en/>JavaScript-CheatSheet-en</a></li><li class="child level"><a href=/books/awesome-cheatsheets/1.cs/zoo/javascript/typescript-cheatsheet/>TypeScript-CheatSheet</a></li><li class="child level"><a href=/books/awesome-cheatsheets/1.cs/zoo/javascript/v8-cheatsheet/>V8-CheatSheet</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-id4fdb6a9c1c59dd283b33aaac86f9823e")' href=#id4fdb6a9c1c59dd283b33aaac86f9823e aria-expanded=false aria-controls=id4fdb6a9c1c59dd283b33aaac86f9823e aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/awesome-cheatsheets/1.cs/zoo/python/>Python</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#id4fdb6a9c1c59dd283b33aaac86f9823e aria-expanded=false aria-controls=id4fdb6a9c1c59dd283b33aaac86f9823e><i class="fa-solid fa-angle-right" id=caret-id4fdb6a9c1c59dd283b33aaac86f9823e></i></a></div><ul class="nav docs-sidenav collapse" id=id4fdb6a9c1c59dd283b33aaac86f9823e><li class="child level"><a href=/books/awesome-cheatsheets/1.cs/zoo/python/python-cheatsheet/>Python-CheatSheet</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-idca4491f13e9c41dd2694c1aaab8eb462")' href=#idca4491f13e9c41dd2694c1aaab8eb462 aria-expanded=false aria-controls=idca4491f13e9c41dd2694c1aaab8eb462 aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/awesome-cheatsheets/1.cs/zoo/ruby/>Ruby</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#idca4491f13e9c41dd2694c1aaab8eb462 aria-expanded=false aria-controls=idca4491f13e9c41dd2694c1aaab8eb462><i class="fa-solid fa-angle-right" id=caret-idca4491f13e9c41dd2694c1aaab8eb462></i></a></div><ul class="nav docs-sidenav collapse" id=idca4491f13e9c41dd2694c1aaab8eb462><li class="child level"><a href=/books/awesome-cheatsheets/1.cs/zoo/ruby/ruby-cheatsheet/>Ruby-CheatSheet</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-id678b4e35fbe5b1cd15f6595bf4a17b45")' href=#id678b4e35fbe5b1cd15f6595bf4a17b45 aria-expanded=false aria-controls=id678b4e35fbe5b1cd15f6595bf4a17b45 aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/awesome-cheatsheets/1.cs/zoo/rust/>Rust</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#id678b4e35fbe5b1cd15f6595bf4a17b45 aria-expanded=false aria-controls=id678b4e35fbe5b1cd15f6595bf4a17b45><i class="fa-solid fa-angle-right" id=caret-id678b4e35fbe5b1cd15f6595bf4a17b45></i></a></div><ul class="nav docs-sidenav collapse" id=id678b4e35fbe5b1cd15f6595bf4a17b45><li class="child level"><a href=/books/awesome-cheatsheets/1.cs/zoo/rust/rust-cheatsheet/>Rust-CheatSheet</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-id8df4b58de5c2496d1e3638c0ae21af1c")' href=#id8df4b58de5c2496d1e3638c0ae21af1c aria-expanded=false aria-controls=id8df4b58de5c2496d1e3638c0ae21af1c aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/awesome-cheatsheets/1.cs/zoo/swift/>Swift</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#id8df4b58de5c2496d1e3638c0ae21af1c aria-expanded=false aria-controls=id8df4b58de5c2496d1e3638c0ae21af1c><i class="fa-solid fa-angle-right" id=caret-id8df4b58de5c2496d1e3638c0ae21af1c></i></a></div><ul class="nav docs-sidenav collapse" id=id8df4b58de5c2496d1e3638c0ae21af1c><li class="child level"><a href=/books/awesome-cheatsheets/1.cs/zoo/swift/swift-cheatsheet/>Swift-CheatSheet</a></li></ul></div></ul></div></nav></div><div class="d-none d-xl-block col-xl-2 docs-toc"><ul class="nav toc-top"><li><a href=# id=back_to_top class=docs-toc-title>目录</a></li></ul><nav id=TableOfContents><ul><li><a href=#package>Package</a></li><li><a href=#go-modules>Go Modules</a><ul><li><a href=#模块结构>模块结构</a></li><li><a href=#外部依赖>外部依赖</a></li></ul></li><li><a href=#初始化函数>初始化函数</a></li></ul><ul><li><a href=#变量声明与赋值>变量声明与赋值</a></li><li><a href=#条件判断>条件判断</a><ul><li><a href=#switch>Switch</a></li></ul></li><li><a href=#循环>循环</a></li></ul><ul><li><a href=#定义参数与返回值>定义，参数与返回值</a></li><li><a href=#闭包--closure>闭包 | Closure</a></li><li><a href=#函数执行>函数执行</a></li><li><a href=#异常处理>异常处理</a></li><li><a href=#panic-与-recover>Panic 与 Recover</a></li></ul><ul><li><a href=#类型绑定与初始化>类型绑定与初始化</a></li><li><a href=#基本数据类型>基本数据类型</a><ul><li><a href=#字符串>字符串</a></li></ul></li><li><a href=#序列类型>序列类型</a><ul><li><a href=#array>Array</a></li><li><a href=#slice>Slice</a></li></ul></li><li><a href=#map--映射类型>Map | 映射类型</a></li></ul><ul><li><a href=#struct--结构体>Struct | 结构体</a><ul><li><a href=#new-与-make>new 与 make</a></li></ul></li><li><a href=#pointer--指针>Pointer | 指针</a></li><li><a href=#interface--接口>Interface | 接口</a></li><li><a href=#embedding--嵌入>Embedding | 嵌入</a></li><li><a href=#reflection--generics--反射与泛型>Reflection & Generics | 反射与泛型</a></li></ul><ul><li><a href=#http-server>HTTP Server</a></li><li><a href=#beego>Beego</a></li></ul><ul><li><a href=#文件读写>文件读写</a></li><li><a href=#测试>测试</a></li></ul></nav><div class="subscribe-module col-24 mt-1"><img src=https://ngte-superbed.oss-cn-beijing.aliyuncs.com/item/20230220172727.png alt=image title=王下邀月熊的微信公众号></div></div><main class="py-md-3 pl-md-3 docs-content col-xl-8" role=main><article class=article><h1>Go-CheatSheet</h1><div class=article-style><p><figure><div class="d-flex justify-content-center"><div class=w-100><img src=https://user-images.githubusercontent.com/5803001/38078769-e6b9ecea-336f-11e8-89c8-b40880b3428c.jpg alt=group loading=lazy data-zoomable></div></div></figure></p><blockquote><p>📖 <a href=https://github.com/wx-chevalier/Awesome-CheatSheets/blob/master/ProgrammingLanguage/Go/Go-CheatSheet.md target=_blank rel=noopener>Go CheatSheet</a> 是对于 Go 学习/实践过程中的语法与技巧进行盘点，其属于 <a href=https://github.com/wx-chevalier/Awesome-CheatSheets/ target=_blank rel=noopener>Awesome CheatSheet</a> 系列，致力于提升学习速度与研发效能，即可以将其当做速查手册，也可以作为轻量级的入门学习资料。本文参考了许多优秀的文章与代码示范，统一声明在了 <a href=https://github.com/wx-chevalier/Awesome-Lists/blob/master/ProgrammingLanguage/Go/Go-List.md target=_blank rel=noopener>Go Links</a>；如果希望深入了解某方面的内容，可以继续阅读 <a href=https://github.com/wx-chevalier/ProgrammingLanguage-Series/blob/master/Go/README.md target=_blank rel=noopener>Go 开发：语法基础与工程实践</a>，或者前往 <a href=https://github.com/wx-chevalier/coding-snippets/ target=_blank rel=noopener>coding-snippets/go</a> 查看使用 Go 解决常见的数据结构与算法、设计模式、业务功能方面的代码实现。</p></blockquote><h1 id=go-cheatsheet--go-语法速览与实践清单>Go CheatSheet | Go 语法速览与实践清单</h1><p>Go (a.k.a. Golang) is a statically-typed programming language first developed at Google. It is derived from C with additional features such as garbage collection, type safety, dynamic-typing capabilities, additional built-in types, and a large standard library.</p><p>可以前往<a href=https://golang.org/dl/ target=_blank rel=noopener>这里</a>下载 Go SDK 安装包，或者使用 brew 等包管理器安装。现在我们也推荐使用 <a href=https://github.com/moovweb/gvm target=_blank rel=noopener>gvm</a> 这样的专用版本管理工具，来方便地更新与切换版本。环境配置完毕后，可以使用 go get 获取依赖，go run 运行程序，go build 来编译项目生成与包名(文件夹名)一致的可执行文件。Golang 1.8 之后支持 dep 依赖管理工具，对于空的项目使用 dep init 初始化依赖配置，其会生成 <code>Gopkg.toml Gopkg.lock vendor/</code> 这三个文件(夹)。</p><p>在这里，我们首先对于 Go 的常用语法有所了解，Go 语言设计的关键字，了解这些关键字有助于命名变量的冲突避免：</p><pre tabindex=0><code>break    default      func    interface    select
case     defer        go      map          struct
chan     else         goto    package      switch
const    fallthrough  if      range        type
continue for          import  return       var
</code></pre><h1 id=包管理与模块机制>包管理与模块机制</h1><p>Golang 的包管理是一直是为人诟病之处，从 Golang 1.5 引入的 vendor 机制，到准官方工具 dep, 再到 Go 1.11 引入了 Go Modules，其包管理与模块机制一直也在不断地完善。</p><h2 id=package>Package</h2><p>早期 Go 命令依赖于 GOPATH 环境变量进行代码组织，多项目情况下也可以使用 ln 进行目录映射以方便进行项目管；GOPATH 允许设置多个目录，每个目录都会包含三个子目录：src 用于存放源代码，pkg 用于存放编译后生成的文件，bin 用于存放编译后生成的可执行文件。</p><p>Go 并没有相对路径引入，而是以文件夹为单位定义模块；并且规定每个源文件的首部需要进行包声明，可执行文件默认放在 main 包中。如上文所述，GOPATH 环境变量为我们指明了本地工作空间的地址，而每个导入路径都会指明唯一的包。标准库中的包往往是 <code>fmt</code>, <code>net/http</code> 这样的短路径；而对于自定义的包，则必须指明根路径以避免潜在的冲突。如果我们使用了 Github 这样的源码仓库，则需要使用 <code>github.com/user</code> 作为根路径。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// goworkdir/src/project1/utils/auth.go
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>package</span> <span class=nx>utils</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>Test1</span><span class=p>()</span> <span class=kt>string</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=s>&#34;Test1&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// goworkdir/src/project1/controllers/login.go
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>package</span> <span class=nx>controllers</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=s>&#34;project1/utils&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>Test2</span><span class=p>()</span> <span class=kt>string</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>utils</span><span class=p>.</span><span class=nf>Test1</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// goworkdir/src/project1/main.go
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;project1/controllers&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>controllers</span><span class=p>.</span><span class=nf>Test2</span><span class=p>())</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>Go 中还允许针对不同的编译目标平台引入不同的文件:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=nx>mypkg_linux</span><span class=p>.</span><span class=k>go</span>         <span class=c1>// only builds on linux systems
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>mypkg_windows_amd64</span><span class=p>.</span><span class=k>go</span> <span class=c1>// only builds on windows 64bit platforms
</span></span></span></code></pre></div><p>我们可以使用 <code>dep ensure -add github.com/pkg/errors</code> 添加依赖，运行之后，其会在 toml 文件中添加如下锁：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-toml data-lang=toml><span class=line><span class=cl><span class=p>[[</span><span class=nx>constraint</span><span class=p>]]</span>
</span></span><span class=line><span class=cl>  <span class=nx>name</span> <span class=p>=</span> <span class=s2>&#34;github.com/pkg/errors&#34;</span>
</span></span><span class=line><span class=cl>  <span class=nx>version</span> <span class=p>=</span> <span class=s2>&#34;0.8.0&#34;</span>
</span></span></code></pre></div><p>简单的 Go 中 Hello World 代码如下：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;hello world&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h2 id=go-modules>Go Modules</h2><p>Go Modules 将包名与路径分离，可以存放于文件系统上的任何为止，而不用管 GOPATH 路径到底是什么，我们可以创建任意的项目目录:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>$ mkdir -p /tmp/scratchpad/hello
</span></span><span class=line><span class=cl>$ <span class=nb>cd</span> /tmp/scratchpad/hello
</span></span></code></pre></div><p>然后初始化所需要的模块:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>$ go mod init github.com/you/hello
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>go: creating new go.mod: module github.com/you/hello
</span></span></code></pre></div><p>然后照常编写 Go 模块代码:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// hello.go
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;rsc.io/quote&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>quote</span><span class=p>.</span><span class=nf>Hello</span><span class=p>())</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>在执行 <code>go build</code> 命令之后，即可以在 <code>go.mod</code> 文件中查看模块定义与显式的声明:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>$ cat go.mod
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>module github.com/you/hello
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>require rsc.io/quote v1.5.2
</span></span></code></pre></div><h3 id=模块结构>模块结构</h3><p>模块是包含了 Go 源文件的目录树，并在根目录中添加了名为 go.mod 的文件，go.mod 包含模块导入名称，声明了要求的依赖项，排除的依赖项和替换的依赖项。</p><pre tabindex=0><code>module my/thing

require (
        one/thing v1.3.2
        other/thing v2.5.0 // indirect
        ...
)

exclude (
        bad/thing v0.7.3
)

replace (
        src/thing 1.0.2 =&gt; dst/thing v1.1.0
)
</code></pre><p>需要注意的是，该文件中声明的依赖，并不会在模块的源代码中使用 import 自动导入，还是需要我们人工添加 import 语句来导入的。模块可以包含其他模块，在这种情况下，它们的内容将从父模块中排除。除了 go.mod 文件外，跟目录下还可以存在一个名为 go.sum 的文件，用于保存所有的依赖项的哈希摘要校验之，用于验证缓存的依赖项是否满足模块要求。</p><h3 id=外部依赖>外部依赖</h3><p>模块依赖项会被下载并存储到 <code>GOPATH/src/mod</code> 目录中，直接后果就是废除了模块的组织名称。假设我们正在开发的项目依赖于 github.com/me/lib 且版本号 1.0.0 的模块，对于这种情况，我们会发现在 GOPATH/src/mod 中文件结构如下</p><p><figure><div class="d-flex justify-content-center"><div class=w-100><img src=https://www.twle.cn/static/i/golang/20180803_golang_3.png alt loading=lazy data-zoomable></div></div></figure></p><p>Go 的模块版本号必须以 v 开头，在发布版本时可以通过 Tag 方式来指定不同的版本。我们可以使用 <code>go mod tidy</code> 来移除未被使用的依赖，使用 <code>go mod vendor</code> 可以生成独立的 vendor 目录。</p><h2 id=初始化函数>初始化函数</h2><p>各个包中默认首字母大写的函数作为其他包可见的导出函数，而小写函数则默认外部不可见的私有函数。Go 允许在文件中包含初始化函数，默认使用 <code>_</code> 引入的包仅调用初始化函数：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>mongo</span> <span class=s2>&#34;mywebapp/libs/mongodb/db&#34;</span> <span class=o>//</span> <span class=n>对引入的模块重命名</span>
</span></span><span class=line><span class=cl>        <span class=n>_</span> <span class=s2>&#34;mywebapp/libs/mysql/db&#34;</span> <span class=o>//</span> <span class=n>使用空白下划线表示仅调用其初始化函数</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span></code></pre></div><p>初始化函数会于属性初始化之后被调用：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// sandbox.go
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>var</span> <span class=nx>_</span> <span class=kt>int64</span> <span class=p>=</span> <span class=nf>s</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>init</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;init in sandbox.go&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>s</span><span class=p>()</span> <span class=kt>int64</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;calling s() in sandbox.go&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;main&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// a.go
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>var</span> <span class=nx>_</span> <span class=kt>int64</span> <span class=p>=</span> <span class=nf>a</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>init</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;init in a.go&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>a</span><span class=p>()</span> <span class=kt>int64</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;calling a() in a.go&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=mi>2</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=cm>/* 输出结果
</span></span></span><span class=line><span class=cl><span class=cm>calling a() in a.go
</span></span></span><span class=line><span class=cl><span class=cm>calling s() in sandbox.go
</span></span></span><span class=line><span class=cl><span class=cm>init in a.go
</span></span></span><span class=line><span class=cl><span class=cm>init in sandbox.go
</span></span></span><span class=line><span class=cl><span class=cm>main
</span></span></span><span class=line><span class=cl><span class=cm>*/</span>
</span></span></code></pre></div><p>而单个文件中也可以定义多个初始化函数：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>init</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;init 1&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>init</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;init 2&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;main&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h1 id=表达式与控制流>表达式与控制流</h1><h2 id=变量声明与赋值>变量声明与赋值</h2><p>作为强类型静态语言，Go 允许我们在变量之后标识数据类型，也为我们提供了自动类型推导的功能。不过需要注意的是，在函数体外 Go 仅允许使用声明式语句。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// 声明三个变量，皆为 bool 类型
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>var</span> <span class=nx>c</span><span class=p>,</span> <span class=nx>python</span><span class=p>,</span> <span class=nx>java</span> <span class=kt>bool</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 声明不同类型的变量，并且赋值
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>var</span> <span class=nx>i</span> <span class=kt>bool</span><span class=p>,</span> <span class=nx>j</span> <span class=kt>int</span> <span class=p>=</span> <span class=kc>true</span><span class=p>,</span> <span class=mi>2</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 复杂变量声明
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>var</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>	<span class=nx>ToBe</span>   <span class=kt>bool</span>       <span class=p>=</span> <span class=kc>false</span>
</span></span><span class=line><span class=cl>	<span class=nx>MaxInt</span> <span class=kt>uint64</span>     <span class=p>=</span> <span class=mi>1</span><span class=o>&lt;&lt;</span><span class=mi>64</span> <span class=o>-</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>	<span class=nx>z</span>      <span class=kt>complex128</span> <span class=p>=</span> <span class=nx>cmplx</span><span class=p>.</span><span class=nf>Sqrt</span><span class=p>(</span><span class=o>-</span><span class=mi>5</span> <span class=o>+</span> <span class=m>12i</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 短声明变量
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>c</span><span class=p>,</span> <span class=nx>python</span><span class=p>,</span> <span class=nx>java</span> <span class=o>:=</span> <span class=kc>true</span><span class=p>,</span> <span class=kc>false</span><span class=p>,</span> <span class=s>&#34;no!&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 声明常量
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>const</span> <span class=nx>constant</span> <span class=p>=</span> <span class=s>&#34;This is a constant&#34;</span>
</span></span></code></pre></div><p>在 Go 中，如果我们需要比较两个复杂对象的相似性，可以使用 reflect.DeepEqual 方法：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=nx>m1</span> <span class=o>:=</span> <span class=kd>map</span><span class=p>[</span><span class=kt>string</span><span class=p>]</span><span class=kt>int</span><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;a&#34;</span><span class=p>:</span><span class=mi>1</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;b&#34;</span><span class=p>:</span><span class=mi>2</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=nx>m2</span> <span class=o>:=</span> <span class=kd>map</span><span class=p>[</span><span class=kt>string</span><span class=p>]</span><span class=kt>int</span><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;a&#34;</span><span class=p>:</span><span class=mi>1</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;b&#34;</span><span class=p>:</span><span class=mi>2</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>reflect</span><span class=p>.</span><span class=nf>DeepEqual</span><span class=p>(</span><span class=nx>m1</span><span class=p>,</span> <span class=nx>m2</span><span class=p>))</span>
</span></span></code></pre></div><h2 id=条件判断>条件判断</h2><p>Go 提供了增强型的 if 语句进行条件判断：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// 基础形式
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>if</span> <span class=nx>x</span> <span class=p>&gt;</span> <span class=mi>0</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=k>return</span> <span class=nx>x</span>
</span></span><span class=line><span class=cl><span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=k>return</span> <span class=o>-</span><span class=nx>x</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 条件判断之前添加自定义语句
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>if</span> <span class=nx>a</span> <span class=o>:=</span> <span class=nx>b</span> <span class=o>+</span> <span class=nx>c</span><span class=p>;</span> <span class=nx>a</span> <span class=p>&lt;</span> <span class=mi>42</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=k>return</span> <span class=nx>a</span>
</span></span><span class=line><span class=cl><span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=k>return</span> <span class=nx>a</span> <span class=o>-</span> <span class=mi>42</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 常用的类型判断
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>var</span> <span class=nx>val</span> <span class=kd>interface</span><span class=p>{}</span>
</span></span><span class=line><span class=cl><span class=nx>val</span> <span class=p>=</span> <span class=s>&#34;foo&#34;</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=nx>str</span><span class=p>,</span> <span class=nx>ok</span> <span class=o>:=</span> <span class=nx>val</span><span class=p>.(</span><span class=kt>string</span><span class=p>);</span> <span class=nx>ok</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>str</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h3 id=switch>Switch</h3><p>Go 也支持使用 Switch 语句：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// 基础格式
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>switch</span> <span class=nx>operatingSystem</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>case</span> <span class=s>&#34;darwin&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;Mac OS Hipster&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=c1>// 默认 break，不需要显式声明
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>case</span> <span class=s>&#34;linux&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;Linux Geek&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>default</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=c1>// Windows, BSD, ...
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;Other&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 类似于 if，可以在条件之前添加自定义语句
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>switch</span> <span class=nx>os</span> <span class=o>:=</span> <span class=nx>runtime</span><span class=p>.</span><span class=nx>GOOS</span><span class=p>;</span> <span class=nx>os</span> <span class=p>{</span>
</span></span><span class=line><span class=cl><span class=k>case</span> <span class=s>&#34;darwin&#34;</span><span class=p>:</span> <span class=o>...</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 使用 switch 语句进行类型判断：
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>switch</span> <span class=nx>v</span> <span class=o>:=</span> <span class=nx>anything</span><span class=p>.(</span><span class=kd>type</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>case</span> <span class=kt>string</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>v</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=k>case</span> <span class=kt>int32</span><span class=p>,</span> <span class=kt>int64</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=o>...</span>
</span></span><span class=line><span class=cl>  <span class=k>default</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;unknown&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>Switch 中也支持进行比较：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=nx>number</span> <span class=o>:=</span> <span class=mi>42</span>
</span></span><span class=line><span class=cl><span class=k>switch</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=k>case</span> <span class=nx>number</span> <span class=p>&lt;</span> <span class=mi>42</span><span class=p>:</span>
</span></span><span class=line><span class=cl>		<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;Smaller&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=k>case</span> <span class=nx>number</span> <span class=o>==</span> <span class=mi>42</span><span class=p>:</span>
</span></span><span class=line><span class=cl>		<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;Equal&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=k>case</span> <span class=nx>number</span> <span class=p>&gt;</span> <span class=mi>42</span><span class=p>:</span>
</span></span><span class=line><span class=cl>		<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;Greater&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>或者进行多条件匹配：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kd>var</span> <span class=nx>char</span> <span class=kt>byte</span> <span class=p>=</span> <span class=sc>&#39;?&#39;</span>
</span></span><span class=line><span class=cl><span class=k>switch</span> <span class=nx>char</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=k>case</span> <span class=sc>&#39; &#39;</span><span class=p>,</span> <span class=sc>&#39;?&#39;</span><span class=p>,</span> <span class=sc>&#39;&amp;&#39;</span><span class=p>,</span> <span class=sc>&#39;=&#39;</span><span class=p>,</span> <span class=sc>&#39;#&#39;</span><span class=p>,</span> <span class=sc>&#39;+&#39;</span><span class=p>,</span> <span class=sc>&#39;%&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>		<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;Should escape&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>Switch 中还支持对于类型的条件判断：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kd>type</span> <span class=nx>T</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>name</span> <span class=kt>string</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>t</span> <span class=o>:=</span> <span class=nx>T</span><span class=p>{}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>switch</span> <span class=p>(</span><span class=kd>interface</span><span class=p>{})(</span><span class=nx>t</span><span class=p>).(</span><span class=kd>type</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl><span class=k>case</span> <span class=nx>T</span><span class=p>:</span>
</span></span><span class=line><span class=cl>	<span class=nx>fmt</span><span class=p>.</span><span class=nf>Print</span><span class=p>(</span><span class=s>&#34;1&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h2 id=循环>循环</h2><p>Go 支持使用 for 语句进行循环，不存在 while 或者 until:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=k>for</span> <span class=nx>i</span> <span class=o>:=</span> <span class=mi>1</span><span class=p>;</span> <span class=nx>i</span> <span class=p>&lt;</span> <span class=mi>10</span><span class=p>;</span> <span class=nx>i</span><span class=o>++</span> <span class=p>{</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// while - loop
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>for</span> <span class=p>;</span> <span class=nx>i</span> <span class=p>&lt;</span> <span class=mi>10</span><span class=p>;</span>  <span class=p>{</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 单条件情况下可以忽略分号
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>for</span> <span class=nx>i</span> <span class=p>&lt;</span> <span class=mi>10</span>  <span class=p>{</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// ~ while (true)
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>for</span> <span class=p>{</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>我们也可以使用 range 函数，对于 Arrays 与 Slices 进行遍历:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// loop over an array/a slice
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>for</span> <span class=nx>i</span><span class=p>,</span> <span class=nx>e</span> <span class=o>:=</span> <span class=k>range</span> <span class=nx>a</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// i 表示下标，e 表示元素
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 仅需要元素
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>for</span> <span class=nx>_</span><span class=p>,</span> <span class=nx>e</span> <span class=o>:=</span> <span class=k>range</span> <span class=nx>a</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// e is the element
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 或者仅需要下标
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>for</span> <span class=nx>i</span> <span class=o>:=</span> <span class=k>range</span> <span class=nx>a</span> <span class=p>{</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 定时执行
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>for</span> <span class=k>range</span> <span class=nx>time</span><span class=p>.</span><span class=nf>Tick</span><span class=p>(</span><span class=nx>time</span><span class=p>.</span><span class=nx>Second</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// do it once a sec
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span>
</span></span></code></pre></div><p>因为 Go 没有逗号运算符，并且 ++ 与 &ndash; 是语句而非表达式，因此当我们想要去同时处理多个变量时，需要使用并行赋值:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// Reverse a
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>for</span> <span class=nx>i</span><span class=p>,</span> <span class=nx>j</span> <span class=o>:=</span> <span class=mi>0</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=nx>a</span><span class=p>)</span><span class=o>-</span><span class=mi>1</span><span class=p>;</span> <span class=nx>i</span> <span class=p>&lt;</span> <span class=nx>j</span><span class=p>;</span> <span class=nx>i</span><span class=p>,</span> <span class=nx>j</span> <span class=p>=</span> <span class=nx>i</span><span class=o>+</span><span class=mi>1</span><span class=p>,</span> <span class=nx>j</span><span class=o>-</span><span class=mi>1</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>a</span><span class=p>[</span><span class=nx>i</span><span class=p>],</span> <span class=nx>a</span><span class=p>[</span><span class=nx>j</span><span class=p>]</span> <span class=p>=</span> <span class=nx>a</span><span class=p>[</span><span class=nx>j</span><span class=p>],</span> <span class=nx>a</span><span class=p>[</span><span class=nx>i</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h1 id=function--函数>Function | 函数</h1><h2 id=定义参数与返回值>定义，参数与返回值</h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// 简单函数定义
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>func</span> <span class=nf>functionName</span><span class=p>()</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 含参函数定义
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>func</span> <span class=nf>functionName</span><span class=p>(</span><span class=nx>param1</span> <span class=kt>string</span><span class=p>,</span> <span class=nx>param2</span> <span class=kt>int</span><span class=p>)</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 多个相同类型参数的函数定义
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>func</span> <span class=nf>functionName</span><span class=p>(</span><span class=nx>param1</span><span class=p>,</span> <span class=nx>param2</span> <span class=kt>int</span><span class=p>)</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 函数表达式定义
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>add</span> <span class=o>:=</span> <span class=kd>func</span><span class=p>(</span><span class=nx>a</span><span class=p>,</span> <span class=nx>b</span> <span class=kt>int</span><span class=p>)</span> <span class=kt>int</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=k>return</span> <span class=nx>a</span> <span class=o>+</span> <span class=nx>b</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>Go 支持函数的最后一个参数使用 &mldr; 设置为不定参数，即可以传入一个或多个参数值：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kd>func</span> <span class=nf>adder</span><span class=p>(</span><span class=nx>args</span> <span class=o>...</span><span class=kt>int</span><span class=p>)</span> <span class=kt>int</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>total</span> <span class=o>:=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>	<span class=k>for</span> <span class=nx>_</span><span class=p>,</span> <span class=nx>v</span> <span class=o>:=</span> <span class=k>range</span> <span class=nx>args</span> <span class=p>{</span> <span class=c1>// Iterates over the arguments whatever the number.
</span></span></span><span class=line><span class=cl><span class=c1></span>		<span class=nx>total</span> <span class=o>+=</span> <span class=nx>v</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl>	<span class=k>return</span> <span class=nx>total</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nf>adder</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>)</span> <span class=c1>// 6
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nf>adder</span><span class=p>(</span><span class=mi>9</span><span class=p>,</span> <span class=mi>9</span><span class=p>)</span> <span class=c1>// 18
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=nx>nums</span> <span class=o>:=</span> <span class=p>[]</span><span class=kt>int</span><span class=p>{</span><span class=mi>10</span><span class=p>,</span> <span class=mi>20</span><span class=p>,</span> <span class=mi>30</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=nf>adder</span><span class=p>(</span><span class=nx>nums</span><span class=o>...</span><span class=p>)</span> <span class=c1>// 60
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=c1>// 传入任意类型的不定参数
</span></span></span></code></pre></div><p>我们也可以使用 Function Stub 作为函数参数传入，以实现回调函数的功能：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kd>func</span> <span class=nf>Filter</span><span class=p>(</span><span class=nx>s</span> <span class=p>[]</span><span class=kt>int</span><span class=p>,</span> <span class=nx>fn</span> <span class=kd>func</span><span class=p>(</span><span class=kt>int</span><span class=p>)</span> <span class=kt>bool</span><span class=p>)</span> <span class=p>[]</span><span class=kt>int</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>p</span> <span class=p>[]</span><span class=kt>int</span> <span class=c1>// == nil
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>for</span> <span class=nx>_</span><span class=p>,</span> <span class=nx>v</span> <span class=o>:=</span> <span class=k>range</span> <span class=nx>s</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=nf>fn</span><span class=p>(</span><span class=nx>v</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>p</span> <span class=p>=</span> <span class=nb>append</span><span class=p>(</span><span class=nx>p</span><span class=p>,</span> <span class=nx>v</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>p</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>Go 支持多个返回值：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// 返回单个值
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>func</span> <span class=nf>functionName</span><span class=p>()</span> <span class=kt>int</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=mi>42</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 返回多个值
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>func</span> <span class=nf>returnMulti</span><span class=p>()</span> <span class=p>(</span><span class=kt>int</span><span class=p>,</span> <span class=kt>string</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=mi>42</span><span class=p>,</span> <span class=s>&#34;foobar&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kd>var</span> <span class=nx>x</span><span class=p>,</span> <span class=nx>str</span> <span class=p>=</span> <span class=nf>returnMulti</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 命名返回多个值
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>func</span> <span class=nf>returnMulti2</span><span class=p>()</span> <span class=p>(</span><span class=nx>n</span> <span class=kt>int</span><span class=p>,</span> <span class=nx>s</span> <span class=kt>string</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>n</span> <span class=p>=</span> <span class=mi>42</span>
</span></span><span class=line><span class=cl>    <span class=nx>s</span> <span class=p>=</span> <span class=s>&#34;foobar&#34;</span>
</span></span><span class=line><span class=cl>    <span class=c1>// n and s will be returned
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>return</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kd>var</span> <span class=nx>x</span><span class=p>,</span> <span class=nx>str</span> <span class=p>=</span> <span class=nf>returnMulti2</span><span class=p>()</span>
</span></span></code></pre></div><p>虽然 Go 不是函数式语言，但是也可以用其实现柯里函数(Currying Function):</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kd>func</span> <span class=nf>add</span><span class=p>(</span><span class=nx>x</span><span class=p>,</span> <span class=nx>y</span> <span class=kt>int</span><span class=p>)</span> <span class=kt>int</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>x</span><span class=o>+</span> <span class=nx>y</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>adder</span><span class=p>(</span><span class=nx>x</span> <span class=kt>int</span><span class=p>)</span> <span class=p>(</span><span class=kd>func</span><span class=p>(</span><span class=kt>int</span><span class=p>)</span> <span class=kt>int</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=kd>func</span><span class=p>(</span><span class=nx>y</span> <span class=kt>int</span><span class=p>)</span> <span class=kt>int</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nf>add</span><span class=p>(</span><span class=nx>x</span><span class=p>,</span> <span class=nx>y</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>add3</span> <span class=o>:=</span> <span class=nf>adder</span><span class=p>(</span><span class=mi>3</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nf>add3</span><span class=p>(</span><span class=mi>4</span><span class=p>))</span>    <span class=c1>// 7
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span>
</span></span></code></pre></div><h2 id=闭包--closure>闭包 | Closure</h2><p>Go 同样支持词法作用域与变量保留，因此我们可以使用来访问函数定义处外层的变量：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kd>func</span> <span class=nf>scope</span><span class=p>()</span> <span class=kd>func</span><span class=p>()</span> <span class=kt>int</span><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>outer_var</span> <span class=o>:=</span> <span class=mi>2</span>
</span></span><span class=line><span class=cl>    <span class=nx>foo</span> <span class=o>:=</span> <span class=kd>func</span><span class=p>()</span> <span class=kt>int</span> <span class=p>{</span> <span class=k>return</span> <span class=nx>outer_var</span><span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>foo</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>闭包中并不能够直接修改外层变量，而是会自动重定义新的变量值：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kd>func</span> <span class=nf>outer</span><span class=p>()</span> <span class=p>(</span><span class=kd>func</span><span class=p>()</span> <span class=kt>int</span><span class=p>,</span> <span class=kt>int</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>outer_var</span> <span class=o>:=</span> <span class=mi>2</span>
</span></span><span class=line><span class=cl>    <span class=nx>inner</span> <span class=o>:=</span> <span class=kd>func</span><span class=p>()</span> <span class=kt>int</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>outer_var</span> <span class=o>+=</span> <span class=mi>99</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nx>outer_var</span> <span class=c1>// =&gt; 101 (but outer_var is a newly redefined
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>inner</span><span class=p>,</span> <span class=nx>outer_var</span> <span class=c1>// =&gt; 101, 2 (outer_var is still 2, not mutated by inner!)
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span>
</span></span></code></pre></div><h2 id=函数执行>函数执行</h2><p>Go 中提供了 defer 关键字，允许将某个语句的执行推迟到函数返回语句之前：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kd>func</span> <span class=nf>read</span><span class=p>(</span><span class=o>...</span><span class=p>)</span> <span class=p>(</span><span class=o>...</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>f</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>os</span><span class=p>.</span><span class=nf>Open</span><span class=p>(</span><span class=nx>file</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=o>...</span>
</span></span><span class=line><span class=cl>  <span class=k>defer</span> <span class=nx>f</span><span class=p>.</span><span class=nf>Close</span><span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=o>...</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=p>..</span> <span class=c1>// f will be closed
</span></span></span></code></pre></div><p>多个 defer 出现的时候，多个 defer 之间按照 LIFO（后进先出）的顺序执行:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>(){</span>
</span></span><span class=line><span class=cl>    <span class=k>defer</span> <span class=kd>func</span><span class=p>(){</span>
</span></span><span class=line><span class=cl>        <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;1&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}()</span>
</span></span><span class=line><span class=cl>    <span class=k>defer</span> <span class=kd>func</span><span class=p>(){</span>
</span></span><span class=line><span class=cl>        <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;2&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}()</span>
</span></span><span class=line><span class=cl>    <span class=k>defer</span> <span class=kd>func</span><span class=p>(){</span>
</span></span><span class=line><span class=cl>        <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;3&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}()</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h2 id=异常处理>异常处理</h2><p>Go 语言中并不存在 try-catch 等异常处理的关键字，对于那些可能返回异常的函数，只需要在函数返回值中添加额外的 Error 类型的返回值：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kd>type</span> <span class=kt>error</span> <span class=kd>interface</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nf>Error</span><span class=p>()</span> <span class=kt>string</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>某个可能返回异常的函数调用方式如下：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;errors&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>result</span><span class=p>,</span> <span class=nx>err</span><span class=o>:=</span> <span class=nf>Divide</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>err</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span><span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>result</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>Divide</span><span class=p>(</span><span class=nx>value1</span> <span class=kt>int</span><span class=p>,</span><span class=nx>value2</span> <span class=kt>int</span><span class=p>)(</span><span class=kt>int</span><span class=p>,</span> <span class=kt>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span><span class=p>(</span><span class=nx>value2</span> <span class=o>==</span> <span class=mi>0</span><span class=p>){</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=mi>0</span><span class=p>,</span> <span class=nx>errors</span><span class=p>.</span><span class=nf>New</span><span class=p>(</span><span class=s>&#34;value2 mustn&#39;t be zero&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>value1</span><span class=o>/</span><span class=nx>value2</span> <span class=p>,</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h2 id=panic-与-recover>Panic 与 Recover</h2><p>Go 还为我们提供了 panic 函数，所谓 panic，即是未获得预期结果，常用于抛出异常结果。譬如当我们获得了某个函数返回的异常，却不知道如何处理或者不需要处理时，可以直接通过 panic 函数中断当前运行，打印出错误信息、Goroutine 追踪信息，并且返回非零的状态码：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=nx>_</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>os</span><span class=p>.</span><span class=nf>Create</span><span class=p>(</span><span class=s>&#34;/tmp/file&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nb>panic</span><span class=p>(</span><span class=nx>err</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>当函数 F 调用 panic 时，其执行流程会被终止，而所有的 deferred 函数会被正常的依次执行，然后 F 会返回到调用者。F 此时的行为逻辑与直接调用 panic 函数并无差异，进程会在函数所在 Goroutine 的所有函数执行完毕之后，恢复异常的调用栈。Recover 函数则可以手动地恢复 Panic Goroutine 的执行，正常的执行中 recover 函数会返回 nil；而如果当前 Goroutine 被 panic，recover 函数会捕获传递给 panic 的值，并且恢复正常的执行流。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>(){</span>
</span></span><span class=line><span class=cl>    <span class=k>defer</span> <span class=kd>func</span><span class=p>(){</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=nx>r</span> <span class=o>:=</span> <span class=nb>recover</span><span class=p>();</span><span class=nx>r</span> <span class=o>!=</span> <span class=kc>nil</span><span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>r</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}()</span>
</span></span><span class=line><span class=cl>    <span class=nb>panic</span><span class=p>([]</span><span class=kt>int</span><span class=p>{</span><span class=mi>12312</span><span class=p>})</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h1 id=数据类型与结构>数据类型与结构</h1><p>Go 中可以使用 <code>interface{}</code> 来表示任意类型。</p><h2 id=类型绑定与初始化>类型绑定与初始化</h2><p>Go 中的 type 关键字能够对某个类型进行重命名：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// IntSlice 并不等价于 []int，但是可以利用类型转换进行转换
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>type</span> <span class=nx>IntSlice</span> <span class=p>[]</span><span class=kt>int</span>
</span></span><span class=line><span class=cl><span class=nx>a</span> <span class=o>:=</span> <span class=nx>IntSlice</span><span class=p>{</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>}</span>
</span></span></code></pre></div><p>可以使用 T(v) 或者 obj.(T) 进行类型转换，obj.(T) 仅针对 interface{} 类型起作用：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=nx>t</span> <span class=o>:=</span> <span class=nx>obj</span><span class=p>.(</span><span class=nx>T</span><span class=p>)</span> <span class=c1>// if obj is not T, error
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>t</span><span class=p>,</span> <span class=nx>ok</span> <span class=o>:=</span> <span class=nx>obj</span><span class=p>.(</span><span class=nx>T</span><span class=p>)</span> <span class=c1>// if obj is not T, ok = false
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=c1>// 类型转换与判断
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>str</span><span class=p>,</span> <span class=nx>ok</span> <span class=o>:=</span> <span class=nx>val</span><span class=p>.(</span><span class=kt>string</span><span class=p>);</span>
</span></span></code></pre></div><h2 id=基本数据类型>基本数据类型</h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kd>interface</span> <span class=p>{}</span> <span class=c1>// ~ java Object
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kt>bool</span> <span class=c1>// true/false
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kt>string</span>
</span></span><span class=line><span class=cl><span class=kt>int8</span>  <span class=kt>int16</span>  <span class=kt>int32</span>  <span class=kt>int64</span>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=c1>// =int32 on 32-bit, =int64 if 64-bit OS
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kt>uint8</span> <span class=kt>uint16</span> <span class=kt>uint32</span> <span class=kt>uint64</span> <span class=kt>uintptr</span>
</span></span><span class=line><span class=cl><span class=kt>uint</span>
</span></span><span class=line><span class=cl><span class=kt>byte</span> <span class=c1>// alias for uint8
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kt>rune</span> <span class=c1>// alias for int32, represents a Unicode code point
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kt>float32</span> <span class=kt>float64</span>
</span></span></code></pre></div><h3 id=字符串>字符串</h3><p>Go 中支持以反引号定义多行字符串：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// 多行字符串声明
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>hellomsg</span> <span class=o>:=</span> <span class=s>`
</span></span></span><span class=line><span class=cl><span class=s> &#34;Hello&#34; in Chinese is 你好 (&#39;Ni Hao&#39;)
</span></span></span><span class=line><span class=cl><span class=s> &#34;Hello&#34; in Hindi is नमस्ते (&#39;Namaste&#39;)
</span></span></span><span class=line><span class=cl><span class=s>`</span>
</span></span></code></pre></div><p>fmt 的输出模块为我们提供了方便的格式化字符串输出功能：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;Hello, 你好, नमस्ते, Привет, ᎣᏏᏲ&#34;</span><span class=p>)</span> <span class=c1>// basic print, plus newline
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>p</span> <span class=o>:=</span> <span class=kd>struct</span> <span class=p>{</span> <span class=nx>X</span><span class=p>,</span> <span class=nx>Y</span> <span class=kt>int</span> <span class=p>}{</span> <span class=mi>17</span><span class=p>,</span> <span class=mi>2</span> <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span> <span class=s>&#34;My point:&#34;</span><span class=p>,</span> <span class=nx>p</span><span class=p>,</span> <span class=s>&#34;x coord=&#34;</span><span class=p>,</span> <span class=nx>p</span><span class=p>.</span><span class=nx>X</span> <span class=p>)</span> <span class=c1>// print structs, ints, etc
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>s</span> <span class=o>:=</span> <span class=nx>fmt</span><span class=p>.</span><span class=nf>Sprintln</span><span class=p>(</span> <span class=s>&#34;My point:&#34;</span><span class=p>,</span> <span class=nx>p</span><span class=p>,</span> <span class=s>&#34;x coord=&#34;</span><span class=p>,</span> <span class=nx>p</span><span class=p>.</span><span class=nx>X</span> <span class=p>)</span> <span class=c1>// print to string variable
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%d hex:%x bin:%b fp:%f sci:%e&#34;</span><span class=p>,</span><span class=mi>17</span><span class=p>,</span><span class=mi>17</span><span class=p>,</span><span class=mi>17</span><span class=p>,</span><span class=mf>17.0</span><span class=p>,</span><span class=mf>17.0</span><span class=p>)</span> <span class=c1>// c-ish format
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=c1>// Sprintf 能够仅进行字符串格式化，返回格式化后的字符串，而非输出到控制台
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>s2</span> <span class=o>:=</span> <span class=nx>fmt</span><span class=p>.</span><span class=nf>Sprintf</span><span class=p>(</span> <span class=s>&#34;%d %f&#34;</span><span class=p>,</span> <span class=mi>17</span><span class=p>,</span> <span class=mf>17.0</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 将其输出到错误流中
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>fmt</span><span class=p>.</span><span class=nf>Fprintf</span><span class=p>(</span><span class=nx>os</span><span class=p>.</span><span class=nx>Stderr</span><span class=p>,</span> <span class=s>&#34;an %s\n&#34;</span><span class=p>,</span> <span class=s>&#34;error&#34;</span><span class=p>)</span>
</span></span></code></pre></div><h2 id=序列类型>序列类型</h2><p>Array 与 Slice 都可以用来表示序列数据，二者也有着一定的关联。</p><h3 id=array>Array</h3><p>其中 Array 用于表示固定长度的，相同类型的序列对象，可以使用如下形式创建：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=p>[</span><span class=nx>N</span><span class=p>]</span><span class=nx>Type</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=nx>N</span><span class=p>]</span><span class=nx>Type</span><span class=p>{</span><span class=nx>value1</span><span class=p>,</span> <span class=nx>value2</span><span class=p>,</span> <span class=o>...</span><span class=p>,</span> <span class=nx>valueN</span><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 由编译器自动计算数目
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>[</span><span class=o>...</span><span class=p>]</span><span class=nx>Type</span><span class=p>{</span><span class=nx>value1</span><span class=p>,</span> <span class=nx>value2</span><span class=p>,</span> <span class=o>...</span><span class=p>,</span> <span class=nx>valueN</span><span class=p>}</span>
</span></span></code></pre></div><p>其具体使用方式为：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// 数组声明
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>var</span> <span class=nx>a</span> <span class=p>[</span><span class=mi>10</span><span class=p>]</span><span class=kt>int</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 赋值
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>a</span><span class=p>[</span><span class=mi>3</span><span class=p>]</span> <span class=p>=</span> <span class=mi>42</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 读取
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>i</span> <span class=o>:=</span> <span class=nx>a</span><span class=p>[</span><span class=mi>3</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 声明与初始化
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>var</span> <span class=nx>a</span> <span class=p>=</span> <span class=p>[</span><span class=mi>2</span><span class=p>]</span><span class=kt>int</span><span class=p>{</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=nx>a</span> <span class=o>:=</span> <span class=p>[</span><span class=mi>2</span><span class=p>]</span><span class=kt>int</span><span class=p>{</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 加 ... 会限制数组长度
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>a</span> <span class=o>:=</span> <span class=p>[</span><span class=o>...</span><span class=p>]</span><span class=kt>int</span><span class=p>{</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 声明二维数组
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>array</span> <span class=o>:=</span> <span class=p>[</span><span class=mi>2</span><span class=p>][</span><span class=mi>3</span><span class=p>]</span><span class=kt>int</span><span class=p>{{</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>},</span> <span class=p>{</span><span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>6</span><span class=p>}}</span>
</span></span></code></pre></div><p>Go 内置了 len 与 cap 函数，用于获取数组的尺寸与容量：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kd>var</span> <span class=nx>arr</span> <span class=p>=</span> <span class=p>[</span><span class=mi>3</span><span class=p>]</span><span class=kt>int</span><span class=p>{</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=nx>arr</span> <span class=o>:=</span> <span class=p>[</span><span class=o>...</span><span class=p>]</span><span class=kt>int</span><span class=p>{</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>len</span><span class=p>(</span><span class=nx>arr</span><span class=p>)</span> <span class=c1>// 3
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nb>cap</span><span class=p>(</span><span class=nx>arr</span><span class=p>)</span> <span class=c1>// 3
</span></span></span></code></pre></div><p>不同于 C/C++ 中的指针(Pointer)或者 Java 中的对象引用(Object Reference)，Go 中的 Array 只是值(Value)。这也就意味着，当进行数组拷贝，或者函数调用中的参数传值时，会复制所有的元素副本，而非仅仅传递指针或者引用。显而易见，这种复制的代价会较为昂贵。</p><h3 id=slice>Slice</h3><p>Slice 为我们提供了更为灵活且轻量级地序列类型操作，可以使用如下方式创建 Slice:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// 使用内置函数创建
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nb>make</span><span class=p>([]</span><span class=nx>Type</span><span class=p>,</span> <span class=nx>length</span><span class=p>,</span> <span class=nx>capacity</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>make</span><span class=p>([]</span><span class=nx>Type</span><span class=p>,</span> <span class=nx>length</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 声明为不定长度数组
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>[]</span><span class=nx>Type</span><span class=p>{}</span>
</span></span><span class=line><span class=cl><span class=p>[]</span><span class=nx>Type</span><span class=p>{</span><span class=nx>value1</span><span class=p>,</span> <span class=nx>value2</span><span class=p>,</span> <span class=o>...</span><span class=p>,</span> <span class=nx>valueN</span><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 对现有数组进行切片转换
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>array</span><span class=p>[:]</span>
</span></span><span class=line><span class=cl><span class=nx>array</span><span class=p>[:</span><span class=mi>2</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nx>array</span><span class=p>[</span><span class=mi>2</span><span class=p>:]</span>
</span></span><span class=line><span class=cl><span class=nx>array</span><span class=p>[</span><span class=mi>2</span><span class=p>:</span><span class=mi>3</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 不定类型切片声明
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>a</span> <span class=o>:=</span> <span class=p>[]</span><span class=kd>interface</span><span class=p>{}{</span><span class=mi>2</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=p>[]</span><span class=kd>interface</span><span class=p>{}{</span><span class=mi>3</span><span class=p>,</span> <span class=p>[]</span><span class=kd>interface</span><span class=p>{}{</span><span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>},</span> <span class=mi>6</span><span class=p>},</span> <span class=mi>7</span><span class=p>,</span> <span class=p>[]</span><span class=kd>interface</span><span class=p>{}{</span><span class=mi>8</span><span class=p>}}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 二维不定类型切片
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>b</span> <span class=o>:=</span> <span class=p>[][]</span><span class=kd>interface</span><span class=p>{}{</span>
</span></span><span class=line><span class=cl>		<span class=p>[]</span><span class=kd>interface</span><span class=p>{}{</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>},</span>
</span></span><span class=line><span class=cl>		<span class=p>[]</span><span class=kd>interface</span><span class=p>{}{</span><span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>},</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span></code></pre></div><p>不同于 Array, Slice 可以看做更为灵活的引用类型(Reference Type)，它并不真实地存放数组值，而是包含数组指针(ptr)，len，cap 三个属性的结构体。换言之，Slice 可以看做对于数组中某个段的描述，包含了指向数组的指针，段长度，以及段的最大潜在长度，其结构如下图所示：</p><p><figure><div class="d-flex justify-content-center"><div class=w-100><img src=https://user-images.githubusercontent.com/5803001/38005668-3f06477e-3274-11e8-85d2-fa78b75f411b.png alt="group 2" loading=lazy data-zoomable></div></div></figure></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// 创建 len 为 5，cap 为 5 的 Slice
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>s</span> <span class=o>:=</span> <span class=nb>make</span><span class=p>([]</span><span class=kt>byte</span><span class=p>,</span> <span class=mi>5</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 对 Slice 进行二次切片，此时 len 为 2，cap 为 3
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>s</span> <span class=p>=</span> <span class=nx>s</span><span class=p>[</span><span class=mi>2</span><span class=p>:</span><span class=mi>4</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 恢复 Slice 的长度
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>s</span> <span class=p>=</span> <span class=nx>s</span><span class=p>[:</span><span class=nb>cap</span><span class=p>(</span><span class=nx>s</span><span class=p>)]</span>
</span></span></code></pre></div><p>需要注意的是，切片操作并不会真实地复制 Slice 中值，只是会创建新的指向原数组的指针，这就保证了切片操作和操作数组下标有着相同的高效率。不过如果我们修改 Slice 中的值，那么其会真实修改底层数组中的值，也就会体现到原有的数组中：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=nx>d</span> <span class=o>:=</span> <span class=p>[]</span><span class=kt>byte</span><span class=p>{</span><span class=sc>&#39;r&#39;</span><span class=p>,</span> <span class=sc>&#39;o&#39;</span><span class=p>,</span> <span class=sc>&#39;a&#39;</span><span class=p>,</span> <span class=sc>&#39;d&#39;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=nx>e</span> <span class=o>:=</span> <span class=nx>d</span><span class=p>[</span><span class=mi>2</span><span class=p>:]</span>
</span></span><span class=line><span class=cl><span class=c1>// e == []byte{&#39;a&#39;, &#39;d&#39;}
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>e</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=p>=</span> <span class=sc>&#39;m&#39;</span>
</span></span><span class=line><span class=cl><span class=c1>// e == []byte{&#39;a&#39;, &#39;m&#39;}
</span></span></span><span class=line><span class=cl><span class=c1>// d == []byte{&#39;r&#39;, &#39;o&#39;, &#39;a&#39;, &#39;m&#39;}
</span></span></span></code></pre></div><p>Go 提供了内置的 append 函数，来动态为 Slice 添加数据，该函数会返回新的切片对象，包含了原始的 Slice 中值以及新增的值。如果原有的 Slice 的容量不足以存放新增的序列，那么会自动分配新的内存：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// len=0 cap=0 []
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>var</span> <span class=nx>s</span> <span class=p>[]</span><span class=kt>int</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// len=1 cap=2 [0]
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>s</span> <span class=p>=</span> <span class=nb>append</span><span class=p>(</span><span class=nx>s</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// len=2 cap=2 [0 1]
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>s</span> <span class=p>=</span> <span class=nb>append</span><span class=p>(</span><span class=nx>s</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// len=5 cap=8 [0 1 2 3 4]
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>s</span> <span class=p>=</span> <span class=nb>append</span><span class=p>(</span><span class=nx>s</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 使用 ... 来自动展开数组并进行合并
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>a</span> <span class=o>:=</span> <span class=p>[]</span><span class=kt>string</span><span class=p>{</span><span class=s>&#34;John&#34;</span><span class=p>,</span> <span class=s>&#34;Paul&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=nx>b</span> <span class=o>:=</span> <span class=p>[]</span><span class=kt>string</span><span class=p>{</span><span class=s>&#34;George&#34;</span><span class=p>,</span> <span class=s>&#34;Ringo&#34;</span><span class=p>,</span> <span class=s>&#34;Pete&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=nx>a</span> <span class=p>=</span> <span class=nb>append</span><span class=p>(</span><span class=nx>a</span><span class=p>,</span> <span class=nx>b</span><span class=o>...</span><span class=p>)</span> <span class=c1>// equivalent to &#34;append(a, b[0], b[1], b[2])&#34;
</span></span></span><span class=line><span class=cl><span class=c1>// a == []string{&#34;John&#34;, &#34;Paul&#34;, &#34;George&#34;, &#34;Ringo&#34;, &#34;Pete&#34;}
</span></span></span></code></pre></div><p>我们也可以使用内置的 copy 函数，进行 Slice 的复制，该函数支持对于不同长度的 Slice 进行复制，其会自动使用最小的元素数目。同时，copy 函数还能够自动处理使用了相同的底层数组之间的 Slice 复制，以避免额外的空间浪费。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kd>func</span> <span class=nb>copy</span><span class=p>(</span><span class=nx>dst</span><span class=p>,</span> <span class=nx>src</span> <span class=p>[]</span><span class=nx>T</span><span class=p>)</span> <span class=kt>int</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 申请较大的空间容量
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>t</span> <span class=o>:=</span> <span class=nb>make</span><span class=p>([]</span><span class=kt>byte</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=nx>s</span><span class=p>),</span> <span class=p>(</span><span class=nb>cap</span><span class=p>(</span><span class=nx>s</span><span class=p>)</span><span class=o>+</span><span class=mi>1</span><span class=p>)</span><span class=o>*</span><span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>copy</span><span class=p>(</span><span class=nx>t</span><span class=p>,</span> <span class=nx>s</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nx>s</span> <span class=p>=</span> <span class=nx>t</span>
</span></span></code></pre></div><h2 id=map--映射类型>Map | 映射类型</h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kd>var</span> <span class=nx>m</span> <span class=kd>map</span><span class=p>[</span><span class=kt>string</span><span class=p>]</span><span class=kt>int</span>
</span></span><span class=line><span class=cl><span class=nx>m</span> <span class=p>=</span> <span class=nb>make</span><span class=p>(</span><span class=kd>map</span><span class=p>[</span><span class=kt>string</span><span class=p>]</span><span class=kt>int</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nx>m</span><span class=p>[</span><span class=s>&#34;key&#34;</span><span class=p>]</span> <span class=p>=</span> <span class=mi>42</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 删除某个键
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nb>delete</span><span class=p>(</span><span class=nx>m</span><span class=p>,</span> <span class=s>&#34;key&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 测试该键对应的值是否存在
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>elem</span><span class=p>,</span> <span class=nx>has_value</span> <span class=o>:=</span> <span class=nx>m</span><span class=p>[</span><span class=s>&#34;key&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// map literal
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>var</span> <span class=nx>m</span> <span class=p>=</span> <span class=kd>map</span><span class=p>[</span><span class=kt>string</span><span class=p>]</span><span class=nx>Vertex</span><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;Bell Labs&#34;</span><span class=p>:</span> <span class=p>{</span><span class=mf>40.68433</span><span class=p>,</span> <span class=o>-</span><span class=mf>74.39967</span><span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;Google&#34;</span><span class=p>:</span>    <span class=p>{</span><span class=mf>37.42202</span><span class=p>,</span> <span class=o>-</span><span class=mf>122.08408</span><span class=p>},</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h1 id=struct--interface--结构体与接口>Struct & Interface | 结构体与接口</h1><h2 id=struct--结构体>Struct | 结构体</h2><p>Go 语言中并不存在类的概念，只有结构体，结构体可以看做属性的集合，同时可以为其定义方法。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// 声明结构体
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>type</span> <span class=nx>Vertex</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 结构体的属性，同样遵循大写导出，小写私有的原则
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>X</span><span class=p>,</span> <span class=nx>Y</span> <span class=kt>int</span>
</span></span><span class=line><span class=cl>    <span class=nx>z</span> <span class=kt>bool</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 也可以声明匿名/隐式结构体
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>point</span> <span class=o>:=</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>X</span><span class=p>,</span> <span class=nx>Y</span> <span class=kt>int</span>
</span></span><span class=line><span class=cl><span class=p>}{</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 声明空指针
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>var</span> <span class=nx>v</span> <span class=o>*</span><span class=nx>Vertex</span> <span class=p>=</span> <span class=nb>new</span><span class=p>(</span><span class=nx>Vertex</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 显式声明键
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>var</span> <span class=nx>v</span> <span class=p>=</span> <span class=nx>Vertex</span><span class=p>{</span><span class=nx>X</span><span class=p>:</span> <span class=mi>1</span><span class=p>,</span> <span class=nx>Y</span><span class=p>:</span> <span class=mi>2</span><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 声明数组
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>var</span> <span class=nx>v</span> <span class=p>=</span> <span class=p>[]</span><span class=nx>Vertex</span><span class=p>{{</span><span class=mi>1</span><span class=p>,</span><span class=mi>2</span><span class=p>},{</span><span class=mi>5</span><span class=p>,</span><span class=mi>2</span><span class=p>},{</span><span class=mi>5</span><span class=p>,</span><span class=mi>5</span><span class=p>}}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 创建结构体实例
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>var</span> <span class=nx>v</span> <span class=p>=</span> <span class=nx>Vertex</span><span class=p>{</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 读取或者设置属性
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>v</span><span class=p>.</span><span class=nx>X</span> <span class=p>=</span> <span class=mi>4</span><span class=p>;</span>
</span></span></code></pre></div><p>方法的声明也非常简洁，只需要在 func 关键字与函数名之间声明结构体指针即可，该结构体会在不同的方法间进行复制：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kd>func</span> <span class=p>(</span><span class=nx>v</span> <span class=nx>Vertex</span><span class=p>)</span> <span class=nf>Abs</span><span class=p>()</span> <span class=kt>float64</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>math</span><span class=p>.</span><span class=nf>Sqrt</span><span class=p>(</span><span class=nx>v</span><span class=p>.</span><span class=nx>X</span><span class=o>*</span><span class=nx>v</span><span class=p>.</span><span class=nx>X</span> <span class=o>+</span> <span class=nx>v</span><span class=p>.</span><span class=nx>Y</span><span class=o>*</span><span class=nx>v</span><span class=p>.</span><span class=nx>Y</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Call method
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>v</span><span class=p>.</span><span class=nf>Abs</span><span class=p>()</span>
</span></span></code></pre></div><p>对于那些需要修改当前结构体对象的方法，则需要传入指针：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kd>func</span> <span class=p>(</span><span class=nx>v</span> <span class=o>*</span><span class=nx>Vertex</span><span class=p>)</span> <span class=nf>add</span><span class=p>(</span><span class=nx>n</span> <span class=kt>float64</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>v</span><span class=p>.</span><span class=nx>X</span> <span class=o>+=</span> <span class=nx>n</span>
</span></span><span class=line><span class=cl>    <span class=nx>v</span><span class=p>.</span><span class=nx>Y</span> <span class=o>+=</span> <span class=nx>n</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h3 id=new-与-make>new 与 make</h3><h2 id=pointer--指针>Pointer | 指针</h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// p 是 Vertex 类型
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>p</span> <span class=o>:=</span> <span class=nx>Vertex</span><span class=p>{</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// q 是指向 Vertex 的指针
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>q</span> <span class=o>:=</span> <span class=o>&amp;</span><span class=nx>p</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// r 同样是指向 Vertex 对象的指针
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>r</span> <span class=o>:=</span> <span class=o>&amp;</span><span class=nx>Vertex</span><span class=p>{</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 指向 Vertex 结构体对象的指针类型为 *Vertex
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>var</span> <span class=nx>s</span> <span class=o>*</span><span class=nx>Vertex</span> <span class=p>=</span> <span class=nb>new</span><span class=p>(</span><span class=nx>Vertex</span><span class=p>)</span>
</span></span></code></pre></div><p>当我们在定义结构体时，可以使用指针或者值作为接受者来定义方法用指针作为接收者，那么变量（或者可以称作对象）本身是按引用传递的，在方法内可以修改对象的数据。使用值接收者，以为这是按值传递的，那么对象在方法内是处于只读状态的。并且指针类型时调用方法会复制 receiver, 每调用一次 TestValue，item 就会被复制一次.实际相当于 TestValue(v)，TestPointer(&v)。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kd>type</span> <span class=nx>VideoItem</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>GroupId</span>  <span class=kt>int64</span>
</span></span><span class=line><span class=cl>	<span class=nx>ItemId</span>   <span class=kt>int64</span>
</span></span><span class=line><span class=cl>	<span class=nx>AggrType</span> <span class=kt>int32</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=p>(</span><span class=nx>item</span> <span class=o>*</span><span class=nx>VideoItem</span><span class=p>)</span> <span class=nf>TestPointer</span><span class=p>(</span><span class=nx>GroupId</span> <span class=kt>int64</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;TestPointer %p %v\n&#34;</span><span class=p>,</span> <span class=nx>item</span><span class=p>,</span> <span class=nx>item</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=nx>item</span><span class=p>.</span><span class=nx>GroupId</span> <span class=p>=</span> <span class=nx>GroupId</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=p>(</span><span class=nx>item</span> <span class=nx>VideoItem</span><span class=p>)</span> <span class=nf>TestValue</span><span class=p>(</span><span class=nx>GroupId</span> <span class=kt>int64</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;TestPointer %p %v\n&#34;</span><span class=p>,</span> <span class=o>&amp;</span><span class=nx>item</span><span class=p>,</span> <span class=o>&amp;</span><span class=nx>item</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=nx>item</span><span class=p>.</span><span class=nx>GroupId</span> <span class=p>=</span> <span class=nx>GroupId</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>v</span> <span class=o>:=</span> <span class=nx>VideoItem</span><span class=p>{}</span>
</span></span><span class=line><span class=cl>	<span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;TestPointer %p %v\n&#34;</span><span class=p>,</span> <span class=o>&amp;</span><span class=nx>v</span><span class=p>,</span> <span class=o>&amp;</span><span class=nx>v</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 值不变
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>v</span><span class=p>.</span><span class=nf>TestValue</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// v 的 GroupId 被修改为 2
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=nx>v</span><span class=p>.</span><span class=nf>TestPointer</span><span class=p>(</span><span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 值不变
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=p>(</span><span class=o>&amp;</span><span class=nx>v</span><span class=p>).</span><span class=nf>TestValue</span><span class=p>(</span><span class=mi>3</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// v 的  GroupId 被修改为 4
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=p>(</span><span class=o>&amp;</span><span class=nx>v</span><span class=p>).</span><span class=nf>TestPointer</span><span class=p>(</span><span class=mi>4</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>v</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=cm>/*
</span></span></span><span class=line><span class=cl><span class=cm>TestPointer 0xc420018300 &amp;{0 0 0}
</span></span></span><span class=line><span class=cl><span class=cm>TestPointer 0xc420018360 &amp;{0 0 0}
</span></span></span><span class=line><span class=cl><span class=cm>TestPointer 0xc420018300 &amp;{0 0 0}
</span></span></span><span class=line><span class=cl><span class=cm>TestPointer 0xc4200183c0 &amp;{0 0 0}
</span></span></span><span class=line><span class=cl><span class=cm>TestPointer 0xc420018300 &amp;{0 0 0}
</span></span></span><span class=line><span class=cl><span class=cm>*/</span>
</span></span></code></pre></div><p>传递普通变量传递值拷贝，不能修改原始值，如果是大对象则内存效率不高。
传递变量的指针，指针为固定大小，效率更高，可以就地修改对象的原始值。
在方法集的使用上，无论接收者是变量还是指针，都能直接正确调用，无需特殊处理，能正确调用所有绑定在该值或指针上的方法，Go 会自动帮我们处理引用与解引用。</p><h2 id=interface--接口>Interface | 接口</h2><p>Go 允许我们通过定义接口的方式来实现多态性：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// 接口声明
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>type</span> <span class=nx>Awesomizer</span> <span class=kd>interface</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nf>Awesomize</span><span class=p>()</span> <span class=kt>string</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 结构体并不需要显式实现接口
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>type</span> <span class=nx>Foo</span> <span class=kd>struct</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 而是通过实现所有接口规定的方法的方式，来实现接口
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>func</span> <span class=p>(</span><span class=nx>foo</span> <span class=nx>Foo</span><span class=p>)</span> <span class=nf>Awesomize</span><span class=p>()</span> <span class=kt>string</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=s>&#34;Awesome!&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kd>type</span> <span class=nx>Shape</span> <span class=kd>interface</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>   <span class=nf>area</span><span class=p>()</span> <span class=kt>float64</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>getArea</span><span class=p>(</span><span class=nx>shape</span> <span class=nx>Shape</span><span class=p>)</span> <span class=kt>float64</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>   <span class=k>return</span> <span class=nx>shape</span><span class=p>.</span><span class=nf>area</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>type</span> <span class=nx>Circle</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>   <span class=nx>x</span><span class=p>,</span><span class=nx>y</span><span class=p>,</span><span class=nx>radius</span> <span class=kt>float64</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>type</span> <span class=nx>Rectangle</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>   <span class=nx>width</span><span class=p>,</span> <span class=nx>height</span> <span class=kt>float64</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span><span class=p>(</span><span class=nx>circle</span> <span class=nx>Circle</span><span class=p>)</span> <span class=nf>area</span><span class=p>()</span> <span class=kt>float64</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>   <span class=k>return</span> <span class=nx>math</span><span class=p>.</span><span class=nx>Pi</span> <span class=o>*</span> <span class=nx>circle</span><span class=p>.</span><span class=nx>radius</span> <span class=o>*</span> <span class=nx>circle</span><span class=p>.</span><span class=nx>radius</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span><span class=p>(</span><span class=nx>rect</span> <span class=nx>Rectangle</span><span class=p>)</span> <span class=nf>area</span><span class=p>()</span> <span class=kt>float64</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>   <span class=k>return</span> <span class=nx>rect</span><span class=p>.</span><span class=nx>width</span> <span class=o>*</span> <span class=nx>rect</span><span class=p>.</span><span class=nx>height</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>   <span class=nx>circle</span> <span class=o>:=</span> <span class=nx>Circle</span><span class=p>{</span><span class=nx>x</span><span class=p>:</span><span class=mi>0</span><span class=p>,</span><span class=nx>y</span><span class=p>:</span><span class=mi>0</span><span class=p>,</span><span class=nx>radius</span><span class=p>:</span><span class=mi>5</span><span class=p>}</span>
</span></span><span class=line><span class=cl>   <span class=nx>rectangle</span> <span class=o>:=</span> <span class=nx>Rectangle</span> <span class=p>{</span><span class=nx>width</span><span class=p>:</span><span class=mi>10</span><span class=p>,</span> <span class=nx>height</span><span class=p>:</span><span class=mi>5</span><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>   <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;Circle area: %f\n&#34;</span><span class=p>,</span><span class=nf>getArea</span><span class=p>(</span><span class=nx>circle</span><span class=p>))</span>
</span></span><span class=line><span class=cl>   <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;Rectangle area: %f\n&#34;</span><span class=p>,</span><span class=nf>getArea</span><span class=p>(</span><span class=nx>rectangle</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=c1>//Circle area: 78.539816
</span></span></span><span class=line><span class=cl><span class=c1>//Rectangle area: 50.000000
</span></span></span></code></pre></div><p>惯用的思路是先定义接口，再定义实现，最后定义使用的方法：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>animals</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>type</span> <span class=nx>Animal</span> <span class=kd>interface</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nf>Speaks</span><span class=p>()</span> <span class=kt>string</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// implementation of Animal
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>type</span> <span class=nx>Dog</span> <span class=kd>struct</span><span class=p>{}</span>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=p>(</span><span class=nx>a</span> <span class=nx>Dog</span><span class=p>)</span> <span class=nf>Speaks</span><span class=p>()</span> <span class=kt>string</span> <span class=p>{</span> <span class=k>return</span> <span class=s>&#34;woof&#34;</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=cm>/** 在需要的地方直接引用 **/</span>
</span></span><span class=line><span class=cl><span class=kn>package</span> <span class=nx>circus</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=s>&#34;animals&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>Perform</span><span class=p>(</span><span class=nx>a</span> <span class=nx>animal</span><span class=p>.</span><span class=nx>Animal</span><span class=p>)</span> <span class=p>{</span> <span class=k>return</span> <span class=nx>a</span><span class=p>.</span><span class=nf>Speaks</span><span class=p>()</span> <span class=p>}</span>
</span></span></code></pre></div><p>Go 也为我们提供了另一种接口的实现方案，我们可以不在具体的实现处定义接口，而是在需要用到该接口的地方，该模式为：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kd>func</span> <span class=nf>funcName</span><span class=p>(</span><span class=nx>a</span> <span class=nx>INTERFACETYPE</span><span class=p>)</span> <span class=nx>CONCRETETYPE</span>
</span></span></code></pre></div><p>定义接口：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>animals</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>type</span> <span class=nx>Dog</span> <span class=kd>struct</span><span class=p>{}</span>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=p>(</span><span class=nx>a</span> <span class=nx>Dog</span><span class=p>)</span> <span class=nf>Speaks</span><span class=p>()</span> <span class=kt>string</span> <span class=p>{</span> <span class=k>return</span> <span class=s>&#34;woof&#34;</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=cm>/** 在需要使用实现的地方定义接口 **/</span>
</span></span><span class=line><span class=cl><span class=kn>package</span> <span class=nx>circus</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>type</span> <span class=nx>Speaker</span> <span class=kd>interface</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nf>Speaks</span><span class=p>()</span> <span class=kt>string</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>Perform</span><span class=p>(</span><span class=nx>a</span> <span class=nx>Speaker</span><span class=p>)</span> <span class=p>{</span> <span class=k>return</span> <span class=nx>a</span><span class=p>.</span><span class=nf>Speaks</span><span class=p>()</span> <span class=p>}</span>
</span></span></code></pre></div><h2 id=embedding--嵌入>Embedding | 嵌入</h2><p>Go 语言中并没有子类继承这样的概念，而是通过嵌入(Embedding)的方式来实现类或者接口的组合。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// ReadWriter 的实现需要同时满足 Reader 与 Writer
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>type</span> <span class=nx>ReadWriter</span> <span class=kd>interface</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>Reader</span>
</span></span><span class=line><span class=cl>    <span class=nx>Writer</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Server 暴露了所有 Logger 结构体的方法
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>type</span> <span class=nx>Server</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>Host</span> <span class=kt>string</span>
</span></span><span class=line><span class=cl>    <span class=nx>Port</span> <span class=kt>int</span>
</span></span><span class=line><span class=cl>    <span class=o>*</span><span class=nx>log</span><span class=p>.</span><span class=nx>Logger</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 初始化方式并未受影响
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>server</span> <span class=o>:=</span> <span class=o>&amp;</span><span class=nx>Server</span><span class=p>{</span><span class=s>&#34;localhost&#34;</span><span class=p>,</span> <span class=mi>80</span><span class=p>,</span> <span class=nx>log</span><span class=p>.</span><span class=nf>New</span><span class=p>(</span><span class=o>...</span><span class=p>)}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 却可以直接调用内嵌结构体的方法，等价于 server.Logger.Log(...)
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>server</span><span class=p>.</span><span class=nf>Log</span><span class=p>(</span><span class=o>...</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 内嵌结构体的名词即是类型名
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>var</span> <span class=nx>logger</span> <span class=o>*</span><span class=nx>log</span><span class=p>.</span><span class=nx>Logger</span> <span class=p>=</span> <span class=nx>server</span><span class=p>.</span><span class=nx>Logger</span>
</span></span></code></pre></div><h2 id=reflection--generics--反射与泛型>Reflection & Generics | 反射与泛型</h2><p>Go 中并没有泛型。</p><h1 id=web-编程>Web 编程</h1><h2 id=http-server>HTTP Server</h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;net/http&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// define a type for the response
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>type</span> <span class=nx>Hello</span> <span class=kd>struct</span><span class=p>{}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// let that type implement the ServeHTTP method (defined in interface http.Handler)
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>func</span> <span class=p>(</span><span class=nx>h</span> <span class=nx>Hello</span><span class=p>)</span> <span class=nf>ServeHTTP</span><span class=p>(</span><span class=nx>w</span> <span class=nx>http</span><span class=p>.</span><span class=nx>ResponseWriter</span><span class=p>,</span> <span class=nx>r</span> <span class=o>*</span><span class=nx>http</span><span class=p>.</span><span class=nx>Request</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Fprint</span><span class=p>(</span><span class=nx>w</span><span class=p>,</span> <span class=s>&#34;Hello!&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>h</span> <span class=nx>Hello</span>
</span></span><span class=line><span class=cl>    <span class=nx>http</span><span class=p>.</span><span class=nf>ListenAndServe</span><span class=p>(</span><span class=s>&#34;localhost:4000&#34;</span><span class=p>,</span> <span class=nx>h</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Here&#39;s the method signature of http.ServeHTTP:
</span></span></span><span class=line><span class=cl><span class=c1>// type Handler interface {
</span></span></span><span class=line><span class=cl><span class=c1>//     ServeHTTP(w http.ResponseWriter, r *http.Request)
</span></span></span><span class=line><span class=cl><span class=c1>// }
</span></span></span></code></pre></div><h2 id=beego>Beego</h2><p>利用 Beego 官方推荐的 <a href=https://beego.me/docs/install/bee.md target=_blank rel=noopener>bee</a> 命令行工具，我们可以快速创建 Beego 项目，其目录组织方式如下：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=nx>quickstart</span>
</span></span><span class=line><span class=cl><span class=err>├──</span> <span class=nx>conf</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>└──</span> <span class=nx>app</span><span class=p>.</span><span class=nx>conf</span>
</span></span><span class=line><span class=cl><span class=err>├──</span> <span class=nx>controllers</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>└──</span> <span class=k>default</span><span class=p>.</span><span class=k>go</span>
</span></span><span class=line><span class=cl><span class=err>├──</span> <span class=nx>main</span><span class=p>.</span><span class=k>go</span>
</span></span><span class=line><span class=cl><span class=err>├──</span> <span class=nx>models</span>
</span></span><span class=line><span class=cl><span class=err>├──</span> <span class=nx>routers</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>└──</span> <span class=nx>router</span><span class=p>.</span><span class=k>go</span>
</span></span><span class=line><span class=cl><span class=err>├──</span> <span class=nx>static</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>├──</span> <span class=nx>css</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>├──</span> <span class=nx>img</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>└──</span> <span class=nx>js</span>
</span></span><span class=line><span class=cl><span class=err>├──</span> <span class=nx>tests</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>└──</span> <span class=nx>default_test</span><span class=p>.</span><span class=k>go</span>
</span></span><span class=line><span class=cl><span class=err>└──</span> <span class=nx>views</span>
</span></span><span class=line><span class=cl>    <span class=err>└──</span> <span class=nx>index</span><span class=p>.</span><span class=nx>tpl</span>
</span></span></code></pre></div><p>在 main.go 文件中，我们可以启动 Beego 实例，并且调用路由的初始化配置文件：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=nx>_</span> <span class=s>&#34;quickstart/routers&#34;</span>
</span></span><span class=line><span class=cl>        <span class=s>&#34;github.com/astaxie/beego&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>beego</span><span class=p>.</span><span class=nf>Run</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>而在路由的初始化函数中，我们会声明各个路由与控制器之间的映射关系：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>routers</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=s>&#34;quickstart/controllers&#34;</span>
</span></span><span class=line><span class=cl>        <span class=s>&#34;github.com/astaxie/beego&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>init</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>beego</span><span class=p>.</span><span class=nf>Router</span><span class=p>(</span><span class=s>&#34;/&#34;</span><span class=p>,</span> <span class=o>&amp;</span><span class=nx>controllers</span><span class=p>.</span><span class=nx>MainController</span><span class=p>{})</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>也可以手动指定 Beego 项目中的静态资源映射：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=nx>beego</span><span class=p>.</span><span class=nf>SetStaticPath</span><span class=p>(</span><span class=s>&#34;/down1&#34;</span><span class=p>,</span> <span class=s>&#34;download1&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nx>beego</span><span class=p>.</span><span class=nf>SetStaticPath</span><span class=p>(</span><span class=s>&#34;/down2&#34;</span><span class=p>,</span> <span class=s>&#34;download2&#34;</span><span class=p>)</span>
</span></span></code></pre></div><p>在具体的控制器中，可以设置返回数据，或者关联的模板名：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>controllers</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=s>&#34;github.com/astaxie/beego&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>type</span> <span class=nx>MainController</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>beego</span><span class=p>.</span><span class=nx>Controller</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=p>(</span><span class=nx>this</span> <span class=o>*</span><span class=nx>MainController</span><span class=p>)</span> <span class=nf>Get</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>this</span><span class=p>.</span><span class=nx>Data</span><span class=p>[</span><span class=s>&#34;Website&#34;</span><span class=p>]</span> <span class=p>=</span> <span class=s>&#34;beego.me&#34;</span>
</span></span><span class=line><span class=cl>        <span class=nx>this</span><span class=p>.</span><span class=nx>Data</span><span class=p>[</span><span class=s>&#34;Email&#34;</span><span class=p>]</span> <span class=p>=</span> <span class=s>&#34;astaxie@gmail.com&#34;</span>
</span></span><span class=line><span class=cl>        <span class=nx>this</span><span class=p>.</span><span class=nx>TplNames</span> <span class=p>=</span> <span class=s>&#34;index.tpl&#34;</span> <span class=c1>// version 1.6 use this.TplName = &#34;index.tpl&#34;
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span>
</span></span></code></pre></div><h1 id=devpractics--开发实践>DevPractics | 开发实践</h1><h2 id=文件读写>文件读写</h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;io/ioutil&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=o>...</span>
</span></span><span class=line><span class=cl><span class=nx>datFile1</span><span class=p>,</span> <span class=nx>errFile1</span> <span class=o>:=</span> <span class=nx>ioutil</span><span class=p>.</span><span class=nf>ReadFile</span><span class=p>(</span><span class=s>&#34;file1&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=nx>errFile1</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nb>panic</span><span class=p>(</span><span class=nx>errFile1</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=o>...</span>
</span></span></code></pre></div><h2 id=测试>测试</h2><p>VSCode 可以为函数自动生成基础测试用例，并且提供了方便的用例执行与调试的功能。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=cm>/** 交换函数 */</span>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>swap</span><span class=p>(</span><span class=nx>x</span> <span class=o>*</span><span class=kt>int</span><span class=p>,</span> <span class=nx>y</span> <span class=o>*</span><span class=kt>int</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>x</span><span class=p>,</span> <span class=nx>y</span> <span class=p>=</span> <span class=nx>y</span><span class=p>,</span> <span class=nx>x</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=cm>/** 自动生成的测试函数 */</span>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>Test_swap</span><span class=p>(</span><span class=nx>t</span> <span class=o>*</span><span class=nx>testing</span><span class=p>.</span><span class=nx>T</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=kd>type</span> <span class=nx>args</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=nx>x</span> <span class=o>*</span><span class=kt>int</span>
</span></span><span class=line><span class=cl>		<span class=nx>y</span> <span class=o>*</span><span class=kt>int</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl>	<span class=nx>tests</span> <span class=o>:=</span> <span class=p>[]</span><span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=nx>name</span> <span class=kt>string</span>
</span></span><span class=line><span class=cl>		<span class=nx>args</span> <span class=nx>args</span>
</span></span><span class=line><span class=cl>	<span class=p>}{</span>
</span></span><span class=line><span class=cl>		<span class=c1>// TODO: Add test cases.
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=p>}</span>
</span></span><span class=line><span class=cl>	<span class=k>for</span> <span class=nx>_</span><span class=p>,</span> <span class=nx>tt</span> <span class=o>:=</span> <span class=k>range</span> <span class=nx>tests</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=nx>t</span><span class=p>.</span><span class=nf>Run</span><span class=p>(</span><span class=nx>tt</span><span class=p>.</span><span class=nx>name</span><span class=p>,</span> <span class=kd>func</span><span class=p>(</span><span class=nx>t</span> <span class=o>*</span><span class=nx>testing</span><span class=p>.</span><span class=nx>T</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>			<span class=nf>swap</span><span class=p>(</span><span class=nx>tt</span><span class=p>.</span><span class=nx>args</span><span class=p>.</span><span class=nx>x</span><span class=p>,</span> <span class=nx>tt</span><span class=p>.</span><span class=nx>args</span><span class=p>.</span><span class=nx>y</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		<span class=p>})</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h1 id=links>Links</h1><ul><li>Go 基础语法宝典 <a href=https://github.com/0voice/Introduction-to-Golang/blob/main/Go%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95%E5%AE%9D%E5%85%B8.md target=_blank rel=noopener>https://github.com/0voice/Introduction-to-Golang/blob/main/Go%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95%E5%AE%9D%E5%85%B8.md</a></li></ul></div><div class=article-widget><div class="container-xl row post-nav"><div class="col-6 post-nav-item"><div class=meta-nav>下一页</div><a href=/books/awesome-cheatsheets/1.cs/zoo/go/go-concurrentprogramming-cheatsheet/ rel=prev>Go-ConcurrentProgramming-CheatSheet</a></div></div></div><div class=body-footer><p>最近更新于 2023-03-05</p><section id=comments class="mb-3 pt-0"><div id=disqus_thread></div><script>var disqus_config=function(){};(function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="https://ngte-website.oss-accelerate.aliyuncs.com/disqus/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)})()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></section></div></article><footer class=site-footer><div class="copyright py-4 bg-footer"><div class="row justify-content-center"><div class="text-center footer-color"><p class=mb-0>© 2017-2022 NGTE all rights reserved</p></div></div></div></footer></main></div></div><script src=//unpkg.com/heti/umd/heti-addon.min.js></script>
<script>const heti=new Heti(".article");heti.autoSpacing()</script><script type=text/javascript>window.$crisp=[],window.CRISP_WEBSITE_ID="12adcc35-9621-4313-8262-62dc654b29d8",function(){setTimeout(function(){d=document,s=d.createElement("script"),s.src="https://client.crisp.chat/l.js",s.async=1,d.getElementsByTagName("head")[0].appendChild(s)},2500)}()</script></div><div class=page-footer></div><script src=/js/vendor-bundle.min.d26509351aa0ff874abbee824e982e9b.js></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.1/highlight.min.js integrity="sha512-Ypjm0o7jOxAd4hpdoppSEN0TQOC19UtPAqD+4s5AlXmUvbmmS/YMxYqAqarQYyxTnB6/rqip9qcxlNB/3U9Wdg==" crossorigin=anonymous></script>
<script id=search-hit-algolia-template type=text/html><div class=search-hit><div class=search-hit-content><div class=search-hit-name><a href={{relpermalink}}>{{#helpers.highlight}}{ "attribute": "title" }{{/helpers.highlight}}</a></div><div class="article-metadata search-hit-type">{{type}}</div><p class=search-hit-description>{{#helpers.highlight}}{ "attribute": "summary" }{{/helpers.highlight}}</p></div></div></script><script src=https://cdn.jsdelivr.net/npm/instantsearch.js@4/dist/instantsearch.production.min.js crossorigin=anonymous></script>
<script id=dsq-count-scr src=https://ngte-website.oss-accelerate.aliyuncs.com/disqus/count.js async></script>
<script src=/zh/js/algolia-search-built.min.4387d694ca1258194aaf562b8cd1c400.js type=module></script>
<script id=page-data type=application/json>{"use_headroom":false}</script><script src=/zh/js/wowchemy.min.d1673c7a11d1238516cbe12a1e84257f.js></script>
<script>var mybutton=document.getElementById("backTopBtn");window.onscroll=function(){scrollFunction()};function scrollFunction(){document.body.scrollTop>20||document.documentElement.scrollTop>20?mybutton.style.display="block":mybutton.style.display="none"}function topFunction(){document.body.scrollTop=0,document.documentElement.scrollTop=0}</script><script src=https://cdn.jsdelivr.net/gh/bryanbraun/anchorjs@4.2.2/anchor.min.js integrity="sha512-I7w3ZdSFzw5j3jU3ZkNikBNeIrl3i+hEuEdwNmqUJvwNcaBUNcijnP2gd9DtGlgVYDplfjGoD8vTNsID+lCjqg==" crossorigin=anonymous></script>
<script>anchors.add()</script><script>(function(){"use strict";if(!document.queryCommandSupported("copy"))return;function e(e,t){e.className="highlight-copy-btn",e.textContent=t,setTimeout(function(){e.textContent="",e.className="highlight-copy-btn fa fa-copy"},1e3)}function t(e){var t=window.getSelection(),n=document.createRange();return n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n),t}function n(n){var o,s=document.createElement("button");s.className="highlight-copy-btn fa fa-copy",s.textContent="",o=n.firstElementChild,s.addEventListener("click",function(){try{var n=t(o);document.execCommand("copy"),n.removeAllRanges(),e(s,"已复制")}catch(t){console&&console.log(t),e(s,"Failed :'(")}}),n.appendChild(s)}var s=document.getElementsByClassName("highlight");Array.prototype.forEach.call(s,n)})()</script></body></html>