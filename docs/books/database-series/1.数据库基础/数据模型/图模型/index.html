<!doctype html><html lang=zh><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=generator content="Wowchemy 5.5.0 for Hugo"><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=preload as=style href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap"><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap" media=print onload='this.media="all"'><meta name=google-site-verification content="google69a5cccb61297807"><meta name=baidu-site-verification content="cqmZHEleVh"><meta name=description content="图模型 如我们之前所见，多对多关系是不同数据模型之间具有区别性的重要特征。如果你的应用程序大多数的关系是一对多关系（树状结构化数据），或者大多数记录之间不存在关系，那么使用文档模型是合适的。关系模型可以"><link rel=alternate hreflang=zh href=https://ng-tech.icu/books/database-series/1.%E6%95%B0%E6%8D%AE%E5%BA%93%E5%9F%BA%E7%A1%80/%E6%95%B0%E6%8D%AE%E6%A8%A1%E5%9E%8B/%E5%9B%BE%E6%A8%A1%E5%9E%8B/><meta name=theme-color content="#0a55a7"><link rel=stylesheet href=/css/vendor-bundle.min.c7b8d9abd591ba2253ea42747e3ac3f5.css media=print onload='this.media="all"'><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.1/styles/github.min.css crossorigin=anonymous title=hl-light media=print onload='this.media="all"'><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.1/styles/dracula.min.css crossorigin=anonymous title=hl-dark media=print onload='this.media="all"' disabled><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/instantsearch.css@7.4.5/themes/satellite-min.css integrity="sha256-TehzF/2QvNKhGQrrNpoOb2Ck4iGZ1J/DI4pkd2oUsBc=" crossorigin=anonymous><link rel=stylesheet href=/css/wowchemy.63df6ae9fc2b4cc71b83f1774d780209.css><script async src="https://www.googletagmanager.com/gtag/js?id=G-40NYXJ8823"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-40NYXJ8823")</script><script>var _hmt=_hmt||[];(function(){var e,t=document.createElement("script");t.src="https://hm.baidu.com/hm.js?56df1177bce405601b0ecdd7208f75c6",e=document.getElementsByTagName("script")[0],e.parentNode.insertBefore(t,e)})()</script><link rel=manifest href=/manifest.webmanifest><link rel=icon type=image/png href=/media/icon_hu0f7d075e895d6f5f1f5fdbc1e33dc138_10087_32x32_fill_lanczos_center_3.png><link rel=apple-touch-icon type=image/png href=/media/icon_hu0f7d075e895d6f5f1f5fdbc1e33dc138_10087_180x180_fill_lanczos_center_3.png><link rel=canonical href=https://ng-tech.icu/books/database-series/1.%E6%95%B0%E6%8D%AE%E5%BA%93%E5%9F%BA%E7%A1%80/%E6%95%B0%E6%8D%AE%E6%A8%A1%E5%9E%8B/%E5%9B%BE%E6%A8%A1%E5%9E%8B/><meta property="twitter:card" content="summary_large_image"><meta property="twitter:site" content="@wx-chevalier"><meta property="twitter:creator" content="@wx-chevalier"><meta property="og:site_name" content="Next-gen Tech Edu"><meta property="og:url" content="https://ng-tech.icu/books/database-series/1.%E6%95%B0%E6%8D%AE%E5%BA%93%E5%9F%BA%E7%A1%80/%E6%95%B0%E6%8D%AE%E6%A8%A1%E5%9E%8B/%E5%9B%BE%E6%A8%A1%E5%9E%8B/"><meta property="og:title" content="图模型 | Next-gen Tech Edu"><meta property="og:description" content="图模型 如我们之前所见，多对多关系是不同数据模型之间具有区别性的重要特征。如果你的应用程序大多数的关系是一对多关系（树状结构化数据），或者大多数记录之间不存在关系，那么使用文档模型是合适的。关系模型可以"><meta property="og:image" content="https://ng-tech.icu/media/sharing.png"><meta property="twitter:image" content="https://ng-tech.icu/media/sharing.png"><meta property="og:locale" content="zh"><title>图模型 | Next-gen Tech Edu</title></head><body id=top data-spy=scroll data-offset=70 data-target=#TableOfContents class=page-wrapper data-wc-page-id=5027b8e3ec013f081def7040016562d0><button onclick=topFunction() id=backTopBtn title="Go to top"><i class="fa-solid fa-circle-up" aria-hidden=true></i></button>
<script src=/js/wowchemy-init.min.14a0ed61c6dbd594b9c75193b25be179.js></script><aside class=search-modal id=search><div class=container><section class=search-header><div class="row no-gutters justify-content-between mb-3"><div class="col-6 search-title"><p>搜索</p></div><div class="col-6 col-search-close"><a class=js-search href=# aria-label=关闭><i class="fas fa-times-circle text-muted" aria-hidden=true></i></a></div></div><div id=search-box></div></section><section class=section-search-results><div id=search-hits></div><div id=search-common-queries></div></section></div></aside><div class=page-header><header class=header--fixed><nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id=navbar-main><div class=container-xl><div class="d-none d-lg-inline-flex"><a class=navbar-brand href=/>Next-gen Tech Edu</a></div><button type=button class=navbar-toggler data-toggle=collapse data-target=#navbar-content aria-controls=navbar-content aria-expanded=false aria-label=切换导航>
<span><i class="fas fa-bars"></i></span></button><div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none"><a class=navbar-brand href=/>Next-gen Tech Edu</a></div><div class="navbar-collapse main-menu-item collapse justify-content-start" id=navbar-content><ul class="navbar-nav d-md-inline-flex"><li class=nav-item><a class=nav-link href=/books-gallery><span>笔记（万篇）</span></a></li><li class=nav-item><a class=nav-link href=/#knowledge-map><span>知识图谱</span></a></li><style>.dropdown-item{display:inline-flex}</style><li class="nav-item dropdown"><a href=# class="nav-link dropdown-toggle" data-toggle=dropdown aria-haspopup=true><span>实验室</span><span class=caret></span></a><div class=dropdown-menu><a class=dropdown-item href=/galaxy-home/gh-craft><span>Craft 方块世界</span></a>
<a class=dropdown-item href=/galaxy-home/glossary-cards><span>3D 知识卡牌</span></a></div></li><style>.dropdown-item{display:inline-flex}</style><li class="nav-item dropdown"><a href=# class="nav-link dropdown-toggle" data-toggle=dropdown aria-haspopup=true><span>其他阅读渠道</span><span class=caret></span></a><div class=dropdown-menu><a class=dropdown-item href=https://zhuanlan.zhihu.com/wxyyxc1992><img style=width:16px;height:16px;display:inline-block;margin-right:8px src=https://ngte-superbed.oss-cn-beijing.aliyuncs.com/item/20230218234451.png></img><span>知乎</span></a>
<a class=dropdown-item href=https://segmentfault.com/blog/wxyyxc1992><img style=width:16px;height:16px;display:inline-block;margin-right:8px src=https://ngte-superbed.oss-cn-beijing.aliyuncs.com/item/20230219113556.png></img><span>SegmentFault</span></a>
<a class=dropdown-item href=https://zhuanlan.zhihu.com/wxyyxc1992><img style=width:16px;height:16px;display:inline-block;margin-right:8px src=https://ngte-superbed.oss-cn-beijing.aliyuncs.com/item/20230219113519.png></img><span>掘金</span></a></div></li></ul></div><ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2"><li class=nav-item><a class="nav-link js-search" href=# aria-label=搜索><i class="fas fa-search" aria-hidden=true></i></a></li><li class=nav-item><a class=nav-link href=https://github.com/wx-chevalier aria-label=GitHub><i class="fa-brands fa-github" aria-hidden=true></i></a></li><div></div><style>@media only screen and (max-width:600px){.jimmysong-template{display:none!important}}</style><li class=jimmysong-template style=color:#fff;font-size:12px><a href=https://jimmysong.io style=color:#fff>By Jimmy Song's Template</a></li></ul></div></nav></header></div><div class=page-body><link rel=stylesheet href=//unpkg.com/heti/umd/heti.min.css><div class="container-xl docs"><div class="row flex-xl-nowrap"><div class=docs-sidebar><form class="docs-search d-flex align-items-center"><button class="btn docs-toggle d-md-none p-0 mr-md-3 w-100" type=button data-toggle=collapse data-target=#docs-nav aria-controls=docs-nav aria-expanded=false aria-label="Toggle section navigation"><div class=d-flex><span class="d-md-none pl-1 flex-grow-1 text-left overflow-hidden">数据模型</span>
<span><i class="fas fa-chevron-down"></i></span></div></button>
<button class="form-control sidebar-search js-search d-none d-md-flex">
<i class="fas fa-search pr-2"></i>
<span class=sidebar-search-text>搜索...</span>
<span class=sidebar-search-shortcut>/</span></button></form><nav class="collapse docs-links" id=docs-nav><ul class="nav docs-sidenav"><li style=display:inline-flex><a style=cursor:pointer onclick=window.history.back()><i class="fas fa-arrow-left pr-1"></i>
Back</a>
<span>|</span>
<a href=/books/><i class="fa-solid fa-house" style=margin-right:4px></i>
Books</a></li></ul><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-id10aaab72abcc401f73cf06438a51f848")' href=#id10aaab72abcc401f73cf06438a51f848 aria-expanded=false aria-controls=id10aaab72abcc401f73cf06438a51f848 aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/database-series/1.%E6%95%B0%E6%8D%AE%E5%BA%93%E5%9F%BA%E7%A1%80/>1.数据库基础</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#id10aaab72abcc401f73cf06438a51f848 aria-expanded=false aria-controls=id10aaab72abcc401f73cf06438a51f848><i class="fa-solid fa-angle-down" id=caret-id10aaab72abcc401f73cf06438a51f848></i></a></div><ul class="nav docs-sidenav collapse show" id=id10aaab72abcc401f73cf06438a51f848><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-id6d71ab4133c8f6e1c9b46386e3d1a9f5")' href=#id6d71ab4133c8f6e1c9b46386e3d1a9f5 aria-expanded=false aria-controls=id6d71ab4133c8f6e1c9b46386e3d1a9f5 aria-hidden=false data-toggle=collapse></div></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-id250836b60389286ead75bff76317f3f8")' href=#id250836b60389286ead75bff76317f3f8 aria-expanded=false aria-controls=id250836b60389286ead75bff76317f3f8 aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/database-series/1.%E6%95%B0%E6%8D%AE%E5%BA%93%E5%9F%BA%E7%A1%80/%E5%B9%B6%E5%8F%91%E6%8E%A7%E5%88%B6/>并发控制</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#id250836b60389286ead75bff76317f3f8 aria-expanded=false aria-controls=id250836b60389286ead75bff76317f3f8><i class="fa-solid fa-angle-right" id=caret-id250836b60389286ead75bff76317f3f8></i></a></div><ul class="nav docs-sidenav collapse" id=id250836b60389286ead75bff76317f3f8><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-id706355df1aa4194e3b8a30a31dead8fb")' href=#id706355df1aa4194e3b8a30a31dead8fb aria-expanded=false aria-controls=id706355df1aa4194e3b8a30a31dead8fb aria-hidden=false data-toggle=collapse></div></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-id38565b327feea9537f81b5137d4e706e")' href=#id38565b327feea9537f81b5137d4e706e aria-expanded=false aria-controls=id38565b327feea9537f81b5137d4e706e aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/database-series/1.%E6%95%B0%E6%8D%AE%E5%BA%93%E5%9F%BA%E7%A1%80/%E5%B9%B6%E5%8F%91%E6%8E%A7%E5%88%B6/%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB/>隔离级别</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#id38565b327feea9537f81b5137d4e706e aria-expanded=false aria-controls=id38565b327feea9537f81b5137d4e706e><i class="fa-solid fa-angle-right" id=caret-id38565b327feea9537f81b5137d4e706e></i></a></div><ul class="nav docs-sidenav collapse" id=id38565b327feea9537f81b5137d4e706e><li class="child level"><a href=/books/database-series/1.%E6%95%B0%E6%8D%AE%E5%BA%93%E5%9F%BA%E7%A1%80/%E5%B9%B6%E5%8F%91%E6%8E%A7%E5%88%B6/%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB/1.%E8%AF%BB%E6%9C%AA%E6%8F%90%E4%BA%A4/>1.读未提交</a></li><li class="child level"><a href=/books/database-series/1.%E6%95%B0%E6%8D%AE%E5%BA%93%E5%9F%BA%E7%A1%80/%E5%B9%B6%E5%8F%91%E6%8E%A7%E5%88%B6/%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB/2.%E8%AF%BB%E5%B7%B2%E6%8F%90%E4%BA%A4/>2.读已提交</a></li><li class="child level"><a href=/books/database-series/1.%E6%95%B0%E6%8D%AE%E5%BA%93%E5%9F%BA%E7%A1%80/%E5%B9%B6%E5%8F%91%E6%8E%A7%E5%88%B6/%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB/3.0.%E5%BF%AB%E7%85%A7%E9%9A%94%E7%A6%BB%E4%B8%8E%E5%8F%AF%E9%87%8D%E5%A4%8D%E8%AF%BB/>3.0.快照隔离与可重复读</a></li><li class="child level"><a href=/books/database-series/1.%E6%95%B0%E6%8D%AE%E5%BA%93%E5%9F%BA%E7%A1%80/%E5%B9%B6%E5%8F%91%E6%8E%A7%E5%88%B6/%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB/3.1.%E5%86%99%E5%85%A5%E5%81%8F%E5%B7%AE%E4%B8%8E%E5%B9%BB%E8%AF%BB/>3.1.写入偏差与幻读</a></li><li class="child level"><a href=/books/database-series/1.%E6%95%B0%E6%8D%AE%E5%BA%93%E5%9F%BA%E7%A1%80/%E5%B9%B6%E5%8F%91%E6%8E%A7%E5%88%B6/%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB/3.%E5%BF%AB%E7%85%A7%E9%9A%94%E7%A6%BB%E4%B8%8E%E5%8F%AF%E9%87%8D%E5%A4%8D%E8%AF%BB/>3.快照隔离与可重复读</a></li><li class="child level"><a href=/books/database-series/1.%E6%95%B0%E6%8D%AE%E5%BA%93%E5%9F%BA%E7%A1%80/%E5%B9%B6%E5%8F%91%E6%8E%A7%E5%88%B6/%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB/4.%E9%98%B2%E6%AD%A2%E4%B8%A2%E5%A4%B1%E6%9B%B4%E6%96%B0/>4.防止丢失更新</a></li><li class="child level"><a href=/books/database-series/1.%E6%95%B0%E6%8D%AE%E5%BA%93%E5%9F%BA%E7%A1%80/%E5%B9%B6%E5%8F%91%E6%8E%A7%E5%88%B6/%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB/5.%E5%8F%AF%E5%BA%8F%E5%88%97%E5%8C%96/>5.可序列化</a></li><li class="child level"><a href=/books/database-series/1.%E6%95%B0%E6%8D%AE%E5%BA%93%E5%9F%BA%E7%A1%80/%E5%B9%B6%E5%8F%91%E6%8E%A7%E5%88%B6/%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB/%E8%AF%BB%E6%9C%AA%E6%8F%90%E4%BA%A4/>读未提交</a></li><li class="child level"><a href=/books/database-series/1.%E6%95%B0%E6%8D%AE%E5%BA%93%E5%9F%BA%E7%A1%80/%E5%B9%B6%E5%8F%91%E6%8E%A7%E5%88%B6/%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB/%E8%AF%BB%E5%B7%B2%E6%8F%90%E4%BA%A4/>读已提交</a></li><li class="child level"><a href=/books/database-series/1.%E6%95%B0%E6%8D%AE%E5%BA%93%E5%9F%BA%E7%A1%80/%E5%B9%B6%E5%8F%91%E6%8E%A7%E5%88%B6/%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB/%E9%98%B2%E6%AD%A2%E4%B8%A2%E5%A4%B1%E6%9B%B4%E6%96%B0/>防止丢失更新</a></li><li class="child level"><a href=/books/database-series/1.%E6%95%B0%E6%8D%AE%E5%BA%93%E5%9F%BA%E7%A1%80/%E5%B9%B6%E5%8F%91%E6%8E%A7%E5%88%B6/%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB/%E5%8F%AF%E5%BA%8F%E5%88%97%E5%8C%96/>可序列化</a></li><li class="child level"><a href=/books/database-series/1.%E6%95%B0%E6%8D%AE%E5%BA%93%E5%9F%BA%E7%A1%80/%E5%B9%B6%E5%8F%91%E6%8E%A7%E5%88%B6/%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB/%E5%BF%AB%E7%85%A7%E9%9A%94%E7%A6%BB%E4%B8%8E%E5%8F%AF%E9%87%8D%E5%A4%8D%E8%AF%BB/>快照隔离与可重复读</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-ida523aedb64c4c1d50e9fdecaada7157b")' href=#ida523aedb64c4c1d50e9fdecaada7157b aria-expanded=false aria-controls=ida523aedb64c4c1d50e9fdecaada7157b aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/database-series/1.%E6%95%B0%E6%8D%AE%E5%BA%93%E5%9F%BA%E7%A1%80/%E5%B9%B6%E5%8F%91%E6%8E%A7%E5%88%B6/%E4%BA%8B%E5%8A%A1%E7%89%B9%E6%80%A7/>事务特性</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#ida523aedb64c4c1d50e9fdecaada7157b aria-expanded=false aria-controls=ida523aedb64c4c1d50e9fdecaada7157b><i class="fa-solid fa-angle-right" id=caret-ida523aedb64c4c1d50e9fdecaada7157b></i></a></div><ul class="nav docs-sidenav collapse" id=ida523aedb64c4c1d50e9fdecaada7157b><li class="child level"><a href=/books/database-series/1.%E6%95%B0%E6%8D%AE%E5%BA%93%E5%9F%BA%E7%A1%80/%E5%B9%B6%E5%8F%91%E6%8E%A7%E5%88%B6/%E4%BA%8B%E5%8A%A1%E7%89%B9%E6%80%A7/acid-%E7%89%B9%E6%80%A7%E8%A7%A3%E6%9E%90/>ACID 特性解析</a></li></ul></div></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-id5f5dd151c4bf06279972a88e3209ca2e")' href=#id5f5dd151c4bf06279972a88e3209ca2e aria-expanded=false aria-controls=id5f5dd151c4bf06279972a88e3209ca2e aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/database-series/1.%E6%95%B0%E6%8D%AE%E5%BA%93%E5%9F%BA%E7%A1%80/%E5%AD%98%E5%82%A8%E5%BC%95%E6%93%8E/>存储引擎</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#id5f5dd151c4bf06279972a88e3209ca2e aria-expanded=false aria-controls=id5f5dd151c4bf06279972a88e3209ca2e><i class="fa-solid fa-angle-right" id=caret-id5f5dd151c4bf06279972a88e3209ca2e></i></a></div><ul class="nav docs-sidenav collapse" id=id5f5dd151c4bf06279972a88e3209ca2e><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-id89408e44780b71a3ee563691adc7217b")' href=#id89408e44780b71a3ee563691adc7217b aria-expanded=false aria-controls=id89408e44780b71a3ee563691adc7217b aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/database-series/1.%E6%95%B0%E6%8D%AE%E5%BA%93%E5%9F%BA%E7%A1%80/%E5%AD%98%E5%82%A8%E5%BC%95%E6%93%8E/%E7%BC%96%E7%A0%81%E4%B8%8E%E5%BA%8F%E5%88%97%E5%8C%96/>编码与序列化</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#id89408e44780b71a3ee563691adc7217b aria-expanded=false aria-controls=id89408e44780b71a3ee563691adc7217b><i class="fa-solid fa-angle-right" id=caret-id89408e44780b71a3ee563691adc7217b></i></a></div><ul class="nav docs-sidenav collapse" id=id89408e44780b71a3ee563691adc7217b><li class="child level"><a href=/books/database-series/1.%E6%95%B0%E6%8D%AE%E5%BA%93%E5%9F%BA%E7%A1%80/%E5%AD%98%E5%82%A8%E5%BC%95%E6%93%8E/%E7%BC%96%E7%A0%81%E4%B8%8E%E5%BA%8F%E5%88%97%E5%8C%96/%E7%BC%96%E7%A0%81/>编码</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-id383f5011b7f416fd7e08abf9128924b9")' href=#id383f5011b7f416fd7e08abf9128924b9 aria-expanded=false aria-controls=id383f5011b7f416fd7e08abf9128924b9 aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/database-series/1.%E6%95%B0%E6%8D%AE%E5%BA%93%E5%9F%BA%E7%A1%80/%E5%AD%98%E5%82%A8%E5%BC%95%E6%93%8E/%E5%88%97%E5%AD%98%E5%82%A8/>列存储</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#id383f5011b7f416fd7e08abf9128924b9 aria-expanded=false aria-controls=id383f5011b7f416fd7e08abf9128924b9><i class="fa-solid fa-angle-right" id=caret-id383f5011b7f416fd7e08abf9128924b9></i></a></div><ul class="nav docs-sidenav collapse" id=id383f5011b7f416fd7e08abf9128924b9><li class="child level"><a href=/books/database-series/1.%E6%95%B0%E6%8D%AE%E5%BA%93%E5%9F%BA%E7%A1%80/%E5%AD%98%E5%82%A8%E5%BC%95%E6%93%8E/%E5%88%97%E5%AD%98%E5%82%A8/%E5%86%99%E5%85%A5%E4%B8%8E%E6%9B%B4%E6%96%B0/>写入与更新</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-idd6d52da7c830c70b93db4149f7c9479b")' href=#idd6d52da7c830c70b93db4149f7c9479b aria-expanded=false aria-controls=idd6d52da7c830c70b93db4149f7c9479b aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/database-series/1.%E6%95%B0%E6%8D%AE%E5%BA%93%E5%9F%BA%E7%A1%80/%E5%AD%98%E5%82%A8%E5%BC%95%E6%93%8E/%E5%85%A8%E6%96%87%E7%B4%A2%E5%BC%95/>全文索引</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#idd6d52da7c830c70b93db4149f7c9479b aria-expanded=false aria-controls=idd6d52da7c830c70b93db4149f7c9479b><i class="fa-solid fa-angle-right" id=caret-idd6d52da7c830c70b93db4149f7c9479b></i></a></div><ul class="nav docs-sidenav collapse" id=idd6d52da7c830c70b93db4149f7c9479b><li class="child level"><a href=/books/database-series/1.%E6%95%B0%E6%8D%AE%E5%BA%93%E5%9F%BA%E7%A1%80/%E5%AD%98%E5%82%A8%E5%BC%95%E6%93%8E/%E5%85%A8%E6%96%87%E7%B4%A2%E5%BC%95/%E5%8A%A8%E6%80%81%E5%85%A8%E6%96%87%E7%B4%A2%E5%BC%95/>动态全文索引</a></li><li class="child level"><a href=/books/database-series/1.%E6%95%B0%E6%8D%AE%E5%BA%93%E5%9F%BA%E7%A1%80/%E5%AD%98%E5%82%A8%E5%BC%95%E6%93%8E/%E5%85%A8%E6%96%87%E7%B4%A2%E5%BC%95/%E5%85%A8%E6%96%87%E7%B4%A2%E5%BC%95/>全文索引</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-idc784bfe7d233a4cbe987b2353b54f51a")' href=#idc784bfe7d233a4cbe987b2353b54f51a aria-expanded=false aria-controls=idc784bfe7d233a4cbe987b2353b54f51a aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/database-series/1.%E6%95%B0%E6%8D%AE%E5%BA%93%E5%9F%BA%E7%A1%80/%E5%AD%98%E5%82%A8%E5%BC%95%E6%93%8E/%E7%B4%A2%E5%BC%95/>索引</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#idc784bfe7d233a4cbe987b2353b54f51a aria-expanded=false aria-controls=idc784bfe7d233a4cbe987b2353b54f51a><i class="fa-solid fa-angle-right" id=caret-idc784bfe7d233a4cbe987b2353b54f51a></i></a></div><ul class="nav docs-sidenav collapse" id=idc784bfe7d233a4cbe987b2353b54f51a><li class="child level"><a href=/books/database-series/1.%E6%95%B0%E6%8D%AE%E5%BA%93%E5%9F%BA%E7%A1%80/%E5%AD%98%E5%82%A8%E5%BC%95%E6%93%8E/%E7%B4%A2%E5%BC%95/1.%E6%97%A0%E7%B4%A2%E5%BC%95/>1.无索引</a></li><li class="child level"><a href=/books/database-series/1.%E6%95%B0%E6%8D%AE%E5%BA%93%E5%9F%BA%E7%A1%80/%E5%AD%98%E5%82%A8%E5%BC%95%E6%93%8E/%E7%B4%A2%E5%BC%95/2.%E6%95%B0%E7%BB%84/>2.数组</a></li><li class="child level"><a href=/books/database-series/1.%E6%95%B0%E6%8D%AE%E5%BA%93%E5%9F%BA%E7%A1%80/%E5%AD%98%E5%82%A8%E5%BC%95%E6%93%8E/%E7%B4%A2%E5%BC%95/3.%E4%BA%8C%E5%8F%89%E6%A0%91/>3.二叉树</a></li><li class="child level"><a href=/books/database-series/1.%E6%95%B0%E6%8D%AE%E5%BA%93%E5%9F%BA%E7%A1%80/%E5%AD%98%E5%82%A8%E5%BC%95%E6%93%8E/%E7%B4%A2%E5%BC%95/4.%E5%93%88%E5%B8%8C%E7%B4%A2%E5%BC%95/>4.哈希索引</a></li><li class="child level"><a href=/books/database-series/1.%E6%95%B0%E6%8D%AE%E5%BA%93%E5%9F%BA%E7%A1%80/%E5%AD%98%E5%82%A8%E5%BC%95%E6%93%8E/%E7%B4%A2%E5%BC%95/5.b-tree/>5.B-Tree</a></li><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-id280a5313332b9882360813e15f09f610")' href=#id280a5313332b9882360813e15f09f610 aria-expanded=false aria-controls=id280a5313332b9882360813e15f09f610 aria-hidden=false data-toggle=collapse></div></div><li class="child level"><a href=/books/database-series/1.%E6%95%B0%E6%8D%AE%E5%BA%93%E5%9F%BA%E7%A1%80/%E5%AD%98%E5%82%A8%E5%BC%95%E6%93%8E/%E7%B4%A2%E5%BC%95/b-tree/>B-Tree</a></li><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-id5ed58d107c7631272a670e30e391a178")' href=#id5ed58d107c7631272a670e30e391a178 aria-expanded=false aria-controls=id5ed58d107c7631272a670e30e391a178 aria-hidden=false data-toggle=collapse></div></div><li class="child level"><a href=/books/database-series/1.%E6%95%B0%E6%8D%AE%E5%BA%93%E5%9F%BA%E7%A1%80/%E5%AD%98%E5%82%A8%E5%BC%95%E6%93%8E/%E7%B4%A2%E5%BC%95/%E4%BA%8C%E5%8F%89%E6%A0%91/>二叉树</a></li><li class="child level"><a href=/books/database-series/1.%E6%95%B0%E6%8D%AE%E5%BA%93%E5%9F%BA%E7%A1%80/%E5%AD%98%E5%82%A8%E5%BC%95%E6%93%8E/%E7%B4%A2%E5%BC%95/%E5%93%88%E5%B8%8C%E7%B4%A2%E5%BC%95/>哈希索引</a></li><li class="child level"><a href=/books/database-series/1.%E6%95%B0%E6%8D%AE%E5%BA%93%E5%9F%BA%E7%A1%80/%E5%AD%98%E5%82%A8%E5%BC%95%E6%93%8E/%E7%B4%A2%E5%BC%95/%E5%85%B6%E4%BB%96%E7%B4%A2%E5%BC%95/>其他索引</a></li><li class="child level"><a href=/books/database-series/1.%E6%95%B0%E6%8D%AE%E5%BA%93%E5%9F%BA%E7%A1%80/%E5%AD%98%E5%82%A8%E5%BC%95%E6%93%8E/%E7%B4%A2%E5%BC%95/%E6%95%B0%E7%BB%84/>数组</a></li><li class="child level"><a href=/books/database-series/1.%E6%95%B0%E6%8D%AE%E5%BA%93%E5%9F%BA%E7%A1%80/%E5%AD%98%E5%82%A8%E5%BC%95%E6%93%8E/%E7%B4%A2%E5%BC%95/%E6%97%A0%E7%B4%A2%E5%BC%95/>无索引</a></li></ul></div></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-id0083df671eec2348641048f03e1a818f")' href=#id0083df671eec2348641048f03e1a818f aria-expanded=false aria-controls=id0083df671eec2348641048f03e1a818f aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/database-series/1.%E6%95%B0%E6%8D%AE%E5%BA%93%E5%9F%BA%E7%A1%80/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%AE%80%E5%8F%B2/>数据库简史</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#id0083df671eec2348641048f03e1a818f aria-expanded=false aria-controls=id0083df671eec2348641048f03e1a818f><i class="fa-solid fa-angle-right" id=caret-id0083df671eec2348641048f03e1a818f></i></a></div><ul class="nav docs-sidenav collapse" id=id0083df671eec2348641048f03e1a818f><li class="child level"><a href=/books/database-series/1.%E6%95%B0%E6%8D%AE%E5%BA%93%E5%9F%BA%E7%A1%80/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%AE%80%E5%8F%B2/1.%E7%BC%96%E5%B9%B4%E5%8F%B2/>1.编年史</a></li><li class="child level"><a href=/books/database-series/1.%E6%95%B0%E6%8D%AE%E5%BA%93%E5%9F%BA%E7%A1%80/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%AE%80%E5%8F%B2/2.dbms/>2.DBMS</a></li><li class="child level"><a href=/books/database-series/1.%E6%95%B0%E6%8D%AE%E5%BA%93%E5%9F%BA%E7%A1%80/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%AE%80%E5%8F%B2/3.nosql/>3.NoSQL</a></li><li class="child level"><a href=/books/database-series/1.%E6%95%B0%E6%8D%AE%E5%BA%93%E5%9F%BA%E7%A1%80/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%AE%80%E5%8F%B2/4.%E6%95%B0%E6%8D%AE%E5%BA%93%E9%80%89%E6%8B%A9/>4.数据库选择</a></li><li class="child level"><a href=/books/database-series/1.%E6%95%B0%E6%8D%AE%E5%BA%93%E5%9F%BA%E7%A1%80/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%AE%80%E5%8F%B2/5.%E6%80%A7%E8%83%BD%E8%AF%84%E6%B5%8B/>5.性能评测</a></li><li class="child level"><a href=/books/database-series/1.%E6%95%B0%E6%8D%AE%E5%BA%93%E5%9F%BA%E7%A1%80/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%AE%80%E5%8F%B2/dbms/>DBMS</a></li><li class="child level"><a href=/books/database-series/1.%E6%95%B0%E6%8D%AE%E5%BA%93%E5%9F%BA%E7%A1%80/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%AE%80%E5%8F%B2/nosql/>NoSQL</a></li><li class="child level"><a href=/books/database-series/1.%E6%95%B0%E6%8D%AE%E5%BA%93%E5%9F%BA%E7%A1%80/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%AE%80%E5%8F%B2/%E7%BC%96%E5%B9%B4%E5%8F%B2/>编年史</a></li><li class="child level"><a href=/books/database-series/1.%E6%95%B0%E6%8D%AE%E5%BA%93%E5%9F%BA%E7%A1%80/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%AE%80%E5%8F%B2/%E6%95%B0%E6%8D%AE%E5%BA%93%E9%80%89%E6%8B%A9/>数据库选择</a></li><li class="child level"><a href=/books/database-series/1.%E6%95%B0%E6%8D%AE%E5%BA%93%E5%9F%BA%E7%A1%80/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%AE%80%E5%8F%B2/%E6%80%A7%E8%83%BD%E8%AF%84%E6%B5%8B/>性能评测</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-idd88903d5f2e714b4f6bdc152f70fa14d")' href=#idd88903d5f2e714b4f6bdc152f70fa14d aria-expanded=false aria-controls=idd88903d5f2e714b4f6bdc152f70fa14d aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/database-series/1.%E6%95%B0%E6%8D%AE%E5%BA%93%E5%9F%BA%E7%A1%80/%E6%95%B0%E6%8D%AE%E6%A8%A1%E5%9E%8B/>数据模型</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#idd88903d5f2e714b4f6bdc152f70fa14d aria-expanded=false aria-controls=idd88903d5f2e714b4f6bdc152f70fa14d><i class="fa-solid fa-angle-down" id=caret-idd88903d5f2e714b4f6bdc152f70fa14d></i></a></div><ul class="nav docs-sidenav collapse show" id=idd88903d5f2e714b4f6bdc152f70fa14d><li class="child level"><a href=/books/database-series/1.%E6%95%B0%E6%8D%AE%E5%BA%93%E5%9F%BA%E7%A1%80/%E6%95%B0%E6%8D%AE%E6%A8%A1%E5%9E%8B/%E6%9F%A5%E8%AF%A2%E8%AF%AD%E8%A8%80/>查询语言</a></li><li class="child level"><a href=/books/database-series/1.%E6%95%B0%E6%8D%AE%E5%BA%93%E5%9F%BA%E7%A1%80/%E6%95%B0%E6%8D%AE%E6%A8%A1%E5%9E%8B/%E5%85%B3%E7%B3%BB%E6%A8%A1%E5%9E%8B/>关系模型</a></li><li class="child level"><a href=/books/database-series/1.%E6%95%B0%E6%8D%AE%E5%BA%93%E5%9F%BA%E7%A1%80/%E6%95%B0%E6%8D%AE%E6%A8%A1%E5%9E%8B/%E6%97%B6%E5%BA%8F%E6%A8%A1%E5%9E%8B/>时序模型</a></li><li class="child level active"><a href=/books/database-series/1.%E6%95%B0%E6%8D%AE%E5%BA%93%E5%9F%BA%E7%A1%80/%E6%95%B0%E6%8D%AE%E6%A8%A1%E5%9E%8B/%E5%9B%BE%E6%A8%A1%E5%9E%8B/>图模型</a></li><li class="child level"><a href=/books/database-series/1.%E6%95%B0%E6%8D%AE%E5%BA%93%E5%9F%BA%E7%A1%80/%E6%95%B0%E6%8D%AE%E6%A8%A1%E5%9E%8B/%E6%96%87%E6%A1%A3%E6%A8%A1%E5%9E%8B/>文档模型</a></li></ul></div></ul></div></nav></div><div class="d-none d-xl-block col-xl-2 docs-toc"><ul class="nav toc-top"><li><a href=# id=back_to_top class=docs-toc-title>目录</a></li></ul><nav id=TableOfContents><ul><li><a href=#图模型与网络模型>图模型与网络模型</a></li></ul><ul><li><a href=#关系模式存储>关系模式存储</a></li><li><a href=#cypher-查询语言>Cypher 查询语言</a></li><li><a href=#sql-中的图查询>SQL 中的图查询</a></li></ul><ul><li><a href=#rdf-数据模型>RDF 数据模型</a></li><li><a href=#sparql-查询语言>SPARQL 查询语言</a></li></ul></nav><div class="subscribe-module col-24 mt-1"><img src=https://ngte-superbed.oss-cn-beijing.aliyuncs.com/item/20230220172727.png alt=image title=王下邀月熊的微信公众号></div></div><main class="py-md-3 pl-md-3 docs-content col-xl-8" role=main><article class=article><h1>图模型</h1><div class=article-style><h1 id=图模型>图模型</h1><p>如我们之前所见，多对多关系是不同数据模型之间具有区别性的重要特征。如果你的应用程序大多数的关系是一对多关系（树状结构化数据），或者大多数记录之间不存在关系，那么使用文档模型是合适的。关系模型可以处理多对多关系的简单情况，但是随着数据之间的连接变得更加复杂，将数据建模为图形显得更加自然。</p><p>一个图由两种对象组成：顶点（vertices）（也称为节点（nodes）或实体（entities）），和边（edges）（也称为关系（relationships）或弧（arcs））。多种数据可以被建模为一个图形。典型的例子包括：</p><ul><li><p>社交图谱：顶点是人，边指示哪些人彼此认识。</p></li><li><p>网络图谱：顶点是网页，边缘表示指向其他页面的 HTML 链接。</p></li><li><p>公路或铁路网络：顶点是交叉路口，边线代表它们之间的道路或铁路线。</p></li></ul><p>可以将那些众所周知的算法运用到这些图上：例如，汽车导航系统搜索道路网络中两点之间的最短路径，PageRank 可以用在网络图上来确定网页的流行程度，从而确定该网页在搜索结果中的排名。这里图中的所有顶点代表了相同类型的事物（人，网页或交叉路口）。不过，图并不局限于这样的同类数据：同样强大地是，图提供了一种一致的方式，用来在单个数据存储中存储完全不同类型的对象。例如，Facebook 维护一个包含许多不同类型的顶点和边的单个图：顶点表示人，地点，事件，签到和用户的评论;边缘表示哪些人是彼此的朋友，哪个签到发生在何处，谁评论了哪条消息，谁参与了哪个事件，等等。</p><p>譬如下图可以从社交网络或系谱数据库中获得：它显示了两个人，来自爱达荷州的 Lucy 和来自法国 Beaune 的 Alain。他们已婚，住在伦敦。</p><p><figure><div class="d-flex justify-content-center"><div class=w-100><img src=https://s2.ax1x.com/2020/02/03/105Xp8.md.png alt=图数据结构示例（框代表顶点，箭头代表边） loading=lazy data-zoomable></div></div></figure></p><p>有几种不同但相关的方法用来构建和查询图表中的数据。在本节中，我们将讨论属性图模型（由 Neo4j，Titan 和 InfiniteGraph 实现）和三元组存储（triple-store）模型（由 Datomic，AllegroGraph 等实现）。我们将查看图的三种声明式查询语言：Cypher，SPARQL 和 Datalog。除此之外，还有像 Gremlin 这样的图形查询语言和像 Pregel 这样的图形处理框架。</p><h2 id=图模型与网络模型>图模型与网络模型</h2><ul><li><p>在 CODASYL 中，数据库有一个模式，用于指定哪种记录类型可以嵌套在其他记录类型中。在图形数据库中，不存在这样的限制：任何顶点都可以具有到其他任何顶点的边。这为应用程序适应不断变化的需求提供了更大的灵活性。</p></li><li><p>在 CODASYL 中，达到特定记录的唯一方法是遍历其中的一个访问路径。在图形数据库中，可以通过其唯一 ID 直接引用任何顶点，也可以使用索引来查找具有特定值的顶点。</p></li><li><p>在 CODASYL，记录的后续是一个有序集合，所以数据库的人不得不维持排序（这会影响存储布局），并且插入新记录到数据库的应用程序不得不担心的新记录在这些集合中的位置。在图形数据库中，顶点和边不是有序的（只能在查询时对结果进行排序）。</p></li><li><p>在 CODASYL 中，所有查询都是命令式的，难以编写，并且很容易因架构中的变化而受到破坏。在图形数据库中，如果需要，可以在命令式代码中编写遍历，但大多数图形数据库也支持高级声明式查询语言，如 Cypher 或 SPARQL。</p></li></ul><h1 id=属性图>属性图</h1><p>在属性图模型中，每个顶点（vertex）包括：</p><ul><li>唯一的标识符</li><li>一组 出边（outgoing edges）</li><li>一组 入边（ingoing edges）</li><li>一组属性（键值对）</li></ul><p>每条边（edge）包括：</p><ul><li>唯一标识符</li><li>边的起点/尾部顶点（tail vertex）</li><li>边的终点/头部顶点（head vertex）</li><li>描述两个顶点之间关系类型的标签</li><li>一组属性（键值对）</li></ul><h2 id=关系模式存储>关系模式存储</h2><p>可以将图存储看作由两个关系表组成：一个存储顶点，另一个存储边。头部和尾部顶点用来存储每条边；如果你想要一组顶点的输入或输出边，你可以分别通过 head_vertex 或 tail_vertex 来查询 edges 表。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>vertices</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>vertex_id</span><span class=w>  </span><span class=nb>INTEGER</span><span class=w> </span><span class=k>PRIMARY</span><span class=w> </span><span class=k>KEY</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>properties</span><span class=w> </span><span class=n>JSON</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>edges</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>edge_id</span><span class=w>     </span><span class=nb>INTEGER</span><span class=w> </span><span class=k>PRIMARY</span><span class=w> </span><span class=k>KEY</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>tail_vertex</span><span class=w> </span><span class=nb>INTEGER</span><span class=w> </span><span class=k>REFERENCES</span><span class=w> </span><span class=n>vertices</span><span class=w> </span><span class=p>(</span><span class=n>vertex_id</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>head_vertex</span><span class=w> </span><span class=nb>INTEGER</span><span class=w> </span><span class=k>REFERENCES</span><span class=w> </span><span class=n>vertices</span><span class=w> </span><span class=p>(</span><span class=n>vertex_id</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>label</span><span class=w>       </span><span class=nb>TEXT</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>properties</span><span class=w>  </span><span class=n>JSON</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>CREATE</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>edges_tails</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>edges</span><span class=w> </span><span class=p>(</span><span class=n>tail_vertex</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>CREATE</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>edges_heads</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>edges</span><span class=w> </span><span class=p>(</span><span class=n>head_vertex</span><span class=p>);</span><span class=w>
</span></span></span></code></pre></div><p>关于这个模型的一些重要方面是：</p><ul><li>任何顶点都可以有一条边连接到任何其他顶点。没有模式限制哪种事物可不可以关联。</li><li>给定任何顶点，可以高效地找到它的入边和出边，从而遍历图，即沿着一系列顶点的路径前后移动。</li><li>通过对不同类型的关系使用不同的标签，可以在一个图中存储几种不同的信息，同时仍然保持一个清晰的数据模型。</li></ul><p>这些特性为数据建模提供了很大的灵活性，如前图所示。图中显示了一些传统关系模式难以表达的事情，例如不同国家的不同地区结构（法国有省和州，美国有不同的州和州），国中国的怪事（先忽略主权国家和国家错综复杂的烂摊子），不同的数据粒度（Lucy 现在的住所被指定为一个城市，而她的出生地点只是在一个州的级别）。你可以想象延伸图还能包括许多关于 Lucy 和 Alain，或其他人的其他更多的事实。例如，你可以用它来表示食物过敏（为每个过敏源增加一个顶点，并增加人与过敏源之间的一条边来指示一种过敏情况），并链接到过敏源，每个过敏源具有一组顶点用来显示哪些食物含有哪些物质。然后，你可以写一个查询，找出每个人吃什么是安全的。图表在可演化性是富有优势的：当向应用程序添加功能时，可以轻松扩展图以适应应用程序数据结构的变化。</p><h2 id=cypher-查询语言>Cypher 查询语言</h2><p>Cypher 是属性图的声明式查询语言，为 Neo4j 图形数据库而发明，每个顶点都有一个像 USA 或 Idaho 这样的符号名称，查询的其他部分可以使用这些名称在顶点之间创建边，使用箭头符号：<code>（Idaho）- [：WITHIN] ->（USA）</code> 创建一条标记为 WITHIN 的边，Idaho 为尾节点，USA 为头节点。</p><pre tabindex=0><code class=language-cypher data-lang=cypher>CREATE
	(NAmerica:Location {name:&#39;North America&#39;, type:&#39;continent&#39;}),
	(USA:Location      {name:&#39;United States&#39;, type:&#39;country&#39;  }),
	(Idaho:Location    {name:&#39;Idaho&#39;,         type:&#39;state&#39;    }),
	(Lucy:Person       {name:&#39;Lucy&#39; }),
	(Idaho) -[:WITHIN]-&gt;  (USA)  -[:WITHIN]-&gt; (NAmerica),
	(Lucy)  -[:BORN_IN]-&gt; (Idaho)
</code></pre><p>所有顶点和边被添加到数据库后，让我们提些有趣的问题：例如，找到所有从美国移民到欧洲的人的名字。更确切地说，这里我们想要找到符合下面条件的所有顶点，并且返回这些顶点的 name 属性：该顶点拥有一条连到美国任一位置的 BORN_IN 边，和一条连到欧洲的任一位置的 LIVING_IN 边。下例展示了如何在 Cypher 中表达这个查询。在 MATCH 子句中使用相同的箭头符号来查找图中的模式：<code>(person) -[:BORN_IN]-> ()</code> 可以匹配 BORN_IN 边的任意两个顶点。该边的尾节点被绑定了变量 person，头节点则未被绑定。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=c1>-- 查找所有从美国移民到欧洲的人的Cypher查询
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>MATCH</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=p>(</span><span class=n>person</span><span class=p>)</span><span class=w> </span><span class=o>-</span><span class=p>[:</span><span class=n>BORN_IN</span><span class=p>]</span><span class=o>-&gt;</span><span class=w>  </span><span class=p>()</span><span class=w> </span><span class=o>-</span><span class=p>[:</span><span class=n>WITHIN</span><span class=o>*</span><span class=mi>0</span><span class=p>..]</span><span class=o>-&gt;</span><span class=w> </span><span class=p>(</span><span class=n>us</span><span class=p>:</span><span class=k>Location</span><span class=w> </span><span class=err>{</span><span class=n>name</span><span class=p>:</span><span class=s1>&#39;United States&#39;</span><span class=err>}</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=p>(</span><span class=n>person</span><span class=p>)</span><span class=w> </span><span class=o>-</span><span class=p>[:</span><span class=n>LIVES_IN</span><span class=p>]</span><span class=o>-&gt;</span><span class=w> </span><span class=p>()</span><span class=w> </span><span class=o>-</span><span class=p>[:</span><span class=n>WITHIN</span><span class=o>*</span><span class=mi>0</span><span class=p>..]</span><span class=o>-&gt;</span><span class=w> </span><span class=p>(</span><span class=n>eu</span><span class=p>:</span><span class=k>Location</span><span class=w> </span><span class=err>{</span><span class=n>name</span><span class=p>:</span><span class=s1>&#39;Europe&#39;</span><span class=err>}</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>RETURN</span><span class=w> </span><span class=n>person</span><span class=p>.</span><span class=n>name</span><span class=w>
</span></span></span></code></pre></div><p>该查询会按照如下来解读，找到满足以下两个条件的所有顶点（称之为 person 顶点）：</p><ul><li>person 顶点拥有一条到某个顶点的 BORN_IN 出边。从那个顶点开始，沿着一系列 WITHIN 出边最终到达一个类型为 Location，name 属性为 United States 的顶点。</li><li>person 顶点还拥有一条 LIVES_IN 出边。沿着这条边，可以通过一系列 WITHIN 出边最终到达一个类型为 Location，name 属性为 Europe 的顶点。</li><li>对于这样的 Person 顶点，返回其 name 属性。</li></ul><p>执行这条查询可能会有几种可行的查询路径。这里给出的描述建议首先扫描数据库中的所有人，检查每个人的出生地和居住地，然后只返回符合条件的那些人。等价地，也可以从两个 Location 顶点开始反向地查找。假如 name 属性上有索引，则可以高效地找到代表美国和欧洲的两个顶点。然后，沿着所有 WITHIN 入边，可以继续查找出所有在美国和欧洲的位置（州，地区，城市等）。最后，查找出那些可以由 BORN_IN 或 LIVES_IN 入边到那些位置顶点的人。</p><p>通常对于声明式查询语言来说，在编写查询语句时，不需要指定执行细节：查询优化程序会自动选择预测效率最高的策略，因此你可以继续编写应用程序的其他部分。</p><h2 id=sql-中的图查询>SQL 中的图查询</h2><p>在关系数据库中，你通常会事先知道在查询中需要哪些连接。在图查询中，你可能需要在找到待查找的顶点之前，遍历可变数量的边。也就是说，连接的数量事先并不确定。在我们的例子中，这发生在 Cypher 查询中的<code>() -[:WITHIN*0..]-> ()</code>规则中。一个人的<code>LIVES_IN</code>边可以指向任何类型的位置：街道，城市，地区，地区，国家等。城市可以在一个地区，在一个州内的一个地区，在一个国家内的一个州等等。<code>LIVES_IN</code>边可以直接指向正在查找的位置，或者一个在位置层次结构中隔了数层的位置。</p><p>在 Cypher 中，用<code>WITHIN * 0</code>非常简洁地表述了上述事实：“沿着<code>WITHIN</code>边，零次或多次”。它很像正则表达式中的<code>*</code>运算符。自 SQL:1999，查询可变长度遍历路径的思想可以使用称为<strong>递归公用表表达式</strong>（<code>WITH RECURSIVE</code>语法）的东西来表示。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>WITH</span><span class=w> </span><span class=k>RECURSIVE</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c1>-- in_usa 包含所有的美国境内的位置ID
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w>    </span><span class=n>in_usa</span><span class=p>(</span><span class=n>vertex_id</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=n>vertex_id</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>vertices</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>properties</span><span class=w> </span><span class=o>-&gt;&gt;</span><span class=w> </span><span class=s1>&#39;name&#39;</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;United States&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>UNION</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=n>edges</span><span class=p>.</span><span class=n>tail_vertex</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>edges</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=k>JOIN</span><span class=w> </span><span class=n>in_usa</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>edges</span><span class=p>.</span><span class=n>head_vertex</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>in_usa</span><span class=p>.</span><span class=n>vertex_id</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=k>WHERE</span><span class=w> </span><span class=n>edges</span><span class=p>.</span><span class=n>label</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;within&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c1>-- in_europe 包含所有的欧洲境内的位置ID
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w>    </span><span class=n>in_europe</span><span class=p>(</span><span class=n>vertex_id</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=n>vertex_id</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>vertices</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>properties</span><span class=w> </span><span class=o>-&gt;&gt;</span><span class=w> </span><span class=s1>&#39;name&#39;</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;Europe&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>UNION</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=n>edges</span><span class=p>.</span><span class=n>tail_vertex</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>edges</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=k>JOIN</span><span class=w> </span><span class=n>in_europe</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>edges</span><span class=p>.</span><span class=n>head_vertex</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>in_europe</span><span class=p>.</span><span class=n>vertex_id</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=k>WHERE</span><span class=w> </span><span class=n>edges</span><span class=p>.</span><span class=n>label</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;within&#39;</span><span class=w> </span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c1>-- born_in_usa 包含了所有类型为Person，且出生在美国的顶点
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w>    </span><span class=n>born_in_usa</span><span class=p>(</span><span class=n>vertex_id</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=k>SELECT</span><span class=w> </span><span class=n>edges</span><span class=p>.</span><span class=n>tail_vertex</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>edges</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>JOIN</span><span class=w> </span><span class=n>in_usa</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>edges</span><span class=p>.</span><span class=n>head_vertex</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>in_usa</span><span class=p>.</span><span class=n>vertex_id</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>WHERE</span><span class=w> </span><span class=n>edges</span><span class=p>.</span><span class=n>label</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;born_in&#39;</span><span class=w> </span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c1>-- lives_in_europe 包含了所有类型为Person，且居住在欧洲的顶点。
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w>    </span><span class=n>lives_in_europe</span><span class=p>(</span><span class=n>vertex_id</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=k>SELECT</span><span class=w> </span><span class=n>edges</span><span class=p>.</span><span class=n>tail_vertex</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>edges</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>JOIN</span><span class=w> </span><span class=n>in_europe</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>edges</span><span class=p>.</span><span class=n>head_vertex</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>in_europe</span><span class=p>.</span><span class=n>vertex_id</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>WHERE</span><span class=w> </span><span class=n>edges</span><span class=p>.</span><span class=n>label</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;lives_in&#39;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=k>SELECT</span><span class=w> </span><span class=n>vertices</span><span class=p>.</span><span class=n>properties</span><span class=w> </span><span class=o>-&gt;&gt;</span><span class=w> </span><span class=s1>&#39;name&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=k>FROM</span><span class=w> </span><span class=n>vertices</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>JOIN</span><span class=w> </span><span class=n>born_in_usa</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>vertices</span><span class=p>.</span><span class=n>vertex_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>born_in_usa</span><span class=p>.</span><span class=n>vertex_id</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>JOIN</span><span class=w> </span><span class=n>lives_in_europe</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>vertices</span><span class=p>.</span><span class=n>vertex_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>lives_in_europe</span><span class=p>.</span><span class=n>vertex_id</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></div><ul><li>首先，查找<code>name</code>属性为<code>United States</code>的顶点，将其作为<code>in_usa</code>顶点的集合的第一个元素。</li><li>从<code>in_usa</code>集合的顶点出发，沿着所有的<code>with_in</code>入边，将其尾顶点加入同一集合，不断递归直到所有<code>with_in</code>入边都被访问完毕。</li><li>同理，从<code>name</code>属性为<code>Europe</code>的顶点出发，建立<code>in_europe</code>顶点的集合。</li><li>对于<code>in_usa</code>集合中的每个顶点，根据<code>born_in</code>入边来查找出生在美国某个地方的人。</li><li>同样，对于<code>in_europe</code>集合中的每个顶点，根据<code>lives_in</code>入边来查找居住在欧洲的人。</li><li>最后，把在美国出生的人的集合与在欧洲居住的人的集合相交。</li></ul><p>同一个查询，用某一个查询语言可以写成 4 行，而用另一个查询语言需要 29 行，这恰恰说明了不同的数据模型是为不同的应用场景而设计的。选择适合应用程序的数据模型非常重要。</p><h1 id=三元组存储和-sparql>三元组存储和 SPARQL</h1><p>三元组存储模式大体上与属性图模型相同，用不同的词来描述相同的想法。不过仍然值得讨论，因为三元组存储有很多现成的工具和语言，这些工具和语言对于构建应用程序的工具箱可能是宝贵的补充。在三元组存储中，所有信息都以非常简单的三部分表示形式存储（主语，谓语，宾语）。例如，三元组 (吉姆, 喜欢 ,香蕉) 中，吉姆 是主语，喜欢 是谓语（动词），香蕉 是对象。</p><p>三元组的主语相当于图中的一个顶点。而宾语是下面两者之一：</p><ol><li>原始数据类型中的值，例如字符串或数字。在这种情况下，三元组的谓语和宾语相当于主语顶点上的属性的键和值。例如，<code>(lucy, age, 33)</code>就像属性<code>{“age”：33}</code>的顶点 lucy。</li><li>图中的另一个顶点。在这种情况下，谓语是图中的一条边，主语是其尾部顶点，而宾语是其头部顶点。例如，在<code>(lucy, marriedTo, alain)</code>中主语和宾语<code>lucy</code>和<code>alain</code>都是顶点，并且谓语<code>marriedTo</code>是连接他们的边的标签。</li></ol><p>下面将前面的例子以称为 Turtle 的格式（Notation3（N3））的一个子集形式写成三元组。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=o>@</span><span class=k>prefix</span><span class=w> </span><span class=p>:</span><span class=w> </span><span class=o>&lt;</span><span class=n>urn</span><span class=p>:</span><span class=n>example</span><span class=p>:</span><span class=o>&gt;</span><span class=p>.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>_</span><span class=p>:</span><span class=n>lucy</span><span class=w>     </span><span class=n>a</span><span class=w>       </span><span class=p>:</span><span class=n>Person</span><span class=p>.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>_</span><span class=p>:</span><span class=n>lucy</span><span class=w>     </span><span class=p>:</span><span class=n>name</span><span class=w>   </span><span class=s2>&#34;Lucy&#34;</span><span class=p>.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>_</span><span class=p>:</span><span class=n>lucy</span><span class=w>     </span><span class=p>:</span><span class=n>bornIn</span><span class=w> </span><span class=n>_</span><span class=p>:</span><span class=n>idaho</span><span class=p>.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>_</span><span class=p>:</span><span class=n>idaho</span><span class=w>    </span><span class=n>a</span><span class=w>       </span><span class=p>:</span><span class=k>Location</span><span class=p>.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>_</span><span class=p>:</span><span class=n>idaho</span><span class=w>    </span><span class=p>:</span><span class=n>name</span><span class=w>   </span><span class=s2>&#34;Idaho&#34;</span><span class=p>.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>_</span><span class=p>:</span><span class=n>idaho</span><span class=w>    </span><span class=p>:</span><span class=k>type</span><span class=w>   </span><span class=s2>&#34;state&#34;</span><span class=p>.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>_</span><span class=p>:</span><span class=n>idaho</span><span class=w>    </span><span class=p>:</span><span class=n>within</span><span class=w> </span><span class=n>_</span><span class=p>:</span><span class=n>usa</span><span class=p>.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>_</span><span class=p>:</span><span class=n>usa</span><span class=w>      </span><span class=n>a</span><span class=w>       </span><span class=p>:</span><span class=k>Location</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>_</span><span class=p>:</span><span class=n>usa</span><span class=w>      </span><span class=p>:</span><span class=n>name</span><span class=w>   </span><span class=s2>&#34;United States&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>_</span><span class=p>:</span><span class=n>usa</span><span class=w>      </span><span class=p>:</span><span class=k>type</span><span class=w>   </span><span class=s2>&#34;country&#34;</span><span class=p>.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>_</span><span class=p>:</span><span class=n>usa</span><span class=w>      </span><span class=p>:</span><span class=n>within</span><span class=w> </span><span class=n>_</span><span class=p>:</span><span class=n>namerica</span><span class=p>.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>_</span><span class=p>:</span><span class=n>namerica</span><span class=w> </span><span class=n>a</span><span class=w>       </span><span class=p>:</span><span class=k>Location</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>_</span><span class=p>:</span><span class=n>namerica</span><span class=w> </span><span class=p>:</span><span class=n>name</span><span class=w>   </span><span class=s2>&#34;North America&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>_</span><span class=p>:</span><span class=n>namerica</span><span class=w> </span><span class=p>:</span><span class=k>type</span><span class=w>   </span><span class=p>:</span><span class=s2>&#34;continent&#34;</span><span class=w>
</span></span></span></code></pre></div><p>在这个例子中，图的顶点被写为：<code>_：someName</code>。这个名字并不意味着这个文件以外的任何东西。它的存在只是帮助我们明确哪些三元组引用了同一顶点。当谓语表示边时，该宾语是一个顶点，如<code>_:idaho :within _:usa.</code>。当谓语是一个属性时，该宾语是一个字符串，如<code>_:usa :name "United States"</code>。一遍又一遍地重复相同的主语看起来相当重复，但幸运的是，可以使用分号来说明关于同一主语的多个事情。这使得 Turtle 格式相当不错，可读性强：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=o>@</span><span class=k>prefix</span><span class=w> </span><span class=p>:</span><span class=w> </span><span class=o>&lt;</span><span class=n>urn</span><span class=p>:</span><span class=n>example</span><span class=p>:</span><span class=o>&gt;</span><span class=p>.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>_</span><span class=p>:</span><span class=n>lucy</span><span class=w>      </span><span class=n>a</span><span class=w> </span><span class=p>:</span><span class=n>Person</span><span class=p>;</span><span class=w>   </span><span class=p>:</span><span class=n>name</span><span class=w> </span><span class=s2>&#34;Lucy&#34;</span><span class=p>;</span><span class=w>          </span><span class=p>:</span><span class=n>bornIn</span><span class=w> </span><span class=n>_</span><span class=p>:</span><span class=n>idaho</span><span class=p>.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>_</span><span class=p>:</span><span class=n>idaho</span><span class=w>     </span><span class=n>a</span><span class=w> </span><span class=p>:</span><span class=k>Location</span><span class=p>;</span><span class=w> </span><span class=p>:</span><span class=n>name</span><span class=w> </span><span class=s2>&#34;Idaho&#34;</span><span class=p>;</span><span class=w>         </span><span class=p>:</span><span class=k>type</span><span class=w> </span><span class=s2>&#34;state&#34;</span><span class=p>;</span><span class=w>   </span><span class=p>:</span><span class=n>within</span><span class=w> </span><span class=n>_</span><span class=p>:</span><span class=n>usa</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>_</span><span class=p>:</span><span class=n>usa</span><span class=w>       </span><span class=n>a</span><span class=w> </span><span class=p>:</span><span class=n>Loaction</span><span class=p>;</span><span class=w> </span><span class=p>:</span><span class=n>name</span><span class=w> </span><span class=s2>&#34;United States&#34;</span><span class=p>;</span><span class=w> </span><span class=p>:</span><span class=k>type</span><span class=w> </span><span class=s2>&#34;country&#34;</span><span class=p>;</span><span class=w> </span><span class=p>:</span><span class=n>within</span><span class=w> </span><span class=n>_</span><span class=p>:</span><span class=n>namerica</span><span class=p>.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>_</span><span class=p>:</span><span class=n>namerica</span><span class=w>  </span><span class=n>a</span><span class=w> </span><span class=p>:</span><span class=k>Location</span><span class=p>;</span><span class=w> </span><span class=p>:</span><span class=n>name</span><span class=w> </span><span class=s2>&#34;North America&#34;</span><span class=p>;</span><span class=w> </span><span class=p>:</span><span class=k>type</span><span class=w> </span><span class=s2>&#34;continent&#34;</span><span class=p>.</span><span class=w>
</span></span></span></code></pre></div><h1 id=语义网络>语义网络</h1><p>从本质上讲语义网是一个简单且合理的想法：网站已经将信息发布为文字和图片供人类阅读，为什么不将信息作为机器可读的数据也发布给计算机呢？资源描述框架（RDF）的目的是作为不同网站以一致的格式发布数据的一种机制，允许来自不同网站的数据自动合并成一个数据网络，即一种互联网范围内的“关于一切的数据库“。</p><p>值得注意的是，三元组存储数据模型完全独立于语义网络，例如，Datomic 是三元组存储。</p><h2 id=rdf-数据模型>RDF 数据模型</h2><p>Turtle 语言是一种用于 RDF 数据的人可读格式。有时候，RDF 也可以以 XML 格式编写，不过完成同样的事情会相对啰嗦，Turtle/N3 是更可取的，因为它更容易阅读，像 Apache Jena 这样的工具可以根据需要在不同的 RDF 格式之间进行自动转换。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;rdf:RDF</span> <span class=na>xmlns=</span><span class=s>&#34;urn:example:&#34;</span>
</span></span><span class=line><span class=cl>         <span class=na>xmlns:rdf=</span><span class=s>&#34;http://www.w3.org/1999/02/22-rdf-syntax-ns#&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;Location</span> <span class=na>rdf:nodeID=</span><span class=s>&#34;idaho&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;name&gt;</span>Idaho<span class=nt>&lt;/name&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;type&gt;</span>state<span class=nt>&lt;/type&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;within&gt;</span>
</span></span><span class=line><span class=cl>            <span class=nt>&lt;Location</span> <span class=na>rdf:nodeID=</span><span class=s>&#34;usa&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>                <span class=nt>&lt;name&gt;</span>United States<span class=nt>&lt;/name&gt;</span>
</span></span><span class=line><span class=cl>                <span class=nt>&lt;type&gt;</span>country<span class=nt>&lt;/type&gt;</span>
</span></span><span class=line><span class=cl>                <span class=nt>&lt;within&gt;</span>
</span></span><span class=line><span class=cl>                    <span class=nt>&lt;Location</span> <span class=na>rdf:nodeID=</span><span class=s>&#34;namerica&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>                        <span class=nt>&lt;name&gt;</span>North America<span class=nt>&lt;/name&gt;</span>
</span></span><span class=line><span class=cl>                        <span class=nt>&lt;type&gt;</span>continent<span class=nt>&lt;/type&gt;</span>
</span></span><span class=line><span class=cl>                    <span class=nt>&lt;/Location&gt;</span>
</span></span><span class=line><span class=cl>                <span class=nt>&lt;/within&gt;</span>
</span></span><span class=line><span class=cl>            <span class=nt>&lt;/Location&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;/within&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;/Location&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;Person</span> <span class=na>rdf:nodeID=</span><span class=s>&#34;lucy&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;name&gt;</span>Lucy<span class=nt>&lt;/name&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;bornIn</span> <span class=na>rdf:nodeID=</span><span class=s>&#34;idaho&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;/Person&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/rdf:RDF&gt;</span>
</span></span></code></pre></div><p>RDF 有一些奇怪之处，因为它是为了在互联网上交换数据而设计的。三元组的主语，谓语和宾语通常是 URI。例如，谓语可能是一个 URI，如 <code>或</code>，而不仅仅是<code>WITHIN</code>或<code>LIVES_IN</code>。这个设计背后的原因为了让你能够把你的数据和其他人的数据结合起来，如果他们赋予单词<code>within</code>或者<code>lives_in</code>不同的含义，两者也不会冲突，因为它们的谓语实际上是<code>和</code>。</p><p>从 RDF 的角度来看，URL 不一定需要能解析成什么东西，它只是一个命名空间。为避免与<code>http://URL</code>混淆，本节中的示例使用不可解析的 URI，如<code>urn：example：within</code>。幸运的是，你只需在文件顶部指定一个前缀，然后就不用再管了。</p><h2 id=sparql-查询语言>SPARQL 查询语言</h2><p>SPARQL 是一种用于三元组存储的面向 RDF 数据模型的查询语言，它是 SPARQL 协议和 RDF 查询语言的缩写，发音为“sparkle”。SPARQL 早于 Cypher，并且由于 Cypher 的模式匹配借鉴于 SPARQL，这使得它们看起来非常相似。与之前相同的查询，查找从美国转移到欧洲的人，使用 SPARQL 比使用 Cypher 甚至更为简洁：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>PREFIX</span><span class=w> </span><span class=p>:</span><span class=w> </span><span class=o>&lt;</span><span class=n>urn</span><span class=p>:</span><span class=n>example</span><span class=p>:</span><span class=o>&gt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>SELECT</span><span class=w> </span><span class=o>?</span><span class=n>personName</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=err>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=o>?</span><span class=n>person</span><span class=w> </span><span class=p>:</span><span class=n>name</span><span class=w> </span><span class=o>?</span><span class=n>personName</span><span class=p>.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=o>?</span><span class=n>person</span><span class=w> </span><span class=p>:</span><span class=n>bornIn</span><span class=w>  </span><span class=o>/</span><span class=w> </span><span class=p>:</span><span class=n>within</span><span class=o>*</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=p>:</span><span class=n>name</span><span class=w> </span><span class=s2>&#34;United States&#34;</span><span class=p>.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=o>?</span><span class=n>person</span><span class=w> </span><span class=p>:</span><span class=n>livesIn</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=p>:</span><span class=n>within</span><span class=o>*</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=p>:</span><span class=n>name</span><span class=w> </span><span class=s2>&#34;Europe&#34;</span><span class=p>.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=err>}</span><span class=w>
</span></span></span></code></pre></div><p>结构非常相似。以下两个表达式是等价的（SPARQL 中的变量以问号开头）：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=p>(</span><span class=n>person</span><span class=p>)</span><span class=w> </span><span class=o>-</span><span class=p>[:</span><span class=n>BORN_IN</span><span class=p>]</span><span class=o>-&gt;</span><span class=w> </span><span class=p>()</span><span class=w> </span><span class=o>-</span><span class=p>[:</span><span class=n>WITHIN</span><span class=o>*</span><span class=mi>0</span><span class=p>..]</span><span class=o>-&gt;</span><span class=w> </span><span class=p>(</span><span class=k>location</span><span class=p>)</span><span class=w>   </span><span class=o>#</span><span class=w> </span><span class=n>Cypher</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>?</span><span class=n>person</span><span class=w> </span><span class=p>:</span><span class=n>bornIn</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=p>:</span><span class=n>within</span><span class=o>*</span><span class=w> </span><span class=o>?</span><span class=k>location</span><span class=p>.</span><span class=w>                   </span><span class=o>#</span><span class=w> </span><span class=n>SPARQL</span><span class=w>
</span></span></span></code></pre></div><p>因为 RDF 不区分属性和边，而只是将它们作为谓语，所以可以使用相同的语法来匹配属性。在下面的表达式中，变量 usa 被绑定到任意具有值为字符串"United States"的 name 属性的顶点：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=p>(</span><span class=n>usa</span><span class=w> </span><span class=err>{</span><span class=n>name</span><span class=p>:</span><span class=s1>&#39;United States&#39;</span><span class=err>}</span><span class=p>)</span><span class=w>   </span><span class=o>#</span><span class=w> </span><span class=n>Cypher</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>?</span><span class=n>usa</span><span class=w> </span><span class=p>:</span><span class=n>name</span><span class=w> </span><span class=s2>&#34;United States&#34;</span><span class=p>.</span><span class=w>    </span><span class=o>#</span><span class=w> </span><span class=n>SPARQL</span><span class=w>
</span></span></span></code></pre></div><h1 id=datalog>Datalog</h1><p>Datalog 是比 SPARQL 或 Cypher 更古老的语言，在 20 世纪 80 年代被学者广泛研究。它在软件工程师中不太知名，但是它是重要的，因为它为以后的查询语言提供了基础。在实践中，Datalog 被用于少数的数据系统中：例如，它是 Datomic 的查询语言，Cascalog 是一种用于查询 Hadoop 大数据集的 Datalog 实现。</p><p>Datalog 的数据模型类似于三元组模式，但进行了一点泛化。把三元组写成谓语（主语，宾语），而不是写三元语（主语，谓语，宾语）。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=n>name</span><span class=p>(</span><span class=n>namerica</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;North America&#39;</span><span class=p>).</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>type</span><span class=p>(</span><span class=n>namerica</span><span class=p>,</span><span class=w> </span><span class=n>continent</span><span class=p>).</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>name</span><span class=p>(</span><span class=n>usa</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;United States&#39;</span><span class=p>).</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>type</span><span class=p>(</span><span class=n>usa</span><span class=p>,</span><span class=w> </span><span class=n>country</span><span class=p>).</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>within</span><span class=p>(</span><span class=n>usa</span><span class=p>,</span><span class=w> </span><span class=n>namerica</span><span class=p>).</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>name</span><span class=p>(</span><span class=n>idaho</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;Idaho&#39;</span><span class=p>).</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>type</span><span class=p>(</span><span class=n>idaho</span><span class=p>,</span><span class=w> </span><span class=k>state</span><span class=p>).</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>within</span><span class=p>(</span><span class=n>idaho</span><span class=p>,</span><span class=w> </span><span class=n>usa</span><span class=p>).</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>name</span><span class=p>(</span><span class=n>lucy</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;Lucy&#39;</span><span class=p>).</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>born_in</span><span class=p>(</span><span class=n>lucy</span><span class=p>,</span><span class=w> </span><span class=n>idaho</span><span class=p>).</span><span class=w>
</span></span></span></code></pre></div><p>既然已经定义了数据，我们可以像之前一样编写相同的查询：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=n>within_recursive</span><span class=p>(</span><span class=k>Location</span><span class=p>,</span><span class=w> </span><span class=n>Name</span><span class=p>)</span><span class=w> </span><span class=p>:</span><span class=o>-</span><span class=w> </span><span class=n>name</span><span class=p>(</span><span class=k>Location</span><span class=p>,</span><span class=w> </span><span class=n>Name</span><span class=p>).</span><span class=w> </span><span class=cm>/* Rule 1 */</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>within_recursive</span><span class=p>(</span><span class=k>Location</span><span class=p>,</span><span class=w> </span><span class=n>Name</span><span class=p>)</span><span class=w> </span><span class=p>:</span><span class=o>-</span><span class=w> </span><span class=n>within</span><span class=p>(</span><span class=k>Location</span><span class=p>,</span><span class=w> </span><span class=n>Via</span><span class=p>),</span><span class=w> </span><span class=cm>/* Rule 2 */</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>									</span><span class=n>within_recursive</span><span class=p>(</span><span class=n>Via</span><span class=p>,</span><span class=w> </span><span class=n>Name</span><span class=p>).</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>migrated</span><span class=p>(</span><span class=n>Name</span><span class=p>,</span><span class=w> </span><span class=n>BornIn</span><span class=p>,</span><span class=w> </span><span class=n>LivingIn</span><span class=p>)</span><span class=w> </span><span class=p>:</span><span class=o>-</span><span class=w> </span><span class=n>name</span><span class=p>(</span><span class=n>Person</span><span class=p>,</span><span class=w> </span><span class=n>Name</span><span class=p>),</span><span class=w> </span><span class=cm>/* Rule 3 */</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                                    </span><span class=n>born_in</span><span class=p>(</span><span class=n>Person</span><span class=p>,</span><span class=w> </span><span class=n>BornLoc</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                                    </span><span class=n>within_recursive</span><span class=p>(</span><span class=n>BornLoc</span><span class=p>,</span><span class=w> </span><span class=n>BornIn</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                                    </span><span class=n>lives_in</span><span class=p>(</span><span class=n>Person</span><span class=p>,</span><span class=w> </span><span class=n>LivingLoc</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                                    </span><span class=n>within_recursive</span><span class=p>(</span><span class=n>LivingLoc</span><span class=p>,</span><span class=w> </span><span class=n>LivingIn</span><span class=p>).</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>?-</span><span class=w> </span><span class=n>migrated</span><span class=p>(</span><span class=n>Who</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;United States&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;Europe&#39;</span><span class=p>).</span><span class=w> </span><span class=cm>/* Who = &#39;Lucy&#39;. */</span><span class=w>
</span></span></span></code></pre></div><p>Cypher 和 SPARQL 使用 SELECT 立即跳转，但是 Datalog 一次只进行一小步。我们定义<strong>规则</strong>，以将新谓语告诉数据库：在这里，我们定义了两个新的谓语，<code>within_recursive</code>和<code>migrated</code>。这些谓语不是存储在数据库中的三元组中，而是它们是从数据或其他规则派生而来的。规则可以引用其他规则，就像函数可以调用其他函数或者递归地调用自己一样。像这样，复杂的查询可以一次构建其中的一小块。</p><p>在规则中，以大写字母开头的单词是变量，谓语则用 Cypher 和 SPARQL 的方式一样来匹配。例如，<code>name(Location, Name)</code>通过变量绑定<code>Location = namerica</code>和<code>Name ='North America'</code>可以匹配三元组<code>name(namerica, 'North America')</code>。</p><p>要是系统可以在<code>:-</code> 操作符的右侧找到与所有谓语的一个匹配，就运用该规则。当规则运用时，就好像通过<code>:-</code>的左侧将其添加到数据库（将变量替换成它们匹配的值）。</p><p>因此，一种可能的应用规则的方式是：</p><ol><li>数据库存在<code>name(namerica, 'North America')</code>，故运用规则 1。它生成<code>within_recursive(namerica, 'North America')</code>。</li><li>数据库存在<code>within(usa, namerica)</code>，在上一步骤中生成<code>within_recursive(namerica, 'North America')</code>，故运用规则 2。它会产生<code>within_recursive(usa, 'North America')</code>。</li><li>数据库存在<code>within(idaho, usa)</code>，在上一步生成<code>within_recursive(usa, 'North America')</code>，故运用规则 2。它产生<code>within_recursive(idaho, 'North America')</code>。</li></ol><p>通过重复应用规则 1 和 2，within_recursive 谓语可以告诉我们在数据库中包含北美（或任何其他位置名称）的所有位置。</p><p><figure><div class="d-flex justify-content-center"><div class=w-100><img src=https://s2.ax1x.com/2020/02/04/1BBjJA.png alt="使用 Datalog 规则来确定爱达荷州在北美。" loading=lazy data-zoomable></div></div></figure></p><p>现在规则 3 可以找到出生在某个地方 BornIn 的人，并住在某个地方 LivingIn。通过查询 BornIn =&lsquo;United States&rsquo;和 LivingIn =&lsquo;Europe&rsquo;，并将此人作为变量 Who，让 Datalog 系统找出变量 Who 会出现哪些值。因此，最后得到了与早先的 Cypher 和 SPARQL 查询相同的答案。</p></div><div class=article-widget><div class="container-xl row post-nav"><div class="col-6 post-nav-item"><div class=meta-nav>上一页</div><a href=/books/database-series/1.%E6%95%B0%E6%8D%AE%E5%BA%93%E5%9F%BA%E7%A1%80/%E6%95%B0%E6%8D%AE%E6%A8%A1%E5%9E%8B/%E6%97%B6%E5%BA%8F%E6%A8%A1%E5%9E%8B/ rel=next>时序模型</a></div><div class="col-6 post-nav-item"><div class=meta-nav>下一页</div><a href=/books/database-series/1.%E6%95%B0%E6%8D%AE%E5%BA%93%E5%9F%BA%E7%A1%80/%E6%95%B0%E6%8D%AE%E6%A8%A1%E5%9E%8B/%E6%96%87%E6%A1%A3%E6%A8%A1%E5%9E%8B/ rel=prev>文档模型</a></div></div></div><div class=body-footer><p>最近更新于 0001-01-01</p><section id=comments class="mb-3 pt-0"><div id=disqus_thread></div><script>var disqus_config=function(){};(function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="https://ngte.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)})()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></section></div></article><footer class=site-footer><div class="copyright py-4 bg-footer"><div class="row justify-content-center"><div class="text-center footer-color"><p class=mb-0>© 2017-2022 NGTE all rights reserved</p></div></div></div></footer></main></div></div><script src=//unpkg.com/heti/umd/heti-addon.min.js></script>
<script>const heti=new Heti(".article");heti.autoSpacing()</script><script type=text/javascript>window.$crisp=[],window.CRISP_WEBSITE_ID="12adcc35-9621-4313-8262-62dc654b29d8",function(){setTimeout(function(){d=document,s=d.createElement("script"),s.src="https://client.crisp.chat/l.js",s.async=1,d.getElementsByTagName("head")[0].appendChild(s)},2500)}()</script></div><div class=page-footer></div><script src=/js/vendor-bundle.min.d26509351aa0ff874abbee824e982e9b.js></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.1/highlight.min.js integrity="sha512-Ypjm0o7jOxAd4hpdoppSEN0TQOC19UtPAqD+4s5AlXmUvbmmS/YMxYqAqarQYyxTnB6/rqip9qcxlNB/3U9Wdg==" crossorigin=anonymous></script>
<script id=search-hit-algolia-template type=text/html><div class=search-hit><div class=search-hit-content><div class=search-hit-name><a href={{relpermalink}}>{{#helpers.highlight}}{ "attribute": "title" }{{/helpers.highlight}}</a></div><div class="article-metadata search-hit-type">{{type}}</div><p class=search-hit-description>{{#helpers.highlight}}{ "attribute": "summary" }{{/helpers.highlight}}</p></div></div></script><script src=https://cdn.jsdelivr.net/npm/instantsearch.js@4/dist/instantsearch.production.min.js crossorigin=anonymous></script>
<script id=dsq-count-scr src=https://ngte.disqus.com/count.js async></script>
<script src=/zh/js/algolia-search-built.min.4387d694ca1258194aaf562b8cd1c400.js type=module></script>
<script id=page-data type=application/json>{"use_headroom":false}</script><script src=/zh/js/wowchemy.min.d1673c7a11d1238516cbe12a1e84257f.js></script>
<script>var mybutton=document.getElementById("backTopBtn");window.onscroll=function(){scrollFunction()};function scrollFunction(){document.body.scrollTop>20||document.documentElement.scrollTop>20?mybutton.style.display="block":mybutton.style.display="none"}function topFunction(){document.body.scrollTop=0,document.documentElement.scrollTop=0}</script><script src=https://cdn.jsdelivr.net/gh/bryanbraun/anchorjs@4.2.2/anchor.min.js integrity="sha512-I7w3ZdSFzw5j3jU3ZkNikBNeIrl3i+hEuEdwNmqUJvwNcaBUNcijnP2gd9DtGlgVYDplfjGoD8vTNsID+lCjqg==" crossorigin=anonymous></script>
<script>anchors.add()</script><script>(function(){"use strict";if(!document.queryCommandSupported("copy"))return;function e(e,t){e.className="highlight-copy-btn",e.textContent=t,setTimeout(function(){e.textContent="",e.className="highlight-copy-btn fa fa-copy"},1e3)}function t(e){var t=window.getSelection(),n=document.createRange();return n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n),t}function n(n){var o,s=document.createElement("button");s.className="highlight-copy-btn fa fa-copy",s.textContent="",o=n.firstElementChild,s.addEventListener("click",function(){try{var n=t(o);document.execCommand("copy"),n.removeAllRanges(),e(s,"已复制")}catch(t){console&&console.log(t),e(s,"Failed :'(")}}),n.appendChild(s)}var s=document.getElementsByClassName("highlight");Array.prototype.forEach.call(s,n)})()</script></body></html>