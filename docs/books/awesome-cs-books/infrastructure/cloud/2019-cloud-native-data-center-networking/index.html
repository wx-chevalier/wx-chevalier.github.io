<!doctype html><html lang=zh><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=generator content="Wowchemy 5.5.0 for Hugo"><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=preload as=style href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap"><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap" media=print onload='this.media="all"'><meta name=google-site-verification content="google69a5cccb61297807"><meta name=baidu-site-verification content="cqmZHEleVh"><meta name=description content="Cloud Native Data Center Networking 作者 Dinesh G. Dutt 是一家网络公司的首席科学家，在网络行业有 20 多年工作经验，曾 是 Cisco Fellow，是 TRILL、VxLAN 等协议的合作者（co-author）之一。 传统网络架构面临瓶颈 分布式应用（dis"><link rel=alternate hreflang=zh href=https://ng-tech.icu/books/awesome-cs-books/infrastructure/cloud/2019-cloud-native-data-center-networking/><meta name=theme-color content="#0a55a7"><link rel=stylesheet href=/css/vendor-bundle.min.c7b8d9abd591ba2253ea42747e3ac3f5.css media=print onload='this.media="all"'><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.1/styles/github.min.css crossorigin=anonymous title=hl-light media=print onload='this.media="all"'><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.1/styles/dracula.min.css crossorigin=anonymous title=hl-dark media=print onload='this.media="all"' disabled><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/instantsearch.css@7.4.5/themes/satellite-min.css integrity="sha256-TehzF/2QvNKhGQrrNpoOb2Ck4iGZ1J/DI4pkd2oUsBc=" crossorigin=anonymous><link rel=stylesheet href=/css/wowchemy.63df6ae9fc2b4cc71b83f1774d780209.css><script async src="https://www.googletagmanager.com/gtag/js?id=G-40NYXJ8823"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-40NYXJ8823")</script><script>var _hmt=_hmt||[];(function(){var e,t=document.createElement("script");t.src="https://hm.baidu.com/hm.js?56df1177bce405601b0ecdd7208f75c6",e=document.getElementsByTagName("script")[0],e.parentNode.insertBefore(t,e)})()</script><link rel=manifest href=/manifest.webmanifest><link rel=icon type=image/png href=/media/icon_hu0f7d075e895d6f5f1f5fdbc1e33dc138_10087_32x32_fill_lanczos_center_3.png><link rel=apple-touch-icon type=image/png href=/media/icon_hu0f7d075e895d6f5f1f5fdbc1e33dc138_10087_180x180_fill_lanczos_center_3.png><link rel=canonical href=https://ng-tech.icu/books/awesome-cs-books/infrastructure/cloud/2019-cloud-native-data-center-networking/><meta property="twitter:card" content="summary_large_image"><meta property="twitter:site" content="@wx-chevalier"><meta property="twitter:creator" content="@wx-chevalier"><meta property="og:site_name" content="Next-gen Tech Edu"><meta property="og:url" content="https://ng-tech.icu/books/awesome-cs-books/infrastructure/cloud/2019-cloud-native-data-center-networking/"><meta property="og:title" content="2019-Cloud Native Data Center Networking | Next-gen Tech Edu"><meta property="og:description" content="Cloud Native Data Center Networking 作者 Dinesh G. Dutt 是一家网络公司的首席科学家，在网络行业有 20 多年工作经验，曾 是 Cisco Fellow，是 TRILL、VxLAN 等协议的合作者（co-author）之一。 传统网络架构面临瓶颈 分布式应用（dis"><meta property="og:image" content="https://ng-tech.icu/media/sharing.png"><meta property="twitter:image" content="https://ng-tech.icu/media/sharing.png"><meta property="og:locale" content="zh"><meta property="article:modified_time" content="2023-03-05T15:38:23+08:00"><title>2019-Cloud Native Data Center Networking | Next-gen Tech Edu</title></head><body id=top data-spy=scroll data-offset=70 data-target=#TableOfContents class=page-wrapper data-wc-page-id=564eece0f5d8416b02b1d09fea1aa008><button onclick=topFunction() id=backTopBtn title="Go to top"><i class="fa-solid fa-circle-up" aria-hidden=true></i></button>
<script src=/js/wowchemy-init.min.14a0ed61c6dbd594b9c75193b25be179.js></script><aside class=search-modal id=search><div class=container><section class=search-header><div class="row no-gutters justify-content-between mb-3"><div class="col-6 search-title"><p>搜索</p></div><div class="col-6 col-search-close"><a class=js-search href=# aria-label=关闭><i class="fas fa-times-circle text-muted" aria-hidden=true></i></a></div></div><div id=search-box></div></section><section class=section-search-results><div id=search-hits></div><div id=search-common-queries></div></section></div></aside><div class=page-header><header class=header--fixed><nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id=navbar-main><div class=container-xl><div class="d-none d-lg-inline-flex"><a class=navbar-brand href=/>Next-gen Tech Edu</a></div><button type=button class=navbar-toggler data-toggle=collapse data-target=#navbar-content aria-controls=navbar-content aria-expanded=false aria-label=切换导航>
<span><i class="fas fa-bars"></i></span></button><div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none"><a class=navbar-brand href=/>Next-gen Tech Edu</a></div><div class="navbar-collapse main-menu-item collapse justify-content-start" id=navbar-content><ul class="navbar-nav d-md-inline-flex"><li class=nav-item><a class=nav-link href=/books-gallery><span>笔记（万篇）</span></a></li><li class=nav-item><a class=nav-link href=/#knowledge-map><span>知识图谱</span></a></li><style>.dropdown-item{display:inline-flex}</style><li class="nav-item dropdown"><a href=# class="nav-link dropdown-toggle" data-toggle=dropdown aria-haspopup=true><span>实验室</span><span class=caret></span></a><div class=dropdown-menu><a class=dropdown-item href=/galaxy-home/gh-craft><span>Craft 方块世界</span></a>
<a class=dropdown-item href=/galaxy-home/glossary-cards><span>3D 知识卡牌</span></a></div></li><style>.dropdown-item{display:inline-flex}</style><li class="nav-item dropdown"><a href=# class="nav-link dropdown-toggle" data-toggle=dropdown aria-haspopup=true><span>其他阅读渠道</span><span class=caret></span></a><div class=dropdown-menu><a class=dropdown-item href=https://zhuanlan.zhihu.com/wxyyxc1992><img style=width:16px;height:16px;display:inline-block;margin-right:8px src=https://ngte-superbed.oss-cn-beijing.aliyuncs.com/item/20230218234451.png></img><span>知乎</span></a>
<a class=dropdown-item href=https://segmentfault.com/blog/wxyyxc1992><img style=width:16px;height:16px;display:inline-block;margin-right:8px src=https://ngte-superbed.oss-cn-beijing.aliyuncs.com/item/20230219113556.png></img><span>SegmentFault</span></a>
<a class=dropdown-item href=https://zhuanlan.zhihu.com/wxyyxc1992><img style=width:16px;height:16px;display:inline-block;margin-right:8px src=https://ngte-superbed.oss-cn-beijing.aliyuncs.com/item/20230219113519.png></img><span>掘金</span></a></div></li></ul></div><ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2"><li class=nav-item><a class="nav-link js-search" href=# aria-label=搜索><i class="fas fa-search" aria-hidden=true></i></a></li><li class=nav-item><a class=nav-link href=https://github.com/wx-chevalier aria-label=GitHub><i class="fa-brands fa-github" aria-hidden=true></i></a></li><div></div><style>@media only screen and (max-width:600px){.jimmysong-template{display:none!important}}</style><li class=jimmysong-template style=color:#fff;font-size:12px><a href=https://jimmysong.io style=color:#fff>By Jimmy Song's Template</a></li></ul></div></nav></header></div><div class=page-body><link rel=stylesheet href=//unpkg.com/heti/umd/heti.min.css><div class="container-xl docs"><div class="row flex-xl-nowrap"><div class=docs-sidebar><form class="docs-search d-flex align-items-center"><button class="btn docs-toggle d-md-none p-0 mr-md-3 w-100" type=button data-toggle=collapse data-target=#docs-nav aria-controls=docs-nav aria-expanded=false aria-label="Toggle section navigation"><div class=d-flex><span class="d-md-none pl-1 flex-grow-1 text-left overflow-hidden">Cloud</span>
<span><i class="fas fa-chevron-down"></i></span></div></button>
<button class="form-control sidebar-search js-search d-none d-md-flex">
<i class="fas fa-search pr-2"></i>
<span class=sidebar-search-text>搜索...</span>
<span class=sidebar-search-shortcut>/</span></button></form><nav class="collapse docs-links" id=docs-nav><ul class="nav docs-sidenav"><li style=display:inline-flex><a style=cursor:pointer onclick=window.history.back()><i class="fas fa-arrow-left pr-1"></i>
Back</a>
<span>|</span>
<a href=/books/><i class="fa-solid fa-house" style=margin-right:4px></i>
Books</a></li></ul><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-ida78dee89063dae8af294ba0f9e860bb2")' href=#ida78dee89063dae8af294ba0f9e860bb2 aria-expanded=false aria-controls=ida78dee89063dae8af294ba0f9e860bb2 aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/awesome-cs-books/infrastructure/>Infrastructure</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#ida78dee89063dae8af294ba0f9e860bb2 aria-expanded=false aria-controls=ida78dee89063dae8af294ba0f9e860bb2><i class="fa-solid fa-angle-down" id=caret-ida78dee89063dae8af294ba0f9e860bb2></i></a></div><ul class="nav docs-sidenav collapse show" id=ida78dee89063dae8af294ba0f9e860bb2><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-ide042df731ca50ba6bb56fa8b1bc0015f")' href=#ide042df731ca50ba6bb56fa8b1bc0015f aria-expanded=false aria-controls=ide042df731ca50ba6bb56fa8b1bc0015f aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/awesome-cs-books/infrastructure/cloud/>Cloud</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#ide042df731ca50ba6bb56fa8b1bc0015f aria-expanded=false aria-controls=ide042df731ca50ba6bb56fa8b1bc0015f><i class="fa-solid fa-angle-down" id=caret-ide042df731ca50ba6bb56fa8b1bc0015f></i></a></div><ul class="nav docs-sidenav collapse show" id=ide042df731ca50ba6bb56fa8b1bc0015f><li class="child level"><a href=/books/awesome-cs-books/infrastructure/cloud/2011-%E4%BA%91%E8%AE%A1%E7%AE%97%E4%B8%8E%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F-%E4%BB%8E%E5%B9%B6%E8%A1%8C%E5%A4%84%E7%90%86%E5%88%B0%E7%89%A9%E8%81%94%E7%BD%91/>2011-《云计算与分布式系统， 从并行处理到物联网》</a></li><li class="child level"><a href=/books/awesome-cs-books/infrastructure/cloud/2011-%E4%BA%91%E8%AE%A1%E7%AE%97%E4%B8%8E%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F-%E4%BB%8E%E5%B9%B6%E8%A1%8C%E5%A4%84%E7%90%86%E5%88%B0%E7%89%A9%E8%81%94%E7%BD%91/>2011-云计算与分布式系统， 从并行处理到物联网</a></li><li class="child level"><a href=/books/awesome-cs-books/infrastructure/cloud/2019-cloud-native-data-center-networking/>2019-《Cloud Native Data Center Networking》</a></li><li class="child level active"><a href=/books/awesome-cs-books/infrastructure/cloud/2019-cloud-native-data-center-networking/>2019-Cloud Native Data Center Networking</a></li><li class="child level"><a href=/books/awesome-cs-books/infrastructure/cloud/2020-learning-dapr/>2020-《Learning Dapr》</a></li><li class="child level"><a href=/books/awesome-cs-books/infrastructure/cloud/2020-learning-dapr/>2020-Learning Dapr</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-ida739c86e056f458be9313c952195cd84")' href=#ida739c86e056f458be9313c952195cd84 aria-expanded=false aria-controls=ida739c86e056f458be9313c952195cd84 aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/awesome-cs-books/infrastructure/infosecurity/>InfoSecurity</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#ida739c86e056f458be9313c952195cd84 aria-expanded=false aria-controls=ida739c86e056f458be9313c952195cd84><i class="fa-solid fa-angle-right" id=caret-ida739c86e056f458be9313c952195cd84></i></a></div><ul class="nav docs-sidenav collapse" id=ida739c86e056f458be9313c952195cd84><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-id25db6fb3fe104a06be8c8fd315c53e50")' href=#id25db6fb3fe104a06be8c8fd315c53e50 aria-expanded=false aria-controls=id25db6fb3fe104a06be8c8fd315c53e50 aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/awesome-cs-books/infrastructure/infosecurity/webcrawler/>WebCrawler</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#id25db6fb3fe104a06be8c8fd315c53e50 aria-expanded=false aria-controls=id25db6fb3fe104a06be8c8fd315c53e50><i class="fa-solid fa-angle-right" id=caret-id25db6fb3fe104a06be8c8fd315c53e50></i></a></div><ul class="nav docs-sidenav collapse" id=id25db6fb3fe104a06be8c8fd315c53e50><li class="child level"><a href=/books/awesome-cs-books/infrastructure/infosecurity/webcrawler/design-and-implementation-of-scalable-fully-distributed-web-crawler-for-a-web-search-engine/>Design and Implementation of Scalable, Fully Distributed Web Crawler for a Web Search Engine</a></li><li class="child level"><a href=/books/awesome-cs-books/infrastructure/infosecurity/webcrawler/research-on-detection-algorithm-of-web-crawler/>Research on Detection Algorithm of Web Crawler</a></li></ul></div></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-id4791d54c5c1ad273f2bf0cc3c9249781")' href=#id4791d54c5c1ad273f2bf0cc3c9249781 aria-expanded=false aria-controls=id4791d54c5c1ad273f2bf0cc3c9249781 aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/awesome-cs-books/infrastructure/os/>OS</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#id4791d54c5c1ad273f2bf0cc3c9249781 aria-expanded=false aria-controls=id4791d54c5c1ad273f2bf0cc3c9249781><i class="fa-solid fa-angle-right" id=caret-id4791d54c5c1ad273f2bf0cc3c9249781></i></a></div><ul class="nav docs-sidenav collapse" id=id4791d54c5c1ad273f2bf0cc3c9249781><li class="child level"><a href=/books/awesome-cs-books/infrastructure/os/2007-what-every-programmer-should-know-about-memory/>2007-《What Every Programmer Should Know About Memory》</a></li><li class="child level"><a href=/books/awesome-cs-books/infrastructure/os/2007-what-every-programmer-should-know-about-memory/>2007-What Every Programmer Should Know About Memory</a></li><li class="child level"><a href=/books/awesome-cs-books/infrastructure/os/2007-%E6%B1%A4%E5%AD%90%E7%80%9B-%E8%AE%A1%E7%AE%97%E6%9C%BA%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F-3rd/>2007-汤子瀛-《计算机操作系统》-3rd</a></li><li class="child level"><a href=/books/awesome-cs-books/infrastructure/os/2007-%E6%B1%A4%E5%AD%90%E7%80%9B-%E8%AE%A1%E7%AE%97%E6%9C%BA%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F-3rd/>2007-汤子瀛-计算机操作系统-3rd</a></li><li class="child level"><a href=/books/awesome-cs-books/infrastructure/os/2011-csapp-2nd/>2011-CSAPP-2nd</a></li><li class="child level"><a href=/books/awesome-cs-books/infrastructure/os/2011-linux-shell-scripting-cookboos/>2011-Linux Shell Scripting Cookboos</a></li><li class="child level"><a href=/books/awesome-cs-books/infrastructure/os/2011-%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F/>2011-深入理解计算机系统</a></li><li class="child level"><a href=/books/awesome-cs-books/infrastructure/os/2011-%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F-2nd/>2011-深入理解计算机系统-2nd</a></li><li class="child level"><a href=/books/awesome-cs-books/infrastructure/os/2012-how-linux-works-what-every-superuser-should-know-2nd/>2012-《How Linux Works What Every Superuser Should Know》-2nd</a></li><li class="child level"><a href=/books/awesome-cs-books/infrastructure/os/2012-how-linux-works-what-every-superuser-should-know-2nd/>2012-How Linux Works What Every Superuser Should Know-2nd</a></li><li class="child level"><a href=/books/awesome-cs-books/infrastructure/os/2012-%E9%99%88%E8%8E%89%E5%90%9B-linux-%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%8E%9F%E7%90%86%E4%B8%8E%E5%BA%94%E7%94%A8-2nd/>2012-陈莉君-Linux 操作系统原理与应用-2nd</a></li><li class="child level"><a href=/books/awesome-cs-books/infrastructure/os/2014-bash-notes-for-professionals/>2014-《Bash Notes For Professionals》</a></li><li class="child level"><a href=/books/awesome-cs-books/infrastructure/os/2014-bash-notes-for-professionals/>2014-Bash Notes For Professionals</a></li><li class="child level"><a href=/books/awesome-cs-books/infrastructure/os/2018-operating-system-concepts-10th/>2018-Operating System Concepts-10th</a></li><li class="child level"><a href=/books/awesome-cs-books/infrastructure/os/2019-jon-stokes-insidethe-machine/>2019-Jon Stokes-《Insidethe Machine》</a></li><li class="child level"><a href=/books/awesome-cs-books/infrastructure/os/2019-jon-stokes-insidethe-machine/>2019-Jon Stokes-Insidethe Machine</a></li></ul></div></ul></div></nav></div><div class="d-none d-xl-block col-xl-2 docs-toc"><ul class="nav toc-top"><li><a href=# id=back_to_top class=docs-toc-title>目录</a></li></ul><nav id=TableOfContents><ul><li><a href=#应用-网络架构演进>应用-网络架构演进</a></li><li><a href=#21-世纪以来的网络设计>21 世纪以来的网络设计</a><ul><li><a href=#桥接bridging的魅力>桥接（Bridging）的魅力</a></li><li><a href=#构建和扩展的桥接网络>构建和扩展的桥接网络</a></li><li><a href=#接入-汇聚-核心网络架构存在的问题>接入-汇聚-核心网络架构存在的问题</a></li></ul></li><li><a href=#the-stories-not-told>The Stories Not Told</a></li></ul></nav><div class="subscribe-module col-24 mt-1"><img src=https://ngte-superbed.oss-cn-beijing.aliyuncs.com/item/20230220172727.png alt=image title=王下邀月熊的微信公众号></div></div><main class="py-md-3 pl-md-3 docs-content col-xl-8" role=main><article class=article><h1>2019-Cloud Native Data Center Networking</h1><div class=article-style><h1 id=cloud-native-data-center-networking>Cloud Native Data Center Networking</h1><p>作者 Dinesh G. Dutt 是一家网络公司的首席科学家，在网络行业有 20 多年工作经验，曾 是 Cisco Fellow，是 TRILL、VxLAN 等协议的合作者（co-author）之一。</p><h1 id=传统网络架构面临瓶颈>传统网络架构面临瓶颈</h1><p>分布式应用（distributed application）正在与网络（network）共舞，而且前者是主角。分布式应用突然变换了舞步，现代数据中心的故事也由此开始。理解这种转变对网络从业人员至关重要，否则只会不断被一些新名词带着走。</p><h2 id=应用-网络架构演进>应用-网络架构演进</h2><p><figure><div class="d-flex justify-content-center"><div class=w-100><img src=https://s3.ax1x.com/2021/01/25/sL9d2T.png alt="The evolution of application architecture" loading=lazy data-zoomable></div></div></figure></p><p>应用架构演进：</p><ol><li><p>单体应用</p><ul><li>通常部署在 mainframe 上。</li><li>特定的厂商提供网络方案，<strong>协议是私有的</strong>（不是 TCP/IP 协议）。</li><li>以今天的眼光看，应用所需的带宽极小。</li></ul></li><li><p>客户端-服务器应用</p><ul><li>工作站和 PC 时代。</li><li>LAN 开始兴起，充斥着各种 L2、L3 和更上层协议。<ul><li>以太网、Token Ring、FDDI 等是比较流行的互连方式。带宽上限 100Mbps。</li><li><strong>TCP/IP 体系开始发展</strong>，但还没用成为主流。</li></ul></li></ul></li><li><p>Web 应用</p><ul><li>以太网和 TCP/IP 一统互联网，其他绝大部分协议成为历史。</li><li>计算和网络虚拟化：<strong>虚拟机时代</strong>。</li></ul></li><li><p>微服务（分布式应用）</p><ul><li>大规模的数据处理（例如 MapReduce），使数据中心网络的带宽瓶颈<strong>从南北向变成东西向</strong>，这是一个历史性的转变。</li><li><strong>容器时代</strong>。</li></ul></li></ol><h2 id=21-世纪以来的网络设计>21 世纪以来的网络设计</h2><p><figure><div class="d-flex justify-content-center"><div class=w-100><img src=https://s3.ax1x.com/2021/01/25/sL9TZd.png alt="Access-aggregation-core network architecture" loading=lazy data-zoomable></div></div></figure></p><p>上图是在上世纪末开始占据统治地位的网络架构：接入-汇聚-核心三级网络架构。</p><h3 id=桥接bridging的魅力>桥接（Bridging）的魅力</h3><p>这种网络架构重度依赖交换（或称桥接，bridging），而在同时期，互联网（the internet）真正快速发展成型。既然支撑互联网的是 IP 路由（IP routing）技术，为什么数据中心网络没有选择路由（routing），而是选择的交换（bridging）呢？三方面原因：</p><ol><li><p><strong>交换芯片</strong>的出现（silicon switched packet forwarding）</p><ul><li>做数据转发的芯片原先主要用在<strong>网卡</strong>，现在用于功能更强大的<strong>交换设备</strong>。</li><li>这种设备显然要求芯片具备<strong>更高密度的接口</strong>，而这样的芯片在当时<strong>只支持交换</strong>（bridging），不支持路由（routing）。</li></ul></li><li><p><strong>厂商特定的软件栈</strong>（proprietary network software stacks）在企业中占据主导地位</p><ul><li><p>“客户端-服务器”模型所处的时代，TCP/IP 只是众多协议种的一种，并没有今天所处的统治地位。</p></li><li><p>但各家的协议有一个共同点：<strong>二层协议是一样的，都是走交换</strong>（bridging）。因 此<strong>汇聚层以下走交换</strong>就是顺理成章也是唯一的选择。</p></li><li><p>接入-汇聚-核心成为了一种通用的网络架构：</p><ul><li>汇聚以下走交换（bridging），不区分厂商</li><li>汇聚以上走各家的三层协议</li><li>这样就避免了为每家厂商的设备单独搭建一张网络。</li></ul></li></ul></li><li><p><strong>交换网络</strong>所宣称的<strong>零配置</strong>（zero configuration of bridging）</p><ul><li>路由网络很难配置，甚至对某些厂商的设备来说，直到今天仍然如此。需要很多显式 配置。</li><li>相比交换，路由的延迟更大，更消耗 CPU 资源。</li><li>交换网络是自学习的（self-learning），也是所谓的“零配置”（zero configurations）。</li></ul></li></ol><h3 id=构建和扩展的桥接网络>构建和扩展的桥接网络</h3><p>厂商设备无关、高性能芯片加上零配置，使得桥接网络在那个年代取得很大成功。但这种网 络也存在一些<strong>限制</strong>：</p><ol><li><p>广播风暴和 STP：这是自学习的机制决定的，</p><ul><li>MAC 头中没有 TTL 字段，因此一旦形成环路就无法停下来。</li><li>STP（生成树协议）：避免交换网络出现环路，非常复杂，因此很难做到没有 bug。</li></ul></li><li><p>泛洪成本</p><ul><li>大的交换网络的泛洪</li><li>缓解：划分 VLAN，使得泛洪域限制到 VLAN 内。</li></ul></li><li><p>网关高可用</p><ul><li><p><strong>网关</strong>配置在<strong>汇聚交换机</strong>。</p></li><li><p>为保证高可用，一组汇聚配置同一个网关；一台挂掉后自动切换到另一台。需要协议 支持，这种协议称为<strong>第一跳路由协议</strong>（First Hop Routing Protocol, <strong>FHRP</strong>）。</p></li><li><p><strong>FHRP 原理</strong>：几台路由器之间互相检测状态，确保永远有且只有一台在应答对网关的 ARP 请求。FHRP 协议举例：</p><ul><li>HSRP（Hot Standby Routing Protocol）：思科的私有协议。</li><li><strong>VRRP</strong>（Virtual Router Rundundency Protocol）：目前用的最多的协议。</li></ul></li></ul></li></ol><h3 id=接入-汇聚-核心网络架构存在的问题>接入-汇聚-核心网络架构存在的问题</h3><ul><li><strong>广播风暴</strong>是所有在那个年代运维过这种网络的网工们的噩梦 —— 即便已经开启了 STP。</li><li><strong>应用（applications）变了</strong> —— 服务器之间的东西向流量开始成为瓶颈，而这种网络架构主要面向的是“客 户端-服务器”模式的南北向流量时代。</li><li><strong>应用的规模</strong>显著变大，在故障、复杂性和敏捷度方面对网络提出了完全不同于以往的新需求。</li></ul><p>现有网络架构无法解决以上问题。</p><ul><li><p>不可扩展性（Unscalability）</p><ul><li>泛洪：自学习机制是 “flood-and-learn”，因此泛洪是不可避免的。当网络规模非常大时（例如大规模虚拟机场景），定期地会有上百万的泛洪包，终端计算节点不堪重负。</li><li>VLAN 限制：VLAN 总共 4096 个，无法满足云计算时代的多租户需求。</li><li>汇聚应答 ARP 的负担：汇聚负责应答 ARP。ARP 数量可能非常多，导致汇聚交换机 CPU 飙升。</li><li>交换机水平扩展性和 STP 限制：理论上，增加汇聚交换机数量似乎就能增加东西向带宽。但是，<strong>STP 不支持两个以上 的交换机</strong>场景，否则后果无法预测。因此汇聚交换机就固定在了两个，无法扩展。</li></ul></li><li><p>复杂性（Complexity）</p><ul><li>交换网络需要运行大量不同类型的协议，例如：STP、FHRP、链路检测协议；厂商特定的协议，例如 VLAN Trunking Protocol（VTP），显著增加了网络的复杂性，STP 使得网络只能用到一半的链路带宽。</li></ul></li></ul><h2 id=the-stories-not-told>The Stories Not Told</h2><p>一些对这种网络方案的改进尝试：TRILL 和 MLAG。经过时间沉淀，其他各种上层协议（L3+）已经退潮，IP 协议成为唯一主流。是时候从网络需求出发，设计一种新的架构了。</p><h1 id=links>Links</h1><ul><li><a href=http://arthurchiao.art/blog/cloud-native-data-center-networking-notes-zh/ target=_blank rel=noopener>http://arthurchiao.art/blog/cloud-native-data-center-networking-notes-zh/</a></li></ul></div><div class=article-widget><div class="container-xl row post-nav"><div class="col-6 post-nav-item"><div class=meta-nav>上一页</div><a href=/books/awesome-cs-books/infrastructure/cloud/2019-cloud-native-data-center-networking/ rel=next>2019-《Cloud Native Data Center Networking》</a></div><div class="col-6 post-nav-item"><div class=meta-nav>下一页</div><a href=/books/awesome-cs-books/infrastructure/cloud/2020-learning-dapr/ rel=prev>2020-《Learning Dapr》</a></div></div></div><div class=body-footer><p>最近更新于 2023-03-05</p><section id=comments class="mb-3 pt-0"><div id=disqus_thread></div><script>var disqus_config=function(){};(function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="https://ngte.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)})()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></section></div></article><footer class=site-footer><div class="copyright py-4 bg-footer"><div class="row justify-content-center"><div class="text-center footer-color"><p class=mb-0>© 2017-2022 NGTE all rights reserved</p></div></div></div></footer></main></div></div><script src=//unpkg.com/heti/umd/heti-addon.min.js></script>
<script>const heti=new Heti(".article");heti.autoSpacing()</script><script type=text/javascript>window.$crisp=[],window.CRISP_WEBSITE_ID="12adcc35-9621-4313-8262-62dc654b29d8",function(){setTimeout(function(){d=document,s=d.createElement("script"),s.src="https://client.crisp.chat/l.js",s.async=1,d.getElementsByTagName("head")[0].appendChild(s)},2500)}()</script></div><div class=page-footer></div><script src=/js/vendor-bundle.min.d26509351aa0ff874abbee824e982e9b.js></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.1/highlight.min.js integrity="sha512-Ypjm0o7jOxAd4hpdoppSEN0TQOC19UtPAqD+4s5AlXmUvbmmS/YMxYqAqarQYyxTnB6/rqip9qcxlNB/3U9Wdg==" crossorigin=anonymous></script>
<script id=search-hit-algolia-template type=text/html><div class=search-hit><div class=search-hit-content><div class=search-hit-name><a href={{relpermalink}}>{{#helpers.highlight}}{ "attribute": "title" }{{/helpers.highlight}}</a></div><div class="article-metadata search-hit-type">{{type}}</div><p class=search-hit-description>{{#helpers.highlight}}{ "attribute": "summary" }{{/helpers.highlight}}</p></div></div></script><script src=https://cdn.jsdelivr.net/npm/instantsearch.js@4/dist/instantsearch.production.min.js crossorigin=anonymous></script>
<script id=dsq-count-scr src=https://ngte.disqus.com/count.js async></script>
<script src=/zh/js/algolia-search-built.min.4387d694ca1258194aaf562b8cd1c400.js type=module></script>
<script id=page-data type=application/json>{"use_headroom":false}</script><script src=/zh/js/wowchemy.min.d1673c7a11d1238516cbe12a1e84257f.js></script>
<script>var mybutton=document.getElementById("backTopBtn");window.onscroll=function(){scrollFunction()};function scrollFunction(){document.body.scrollTop>20||document.documentElement.scrollTop>20?mybutton.style.display="block":mybutton.style.display="none"}function topFunction(){document.body.scrollTop=0,document.documentElement.scrollTop=0}</script><script src=https://cdn.jsdelivr.net/gh/bryanbraun/anchorjs@4.2.2/anchor.min.js integrity="sha512-I7w3ZdSFzw5j3jU3ZkNikBNeIrl3i+hEuEdwNmqUJvwNcaBUNcijnP2gd9DtGlgVYDplfjGoD8vTNsID+lCjqg==" crossorigin=anonymous></script>
<script>anchors.add()</script><script>(function(){"use strict";if(!document.queryCommandSupported("copy"))return;function e(e,t){e.className="highlight-copy-btn",e.textContent=t,setTimeout(function(){e.textContent="",e.className="highlight-copy-btn fa fa-copy"},1e3)}function t(e){var t=window.getSelection(),n=document.createRange();return n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n),t}function n(n){var o,s=document.createElement("button");s.className="highlight-copy-btn fa fa-copy",s.textContent="",o=n.firstElementChild,s.addEventListener("click",function(){try{var n=t(o);document.execCommand("copy"),n.removeAllRanges(),e(s,"已复制")}catch(t){console&&console.log(t),e(s,"Failed :'(")}}),n.appendChild(s)}var s=document.getElementsByClassName("highlight");Array.prototype.forEach.call(s,n)})()</script></body></html>