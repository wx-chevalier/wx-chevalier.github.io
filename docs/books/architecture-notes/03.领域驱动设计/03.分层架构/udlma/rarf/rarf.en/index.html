<!doctype html><html lang=zh><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=generator content="Wowchemy 5.5.0 for Hugo"><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=preload as=style href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap"><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap" media=print onload='this.media="all"'><meta name=google-site-verification content="google69a5cccb61297807"><meta name=baidu-site-verification content="cqmZHEleVh"><meta name=description content="Reactive Abstract Resource Flow Introduction Inspired By Flux and Microservice，I want to do something different in server side. I am a fresh bird for developing，but has some practice in both frontend and backend. Recently, I develop an app containing iOS, android and web client(React). I use the Spring MVC as server-side framework. It’s good, but the mvc make me sometimes annoyed. Spring MVC mapping request to single controller according to its uri, that works well but demand or the product of my app suffers frequent change. Some one think its called agile, but result in so much deprecated code ."><link rel=alternate hreflang=zh href=https://ng-tech.icu/books/architecture-notes/03.%E9%A2%86%E5%9F%9F%E9%A9%B1%E5%8A%A8%E8%AE%BE%E8%AE%A1/03.%E5%88%86%E5%B1%82%E6%9E%B6%E6%9E%84/udlma/rarf/rarf.en/><meta name=theme-color content="#0a55a7"><link rel=stylesheet href=/css/vendor-bundle.min.c7b8d9abd591ba2253ea42747e3ac3f5.css media=print onload='this.media="all"'><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.1/styles/github.min.css crossorigin=anonymous title=hl-light media=print onload='this.media="all"'><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.1/styles/dracula.min.css crossorigin=anonymous title=hl-dark media=print onload='this.media="all"' disabled><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/instantsearch.css@7.4.5/themes/satellite-min.css integrity="sha256-TehzF/2QvNKhGQrrNpoOb2Ck4iGZ1J/DI4pkd2oUsBc=" crossorigin=anonymous><link rel=stylesheet href=/css/wowchemy.fab3cd1900ae35687457073b2d518207.css><script async src="https://www.googletagmanager.com/gtag/js?id=G-40NYXJ8823"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-40NYXJ8823")</script><script>var _hmt=_hmt||[];(function(){var e,t=document.createElement("script");t.src="https://hm.baidu.com/hm.js?56df1177bce405601b0ecdd7208f75c6",e=document.getElementsByTagName("script")[0],e.parentNode.insertBefore(t,e)})()</script><link rel=manifest href=/manifest.webmanifest><link rel=icon type=image/png href=/media/icon_hu0f7d075e895d6f5f1f5fdbc1e33dc138_10087_32x32_fill_lanczos_center_3.png><link rel=apple-touch-icon type=image/png href=/media/icon_hu0f7d075e895d6f5f1f5fdbc1e33dc138_10087_180x180_fill_lanczos_center_3.png><link rel=canonical href=https://ng-tech.icu/books/architecture-notes/03.%E9%A2%86%E5%9F%9F%E9%A9%B1%E5%8A%A8%E8%AE%BE%E8%AE%A1/03.%E5%88%86%E5%B1%82%E6%9E%B6%E6%9E%84/udlma/rarf/rarf.en/><meta property="twitter:card" content="summary_large_image"><meta property="twitter:site" content="@wx-chevalier"><meta property="twitter:creator" content="@wx-chevalier"><meta property="og:site_name" content="Next-gen Tech Edu"><meta property="og:url" content="https://ng-tech.icu/books/architecture-notes/03.%E9%A2%86%E5%9F%9F%E9%A9%B1%E5%8A%A8%E8%AE%BE%E8%AE%A1/03.%E5%88%86%E5%B1%82%E6%9E%B6%E6%9E%84/udlma/rarf/rarf.en/"><meta property="og:title" content="RARF.en | Next-gen Tech Edu"><meta property="og:description" content="Reactive Abstract Resource Flow Introduction Inspired By Flux and Microservice，I want to do something different in server side. I am a fresh bird for developing，but has some practice in both frontend and backend. Recently, I develop an app containing iOS, android and web client(React). I use the Spring MVC as server-side framework. It’s good, but the mvc make me sometimes annoyed. Spring MVC mapping request to single controller according to its uri, that works well but demand or the product of my app suffers frequent change. Some one think its called agile, but result in so much deprecated code ."><meta property="og:image" content="https://ng-tech.icu/media/sharing.png"><meta property="twitter:image" content="https://ng-tech.icu/media/sharing.png"><meta property="og:locale" content="zh"><title>RARF.en | Next-gen Tech Edu</title></head><body id=top data-spy=scroll data-offset=70 data-target=#TableOfContents class=page-wrapper data-wc-page-id=095644180c983c8e6a549285d618da4f><button onclick=topFunction() id=backTopBtn title="Go to top"><i class="fa-solid fa-circle-up" aria-hidden=true></i></button>
<script src=/js/wowchemy-init.min.14a0ed61c6dbd594b9c75193b25be179.js></script><aside class=search-modal id=search><div class=container><section class=search-header><div class="row no-gutters justify-content-between mb-3"><div class="col-6 search-title"><p>搜索</p></div><div class="col-6 col-search-close"><a class=js-search href=# aria-label=关闭><i class="fas fa-times-circle text-muted" aria-hidden=true></i></a></div></div><div id=search-box></div></section><section class=section-search-results><div id=search-hits></div><div id=search-common-queries></div></section></div></aside><div class=page-header><header class=header--fixed><nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id=navbar-main><div class=container-xl><div class="d-none d-lg-inline-flex"><a class=navbar-brand href=/>Next-gen Tech Edu</a></div><button type=button class=navbar-toggler data-toggle=collapse data-target=#navbar-content aria-controls=navbar-content aria-expanded=false aria-label=切换导航>
<span><i class="fas fa-bars"></i></span></button><div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none"><a class=navbar-brand href=/>Next-gen Tech Edu</a></div><div class="navbar-collapse main-menu-item collapse justify-content-start" id=navbar-content><ul class="navbar-nav d-md-inline-flex"><li class=nav-item><a class=nav-link href=/books-gallery><span>笔记（万篇）</span></a></li><li class=nav-item><a class=nav-link href=/#knowledge-map><span>知识图谱</span></a></li><style>.dropdown-item{display:inline-flex}</style><li class="nav-item dropdown"><a href=# class="nav-link dropdown-toggle" data-toggle=dropdown aria-haspopup=true><span>实验室</span><span class=caret></span></a><div class=dropdown-menu><a class=dropdown-item href=/galaxy-home/gh-craft><span>Craft 方块世界</span></a>
<a class=dropdown-item href=/galaxy-home/glossary-cards><span>3D 知识卡牌</span></a></div></li><style>.dropdown-item{display:inline-flex}</style><li class="nav-item dropdown"><a href=# class="nav-link dropdown-toggle" data-toggle=dropdown aria-haspopup=true><span>其他阅读渠道</span><span class=caret></span></a><div class=dropdown-menu><a class=dropdown-item href=https://zhuanlan.zhihu.com/wxyyxc1992><img style=width:16px;height:16px;display:inline-block;margin-right:8px src=https://ngte-superbed.oss-cn-beijing.aliyuncs.com/item/20230218234451.png></img><span>知乎</span></a>
<a class=dropdown-item href=https://segmentfault.com/blog/wxyyxc1992><img style=width:16px;height:16px;display:inline-block;margin-right:8px src=https://ngte-superbed.oss-cn-beijing.aliyuncs.com/item/20230219113556.png></img><span>SegmentFault</span></a>
<a class=dropdown-item href=https://zhuanlan.zhihu.com/wxyyxc1992><img style=width:16px;height:16px;display:inline-block;margin-right:8px src=https://ngte-superbed.oss-cn-beijing.aliyuncs.com/item/20230219113519.png></img><span>掘金</span></a></div></li></ul></div><ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2"><li class=nav-item><a class="nav-link js-search" href=# aria-label=搜索><i class="fas fa-search" aria-hidden=true></i></a></li><li class=nav-item><a class=nav-link href=https://github.com/wx-chevalier aria-label=GitHub><i class="fa-brands fa-github" aria-hidden=true></i></a></li><div></div><style>@media only screen and (max-width:600px){.jimmysong-template{display:none!important}}</style><li class=jimmysong-template style=color:#fff;font-size:12px><a href=https://jimmysong.io style=color:#fff>By Jimmy Song's Template</a></li></ul></div></nav></header></div><div class=page-body><link rel=stylesheet href=//unpkg.com/heti/umd/heti.min.css><div class="container-xl docs"><div class="row flex-xl-nowrap"><div class=docs-sidebar><form class="docs-search d-flex align-items-center"><button class="btn docs-toggle d-md-none p-0 mr-md-3 w-100" type=button data-toggle=collapse data-target=#docs-nav aria-controls=docs-nav aria-expanded=false aria-label="Toggle section navigation"><div class=d-flex><span class="d-md-none pl-1 flex-grow-1 text-left overflow-hidden">RARF</span>
<span><i class="fas fa-chevron-down"></i></span></div></button>
<button class="form-control sidebar-search js-search d-none d-md-flex">
<i class="fas fa-search pr-2"></i>
<span class=sidebar-search-text>搜索...</span>
<span class=sidebar-search-shortcut>/</span></button></form><nav class="collapse docs-links" id=docs-nav><ul class="nav docs-sidenav"><li style=display:inline-flex><a style=cursor:pointer onclick=window.history.back()><i class="fas fa-arrow-left pr-1"></i>
Back</a>
<span>|</span>
<a href=/books/><i class="fa-solid fa-house" style=margin-right:4px></i>
Books</a></li></ul><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-id533d7b1e1e4288e54291a18f1363fbdf")' href=#id533d7b1e1e4288e54291a18f1363fbdf aria-expanded=false aria-controls=id533d7b1e1e4288e54291a18f1363fbdf aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/architecture-notes/03.%E9%A2%86%E5%9F%9F%E9%A9%B1%E5%8A%A8%E8%AE%BE%E8%AE%A1/03.%E5%88%86%E5%B1%82%E6%9E%B6%E6%9E%84/udlma/>UDLMA</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#id533d7b1e1e4288e54291a18f1363fbdf aria-expanded=false aria-controls=id533d7b1e1e4288e54291a18f1363fbdf><i class="fa-solid fa-angle-down" id=caret-id533d7b1e1e4288e54291a18f1363fbdf></i></a></div><ul class="nav docs-sidenav collapse show" id=id533d7b1e1e4288e54291a18f1363fbdf><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-ida87a4c93d583b6c3c8f524bfae93d9ce")' href=#ida87a4c93d583b6c3c8f524bfae93d9ce aria-expanded=false aria-controls=ida87a4c93d583b6c3c8f524bfae93d9ce aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/architecture-notes/03.%E9%A2%86%E5%9F%9F%E9%A9%B1%E5%8A%A8%E8%AE%BE%E8%AE%A1/03.%E5%88%86%E5%B1%82%E6%9E%B6%E6%9E%84/udlma/rarf/>RARF</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#ida87a4c93d583b6c3c8f524bfae93d9ce aria-expanded=false aria-controls=ida87a4c93d583b6c3c8f524bfae93d9ce><i class="fa-solid fa-angle-down" id=caret-ida87a4c93d583b6c3c8f524bfae93d9ce></i></a></div><ul class="nav docs-sidenav collapse show" id=ida87a4c93d583b6c3c8f524bfae93d9ce><li class="child level"><a href=/books/architecture-notes/03.%E9%A2%86%E5%9F%9F%E9%A9%B1%E5%8A%A8%E8%AE%BE%E8%AE%A1/03.%E5%88%86%E5%B1%82%E6%9E%B6%E6%9E%84/udlma/rarf/aarf/>AARF</a></li><li class="child level"><a href=/books/architecture-notes/03.%E9%A2%86%E5%9F%9F%E9%A9%B1%E5%8A%A8%E8%AE%BE%E8%AE%A1/03.%E5%88%86%E5%B1%82%E6%9E%B6%E6%9E%84/udlma/rarf/aarf.en/>AARF.en</a></li><li class="child level"><a href=/books/architecture-notes/03.%E9%A2%86%E5%9F%9F%E9%A9%B1%E5%8A%A8%E8%AE%BE%E8%AE%A1/03.%E5%88%86%E5%B1%82%E6%9E%B6%E6%9E%84/udlma/rarf/rarf/>RARF</a></li><li class="child level active"><a href=/books/architecture-notes/03.%E9%A2%86%E5%9F%9F%E9%A9%B1%E5%8A%A8%E8%AE%BE%E8%AE%A1/03.%E5%88%86%E5%B1%82%E6%9E%B6%E6%9E%84/udlma/rarf/rarf.en/>RARF.en</a></li><li class="child level"><a href=/books/architecture-notes/03.%E9%A2%86%E5%9F%9F%E9%A9%B1%E5%8A%A8%E8%AE%BE%E8%AE%A1/03.%E5%88%86%E5%B1%82%E6%9E%B6%E6%9E%84/udlma/rarf/%E7%B1%BB-redux-%E7%9A%84%E4%BB%A3%E7%A0%81%E7%BB%84%E7%BB%87/>类 Redux 的代码组织</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-id9a5d95fb9f4efd2eae8104c7b791e935")' href=#id9a5d95fb9f4efd2eae8104c7b791e935 aria-expanded=false aria-controls=id9a5d95fb9f4efd2eae8104c7b791e935 aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/architecture-notes/03.%E9%A2%86%E5%9F%9F%E9%A9%B1%E5%8A%A8%E8%AE%BE%E8%AE%A1/03.%E5%88%86%E5%B1%82%E6%9E%B6%E6%9E%84/udlma/%E6%89%A9%E5%B1%95/>扩展</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#id9a5d95fb9f4efd2eae8104c7b791e935 aria-expanded=false aria-controls=id9a5d95fb9f4efd2eae8104c7b791e935><i class="fa-solid fa-angle-right" id=caret-id9a5d95fb9f4efd2eae8104c7b791e935></i></a></div><ul class="nav docs-sidenav collapse" id=id9a5d95fb9f4efd2eae8104c7b791e935><li class="child level"><a href=/books/architecture-notes/03.%E9%A2%86%E5%9F%9F%E9%A9%B1%E5%8A%A8%E8%AE%BE%E8%AE%A1/03.%E5%88%86%E5%B1%82%E6%9E%B6%E6%9E%84/udlma/%E6%89%A9%E5%B1%95/%E5%8F%8D%E5%BA%94%E5%BC%8F/>反应式</a></li><li class="child level"><a href=/books/architecture-notes/03.%E9%A2%86%E5%9F%9F%E9%A9%B1%E5%8A%A8%E8%AE%BE%E8%AE%A1/03.%E5%88%86%E5%B1%82%E6%9E%B6%E6%9E%84/udlma/%E6%89%A9%E5%B1%95/%E6%89%A9%E5%B1%95%E7%82%B9/>扩展点</a></li></ul></div></ul></div></nav></div><div class="d-none d-xl-block col-xl-2 docs-toc"><ul class="nav toc-top"><li><a href=# id=back_to_top class=docs-toc-title>目录</a></li></ul><nav id=TableOfContents><ul><li><a href=#reactive-abstract-resource-flow>Reactive Abstract Resource Flow</a></li></ul><ul><li><a href=#attribute>Attribute</a></li><li><a href=#resource-definition>Resource Definition</a></li></ul><ul><li><a href=#resourcebag>ResourceBag</a></li><li><a href=#resourcehandler-implementation>ResourceHandler Implementation</a></li></ul></nav><div class="subscribe-module col-24 mt-1"><img src=https://ngte-superbed.oss-cn-beijing.aliyuncs.com/item/20230220172727.png alt=image title=王下邀月熊的微信公众号></div></div><main class="py-md-3 pl-md-3 docs-content col-xl-8" role=main><article class=article><h1>RARF.en</h1><div class=article-style><h2 id=reactive-abstract-resource-flow>Reactive Abstract Resource Flow</h2><h1 id=introduction>Introduction</h1><p>Inspired By Flux and Microservice，I want to do something different in server side. I am a fresh bird for developing，but has some practice in both frontend and backend. Recently, I develop an app containing iOS, android and web client(React). I use the Spring MVC as server-side framework. It’s good, but the mvc make me sometimes annoyed. Spring MVC mapping request to single controller according to its uri, that works well but demand or the product of my app suffers frequent change. Some one think its called agile, but result in so much deprecated code .</p><p>Sometime, even the front-end add one element in its view, I need to rewrite one controller to adapt to suitable RequestData. So, I want to present my Asynchronous Abstract Resource Flow idea. I don’t know wherther it is good and it;s only during the draft progress, no one except me know what it is.</p><p>I think the impression of Docker, which ships data via container between different sevice, may be a little alike. AARF don’t map request to one controller, it’s not Ordering food，but self-help.</p><p>In this post, I use AARF as abbreviation to indicate on Asynchronous Abstract Resource Flow.Main principle of AARF is split the complex business logic into micro handlers, which is mapping to single resource. Besides, for the convenience of MVVM(data binding), responded data is</p><p>In conclusion, the front-end draft the responsed data structure by define the resource flow path and required attribute. The server-side provide essential constraints of resources and relation.</p><h1 id=resource>Resource</h1><h2 id=attribute>Attribute</h2><p>**attribute is the most granular level atom in one model, and each attribute has its unique name.**For example, in a simple model of library，there are several attributes, user_name, user_age, book_name, book_author. user_name and user_age can be allocated to User Resource naturally. On the other hand, book_name and book_author are assigned to Book Resource. In addition, User Resource has one attribute called user_id, this is identify for one user resource.</p><p>In conclusion，there are two category of attributes in AARF model, one is called identify attribute, which can be used to index one resource and can be shared among different resource. Anonther is called value attribute, which only can be owned by one Resource.</p><h2 id=resource-definition>Resource Definition</h2><p>**Any resource has at least one unique value attribute besides any resource id.**For example, in the library case, Comment may have comment_id, user_id and book_id, all of them are resource_id. If comment doesn’t have comment_content, which id unique attribute only belongs to the Comment Resource, Comment can’t be regarded as resource. It just called relation ,which will be discussed below.</p><h1 id=resourcehandler>ResourceHandler</h1><h2 id=resourcebag>ResourceBag</h2><p>A ResourceBag is wrapper for all resourced involved in this request processing, it is the actual one which is shipped between resourceHandler and loaded with response data or any temporary data.</p><h2 id=resourcehandler-implementation>ResourceHandler Implementation</h2><p>A ResourceHandler is an observable(rxjava), it’s only handling logic for its resource, such as databased interacting and logic processing and data encapsulation. One demonstrated code snippet for resource handler are listed following:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Component</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>UserResourceHandler</span> <span class=kd>implements</span> <span class=n>AbstractResourceHandler</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>  <span class=nd>@Autowired</span>
</span></span><span class=line><span class=cl>  <span class=n>DispatcherController</span> <span class=n>dispatcherController</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>  <span class=kd>public</span> <span class=n>Observable</span><span class=o>&lt;</span><span class=n>ResourceBag</span><span class=o>&gt;</span> <span class=nf>handle</span><span class=o>(</span><span class=n>ResourceBag</span> <span class=n>resourceBag</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>Observable</span><span class=o>.&lt;</span><span class=n>ResourceBag</span><span class=o>&gt;</span><span class=n>create</span><span class=o>(</span>
</span></span><span class=line><span class=cl>      <span class=o>(</span>
</span></span><span class=line><span class=cl>        <span class=n>subscriber</span> <span class=o>-&gt;</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>          <span class=c1>//Before
</span></span></span><span class=line><span class=cl><span class=c1></span>          <span class=c1>//Initialize and fill this resource content by its resource_id
</span></span></span><span class=line><span class=cl><span class=c1></span>          <span class=n>String</span> <span class=n>user_id</span> <span class=o>=</span> <span class=n>Optional</span>
</span></span><span class=line><span class=cl>            <span class=o>.</span><span class=na>ofNullable</span><span class=o>(</span><span class=n>resourceBag</span><span class=o>.</span><span class=na>getUserId</span><span class=o>())</span>
</span></span><span class=line><span class=cl>            <span class=o>.</span><span class=na>orElseGet</span><span class=o>(</span>
</span></span><span class=line><span class=cl>              <span class=o>()</span> <span class=o>-&gt;</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=n>String</span><span class=o>.</span><span class=na>valueOf</span><span class=o>(</span>
</span></span><span class=line><span class=cl>                  <span class=n>resourceBag</span><span class=o>.</span><span class=na>getUriMapping</span><span class=o>().</span><span class=na>get</span><span class=o>(</span><span class=n>resourceBag</span><span class=o>.</span><span class=na>getFlowIndex</span><span class=o>())[</span><span class=mi>1</span><span class=o>]</span>
</span></span><span class=line><span class=cl>                <span class=o>);</span>
</span></span><span class=line><span class=cl>              <span class=o>}</span>
</span></span><span class=line><span class=cl>            <span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>          <span class=n>Resource</span> <span class=n>userResource</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Resource</span><span class=o>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>          <span class=n>userResource</span><span class=o>.</span><span class=na>attributes</span><span class=o>.</span><span class=na>put</span><span class=o>(</span><span class=s>&#34;user_id&#34;</span><span class=o>,</span> <span class=n>user_id</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>          <span class=c1>//            System.out.println(resourceBag.getFlowIndex() + &#34;AAAAAA&#34; + resourceBag.getUriMapping().size());
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=c1>//Insert this resource into resource bag
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=n>resourceBag</span>
</span></span><span class=line><span class=cl>            <span class=o>.</span><span class=na>getResources</span><span class=o>()</span>
</span></span><span class=line><span class=cl>            <span class=o>.</span><span class=na>add</span><span class=o>(</span><span class=n>userResource</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>          <span class=c1>//chech whether it is terminal
</span></span></span><span class=line><span class=cl><span class=c1></span>          <span class=c1>//After
</span></span></span><span class=line><span class=cl><span class=c1></span>          <span class=k>if</span> <span class=o>(</span>
</span></span><span class=line><span class=cl>            <span class=n>resourceBag</span><span class=o>.</span><span class=na>getUriMapping</span><span class=o>().</span><span class=na>size</span><span class=o>()</span> <span class=o>&gt;</span> <span class=n>resourceBag</span><span class=o>.</span><span class=na>getFlowIndex</span><span class=o>()</span> <span class=o>+</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>          <span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=n>dispatcherController</span>
</span></span><span class=line><span class=cl>              <span class=o>.</span><span class=na>forward</span><span class=o>(</span><span class=n>resourceBag</span><span class=o>)</span>
</span></span><span class=line><span class=cl>              <span class=o>.</span><span class=na>subscribe</span><span class=o>(</span>
</span></span><span class=line><span class=cl>                <span class=n>r</span> <span class=o>-&gt;</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                  <span class=n>resourceBag</span><span class=o>.</span><span class=na>decreaseFlowIndex</span><span class=o>();</span>
</span></span><span class=line><span class=cl>                  <span class=n>subscriber</span><span class=o>.</span><span class=na>onNext</span><span class=o>(</span><span class=n>r</span><span class=o>);</span>
</span></span><span class=line><span class=cl>                  <span class=n>subscriber</span><span class=o>.</span><span class=na>onCompleted</span><span class=o>();</span>
</span></span><span class=line><span class=cl>                <span class=o>}</span>
</span></span><span class=line><span class=cl>              <span class=o>);</span>
</span></span><span class=line><span class=cl>          <span class=o>}</span> <span class=k>else</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=c1>//if terminal, use onNext to backward
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=n>resourceBag</span><span class=o>.</span><span class=na>decreaseFlowIndex</span><span class=o>();</span>
</span></span><span class=line><span class=cl>            <span class=n>subscriber</span><span class=o>.</span><span class=na>onNext</span><span class=o>(</span><span class=n>resourceBag</span><span class=o>);</span>
</span></span><span class=line><span class=cl>            <span class=n>subscriber</span><span class=o>.</span><span class=na>onCompleted</span><span class=o>();</span>
</span></span><span class=line><span class=cl>          <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>      <span class=o>)</span>
</span></span><span class=line><span class=cl>    <span class=o>);</span>
</span></span><span class=line><span class=cl>  <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><h1 id=asynchronous-flow>Asynchronous Flow</h1><p>How the Resource Flow between Resource Handler</p><p><figure><div class="d-flex justify-content-center"><div class=w-100><img src=http://7xlgth.com1.z0.glb.clouddn.com/56A0BE00-E44F-4E08-AA96-3DB9CD0E561C.png alt loading=lazy data-zoomable></div></div></figure></p><p><figure><div class="d-flex justify-content-center"><div class=w-100><img src=http://7xlgth.com1.z0.glb.clouddn.com/E1C10411-FCDC-400D-81FA-3885065E1B70.png alt loading=lazy data-zoomable></div></div></figure></p><p>In my practice，if front-end want to get books commented by one user. In the restful type, it can be written as :</p><p><a href="http://api.com/user/%7buser_token%7d/comment?requestData=%7b%7d" target=_blank rel=noopener>http://api.com/user/{user_token}/comment?requestData={}</a></p><p><a href="http://api.com/book?requestData=%7bbook_ids%7d" target=_blank rel=noopener>http://api.com/book?requestData={book_ids}</a></p><p>and in AARF, it is:</p><p><a href="http://api.com/user/%7buser_token%7d/comment/all/books?requestData=%7b%7d" target=_blank rel=noopener>http://api.com/user/{user_token}/comment/all/books?requestData={}</a></p></div><div class=article-widget><div class="container-xl row post-nav"><div class="col-6 post-nav-item"><div class=meta-nav>上一页</div><a href=/books/architecture-notes/03.%E9%A2%86%E5%9F%9F%E9%A9%B1%E5%8A%A8%E8%AE%BE%E8%AE%A1/03.%E5%88%86%E5%B1%82%E6%9E%B6%E6%9E%84/udlma/rarf/rarf/ rel=next>RARF</a></div><div class="col-6 post-nav-item"><div class=meta-nav>下一页</div><a href=/books/architecture-notes/03.%E9%A2%86%E5%9F%9F%E9%A9%B1%E5%8A%A8%E8%AE%BE%E8%AE%A1/03.%E5%88%86%E5%B1%82%E6%9E%B6%E6%9E%84/udlma/rarf/%E7%B1%BB-redux-%E7%9A%84%E4%BB%A3%E7%A0%81%E7%BB%84%E7%BB%87/ rel=prev>类 Redux 的代码组织</a></div></div></div><div class=body-footer><p>最近更新于 0001-01-01</p><section id=comments class="mb-3 pt-0"><div id=disqus_thread></div><script>var disqus_config=function(){};(function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="https://ngte.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)})()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></section></div></article><footer class=site-footer><div class="copyright py-4 bg-footer"><div class="row justify-content-center"><div class="text-center footer-color"><p class=mb-0>© 2017-2022 NGTE all rights reserved</p></div></div></div><script type=text/javascript id=clstr_globe async src="//clustrmaps.com/globe.js?d=kgpJG5sWZQpKujBmD-uW1B54-WBPol-DuDtrB2KFjKs"></script></footer></main></div></div><script src=//unpkg.com/heti/umd/heti-addon.min.js></script>
<script>const heti=new Heti(".article");heti.autoSpacing()</script><script type=text/javascript>window.$crisp=[],window.CRISP_WEBSITE_ID="12adcc35-9621-4313-8262-62dc654b29d8",function(){setTimeout(function(){d=document,s=d.createElement("script"),s.src="https://client.crisp.chat/l.js",s.async=1,d.getElementsByTagName("head")[0].appendChild(s)},2500)}()</script></div><div class=page-footer></div><script src=/js/vendor-bundle.min.d26509351aa0ff874abbee824e982e9b.js></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.1/highlight.min.js integrity="sha512-Ypjm0o7jOxAd4hpdoppSEN0TQOC19UtPAqD+4s5AlXmUvbmmS/YMxYqAqarQYyxTnB6/rqip9qcxlNB/3U9Wdg==" crossorigin=anonymous></script>
<script id=search-hit-algolia-template type=text/html><div class=search-hit><div class=search-hit-content><div class=search-hit-name><a href={{relpermalink}}>{{#helpers.highlight}}{ "attribute": "title" }{{/helpers.highlight}}</a></div><div class="article-metadata search-hit-type">{{type}}</div><p class=search-hit-description>{{#helpers.highlight}}{ "attribute": "summary" }{{/helpers.highlight}}</p></div></div></script><script src=https://cdn.jsdelivr.net/npm/instantsearch.js@4/dist/instantsearch.production.min.js crossorigin=anonymous></script>
<script id=dsq-count-scr src=https://ngte.disqus.com/count.js async></script>
<script src=/zh/js/algolia-search-built.min.4387d694ca1258194aaf562b8cd1c400.js type=module></script>
<script id=page-data type=application/json>{"use_headroom":false}</script><script src=/zh/js/wowchemy.min.d1673c7a11d1238516cbe12a1e84257f.js></script>
<script>var mybutton=document.getElementById("backTopBtn");window.onscroll=function(){scrollFunction()};function scrollFunction(){document.body.scrollTop>20||document.documentElement.scrollTop>20?mybutton.style.display="block":mybutton.style.display="none"}function topFunction(){document.body.scrollTop=0,document.documentElement.scrollTop=0}</script><script src=https://cdn.jsdelivr.net/gh/bryanbraun/anchorjs@4.2.2/anchor.min.js integrity="sha512-I7w3ZdSFzw5j3jU3ZkNikBNeIrl3i+hEuEdwNmqUJvwNcaBUNcijnP2gd9DtGlgVYDplfjGoD8vTNsID+lCjqg==" crossorigin=anonymous></script>
<script>anchors.add()</script><script>(function(){"use strict";if(!document.queryCommandSupported("copy"))return;function e(e,t){e.className="highlight-copy-btn",e.textContent=t,setTimeout(function(){e.textContent="",e.className="highlight-copy-btn fa fa-copy"},1e3)}function t(e){var t=window.getSelection(),n=document.createRange();return n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n),t}function n(n){var o,s=document.createElement("button");s.className="highlight-copy-btn fa fa-copy",s.textContent="",o=n.firstElementChild,s.addEventListener("click",function(){try{var n=t(o);document.execCommand("copy"),n.removeAllRanges(),e(s,"已复制")}catch(t){console&&console.log(t),e(s,"Failed :'(")}}),n.appendChild(s)}var s=document.getElementsByClassName("highlight");Array.prototype.forEach.call(s,n)})()</script></body></html>