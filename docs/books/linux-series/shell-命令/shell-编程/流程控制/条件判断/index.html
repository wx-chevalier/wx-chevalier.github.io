<!doctype html><html lang=zh><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=generator content="Wowchemy 5.5.0 for Hugo"><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=preload as=style href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap"><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap" media=print onload='this.media="all"'><meta name=google-site-verification content="google69a5cccb61297807"><meta name=baidu-site-verification content="cqmZHEleVh"><meta name=description content="条件比较 test test 命令用于检查文件类型并比较值。测试用于条件执行中。它用于： 文件属性比较 执行字符串比较。 基本算术比较。 $ test condition $ test condition && true-command $ test condition || false-command $ test condition && true-command || false-command 很多时候我们可以不用 test 关键字而是直接使用 [ ] 来包"><link rel=alternate hreflang=zh href=https://ng-tech.icu/books/linux-series/shell-%E5%91%BD%E4%BB%A4/shell-%E7%BC%96%E7%A8%8B/%E6%B5%81%E7%A8%8B%E6%8E%A7%E5%88%B6/%E6%9D%A1%E4%BB%B6%E5%88%A4%E6%96%AD/><meta name=theme-color content="#0a55a7"><link rel=stylesheet href=/css/vendor-bundle.min.c7b8d9abd591ba2253ea42747e3ac3f5.css media=print onload='this.media="all"'><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.1/styles/github.min.css crossorigin=anonymous title=hl-light media=print onload='this.media="all"'><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.1/styles/dracula.min.css crossorigin=anonymous title=hl-dark media=print onload='this.media="all"' disabled><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/instantsearch.css@7.4.5/themes/satellite-min.css integrity="sha256-TehzF/2QvNKhGQrrNpoOb2Ck4iGZ1J/DI4pkd2oUsBc=" crossorigin=anonymous><link rel=stylesheet href=/css/wowchemy.63df6ae9fc2b4cc71b83f1774d780209.css><script async src="https://www.googletagmanager.com/gtag/js?id=G-40NYXJ8823"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-40NYXJ8823")</script><script>var _hmt=_hmt||[];(function(){var e,t=document.createElement("script");t.src="https://hm.baidu.com/hm.js?56df1177bce405601b0ecdd7208f75c6",e=document.getElementsByTagName("script")[0],e.parentNode.insertBefore(t,e)})()</script><link rel=manifest href=/manifest.webmanifest><link rel=icon type=image/png href=/media/icon_hu0f7d075e895d6f5f1f5fdbc1e33dc138_10087_32x32_fill_lanczos_center_3.png><link rel=apple-touch-icon type=image/png href=/media/icon_hu0f7d075e895d6f5f1f5fdbc1e33dc138_10087_180x180_fill_lanczos_center_3.png><link rel=canonical href=https://ng-tech.icu/books/linux-series/shell-%E5%91%BD%E4%BB%A4/shell-%E7%BC%96%E7%A8%8B/%E6%B5%81%E7%A8%8B%E6%8E%A7%E5%88%B6/%E6%9D%A1%E4%BB%B6%E5%88%A4%E6%96%AD/><meta property="twitter:card" content="summary_large_image"><meta property="twitter:site" content="@wx-chevalier"><meta property="twitter:creator" content="@wx-chevalier"><meta property="og:site_name" content="Next-gen Tech Edu"><meta property="og:url" content="https://ng-tech.icu/books/linux-series/shell-%E5%91%BD%E4%BB%A4/shell-%E7%BC%96%E7%A8%8B/%E6%B5%81%E7%A8%8B%E6%8E%A7%E5%88%B6/%E6%9D%A1%E4%BB%B6%E5%88%A4%E6%96%AD/"><meta property="og:title" content="条件判断 | Next-gen Tech Edu"><meta property="og:description" content="条件比较 test test 命令用于检查文件类型并比较值。测试用于条件执行中。它用于： 文件属性比较 执行字符串比较。 基本算术比较。 $ test condition $ test condition && true-command $ test condition || false-command $ test condition && true-command || false-command 很多时候我们可以不用 test 关键字而是直接使用 [ ] 来包"><meta property="og:image" content="https://ng-tech.icu/media/sharing.png"><meta property="twitter:image" content="https://ng-tech.icu/media/sharing.png"><meta property="og:locale" content="zh"><title>条件判断 | Next-gen Tech Edu</title></head><body id=top data-spy=scroll data-offset=70 data-target=#TableOfContents class=page-wrapper data-wc-page-id=29ab4e3d2504ec4da8aab03f36fb69f5><button onclick=topFunction() id=backTopBtn title="Go to top"><i class="fa-solid fa-circle-up" aria-hidden=true></i></button>
<script src=/js/wowchemy-init.min.14a0ed61c6dbd594b9c75193b25be179.js></script><aside class=search-modal id=search><div class=container><section class=search-header><div class="row no-gutters justify-content-between mb-3"><div class="col-6 search-title"><p>搜索</p></div><div class="col-6 col-search-close"><a class=js-search href=# aria-label=关闭><i class="fas fa-times-circle text-muted" aria-hidden=true></i></a></div></div><div id=search-box></div></section><section class=section-search-results><div id=search-hits></div><div id=search-common-queries></div></section></div></aside><div class=page-header><header class=header--fixed><nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id=navbar-main><div class=container-xl><div class="d-none d-lg-inline-flex"><a class=navbar-brand href=/>Next-gen Tech Edu</a></div><button type=button class=navbar-toggler data-toggle=collapse data-target=#navbar-content aria-controls=navbar-content aria-expanded=false aria-label=切换导航>
<span><i class="fas fa-bars"></i></span></button><div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none"><a class=navbar-brand href=/>Next-gen Tech Edu</a></div><div class="navbar-collapse main-menu-item collapse justify-content-start" id=navbar-content><ul class="navbar-nav d-md-inline-flex"><li class=nav-item><a class=nav-link href=/books-gallery><span>笔记（万篇）</span></a></li><li class=nav-item><a class=nav-link href=/#knowledge-map><span>知识图谱</span></a></li><style>.dropdown-item{display:inline-flex}</style><li class="nav-item dropdown"><a href=# class="nav-link dropdown-toggle" data-toggle=dropdown aria-haspopup=true><span>实验室</span><span class=caret></span></a><div class=dropdown-menu><a class=dropdown-item href=/galaxy-home/gh-craft><span>Craft 方块世界</span></a>
<a class=dropdown-item href=/galaxy-home/glossary-cards><span>3D 知识卡牌</span></a></div></li><style>.dropdown-item{display:inline-flex}</style><li class="nav-item dropdown"><a href=# class="nav-link dropdown-toggle" data-toggle=dropdown aria-haspopup=true><span>其他阅读渠道</span><span class=caret></span></a><div class=dropdown-menu><a class=dropdown-item href=https://zhuanlan.zhihu.com/wxyyxc1992><img style=width:16px;height:16px;display:inline-block;margin-right:8px src=https://ngte-superbed.oss-cn-beijing.aliyuncs.com/item/20230218234451.png></img><span>知乎</span></a>
<a class=dropdown-item href=https://segmentfault.com/blog/wxyyxc1992><img style=width:16px;height:16px;display:inline-block;margin-right:8px src=https://ngte-superbed.oss-cn-beijing.aliyuncs.com/item/20230219113556.png></img><span>SegmentFault</span></a>
<a class=dropdown-item href=https://zhuanlan.zhihu.com/wxyyxc1992><img style=width:16px;height:16px;display:inline-block;margin-right:8px src=https://ngte-superbed.oss-cn-beijing.aliyuncs.com/item/20230219113519.png></img><span>掘金</span></a></div></li></ul></div><ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2"><li class=nav-item><a class="nav-link js-search" href=# aria-label=搜索><i class="fas fa-search" aria-hidden=true></i></a></li><li class=nav-item><a class=nav-link href=https://github.com/wx-chevalier aria-label=GitHub><i class="fa-brands fa-github" aria-hidden=true></i></a></li><div></div><style>@media only screen and (max-width:600px){.jimmysong-template{display:none!important}}</style><li class=jimmysong-template style=color:#fff;font-size:12px><a href=https://jimmysong.io style=color:#fff>By Jimmy Song's Template</a></li></ul></div></nav></header></div><div class=page-body><link rel=stylesheet href=//unpkg.com/heti/umd/heti.min.css><div class="container-xl docs"><div class="row flex-xl-nowrap"><div class=docs-sidebar><form class="docs-search d-flex align-items-center"><button class="btn docs-toggle d-md-none p-0 mr-md-3 w-100" type=button data-toggle=collapse data-target=#docs-nav aria-controls=docs-nav aria-expanded=false aria-label="Toggle section navigation"><div class=d-flex><span class="d-md-none pl-1 flex-grow-1 text-left overflow-hidden">流程控制</span>
<span><i class="fas fa-chevron-down"></i></span></div></button>
<button class="form-control sidebar-search js-search d-none d-md-flex">
<i class="fas fa-search pr-2"></i>
<span class=sidebar-search-text>搜索...</span>
<span class=sidebar-search-shortcut>/</span></button></form><nav class="collapse docs-links" id=docs-nav><ul class="nav docs-sidenav"><li style=display:inline-flex><a style=cursor:pointer onclick=window.history.back()><i class="fas fa-arrow-left pr-1"></i>
Back</a>
<span>|</span>
<a href=/books/><i class="fa-solid fa-house" style=margin-right:4px></i>
Books</a></li></ul><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-idbfd3b634792467c9be9e30750ca6e43e")' href=#idbfd3b634792467c9be9e30750ca6e43e aria-expanded=false aria-controls=idbfd3b634792467c9be9e30750ca6e43e aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/linux-series/shell-%E5%91%BD%E4%BB%A4/shell-%E7%BC%96%E7%A8%8B/>Shell 编程</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#idbfd3b634792467c9be9e30750ca6e43e aria-expanded=false aria-controls=idbfd3b634792467c9be9e30750ca6e43e><i class="fa-solid fa-angle-down" id=caret-idbfd3b634792467c9be9e30750ca6e43e></i></a></div><ul class="nav docs-sidenav collapse show" id=idbfd3b634792467c9be9e30750ca6e43e><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-idd89245fffbc51db5d4edb87484ef50fc")' href=#idd89245fffbc51db5d4edb87484ef50fc aria-expanded=false aria-controls=idd89245fffbc51db5d4edb87484ef50fc aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/linux-series/shell-%E5%91%BD%E4%BB%A4/shell-%E7%BC%96%E7%A8%8B/%E5%87%BD%E6%95%B0/>函数</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#idd89245fffbc51db5d4edb87484ef50fc aria-expanded=false aria-controls=idd89245fffbc51db5d4edb87484ef50fc><i class="fa-solid fa-angle-right" id=caret-idd89245fffbc51db5d4edb87484ef50fc></i></a></div><ul class="nav docs-sidenav collapse" id=idd89245fffbc51db5d4edb87484ef50fc><li class="child level"><a href=/books/linux-series/shell-%E5%91%BD%E4%BB%A4/shell-%E7%BC%96%E7%A8%8B/%E5%87%BD%E6%95%B0/%E5%87%BD%E6%95%B0%E8%B0%83%E7%94%A8/>函数调用</a></li><li class="child level"><a href=/books/linux-series/shell-%E5%91%BD%E4%BB%A4/shell-%E7%BC%96%E7%A8%8B/%E5%87%BD%E6%95%B0/%E5%87%BD%E6%95%B0%E5%AE%9A%E4%B9%89/>函数定义</a></li><li class="child level"><a href=/books/linux-series/shell-%E5%91%BD%E4%BB%A4/shell-%E7%BC%96%E7%A8%8B/%E5%87%BD%E6%95%B0/%E5%B1%80%E9%83%A8%E5%8F%98%E9%87%8F%E4%B8%8E%E8%BF%94%E5%9B%9E/>局部变量与返回</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-id09bc3c61ae7058b10098a562f70d22ec")' href=#id09bc3c61ae7058b10098a562f70d22ec aria-expanded=false aria-controls=id09bc3c61ae7058b10098a562f70d22ec aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/linux-series/shell-%E5%91%BD%E4%BB%A4/shell-%E7%BC%96%E7%A8%8B/%E4%BA%A4%E4%BA%92%E5%BC%8F-shell/>交互式 Shell</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#id09bc3c61ae7058b10098a562f70d22ec aria-expanded=false aria-controls=id09bc3c61ae7058b10098a562f70d22ec><i class="fa-solid fa-angle-right" id=caret-id09bc3c61ae7058b10098a562f70d22ec></i></a></div><ul class="nav docs-sidenav collapse" id=id09bc3c61ae7058b10098a562f70d22ec><li class="child level"><a href=/books/linux-series/shell-%E5%91%BD%E4%BB%A4/shell-%E7%BC%96%E7%A8%8B/%E4%BA%A4%E4%BA%92%E5%BC%8F-shell/funny-terminals/>Funny Terminals</a></li><li class="child level"><a href=/books/linux-series/shell-%E5%91%BD%E4%BB%A4/shell-%E7%BC%96%E7%A8%8B/%E4%BA%A4%E4%BA%92%E5%BC%8F-shell/%E8%8F%9C%E5%8D%95%E4%B8%8E%E5%AF%B9%E8%AF%9D%E6%A1%86/>菜单与对话框</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-id9e4b73045e53a98984d4165d6280d977")' href=#id9e4b73045e53a98984d4165d6280d977 aria-expanded=false aria-controls=id9e4b73045e53a98984d4165d6280d977 aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/linux-series/shell-%E5%91%BD%E4%BB%A4/shell-%E7%BC%96%E7%A8%8B/%E6%B5%81%E7%A8%8B%E6%8E%A7%E5%88%B6/>流程控制</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#id9e4b73045e53a98984d4165d6280d977 aria-expanded=false aria-controls=id9e4b73045e53a98984d4165d6280d977><i class="fa-solid fa-angle-down" id=caret-id9e4b73045e53a98984d4165d6280d977></i></a></div><ul class="nav docs-sidenav collapse show" id=id9e4b73045e53a98984d4165d6280d977><li class="child level active"><a href=/books/linux-series/shell-%E5%91%BD%E4%BB%A4/shell-%E7%BC%96%E7%A8%8B/%E6%B5%81%E7%A8%8B%E6%8E%A7%E5%88%B6/%E6%9D%A1%E4%BB%B6%E5%88%A4%E6%96%AD/>条件判断</a></li><li class="child level"><a href=/books/linux-series/shell-%E5%91%BD%E4%BB%A4/shell-%E7%BC%96%E7%A8%8B/%E6%B5%81%E7%A8%8B%E6%8E%A7%E5%88%B6/%E6%9D%A1%E4%BB%B6%E9%80%89%E6%8B%A9/>条件选择</a></li><li class="child level"><a href=/books/linux-series/shell-%E5%91%BD%E4%BB%A4/shell-%E7%BC%96%E7%A8%8B/%E6%B5%81%E7%A8%8B%E6%8E%A7%E5%88%B6/%E5%BE%AA%E7%8E%AF/>循环</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-idecbc8fd9516fd7253f3ba8a707ea51f9")' href=#idecbc8fd9516fd7253f3ba8a707ea51f9 aria-expanded=false aria-controls=idecbc8fd9516fd7253f3ba8a707ea51f9 aria-hidden=false data-toggle=collapse></div></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-id863eaea1b1a5869f959089f6803f4502")' href=#id863eaea1b1a5869f959089f6803f4502 aria-expanded=false aria-controls=id863eaea1b1a5869f959089f6803f4502 aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/linux-series/shell-%E5%91%BD%E4%BB%A4/shell-%E7%BC%96%E7%A8%8B/%E8%AF%AD%E6%B3%95%E5%9F%BA%E7%A1%80/>语法基础</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#id863eaea1b1a5869f959089f6803f4502 aria-expanded=false aria-controls=id863eaea1b1a5869f959089f6803f4502><i class="fa-solid fa-angle-right" id=caret-id863eaea1b1a5869f959089f6803f4502></i></a></div><ul class="nav docs-sidenav collapse" id=id863eaea1b1a5869f959089f6803f4502><li class="child level"><a href=/books/linux-series/shell-%E5%91%BD%E4%BB%A4/shell-%E7%BC%96%E7%A8%8B/%E8%AF%AD%E6%B3%95%E5%9F%BA%E7%A1%80/%E5%8F%98%E9%87%8F/>变量</a></li><li class="child level"><a href=/books/linux-series/shell-%E5%91%BD%E4%BB%A4/shell-%E7%BC%96%E7%A8%8B/%E8%AF%AD%E6%B3%95%E5%9F%BA%E7%A1%80/%E8%A1%A8%E8%BE%BE%E5%BC%8F/>表达式</a></li><li class="child level"><a href=/books/linux-series/shell-%E5%91%BD%E4%BB%A4/shell-%E7%BC%96%E7%A8%8B/%E8%AF%AD%E6%B3%95%E5%9F%BA%E7%A1%80/%E6%95%B0%E5%80%BC%E7%B1%BB%E5%9E%8B/>数值类型</a></li><li class="child level"><a href=/books/linux-series/shell-%E5%91%BD%E4%BB%A4/shell-%E7%BC%96%E7%A8%8B/%E8%AF%AD%E6%B3%95%E5%9F%BA%E7%A1%80/%E5%AD%97%E7%AC%A6%E4%B8%B2/>字符串</a></li></ul></div></ul></div></nav></div><div class="d-none d-xl-block col-xl-2 docs-toc"><ul class="nav toc-top"><li><a href=# id=back_to_top class=docs-toc-title>目录</a></li></ul><nav id=TableOfContents><ul><li><a href=#test>test</a></li><li><a href=#字符串判断>字符串判断</a></li><li><a href=#数值判断>数值判断</a></li><li><a href=#逻辑判断>逻辑判断</a></li><li><a href=#文件目录判断>文件/目录判断</a></li></ul><ul><li><a href=#字符串判断-1>字符串判断</a></li><li><a href=#文件判断>文件判断</a></li><li><a href=#系统判断>系统判断</a></li></ul></nav><div class="subscribe-module col-24 mt-1"><img src=https://ngte-superbed.oss-cn-beijing.aliyuncs.com/item/20230220172727.png alt=image title=王下邀月熊的微信公众号></div></div><main class="py-md-3 pl-md-3 docs-content col-xl-8" role=main><article class=article><h1>条件判断</h1><div class=article-style><h1 id=条件比较>条件比较</h1><h2 id=test>test</h2><p>test 命令用于检查文件类型并比较值。测试用于条件执行中。它用于：</p><ul><li>文件属性比较</li><li>执行字符串比较。</li><li>基本算术比较。</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>$ <span class=nb>test</span> condition
</span></span><span class=line><span class=cl>$ <span class=nb>test</span> condition <span class=o>&amp;&amp;</span> true-command
</span></span><span class=line><span class=cl>$ <span class=nb>test</span> condition <span class=o>||</span> false-command
</span></span><span class=line><span class=cl>$ <span class=nb>test</span> condition <span class=o>&amp;&amp;</span> true-command <span class=o>||</span> false-command
</span></span></code></pre></div><p>很多时候我们可以不用 test 关键字而是直接使用 <code>[ ]</code> 来包含条件语句，在 Shell 提示符下键入以下命令（5 是否大于 2？）：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl><span class=nb>test</span> <span class=m>5</span> -eq <span class=m>5</span> <span class=o>&amp;&amp;</span> <span class=nb>echo</span> Yes <span class=o>||</span> <span class=nb>echo</span> No
</span></span><span class=line><span class=cl><span class=nb>test</span> <span class=m>5</span> -eq <span class=m>15</span> <span class=o>&amp;&amp;</span> <span class=nb>echo</span> Yes <span class=o>||</span> <span class=nb>echo</span> No
</span></span><span class=line><span class=cl><span class=nb>test</span> <span class=m>5</span> -ne <span class=m>10</span> <span class=o>&amp;&amp;</span> <span class=nb>echo</span> Yes <span class=o>||</span> <span class=nb>echo</span> No
</span></span><span class=line><span class=cl><span class=nb>test</span> -f /etc/resolv.conf <span class=o>&amp;&amp;</span> <span class=nb>echo</span> <span class=s2>&#34;File /etc/resolv.conf found.&#34;</span> <span class=o>||</span> <span class=nb>echo</span> <span class=s2>&#34;File /etc/resolv.conf not found.&#34;</span>
</span></span><span class=line><span class=cl><span class=nb>test</span> -f /etc/resolv1.conf <span class=o>&amp;&amp;</span> <span class=nb>echo</span> <span class=s2>&#34;File /etc/resolv1.conf found.&#34;</span> <span class=o>||</span> <span class=nb>echo</span> <span class=s2>&#34;File /etc/resolv1.conf not found.&#34;</span>
</span></span></code></pre></div><p>一个简单的 shell 脚本来查找用户名（finduser.sh）</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl><span class=c1># set var</span>
</span></span><span class=line><span class=cl><span class=nv>PASSWD_FILE</span><span class=o>=</span>/etc/passwd
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># get user name</span>
</span></span><span class=line><span class=cl><span class=nb>read</span> -p <span class=s2>&#34;Enter a user name : &#34;</span> username
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># try to locate username in in /etc/passwd</span>
</span></span><span class=line><span class=cl>grep <span class=s2>&#34;^</span><span class=nv>$username</span><span class=s2>&#34;</span> <span class=nv>$PASSWD_FILE</span> &gt; /dev/null
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># store exit status of grep</span>
</span></span><span class=line><span class=cl><span class=c1># if found grep will return 0 exit stauts</span>
</span></span><span class=line><span class=cl><span class=c1># if not found, grep will return a nonzero exit stauts</span>
</span></span><span class=line><span class=cl><span class=nv>status</span><span class=o>=</span><span class=nv>$?</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=nb>test</span> <span class=nv>$status</span> -eq <span class=m>0</span>
</span></span><span class=line><span class=cl><span class=k>then</span>
</span></span><span class=line><span class=cl>	<span class=nb>echo</span> <span class=s2>&#34;User &#39;</span><span class=nv>$username</span><span class=s2>&#39; found in </span><span class=nv>$PASSWD_FILE</span><span class=s2> file.&#34;</span>
</span></span><span class=line><span class=cl><span class=k>else</span>
</span></span><span class=line><span class=cl>	<span class=nb>echo</span> <span class=s2>&#34;User &#39;</span><span class=nv>$username</span><span class=s2>&#39; not found in </span><span class=nv>$PASSWD_FILE</span><span class=s2> file.&#34;</span>
</span></span><span class=line><span class=cl><span class=k>fi</span>
</span></span></code></pre></div><h2 id=字符串判断>字符串判断</h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl><span class=o>[</span> -z STRING <span class=o>]</span> 如果STRING的长度为零则返回为真，即空是真
</span></span><span class=line><span class=cl><span class=o>[</span> -n STRING <span class=o>]</span> 如果STRING的长度非零则返回为真，即非空是真
</span></span><span class=line><span class=cl><span class=o>[</span> STRING1 <span class=o>]</span>　 如果字符串不为空则返回为真,与-n类似
</span></span><span class=line><span class=cl><span class=o>[</span> <span class=nv>STRING1</span> <span class=o>==</span> STRING2 <span class=o>]</span> 如果两个字符串相同则返回为真
</span></span><span class=line><span class=cl><span class=o>[</span> STRING1 !<span class=o>=</span> STRING2 <span class=o>]</span> 如果字符串不相同则返回为真
</span></span><span class=line><span class=cl><span class=o>[</span> STRING1 &lt; STRING2 <span class=o>]</span> 如果 “STRING1”字典排序在“STRING2”前面则返回为真。
</span></span><span class=line><span class=cl><span class=o>[</span> STRING1 &gt; STRING2 <span class=o>]</span> 如果 “STRING1”字典排序在“STRING2”后面则返回为真。
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 正则表达式</span>
</span></span><span class=line><span class=cl><span class=nv>doiido</span><span class=o>=</span><span class=s2>&#34;hero&#34;</span>
</span></span><span class=line><span class=cl><span class=k>if</span>  <span class=o>[[</span> <span class=s2>&#34;</span><span class=nv>$doiido</span><span class=s2>&#34;</span> <span class=o>==</span> h* <span class=o>]]</span><span class=p>;</span><span class=k>then</span>
</span></span><span class=line><span class=cl>    <span class=nb>echo</span> <span class=s2>&#34;hello，hero&#34;</span>
</span></span><span class=line><span class=cl><span class=k>fi</span>
</span></span></code></pre></div><h2 id=数值判断>数值判断</h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl><span class=o>[</span> INT1 -eq INT2 <span class=o>]</span> INT1和INT2两数相等返回为真 ,<span class=o>=</span>
</span></span><span class=line><span class=cl><span class=o>[</span> INT1 -ne INT2 <span class=o>]</span> INT1和INT2两数不等返回为真 ,&lt;&gt;
</span></span><span class=line><span class=cl><span class=o>[</span> INT1 -gt INT2 <span class=o>]</span> INT1大于INT2返回为真 ,&gt;
</span></span><span class=line><span class=cl><span class=o>[</span> INT1 -ge INT2 <span class=o>]</span> INT1大于等于INT2返回为真,&gt;<span class=o>=</span>
</span></span><span class=line><span class=cl><span class=o>[</span> INT1 -lt INT2 <span class=o>]</span> INT1小于INT2返回为真 ,&lt;
</span></span><span class=line><span class=cl><span class=o>[</span> INT1 -le INT2 <span class=o>]</span> INT1小于等于INT2返回为真,&lt;<span class=o>=</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># a&gt;b且a&lt;c</span>
</span></span><span class=line><span class=cl><span class=o>((</span> a &gt; b <span class=o>))</span> <span class=o>&amp;&amp;</span> <span class=o>((</span> a &lt; c <span class=o>))</span>
</span></span><span class=line><span class=cl><span class=o>[[</span> <span class=nv>$a</span> &gt; <span class=nv>$b</span> <span class=o>]]</span> <span class=o>&amp;&amp;</span> <span class=o>[[</span> <span class=nv>$a</span> &lt; <span class=nv>$c</span> <span class=o>]]</span>
</span></span><span class=line><span class=cl><span class=o>[</span> <span class=nv>$a</span> -gt <span class=nv>$b</span> -a <span class=nv>$a</span> -lt <span class=nv>$c</span> <span class=o>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># a&gt;b或a&lt;c</span>
</span></span><span class=line><span class=cl><span class=o>((</span> a &gt; b <span class=o>))</span> <span class=o>||</span> <span class=o>((</span> a &lt; c <span class=o>))</span>
</span></span><span class=line><span class=cl><span class=o>[[</span> <span class=nv>$a</span> &gt; <span class=nv>$b</span> <span class=o>]]</span> <span class=o>||</span> <span class=o>[[</span> <span class=nv>$a</span> &lt; <span class=nv>$c</span> <span class=o>]]</span>
</span></span><span class=line><span class=cl><span class=o>[</span> <span class=nv>$a</span> -gt <span class=nv>$b</span> -o <span class=nv>$a</span> -lt <span class=nv>$c</span> <span class=o>]</span>
</span></span></code></pre></div><h2 id=逻辑判断>逻辑判断</h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl><span class=o>[</span> ! EXPR <span class=o>]</span> 逻辑非，如果 EXPR 是false则返回为真。
</span></span><span class=line><span class=cl><span class=o>[</span> EXPR1 -a EXPR2 <span class=o>]</span> 逻辑与，如果 EXPR1 and EXPR2 全真则返回为真。
</span></span><span class=line><span class=cl><span class=o>[</span> EXPR1 -o EXPR2 <span class=o>]</span> 逻辑或，如果 EXPR1 或者 EXPR2 为真则返回为真。
</span></span><span class=line><span class=cl><span class=o>[</span> <span class=o>]</span> <span class=o>||</span> <span class=o>[</span> <span class=o>]</span> 用OR来合并两个条件
</span></span><span class=line><span class=cl><span class=o>[</span> <span class=o>]</span> <span class=o>&amp;&amp;</span> <span class=o>[</span> <span class=o>]</span> 用AND来合并两个条件
</span></span><span class=line><span class=cl><span class=o>[</span> -t FD <span class=o>]</span> 如果文件描述符 FD（默认值为1）打开且指向一个终端则返回为真
</span></span><span class=line><span class=cl><span class=o>[</span> -o optionname <span class=o>]</span> 如果shell选项optionname开启则返回为真
</span></span></code></pre></div><h2 id=文件目录判断>文件/目录判断</h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl><span class=c1># 常用的：</span>
</span></span><span class=line><span class=cl><span class=o>[</span> -a FILE <span class=o>]</span> 如果 FILE 存在则为真。
</span></span><span class=line><span class=cl><span class=o>[</span> -d FILE <span class=o>]</span> 如果 FILE 存在且是一个目录则返回为真。
</span></span><span class=line><span class=cl><span class=o>[</span> -e FILE <span class=o>]</span> 如果 指定的文件或目录存在时返回为真。
</span></span><span class=line><span class=cl><span class=o>[</span> -f FILE <span class=o>]</span> 如果 FILE 存在且是一个普通文件则返回为真。
</span></span><span class=line><span class=cl><span class=o>[</span> -r FILE <span class=o>]</span> 如果 FILE 存在且是可读的则返回为真。
</span></span><span class=line><span class=cl><span class=o>[</span> -w FILE <span class=o>]</span> 如果 FILE 存在且是可写的则返回为真。（一个目录为了它的内容被访问必然是可执行的）
</span></span><span class=line><span class=cl><span class=o>[</span> -x FILE <span class=o>]</span> 如果 FILE 存在且是可执行的则返回为真。
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 不常用的：</span>
</span></span><span class=line><span class=cl><span class=o>[</span> -b FILE <span class=o>]</span> 如果 FILE 存在且是一个块文件则返回为真。
</span></span><span class=line><span class=cl><span class=o>[</span> -c FILE <span class=o>]</span> 如果 FILE 存在且是一个字符文件则返回为真。
</span></span><span class=line><span class=cl><span class=o>[</span> -g FILE <span class=o>]</span> 如果 FILE 存在且设置了SGID则返回为真。
</span></span><span class=line><span class=cl><span class=o>[</span> -h FILE <span class=o>]</span> 如果 FILE 存在且是一个符号符号链接文件则返回为真。（该选项在一些老系统上无效）
</span></span><span class=line><span class=cl><span class=o>[</span> -k FILE <span class=o>]</span> 如果 FILE 存在且已经设置了冒险位则返回为真。
</span></span><span class=line><span class=cl><span class=o>[</span> -p FILE <span class=o>]</span> 如果 FILE 存并且是命令管道时返回为真。
</span></span><span class=line><span class=cl><span class=o>[</span> -s FILE <span class=o>]</span> 如果 FILE 存在且大小非0时为真则返回为真。
</span></span><span class=line><span class=cl><span class=o>[</span> -u FILE <span class=o>]</span> 如果 FILE 存在且设置了SUID位时返回为真。
</span></span><span class=line><span class=cl><span class=o>[</span> -O FILE <span class=o>]</span> 如果 FILE 存在且属有效用户ID则返回为真。
</span></span><span class=line><span class=cl><span class=o>[</span> -G FILE <span class=o>]</span> 如果 FILE 存在且默认组为当前组则返回为真。（只检查系统默认组）
</span></span><span class=line><span class=cl><span class=o>[</span> -L FILE <span class=o>]</span> 如果 FILE 存在且是一个符号连接则返回为真。
</span></span><span class=line><span class=cl><span class=o>[</span> -N FILE <span class=o>]</span> 如果 FILE 存在 and has been mod如果ied since it was last read则返回为真。
</span></span><span class=line><span class=cl><span class=o>[</span> -S FILE <span class=o>]</span> 如果 FILE 存在且是一个套接字则返回为真。
</span></span><span class=line><span class=cl><span class=o>[</span> FILE1 -nt FILE2 <span class=o>]</span> 如果 FILE1 比 FILE2 新, 或者 FILE1 存在但是 FILE2 不存在则返回为真。
</span></span><span class=line><span class=cl><span class=o>[</span> FILE1 -ot FILE2 <span class=o>]</span> 如果 FILE1 比 FILE2 老, 或者 FILE2 存在但是 FILE1 不存在则返回为真。
</span></span><span class=line><span class=cl><span class=o>[</span> FILE1 -ef FILE2 <span class=o>]</span> 如果 FILE1 和 FILE2 指向相同的设备和节点号则返回为真。
</span></span></code></pre></div><h1 id=if-条件判断>if 条件判断</h1><p>Bash Shell 会按顺序执行 if 语句，如果 command 执行后且它的返回状态是 0，则会执行符合该条件执行的语句，否则后面的命令不执行，跳到下一条命令。当有多个嵌套时，只有第一个返回 0 退出状态的命令会导致符合该条件执行的语句部分被执行,如果所有的语句的执行状态都不为 0，则执行 else 中语句。返回状态是最后一个命令的退出状态，或者当没有条件是真的话为 0。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl><span class=k>if</span> <span class=nb>command</span>
</span></span><span class=line><span class=cl><span class=k>then</span>
</span></span><span class=line><span class=cl>    <span class=nb>command</span> executed successfully
</span></span><span class=line><span class=cl>    execute all commands up to <span class=k>else</span> statement
</span></span><span class=line><span class=cl>    or to <span class=k>fi</span> <span class=k>if</span> there is no <span class=k>else</span> statement
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>else</span>
</span></span><span class=line><span class=cl>    <span class=nb>command</span> failed so
</span></span><span class=line><span class=cl>    execute all commands up to <span class=k>fi</span>
</span></span><span class=line><span class=cl><span class=k>fi</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 使用 test 进行判断</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=nb>test</span> var -eq val
</span></span><span class=line><span class=cl><span class=k>then</span>
</span></span><span class=line><span class=cl>    <span class=nb>command</span> executed successfully
</span></span><span class=line><span class=cl>    execute all commands up to <span class=k>else</span> statement
</span></span><span class=line><span class=cl>    or to <span class=k>fi</span> <span class=k>if</span> there is no <span class=k>else</span> statement
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>else</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nb>command</span> failed <span class=k>then</span>
</span></span><span class=line><span class=cl>    execute all commands up to <span class=k>fi</span>
</span></span><span class=line><span class=cl><span class=k>fi</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=nb>test</span> <span class=nv>var</span> <span class=o>==</span> value
</span></span><span class=line><span class=cl><span class=k>then</span>
</span></span><span class=line><span class=cl>     command1
</span></span><span class=line><span class=cl>     command2
</span></span><span class=line><span class=cl>     ...
</span></span><span class=line><span class=cl>     commandN
</span></span><span class=line><span class=cl><span class=k>fi</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 基本语法</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=o>[</span> <span class=nb>command</span> <span class=o>]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>     符合该条件执行的语句
</span></span><span class=line><span class=cl><span class=k>fi</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 扩展语法</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=o>[</span> <span class=nb>command</span> <span class=o>]</span><span class=p>;</span><span class=k>then</span>
</span></span><span class=line><span class=cl>     符合该条件执行的语句
</span></span><span class=line><span class=cl><span class=k>elif</span> <span class=o>[</span> <span class=nb>command</span> <span class=o>]</span><span class=p>;</span><span class=k>then</span>
</span></span><span class=line><span class=cl>     符合该条件执行的语句
</span></span><span class=line><span class=cl><span class=k>else</span>
</span></span><span class=line><span class=cl>     符合该条件执行的语句
</span></span><span class=line><span class=cl><span class=k>fi</span>
</span></span></code></pre></div><p>注意，<code>[ ]</code> 表示条件测试。注意这里的空格很重要。要注意在 <code>[</code> 后面和 <code>]</code> 前面都必须要有空格。在 Shell 中，then 和 fi 是分开的语句。如果要在同一行里面输入，则需要用分号将他们隔开。我们也可以多层嵌套条件判断：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl><span class=k>if</span> condition
</span></span><span class=line><span class=cl><span class=k>then</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> condition
</span></span><span class=line><span class=cl>    <span class=k>then</span>
</span></span><span class=line><span class=cl>        .....
</span></span><span class=line><span class=cl>        ..
</span></span><span class=line><span class=cl>        <span class=k>do</span> this
</span></span><span class=line><span class=cl>    <span class=k>else</span>
</span></span><span class=line><span class=cl>        ....
</span></span><span class=line><span class=cl>        ..
</span></span><span class=line><span class=cl>        <span class=k>do</span> this
</span></span><span class=line><span class=cl>    <span class=k>fi</span>
</span></span><span class=line><span class=cl><span class=k>else</span>
</span></span><span class=line><span class=cl>    ...
</span></span><span class=line><span class=cl>    .....
</span></span><span class=line><span class=cl>    <span class=k>do</span> this
</span></span><span class=line><span class=cl><span class=k>fi</span>
</span></span></code></pre></div><h2 id=字符串判断-1>字符串判断</h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl><span class=c1># 两个变量判断是否相等</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=o>[</span> <span class=s2>&#34;</span><span class=nv>$var1</span><span class=s2>&#34;</span> <span class=o>=</span> <span class=s2>&#34;</span><span class=nv>$var2</span><span class=s2>&#34;</span> <span class=o>]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>　　echo <span class=s1>&#39;$var1 eq $var2&#39;</span>
</span></span><span class=line><span class=cl><span class=k>else</span>
</span></span><span class=line><span class=cl>　　echo <span class=s1>&#39;$var1 not eq $var2&#39;</span>
</span></span><span class=line><span class=cl><span class=k>fi</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 是判断变量$doiido是否有值</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=o>[</span> ! -n <span class=s2>&#34;</span><span class=nv>$doiido</span><span class=s2>&#34;</span> <span class=o>]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>　　echo <span class=s2>&#34;</span><span class=nv>$doiido</span><span class=s2> is empty&#34;</span>
</span></span><span class=line><span class=cl>　　exit <span class=m>0</span>
</span></span><span class=line><span class=cl><span class=k>fi</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 数值的比较</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=o>[</span> <span class=s2>&#34;</span><span class=nv>$num</span><span class=s2>&#34;</span> -gt <span class=s2>&#34;150&#34;</span> <span class=o>]</span><span class=p>;</span><span class=k>then</span>
</span></span><span class=line><span class=cl>   <span class=nb>echo</span> <span class=s2>&#34;</span><span class=nv>$num</span><span class=s2> is biger than 150&#34;</span>
</span></span><span class=line><span class=cl><span class=k>fi</span>
</span></span></code></pre></div><h2 id=文件判断>文件判断</h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl><span class=c1># 判断目录 $doiido 是否存在，若不存在，则新建一个</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=o>[</span> ! -d <span class=s2>&#34;</span><span class=nv>$doiido</span><span class=s2>&#34;</span><span class=o>]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>　　mkdir <span class=s2>&#34;</span><span class=nv>$doiido</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=k>fi</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 判断普通文件 $doiido 是否存，若不存在，则新建一个</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=o>[</span> ! -f <span class=s2>&#34;</span><span class=nv>$doiido</span><span class=s2>&#34;</span> <span class=o>]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>　　touch <span class=s2>&#34;</span><span class=nv>$doiido</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=k>fi</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 判断 $doiido 是否存在并且是否具有可执行权限</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=o>[</span> ! -x <span class=s2>&#34;</span><span class=nv>$doiido</span><span class=s2>&#34;</span><span class=o>]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>　　mkdir <span class=s2>&#34;</span><span class=nv>$doiido</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>chmod +x <span class=s2>&#34;</span><span class=nv>$doiido</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=k>fi</span>
</span></span></code></pre></div><p>这是使用逻辑 not 的示例脚本 ! 快速制作备份目录：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl><span class=cp>#!/bin/bash
</span></span></span><span class=line><span class=cl><span class=cp></span><span class=c1># A sample shell script to backup MySQL database</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Get todays date</span>
</span></span><span class=line><span class=cl><span class=nv>NOW</span><span class=o>=</span><span class=k>$(</span>date +<span class=s2>&#34;%d-%m-%Y&#34;</span><span class=k>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Location to store mysql backup</span>
</span></span><span class=line><span class=cl><span class=nv>BAK</span><span class=o>=</span><span class=s2>&#34;/nas10/.mysql-database&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># MySQL Server Login Information</span>
</span></span><span class=line><span class=cl><span class=nv>MUSER</span><span class=o>=</span><span class=s2>&#34;root&#34;</span>			<span class=c1>#### mysql user name ###</span>
</span></span><span class=line><span class=cl><span class=nv>MPASS</span><span class=o>=</span><span class=s2>&#34;YOUR-PASSWORD-HERE&#34;</span>	<span class=c1>#### mysql password  ###</span>
</span></span><span class=line><span class=cl><span class=nv>MHOST</span><span class=o>=</span><span class=s2>&#34;127.0.0.1&#34;</span>		<span class=c1>#### mysql host name ###</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Full path to common utilities</span>
</span></span><span class=line><span class=cl><span class=nv>MYSQL</span><span class=o>=</span><span class=s2>&#34;/usr/bin/mysql&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>MYSQLDUMP</span><span class=o>=</span><span class=s2>&#34;/usr/bin/mysqldump&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>GZIP</span><span class=o>=</span><span class=s2>&#34;/bin/gzip&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># If backup directory does not exits create it using logical not</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=o>[</span> ! -d <span class=s2>&#34;</span><span class=nv>$BAK</span><span class=s2>&#34;</span> <span class=o>]</span>
</span></span><span class=line><span class=cl><span class=k>then</span>
</span></span><span class=line><span class=cl>  mkdir -p <span class=s2>&#34;</span><span class=nv>$BAK</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=k>fi</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Get all mysql databases names</span>
</span></span><span class=line><span class=cl><span class=nv>DBS</span><span class=o>=</span><span class=s2>&#34;</span><span class=k>$(</span><span class=nv>$MYSQL</span> -u <span class=nv>$MUSER</span> -h <span class=nv>$MHOST</span> -p<span class=nv>$MPASS</span> -Bse <span class=s1>&#39;show databases&#39;</span><span class=k>)</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Start backup</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> -n <span class=s2>&#34;Dumping...&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Use the for loop</span>
</span></span><span class=line><span class=cl><span class=k>for</span> db in <span class=nv>$DBS</span>
</span></span><span class=line><span class=cl><span class=k>do</span>
</span></span><span class=line><span class=cl> <span class=nv>FILE</span><span class=o>=</span><span class=s2>&#34;</span><span class=nv>$BAK</span><span class=s2>/mysql-</span><span class=nv>$db</span><span class=s2>.</span><span class=nv>$NOW</span><span class=s2>-</span><span class=k>$(</span>date +<span class=s2>&#34;%T&#34;</span><span class=k>)</span><span class=s2>.gz&#34;</span>
</span></span><span class=line><span class=cl>  <span class=nv>$MYSQLDUMP</span> -u <span class=nv>$MUSER</span> -h <span class=nv>$MHOST</span> -p<span class=nv>$MPASS</span> <span class=nv>$db</span> <span class=p>|</span> <span class=nv>$GZIP</span> -9 &gt; <span class=nv>$FILE</span>
</span></span><span class=line><span class=cl> <span class=nb>echo</span> -n <span class=s2>&#34;.&#34;</span>
</span></span><span class=line><span class=cl><span class=k>done</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> -n  <span class=s2>&#34;...Done&#34;</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;&#34;</span>
</span></span></code></pre></div><h2 id=系统判断>系统判断</h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl><span class=c1># 测试退出状态</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=o>[</span> <span class=nv>$?</span> -eq <span class=m>0</span> <span class=o>]</span><span class=p>;</span><span class=k>then</span>
</span></span><span class=line><span class=cl>    <span class=nb>echo</span> <span class=s1>&#39;That is ok&#39;</span>
</span></span><span class=line><span class=cl><span class=k>fi</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 检测执行脚本的用户</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=o>[</span> <span class=s2>&#34;</span><span class=k>$(</span>whoami<span class=k>)</span><span class=s2>&#34;</span> !<span class=o>=</span> <span class=s1>&#39;root&#39;</span> <span class=o>]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>   <span class=nb>echo</span>  <span class=s2>&#34;You  have no permission to run </span><span class=nv>$0</span><span class=s2> as non-root user.&#34;</span>
</span></span><span class=line><span class=cl>   <span class=nb>exit</span>  1<span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>fi</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 查看当前操作系统类型</span>
</span></span><span class=line><span class=cl><span class=nv>SYSTEM</span><span class=o>=</span><span class=sb>`</span>uname  -s<span class=sb>`</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=o>[</span> <span class=nv>$SYSTEM</span> <span class=o>=</span> <span class=s2>&#34;Linux&#34;</span> <span class=o>]</span> <span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>   <span class=nb>echo</span> <span class=s2>&#34;Linux&#34;</span>
</span></span><span class=line><span class=cl><span class=k>elif</span>
</span></span><span class=line><span class=cl>    <span class=o>[</span> <span class=nv>$SYSTEM</span> <span class=o>=</span> <span class=s2>&#34;FreeBSD&#34;</span> <span class=o>]</span> <span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>   <span class=nb>echo</span> <span class=s2>&#34;FreeBSD&#34;</span>
</span></span><span class=line><span class=cl><span class=k>elif</span>
</span></span><span class=line><span class=cl>    <span class=o>[</span> <span class=nv>$SYSTEM</span> <span class=o>=</span> <span class=s2>&#34;Solaris&#34;</span> <span class=o>]</span> <span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>    <span class=nb>echo</span> <span class=s2>&#34;Solaris&#34;</span>
</span></span><span class=line><span class=cl><span class=k>else</span>
</span></span><span class=line><span class=cl>    <span class=nb>echo</span>  <span class=s2>&#34;What?&#34;</span>
</span></span><span class=line><span class=cl><span class=k>fi</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 判断 read 传入的参数</span>
</span></span><span class=line><span class=cl><span class=nb>read</span> -p <span class=s2>&#34;please  input a score:&#34;</span>  score
</span></span><span class=line><span class=cl><span class=nb>echo</span>  -e <span class=s2>&#34;your  score [</span><span class=nv>$score</span><span class=s2>] is judging by sys now&#34;</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=o>[</span> <span class=s2>&#34;</span><span class=nv>$score</span><span class=s2>&#34;</span> -ge <span class=s2>&#34;0&#34;</span> <span class=o>]&amp;&amp;[</span> <span class=s2>&#34;</span><span class=nv>$score</span><span class=s2>&#34;</span> -lt <span class=s2>&#34;60&#34;</span> <span class=o>]</span><span class=p>;</span><span class=k>then</span>
</span></span><span class=line><span class=cl>    <span class=nb>echo</span>  <span class=s2>&#34;sorry,you  are lost!&#34;</span>
</span></span><span class=line><span class=cl><span class=k>elif</span> <span class=o>[</span> <span class=s2>&#34;</span><span class=nv>$score</span><span class=s2>&#34;</span> -ge <span class=s2>&#34;60&#34;</span> <span class=o>]&amp;&amp;[</span> <span class=s2>&#34;</span><span class=nv>$score</span><span class=s2>&#34;</span> -lt <span class=s2>&#34;85&#34;</span> <span class=o>]</span><span class=p>;</span><span class=k>then</span>
</span></span><span class=line><span class=cl>    <span class=nb>echo</span> <span class=s2>&#34;just  soso!&#34;</span>
</span></span><span class=line><span class=cl><span class=k>elif</span> <span class=o>[</span> <span class=s2>&#34;</span><span class=nv>$score</span><span class=s2>&#34;</span> -le <span class=s2>&#34;100&#34;</span> <span class=o>]&amp;&amp;[</span> <span class=s2>&#34;</span><span class=nv>$score</span><span class=s2>&#34;</span> -ge <span class=s2>&#34;85&#34;</span> <span class=o>]</span><span class=p>;</span><span class=k>then</span>
</span></span><span class=line><span class=cl>     <span class=nb>echo</span> <span class=s2>&#34;good  job!&#34;</span>
</span></span><span class=line><span class=cl><span class=k>else</span>
</span></span><span class=line><span class=cl>     <span class=nb>echo</span> <span class=s2>&#34;input  score is wrong, the range is [0-100]!&#34;</span>
</span></span><span class=line><span class=cl><span class=k>fi</span>
</span></span></code></pre></div><p>以下脚本（chk_hardware.sh）在运行 64 位 Linux 内核的 x86-64 计算机上使用 mcelog 命令。它将找出硬件错误（例如 RAM 或 CPU），并向服务器管理员发送电子邮件。这对于在实际服务器崩溃之前预测服务器硬件故障很有用：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl><span class=cp>#!/bin/bash
</span></span></span><span class=line><span class=cl><span class=cp></span><span class=c1># Purpose: Detecting Hardware Errors</span>
</span></span><span class=line><span class=cl><span class=c1># Author: Vivek Gite &lt;vivek@nixcraft.com&gt;</span>
</span></span><span class=line><span class=cl><span class=c1># Note : The script must run as a cron-job.</span>
</span></span><span class=line><span class=cl><span class=c1># Last updated on : 28-Aug-2007</span>
</span></span><span class=line><span class=cl><span class=c1># -----------------------------------------------</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Store path to commands</span>
</span></span><span class=line><span class=cl><span class=nv>LOGGER</span><span class=o>=</span>/usr/bin/logger
</span></span><span class=line><span class=cl><span class=nv>FILE</span><span class=o>=</span>/var/log/mcelog
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Store email settings</span>
</span></span><span class=line><span class=cl><span class=nv>AEMAIL</span><span class=o>=</span><span class=s2>&#34;vivek@nixcraft.net.in&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>ASUB</span><span class=o>=</span><span class=s2>&#34;H/W Error - </span><span class=k>$(</span>hostname<span class=k>)</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>AMESS</span><span class=o>=</span><span class=s2>&#34;Warning - Hardware errors found on </span><span class=k>$(</span>hostname<span class=k>)</span><span class=s2> @ </span><span class=k>$(</span>date<span class=k>)</span><span class=s2>. See log file for the details /var/log/mcelog.&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>OK_MESS</span><span class=o>=</span><span class=s2>&#34;OK: NO Hardware Error Found.&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>WARN_MESS</span><span class=o>=</span><span class=s2>&#34;ERROR: Hardware Error Found.&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Check if $FILE exists or not</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=nb>test</span> ! -f <span class=s2>&#34;</span><span class=nv>$FILE</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=k>then</span>
</span></span><span class=line><span class=cl>	<span class=nb>echo</span> <span class=s2>&#34;Error - </span><span class=nv>$FILE</span><span class=s2> not found or mcelog is not configured for 64 bit Linux systems.&#34;</span>
</span></span><span class=line><span class=cl>	<span class=nb>exit</span> <span class=m>1</span>
</span></span><span class=line><span class=cl><span class=k>fi</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># okay search for errors in file</span>
</span></span><span class=line><span class=cl><span class=nv>error_log</span><span class=o>=</span><span class=k>$(</span>grep -c -i <span class=s2>&#34;hardware error&#34;</span> <span class=nv>$FILE</span><span class=k>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># error found or not?</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=o>[</span> <span class=nv>$error_log</span> -gt <span class=m>0</span> <span class=o>]</span>
</span></span><span class=line><span class=cl><span class=k>then</span>    <span class=c1># yes error(s) found, let send an email</span>
</span></span><span class=line><span class=cl>	<span class=nb>echo</span> <span class=s2>&#34;</span><span class=nv>$AMESS</span><span class=s2>&#34;</span> <span class=p>|</span> email -s <span class=s2>&#34;</span><span class=nv>$ASUB</span><span class=s2>&#34;</span> <span class=nv>$AEMAIL</span>
</span></span><span class=line><span class=cl><span class=k>else</span>    <span class=c1># naa, everything looks okay</span>
</span></span><span class=line><span class=cl>	<span class=nb>echo</span> <span class=s2>&#34;</span><span class=nv>$OK_MESS</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=k>fi</span>
</span></span></code></pre></div></div><div class=article-widget><div class="container-xl row post-nav"><div class="col-6 post-nav-item"><div class=meta-nav>下一页</div><a href=/books/linux-series/shell-%E5%91%BD%E4%BB%A4/shell-%E7%BC%96%E7%A8%8B/%E6%B5%81%E7%A8%8B%E6%8E%A7%E5%88%B6/%E6%9D%A1%E4%BB%B6%E9%80%89%E6%8B%A9/ rel=prev>条件选择</a></div></div></div><div class=body-footer><p>最近更新于 0001-01-01</p><section id=comments class="mb-3 pt-0"><div id=disqus_thread></div><script>var disqus_config=function(){};(function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="https://ngte.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)})()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></section></div></article><footer class=site-footer><div class="copyright py-4 bg-footer"><div class="row justify-content-center"><div class="text-center footer-color"><p class=mb-0>© 2017-2022 NGTE all rights reserved</p></div></div></div></footer></main></div></div><script src=//unpkg.com/heti/umd/heti-addon.min.js></script>
<script>const heti=new Heti(".article");heti.autoSpacing()</script><script type=text/javascript>window.$crisp=[],window.CRISP_WEBSITE_ID="12adcc35-9621-4313-8262-62dc654b29d8",function(){setTimeout(function(){d=document,s=d.createElement("script"),s.src="https://client.crisp.chat/l.js",s.async=1,d.getElementsByTagName("head")[0].appendChild(s)},2500)}()</script></div><div class=page-footer></div><script src=/js/vendor-bundle.min.d26509351aa0ff874abbee824e982e9b.js></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.1/highlight.min.js integrity="sha512-Ypjm0o7jOxAd4hpdoppSEN0TQOC19UtPAqD+4s5AlXmUvbmmS/YMxYqAqarQYyxTnB6/rqip9qcxlNB/3U9Wdg==" crossorigin=anonymous></script>
<script id=search-hit-algolia-template type=text/html><div class=search-hit><div class=search-hit-content><div class=search-hit-name><a href={{relpermalink}}>{{#helpers.highlight}}{ "attribute": "title" }{{/helpers.highlight}}</a></div><div class="article-metadata search-hit-type">{{type}}</div><p class=search-hit-description>{{#helpers.highlight}}{ "attribute": "summary" }{{/helpers.highlight}}</p></div></div></script><script src=https://cdn.jsdelivr.net/npm/instantsearch.js@4/dist/instantsearch.production.min.js crossorigin=anonymous></script>
<script id=dsq-count-scr src=https://ngte.disqus.com/count.js async></script>
<script src=/zh/js/algolia-search-built.min.4387d694ca1258194aaf562b8cd1c400.js type=module></script>
<script id=page-data type=application/json>{"use_headroom":false}</script><script src=/zh/js/wowchemy.min.d1673c7a11d1238516cbe12a1e84257f.js></script>
<script>var mybutton=document.getElementById("backTopBtn");window.onscroll=function(){scrollFunction()};function scrollFunction(){document.body.scrollTop>20||document.documentElement.scrollTop>20?mybutton.style.display="block":mybutton.style.display="none"}function topFunction(){document.body.scrollTop=0,document.documentElement.scrollTop=0}</script><script src=https://cdn.jsdelivr.net/gh/bryanbraun/anchorjs@4.2.2/anchor.min.js integrity="sha512-I7w3ZdSFzw5j3jU3ZkNikBNeIrl3i+hEuEdwNmqUJvwNcaBUNcijnP2gd9DtGlgVYDplfjGoD8vTNsID+lCjqg==" crossorigin=anonymous></script>
<script>anchors.add()</script><script>(function(){"use strict";if(!document.queryCommandSupported("copy"))return;function e(e,t){e.className="highlight-copy-btn",e.textContent=t,setTimeout(function(){e.textContent="",e.className="highlight-copy-btn fa fa-copy"},1e3)}function t(e){var t=window.getSelection(),n=document.createRange();return n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n),t}function n(n){var o,s=document.createElement("button");s.className="highlight-copy-btn fa fa-copy",s.textContent="",o=n.firstElementChild,s.addEventListener("click",function(){try{var n=t(o);document.execCommand("copy"),n.removeAllRanges(),e(s,"已复制")}catch(t){console&&console.log(t),e(s,"Failed :'(")}}),n.appendChild(s)}var s=document.getElementsByClassName("highlight");Array.prototype.forEach.call(s,n)})()</script></body></html>