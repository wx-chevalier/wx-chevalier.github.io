<!doctype html><html lang=zh><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=generator content="Wowchemy 5.5.0 for Hugo"><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=preload as=style href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap"><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap" media=print onload='this.media="all"'><meta name=google-site-verification content="google69a5cccb61297807"><meta name=baidu-site-verification content="cqmZHEleVh"><meta name=description content="HTTP Headers const express = require(&#34;express&#34;); const PORT = process.env.PORT || 3000; const app = express(); app.get(&#34;/&#34;, (req, res) => { res.send(`<h1>Hello World</h1>`); }); app.listen(PORT, () => { console.log(`Listening on http://localhost:${PORT}`); }); ... const helmet = require('helmet'); ... app.use(helmet()); ... const express = require(&#34;express&#34;); const PORT = process.env.PORT || 3000; const app = express(); app.get(&#34;/&#34;, (req, res) => { res.send(`<h1>Hello World</h1>`); }); app.listen(PORT, () => { console.log(`Listening on http://localhost:${PORT}`); }); We’ll start by adding and removing a few HTTP headers that will help improve our security. To inspect these headers you can use a tool like"><link rel=alternate hreflang=zh href=https://ng-tech.icu/books/node-notes/02.%E5%B7%A5%E7%A8%8B%E5%AE%9E%E8%B7%B5/%E7%94%9F%E4%BA%A7%E8%B0%83%E4%BC%98/%E5%AE%89%E5%85%A8%E5%8A%A0%E5%9B%BA/><meta name=theme-color content="#0a55a7"><link rel=stylesheet href=/css/vendor-bundle.min.c7b8d9abd591ba2253ea42747e3ac3f5.css media=print onload='this.media="all"'><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.1/styles/github.min.css crossorigin=anonymous title=hl-light media=print onload='this.media="all"'><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.1/styles/dracula.min.css crossorigin=anonymous title=hl-dark media=print onload='this.media="all"' disabled><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/instantsearch.css@7.4.5/themes/satellite-min.css integrity="sha256-TehzF/2QvNKhGQrrNpoOb2Ck4iGZ1J/DI4pkd2oUsBc=" crossorigin=anonymous><link rel=stylesheet href=/css/wowchemy.fab3cd1900ae35687457073b2d518207.css><script async src="https://www.googletagmanager.com/gtag/js?id=G-40NYXJ8823"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-40NYXJ8823")</script><script>var _hmt=_hmt||[];(function(){var e,t=document.createElement("script");t.src="https://hm.baidu.com/hm.js?56df1177bce405601b0ecdd7208f75c6",e=document.getElementsByTagName("script")[0],e.parentNode.insertBefore(t,e)})()</script><link rel=manifest href=/manifest.webmanifest><link rel=icon type=image/png href=/media/icon_hu0f7d075e895d6f5f1f5fdbc1e33dc138_10087_32x32_fill_lanczos_center_3.png><link rel=apple-touch-icon type=image/png href=/media/icon_hu0f7d075e895d6f5f1f5fdbc1e33dc138_10087_180x180_fill_lanczos_center_3.png><link rel=canonical href=https://ng-tech.icu/books/node-notes/02.%E5%B7%A5%E7%A8%8B%E5%AE%9E%E8%B7%B5/%E7%94%9F%E4%BA%A7%E8%B0%83%E4%BC%98/%E5%AE%89%E5%85%A8%E5%8A%A0%E5%9B%BA/><meta property="twitter:card" content="summary_large_image"><meta property="twitter:site" content="@wx-chevalier"><meta property="twitter:creator" content="@wx-chevalier"><meta property="og:site_name" content="Next-gen Tech Edu"><meta property="og:url" content="https://ng-tech.icu/books/node-notes/02.%E5%B7%A5%E7%A8%8B%E5%AE%9E%E8%B7%B5/%E7%94%9F%E4%BA%A7%E8%B0%83%E4%BC%98/%E5%AE%89%E5%85%A8%E5%8A%A0%E5%9B%BA/"><meta property="og:title" content="安全加固 | Next-gen Tech Edu"><meta property="og:description" content="HTTP Headers const express = require(&#34;express&#34;); const PORT = process.env.PORT || 3000; const app = express(); app.get(&#34;/&#34;, (req, res) => { res.send(`<h1>Hello World</h1>`); }); app.listen(PORT, () => { console.log(`Listening on http://localhost:${PORT}`); }); ... const helmet = require('helmet'); ... app.use(helmet()); ... const express = require(&#34;express&#34;); const PORT = process.env.PORT || 3000; const app = express(); app.get(&#34;/&#34;, (req, res) => { res.send(`<h1>Hello World</h1>`); }); app.listen(PORT, () => { console.log(`Listening on http://localhost:${PORT}`); }); We’ll start by adding and removing a few HTTP headers that will help improve our security. To inspect these headers you can use a tool like"><meta property="og:image" content="https://ng-tech.icu/media/sharing.png"><meta property="twitter:image" content="https://ng-tech.icu/media/sharing.png"><meta property="og:locale" content="zh"><title>安全加固 | Next-gen Tech Edu</title></head><body id=top data-spy=scroll data-offset=70 data-target=#TableOfContents class=page-wrapper data-wc-page-id=d6d43e4c6f356388949d7b51b1e3781b><button onclick=topFunction() id=backTopBtn title="Go to top"><i class="fa-solid fa-circle-up" aria-hidden=true></i></button>
<script src=/js/wowchemy-init.min.14a0ed61c6dbd594b9c75193b25be179.js></script><aside class=search-modal id=search><div class=container><section class=search-header><div class="row no-gutters justify-content-between mb-3"><div class="col-6 search-title"><p>搜索</p></div><div class="col-6 col-search-close"><a class=js-search href=# aria-label=关闭><i class="fas fa-times-circle text-muted" aria-hidden=true></i></a></div></div><div id=search-box></div></section><section class=section-search-results><div id=search-hits></div><div id=search-common-queries></div></section></div></aside><div class=page-header><header class=header--fixed><nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id=navbar-main><div class=container-xl><div class="d-none d-lg-inline-flex"><a class=navbar-brand href=/>Next-gen Tech Edu</a></div><button type=button class=navbar-toggler data-toggle=collapse data-target=#navbar-content aria-controls=navbar-content aria-expanded=false aria-label=切换导航>
<span><i class="fas fa-bars"></i></span></button><div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none"><a class=navbar-brand href=/>Next-gen Tech Edu</a></div><div class="navbar-collapse main-menu-item collapse justify-content-start" id=navbar-content><ul class="navbar-nav d-md-inline-flex"><li class=nav-item><a class=nav-link href=/books-gallery><span>笔记（万篇）</span></a></li><li class=nav-item><a class=nav-link href=/#knowledge-map><span>知识图谱</span></a></li><style>.dropdown-item{display:inline-flex}</style><li class="nav-item dropdown"><a href=# class="nav-link dropdown-toggle" data-toggle=dropdown aria-haspopup=true><span>实验室</span><span class=caret></span></a><div class=dropdown-menu><a class=dropdown-item href=/galaxy-home/gh-craft><span>Craft 方块世界</span></a>
<a class=dropdown-item href=/galaxy-home/glossary-cards><span>3D 知识卡牌</span></a></div></li><style>.dropdown-item{display:inline-flex}</style><li class="nav-item dropdown"><a href=# class="nav-link dropdown-toggle" data-toggle=dropdown aria-haspopup=true><span>其他阅读渠道</span><span class=caret></span></a><div class=dropdown-menu><a class=dropdown-item href=https://zhuanlan.zhihu.com/wxyyxc1992><img style=width:16px;height:16px;display:inline-block;margin-right:8px src=https://ngte-superbed.oss-cn-beijing.aliyuncs.com/item/20230218234451.png></img><span>知乎</span></a>
<a class=dropdown-item href=https://segmentfault.com/blog/wxyyxc1992><img style=width:16px;height:16px;display:inline-block;margin-right:8px src=https://ngte-superbed.oss-cn-beijing.aliyuncs.com/item/20230219113556.png></img><span>SegmentFault</span></a>
<a class=dropdown-item href=https://zhuanlan.zhihu.com/wxyyxc1992><img style=width:16px;height:16px;display:inline-block;margin-right:8px src=https://ngte-superbed.oss-cn-beijing.aliyuncs.com/item/20230219113519.png></img><span>掘金</span></a></div></li></ul></div><ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2"><li class=nav-item><a class="nav-link js-search" href=# aria-label=搜索><i class="fas fa-search" aria-hidden=true></i></a></li><li class=nav-item><a class=nav-link href=https://github.com/wx-chevalier aria-label=GitHub><i class="fa-brands fa-github" aria-hidden=true></i></a></li><div></div><style>@media only screen and (max-width:600px){.jimmysong-template{display:none!important}}</style><li class=jimmysong-template style=color:#fff;font-size:12px><a href=https://jimmysong.io style=color:#fff>By Jimmy Song's Template</a></li></ul></div></nav></header></div><div class=page-body><link rel=stylesheet href=//unpkg.com/heti/umd/heti.min.css><div class="container-xl docs"><div class="row flex-xl-nowrap"><div class=docs-sidebar><form class="docs-search d-flex align-items-center"><button class="btn docs-toggle d-md-none p-0 mr-md-3 w-100" type=button data-toggle=collapse data-target=#docs-nav aria-controls=docs-nav aria-expanded=false aria-label="Toggle section navigation"><div class=d-flex><span class="d-md-none pl-1 flex-grow-1 text-left overflow-hidden">生产调优</span>
<span><i class="fas fa-chevron-down"></i></span></div></button>
<button class="form-control sidebar-search js-search d-none d-md-flex">
<i class="fas fa-search pr-2"></i>
<span class=sidebar-search-text>搜索...</span>
<span class=sidebar-search-shortcut>/</span></button></form><nav class="collapse docs-links" id=docs-nav><ul class="nav docs-sidenav"><li style=display:inline-flex><a style=cursor:pointer onclick=window.history.back()><i class="fas fa-arrow-left pr-1"></i>
Back</a>
<span>|</span>
<a href=/books/><i class="fa-solid fa-house" style=margin-right:4px></i>
Books</a></li></ul><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-idee5f28cdb449a3b865d84854bbdbb5ba")' href=#idee5f28cdb449a3b865d84854bbdbb5ba aria-expanded=false aria-controls=idee5f28cdb449a3b865d84854bbdbb5ba aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/node-notes/02.%E5%B7%A5%E7%A8%8B%E5%AE%9E%E8%B7%B5/>02.工程实践</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#idee5f28cdb449a3b865d84854bbdbb5ba aria-expanded=false aria-controls=idee5f28cdb449a3b865d84854bbdbb5ba><i class="fa-solid fa-angle-down" id=caret-idee5f28cdb449a3b865d84854bbdbb5ba></i></a></div><ul class="nav docs-sidenav collapse show" id=idee5f28cdb449a3b865d84854bbdbb5ba><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-id619739e248cfd8121bc256a1872f7c1b")' href=#id619739e248cfd8121bc256a1872f7c1b aria-expanded=false aria-controls=id619739e248cfd8121bc256a1872f7c1b aria-hidden=false data-toggle=collapse></div></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-id281f299d13f5810e74d31ece8829d913")' href=#id281f299d13f5810e74d31ece8829d913 aria-expanded=false aria-controls=id281f299d13f5810e74d31ece8829d913 aria-hidden=false data-toggle=collapse></div></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-id39d94840c327028ae3d9525804e39e0b")' href=#id39d94840c327028ae3d9525804e39e0b aria-expanded=false aria-controls=id39d94840c327028ae3d9525804e39e0b aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/node-notes/02.%E5%B7%A5%E7%A8%8B%E5%AE%9E%E8%B7%B5/%E6%9D%83%E9%99%90%E8%AE%A4%E8%AF%81/>权限认证</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#id39d94840c327028ae3d9525804e39e0b aria-expanded=false aria-controls=id39d94840c327028ae3d9525804e39e0b><i class="fa-solid fa-angle-right" id=caret-id39d94840c327028ae3d9525804e39e0b></i></a></div><ul class="nav docs-sidenav collapse" id=id39d94840c327028ae3d9525804e39e0b><li class="child level"><a href=/books/node-notes/02.%E5%B7%A5%E7%A8%8B%E5%AE%9E%E8%B7%B5/%E6%9D%83%E9%99%90%E8%AE%A4%E8%AF%81/jwt/>JWT</a></li><li class="child level"><a href=/books/node-notes/02.%E5%B7%A5%E7%A8%8B%E5%AE%9E%E8%B7%B5/%E6%9D%83%E9%99%90%E8%AE%A4%E8%AF%81/passport/>Passport</a></li><li class="child level"><a href=/books/node-notes/02.%E5%B7%A5%E7%A8%8B%E5%AE%9E%E8%B7%B5/%E6%9D%83%E9%99%90%E8%AE%A4%E8%AF%81/rbac/>RBAC</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-ida6f3aef3dcf395bd8e1963a5da61a7d9")' href=#ida6f3aef3dcf395bd8e1963a5da61a7d9 aria-expanded=false aria-controls=ida6f3aef3dcf395bd8e1963a5da61a7d9 aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/node-notes/02.%E5%B7%A5%E7%A8%8B%E5%AE%9E%E8%B7%B5/%E6%97%A5%E5%BF%97/>日志</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#ida6f3aef3dcf395bd8e1963a5da61a7d9 aria-expanded=false aria-controls=ida6f3aef3dcf395bd8e1963a5da61a7d9><i class="fa-solid fa-angle-right" id=caret-ida6f3aef3dcf395bd8e1963a5da61a7d9></i></a></div><ul class="nav docs-sidenav collapse" id=ida6f3aef3dcf395bd8e1963a5da61a7d9><li class="child level"><a href=/books/node-notes/02.%E5%B7%A5%E7%A8%8B%E5%AE%9E%E8%B7%B5/%E6%97%A5%E5%BF%97/winston/>winston</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-id1c7ae759dfba989daa49efee1420bc40")' href=#id1c7ae759dfba989daa49efee1420bc40 aria-expanded=false aria-controls=id1c7ae759dfba989daa49efee1420bc40 aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/node-notes/02.%E5%B7%A5%E7%A8%8B%E5%AE%9E%E8%B7%B5/%E7%94%9F%E4%BA%A7%E8%B0%83%E4%BC%98/>生产调优</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#id1c7ae759dfba989daa49efee1420bc40 aria-expanded=false aria-controls=id1c7ae759dfba989daa49efee1420bc40><i class="fa-solid fa-angle-down" id=caret-id1c7ae759dfba989daa49efee1420bc40></i></a></div><ul class="nav docs-sidenav collapse show" id=id1c7ae759dfba989daa49efee1420bc40><li class="child level active"><a href=/books/node-notes/02.%E5%B7%A5%E7%A8%8B%E5%AE%9E%E8%B7%B5/%E7%94%9F%E4%BA%A7%E8%B0%83%E4%BC%98/%E5%AE%89%E5%85%A8%E5%8A%A0%E5%9B%BA/>安全加固</a></li><li class="child level"><a href=/books/node-notes/02.%E5%B7%A5%E7%A8%8B%E5%AE%9E%E8%B7%B5/%E7%94%9F%E4%BA%A7%E8%B0%83%E4%BC%98/%E5%90%9E%E5%90%90%E9%87%8F%E4%BC%98%E5%8C%96/>吞吐量优化</a></li><li class="child level"><a href=/books/node-notes/02.%E5%B7%A5%E7%A8%8B%E5%AE%9E%E8%B7%B5/%E7%94%9F%E4%BA%A7%E8%B0%83%E4%BC%98/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/>性能优化</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-id1a2f213367090c30ccad8a65e846fe79")' href=#id1a2f213367090c30ccad8a65e846fe79 aria-expanded=false aria-controls=id1a2f213367090c30ccad8a65e846fe79 aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/node-notes/02.%E5%B7%A5%E7%A8%8B%E5%AE%9E%E8%B7%B5/%E5%AE%9E%E6%97%B6%E9%80%9A%E4%BF%A1/>实时通信</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#id1a2f213367090c30ccad8a65e846fe79 aria-expanded=false aria-controls=id1a2f213367090c30ccad8a65e846fe79><i class="fa-solid fa-angle-right" id=caret-id1a2f213367090c30ccad8a65e846fe79></i></a></div><ul class="nav docs-sidenav collapse" id=id1a2f213367090c30ccad8a65e846fe79><li class="child level"><a href=/books/node-notes/02.%E5%B7%A5%E7%A8%8B%E5%AE%9E%E8%B7%B5/%E5%AE%9E%E6%97%B6%E9%80%9A%E4%BF%A1/socketio/>SocketIO</a></li><li class="child level"><a href=/books/node-notes/02.%E5%B7%A5%E7%A8%8B%E5%AE%9E%E8%B7%B5/%E5%AE%9E%E6%97%B6%E9%80%9A%E4%BF%A1/%E8%81%8A%E5%A4%A9%E5%AE%A4/>聊天室</a></li><li class="child level"><a href=/books/node-notes/02.%E5%B7%A5%E7%A8%8B%E5%AE%9E%E8%B7%B5/%E5%AE%9E%E6%97%B6%E9%80%9A%E4%BF%A1/%E5%AE%9E%E6%97%B6%E9%80%9A%E4%BF%A1/>实时通信</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-id3b2b65d85e2e0696dae835e646373f58")' href=#id3b2b65d85e2e0696dae835e646373f58 aria-expanded=false aria-controls=id3b2b65d85e2e0696dae835e646373f58 aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/node-notes/02.%E5%B7%A5%E7%A8%8B%E5%AE%9E%E8%B7%B5/%E7%B3%BB%E7%BB%9F%E8%BF%9B%E7%A8%8B/>系统进程</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#id3b2b65d85e2e0696dae835e646373f58 aria-expanded=false aria-controls=id3b2b65d85e2e0696dae835e646373f58><i class="fa-solid fa-angle-right" id=caret-id3b2b65d85e2e0696dae835e646373f58></i></a></div><ul class="nav docs-sidenav collapse" id=id3b2b65d85e2e0696dae835e646373f58><li class="child level"><a href=/books/node-notes/02.%E5%B7%A5%E7%A8%8B%E5%AE%9E%E8%B7%B5/%E7%B3%BB%E7%BB%9F%E8%BF%9B%E7%A8%8B/%E5%A4%9A%E8%BF%9B%E7%A8%8B%E6%9E%B6%E6%9E%84/>多进程架构</a></li><li class="child level"><a href=/books/node-notes/02.%E5%B7%A5%E7%A8%8B%E5%AE%9E%E8%B7%B5/%E7%B3%BB%E7%BB%9F%E8%BF%9B%E7%A8%8B/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/>命令执行</a></li></ul></div></ul></div></nav></div><div class="d-none d-xl-block col-xl-2 docs-toc"><ul class="nav toc-top"><li><a href=# id=back_to_top class=docs-toc-title>目录</a></li></ul><nav id=TableOfContents><ul><li><a href=#x-dns-prefetch-control>X-DNS-Prefetch-Control</a></li><li><a href=#x-frame-options>X-Frame-Options</a></li><li><a href=#strict-transport-security>Strict-Transport-Security</a></li><li><a href=#x-download-options>X-Download-Options</a></li><li><a href=#x-content-type-options>X-Content-Type-Options</a></li><li><a href=#x-xss-protection>X-XSS-Protection</a></li></ul></nav><div class="subscribe-module col-24 mt-1"><img src=https://ngte-superbed.oss-cn-beijing.aliyuncs.com/item/20230220172727.png alt=image title=王下邀月熊的微信公众号></div></div><main class="py-md-3 pl-md-3 docs-content col-xl-8" role=main><article class=article><h1>安全加固</h1><div class=article-style><h1 id=http-headers>HTTP Headers</h1><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kr>const</span> <span class=nx>express</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s2>&#34;express&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>PORT</span> <span class=o>=</span> <span class=nx>process</span><span class=p>.</span><span class=nx>env</span><span class=p>.</span><span class=nx>PORT</span> <span class=o>||</span> <span class=mi>3000</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>app</span> <span class=o>=</span> <span class=nx>express</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>app</span><span class=p>.</span><span class=nx>get</span><span class=p>(</span><span class=s2>&#34;/&#34;</span><span class=p>,</span> <span class=p>(</span><span class=nx>req</span><span class=p>,</span> <span class=nx>res</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>res</span><span class=p>.</span><span class=nx>send</span><span class=p>(</span><span class=sb>`&lt;h1&gt;Hello World&lt;/h1&gt;`</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>app</span><span class=p>.</span><span class=nx>listen</span><span class=p>(</span><span class=nx>PORT</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=sb>`Listening on http://localhost:</span><span class=si>${</span><span class=nx>PORT</span><span class=si>}</span><span class=sb>`</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=p>...</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>helmet</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;helmet&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>...</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>app</span><span class=p>.</span><span class=nx>use</span><span class=p>(</span><span class=nx>helmet</span><span class=p>());</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>...</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kr>const</span> <span class=nx>express</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s2>&#34;express&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>PORT</span> <span class=o>=</span> <span class=nx>process</span><span class=p>.</span><span class=nx>env</span><span class=p>.</span><span class=nx>PORT</span> <span class=o>||</span> <span class=mi>3000</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>app</span> <span class=o>=</span> <span class=nx>express</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>app</span><span class=p>.</span><span class=nx>get</span><span class=p>(</span><span class=s2>&#34;/&#34;</span><span class=p>,</span> <span class=p>(</span><span class=nx>req</span><span class=p>,</span> <span class=nx>res</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>res</span><span class=p>.</span><span class=nx>send</span><span class=p>(</span><span class=sb>`&lt;h1&gt;Hello World&lt;/h1&gt;`</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>app</span><span class=p>.</span><span class=nx>listen</span><span class=p>(</span><span class=nx>PORT</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=sb>`Listening on http://localhost:</span><span class=si>${</span><span class=nx>PORT</span><span class=si>}</span><span class=sb>`</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span></code></pre></div><p>We’ll start by adding and removing a few HTTP headers that will help improve our security. To inspect these headers you can use a tool like curl by running:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=nx>curl</span> <span class=nx>http</span><span class=o>:</span><span class=c1>//localhost:3000 --include
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=nx>HTTP</span><span class=o>/</span><span class=mf>1.1</span> <span class=mi>200</span> <span class=nx>OK</span>
</span></span><span class=line><span class=cl><span class=nx>X</span><span class=o>-</span><span class=nx>Powered</span><span class=o>-</span><span class=nx>By</span><span class=o>:</span> <span class=nx>Express</span>
</span></span><span class=line><span class=cl><span class=nx>Content</span><span class=o>-</span><span class=nx>Type</span><span class=o>:</span> <span class=nx>text</span><span class=o>/</span><span class=nx>html</span><span class=p>;</span> <span class=nx>charset</span><span class=o>=</span><span class=nx>utf</span><span class=o>-</span><span class=mi>8</span>
</span></span><span class=line><span class=cl><span class=nx>Content</span><span class=o>-</span><span class=nx>Length</span><span class=o>:</span> <span class=mi>20</span>
</span></span><span class=line><span class=cl><span class=nx>ETag</span><span class=o>:</span> <span class=nx>W</span><span class=o>/</span><span class=s2>&#34;14-SsoazAISF4H46953FT6rSL7/tvU&#34;</span>
</span></span><span class=line><span class=cl><span class=nb>Date</span><span class=o>:</span> <span class=nx>Wed</span><span class=p>,</span> <span class=mi>01</span> <span class=nx>Nov</span> <span class=mi>2017</span> <span class=mi>13</span><span class=o>:</span><span class=mi>36</span><span class=o>:</span><span class=mi>10</span> <span class=nx>GMT</span>
</span></span><span class=line><span class=cl><span class=nx>Connection</span><span class=o>:</span> <span class=nx>keep</span><span class=o>-</span><span class=nx>alive</span>
</span></span></code></pre></div><p>One header that you should keep an eye on is X-Powered-By. Generally speaking headers that start with X- are non-standard headers. This one gives away which framework you are using. For an attacker, this cuts the attack space down for them as they can concentrate on the known vulnerabilities in that framework.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=p>...</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>helmet</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;helmet&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>...</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>app</span><span class=p>.</span><span class=nx>use</span><span class=p>(</span><span class=nx>helmet</span><span class=p>());</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>...</span>
</span></span></code></pre></div><p>Now add the helmet middleware to your application. Modify the index.js accordingly:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>curl http://localhost:3000 --inspect
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>HTTP/1.1 <span class=m>200</span> OK
</span></span><span class=line><span class=cl>X-DNS-Prefetch-Control: off
</span></span><span class=line><span class=cl>X-Frame-Options: SAMEORIGIN
</span></span><span class=line><span class=cl>Strict-Transport-Security: max-age<span class=o>=</span>15552000<span class=p>;</span> includeSubDomains
</span></span><span class=line><span class=cl>X-Download-Options: noopen
</span></span><span class=line><span class=cl>X-Content-Type-Options: nosniff
</span></span><span class=line><span class=cl>X-XSS-Protection: 1<span class=p>;</span> <span class=nv>mode</span><span class=o>=</span>block
</span></span><span class=line><span class=cl>Content-Type: text/html<span class=p>;</span> <span class=nv>charset</span><span class=o>=</span>utf-8
</span></span><span class=line><span class=cl>Content-Length: <span class=m>20</span>
</span></span><span class=line><span class=cl>ETag: W/<span class=s2>&#34;14-SsoazAISF4H46953FT6rSL7/tvU&#34;</span>
</span></span><span class=line><span class=cl>Date: Wed, <span class=m>01</span> Nov <span class=m>2017</span> 13:50:42 GMT
</span></span><span class=line><span class=cl>Connection: keep-alive
</span></span></code></pre></div><p>The <code>X-Powered-By</code> header is gone, which is a good start, but now we have a bunch of new headers.</p><h2 id=x-dns-prefetch-control>X-DNS-Prefetch-Control</h2><p>This header isn’t much of an added security benefit as much as an added privacy benefit. By setting the value to <code>off</code> it turns off the DNS lookups that the browser does for URLs in the page. The DNS lookups are done for performance improvements and according to MDN they can <a href=https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-DNS-Prefetch-Control target=_blank rel=noopener>improve the performance of loading images by 5% or more</a>. However this look up can make it appear like the user visited things they never visited.</p><p>The default for this is <code>off</code> but if you care about the added performance benefit you can enable it by passing <code>{ dnsPrefetchControl: { allow: true }}</code> to the <code>helmet()</code> call.</p><h2 id=x-frame-options>X-Frame-Options</h2><p><code>X-Frame-Options</code> allows you to control whether the page can be loaded in a frame like <code>&lt;frame/></code> <code>&lt;iframe/></code> or <code>&lt;object/></code>. Unless you really need to frame your page you should just disable it entirely by passing the option to the <code>helmet()</code>call:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=nx>app</span><span class=p>.</span><span class=nx>use</span><span class=p>(</span>
</span></span><span class=line><span class=cl>  <span class=nx>helmet</span><span class=p>({</span>
</span></span><span class=line><span class=cl>    <span class=nx>frameguard</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>action</span><span class=o>:</span> <span class=s2>&#34;deny&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>})</span>
</span></span><span class=line><span class=cl><span class=p>);</span>
</span></span></code></pre></div><p><a href="http://caniuse.com/#feat=x-frame-options" target=_blank rel=noopener><code>X-Frame-Options</code> is supported by all modern browsers</a>. It can however also be controlled via a Content Security Policy as we’ll see later.</p><h2 id=strict-transport-security>Strict-Transport-Security</h2><p>This is also known as HSTS (HTTP Strict Transport Security) and is used to ensure that there is no protocol downgrade when you are using HTTPS. If a user visited the website once on HTTPS it makes sure that the browser will not allow any future communication via HTTP. This feature is helpful to avoid Man-In-The-Middle attacks.</p><p>You might have seen this feature in action if you tried to access a page like <a href=https://google.com target=_blank rel=noopener>https://google.com</a> while being on a public WiFi with a captive portal. The WiFi is trying to redirect you to their captive portal but since you visited <code>google.com</code>before via HTTPS and it set the <code>Strict-Transport-Security</code> header, the browser will block this redirect.</p><p>You can read more about it on the <a href=https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Strict-Transport-Security target=_blank rel=noopener>MDN page</a> or the <a href=https://www.owasp.org/index.php/HTTP_Strict_Transport_Security_Cheat_Sheet target=_blank rel=noopener>OWASP wiki page</a>.</p><h2 id=x-download-options>X-Download-Options</h2><p>This header is only protecting you from an old IE security vulnerability. Basically if you host untrusted HTML files for download, users were able open these directly (rather than saving them to disk first) and they would execute in the context of your app. This header ensures that users download files before they open them so that they can’t execute in your app’s security context.</p><p>You can find more information about this on the <a href=https://helmetjs.github.io/docs/ienoopen/ target=_blank rel=noopener>helmet page</a> and this <a href=https://blogs.msdn.microsoft.com/ie/2008/07/02/ie8-security-part-v-comprehensive-protection/ target=_blank rel=noopener>MSDN blog post</a>.</p><h2 id=x-content-type-options>X-Content-Type-Options</h2><p>Some browsers perform “MIME sniffing” meaning that rather than loading things based on the <code>Content-Type</code> that the server will send, the browser will try to determine the content type based on the file content and execute it based on that.</p><p>Say your page offers a way to upload pictures and an attacker uploads some HTML instead, if the browser performs MIME sniffing, it could execute the code as HTML and the attacker would have performed a successful XSS attack.</p><p>By setting this header to <code>nosniff</code> we are disabling this MIME sniffing.</p><h2 id=x-xss-protection>X-XSS-Protection</h2><p>This header is used to turn on basic XSS protections in the user’s browser. It can’t avoid every XSS opportunity but it can determine basic ones. For example, if it detects that the query string contains something like a script tag, the browser could block the execution of the same code in the page knowing that it’s likely an XSS attack. This header can have three different values. <code>0</code>, <code>1</code> and <code>1; mode=block</code>. If you want to learn more about which mode you should choose, make sure to <a href=https://blog.innerht.ml/the-misunderstood-x-xss-protection/ target=_blank rel=noopener>check out this blog post about <code>X-XSS-Protection</code> and it’s potential dangers</a>.</p></div><div class=article-widget><div class="container-xl row post-nav"><div class="col-6 post-nav-item"><div class=meta-nav>下一页</div><a href=/books/node-notes/02.%E5%B7%A5%E7%A8%8B%E5%AE%9E%E8%B7%B5/%E7%94%9F%E4%BA%A7%E8%B0%83%E4%BC%98/%E5%90%9E%E5%90%90%E9%87%8F%E4%BC%98%E5%8C%96/ rel=prev>吞吐量优化</a></div></div></div><div class=body-footer><p>最近更新于 0001-01-01</p><section id=comments class="mb-3 pt-0"><div id=disqus_thread></div><script>var disqus_config=function(){};(function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="https://ngte.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)})()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></section></div></article><footer class=site-footer><div class="copyright py-4 bg-footer"><div class="row justify-content-center"><div class="text-center footer-color"><p class=mb-0>© 2017-2022 NGTE all rights reserved</p></div></div></div><script type=text/javascript id=clstr_globe async src="//clustrmaps.com/globe.js?d=kgpJG5sWZQpKujBmD-uW1B54-WBPol-DuDtrB2KFjKs"></script></footer></main></div></div><script src=//unpkg.com/heti/umd/heti-addon.min.js></script>
<script>const heti=new Heti(".article");heti.autoSpacing()</script><script type=text/javascript>window.$crisp=[],window.CRISP_WEBSITE_ID="12adcc35-9621-4313-8262-62dc654b29d8",function(){setTimeout(function(){d=document,s=d.createElement("script"),s.src="https://client.crisp.chat/l.js",s.async=1,d.getElementsByTagName("head")[0].appendChild(s)},2500)}()</script></div><div class=page-footer></div><script src=/js/vendor-bundle.min.d26509351aa0ff874abbee824e982e9b.js></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.1/highlight.min.js integrity="sha512-Ypjm0o7jOxAd4hpdoppSEN0TQOC19UtPAqD+4s5AlXmUvbmmS/YMxYqAqarQYyxTnB6/rqip9qcxlNB/3U9Wdg==" crossorigin=anonymous></script>
<script id=search-hit-algolia-template type=text/html><div class=search-hit><div class=search-hit-content><div class=search-hit-name><a href={{relpermalink}}>{{#helpers.highlight}}{ "attribute": "title" }{{/helpers.highlight}}</a></div><div class="article-metadata search-hit-type">{{type}}</div><p class=search-hit-description>{{#helpers.highlight}}{ "attribute": "summary" }{{/helpers.highlight}}</p></div></div></script><script src=https://cdn.jsdelivr.net/npm/instantsearch.js@4/dist/instantsearch.production.min.js crossorigin=anonymous></script>
<script id=dsq-count-scr src=https://ngte.disqus.com/count.js async></script>
<script src=/zh/js/algolia-search-built.min.4387d694ca1258194aaf562b8cd1c400.js type=module></script>
<script id=page-data type=application/json>{"use_headroom":false}</script><script src=/zh/js/wowchemy.min.d1673c7a11d1238516cbe12a1e84257f.js></script>
<script>var mybutton=document.getElementById("backTopBtn");window.onscroll=function(){scrollFunction()};function scrollFunction(){document.body.scrollTop>20||document.documentElement.scrollTop>20?mybutton.style.display="block":mybutton.style.display="none"}function topFunction(){document.body.scrollTop=0,document.documentElement.scrollTop=0}</script><script src=https://cdn.jsdelivr.net/gh/bryanbraun/anchorjs@4.2.2/anchor.min.js integrity="sha512-I7w3ZdSFzw5j3jU3ZkNikBNeIrl3i+hEuEdwNmqUJvwNcaBUNcijnP2gd9DtGlgVYDplfjGoD8vTNsID+lCjqg==" crossorigin=anonymous></script>
<script>anchors.add()</script><script>(function(){"use strict";if(!document.queryCommandSupported("copy"))return;function e(e,t){e.className="highlight-copy-btn",e.textContent=t,setTimeout(function(){e.textContent="",e.className="highlight-copy-btn fa fa-copy"},1e3)}function t(e){var t=window.getSelection(),n=document.createRange();return n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n),t}function n(n){var o,s=document.createElement("button");s.className="highlight-copy-btn fa fa-copy",s.textContent="",o=n.firstElementChild,s.addEventListener("click",function(){try{var n=t(o);document.execCommand("copy"),n.removeAllRanges(),e(s,"已复制")}catch(t){console&&console.log(t),e(s,"Failed :'(")}}),n.appendChild(s)}var s=document.getElementsByClassName("highlight");Array.prototype.forEach.call(s,n)})()</script></body></html>