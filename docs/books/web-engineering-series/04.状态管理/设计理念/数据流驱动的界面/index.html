<!doctype html><html lang=zh><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=generator content="Wowchemy 5.5.0 for Hugo"><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=preload as=style href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap"><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap" media=print onload='this.media="all"'><meta name=google-site-verification content="google69a5cccb61297807"><meta name=baidu-site-verification content="cqmZHEleVh"><meta name=description content="数据流驱动的界面 广义的数据流驱动的界面有很多的理解，其一是界面层的从以 DOM 操作为核心到逻辑分离，其二是数据交互层的前后端分离。在 jQuery 时代，我们往往将 DOM 操作与逻辑操作混杂在一起，再加上模块机制的缺乏使得代码"><link rel=alternate hreflang=zh href=https://ng-tech.icu/books/web-engineering-series/04.%E7%8A%B6%E6%80%81%E7%AE%A1%E7%90%86/%E8%AE%BE%E8%AE%A1%E7%90%86%E5%BF%B5/%E6%95%B0%E6%8D%AE%E6%B5%81%E9%A9%B1%E5%8A%A8%E7%9A%84%E7%95%8C%E9%9D%A2/><meta name=theme-color content="#0a55a7"><link rel=stylesheet href=/css/vendor-bundle.min.c7b8d9abd591ba2253ea42747e3ac3f5.css media=print onload='this.media="all"'><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.1/styles/github.min.css crossorigin=anonymous title=hl-light media=print onload='this.media="all"'><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.1/styles/dracula.min.css crossorigin=anonymous title=hl-dark media=print onload='this.media="all"' disabled><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/instantsearch.css@7.4.5/themes/satellite-min.css integrity="sha256-TehzF/2QvNKhGQrrNpoOb2Ck4iGZ1J/DI4pkd2oUsBc=" crossorigin=anonymous><link rel=stylesheet href=/css/wowchemy.63df6ae9fc2b4cc71b83f1774d780209.css><script async src="https://www.googletagmanager.com/gtag/js?id=G-40NYXJ8823"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-40NYXJ8823")</script><script>var _hmt=_hmt||[];(function(){var e,t=document.createElement("script");t.src="https://hm.baidu.com/hm.js?56df1177bce405601b0ecdd7208f75c6",e=document.getElementsByTagName("script")[0],e.parentNode.insertBefore(t,e)})()</script><link rel=manifest href=/manifest.webmanifest><link rel=icon type=image/png href=/media/icon_hu0f7d075e895d6f5f1f5fdbc1e33dc138_10087_32x32_fill_lanczos_center_3.png><link rel=apple-touch-icon type=image/png href=/media/icon_hu0f7d075e895d6f5f1f5fdbc1e33dc138_10087_180x180_fill_lanczos_center_3.png><link rel=canonical href=https://ng-tech.icu/books/web-engineering-series/04.%E7%8A%B6%E6%80%81%E7%AE%A1%E7%90%86/%E8%AE%BE%E8%AE%A1%E7%90%86%E5%BF%B5/%E6%95%B0%E6%8D%AE%E6%B5%81%E9%A9%B1%E5%8A%A8%E7%9A%84%E7%95%8C%E9%9D%A2/><meta property="twitter:card" content="summary_large_image"><meta property="twitter:site" content="@wx-chevalier"><meta property="twitter:creator" content="@wx-chevalier"><meta property="og:site_name" content="Next-gen Tech Edu"><meta property="og:url" content="https://ng-tech.icu/books/web-engineering-series/04.%E7%8A%B6%E6%80%81%E7%AE%A1%E7%90%86/%E8%AE%BE%E8%AE%A1%E7%90%86%E5%BF%B5/%E6%95%B0%E6%8D%AE%E6%B5%81%E9%A9%B1%E5%8A%A8%E7%9A%84%E7%95%8C%E9%9D%A2/"><meta property="og:title" content="数据流驱动的界面 | Next-gen Tech Edu"><meta property="og:description" content="数据流驱动的界面 广义的数据流驱动的界面有很多的理解，其一是界面层的从以 DOM 操作为核心到逻辑分离，其二是数据交互层的前后端分离。在 jQuery 时代，我们往往将 DOM 操作与逻辑操作混杂在一起，再加上模块机制的缺乏使得代码"><meta property="og:image" content="https://ng-tech.icu/media/sharing.png"><meta property="twitter:image" content="https://ng-tech.icu/media/sharing.png"><meta property="og:locale" content="zh"><title>数据流驱动的界面 | Next-gen Tech Edu</title></head><body id=top data-spy=scroll data-offset=70 data-target=#TableOfContents class=page-wrapper data-wc-page-id=fea69fb523e888b85e7c6a495d3ff030><button onclick=topFunction() id=backTopBtn title="Go to top"><i class="fa-solid fa-circle-up" aria-hidden=true></i></button>
<script src=/js/wowchemy-init.min.14a0ed61c6dbd594b9c75193b25be179.js></script><aside class=search-modal id=search><div class=container><section class=search-header><div class="row no-gutters justify-content-between mb-3"><div class="col-6 search-title"><p>搜索</p></div><div class="col-6 col-search-close"><a class=js-search href=# aria-label=关闭><i class="fas fa-times-circle text-muted" aria-hidden=true></i></a></div></div><div id=search-box></div></section><section class=section-search-results><div id=search-hits></div><div id=search-common-queries></div></section></div></aside><div class=page-header><header class=header--fixed><nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id=navbar-main><div class=container-xl><div class="d-none d-lg-inline-flex"><a class=navbar-brand href=/>Next-gen Tech Edu</a></div><button type=button class=navbar-toggler data-toggle=collapse data-target=#navbar-content aria-controls=navbar-content aria-expanded=false aria-label=切换导航>
<span><i class="fas fa-bars"></i></span></button><div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none"><a class=navbar-brand href=/>Next-gen Tech Edu</a></div><div class="navbar-collapse main-menu-item collapse justify-content-start" id=navbar-content><ul class="navbar-nav d-md-inline-flex"><li class=nav-item><a class=nav-link href=/books-gallery><span>笔记（万篇）</span></a></li><li class=nav-item><a class=nav-link href=/#knowledge-map><span>知识图谱</span></a></li><style>.dropdown-item{display:inline-flex}</style><li class="nav-item dropdown"><a href=# class="nav-link dropdown-toggle" data-toggle=dropdown aria-haspopup=true><span>实验室</span><span class=caret></span></a><div class=dropdown-menu><a class=dropdown-item href=/galaxy-home/gh-craft><span>Craft 方块世界</span></a>
<a class=dropdown-item href=/galaxy-home/glossary-cards><span>3D 知识卡牌</span></a></div></li><style>.dropdown-item{display:inline-flex}</style><li class="nav-item dropdown"><a href=# class="nav-link dropdown-toggle" data-toggle=dropdown aria-haspopup=true><span>其他阅读渠道</span><span class=caret></span></a><div class=dropdown-menu><a class=dropdown-item href=https://zhuanlan.zhihu.com/wxyyxc1992><img style=width:16px;height:16px;display:inline-block;margin-right:8px src=https://ngte-superbed.oss-cn-beijing.aliyuncs.com/item/20230218234451.png></img><span>知乎</span></a>
<a class=dropdown-item href=https://segmentfault.com/blog/wxyyxc1992><img style=width:16px;height:16px;display:inline-block;margin-right:8px src=https://ngte-superbed.oss-cn-beijing.aliyuncs.com/item/20230219113556.png></img><span>SegmentFault</span></a>
<a class=dropdown-item href=https://zhuanlan.zhihu.com/wxyyxc1992><img style=width:16px;height:16px;display:inline-block;margin-right:8px src=https://ngte-superbed.oss-cn-beijing.aliyuncs.com/item/20230219113519.png></img><span>掘金</span></a></div></li></ul></div><ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2"><li class=nav-item><a class="nav-link js-search" href=# aria-label=搜索><i class="fas fa-search" aria-hidden=true></i></a></li><li class=nav-item><a class=nav-link href=https://github.com/wx-chevalier aria-label=GitHub><i class="fa-brands fa-github" aria-hidden=true></i></a></li><div></div><style>@media only screen and (max-width:600px){.jimmysong-template{display:none!important}}</style><li class=jimmysong-template style=color:#fff;font-size:12px><a href=https://jimmysong.io style=color:#fff>By Jimmy Song's Template</a></li></ul></div></nav></header></div><div class=page-body><link rel=stylesheet href=//unpkg.com/heti/umd/heti.min.css><div class="container-xl docs"><div class="row flex-xl-nowrap"><div class=docs-sidebar><form class="docs-search d-flex align-items-center"><button class="btn docs-toggle d-md-none p-0 mr-md-3 w-100" type=button data-toggle=collapse data-target=#docs-nav aria-controls=docs-nav aria-expanded=false aria-label="Toggle section navigation"><div class=d-flex><span class="d-md-none pl-1 flex-grow-1 text-left overflow-hidden">设计理念</span>
<span><i class="fas fa-chevron-down"></i></span></div></button>
<button class="form-control sidebar-search js-search d-none d-md-flex">
<i class="fas fa-search pr-2"></i>
<span class=sidebar-search-text>搜索...</span>
<span class=sidebar-search-shortcut>/</span></button></form><nav class="collapse docs-links" id=docs-nav><ul class="nav docs-sidenav"><li style=display:inline-flex><a style=cursor:pointer onclick=window.history.back()><i class="fas fa-arrow-left pr-1"></i>
Back</a>
<span>|</span>
<a href=/books/><i class="fa-solid fa-house" style=margin-right:4px></i>
Books</a></li></ul><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-idc7e3545f103271a0a9ef3ee59048fe6b")' href=#idc7e3545f103271a0a9ef3ee59048fe6b aria-expanded=false aria-controls=idc7e3545f103271a0a9ef3ee59048fe6b aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/web-engineering-series/04.%E7%8A%B6%E6%80%81%E7%AE%A1%E7%90%86/>04.状态管理</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#idc7e3545f103271a0a9ef3ee59048fe6b aria-expanded=false aria-controls=idc7e3545f103271a0a9ef3ee59048fe6b><i class="fa-solid fa-angle-down" id=caret-idc7e3545f103271a0a9ef3ee59048fe6b></i></a></div><ul class="nav docs-sidenav collapse show" id=idc7e3545f103271a0a9ef3ee59048fe6b><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-id8da5be1c9c9912685830d6a918bb7607")' href=#id8da5be1c9c9912685830d6a918bb7607 aria-expanded=false aria-controls=id8da5be1c9c9912685830d6a918bb7607 aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/web-engineering-series/04.%E7%8A%B6%E6%80%81%E7%AE%A1%E7%90%86/mobx/>MobX</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#id8da5be1c9c9912685830d6a918bb7607 aria-expanded=false aria-controls=id8da5be1c9c9912685830d6a918bb7607><i class="fa-solid fa-angle-right" id=caret-id8da5be1c9c9912685830d6a918bb7607></i></a></div><ul class="nav docs-sidenav collapse" id=id8da5be1c9c9912685830d6a918bb7607><li class="child level"><a href=/books/web-engineering-series/04.%E7%8A%B6%E6%80%81%E7%AE%A1%E7%90%86/mobx/%E5%BA%95%E5%B1%82%E5%8E%9F%E7%90%86%E4%B8%8E%E9%80%8F%E6%98%8E%E5%93%8D%E5%BA%94/>底层原理与透明响应</a></li><li class="child level"><a href=/books/web-engineering-series/04.%E7%8A%B6%E6%80%81%E7%AE%A1%E7%90%86/mobx/%E5%93%8D%E5%BA%94%E5%BC%8F%E7%9B%91%E5%90%AC/>响应式监听</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-idd608246a89e49eea6aca9decf0e59d5d")' href=#idd608246a89e49eea6aca9decf0e59d5d aria-expanded=false aria-controls=idd608246a89e49eea6aca9decf0e59d5d aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/web-engineering-series/04.%E7%8A%B6%E6%80%81%E7%AE%A1%E7%90%86/redux/>Redux</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#idd608246a89e49eea6aca9decf0e59d5d aria-expanded=false aria-controls=idd608246a89e49eea6aca9decf0e59d5d><i class="fa-solid fa-angle-right" id=caret-idd608246a89e49eea6aca9decf0e59d5d></i></a></div><ul class="nav docs-sidenav collapse" id=idd608246a89e49eea6aca9decf0e59d5d><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-id2bc60a1bfa7451f8b42cbfad454f2651")' href=#id2bc60a1bfa7451f8b42cbfad454f2651 aria-expanded=false aria-controls=id2bc60a1bfa7451f8b42cbfad454f2651 aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/web-engineering-series/04.%E7%8A%B6%E6%80%81%E7%AE%A1%E7%90%86/redux/%E5%B7%A5%E7%A8%8B%E6%A1%86%E6%9E%B6/>工程框架</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#id2bc60a1bfa7451f8b42cbfad454f2651 aria-expanded=false aria-controls=id2bc60a1bfa7451f8b42cbfad454f2651><i class="fa-solid fa-angle-right" id=caret-id2bc60a1bfa7451f8b42cbfad454f2651></i></a></div><ul class="nav docs-sidenav collapse" id=id2bc60a1bfa7451f8b42cbfad454f2651><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-id66aa16ab5053e53e5256dac0d12810fe")' href=#id66aa16ab5053e53e5256dac0d12810fe aria-expanded=false aria-controls=id66aa16ab5053e53e5256dac0d12810fe aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/web-engineering-series/04.%E7%8A%B6%E6%80%81%E7%AE%A1%E7%90%86/redux/%E5%B7%A5%E7%A8%8B%E6%A1%86%E6%9E%B6/kea/>Kea</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#id66aa16ab5053e53e5256dac0d12810fe aria-expanded=false aria-controls=id66aa16ab5053e53e5256dac0d12810fe><i class="fa-solid fa-angle-right" id=caret-id66aa16ab5053e53e5256dac0d12810fe></i></a></div><ul class="nav docs-sidenav collapse" id=id66aa16ab5053e53e5256dac0d12810fe><li class="child level"><a href=/books/web-engineering-series/04.%E7%8A%B6%E6%80%81%E7%AE%A1%E7%90%86/redux/%E5%B7%A5%E7%A8%8B%E6%A1%86%E6%9E%B6/kea/%E6%8F%92%E4%BB%B6/>插件</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-id7dc38bb16b021cd1a50a627fc66c4981")' href=#id7dc38bb16b021cd1a50a627fc66c4981 aria-expanded=false aria-controls=id7dc38bb16b021cd1a50a627fc66c4981 aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/web-engineering-series/04.%E7%8A%B6%E6%80%81%E7%AE%A1%E7%90%86/redux/%E5%B7%A5%E7%A8%8B%E6%A1%86%E6%9E%B6/redux-toolkit/>Redux Toolkit</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#id7dc38bb16b021cd1a50a627fc66c4981 aria-expanded=false aria-controls=id7dc38bb16b021cd1a50a627fc66c4981><i class="fa-solid fa-angle-right" id=caret-id7dc38bb16b021cd1a50a627fc66c4981></i></a></div><ul class="nav docs-sidenav collapse" id=id7dc38bb16b021cd1a50a627fc66c4981><li class="child level"><a href=/books/web-engineering-series/04.%E7%8A%B6%E6%80%81%E7%AE%A1%E7%90%86/redux/%E5%B7%A5%E7%A8%8B%E6%A1%86%E6%9E%B6/redux-toolkit/api-%E7%AE%80%E5%8C%96/>API 简化</a></li><li class="child level"><a href=/books/web-engineering-series/04.%E7%8A%B6%E6%80%81%E7%AE%A1%E7%90%86/redux/%E5%B7%A5%E7%A8%8B%E6%A1%86%E6%9E%B6/redux-toolkit/typescript/>TypeScript</a></li><li class="child level"><a href=/books/web-engineering-series/04.%E7%8A%B6%E6%80%81%E7%AE%A1%E7%90%86/redux/%E5%B7%A5%E7%A8%8B%E6%A1%86%E6%9E%B6/redux-toolkit/%E6%95%B0%E6%8D%AE%E6%A0%87%E5%87%86%E5%8C%96/>数据标准化</a></li><li class="child level"><a href=/books/web-engineering-series/04.%E7%8A%B6%E6%80%81%E7%AE%A1%E7%90%86/redux/%E5%B7%A5%E7%A8%8B%E6%A1%86%E6%9E%B6/redux-toolkit/%E5%BC%82%E6%AD%A5%E6%A8%A1%E5%BC%8F/>异步模式</a></li></ul></div><li class="child level"><a href=/books/web-engineering-series/04.%E7%8A%B6%E6%80%81%E7%AE%A1%E7%90%86/redux/%E5%B7%A5%E7%A8%8B%E6%A1%86%E6%9E%B6/redux-actions/>redux-actions</a></li><li class="child level"><a href=/books/web-engineering-series/04.%E7%8A%B6%E6%80%81%E7%AE%A1%E7%90%86/redux/%E5%B7%A5%E7%A8%8B%E6%A1%86%E6%9E%B6/%E4%BB%A3%E7%A0%81%E7%BB%84%E7%BB%87/>代码组织</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-id3f75423a6282c5797f6aa93692175c58")' href=#id3f75423a6282c5797f6aa93692175c58 aria-expanded=false aria-controls=id3f75423a6282c5797f6aa93692175c58 aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/web-engineering-series/04.%E7%8A%B6%E6%80%81%E7%AE%A1%E7%90%86/redux/%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/>基础语法</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#id3f75423a6282c5797f6aa93692175c58 aria-expanded=false aria-controls=id3f75423a6282c5797f6aa93692175c58><i class="fa-solid fa-angle-right" id=caret-id3f75423a6282c5797f6aa93692175c58></i></a></div><ul class="nav docs-sidenav collapse" id=id3f75423a6282c5797f6aa93692175c58><li class="child level"><a href=/books/web-engineering-series/04.%E7%8A%B6%E6%80%81%E7%AE%A1%E7%90%86/redux/%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/redux-scratch/>Redux Scratch</a></li><li class="child level"><a href=/books/web-engineering-series/04.%E7%8A%B6%E6%80%81%E7%AE%A1%E7%90%86/redux/%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/%E6%A0%B8%E5%BF%83%E7%BB%84%E4%BB%B6/>核心组件</a></li><li class="child level"><a href=/books/web-engineering-series/04.%E7%8A%B6%E6%80%81%E7%AE%A1%E7%90%86/redux/%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/%E8%AE%BE%E8%AE%A1%E5%8E%9F%E5%88%99/>设计原则</a></li><li class="child level"><a href=/books/web-engineering-series/04.%E7%8A%B6%E6%80%81%E7%AE%A1%E7%90%86/redux/%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/%E7%8A%B6%E6%80%81%E6%A0%91%E8%AE%BE%E8%AE%A1/>状态树设计</a></li></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-id594166fef4add1f8d261fe62d8a7466c")' href=#id594166fef4add1f8d261fe62d8a7466c aria-expanded=false aria-controls=id594166fef4add1f8d261fe62d8a7466c aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/web-engineering-series/04.%E7%8A%B6%E6%80%81%E7%AE%A1%E7%90%86/redux/%E4%B8%AD%E9%97%B4%E4%BB%B6%E4%B8%8E%E5%BC%82%E6%AD%A5/>中间件与异步</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#id594166fef4add1f8d261fe62d8a7466c aria-expanded=false aria-controls=id594166fef4add1f8d261fe62d8a7466c><i class="fa-solid fa-angle-right" id=caret-id594166fef4add1f8d261fe62d8a7466c></i></a></div><ul class="nav docs-sidenav collapse" id=id594166fef4add1f8d261fe62d8a7466c><li class="child level"><a href=/books/web-engineering-series/04.%E7%8A%B6%E6%80%81%E7%AE%A1%E7%90%86/redux/%E4%B8%AD%E9%97%B4%E4%BB%B6%E4%B8%8E%E5%BC%82%E6%AD%A5/observable/>Observable</a></li><li class="child level"><a href=/books/web-engineering-series/04.%E7%8A%B6%E6%80%81%E7%AE%A1%E7%90%86/redux/%E4%B8%AD%E9%97%B4%E4%BB%B6%E4%B8%8E%E5%BC%82%E6%AD%A5/promise/>Promise</a></li><li class="child level"><a href=/books/web-engineering-series/04.%E7%8A%B6%E6%80%81%E7%AE%A1%E7%90%86/redux/%E4%B8%AD%E9%97%B4%E4%BB%B6%E4%B8%8E%E5%BC%82%E6%AD%A5/sagas/>Sagas</a></li><li class="child level"><a href=/books/web-engineering-series/04.%E7%8A%B6%E6%80%81%E7%AE%A1%E7%90%86/redux/%E4%B8%AD%E9%97%B4%E4%BB%B6%E4%B8%8E%E5%BC%82%E6%AD%A5/thunk/>Thunk</a></li><li class="child level"><a href=/books/web-engineering-series/04.%E7%8A%B6%E6%80%81%E7%AE%A1%E7%90%86/redux/%E4%B8%AD%E9%97%B4%E4%BB%B6%E4%B8%8E%E5%BC%82%E6%AD%A5/%E4%B8%AD%E9%97%B4%E4%BB%B6/>中间件</a></li></ul></div></ul></div><div class="docs-toc-item has-child"><div class="parent-node d-flex justify-content-between" onclick='Collapse("caret-id9db47c02f350e7ff04bcf8f01354c764")' href=#id9db47c02f350e7ff04bcf8f01354c764 aria-expanded=false aria-controls=id9db47c02f350e7ff04bcf8f01354c764 aria-hidden=false data-toggle=collapse><a class="d-inline docs-toc-link" href=/books/web-engineering-series/04.%E7%8A%B6%E6%80%81%E7%AE%A1%E7%90%86/%E8%AE%BE%E8%AE%A1%E7%90%86%E5%BF%B5/>设计理念</a>
<a class="nav-toogle d-inline level" aria-hidden=false data-toggle=collapse href=#id9db47c02f350e7ff04bcf8f01354c764 aria-expanded=false aria-controls=id9db47c02f350e7ff04bcf8f01354c764><i class="fa-solid fa-angle-down" id=caret-id9db47c02f350e7ff04bcf8f01354c764></i></a></div><ul class="nav docs-sidenav collapse show" id=id9db47c02f350e7ff04bcf8f01354c764><li class="child level"><a href=/books/web-engineering-series/04.%E7%8A%B6%E6%80%81%E7%AE%A1%E7%90%86/%E8%AE%BE%E8%AE%A1%E7%90%86%E5%BF%B5/flux/>Flux</a></li><li class="child level"><a href=/books/web-engineering-series/04.%E7%8A%B6%E6%80%81%E7%AE%A1%E7%90%86/%E8%AE%BE%E8%AE%A1%E7%90%86%E5%BF%B5/%E5%8D%95%E5%90%91%E6%95%B0%E6%8D%AE%E6%B5%81/>单向数据流</a></li><li class="child level"><a href=/books/web-engineering-series/04.%E7%8A%B6%E6%80%81%E7%AE%A1%E7%90%86/%E8%AE%BE%E8%AE%A1%E7%90%86%E5%BF%B5/%E6%B8%90%E8%BF%9B%E7%9A%84%E7%8A%B6%E6%80%81%E7%AE%A1%E7%90%86/>渐进的状态管理</a></li><li class="child level active"><a href=/books/web-engineering-series/04.%E7%8A%B6%E6%80%81%E7%AE%A1%E7%90%86/%E8%AE%BE%E8%AE%A1%E7%90%86%E5%BF%B5/%E6%95%B0%E6%8D%AE%E6%B5%81%E9%A9%B1%E5%8A%A8%E7%9A%84%E7%95%8C%E9%9D%A2/>数据流驱动的界面</a></li></ul></div><li class="child level"><a href=/books/web-engineering-series/04.%E7%8A%B6%E6%80%81%E7%AE%A1%E7%90%86/%E7%8A%B6%E6%80%81%E7%AE%A1%E7%90%86%E6%A1%86%E6%9E%B6%E5%AF%B9%E6%AF%94/>状态管理框架对比</a></li></ul></div></nav></div><div class="d-none d-xl-block col-xl-2 docs-toc"><ul class="nav toc-top"><li><a href=# id=back_to_top class=docs-toc-title>目录</a></li></ul><nav id=TableOfContents><ul><li><a href=#命令式编程与声明式编程>命令式编程与声明式编程</a></li></ul><ul><li><a href=#virtual-dom>Virtual DOM</a></li></ul><ul><li><a href=#函数式编程>函数式编程</a></li></ul></nav><div class="subscribe-module col-24 mt-1"><img src=https://ngte-superbed.oss-cn-beijing.aliyuncs.com/item/20230220172727.png alt=image title=王下邀月熊的微信公众号></div></div><main class="py-md-3 pl-md-3 docs-content col-xl-8" role=main><article class=article><h1>数据流驱动的界面</h1><div class=article-style><h1 id=数据流驱动的界面>数据流驱动的界面</h1><p>广义的数据流驱动的界面有很多的理解，其一是界面层的从以 DOM 操作为核心到逻辑分离，其二是数据交互层的前后端分离。在 jQuery 时代，我们往往将 DOM 操作与逻辑操作混杂在一起，再加上模块机制的缺乏使得代码的可读性、可测试性与可维护性极低；随着项目复杂度的增加、开发人员的增加与时间的推移，项目的维护成本会以几何级数增长。随着 ES6 Modules 的广泛应用，我们在前端开发中更易于去实践 SRP 单一职责原则，也更方便地去编写单元测试、集成测试等来保证代码质量。而像 React、Vue 这样现代的视图层库为我们提供了声明式组件，托管了从数据变化到 DOM 操作之间的映射，使得开发者能够专注于业务逻辑本身。并且 Redux, MobX 这样独立的状态管理库，又可以将产品中的视图层与逻辑层剥离，保证了逻辑代码的易于测试性与跨端迁移性，促进了前端的工程化步伐。</p><p>而随着从传统的前后端未分离的巨石型 Web 应用，到 SPA 这样的富客户端前后端分离应用，前后端各成体系，能够应用不同的技术选型与项目架构。原本由服务端负责的数据渲染工作交由前端进行，并且规定前端与服务端之间只能通过标准化协议进行通信，给与了双方更好地灵活性与适应性。前后端分离也促成了组织架构上的分离，由早期的服务端开发人员顺手去写个界面转变为完整的前端团队构建工程化的前端架构。近两年来随着无线技术的发展和各种智能设备的兴起，互联网应用演进到以 API 驱动的无线优先(Mobile First)和面向全渠道体验(omni-channel experience oriented)的时代，BFF 这样前端优先的 API 设计模式与 GraphQL 这样的查询语言也得到了大量的关注与应用。</p><h1 id=dom-操作与逻辑的剥离>DOM 操作与逻辑的剥离</h1><h2 id=命令式编程与声明式编程>命令式编程与声明式编程</h2><p>An imperative approach (HOW): I see that table located under the Gone Fishin’ sign is empty. My husband and I are going to walk over there and sit down.</p><p>A declarative approach (WHAT): Table for two, please.</p><p>The imperative approach is concerned with HOW you’re actually going to get a seat. You need to list out the steps to be able to show HOW you’re going to get a table.The declarative approach is more concerned with WHAT you want, a table for two.</p><p>Imperative: C, C++, Java</p><p>Declarative: SQL, HTML</p><p>(Can Be) Mix: JavaScript, C#, Python</p><p>Think about your typical SQL or HTML example,</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>Users</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>Country</span><span class=o>=</span><span class=err>’</span><span class=n>Mexico</span><span class=err>’</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>article</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>header</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>h1</span><span class=p>&gt;</span>Declarative Programming<span class=p>&lt;/</span><span class=nt>h1</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>p</span><span class=p>&gt;</span>Sprinkle Declarative in your verbiage to sound smart<span class=p>&lt;/</span><span class=nt>p</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;/</span><span class=nt>header</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>article</span><span class=p>&gt;</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kr>const</span> <span class=nx>photos</span> <span class=o>=</span> <span class=p>[</span><span class=s2>&#34;photoMoon&#34;</span><span class=p>,</span> <span class=s2>&#34;photoSun&#34;</span><span class=p>,</span> <span class=s2>&#34;photoSky&#34;</span><span class=p>];</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>cameras</span> <span class=o>=</span> <span class=p>[</span><span class=s2>&#34;canon&#34;</span><span class=p>,</span> <span class=s2>&#34;nikon&#34;</span><span class=p>,</span> <span class=s2>&#34;Sony&#34;</span><span class=p>];</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// can be const since it&#39;s an array will keep as let to identify that it&#39;s being changed
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=kd>let</span> <span class=nx>artists</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>name</span><span class=o>:</span> <span class=s2>&#34;Thomas Kelley&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>link</span><span class=o>:</span> <span class=s2>&#34;https://unsplash.com/@thkelley&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>name</span><span class=o>:</span> <span class=s2>&#34;Thomas Kvistholt&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>link</span><span class=o>:</span> <span class=s2>&#34;https://unsplash.com/@freeche&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>name</span><span class=o>:</span> <span class=s2>&#34;Guillaume Flandre&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>link</span><span class=o>:</span> <span class=s2>&#34;https://unsplash.com/@gflandre&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span>
</span></span><span class=line><span class=cl><span class=p>];</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>artistsCorrect</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>for</span> <span class=p>(</span><span class=kd>let</span> <span class=nx>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>i</span> <span class=o>&lt;</span> <span class=nx>artists</span><span class=p>.</span><span class=nx>length</span><span class=p>;</span> <span class=nx>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>artists</span><span class=p>[</span><span class=nx>i</span><span class=p>].</span><span class=nx>photo</span> <span class=o>=</span> <span class=nx>photos</span><span class=p>[</span><span class=nx>i</span><span class=p>];</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>artists</span><span class=p>[</span><span class=nx>i</span><span class=p>].</span><span class=nx>camera</span> <span class=o>=</span> <span class=nx>cameras</span><span class=p>[</span><span class=nx>i</span><span class=p>];</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>artistsCorrect</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s2>&#34;result -&gt;&#34;</span><span class=p>,</span> <span class=nx>artists</span><span class=p>);</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kr>const</span> <span class=nx>photos</span> <span class=o>=</span> <span class=p>[</span><span class=s2>&#34;photoMoon&#34;</span><span class=p>,</span> <span class=s2>&#34;photoSun&#34;</span><span class=p>,</span> <span class=s2>&#34;photoSky&#34;</span><span class=p>];</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>cameras</span> <span class=o>=</span> <span class=p>[</span><span class=s2>&#34;canon&#34;</span><span class=p>,</span> <span class=s2>&#34;nikon&#34;</span><span class=p>,</span> <span class=s2>&#34;Sony&#34;</span><span class=p>];</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>artists</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>name</span><span class=o>:</span> <span class=s2>&#34;Thomas Kelley&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>link</span><span class=o>:</span> <span class=s2>&#34;https://unsplash.com/@thkelley&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>name</span><span class=o>:</span> <span class=s2>&#34;Thomas Kvistholt&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>link</span><span class=o>:</span> <span class=s2>&#34;https://unsplash.com/@freeche&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>name</span><span class=o>:</span> <span class=s2>&#34;Guillaume Flandre&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>link</span><span class=o>:</span> <span class=s2>&#34;https://unsplash.com/@gflandre&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span>
</span></span><span class=line><span class=cl><span class=p>];</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>artistsCorrect</span><span class=p>(</span><span class=nx>artistsList</span><span class=p>,</span> <span class=nx>photosList</span><span class=p>,</span> <span class=nx>camerasList</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=nx>artistsList</span><span class=p>.</span><span class=nx>map</span><span class=p>((</span><span class=nx>artist</span><span class=p>,</span> <span class=nx>index</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>extraValues</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>photo</span><span class=o>:</span> <span class=nx>photosList</span><span class=p>[</span><span class=nx>index</span><span class=p>],</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      <span class=nx>camera</span><span class=o>:</span> <span class=nx>camerasList</span><span class=p>[</span><span class=nx>index</span><span class=p>],</span>
</span></span><span class=line><span class=cl>    <span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nb>Object</span><span class=p>.</span><span class=nx>assign</span><span class=p>({},</span> <span class=nx>artist</span><span class=p>,</span> <span class=nx>extraValues</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>});</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>result</span> <span class=o>=</span> <span class=nx>artistsCorrect</span><span class=p>(</span><span class=nx>artists</span><span class=p>,</span> <span class=nx>photos</span><span class=p>,</span> <span class=nx>cameras</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s2>&#34;result -&gt;&#34;</span><span class=p>,</span> <span class=nx>result</span><span class=p>);</span>
</span></span></code></pre></div><h1 id=声明式组件>声明式组件</h1><p>jQuery 作为了影响一代前端开发者的框架，是前端工具的典型代表，它留下了璀璨的痕迹与无法磨灭的脚印；笔者则是以 jQuery 为符号，代指以 DOM 节点操作为核心的前端开发风格。所谓以 DOM 操作为核心，即要插入数据或者更改数据，都是直接操作 DOM 节点，或者手工的构造 DOM 节点；譬如从服务端获得一个用户列表之后，会通过构造 <code>&lt;i></code> 节点的方式将数据插入到 DOM 树中。而随着现代浏览器的发展与逐步统一的原生 API 的丰富，应用复杂度的增加，并且直接的 DOM 操作不支持同构渲染与跨平台渲染，还存在着较大的性能缺陷，前端逐步从以 DOM 为中心过渡到了以数据 / 状态为中心。</p><p>在现代 Web 开发中，无论是 Angular、Web Components、React 还是 Vue.js，都是以声明式组件为编程基础；我们在上文中提到过，声明式编程的核心理念在于描述做什么，通过声明式的方式我们能够以链式方法调用的形式对于输入的数据流进行一系列的变换处理。譬如以 jQuery 开发简单的表单校验与提交，最简单直观的命令式编程方式如下：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=c1>// Email field
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>$</span><span class=p>(</span><span class=s2>&#34;#email-field&#34;</span><span class=p>).</span><span class=nx>on</span><span class=p>(</span><span class=s2>&#34;blur&#34;</span><span class=p>,</span> <span class=kd>function</span> <span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>username</span> <span class=o>=</span> <span class=nx>$</span><span class=p>(</span><span class=k>this</span><span class=p>).</span><span class=nx>val</span><span class=p>();</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span><span class=nx>username</span> <span class=o>==</span> <span class=s2>&#34;&#34;</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>$</span><span class=p>(</span><span class=s2>&#34;#email-error&#34;</span><span class=p>).</span><span class=nx>html</span><span class=p>(</span><span class=s2>&#34;Please enter email address&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nx>$</span><span class=p>(</span><span class=s2>&#34;#signup-button&#34;</span><span class=p>).</span><span class=nx>attr</span><span class=p>(</span><span class=s2>&#34;disabled&#34;</span><span class=p>,</span> <span class=kc>true</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>checkValues</span><span class=p>();</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span></code></pre></div><p>这种方式也显而易见的存在很多的代码冗余，导致整体的可读性与重构性降低，譬如邮箱与密码这两个输入域都会在失去焦点时进行验证，并且判断是否设置按钮失效。而在声明式编程中，我们可以将公用的部分业务逻辑代码，即是偏向于计算的、表达式形式的代码剥离出来，可以得到如下的封装：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kd>function</span> <span class=nx>checkIfEmpty</span><span class=p>(</span><span class=nx>e</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=o>!</span><span class=nx>e</span><span class=p>.</span><span class=nx>target</span><span class=p>.</span><span class=nx>value</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>checkIfBothEmpty</span><span class=p>(</span><span class=nx>noEmail</span><span class=p>,</span> <span class=nx>noPass</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=nx>noEmail</span> <span class=o>||</span> <span class=nx>noPass</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>getEmailMessage</span><span class=p>(</span><span class=nx>noEmail</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=nx>noEmail</span> <span class=o>?</span> <span class=s2>&#34;Please enter email address.&#34;</span> <span class=o>:</span> <span class=s2>&#34;&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span> <span class=c1>// Email field
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=kd>var</span> <span class=nx>email</span> <span class=o>=</span> <span class=nx>$</span><span class=p>(</span><span class=s2>&#34;#email-field&#34;</span><span class=p>).</span><span class=nx>asEventStream</span><span class=p>(</span><span class=s2>&#34;blur&#34;</span><span class=p>).</span><span class=nx>map</span><span class=p>(</span><span class=nx>checkIfEmpty</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>email</span><span class=p>.</span><span class=nx>map</span><span class=p>(</span><span class=nx>getEmailMessage</span><span class=p>).</span><span class=nx>assign</span><span class=p>(</span><span class=nx>$</span><span class=p>(</span><span class=s2>&#34;#email-error&#34;</span><span class=p>),</span> <span class=s2>&#34;html&#34;</span><span class=p>);</span>
</span></span></code></pre></div><p>代码更加清晰易懂，并且对于空判断这些公共逻辑代码的提出也方便了我们进行重构或者对于业务逻辑的变化进行快速响应。未来如果我们需要添加 Checkbox、DialogBox 等控件时，声明式的代码增加会远小于命令式，并且我们也只是需要创建新的数据流而已。而采用 JSX 的方式，我们可以更加直观地将布局与逻辑混合编排：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=o>&lt;</span><span class=nx>select</span> <span class=nx>value</span><span class=o>=</span><span class=p>{</span><span class=k>this</span><span class=p>.</span><span class=nx>state</span><span class=p>.</span><span class=nx>value</span><span class=p>}</span> <span class=nx>onChange</span><span class=o>=</span><span class=p>{</span><span class=k>this</span><span class=p>.</span><span class=nx>handleChange</span><span class=p>}</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span><span class=nx>somearray</span><span class=p>.</span><span class=nx>map</span><span class=p>((</span><span class=nx>element</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=o>&lt;</span><span class=nx>option</span> <span class=nx>value</span><span class=o>=</span><span class=p>{</span><span class=nx>element</span><span class=p>.</span><span class=nx>value</span><span class=p>}</span><span class=o>&gt;</span><span class=p>{</span><span class=nx>element</span><span class=p>.</span><span class=nx>text</span><span class=p>}</span><span class=o>&lt;</span><span class=err>/option&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>))}</span>
</span></span><span class=line><span class=cl><span class=o>&lt;</span><span class=err>/select&gt;</span>
</span></span></code></pre></div><p>JSX 并非等价于 HTML 元素，通过 Babel 等转换工具其会被</p><p>组件化也允许我们更好地分割前端代码：</p><p>声明式组件并非禁绝了 DOM 操作，而是将 DOM 操作这样与浏览器运行时的交互交付给了框架，开发者可以专注于上层应用逻辑的开发；这种分层隔离本身也保证了应用的可迁移性，譬如 React Native、Weex 这样的框架，就允许我们将相同的代码分别渲染到不同的原生平台中。声明式组件的核心函数即是 <code>View = f(Template, Props)(State)</code></p><h2 id=virtual-dom>Virtual DOM</h2><p>如我们所知，在浏览器渲染网页的过程中，加载到 HTML 文档后，会将文档解析并构建 DOM 树，然后将其与解析 CSS 生成的 CSSOM 树一起结合产生爱的结晶 ——RenderObject 树，然后将 RenderObject 树渲染成页面(当然中间可能会有一些优化，比如 RenderLayer 树)。这些过程都存在与渲染引擎之中，渲染引擎在浏览器中是于 JavaScript 引擎(JavaScriptCore 也好 V8 也好)分离开的，但为了方便 JS 操作 DOM 结构，渲染引擎会暴露一些接口供 JavaScript 调用。由于这两块相互分离，通信是需要付出代价的，因此 JavaScript 调用 DOM 提供的接口性能不咋地。各种性能优化的最佳实践也都在尽可能的减少 DOM 操作次数。而虚拟 DOM 干了什么？它直接用 JavaScript 实现了 DOM 树(大致上)。组件的 HTML 结构并不会直接生成 DOM，而是映射生成虚拟的 JavaScript DOM 结构，React 又通过在这个虚拟 DOM 上实现了一个 diff 算法找出最小变更，再把这些变更写入实际的 DOM 中。这个虚拟 DOM 以 JS 结构的形式存在，计算性能会比较好，而且由于减少了实际 DOM 操作次数，性能会有较大提升。React 渲染出来的 HTML 标记都包含了<code>data-reactid</code>属性，这有助于 React 中追踪 DOM 节点。很多人第一次学习 React 的时候都会觉得 JSX 语法看上去非常怪异，这种背离传统的 HTML 模板开发方式真的靠谱吗？(在 2.0 版本中 Vue 也引入了 JSX 语法支持)。我们并不能单纯地将 JSX 与传统的 HTML 模板相提并论，JSX 本质上是对于<code>React.createElement</code>函数的抽象，而该函数主要的作用是将朴素的 JavaScript 中的对象映射为某个 DOM 表示。其大概思想图示如下：</p><p><figure><div class="d-flex justify-content-center"><div class=w-100><img src=https://i.stack.imgur.com/S1vng.png alt loading=lazy data-zoomable></div></div></figure></p><p>在现代浏览器中，对于 JavaScript 的计算速度远快于对 DOM 进行操作，特别是在涉及到重绘与重渲染的情况下。并且以 JavaScript 对象代替与平台强相关的 DOM，也保证了多平台的支持，譬如在 ReactNative 的协助下我们很方便地可以将一套代码运行于 iOS、Android 等多平台。总结而言，JSX 本质上还是 JavaScript，因此我们在保留了 JavaScript 函数本身在组合、语法检查、调试方面优势的同时又能得到类似于 HTML 这样声明式用法的便利与较好的可读性。</p><h1 id=gui-应用程序架构的变迁>GUI 应用程序架构的变迁</h1><h1 id=函数式编程与-redux>函数式编程与 Redux</h1><h2 id=函数式编程>函数式编程</h2><p>在软件开发中有一句名言：共享的可变状态是万恶之源，即 <a href=http://www.dalnefre.com/wp/2011/11/high-availability-for-mutable-shared-state/ target=_blank rel=noopener>Mutable shared state is the root of all evil in concurrent systems.</a>，而函数式编程正是能够彻底解决共享状态。函数式编程本质上也是一种编程范式(Programming Paradigm )，其代表了一系列用于构建软件系统的基本定义准则；它强调避免使用共享状态(Shared State)、可变状态(Mutable Data)以及副作用(Side Effects )，整个软件系统由数据驱动，应用的状态在不同纯函数之间流动。与偏向命令式编程的面向对象编程而言，函数式编程其更偏向于声明式编程，代码更加简洁明了、更可预测，并且可测试性也更好；典型的函数式编程语言有 Scala、Haskell 等，而其编程思想在 Go、Swift、JavaScript、Python 乃至于 Java 中都有着广泛而深远的实践应用。</p><p>共享状态(Shared State)可以是存在于共享作用域(全局作用域与闭包作用域)或者作为传递到不同作用域的对象属性的任何变量、对象或者内存空间。在面向对象编程中，我们常常是通过添加属性到其他对象的方式共享某个对象。共享状态问题在于，如果开发者想要理解某个函数的作用，必须去详细了解该函数可能对于每个共享变量造成的影响。往往多个并发请求会导致的数据一致性错乱也就是触发所谓的竞态条件(Race Condition )，而不同的调用顺序可能会触发未知的错误，这是因为对于共享状态的操作往往是时序依赖的。</p><p>纯函数指那些仅根据输入参数决定输出并且不会产生任何副作用的函数。纯函数最优秀的特性之一在于其结果的可预测性：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kd>var</span> <span class=nx>z</span> <span class=o>=</span> <span class=mi>10</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>add</span><span class=p>(</span><span class=nx>x</span><span class=p>,</span> <span class=nx>y</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=nx>x</span> <span class=o>+</span> <span class=nx>y</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>add</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>));</span> <span class=c1>// prints 3
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>add</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>));</span> <span class=c1>// still prints 3
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>add</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>));</span> <span class=c1>// WILL ALWAYS print 3
</span></span></span></code></pre></div><p>副作用指那些在函数调用过程中没有通过返回值表现的任何可观测的应用状态变化，常见的副作用包括但不限于修改任何外部变量或者外部对象属性、在控制台中输出日志、写入文件、发起网络通信、触发任何外部进程事件、调用任何其他具有副作用的函数等。在函数式编程中我们会尽可能地规避副作用，保证程序更易于理解与测试。Haskell 或者其他函数式编程语言通常会使用 <a href=https://en.wikipedia.org/wiki/Monad_%28functional_programming%29 target=_blank rel=noopener>Monads</a>来隔离与封装副作用。在绝大部分真实的应用场景进行编程开始时，我们不可能保证系统中的全部函数都是纯函数，但是我们应该尽可能地增加纯函数的数目并且将有副作用的部分与纯函数剥离开来，特别是将业务逻辑抽象为纯函数，来保证软件更易于扩展、重构、调试、测试与维护。这也是很多前端框架鼓励开发者将用户的状态管理与组件渲染相隔离，构建松耦合模块的原因。不可变对象(Immutable Object )指那些创建之后无法再被修改的对象，与之相对的可变对象(Mutable Object )指那些创建之后仍然可以被修改的对象。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kr>const</span> <span class=nx>a</span> <span class=o>=</span> <span class=nb>Object</span><span class=p>.</span><span class=nx>freeze</span><span class=p>({</span>
</span></span><span class=line><span class=cl>  <span class=nx>foo</span><span class=o>:</span> <span class=s2>&#34;Hello&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>bar</span><span class=o>:</span> <span class=s2>&#34;world&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>baz</span><span class=o>:</span> <span class=s2>&#34;!&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>a</span><span class=p>.</span><span class=nx>foo</span> <span class=o>=</span> <span class=s2>&#34;Goodbye&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Error: Cannot assign to read only property &#39;foo&#39; of object Object
</span></span></span></code></pre></div><p>函数式编程倾向于重用一系列公共的纯函数来处理数据，而面向对象编程则是将方法与数据封装到对象内。这些被封装起来的方法复用性不强，只能作用于某些类型的数据，往往只能处理所属对象的实例这种数据类型。而函数式编程中，任何类型的数据则是被一视同仁，譬如<code>map()</code>函数允许开发者传入函数参数，保证其能够作用于对象、字符串、数字，以及任何其他类型。JavaScript 中函数同样是一等公民，即我们可以像其他类型一样处理函数，将其赋予变量、传递给其他函数或者作为函数返回值。而高阶函数(Higher Order Function )则是能够接受函数作为参数，能够返回某个函数作为返回值的函数。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kr>const</span> <span class=nx>add10</span> <span class=o>=</span> <span class=p>(</span><span class=nx>value</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=nx>value</span> <span class=o>+</span> <span class=mi>10</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>mult5</span> <span class=o>=</span> <span class=p>(</span><span class=nx>value</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=nx>value</span> <span class=o>*</span> <span class=mi>5</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>mult5AfterAdd10</span> <span class=o>=</span> <span class=p>(</span><span class=nx>value</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=mi>5</span> <span class=o>*</span> <span class=p>(</span><span class=nx>value</span> <span class=o>+</span> <span class=mi>10</span><span class=p>);</span>
</span></span></code></pre></div><h1 id=tfrp-与-mobx>TFRP 与 MobX</h1></div><div class=article-widget><div class="container-xl row post-nav"><div class="col-6 post-nav-item"><div class=meta-nav>上一页</div><a href=/books/web-engineering-series/04.%E7%8A%B6%E6%80%81%E7%AE%A1%E7%90%86/%E8%AE%BE%E8%AE%A1%E7%90%86%E5%BF%B5/%E6%B8%90%E8%BF%9B%E7%9A%84%E7%8A%B6%E6%80%81%E7%AE%A1%E7%90%86/ rel=next>渐进的状态管理</a></div></div></div><div class=body-footer><p>最近更新于 0001-01-01</p><section id=comments class="mb-3 pt-0"><div id=disqus_thread></div><script>var disqus_config=function(){};(function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="https://ngte.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)})()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></section></div></article><footer class=site-footer><div class="copyright py-4 bg-footer"><div class="row justify-content-center"><div class="text-center footer-color"><p class=mb-0>© 2017-2022 NGTE all rights reserved</p></div></div></div></footer></main></div></div><script src=//unpkg.com/heti/umd/heti-addon.min.js></script>
<script>const heti=new Heti(".article");heti.autoSpacing()</script><script type=text/javascript>window.$crisp=[],window.CRISP_WEBSITE_ID="12adcc35-9621-4313-8262-62dc654b29d8",function(){setTimeout(function(){d=document,s=d.createElement("script"),s.src="https://client.crisp.chat/l.js",s.async=1,d.getElementsByTagName("head")[0].appendChild(s)},2500)}()</script></div><div class=page-footer></div><script src=/js/vendor-bundle.min.d26509351aa0ff874abbee824e982e9b.js></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.1/highlight.min.js integrity="sha512-Ypjm0o7jOxAd4hpdoppSEN0TQOC19UtPAqD+4s5AlXmUvbmmS/YMxYqAqarQYyxTnB6/rqip9qcxlNB/3U9Wdg==" crossorigin=anonymous></script>
<script id=search-hit-algolia-template type=text/html><div class=search-hit><div class=search-hit-content><div class=search-hit-name><a href={{relpermalink}}>{{#helpers.highlight}}{ "attribute": "title" }{{/helpers.highlight}}</a></div><div class="article-metadata search-hit-type">{{type}}</div><p class=search-hit-description>{{#helpers.highlight}}{ "attribute": "summary" }{{/helpers.highlight}}</p></div></div></script><script src=https://cdn.jsdelivr.net/npm/instantsearch.js@4/dist/instantsearch.production.min.js crossorigin=anonymous></script>
<script id=dsq-count-scr src=https://ngte.disqus.com/count.js async></script>
<script src=/zh/js/algolia-search-built.min.4387d694ca1258194aaf562b8cd1c400.js type=module></script>
<script id=page-data type=application/json>{"use_headroom":false}</script><script src=/zh/js/wowchemy.min.d1673c7a11d1238516cbe12a1e84257f.js></script>
<script>var mybutton=document.getElementById("backTopBtn");window.onscroll=function(){scrollFunction()};function scrollFunction(){document.body.scrollTop>20||document.documentElement.scrollTop>20?mybutton.style.display="block":mybutton.style.display="none"}function topFunction(){document.body.scrollTop=0,document.documentElement.scrollTop=0}</script><script src=https://cdn.jsdelivr.net/gh/bryanbraun/anchorjs@4.2.2/anchor.min.js integrity="sha512-I7w3ZdSFzw5j3jU3ZkNikBNeIrl3i+hEuEdwNmqUJvwNcaBUNcijnP2gd9DtGlgVYDplfjGoD8vTNsID+lCjqg==" crossorigin=anonymous></script>
<script>anchors.add()</script><script>(function(){"use strict";if(!document.queryCommandSupported("copy"))return;function e(e,t){e.className="highlight-copy-btn",e.textContent=t,setTimeout(function(){e.textContent="",e.className="highlight-copy-btn fa fa-copy"},1e3)}function t(e){var t=window.getSelection(),n=document.createRange();return n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n),t}function n(n){var o,s=document.createElement("button");s.className="highlight-copy-btn fa fa-copy",s.textContent="",o=n.firstElementChild,s.addEventListener("click",function(){try{var n=t(o);document.execCommand("copy"),n.removeAllRanges(),e(s,"已复制")}catch(t){console&&console.log(t),e(s,"Failed :'(")}}),n.appendChild(s)}var s=document.getElementsByClassName("highlight");Array.prototype.forEach.call(s,n)})()</script></body></html>